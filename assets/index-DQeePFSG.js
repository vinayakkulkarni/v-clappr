(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const f of t)if(f.type==="childList")for(const S of f.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&r(S)}).observe(document,{childList:!0,subtree:!0});function i(t){const f={};return t.integrity&&(f.integrity=t.integrity),t.referrerPolicy&&(f.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?f.credentials="include":t.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(t){if(t.ep)return;t.ep=!0;const f=i(t);fetch(t.href,f)}})();function mi(e){const n=Object.create(null);for(const i of e.split(","))n[i]=1;return i=>i in n}const be={},fr=[],Et=()=>{},Wa=()=>!1,vn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),yi=e=>e.startsWith("onUpdate:"),We=Object.assign,Ei=(e,n)=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)},fo=Object.prototype.hasOwnProperty,Te=(e,n)=>fo.call(e,n),ge=Array.isArray,Dr=e=>gn(e)==="[object Map]",ho=e=>gn(e)==="[object Set]",ye=e=>typeof e=="function",Ue=e=>typeof e=="string",_r=e=>typeof e=="symbol",ke=e=>e!==null&&typeof e=="object",Va=e=>(ke(e)||ye(e))&&ye(e.then)&&ye(e.catch),vo=Object.prototype.toString,gn=e=>vo.call(e),go=e=>gn(e).slice(8,-1),po=e=>gn(e)==="[object Object]",Ai=e=>Ue(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Or=mi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),pn=e=>{const n=Object.create(null);return(i=>n[i]||(n[i]=e(i)))},mo=/-\w/g,Dt=pn(e=>e.replace(mo,n=>n.slice(1).toUpperCase())),yo=/\B([A-Z])/g,Vt=pn(e=>e.replace(yo,"-$1").toLowerCase()),Ga=pn(e=>e.charAt(0).toUpperCase()+e.slice(1)),Rn=pn(e=>e?`on${Ga(e)}`:""),Xe=(e,n)=>!Object.is(e,n),kn=(e,...n)=>{for(let i=0;i<e.length;i++)e[i](...n)},Ha=(e,n,i,r=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:r,value:i})},Eo=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let Gi;const mn=()=>Gi||(Gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Fr(e){if(ge(e)){const n={};for(let i=0;i<e.length;i++){const r=e[i],t=Ue(r)?bo(r):Fr(r);if(t)for(const f in t)n[f]=t[f]}return n}else if(Ue(e)||ke(e))return e}const Ao=/;(?![^(]*\))/g,_o=/:([^]+)/,To=/\/\*[^]*?\*\//g;function bo(e){const n={};return e.replace(To,"").split(Ao).forEach(i=>{if(i){const r=i.split(_o);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function _i(e){let n="";if(Ue(e))n=e;else if(ge(e))for(let i=0;i<e.length;i++){const r=_i(e[i]);r&&(n+=r+" ")}else if(ke(e))for(const i in e)e[i]&&(n+=i+" ");return n.trim()}const So="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",xo=mi(So);function ja(e){return!!e||e===""}let ze;class Co{constructor(n=!1){this.detached=n,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ze,!n&&ze&&(this.index=(ze.scopes||(ze.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,i;if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].pause();for(n=0,i=this.effects.length;n<i;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,i;if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].resume();for(n=0,i=this.effects.length;n<i;n++)this.effects[n].resume()}}run(n){if(this._active){const i=ze;try{return ze=this,n()}finally{ze=i}}}on(){++this._on===1&&(this.prevScope=ze,ze=this)}off(){this._on>0&&--this._on===0&&(ze=this.prevScope,this.prevScope=void 0)}stop(n){if(this._active){this._active=!1;let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(this.effects.length=0,i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0}}}function Lo(){return ze}let Le;const Mn=new WeakSet;class Ya{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ze&&ze.active&&ze.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Mn.has(this)&&(Mn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||za(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hi(this),Xa(this);const n=Le,i=lt;Le=this,lt=!0;try{return this.fn()}finally{Qa(this),Le=n,lt=i,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)Si(n);this.deps=this.depsTail=void 0,Hi(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Mn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Xn(this)&&this.run()}get dirty(){return Xn(this)}}let $a=0,Pr,Ir;function za(e,n=!1){if(e.flags|=8,n){e.next=Ir,Ir=e;return}e.next=Pr,Pr=e}function Ti(){$a++}function bi(){if(--$a>0)return;if(Ir){let n=Ir;for(Ir=void 0;n;){const i=n.next;n.next=void 0,n.flags&=-9,n=i}}let e;for(;Pr;){let n=Pr;for(Pr=void 0;n;){const i=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(r){e||(e=r)}n=i}}if(e)throw e}function Xa(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Qa(e){let n,i=e.depsTail,r=i;for(;r;){const t=r.prevDep;r.version===-1?(r===i&&(i=t),Si(r),Do(r)):n=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=t}e.deps=n,e.depsTail=i}function Xn(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(Za(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function Za(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Br)||(e.globalVersion=Br,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Xn(e))))return;e.flags|=2;const n=e.dep,i=Le,r=lt;Le=e,lt=!0;try{Xa(e);const t=e.fn(e._value);(n.version===0||Xe(t,e._value))&&(e.flags|=128,e._value=t,n.version++)}catch(t){throw n.version++,t}finally{Le=i,lt=r,Qa(e),e.flags&=-3}}function Si(e,n=!1){const{dep:i,prevSub:r,nextSub:t}=e;if(r&&(r.nextSub=t,e.prevSub=void 0),t&&(t.prevSub=r,e.nextSub=void 0),i.subs===e&&(i.subs=r,!r&&i.computed)){i.computed.flags&=-5;for(let f=i.computed.deps;f;f=f.nextDep)Si(f,!0)}!n&&!--i.sc&&i.map&&i.map.delete(i.key)}function Do(e){const{prevDep:n,nextDep:i}=e;n&&(n.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=n,e.nextDep=void 0)}let lt=!0;const Ja=[];function Ot(){Ja.push(lt),lt=!1}function Pt(){const e=Ja.pop();lt=e===void 0?!0:e}function Hi(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const i=Le;Le=void 0;try{n()}finally{Le=i}}}let Br=0;class Oo{constructor(n,i){this.sub=n,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class yn{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(n){if(!Le||!lt||Le===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==Le)i=this.activeLink=new Oo(Le,this),Le.deps?(i.prevDep=Le.depsTail,Le.depsTail.nextDep=i,Le.depsTail=i):Le.deps=Le.depsTail=i,qa(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const r=i.nextDep;r.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=r),i.prevDep=Le.depsTail,i.nextDep=void 0,Le.depsTail.nextDep=i,Le.depsTail=i,Le.deps===i&&(Le.deps=r)}return i}trigger(n){this.version++,Br++,this.notify(n)}notify(n){Ti();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{bi()}}}function qa(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let r=n.deps;r;r=r.nextDep)qa(r)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const Qn=new WeakMap,rr=Symbol(""),Zn=Symbol(""),Ur=Symbol("");function Ve(e,n,i){if(lt&&Le){let r=Qn.get(e);r||Qn.set(e,r=new Map);let t=r.get(i);t||(r.set(i,t=new yn),t.map=r,t.key=i),t.track()}}function Ct(e,n,i,r,t,f){const S=Qn.get(e);if(!S){Br++;return}const L=h=>{h&&h.trigger()};if(Ti(),n==="clear")S.forEach(L);else{const h=ge(e),F=h&&Ai(i);if(h&&i==="length"){const T=Number(r);S.forEach((N,M)=>{(M==="length"||M===Ur||!_r(M)&&M>=T)&&L(N)})}else switch((i!==void 0||S.has(void 0))&&L(S.get(i)),F&&L(S.get(Ur)),n){case"add":h?F&&L(S.get("length")):(L(S.get(rr)),Dr(e)&&L(S.get(Zn)));break;case"delete":h||(L(S.get(rr)),Dr(e)&&L(S.get(Zn)));break;case"set":Dr(e)&&L(S.get(rr));break}}bi()}function ur(e){const n=_e(e);return n===e?n:(Ve(n,"iterate",Ur),ut(e)?n:n.map(It))}function xi(e){return Ve(e=_e(e),"iterate",Ur),e}function kt(e,n){return Bt(e)?dr(e)?Kr(It(n)):Kr(n):It(n)}const Po={__proto__:null,[Symbol.iterator](){return wn(this,Symbol.iterator,e=>kt(this,e))},concat(...e){return ur(this).concat(...e.map(n=>ge(n)?ur(n):n))},entries(){return wn(this,"entries",e=>(e[1]=kt(this,e[1]),e))},every(e,n){return St(this,"every",e,n,void 0,arguments)},filter(e,n){return St(this,"filter",e,n,i=>i.map(r=>kt(this,r)),arguments)},find(e,n){return St(this,"find",e,n,i=>kt(this,i),arguments)},findIndex(e,n){return St(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return St(this,"findLast",e,n,i=>kt(this,i),arguments)},findLastIndex(e,n){return St(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return St(this,"forEach",e,n,void 0,arguments)},includes(...e){return Nn(this,"includes",e)},indexOf(...e){return Nn(this,"indexOf",e)},join(e){return ur(this).join(e)},lastIndexOf(...e){return Nn(this,"lastIndexOf",e)},map(e,n){return St(this,"map",e,n,void 0,arguments)},pop(){return Sr(this,"pop")},push(...e){return Sr(this,"push",e)},reduce(e,...n){return ji(this,"reduce",e,n)},reduceRight(e,...n){return ji(this,"reduceRight",e,n)},shift(){return Sr(this,"shift")},some(e,n){return St(this,"some",e,n,void 0,arguments)},splice(...e){return Sr(this,"splice",e)},toReversed(){return ur(this).toReversed()},toSorted(e){return ur(this).toSorted(e)},toSpliced(...e){return ur(this).toSpliced(...e)},unshift(...e){return Sr(this,"unshift",e)},values(){return wn(this,"values",e=>kt(this,e))}};function wn(e,n,i){const r=xi(e),t=r[n]();return r!==e&&!ut(e)&&(t._next=t.next,t.next=()=>{const f=t._next();return f.done||(f.value=i(f.value)),f}),t}const Io=Array.prototype;function St(e,n,i,r,t,f){const S=xi(e),L=S!==e&&!ut(e),h=S[n];if(h!==Io[n]){const N=h.apply(e,f);return L?It(N):N}let F=i;S!==e&&(L?F=function(N,M){return i.call(this,kt(e,N),M,e)}:i.length>2&&(F=function(N,M){return i.call(this,N,M,e)}));const T=h.call(S,F,r);return L&&t?t(T):T}function ji(e,n,i,r){const t=xi(e);let f=i;return t!==e&&(ut(e)?i.length>3&&(f=function(S,L,h){return i.call(this,S,L,h,e)}):f=function(S,L,h){return i.call(this,S,kt(e,L),h,e)}),t[n](f,...r)}function Nn(e,n,i){const r=_e(e);Ve(r,"iterate",Ur);const t=r[n](...i);return(t===-1||t===!1)&&Di(i[0])?(i[0]=_e(i[0]),r[n](...i)):t}function Sr(e,n,i=[]){Ot(),Ti();const r=_e(e)[n].apply(e,i);return bi(),Pt(),r}const Ro=mi("__proto__,__v_isRef,__isVue"),es=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(_r));function ko(e){_r(e)||(e=String(e));const n=_e(this);return Ve(n,"has",e),n.hasOwnProperty(e)}class ts{constructor(n=!1,i=!1){this._isReadonly=n,this._isShallow=i}get(n,i,r){if(i==="__v_skip")return n.__v_skip;const t=this._isReadonly,f=this._isShallow;if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return f;if(i==="__v_raw")return r===(t?f?Go:as:f?is:ns).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const S=ge(n);if(!t){let h;if(S&&(h=Po[i]))return h;if(i==="hasOwnProperty")return ko}const L=Reflect.get(n,i,Ge(n)?n:r);if((_r(i)?es.has(i):Ro(i))||(t||Ve(n,"get",i),f))return L;if(Ge(L)){const h=S&&Ai(i)?L:L.value;return t&&ke(h)?qn(h):h}return ke(L)?t?qn(L):En(L):L}}class rs extends ts{constructor(n=!1){super(!1,n)}set(n,i,r,t){let f=n[i];const S=ge(n)&&Ai(i);if(!this._isShallow){const F=Bt(f);if(!ut(r)&&!Bt(r)&&(f=_e(f),r=_e(r)),!S&&Ge(f)&&!Ge(r))return F||(f.value=r),!0}const L=S?Number(i)<n.length:Te(n,i),h=Reflect.set(n,i,r,Ge(n)?n:t);return n===_e(t)&&(L?Xe(r,f)&&Ct(n,"set",i,r):Ct(n,"add",i,r)),h}deleteProperty(n,i){const r=Te(n,i);n[i];const t=Reflect.deleteProperty(n,i);return t&&r&&Ct(n,"delete",i,void 0),t}has(n,i){const r=Reflect.has(n,i);return(!_r(i)||!es.has(i))&&Ve(n,"has",i),r}ownKeys(n){return Ve(n,"iterate",ge(n)?"length":rr),Reflect.ownKeys(n)}}class Mo extends ts{constructor(n=!1){super(!0,n)}set(n,i){return!0}deleteProperty(n,i){return!0}}const wo=new rs,No=new Mo,Fo=new rs(!0);const Jn=e=>e,Qr=e=>Reflect.getPrototypeOf(e);function Bo(e,n,i){return function(...r){const t=this.__v_raw,f=_e(t),S=Dr(f),L=e==="entries"||e===Symbol.iterator&&S,h=e==="keys"&&S,F=t[e](...r),T=i?Jn:n?Kr:It;return!n&&Ve(f,"iterate",h?Zn:rr),{next(){const{value:N,done:M}=F.next();return M?{value:N,done:M}:{value:L?[T(N[0]),T(N[1])]:T(N),done:M}},[Symbol.iterator](){return this}}}}function Zr(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function Uo(e,n){const i={get(t){const f=this.__v_raw,S=_e(f),L=_e(t);e||(Xe(t,L)&&Ve(S,"get",t),Ve(S,"get",L));const{has:h}=Qr(S),F=n?Jn:e?Kr:It;if(h.call(S,t))return F(f.get(t));if(h.call(S,L))return F(f.get(L));f!==S&&f.get(t)},get size(){const t=this.__v_raw;return!e&&Ve(_e(t),"iterate",rr),t.size},has(t){const f=this.__v_raw,S=_e(f),L=_e(t);return e||(Xe(t,L)&&Ve(S,"has",t),Ve(S,"has",L)),t===L?f.has(t):f.has(t)||f.has(L)},forEach(t,f){const S=this,L=S.__v_raw,h=_e(L),F=n?Jn:e?Kr:It;return!e&&Ve(h,"iterate",rr),L.forEach((T,N)=>t.call(f,F(T),F(N),S))}};return We(i,e?{add:Zr("add"),set:Zr("set"),delete:Zr("delete"),clear:Zr("clear")}:{add(t){!n&&!ut(t)&&!Bt(t)&&(t=_e(t));const f=_e(this);return Qr(f).has.call(f,t)||(f.add(t),Ct(f,"add",t,t)),this},set(t,f){!n&&!ut(f)&&!Bt(f)&&(f=_e(f));const S=_e(this),{has:L,get:h}=Qr(S);let F=L.call(S,t);F||(t=_e(t),F=L.call(S,t));const T=h.call(S,t);return S.set(t,f),F?Xe(f,T)&&Ct(S,"set",t,f):Ct(S,"add",t,f),this},delete(t){const f=_e(this),{has:S,get:L}=Qr(f);let h=S.call(f,t);h||(t=_e(t),h=S.call(f,t)),L&&L.call(f,t);const F=f.delete(t);return h&&Ct(f,"delete",t,void 0),F},clear(){const t=_e(this),f=t.size!==0,S=t.clear();return f&&Ct(t,"clear",void 0,void 0),S}}),["keys","values","entries",Symbol.iterator].forEach(t=>{i[t]=Bo(t,e,n)}),i}function Ci(e,n){const i=Uo(e,n);return(r,t,f)=>t==="__v_isReactive"?!e:t==="__v_isReadonly"?e:t==="__v_raw"?r:Reflect.get(Te(i,t)&&t in r?i:r,t,f)}const Ko={get:Ci(!1,!1)},Wo={get:Ci(!1,!0)},Vo={get:Ci(!0,!1)};const ns=new WeakMap,is=new WeakMap,as=new WeakMap,Go=new WeakMap;function Ho(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jo(e){return e.__v_skip||!Object.isExtensible(e)?0:Ho(go(e))}function En(e){return Bt(e)?e:Li(e,!1,wo,Ko,ns)}function Yo(e){return Li(e,!1,Fo,Wo,is)}function qn(e){return Li(e,!0,No,Vo,as)}function Li(e,n,i,r,t){if(!ke(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const f=jo(e);if(f===0)return e;const S=t.get(e);if(S)return S;const L=new Proxy(e,f===2?r:i);return t.set(e,L),L}function dr(e){return Bt(e)?dr(e.__v_raw):!!(e&&e.__v_isReactive)}function Bt(e){return!!(e&&e.__v_isReadonly)}function ut(e){return!!(e&&e.__v_isShallow)}function Di(e){return e?!!e.__v_raw:!1}function _e(e){const n=e&&e.__v_raw;return n?_e(n):e}function $o(e){return!Te(e,"__v_skip")&&Object.isExtensible(e)&&Ha(e,"__v_skip",!0),e}const It=e=>ke(e)?En(e):e,Kr=e=>ke(e)?qn(e):e;function Ge(e){return e?e.__v_isRef===!0:!1}function zo(e){return Xo(e,!1)}function Xo(e,n){return Ge(e)?e:new Qo(e,n)}class Qo{constructor(n,i){this.dep=new yn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?n:_e(n),this._value=i?n:It(n),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(n){const i=this._rawValue,r=this.__v_isShallow||ut(n)||Bt(n);n=r?n:_e(n),Xe(n,i)&&(this._rawValue=n,this._value=r?n:It(n),this.dep.trigger())}}function ei(e){return Ge(e)?e.value:e}const Zo={get:(e,n,i)=>n==="__v_raw"?e:ei(Reflect.get(e,n,i)),set:(e,n,i,r)=>{const t=e[n];return Ge(t)&&!Ge(i)?(t.value=i,!0):Reflect.set(e,n,i,r)}};function ss(e){return dr(e)?e:new Proxy(e,Zo)}class Jo{constructor(n){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new yn,{get:r,set:t}=n(i.track.bind(i),i.trigger.bind(i));this._get=r,this._set=t}get value(){return this._value=this._get()}set value(n){this._set(n)}}function qo(e){return new Jo(e)}class el{constructor(n,i,r){this.fn=n,this.setter=i,this._value=void 0,this.dep=new yn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Br-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Le!==this)return za(this,!0),!0}get value(){const n=this.dep.track();return Za(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function tl(e,n,i=!1){let r,t;return ye(e)?r=e:(r=e.get,t=e.set),new el(r,t,i)}const Jr={},on=new WeakMap;let Jt;function rl(e,n=!1,i=Jt){if(i){let r=on.get(i);r||on.set(i,r=[]),r.push(e)}}function nl(e,n,i=be){const{immediate:r,deep:t,once:f,scheduler:S,augmentJob:L,call:h}=i,F=O=>t?O:ut(O)||t===!1||t===0?Nt(O,1):Nt(O);let T,N,M,U,w=!1,I=!1;if(Ge(e)?(N=()=>e.value,w=ut(e)):dr(e)?(N=()=>F(e),w=!0):ge(e)?(I=!0,w=e.some(O=>dr(O)||ut(O)),N=()=>e.map(O=>{if(Ge(O))return O.value;if(dr(O))return F(O);if(ye(O))return h?h(O,2):O()})):ye(e)?n?N=h?()=>h(e,2):e:N=()=>{if(M){Ot();try{M()}finally{Pt()}}const O=Jt;Jt=T;try{return h?h(e,3,[U]):e(U)}finally{Jt=O}}:N=Et,n&&t){const O=N,C=t===!0?1/0:t;N=()=>Nt(O(),C)}const k=Lo(),x=()=>{T.stop(),k&&k.active&&Ei(k.effects,T)};if(f&&n){const O=n;n=(...C)=>{O(...C),x()}}let D=I?new Array(e.length).fill(Jr):Jr;const R=O=>{if(!(!(T.flags&1)||!T.dirty&&!O))if(n){const C=T.run();if(t||w||(I?C.some((E,u)=>Xe(E,D[u])):Xe(C,D))){M&&M();const E=Jt;Jt=T;try{const u=[C,D===Jr?void 0:I&&D[0]===Jr?[]:D,U];D=C,h?h(n,3,u):n(...u)}finally{Jt=E}}}else T.run()};return L&&L(R),T=new Ya(N),T.scheduler=S?()=>S(R,!1):R,U=O=>rl(O,!1,T),M=T.onStop=()=>{const O=on.get(T);if(O){if(h)h(O,4);else for(const C of O)C();on.delete(T)}},n?r?R(!0):D=T.run():S?S(R.bind(null,!0),!0):T.run(),x.pause=T.pause.bind(T),x.resume=T.resume.bind(T),x.stop=x,x}function Nt(e,n=1/0,i){if(n<=0||!ke(e)||e.__v_skip||(i=i||new Map,(i.get(e)||0)>=n))return e;if(i.set(e,n),n--,Ge(e))Nt(e.value,n,i);else if(ge(e))for(let r=0;r<e.length;r++)Nt(e[r],n,i);else if(ho(e)||Dr(e))e.forEach(r=>{Nt(r,n,i)});else if(po(e)){for(const r in e)Nt(e[r],n,i);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&Nt(e[r],n,i)}return e}function Yr(e,n,i,r){try{return r?e(...r):e()}catch(t){An(t,n,i)}}function _t(e,n,i,r){if(ye(e)){const t=Yr(e,n,i,r);return t&&Va(t)&&t.catch(f=>{An(f,n,i)}),t}if(ge(e)){const t=[];for(let f=0;f<e.length;f++)t.push(_t(e[f],n,i,r));return t}}function An(e,n,i,r=!0){const t=n?n.vnode:null,{errorHandler:f,throwUnhandledErrorInProduction:S}=n&&n.appContext.config||be;if(n){let L=n.parent;const h=n.proxy,F=`https://vuejs.org/error-reference/#runtime-${i}`;for(;L;){const T=L.ec;if(T){for(let N=0;N<T.length;N++)if(T[N](e,h,F)===!1)return}L=L.parent}if(f){Ot(),Yr(f,null,10,[e,h,F]),Pt();return}}il(e,i,t,r,S)}function il(e,n,i,r=!0,t=!1){if(t)throw e;console.error(e)}const Ye=[];let vt=-1;const hr=[];let Mt=null,cr=0;const os=Promise.resolve();let ln=null;function al(e){const n=ln||os;return e?n.then(this?e.bind(this):e):n}function sl(e){let n=vt+1,i=Ye.length;for(;n<i;){const r=n+i>>>1,t=Ye[r],f=Wr(t);f<e||f===e&&t.flags&2?n=r+1:i=r}return n}function Oi(e){if(!(e.flags&1)){const n=Wr(e),i=Ye[Ye.length-1];!i||!(e.flags&2)&&n>=Wr(i)?Ye.push(e):Ye.splice(sl(n),0,e),e.flags|=1,ls()}}function ls(){ln||(ln=os.then(cs))}function ol(e){ge(e)?hr.push(...e):Mt&&e.id===-1?Mt.splice(cr+1,0,e):e.flags&1||(hr.push(e),e.flags|=1),ls()}function Yi(e,n,i=vt+1){for(;i<Ye.length;i++){const r=Ye[i];if(r&&r.flags&2){if(e&&r.id!==e.uid)continue;Ye.splice(i,1),i--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function us(e){if(hr.length){const n=[...new Set(hr)].sort((i,r)=>Wr(i)-Wr(r));if(hr.length=0,Mt){Mt.push(...n);return}for(Mt=n,cr=0;cr<Mt.length;cr++){const i=Mt[cr];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}Mt=null,cr=0}}const Wr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function cs(e){try{for(vt=0;vt<Ye.length;vt++){const n=Ye[vt];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Yr(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;vt<Ye.length;vt++){const n=Ye[vt];n&&(n.flags&=-2)}vt=-1,Ye.length=0,us(),ln=null,(Ye.length||hr.length)&&cs()}}let yt=null,_n=null;function un(e){const n=yt;return yt=e,_n=e&&e.type.__scopeId||null,n}function ll(e){_n=e}function ul(){_n=null}function cl(e,n=yt,i){if(!n||e._n)return e;const r=(...t)=>{r._d&&ta(-1);const f=un(n);let S;try{S=e(...t)}finally{un(f),r._d&&ta(1)}return S};return r._n=!0,r._c=!0,r._d=!0,r}function Qt(e,n,i,r){const t=e.dirs,f=n&&n.dirs;for(let S=0;S<t.length;S++){const L=t[S];f&&(L.oldValue=f[S].value);let h=L.dir[r];h&&(Ot(),_t(h,i,8,[e.el,L,e,n]),Pt())}}function fl(e,n){if($e){let i=$e.provides;const r=$e.parent&&$e.parent.provides;r===i&&(i=$e.provides=Object.create(r)),i[e]=n}}function rn(e,n,i=!1){const r=Bs();if(r||vr){let t=vr?vr._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(t&&e in t)return t[e];if(arguments.length>1)return i&&ye(n)?n.call(r&&r.proxy):n}}const dl=Symbol.for("v-scx"),hl=()=>rn(dl);function vl(e,n){return Pi(e,null,{flush:"sync"})}function nn(e,n,i){return Pi(e,n,i)}function Pi(e,n,i=be){const{immediate:r,deep:t,flush:f,once:S}=i,L=We({},i),h=n&&r||!n&&f!=="post";let F;if(Gr){if(f==="sync"){const U=hl();F=U.__watcherHandles||(U.__watcherHandles=[])}else if(!h){const U=()=>{};return U.stop=Et,U.resume=Et,U.pause=Et,U}}const T=$e;L.call=(U,w,I)=>_t(U,T,w,I);let N=!1;f==="post"?L.scheduler=U=>{Je(U,T&&T.suspense)}:f!=="sync"&&(N=!0,L.scheduler=(U,w)=>{w?U():Oi(U)}),L.augmentJob=U=>{n&&(U.flags|=4),N&&(U.flags|=2,T&&(U.id=T.uid,U.i=T))};const M=nl(e,n,L);return Gr&&(F?F.push(M):h&&M()),M}function gl(e,n,i){const r=this.proxy,t=Ue(e)?e.includes(".")?fs(r,e):()=>r[e]:e.bind(r,r);let f;ye(n)?f=n:(f=n.handler,i=n);const S=$r(this),L=Pi(t,f.bind(r),i);return S(),L}function fs(e,n){const i=n.split(".");return()=>{let r=e;for(let t=0;t<i.length&&r;t++)r=r[i[t]];return r}}const pl=Symbol("_vte"),ml=e=>e.__isTeleport,yl=Symbol("_leaveCb");function Ii(e,n){e.shapeFlag&6&&e.component?(e.transition=n,Ii(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function Ri(e,n){return ye(e)?We({name:e.name},n,{setup:e}):e}function ds(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const cn=new WeakMap;function Rr(e,n,i,r,t=!1){if(ge(e)){e.forEach((w,I)=>Rr(w,n&&(ge(n)?n[I]:n),i,r,t));return}if(kr(r)&&!t){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&Rr(e,n,i,r.component.subTree);return}const f=r.shapeFlag&4?Ni(r.component):r.el,S=t?null:f,{i:L,r:h}=e,F=n&&n.r,T=L.refs===be?L.refs={}:L.refs,N=L.setupState,M=_e(N),U=N===be?Wa:w=>Te(M,w);if(F!=null&&F!==h){if($i(n),Ue(F))T[F]=null,U(F)&&(N[F]=null);else if(Ge(F)){F.value=null;const w=n;w.k&&(T[w.k]=null)}}if(ye(h))Yr(h,L,12,[S,T]);else{const w=Ue(h),I=Ge(h);if(w||I){const k=()=>{if(e.f){const x=w?U(h)?N[h]:T[h]:h.value;if(t)ge(x)&&Ei(x,f);else if(ge(x))x.includes(f)||x.push(f);else if(w)T[h]=[f],U(h)&&(N[h]=T[h]);else{const D=[f];h.value=D,e.k&&(T[e.k]=D)}}else w?(T[h]=S,U(h)&&(N[h]=S)):I&&(h.value=S,e.k&&(T[e.k]=S))};if(S){const x=()=>{k(),cn.delete(e)};x.id=-1,cn.set(e,x),Je(x,i)}else $i(e),k()}}}function $i(e){const n=cn.get(e);n&&(n.flags|=8,cn.delete(e))}mn().requestIdleCallback;mn().cancelIdleCallback;const kr=e=>!!e.type.__asyncLoader,hs=e=>e.type.__isKeepAlive;function El(e,n){vs(e,"a",n)}function Al(e,n){vs(e,"da",n)}function vs(e,n,i=$e){const r=e.__wdc||(e.__wdc=()=>{let t=i;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Tn(n,r,i),i){let t=i.parent;for(;t&&t.parent;)hs(t.parent.vnode)&&_l(r,n,i,t),t=t.parent}}function _l(e,n,i,r){const t=Tn(n,e,r,!0);ms(()=>{Ei(r[n],t)},i)}function Tn(e,n,i=$e,r=!1){if(i){const t=i[e]||(i[e]=[]),f=n.__weh||(n.__weh=(...S)=>{Ot();const L=$r(i),h=_t(n,i,e,S);return L(),Pt(),h});return r?t.unshift(f):t.push(f),f}}const Rt=e=>(n,i=$e)=>{(!Gr||e==="sp")&&Tn(e,(...r)=>n(...r),i)},Tl=Rt("bm"),gs=Rt("m"),bl=Rt("bu"),Sl=Rt("u"),ps=Rt("bum"),ms=Rt("um"),xl=Rt("sp"),Cl=Rt("rtg"),Ll=Rt("rtc");function Dl(e,n=$e){Tn("ec",e,n)}const Ol=Symbol.for("v-ndc"),ti=e=>e?Us(e)?Ni(e):ti(e.parent):null,Mr=We(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ti(e.parent),$root:e=>ti(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Es(e),$forceUpdate:e=>e.f||(e.f=()=>{Oi(e.update)}),$nextTick:e=>e.n||(e.n=al.bind(e.proxy)),$watch:e=>gl.bind(e)}),Fn=(e,n)=>e!==be&&!e.__isScriptSetup&&Te(e,n),Pl={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:i,setupState:r,data:t,props:f,accessCache:S,type:L,appContext:h}=e;if(n[0]!=="$"){const M=S[n];if(M!==void 0)switch(M){case 1:return r[n];case 2:return t[n];case 4:return i[n];case 3:return f[n]}else{if(Fn(r,n))return S[n]=1,r[n];if(t!==be&&Te(t,n))return S[n]=2,t[n];if(Te(f,n))return S[n]=3,f[n];if(i!==be&&Te(i,n))return S[n]=4,i[n];ri&&(S[n]=0)}}const F=Mr[n];let T,N;if(F)return n==="$attrs"&&Ve(e.attrs,"get",""),F(e);if((T=L.__cssModules)&&(T=T[n]))return T;if(i!==be&&Te(i,n))return S[n]=4,i[n];if(N=h.config.globalProperties,Te(N,n))return N[n]},set({_:e},n,i){const{data:r,setupState:t,ctx:f}=e;return Fn(t,n)?(t[n]=i,!0):r!==be&&Te(r,n)?(r[n]=i,!0):Te(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(f[n]=i,!0)},has({_:{data:e,setupState:n,accessCache:i,ctx:r,appContext:t,props:f,type:S}},L){let h;return!!(i[L]||e!==be&&L[0]!=="$"&&Te(e,L)||Fn(n,L)||Te(f,L)||Te(r,L)||Te(Mr,L)||Te(t.config.globalProperties,L)||(h=S.__cssModules)&&h[L])},defineProperty(e,n,i){return i.get!=null?e._.accessCache[n]=0:Te(i,"value")&&this.set(e,n,i.value,null),Reflect.defineProperty(e,n,i)}};function fn(e){return ge(e)?e.reduce((n,i)=>(n[i]=null,n),{}):e}function Il(e,n){return!e||!n?e||n:ge(e)&&ge(n)?e.concat(n):We({},fn(e),fn(n))}let ri=!0;function Rl(e){const n=Es(e),i=e.proxy,r=e.ctx;ri=!1,n.beforeCreate&&zi(n.beforeCreate,e,"bc");const{data:t,computed:f,methods:S,watch:L,provide:h,inject:F,created:T,beforeMount:N,mounted:M,beforeUpdate:U,updated:w,activated:I,deactivated:k,beforeDestroy:x,beforeUnmount:D,destroyed:R,unmounted:O,render:C,renderTracked:E,renderTriggered:u,errorCaptured:l,serverPrefetch:c,expose:d,inheritAttrs:o,components:a,directives:s,filters:v}=n;if(F&&kl(F,r,null),S)for(const g in S){const A=S[g];ye(A)&&(r[g]=A.bind(i))}if(t){const g=t.call(i,i);ke(g)&&(e.data=En(g))}if(ri=!0,f)for(const g in f){const A=f[g],y=ye(A)?A.bind(i,i):ye(A.get)?A.get.bind(i,i):Et,p=!ye(A)&&ye(A.set)?A.set.bind(i):Et,b=pu({get:y,set:p});Object.defineProperty(r,g,{enumerable:!0,configurable:!0,get:()=>b.value,set:P=>b.value=P})}if(L)for(const g in L)ys(L[g],r,i,g);if(h){const g=ye(h)?h.call(i):h;Reflect.ownKeys(g).forEach(A=>{fl(A,g[A])})}T&&zi(T,e,"c");function _(g,A){ge(A)?A.forEach(y=>g(y.bind(i))):A&&g(A.bind(i))}if(_(Tl,N),_(gs,M),_(bl,U),_(Sl,w),_(El,I),_(Al,k),_(Dl,l),_(Ll,E),_(Cl,u),_(ps,D),_(ms,O),_(xl,c),ge(d))if(d.length){const g=e.exposed||(e.exposed={});d.forEach(A=>{Object.defineProperty(g,A,{get:()=>i[A],set:y=>i[A]=y,enumerable:!0})})}else e.exposed||(e.exposed={});C&&e.render===Et&&(e.render=C),o!=null&&(e.inheritAttrs=o),a&&(e.components=a),s&&(e.directives=s),c&&ds(e)}function kl(e,n,i=Et){ge(e)&&(e=ni(e));for(const r in e){const t=e[r];let f;ke(t)?"default"in t?f=rn(t.from||r,t.default,!0):f=rn(t.from||r):f=rn(t),Ge(f)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>f.value,set:S=>f.value=S}):n[r]=f}}function zi(e,n,i){_t(ge(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,i)}function ys(e,n,i,r){let t=r.includes(".")?fs(i,r):()=>i[r];if(Ue(e)){const f=n[e];ye(f)&&nn(t,f)}else if(ye(e))nn(t,e.bind(i));else if(ke(e))if(ge(e))e.forEach(f=>ys(f,n,i,r));else{const f=ye(e.handler)?e.handler.bind(i):n[e.handler];ye(f)&&nn(t,f,e)}}function Es(e){const n=e.type,{mixins:i,extends:r}=n,{mixins:t,optionsCache:f,config:{optionMergeStrategies:S}}=e.appContext,L=f.get(n);let h;return L?h=L:!t.length&&!i&&!r?h=n:(h={},t.length&&t.forEach(F=>dn(h,F,S,!0)),dn(h,n,S)),ke(n)&&f.set(n,h),h}function dn(e,n,i,r=!1){const{mixins:t,extends:f}=n;f&&dn(e,f,i,!0),t&&t.forEach(S=>dn(e,S,i,!0));for(const S in n)if(!(r&&S==="expose")){const L=Ml[S]||i&&i[S];e[S]=L?L(e[S],n[S]):n[S]}return e}const Ml={data:Xi,props:Qi,emits:Qi,methods:Cr,computed:Cr,beforeCreate:je,created:je,beforeMount:je,mounted:je,beforeUpdate:je,updated:je,beforeDestroy:je,beforeUnmount:je,destroyed:je,unmounted:je,activated:je,deactivated:je,errorCaptured:je,serverPrefetch:je,components:Cr,directives:Cr,watch:Nl,provide:Xi,inject:wl};function Xi(e,n){return n?e?function(){return We(ye(e)?e.call(this,this):e,ye(n)?n.call(this,this):n)}:n:e}function wl(e,n){return Cr(ni(e),ni(n))}function ni(e){if(ge(e)){const n={};for(let i=0;i<e.length;i++)n[e[i]]=e[i];return n}return e}function je(e,n){return e?[...new Set([].concat(e,n))]:n}function Cr(e,n){return e?We(Object.create(null),e,n):n}function Qi(e,n){return e?ge(e)&&ge(n)?[...new Set([...e,...n])]:We(Object.create(null),fn(e),fn(n??{})):n}function Nl(e,n){if(!e)return n;if(!n)return e;const i=We(Object.create(null),e);for(const r in n)i[r]=je(e[r],n[r]);return i}function As(){return{app:null,config:{isNativeTag:Wa,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fl=0;function Bl(e,n){return function(r,t=null){ye(r)||(r=We({},r)),t!=null&&!ke(t)&&(t=null);const f=As(),S=new WeakSet,L=[];let h=!1;const F=f.app={_uid:Fl++,_component:r,_props:t,_container:null,_context:f,_instance:null,version:mu,get config(){return f.config},set config(T){},use(T,...N){return S.has(T)||(T&&ye(T.install)?(S.add(T),T.install(F,...N)):ye(T)&&(S.add(T),T(F,...N))),F},mixin(T){return f.mixins.includes(T)||f.mixins.push(T),F},component(T,N){return N?(f.components[T]=N,F):f.components[T]},directive(T,N){return N?(f.directives[T]=N,F):f.directives[T]},mount(T,N,M){if(!h){const U=F._ceVNode||ft(r,t);return U.appContext=f,M===!0?M="svg":M===!1&&(M=void 0),e(U,T,M),h=!0,F._container=T,T.__vue_app__=F,Ni(U.component)}},onUnmount(T){L.push(T)},unmount(){h&&(_t(L,F._instance,16),e(null,F._container),delete F._container.__vue_app__)},provide(T,N){return f.provides[T]=N,F},runWithContext(T){const N=vr;vr=F;try{return T()}finally{vr=N}}};return F}}let vr=null;function Bn(e,n,i=be){const r=Bs(),t=Dt(n),f=Vt(n),S=_s(e,t),L=qo((h,F)=>{let T,N=be,M;return vl(()=>{const U=e[t];Xe(T,U)&&(T=U,F())}),{get(){return h(),i.get?i.get(T):T},set(U){const w=i.set?i.set(U):U;if(!Xe(w,T)&&!(N!==be&&Xe(U,N)))return;const I=r.vnode.props;I&&(n in I||t in I||f in I)&&(`onUpdate:${n}`in I||`onUpdate:${t}`in I||`onUpdate:${f}`in I)||(T=U,F()),r.emit(`update:${n}`,w),Xe(U,w)&&Xe(U,N)&&!Xe(w,M)&&F(),N=U,M=w}}});return L[Symbol.iterator]=()=>{let h=0;return{next(){return h<2?{value:h++?S||be:L,done:!1}:{done:!0}}}},L}const _s=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Dt(n)}Modifiers`]||e[`${Vt(n)}Modifiers`];function Ul(e,n,...i){if(e.isUnmounted)return;const r=e.vnode.props||be;let t=i;const f=n.startsWith("update:"),S=f&&_s(r,n.slice(7));S&&(S.trim&&(t=i.map(T=>Ue(T)?T.trim():T)),S.number&&(t=i.map(Eo)));let L,h=r[L=Rn(n)]||r[L=Rn(Dt(n))];!h&&f&&(h=r[L=Rn(Vt(n))]),h&&_t(h,e,6,t);const F=r[L+"Once"];if(F){if(!e.emitted)e.emitted={};else if(e.emitted[L])return;e.emitted[L]=!0,_t(F,e,6,t)}}const Kl=new WeakMap;function Ts(e,n,i=!1){const r=i?Kl:n.emitsCache,t=r.get(e);if(t!==void 0)return t;const f=e.emits;let S={},L=!1;if(!ye(e)){const h=F=>{const T=Ts(F,n,!0);T&&(L=!0,We(S,T))};!i&&n.mixins.length&&n.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}return!f&&!L?(ke(e)&&r.set(e,null),null):(ge(f)?f.forEach(h=>S[h]=null):We(S,f),ke(e)&&r.set(e,S),S)}function bn(e,n){return!e||!vn(n)?!1:(n=n.slice(2).replace(/Once$/,""),Te(e,n[0].toLowerCase()+n.slice(1))||Te(e,Vt(n))||Te(e,n))}function Zi(e){const{type:n,vnode:i,proxy:r,withProxy:t,propsOptions:[f],slots:S,attrs:L,emit:h,render:F,renderCache:T,props:N,data:M,setupState:U,ctx:w,inheritAttrs:I}=e,k=un(e);let x,D;try{if(i.shapeFlag&4){const O=t||r,C=O;x=pt(F.call(C,O,T,N,U,M,w)),D=L}else{const O=n;x=pt(O.length>1?O(N,{attrs:L,slots:S,emit:h}):O(N,null)),D=n.props?L:Wl(L)}}catch(O){wr.length=0,An(O,e,1),x=ft(Ut)}let R=x;if(D&&I!==!1){const O=Object.keys(D),{shapeFlag:C}=R;O.length&&C&7&&(f&&O.some(yi)&&(D=Vl(D,f)),R=yr(R,D,!1,!0))}return i.dirs&&(R=yr(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(i.dirs):i.dirs),i.transition&&Ii(R,i.transition),x=R,un(k),x}const Wl=e=>{let n;for(const i in e)(i==="class"||i==="style"||vn(i))&&((n||(n={}))[i]=e[i]);return n},Vl=(e,n)=>{const i={};for(const r in e)(!yi(r)||!(r.slice(9)in n))&&(i[r]=e[r]);return i};function Gl(e,n,i){const{props:r,children:t,component:f}=e,{props:S,children:L,patchFlag:h}=n,F=f.emitsOptions;if(n.dirs||n.transition)return!0;if(i&&h>=0){if(h&1024)return!0;if(h&16)return r?Ji(r,S,F):!!S;if(h&8){const T=n.dynamicProps;for(let N=0;N<T.length;N++){const M=T[N];if(S[M]!==r[M]&&!bn(F,M))return!0}}}else return(t||L)&&(!L||!L.$stable)?!0:r===S?!1:r?S?Ji(r,S,F):!0:!!S;return!1}function Ji(e,n,i){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let t=0;t<r.length;t++){const f=r[t];if(n[f]!==e[f]&&!bn(i,f))return!0}return!1}function Hl({vnode:e,parent:n},i){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=i,n=n.parent;else break}}const bs={},Ss=()=>Object.create(bs),xs=e=>Object.getPrototypeOf(e)===bs;function jl(e,n,i,r=!1){const t={},f=Ss();e.propsDefaults=Object.create(null),Cs(e,n,t,f);for(const S in e.propsOptions[0])S in t||(t[S]=void 0);i?e.props=r?t:Yo(t):e.type.props?e.props=t:e.props=f,e.attrs=f}function Yl(e,n,i,r){const{props:t,attrs:f,vnode:{patchFlag:S}}=e,L=_e(t),[h]=e.propsOptions;let F=!1;if((r||S>0)&&!(S&16)){if(S&8){const T=e.vnode.dynamicProps;for(let N=0;N<T.length;N++){let M=T[N];if(bn(e.emitsOptions,M))continue;const U=n[M];if(h)if(Te(f,M))U!==f[M]&&(f[M]=U,F=!0);else{const w=Dt(M);t[w]=ii(h,L,w,U,e,!1)}else U!==f[M]&&(f[M]=U,F=!0)}}}else{Cs(e,n,t,f)&&(F=!0);let T;for(const N in L)(!n||!Te(n,N)&&((T=Vt(N))===N||!Te(n,T)))&&(h?i&&(i[N]!==void 0||i[T]!==void 0)&&(t[N]=ii(h,L,N,void 0,e,!0)):delete t[N]);if(f!==L)for(const N in f)(!n||!Te(n,N))&&(delete f[N],F=!0)}F&&Ct(e.attrs,"set","")}function Cs(e,n,i,r){const[t,f]=e.propsOptions;let S=!1,L;if(n)for(let h in n){if(Or(h))continue;const F=n[h];let T;t&&Te(t,T=Dt(h))?!f||!f.includes(T)?i[T]=F:(L||(L={}))[T]=F:bn(e.emitsOptions,h)||(!(h in r)||F!==r[h])&&(r[h]=F,S=!0)}if(f){const h=_e(i),F=L||be;for(let T=0;T<f.length;T++){const N=f[T];i[N]=ii(t,h,N,F[N],e,!Te(F,N))}}return S}function ii(e,n,i,r,t,f){const S=e[i];if(S!=null){const L=Te(S,"default");if(L&&r===void 0){const h=S.default;if(S.type!==Function&&!S.skipFactory&&ye(h)){const{propsDefaults:F}=t;if(i in F)r=F[i];else{const T=$r(t);r=F[i]=h.call(null,n),T()}}else r=h;t.ce&&t.ce._setProp(i,r)}S[0]&&(f&&!L?r=!1:S[1]&&(r===""||r===Vt(i))&&(r=!0))}return r}const $l=new WeakMap;function Ls(e,n,i=!1){const r=i?$l:n.propsCache,t=r.get(e);if(t)return t;const f=e.props,S={},L=[];let h=!1;if(!ye(e)){const T=N=>{h=!0;const[M,U]=Ls(N,n,!0);We(S,M),U&&L.push(...U)};!i&&n.mixins.length&&n.mixins.forEach(T),e.extends&&T(e.extends),e.mixins&&e.mixins.forEach(T)}if(!f&&!h)return ke(e)&&r.set(e,fr),fr;if(ge(f))for(let T=0;T<f.length;T++){const N=Dt(f[T]);qi(N)&&(S[N]=be)}else if(f)for(const T in f){const N=Dt(T);if(qi(N)){const M=f[T],U=S[N]=ge(M)||ye(M)?{type:M}:We({},M),w=U.type;let I=!1,k=!0;if(ge(w))for(let x=0;x<w.length;++x){const D=w[x],R=ye(D)&&D.name;if(R==="Boolean"){I=!0;break}else R==="String"&&(k=!1)}else I=ye(w)&&w.name==="Boolean";U[0]=I,U[1]=k,(I||Te(U,"default"))&&L.push(N)}}const F=[S,L];return ke(e)&&r.set(e,F),F}function qi(e){return e[0]!=="$"&&!Or(e)}const ki=e=>e==="_"||e==="_ctx"||e==="$stable",Mi=e=>ge(e)?e.map(pt):[pt(e)],zl=(e,n,i)=>{if(n._n)return n;const r=cl((...t)=>Mi(n(...t)),i);return r._c=!1,r},Ds=(e,n,i)=>{const r=e._ctx;for(const t in e){if(ki(t))continue;const f=e[t];if(ye(f))n[t]=zl(t,f,r);else if(f!=null){const S=Mi(f);n[t]=()=>S}}},Os=(e,n)=>{const i=Mi(n);e.slots.default=()=>i},Ps=(e,n,i)=>{for(const r in n)(i||!ki(r))&&(e[r]=n[r])},Xl=(e,n,i)=>{const r=e.slots=Ss();if(e.vnode.shapeFlag&32){const t=n._;t?(Ps(r,n,i),i&&Ha(r,"_",t,!0)):Ds(n,r)}else n&&Os(e,n)},Ql=(e,n,i)=>{const{vnode:r,slots:t}=e;let f=!0,S=be;if(r.shapeFlag&32){const L=n._;L?i&&L===1?f=!1:Ps(t,n,i):(f=!n.$stable,Ds(n,t)),S=n}else n&&(Os(e,n),S={default:1});if(f)for(const L in t)!ki(L)&&S[L]==null&&delete t[L]},Je=tu;function Zl(e){return Jl(e)}function Jl(e,n){const i=mn();i.__VUE__=!0;const{insert:r,remove:t,patchProp:f,createElement:S,createText:L,createComment:h,setText:F,setElementText:T,parentNode:N,nextSibling:M,setScopeId:U=Et,insertStaticContent:w}=e,I=(Y,X,q,re=null,te=null,ne=null,K=void 0,H=null,z=!!X.dynamicChildren)=>{if(Y===X)return;Y&&!xr(Y,X)&&(re=$(Y),P(Y,te,ne,!0),Y=null),X.patchFlag===-2&&(z=!1,X.dynamicChildren=null);const{type:J,ref:ae,shapeFlag:ie}=X;switch(J){case Sn:k(Y,X,q,re);break;case Ut:x(Y,X,q,re);break;case Kn:Y==null&&D(X,q,re,K);break;case gt:a(Y,X,q,re,te,ne,K,H,z);break;default:ie&1?C(Y,X,q,re,te,ne,K,H,z):ie&6?s(Y,X,q,re,te,ne,K,H,z):(ie&64||ie&128)&&J.process(Y,X,q,re,te,ne,K,H,z,ee)}ae!=null&&te?Rr(ae,Y&&Y.ref,ne,X||Y,!X):ae==null&&Y&&Y.ref!=null&&Rr(Y.ref,null,ne,Y,!0)},k=(Y,X,q,re)=>{if(Y==null)r(X.el=L(X.children),q,re);else{const te=X.el=Y.el;X.children!==Y.children&&F(te,X.children)}},x=(Y,X,q,re)=>{Y==null?r(X.el=h(X.children||""),q,re):X.el=Y.el},D=(Y,X,q,re)=>{[Y.el,Y.anchor]=w(Y.children,X,q,re,Y.el,Y.anchor)},R=({el:Y,anchor:X},q,re)=>{let te;for(;Y&&Y!==X;)te=M(Y),r(Y,q,re),Y=te;r(X,q,re)},O=({el:Y,anchor:X})=>{let q;for(;Y&&Y!==X;)q=M(Y),t(Y),Y=q;t(X)},C=(Y,X,q,re,te,ne,K,H,z)=>{if(X.type==="svg"?K="svg":X.type==="math"&&(K="mathml"),Y==null)E(X,q,re,te,ne,K,H,z);else{const J=Y.el&&Y.el._isVueCE?Y.el:null;try{J&&J._beginPatch(),c(Y,X,te,ne,K,H,z)}finally{J&&J._endPatch()}}},E=(Y,X,q,re,te,ne,K,H)=>{let z,J;const{props:ae,shapeFlag:ie,transition:le,dirs:oe}=Y;if(z=Y.el=S(Y.type,ne,ae&&ae.is,ae),ie&8?T(z,Y.children):ie&16&&l(Y.children,z,null,re,te,Un(Y,ne),K,H),oe&&Qt(Y,null,re,"created"),u(z,Y,Y.scopeId,K,re),ae){for(const he in ae)he!=="value"&&!Or(he)&&f(z,he,null,ae[he],ne,re);"value"in ae&&f(z,"value",null,ae.value,ne),(J=ae.onVnodeBeforeMount)&&ht(J,re,Y)}oe&&Qt(Y,null,re,"beforeMount");const ce=ql(te,le);ce&&le.beforeEnter(z),r(z,X,q),((J=ae&&ae.onVnodeMounted)||ce||oe)&&Je(()=>{J&&ht(J,re,Y),ce&&le.enter(z),oe&&Qt(Y,null,re,"mounted")},te)},u=(Y,X,q,re,te)=>{if(q&&U(Y,q),re)for(let ne=0;ne<re.length;ne++)U(Y,re[ne]);if(te){let ne=te.subTree;if(X===ne||Ms(ne.type)&&(ne.ssContent===X||ne.ssFallback===X)){const K=te.vnode;u(Y,K,K.scopeId,K.slotScopeIds,te.parent)}}},l=(Y,X,q,re,te,ne,K,H,z=0)=>{for(let J=z;J<Y.length;J++){const ae=Y[J]=H?wt(Y[J]):pt(Y[J]);I(null,ae,X,q,re,te,ne,K,H)}},c=(Y,X,q,re,te,ne,K)=>{const H=X.el=Y.el;let{patchFlag:z,dynamicChildren:J,dirs:ae}=X;z|=Y.patchFlag&16;const ie=Y.props||be,le=X.props||be;let oe;if(q&&Zt(q,!1),(oe=le.onVnodeBeforeUpdate)&&ht(oe,q,X,Y),ae&&Qt(X,Y,q,"beforeUpdate"),q&&Zt(q,!0),(ie.innerHTML&&le.innerHTML==null||ie.textContent&&le.textContent==null)&&T(H,""),J?d(Y.dynamicChildren,J,H,q,re,Un(X,te),ne):K||A(Y,X,H,null,q,re,Un(X,te),ne,!1),z>0){if(z&16)o(H,ie,le,q,te);else if(z&2&&ie.class!==le.class&&f(H,"class",null,le.class,te),z&4&&f(H,"style",ie.style,le.style,te),z&8){const ce=X.dynamicProps;for(let he=0;he<ce.length;he++){const de=ce[he],pe=ie[de],Ae=le[de];(Ae!==pe||de==="value")&&f(H,de,pe,Ae,te,q)}}z&1&&Y.children!==X.children&&T(H,X.children)}else!K&&J==null&&o(H,ie,le,q,te);((oe=le.onVnodeUpdated)||ae)&&Je(()=>{oe&&ht(oe,q,X,Y),ae&&Qt(X,Y,q,"updated")},re)},d=(Y,X,q,re,te,ne,K)=>{for(let H=0;H<X.length;H++){const z=Y[H],J=X[H],ae=z.el&&(z.type===gt||!xr(z,J)||z.shapeFlag&198)?N(z.el):q;I(z,J,ae,null,re,te,ne,K,!0)}},o=(Y,X,q,re,te)=>{if(X!==q){if(X!==be)for(const ne in X)!Or(ne)&&!(ne in q)&&f(Y,ne,X[ne],null,te,re);for(const ne in q){if(Or(ne))continue;const K=q[ne],H=X[ne];K!==H&&ne!=="value"&&f(Y,ne,H,K,te,re)}"value"in q&&f(Y,"value",X.value,q.value,te)}},a=(Y,X,q,re,te,ne,K,H,z)=>{const J=X.el=Y?Y.el:L(""),ae=X.anchor=Y?Y.anchor:L("");let{patchFlag:ie,dynamicChildren:le,slotScopeIds:oe}=X;oe&&(H=H?H.concat(oe):oe),Y==null?(r(J,q,re),r(ae,q,re),l(X.children||[],q,ae,te,ne,K,H,z)):ie>0&&ie&64&&le&&Y.dynamicChildren&&Y.dynamicChildren.length===le.length?(d(Y.dynamicChildren,le,q,te,ne,K,H),(X.key!=null||te&&X===te.subTree)&&Is(Y,X,!0)):A(Y,X,q,ae,te,ne,K,H,z)},s=(Y,X,q,re,te,ne,K,H,z)=>{X.slotScopeIds=H,Y==null?X.shapeFlag&512?te.ctx.activate(X,q,re,K,z):v(X,q,re,te,ne,K,z):m(Y,X,z)},v=(Y,X,q,re,te,ne,K)=>{const H=Y.component=cu(Y,re,te);if(hs(Y)&&(H.ctx.renderer=ee),fu(H,!1,K),H.asyncDep){if(te&&te.registerDep(H,_,K),!Y.el){const z=H.subTree=ft(Ut);x(null,z,X,q),Y.placeholder=z.el}}else _(H,Y,X,q,te,ne,K)},m=(Y,X,q)=>{const re=X.component=Y.component;if(Gl(Y,X,q))if(re.asyncDep&&!re.asyncResolved){g(re,X,q);return}else re.next=X,re.update();else X.el=Y.el,re.vnode=X},_=(Y,X,q,re,te,ne,K)=>{const H=()=>{if(Y.isMounted){let{next:ie,bu:le,u:oe,parent:ce,vnode:he}=Y;{const De=Rs(Y);if(De){ie&&(ie.el=he.el,g(Y,ie,K)),De.asyncDep.then(()=>{Y.isUnmounted||H()});return}}let de=ie,pe;Zt(Y,!1),ie?(ie.el=he.el,g(Y,ie,K)):ie=he,le&&kn(le),(pe=ie.props&&ie.props.onVnodeBeforeUpdate)&&ht(pe,ce,ie,he),Zt(Y,!0);const Ae=Zi(Y),Pe=Y.subTree;Y.subTree=Ae,I(Pe,Ae,N(Pe.el),$(Pe),Y,te,ne),ie.el=Ae.el,de===null&&Hl(Y,Ae.el),oe&&Je(oe,te),(pe=ie.props&&ie.props.onVnodeUpdated)&&Je(()=>ht(pe,ce,ie,he),te)}else{let ie;const{el:le,props:oe}=X,{bm:ce,m:he,parent:de,root:pe,type:Ae}=Y,Pe=kr(X);Zt(Y,!1),ce&&kn(ce),!Pe&&(ie=oe&&oe.onVnodeBeforeMount)&&ht(ie,de,X),Zt(Y,!0);{pe.ce&&pe.ce._def.shadowRoot!==!1&&pe.ce._injectChildStyle(Ae);const De=Y.subTree=Zi(Y);I(null,De,q,re,Y,te,ne),X.el=De.el}if(he&&Je(he,te),!Pe&&(ie=oe&&oe.onVnodeMounted)){const De=X;Je(()=>ht(ie,de,De),te)}(X.shapeFlag&256||de&&kr(de.vnode)&&de.vnode.shapeFlag&256)&&Y.a&&Je(Y.a,te),Y.isMounted=!0,X=q=re=null}};Y.scope.on();const z=Y.effect=new Ya(H);Y.scope.off();const J=Y.update=z.run.bind(z),ae=Y.job=z.runIfDirty.bind(z);ae.i=Y,ae.id=Y.uid,z.scheduler=()=>Oi(ae),Zt(Y,!0),J()},g=(Y,X,q)=>{X.component=Y;const re=Y.vnode.props;Y.vnode=X,Y.next=null,Yl(Y,X.props,re,q),Ql(Y,X.children,q),Ot(),Yi(Y),Pt()},A=(Y,X,q,re,te,ne,K,H,z=!1)=>{const J=Y&&Y.children,ae=Y?Y.shapeFlag:0,ie=X.children,{patchFlag:le,shapeFlag:oe}=X;if(le>0){if(le&128){p(J,ie,q,re,te,ne,K,H,z);return}else if(le&256){y(J,ie,q,re,te,ne,K,H,z);return}}oe&8?(ae&16&&j(J,te,ne),ie!==J&&T(q,ie)):ae&16?oe&16?p(J,ie,q,re,te,ne,K,H,z):j(J,te,ne,!0):(ae&8&&T(q,""),oe&16&&l(ie,q,re,te,ne,K,H,z))},y=(Y,X,q,re,te,ne,K,H,z)=>{Y=Y||fr,X=X||fr;const J=Y.length,ae=X.length,ie=Math.min(J,ae);let le;for(le=0;le<ie;le++){const oe=X[le]=z?wt(X[le]):pt(X[le]);I(Y[le],oe,q,null,te,ne,K,H,z)}J>ae?j(Y,te,ne,!0,!1,ie):l(X,q,re,te,ne,K,H,z,ie)},p=(Y,X,q,re,te,ne,K,H,z)=>{let J=0;const ae=X.length;let ie=Y.length-1,le=ae-1;for(;J<=ie&&J<=le;){const oe=Y[J],ce=X[J]=z?wt(X[J]):pt(X[J]);if(xr(oe,ce))I(oe,ce,q,null,te,ne,K,H,z);else break;J++}for(;J<=ie&&J<=le;){const oe=Y[ie],ce=X[le]=z?wt(X[le]):pt(X[le]);if(xr(oe,ce))I(oe,ce,q,null,te,ne,K,H,z);else break;ie--,le--}if(J>ie){if(J<=le){const oe=le+1,ce=oe<ae?X[oe].el:re;for(;J<=le;)I(null,X[J]=z?wt(X[J]):pt(X[J]),q,ce,te,ne,K,H,z),J++}}else if(J>le)for(;J<=ie;)P(Y[J],te,ne,!0),J++;else{const oe=J,ce=J,he=new Map;for(J=ce;J<=le;J++){const Ce=X[J]=z?wt(X[J]):pt(X[J]);Ce.key!=null&&he.set(Ce.key,J)}let de,pe=0;const Ae=le-ce+1;let Pe=!1,De=0;const Me=new Array(Ae);for(J=0;J<Ae;J++)Me[J]=0;for(J=oe;J<=ie;J++){const Ce=Y[J];if(pe>=Ae){P(Ce,te,ne,!0);continue}let we;if(Ce.key!=null)we=he.get(Ce.key);else for(de=ce;de<=le;de++)if(Me[de-ce]===0&&xr(Ce,X[de])){we=de;break}we===void 0?P(Ce,te,ne,!0):(Me[we-ce]=J+1,we>=De?De=we:Pe=!0,I(Ce,X[we],q,null,te,ne,K,H,z),pe++)}const He=Pe?eu(Me):fr;for(de=He.length-1,J=Ae-1;J>=0;J--){const Ce=ce+J,we=X[Ce],Ie=X[Ce+1],Ne=Ce+1<ae?Ie.el||ks(Ie):re;Me[J]===0?I(null,we,q,Ne,te,ne,K,H,z):Pe&&(de<0||J!==He[de]?b(we,q,Ne,2):de--)}}},b=(Y,X,q,re,te=null)=>{const{el:ne,type:K,transition:H,children:z,shapeFlag:J}=Y;if(J&6){b(Y.component.subTree,X,q,re);return}if(J&128){Y.suspense.move(X,q,re);return}if(J&64){K.move(Y,X,q,ee);return}if(K===gt){r(ne,X,q);for(let ie=0;ie<z.length;ie++)b(z[ie],X,q,re);r(Y.anchor,X,q);return}if(K===Kn){R(Y,X,q);return}if(re!==2&&J&1&&H)if(re===0)H.beforeEnter(ne),r(ne,X,q),Je(()=>H.enter(ne),te);else{const{leave:ie,delayLeave:le,afterLeave:oe}=H,ce=()=>{Y.ctx.isUnmounted?t(ne):r(ne,X,q)},he=()=>{ne._isLeaving&&ne[yl](!0),ie(ne,()=>{ce(),oe&&oe()})};le?le(ne,ce,he):he()}else r(ne,X,q)},P=(Y,X,q,re=!1,te=!1)=>{const{type:ne,props:K,ref:H,children:z,dynamicChildren:J,shapeFlag:ae,patchFlag:ie,dirs:le,cacheIndex:oe}=Y;if(ie===-2&&(te=!1),H!=null&&(Ot(),Rr(H,null,q,Y,!0),Pt()),oe!=null&&(X.renderCache[oe]=void 0),ae&256){X.ctx.deactivate(Y);return}const ce=ae&1&&le,he=!kr(Y);let de;if(he&&(de=K&&K.onVnodeBeforeUnmount)&&ht(de,X,Y),ae&6)W(Y.component,q,re);else{if(ae&128){Y.suspense.unmount(q,re);return}ce&&Qt(Y,null,X,"beforeUnmount"),ae&64?Y.type.remove(Y,X,q,ee,re):J&&!J.hasOnce&&(ne!==gt||ie>0&&ie&64)?j(J,X,q,!1,!0):(ne===gt&&ie&384||!te&&ae&16)&&j(z,X,q),re&&B(Y)}(he&&(de=K&&K.onVnodeUnmounted)||ce)&&Je(()=>{de&&ht(de,X,Y),ce&&Qt(Y,null,X,"unmounted")},q)},B=Y=>{const{type:X,el:q,anchor:re,transition:te}=Y;if(X===gt){V(q,re);return}if(X===Kn){O(Y);return}const ne=()=>{t(q),te&&!te.persisted&&te.afterLeave&&te.afterLeave()};if(Y.shapeFlag&1&&te&&!te.persisted){const{leave:K,delayLeave:H}=te,z=()=>K(q,ne);H?H(Y.el,ne,z):z()}else ne()},V=(Y,X)=>{let q;for(;Y!==X;)q=M(Y),t(Y),Y=q;t(X)},W=(Y,X,q)=>{const{bum:re,scope:te,job:ne,subTree:K,um:H,m:z,a:J}=Y;ea(z),ea(J),re&&kn(re),te.stop(),ne&&(ne.flags|=8,P(K,Y,X,q)),H&&Je(H,X),Je(()=>{Y.isUnmounted=!0},X)},j=(Y,X,q,re=!1,te=!1,ne=0)=>{for(let K=ne;K<Y.length;K++)P(Y[K],X,q,re,te)},$=Y=>{if(Y.shapeFlag&6)return $(Y.component.subTree);if(Y.shapeFlag&128)return Y.suspense.next();const X=M(Y.anchor||Y.el),q=X&&X[pl];return q?M(q):X};let Q=!1;const Z=(Y,X,q)=>{let re;Y==null?X._vnode&&(P(X._vnode,null,null,!0),re=X._vnode.component):I(X._vnode||null,Y,X,null,null,null,q),X._vnode=Y,Q||(Q=!0,Yi(re),us(),Q=!1)},ee={p:I,um:P,m:b,r:B,mt:v,mc:l,pc:A,pbc:d,n:$,o:e};return{render:Z,hydrate:void 0,createApp:Bl(Z)}}function Un({type:e,props:n},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:i}function Zt({effect:e,job:n},i){i?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function ql(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function Is(e,n,i=!1){const r=e.children,t=n.children;if(ge(r)&&ge(t))for(let f=0;f<r.length;f++){const S=r[f];let L=t[f];L.shapeFlag&1&&!L.dynamicChildren&&((L.patchFlag<=0||L.patchFlag===32)&&(L=t[f]=wt(t[f]),L.el=S.el),!i&&L.patchFlag!==-2&&Is(S,L)),L.type===Sn&&(L.patchFlag!==-1?L.el=S.el:L.__elIndex=f+(e.type===gt?1:0)),L.type===Ut&&!L.el&&(L.el=S.el)}}function eu(e){const n=e.slice(),i=[0];let r,t,f,S,L;const h=e.length;for(r=0;r<h;r++){const F=e[r];if(F!==0){if(t=i[i.length-1],e[t]<F){n[r]=t,i.push(r);continue}for(f=0,S=i.length-1;f<S;)L=f+S>>1,e[i[L]]<F?f=L+1:S=L;F<e[i[f]]&&(f>0&&(n[r]=i[f-1]),i[f]=r)}}for(f=i.length,S=i[f-1];f-- >0;)i[f]=S,S=n[S];return i}function Rs(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:Rs(n)}function ea(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}function ks(e){if(e.placeholder)return e.placeholder;const n=e.component;return n?ks(n.subTree):null}const Ms=e=>e.__isSuspense;function tu(e,n){n&&n.pendingBranch?ge(e)?n.effects.push(...e):n.effects.push(e):ol(e)}const gt=Symbol.for("v-fgt"),Sn=Symbol.for("v-txt"),Ut=Symbol.for("v-cmt"),Kn=Symbol.for("v-stc"),wr=[];let qe=null;function gr(e=!1){wr.push(qe=e?null:[])}function ru(){wr.pop(),qe=wr[wr.length-1]||null}let Vr=1;function ta(e,n=!1){Vr+=e,e<0&&qe&&n&&(qe.hasOnce=!0)}function ws(e){return e.dynamicChildren=Vr>0?qe||fr:null,ru(),Vr>0&&qe&&qe.push(e),e}function Nr(e,n,i,r,t,f){return ws(ct(e,n,i,r,t,f,!0))}function nu(e,n,i,r,t){return ws(ft(e,n,i,r,t,!0))}function Ns(e){return e?e.__v_isVNode===!0:!1}function xr(e,n){return e.type===n.type&&e.key===n.key}const Fs=({key:e})=>e??null,an=({ref:e,ref_key:n,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Ue(e)||Ge(e)||ye(e)?{i:yt,r:e,k:n,f:!!i}:e:null);function ct(e,n=null,i=null,r=0,t=null,f=e===gt?0:1,S=!1,L=!1){const h={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&Fs(n),ref:n&&an(n),scopeId:_n,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:r,dynamicProps:t,dynamicChildren:null,appContext:null,ctx:yt};return L?(wi(h,i),f&128&&e.normalize(h)):i&&(h.shapeFlag|=Ue(i)?8:16),Vr>0&&!S&&qe&&(h.patchFlag>0||f&6)&&h.patchFlag!==32&&qe.push(h),h}const ft=iu;function iu(e,n=null,i=null,r=0,t=null,f=!1){if((!e||e===Ol)&&(e=Ut),Ns(e)){const L=yr(e,n,!0);return i&&wi(L,i),Vr>0&&!f&&qe&&(L.shapeFlag&6?qe[qe.indexOf(e)]=L:qe.push(L)),L.patchFlag=-2,L}if(gu(e)&&(e=e.__vccOpts),n){n=au(n);let{class:L,style:h}=n;L&&!Ue(L)&&(n.class=_i(L)),ke(h)&&(Di(h)&&!ge(h)&&(h=We({},h)),n.style=Fr(h))}const S=Ue(e)?1:Ms(e)?128:ml(e)?64:ke(e)?4:ye(e)?2:0;return ct(e,n,i,r,t,S,f,!0)}function au(e){return e?Di(e)||xs(e)?We({},e):e:null}function yr(e,n,i=!1,r=!1){const{props:t,ref:f,patchFlag:S,children:L,transition:h}=e,F=n?ou(t||{},n):t,T={__v_isVNode:!0,__v_skip:!0,type:e.type,props:F,key:F&&Fs(F),ref:n&&n.ref?i&&f?ge(f)?f.concat(an(n)):[f,an(n)]:an(n):f,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:L,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==gt?S===-1?16:S|16:S,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:h,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&yr(e.ssContent),ssFallback:e.ssFallback&&yr(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return h&&r&&Ii(T,h.clone(T)),T}function su(e=" ",n=0){return ft(Sn,null,e,n)}function ra(e="",n=!1){return n?(gr(),nu(Ut,null,e)):ft(Ut,null,e)}function pt(e){return e==null||typeof e=="boolean"?ft(Ut):ge(e)?ft(gt,null,e.slice()):Ns(e)?wt(e):ft(Sn,null,String(e))}function wt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:yr(e)}function wi(e,n){let i=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(ge(n))i=16;else if(typeof n=="object")if(r&65){const t=n.default;t&&(t._c&&(t._d=!1),wi(e,t()),t._c&&(t._d=!0));return}else{i=32;const t=n._;!t&&!xs(n)?n._ctx=yt:t===3&&yt&&(yt.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else ye(n)?(n={default:n,_ctx:yt},i=32):(n=String(n),r&64?(i=16,n=[su(n)]):i=8);e.children=n,e.shapeFlag|=i}function ou(...e){const n={};for(let i=0;i<e.length;i++){const r=e[i];for(const t in r)if(t==="class")n.class!==r.class&&(n.class=_i([n.class,r.class]));else if(t==="style")n.style=Fr([n.style,r.style]);else if(vn(t)){const f=n[t],S=r[t];S&&f!==S&&!(ge(f)&&f.includes(S))&&(n[t]=f?[].concat(f,S):S)}else t!==""&&(n[t]=r[t])}return n}function ht(e,n,i,r=null){_t(e,n,7,[i,r])}const lu=As();let uu=0;function cu(e,n,i){const r=e.type,t=(n?n.appContext:e.appContext)||lu,f={uid:uu++,vnode:e,type:r,parent:n,appContext:t,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Co(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(t.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ls(r,t),emitsOptions:Ts(r,t),emit:null,emitted:null,propsDefaults:be,inheritAttrs:r.inheritAttrs,ctx:be,data:be,props:be,attrs:be,slots:be,refs:be,setupState:be,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=n?n.root:f,f.emit=Ul.bind(null,f),e.ce&&e.ce(f),f}let $e=null;const Bs=()=>$e||yt;let hn,ai;{const e=mn(),n=(i,r)=>{let t;return(t=e[i])||(t=e[i]=[]),t.push(r),f=>{t.length>1?t.forEach(S=>S(f)):t[0](f)}};hn=n("__VUE_INSTANCE_SETTERS__",i=>$e=i),ai=n("__VUE_SSR_SETTERS__",i=>Gr=i)}const $r=e=>{const n=$e;return hn(e),e.scope.on(),()=>{e.scope.off(),hn(n)}},na=()=>{$e&&$e.scope.off(),hn(null)};function Us(e){return e.vnode.shapeFlag&4}let Gr=!1;function fu(e,n=!1,i=!1){n&&ai(n);const{props:r,children:t}=e.vnode,f=Us(e);jl(e,r,f,n),Xl(e,t,i||n);const S=f?du(e,n):void 0;return n&&ai(!1),S}function du(e,n){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Pl);const{setup:r}=i;if(r){Ot();const t=e.setupContext=r.length>1?vu(e):null,f=$r(e),S=Yr(r,e,0,[e.props,t]),L=Va(S);if(Pt(),f(),(L||e.sp)&&!kr(e)&&ds(e),L){if(S.then(na,na),n)return S.then(h=>{ia(e,h)}).catch(h=>{An(h,e,0)});e.asyncDep=S}else ia(e,S)}else Ks(e)}function ia(e,n,i){ye(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:ke(n)&&(e.setupState=ss(n)),Ks(e)}function Ks(e,n,i){const r=e.type;e.render||(e.render=r.render||Et);{const t=$r(e);Ot();try{Rl(e)}finally{Pt(),t()}}}const hu={get(e,n){return Ve(e,"get",""),e[n]}};function vu(e){const n=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,hu),slots:e.slots,emit:e.emit,expose:n}}function Ni(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(ss($o(e.exposed)),{get(n,i){if(i in n)return n[i];if(i in Mr)return Mr[i](e)},has(n,i){return i in n||i in Mr}})):e.proxy}function gu(e){return ye(e)&&"__vccOpts"in e}const pu=(e,n)=>tl(e,n,Gr),mu="3.5.26";let si;const aa=typeof window<"u"&&window.trustedTypes;if(aa)try{si=aa.createPolicy("vue",{createHTML:e=>e})}catch{}const Ws=si?e=>si.createHTML(e):e=>e,yu="http://www.w3.org/2000/svg",Eu="http://www.w3.org/1998/Math/MathML",xt=typeof document<"u"?document:null,sa=xt&&xt.createElement("template"),Au={insert:(e,n,i)=>{n.insertBefore(e,i||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,i,r)=>{const t=n==="svg"?xt.createElementNS(yu,e):n==="mathml"?xt.createElementNS(Eu,e):i?xt.createElement(e,{is:i}):xt.createElement(e);return e==="select"&&r&&r.multiple!=null&&t.setAttribute("multiple",r.multiple),t},createText:e=>xt.createTextNode(e),createComment:e=>xt.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>xt.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,i,r,t,f){const S=i?i.previousSibling:n.lastChild;if(t&&(t===f||t.nextSibling))for(;n.insertBefore(t.cloneNode(!0),i),!(t===f||!(t=t.nextSibling)););else{sa.innerHTML=Ws(r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e);const L=sa.content;if(r==="svg"||r==="mathml"){const h=L.firstChild;for(;h.firstChild;)L.appendChild(h.firstChild);L.removeChild(h)}n.insertBefore(L,i)}return[S?S.nextSibling:n.firstChild,i?i.previousSibling:n.lastChild]}},_u=Symbol("_vtc");function Tu(e,n,i){const r=e[_u];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):i?e.setAttribute("class",n):e.className=n}const oa=Symbol("_vod"),bu=Symbol("_vsh"),Su=Symbol(""),xu=/(?:^|;)\s*display\s*:/;function Cu(e,n,i){const r=e.style,t=Ue(i);let f=!1;if(i&&!t){if(n)if(Ue(n))for(const S of n.split(";")){const L=S.slice(0,S.indexOf(":")).trim();i[L]==null&&sn(r,L,"")}else for(const S in n)i[S]==null&&sn(r,S,"");for(const S in i)S==="display"&&(f=!0),sn(r,S,i[S])}else if(t){if(n!==i){const S=r[Su];S&&(i+=";"+S),r.cssText=i,f=xu.test(i)}}else n&&e.removeAttribute("style");oa in e&&(e[oa]=f?r.display:"",e[bu]&&(r.display="none"))}const la=/\s*!important$/;function sn(e,n,i){if(ge(i))i.forEach(r=>sn(e,n,r));else if(i==null&&(i=""),n.startsWith("--"))e.setProperty(n,i);else{const r=Lu(e,n);la.test(i)?e.setProperty(Vt(r),i.replace(la,""),"important"):e[r]=i}}const ua=["Webkit","Moz","ms"],Wn={};function Lu(e,n){const i=Wn[n];if(i)return i;let r=Dt(n);if(r!=="filter"&&r in e)return Wn[n]=r;r=Ga(r);for(let t=0;t<ua.length;t++){const f=ua[t]+r;if(f in e)return Wn[n]=f}return n}const ca="http://www.w3.org/1999/xlink";function fa(e,n,i,r,t,f=xo(n)){r&&n.startsWith("xlink:")?i==null?e.removeAttributeNS(ca,n.slice(6,n.length)):e.setAttributeNS(ca,n,i):i==null||f&&!ja(i)?e.removeAttribute(n):e.setAttribute(n,f?"":_r(i)?String(i):i)}function da(e,n,i,r,t){if(n==="innerHTML"||n==="textContent"){i!=null&&(e[n]=n==="innerHTML"?Ws(i):i);return}const f=e.tagName;if(n==="value"&&f!=="PROGRESS"&&!f.includes("-")){const L=f==="OPTION"?e.getAttribute("value")||"":e.value,h=i==null?e.type==="checkbox"?"on":"":String(i);(L!==h||!("_value"in e))&&(e.value=h),i==null&&e.removeAttribute(n),e._value=i;return}let S=!1;if(i===""||i==null){const L=typeof e[n];L==="boolean"?i=ja(i):i==null&&L==="string"?(i="",S=!0):L==="number"&&(i=0,S=!0)}try{e[n]=i}catch{}S&&e.removeAttribute(t||n)}function Du(e,n,i,r){e.addEventListener(n,i,r)}function Ou(e,n,i,r){e.removeEventListener(n,i,r)}const ha=Symbol("_vei");function Pu(e,n,i,r,t=null){const f=e[ha]||(e[ha]={}),S=f[n];if(r&&S)S.value=r;else{const[L,h]=Iu(n);if(r){const F=f[n]=Mu(r,t);Du(e,L,F,h)}else S&&(Ou(e,L,S,h),f[n]=void 0)}}const va=/(?:Once|Passive|Capture)$/;function Iu(e){let n;if(va.test(e)){n={};let r;for(;r=e.match(va);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Vt(e.slice(2)),n]}let Vn=0;const Ru=Promise.resolve(),ku=()=>Vn||(Ru.then(()=>Vn=0),Vn=Date.now());function Mu(e,n){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;_t(wu(r,i.value),n,5,[r])};return i.value=e,i.attached=ku(),i}function wu(e,n){if(ge(n)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},n.map(r=>t=>!t._stopped&&r&&r(t))}else return n}const ga=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Nu=(e,n,i,r,t,f)=>{const S=t==="svg";n==="class"?Tu(e,r,S):n==="style"?Cu(e,i,r):vn(n)?yi(n)||Pu(e,n,i,r,f):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):Fu(e,n,r,S))?(da(e,n,r),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&fa(e,n,r,S,f,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!Ue(r))?da(e,Dt(n),r,f,n):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),fa(e,n,r,S))};function Fu(e,n,i,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&ga(n)&&ye(i));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="autocorrect"||n==="sandbox"&&e.tagName==="IFRAME"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const t=e.tagName;if(t==="IMG"||t==="VIDEO"||t==="CANVAS"||t==="SOURCE")return!1}return ga(n)&&Ue(i)?!1:n in e}const Bu=We({patchProp:Nu},Au);let pa;function Uu(){return pa||(pa=Zl(Bu))}const Ku=((...e)=>{const n=Uu().createApp(...e),{mount:i}=n;return n.mount=r=>{const t=Vu(r);if(!t)return;const f=n._component;!ye(f)&&!f.render&&!f.template&&(f.template=t.innerHTML),t.nodeType===1&&(t.textContent="");const S=i(t,!1,Wu(t));return t instanceof Element&&(t.removeAttribute("v-cloak"),t.setAttribute("data-v-app","")),S},n});function Wu(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Vu(e){return Ue(e)?document.querySelector(e):e}const Gu=Ri({name:"VGithubIcon",props:{url:{type:String,required:!0,default:""},position:{type:String,required:!1,default:"top-right"},bgColor:{type:String,required:!1,default:"#FFFFFF"},fillColor:{type:String,required:!1,default:"#151513"}}}),Hu=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},Tr=e=>(ll("data-v-6c7dc248"),e=e(),ul(),e),ju=["href"],Yu=Tr(()=>ct("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),$u=Tr(()=>ct("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),zu=Tr(()=>ct("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),Xu=[Yu,$u,zu],Qu=Tr(()=>ct("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),Zu=Tr(()=>ct("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),Ju=Tr(()=>ct("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),qu=[Qu,Zu,Ju];function ec(e,n,i,r,t,f){return gr(),Nr("a",{href:e.url,class:"github-corner","aria-label":"View source on GitHub",target:"_blank",rel:"noopener noreferrer"},[e.position==="top-left"?(gr(),Nr("svg",{key:0,width:"80",height:"80",viewBox:"0 0 250 250",style:Fr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",left:"0",transform:"scale(-1, 1)"}]),"aria-hidden":"true"},Xu,4)):ra("",!0),e.position==="top-right"?(gr(),Nr("svg",{key:1,width:"80",height:"80",viewBox:"0 0 250 250",style:Fr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",right:"0"}]),"aria-hidden":"true"},qu,4)):ra("",!0)],8,ju)}const tc=Hu(Gu,[["render",ec],["__scopeId","data-v-6c7dc248"]]);function ma(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function qr(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?ma(Object(i),!0).forEach(function(r){rc(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ma(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Er(e){"@babel/helpers - typeof";return Er=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Er(e)}function Se(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ya(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,n,i){return n&&ya(e.prototype,n),i&&ya(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function rc(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Fe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&oi(e,n)}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Lt(e)}function oi(e,n){return oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},oi(e,n)}function nc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ic(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xn(e)}function Be(e){var n=nc();return function(){var r=Lt(e),t;if(n){var f=Lt(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return ic(this,t)}}function ac(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=Lt(e),e!==null););return e}function tr(){return typeof Reflect<"u"&&Reflect.get?tr=Reflect.get.bind():tr=function(n,i,r){var t=ac(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},tr.apply(this,arguments)}function li(e,n){return oc(e)||uc(e,n)||Fi(e,n)||fc()}function pr(e){return sc(e)||lc(e)||Fi(e)||cc()}function sc(e){if(Array.isArray(e))return ui(e)}function oc(e){if(Array.isArray(e))return e}function lc(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uc(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var r=[],t=!0,f=!1,S,L;try{for(i=i.call(e);!(t=(S=i.next()).done)&&(r.push(S.value),!(n&&r.length===n));t=!0);}catch(h){f=!0,L=h}finally{try{!t&&i.return!=null&&i.return()}finally{if(f)throw L}}return r}}function Fi(e,n){if(e){if(typeof e=="string")return ui(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ui(e,n)}}function ui(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function cc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vs(e,n){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Fi(e))||n){i&&(e=i);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(h){throw h},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=!0,S=!1,L;return{s:function(){i=i.call(e)},n:function(){var h=i.next();return f=h.done,h},e:function(h){S=!0,L=h},f:function(){try{!f&&i.return!=null&&i.return()}finally{if(S)throw L}}}}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],f=0;f<r;){var S=i[f];if(n.call(t,S,f,i))return S;f++}}});Object.entries||(Object.entries=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=[n[i],e[n[i]]];return r});Object.values||(Object.values=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=e[n[i]];return r});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n,i){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),t=1;t<arguments.length;t++){var f=arguments[t];if(f!=null)for(var S in f)Object.prototype.hasOwnProperty.call(f,S)&&(r[S]=f[S])}return r},writable:!0,configurable:!0});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],f=0;f<r;){var S=i[f];if(n.call(t,S,f,i))return f;f++}return-1},configurable:!0,writable:!0});var dc="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",hc={mp4:dc},Gt=(function(){var e,n,i,r,t=[],f=t.concat,S=t.filter,L=t.slice,h=window.document,F={},T={},N={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},M=/^\s*<(\w+|!)[^>]*>/,U=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,I=/^(?:body|html)$/i,k=/([A-Z])/g,x=["val","css","html","text","data","width","height","offset"],D=["after","prepend","before","append"],R=h.createElement("table"),O=h.createElement("tr"),C={tr:h.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:O,th:O,"*":h.createElement("div")},E=/complete|loaded|interactive/,u=/^[\w-]*$/,l={},c=l.toString,d={},o,a,s=h.createElement("div"),v={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},m=Array.isArray||function(K){return K instanceof Array};d.matches=function(K,H){if(!H||!K||K.nodeType!==1)return!1;var z=K.matches||K.webkitMatchesSelector||K.mozMatchesSelector||K.oMatchesSelector||K.matchesSelector;if(z)return z.call(K,H);var J,ae=K.parentNode,ie=!ae;return ie&&(ae=s).appendChild(K),J=~d.qsa(ae,H).indexOf(K),ie&&s.removeChild(K),J};function _(K){return K==null?String(K):l[c.call(K)]||"object"}function g(K){return _(K)=="function"}function A(K){return K!=null&&K==K.window}function y(K){return K!=null&&K.nodeType==K.DOCUMENT_NODE}function p(K){return _(K)=="object"}function b(K){return p(K)&&!A(K)&&Object.getPrototypeOf(K)==Object.prototype}function P(K){var H=!!K&&"length"in K&&K.length,z=i.type(K);return z!="function"&&!A(K)&&(z=="array"||H===0||typeof H=="number"&&H>0&&H-1 in K)}function B(K){return S.call(K,function(H){return H!=null})}function V(K){return K.length>0?i.fn.concat.apply([],K):K}o=function(K){return K.replace(/-+(.)?/g,function(H,z){return z?z.toUpperCase():""})};function W(K){return K.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}a=function(K){return S.call(K,function(H,z){return K.indexOf(H)==z})};function j(K){return K in T?T[K]:T[K]=new RegExp("(^|\\s)"+K+"(\\s|$)")}function $(K,H){return typeof H=="number"&&!N[W(K)]?H+"px":H}function Q(K){var H,z;return F[K]||(H=h.createElement(K),h.body.appendChild(H),z=getComputedStyle(H,"").getPropertyValue("display"),H.parentNode.removeChild(H),z=="none"&&(z="block"),F[K]=z),F[K]}function Z(K){return"children"in K?L.call(K.children):i.map(K.childNodes,function(H){if(H.nodeType==1)return H})}function ee(K,H){var z,J=K?K.length:0;for(z=0;z<J;z++)this[z]=K[z];this.length=J,this.selector=H||""}d.fragment=function(K,H,z){var J,ae,ie;return U.test(K)&&(J=i(h.createElement(RegExp.$1))),J||(K.replace&&(K=K.replace(w,"<$1></$2>")),H===e&&(H=M.test(K)&&RegExp.$1),H in C||(H="*"),ie=C[H],ie.innerHTML=""+K,J=i.each(L.call(ie.childNodes),function(){ie.removeChild(this)})),b(z)&&(ae=i(J),i.each(z,function(le,oe){x.indexOf(le)>-1?ae[le](oe):ae.attr(le,oe)})),J},d.Z=function(K,H){return new ee(K,H)},d.isZ=function(K){return K instanceof d.Z},d.init=function(K,H){var z;if(K)if(typeof K=="string")if(K=K.trim(),K[0]=="<"&&M.test(K))z=d.fragment(K,RegExp.$1,H),K=null;else{if(H!==e)return i(H).find(K);z=d.qsa(h,K)}else{if(g(K))return i(h).ready(K);if(d.isZ(K))return K;if(m(K))z=B(K);else if(p(K))z=[K],K=null;else if(M.test(K))z=d.fragment(K.trim(),RegExp.$1,H),K=null;else{if(H!==e)return i(H).find(K);z=d.qsa(h,K)}}else return d.Z();return d.Z(z,K)},i=function(K,H){return d.init(K,H)};function se(K,H,z){for(n in H)z&&(b(H[n])||m(H[n]))?(b(H[n])&&!b(K[n])&&(K[n]={}),m(H[n])&&!m(K[n])&&(K[n]=[]),se(K[n],H[n],z)):H[n]!==e&&(K[n]=H[n])}i.extend=function(K){var H,z=L.call(arguments,1);return typeof K=="boolean"&&(H=K,K=z.shift()),z.forEach(function(J){se(K,J,H)}),K},d.qsa=function(K,H){var z,J=H[0]=="#",ae=!J&&H[0]==".",ie=J||ae?H.slice(1):H,le=u.test(ie);return K.getElementById&&le&&J?(z=K.getElementById(ie))?[z]:[]:K.nodeType!==1&&K.nodeType!==9&&K.nodeType!==11?[]:L.call(le&&!J&&K.getElementsByClassName?ae?K.getElementsByClassName(ie):K.getElementsByTagName(H):K.querySelectorAll(H))};function Y(K,H){return H==null?i(K):i(K).filter(H)}i.contains=h.documentElement.contains?function(K,H){return K!==H&&K.contains(H)}:function(K,H){for(;H&&(H=H.parentNode);)if(H===K)return!0;return!1};function X(K,H,z,J){return g(H)?H.call(K,z,J):H}function q(K,H,z){z==null?K.removeAttribute(H):K.setAttribute(H,z)}function re(K,H){var z=K.className||"",J=z&&z.baseVal!==e;if(H===e)return J?z.baseVal:z;J?z.baseVal=H:K.className=H}function te(K){try{return K&&(K=="true"||(K=="false"?!1:K=="null"?null:+K+""==K?+K:/^[\[\{]/.test(K)?i.parseJSON(K):K))}catch{return K}}i.type=_,i.isFunction=g,i.isWindow=A,i.isArray=m,i.isPlainObject=b,i.isEmptyObject=function(K){var H;for(H in K)return!1;return!0},i.isNumeric=function(K){var H=Number(K),z=typeof K;return K!=null&&z!="boolean"&&(z!="string"||K.length)&&!isNaN(H)&&isFinite(H)||!1},i.inArray=function(K,H,z){return t.indexOf.call(H,K,z)},i.camelCase=o,i.trim=function(K){return K==null?"":String.prototype.trim.call(K)},i.uuid=0,i.support={},i.expr={},i.noop=function(){},i.map=function(K,H){var z,J=[],ae,ie;if(P(K))for(ae=0;ae<K.length;ae++)z=H(K[ae],ae),z!=null&&J.push(z);else for(ie in K)z=H(K[ie],ie),z!=null&&J.push(z);return V(J)},i.each=function(K,H){var z,J;if(P(K)){for(z=0;z<K.length;z++)if(H.call(K[z],z,K[z])===!1)return K}else for(J in K)if(H.call(K[J],J,K[J])===!1)return K;return K},i.grep=function(K,H){return S.call(K,H)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(K,H){l["[object "+H+"]"]=H.toLowerCase()}),i.fn={constructor:d.Z,length:0,forEach:t.forEach,reduce:t.reduce,push:t.push,sort:t.sort,splice:t.splice,indexOf:t.indexOf,concat:function(){var K,H,z=[];for(K=0;K<arguments.length;K++)H=arguments[K],z[K]=d.isZ(H)?H.toArray():H;return f.apply(d.isZ(this)?this.toArray():this,z)},map:function(K){return i(i.map(this,function(H,z){return K.call(H,z,H)}))},slice:function(){return i(L.apply(this,arguments))},ready:function(K){return E.test(h.readyState)&&h.body?K(i):h.addEventListener("DOMContentLoaded",function(){K(i)},!1),this},get:function(K){return K===e?L.call(this):this[K>=0?K:K+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(K){return t.every.call(this,function(H,z){return K.call(H,z,H)!==!1}),this},filter:function(K){return g(K)?this.not(this.not(K)):i(S.call(this,function(H){return d.matches(H,K)}))},add:function(K,H){return i(a(this.concat(i(K,H))))},is:function(K){return this.length>0&&d.matches(this[0],K)},not:function(K){var H=[];if(g(K)&&K.call!==e)this.each(function(J){K.call(this,J)||H.push(this)});else{var z=typeof K=="string"?this.filter(K):P(K)&&g(K.item)?L.call(K):i(K);this.forEach(function(J){z.indexOf(J)<0&&H.push(J)})}return i(H)},has:function(K){return this.filter(function(){return p(K)?i.contains(this,K):i(this).find(K).size()})},eq:function(K){return K===-1?this.slice(K):this.slice(K,+K+1)},first:function(){var K=this[0];return K&&!p(K)?K:i(K)},last:function(){var K=this[this.length-1];return K&&!p(K)?K:i(K)},find:function(K){var H,z=this;return K?typeof K=="object"?H=i(K).filter(function(){var J=this;return t.some.call(z,function(ae){return i.contains(ae,J)})}):this.length==1?H=i(d.qsa(this[0],K)):H=this.map(function(){return d.qsa(this,K)}):H=i(),H},closest:function(K,H){var z=[],J=typeof K=="object"&&i(K);return this.each(function(ae,ie){for(;ie&&!(J?J.indexOf(ie)>=0:d.matches(ie,K));)ie=ie!==H&&!y(ie)&&ie.parentNode;ie&&z.indexOf(ie)<0&&z.push(ie)}),i(z)},parents:function(K){for(var H=[],z=this;z.length>0;)z=i.map(z,function(J){if((J=J.parentNode)&&!y(J)&&H.indexOf(J)<0)return H.push(J),J});return Y(H,K)},parent:function(K){return Y(a(this.pluck("parentNode")),K)},children:function(K){return Y(this.map(function(){return Z(this)}),K)},contents:function(){return this.map(function(){return this.contentDocument||L.call(this.childNodes)})},siblings:function(K){return Y(this.map(function(H,z){return S.call(Z(z.parentNode),function(J){return J!==z})}),K)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(K){return i.map(this,function(H){return H[K]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=Q(this.nodeName))})},replaceWith:function(K){return this.before(K).remove()},wrap:function(K){var H=g(K);if(this[0]&&!H)var z=i(K).get(0),J=z.parentNode||this.length>1;return this.each(function(ae){i(this).wrapAll(H?K.call(this,ae):J?z.cloneNode(!0):z)})},wrapAll:function(K){if(this[0]){i(this[0]).before(K=i(K));for(var H;(H=K.children()).length;)K=H.first();i(K).append(this)}return this},wrapInner:function(K){var H=g(K);return this.each(function(z){var J=i(this),ae=J.contents(),ie=H?K.call(this,z):K;ae.length?ae.wrapAll(ie):J.append(ie)})},unwrap:function(){return this.parent().each(function(){i(this).replaceWith(i(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(K){return this.each(function(){var H=i(this);(K===e?H.css("display")=="none":K)?H.show():H.hide()})},prev:function(K){return i(this.pluck("previousElementSibling")).filter(K||"*")},next:function(K){return i(this.pluck("nextElementSibling")).filter(K||"*")},html:function(K){return 0 in arguments?this.each(function(H){var z=this.innerHTML;i(this).empty().append(X(this,K,H,z))}):0 in this?this[0].innerHTML:null},text:function(K){return 0 in arguments?this.each(function(H){var z=X(this,K,H,this.textContent);this.textContent=z==null?"":""+z}):0 in this?this.pluck("textContent").join(""):null},attr:function(K,H){var z;return typeof K=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&(z=this[0].getAttribute(K))!=null?z:e:this.each(function(J){if(this.nodeType===1)if(p(K))for(n in K)q(this,n,K[n]);else q(this,K,X(this,H,J,this.getAttribute(K)))})},removeAttr:function(K){return this.each(function(){this.nodeType===1&&K.split(" ").forEach(function(H){q(this,H)},this)})},prop:function(K,H){return K=v[K]||K,1 in arguments?this.each(function(z){this[K]=X(this,H,z,this[K])}):this[0]&&this[0][K]},removeProp:function(K){return K=v[K]||K,this.each(function(){delete this[K]})},data:function(K,H){var z="data-"+K.replace(k,"-$1").toLowerCase(),J=1 in arguments?this.attr(z,H):this.attr(z);return J!==null?te(J):e},val:function(K){return 0 in arguments?(K==null&&(K=""),this.each(function(H){this.value=X(this,K,H,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(K){if(K)return this.each(function(z){var J=i(this),ae=X(this,K,z,J.offset()),ie=J.offsetParent().offset(),le={top:ae.top-ie.top,left:ae.left-ie.left};J.css("position")=="static"&&(le.position="relative"),J.css(le)});if(!this.length)return null;if(h.documentElement!==this[0]&&!i.contains(h.documentElement,this[0]))return{top:0,left:0};var H=this[0].getBoundingClientRect();return{left:H.left+window.pageXOffset,top:H.top+window.pageYOffset,width:Math.round(H.width),height:Math.round(H.height)}},css:function(K,H){if(arguments.length<2){var z=this[0];if(typeof K=="string")return z?z.style[o(K)]||getComputedStyle(z,"").getPropertyValue(K):void 0;if(m(K)){if(!z)return;var J={},ae=getComputedStyle(z,"");return i.each(K,function(le,oe){J[oe]=z.style[o(oe)]||ae.getPropertyValue(oe)}),J}}var ie="";if(_(K)=="string")!H&&H!==0?this.each(function(){this.style.removeProperty(W(K))}):ie=W(K)+":"+$(K,H);else for(n in K)!K[n]&&K[n]!==0?this.each(function(){this.style.removeProperty(W(n))}):ie+=W(n)+":"+$(n,K[n])+";";return this.each(function(){this.style.cssText+=";"+ie})},index:function(K){return K?this.indexOf(i(K)[0]):this.parent().children().indexOf(this[0])},hasClass:function(K){return K?t.some.call(this,function(H){return this.test(re(H))},j(K)):!1},addClass:function(K){return K?this.each(function(H){if("className"in this){r=[];var z=re(this),J=X(this,K,H,z);J.split(/\s+/g).forEach(function(ae){i(this).hasClass(ae)||r.push(ae)},this),r.length&&re(this,z+(z?" ":"")+r.join(" "))}}):this},removeClass:function(K){return this.each(function(H){if("className"in this){if(K===e)return re(this,"");r=re(this),X(this,K,H,r).split(/\s+/g).forEach(function(z){r=r.replace(j(z)," ")}),re(this,r.trim())}})},toggleClass:function(K,H){return K?this.each(function(z){var J=i(this),ae=X(this,K,z,re(this));ae.split(/\s+/g).forEach(function(ie){(H===e?!J.hasClass(ie):H)?J.addClass(ie):J.removeClass(ie)})}):this},scrollTop:function(K){if(this.length){var H="scrollTop"in this[0];return K===e?H?this[0].scrollTop:this[0].pageYOffset:this.each(H?function(){this.scrollTop=K}:function(){this.scrollTo(this.scrollX,K)})}},scrollLeft:function(K){if(this.length){var H="scrollLeft"in this[0];return K===e?H?this[0].scrollLeft:this[0].pageXOffset:this.each(H?function(){this.scrollLeft=K}:function(){this.scrollTo(K,this.scrollY)})}},position:function(){if(this.length){var K=this[0],H=this.offsetParent(),z=this.offset(),J=I.test(H[0].nodeName)?{top:0,left:0}:H.offset();return z.top-=parseFloat(i(K).css("margin-top"))||0,z.left-=parseFloat(i(K).css("margin-left"))||0,J.top+=parseFloat(i(H[0]).css("border-top-width"))||0,J.left+=parseFloat(i(H[0]).css("border-left-width"))||0,{top:z.top-J.top,left:z.left-J.left}}},offsetParent:function(){return this.map(function(){for(var K=this.offsetParent||h.body;K&&!I.test(K.nodeName)&&i(K).css("position")=="static";)K=K.offsetParent;return K})}},i.fn.detach=i.fn.remove,["width","height"].forEach(function(K){var H=K.replace(/./,function(z){return z[0].toUpperCase()});i.fn[K]=function(z){var J,ae=this[0];return z===e?A(ae)?ae["inner"+H]:y(ae)?ae.documentElement["scroll"+H]:(J=this.offset())&&J[K]:this.each(function(ie){ae=i(this),ae.css(K,X(this,z,ie,ae[K]()))})}});function ne(K,H){H(K);for(var z=0,J=K.childNodes.length;z<J;z++)ne(K.childNodes[z],H)}return D.forEach(function(K,H){var z=H%2;i.fn[K]=function(){var J,ae=i.map(arguments,function(oe){var ce=[];return J=_(oe),J=="array"?(oe.forEach(function(he){if(he.nodeType!==e)return ce.push(he);if(i.zepto.isZ(he))return ce=ce.concat(he.get());ce=ce.concat(d.fragment(he))}),ce):J=="object"||oe==null?oe:d.fragment(oe)}),ie,le=this.length>1;return ae.length<1?this:this.each(function(oe,ce){ie=z?ce:ce.parentNode,ce=H==0?ce.nextSibling:H==1?ce.firstChild:H==2?ce:null;var he=i.contains(h.documentElement,ie);ae.forEach(function(de){if(le)de=de.cloneNode(!0);else if(!ie)return i(de).remove();ie.insertBefore(de,ce),he&&ne(de,function(pe){if(pe.nodeName!=null&&pe.nodeName.toUpperCase()==="SCRIPT"&&(!pe.type||pe.type==="text/javascript")&&!pe.src){var Ae=pe.ownerDocument?pe.ownerDocument.defaultView:window;Ae.eval.call(Ae,pe.innerHTML)}})})})},i.fn[z?K+"To":"insert"+(H?"Before":"After")]=function(J){return i(J)[K](this),this}}),d.Z.prototype=ee.prototype=i.fn,d.uniq=a,d.deserializeValue=te,i.zepto=d,i})();window.Zepto=Gt;window.$===void 0&&(window.$=Gt);(function(e){var n=+new Date,i=window.document,r,t,f=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,S=/^(?:text|application)\/javascript/i,L=/^(?:text|application)\/xml/i,h="application/json",F="text/html",T=/^\s*$/,N=i.createElement("a");N.href=window.location.href;function M(a,s,v){var m=e.Event(s);return e(a).trigger(m,v),!m.isDefaultPrevented()}function U(a,s,v,m){if(a.global)return M(s||i,v,m)}e.active=0;function w(a){a.global&&e.active++===0&&U(a,null,"ajaxStart")}function I(a){a.global&&!--e.active&&U(a,null,"ajaxStop")}function k(a,s){var v=s.context;if(s.beforeSend.call(v,a,s)===!1||U(s,v,"ajaxBeforeSend",[a,s])===!1)return!1;U(s,v,"ajaxSend",[a,s])}function x(a,s,v,m){var _=v.context,g="success";v.success.call(_,a,g,s),m&&m.resolveWith(_,[a,g,s]),U(v,_,"ajaxSuccess",[s,v,a]),R(g,s,v)}function D(a,s,v,m,_){var g=m.context;m.error.call(g,v,s,a),_&&_.rejectWith(g,[v,s,a]),U(m,g,"ajaxError",[v,m,a||s]),R(s,v,m)}function R(a,s,v){var m=v.context;v.complete.call(m,s,a),U(v,m,"ajaxComplete",[s,v]),I(v)}function O(a,s,v){if(v.dataFilter==C)return a;var m=v.context;return v.dataFilter.call(m,a,s)}function C(){}e.ajaxJSONP=function(a,s){if(!("type"in a))return e.ajax(a);var v=a.jsonpCallback,m=(e.isFunction(v)?v():v)||"Zepto"+n++,_=i.createElement("script"),g=window[m],A,y=function(P){e(_).triggerHandler("error",P||"abort")},p={abort:y},b;return s&&s.promise(p),e(_).on("load error",function(P,B){clearTimeout(b),e(_).off().remove(),P.type=="error"||!A?D(null,B||"error",p,a,s):x(A[0],p,a,s),window[m]=g,A&&e.isFunction(g)&&g(A[0]),g=A=void 0}),k(p,a)===!1?(y("abort"),p):(window[m]=function(){A=arguments},_.src=a.url.replace(/\?(.+)=\?/,"?$1="+m),i.head.appendChild(_),a.timeout>0&&(b=setTimeout(function(){y("timeout")},a.timeout)),p)},e.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:h,xml:"application/xml, text/xml",html:F,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:C};function E(a){return a&&(a=a.split(";",2)[0]),a&&(a==F?"html":a==h?"json":S.test(a)?"script":L.test(a)&&"xml")||"text"}function u(a,s){return s==""?a:(a+"&"+s).replace(/[&?]{1,2}/,"?")}function l(a){a.processData&&a.data&&e.type(a.data)!="string"&&(a.data=e.param(a.data,a.traditional)),a.data&&(!a.type||a.type.toUpperCase()=="GET"||a.dataType=="jsonp")&&(a.url=u(a.url,a.data),a.data=void 0)}e.ajax=function(a){var s=e.extend({},a||{}),v=e.Deferred&&e.Deferred(),m,_;for(r in e.ajaxSettings)s[r]===void 0&&(s[r]=e.ajaxSettings[r]);w(s),s.crossDomain||(m=i.createElement("a"),m.href=s.url,m.href=m.href,s.crossDomain=N.protocol+"//"+N.host!=m.protocol+"//"+m.host),s.url||(s.url=window.location.toString()),(_=s.url.indexOf("#"))>-1&&(s.url=s.url.slice(0,_)),l(s);var g=s.dataType,A=/\?.+=\?/.test(s.url);if(A&&(g="jsonp"),(s.cache===!1||(!a||a.cache!==!0)&&(g=="script"||g=="jsonp"))&&(s.url=u(s.url,"_="+Date.now())),g=="jsonp")return A||(s.url=u(s.url,s.jsonp?s.jsonp+"=?":s.jsonp===!1?"":"callback=?")),e.ajaxJSONP(s,v);var y=s.accepts[g],p={},b=function($,Q){p[$.toLowerCase()]=[$,Q]},P=/^([\w-]+:)\/\//.test(s.url)?RegExp.$1:window.location.protocol,B=s.xhr(),V=B.setRequestHeader,W;if(v&&v.promise(B),s.crossDomain||b("X-Requested-With","XMLHttpRequest"),b("Accept",y||"*/*"),(y=s.mimeType||y)&&(y.indexOf(",")>-1&&(y=y.split(",",2)[0]),B.overrideMimeType&&B.overrideMimeType(y)),(s.contentType||s.contentType!==!1&&s.data&&s.type.toUpperCase()!="GET")&&b("Content-Type",s.contentType||"application/x-www-form-urlencoded"),s.headers)for(t in s.headers)b(t,s.headers[t]);if(B.setRequestHeader=b,B.onreadystatechange=function(){if(B.readyState==4){B.onreadystatechange=C,clearTimeout(W);var $,Q=!1;if(B.status>=200&&B.status<300||B.status==304||B.status==0&&P=="file:"){if(g=g||E(s.mimeType||B.getResponseHeader("content-type")),B.responseType=="arraybuffer"||B.responseType=="blob")$=B.response;else{$=B.responseText;try{$=O($,g,s),g=="script"?(0,eval)($):g=="xml"?$=B.responseXML:g=="json"&&($=T.test($)?null:e.parseJSON($))}catch(Z){Q=Z}if(Q)return D(Q,"parsererror",B,s,v)}x($,B,s,v)}else D(B.statusText||null,B.status?"error":"abort",B,s,v)}},k(B,s)===!1)return B.abort(),D(null,"abort",B,s,v),B;var j="async"in s?s.async:!0;if(B.open(s.type,s.url,j,s.username,s.password),s.xhrFields)for(t in s.xhrFields)B[t]=s.xhrFields[t];for(t in p)V.apply(B,p[t]);return s.timeout>0&&(W=setTimeout(function(){B.onreadystatechange=C,B.abort(),D(null,"timeout",B,s,v)},s.timeout)),B.send(s.data?s.data:null),B};function c(a,s,v,m){return e.isFunction(s)&&(m=v,v=s,s=void 0),e.isFunction(v)||(m=v,v=void 0),{url:a,data:s,success:v,dataType:m}}e.get=function(){return e.ajax(c.apply(null,arguments))},e.post=function(){var a=c.apply(null,arguments);return a.type="POST",e.ajax(a)},e.getJSON=function(){var a=c.apply(null,arguments);return a.dataType="json",e.ajax(a)},e.fn.load=function(a,s,v){if(!this.length)return this;var m=this,_=a.split(/\s/),g,A=c(a,s,v),y=A.success;return _.length>1&&(A.url=_[0],g=_[1]),A.success=function(p){m.html(g?e("<div>").html(p.replace(f,"")).find(g):p),y&&y.apply(m,arguments)},e.ajax(A),this};var d=encodeURIComponent;function o(a,s,v,m){var _,g=e.isArray(s),A=e.isPlainObject(s);e.each(s,function(y,p){_=e.type(p),m&&(y=v?m:m+"["+(A||_=="object"||_=="array"?y:"")+"]"),!m&&g?a.add(p.name,p.value):_=="array"||!v&&_=="object"?o(a,p,v,y):a.add(y,p)})}e.param=function(a,s){var v=[];return v.add=function(m,_){e.isFunction(_)&&(_=_()),_==null&&(_=""),this.push(d(m)+"="+d(_))},o(v,a,s),v.join("&").replace(/%20/g,"+")}})(Gt);(function(e){e.Callbacks=function(n){n=e.extend({},n);var i,r,t,f,S,L,h=[],F=!n.once&&[],T=function(M){for(i=n.memory&&M,r=!0,L=f||0,f=0,S=h.length,t=!0;h&&L<S;++L)if(h[L].apply(M[0],M[1])===!1&&n.stopOnFalse){i=!1;break}t=!1,h&&(F?F.length&&T(F.shift()):i?h.length=0:N.disable())},N={add:function(){if(h){var M=h.length,U=function(w){e.each(w,function(I,k){typeof k=="function"?(!n.unique||!N.has(k))&&h.push(k):k&&k.length&&typeof k!="string"&&U(k)})};U(arguments),t?S=h.length:i&&(f=M,T(i))}return this},remove:function(){return h&&e.each(arguments,function(M,U){for(var w;(w=e.inArray(U,h,w))>-1;)h.splice(w,1),t&&(w<=S&&--S,w<=L&&--L)}),this},has:function(M){return!!(h&&(M?e.inArray(M,h)>-1:h.length))},empty:function(){return S=h.length=0,this},disable:function(){return h=F=i=void 0,this},disabled:function(){return!h},lock:function(){return F=void 0,i||N.disable(),this},locked:function(){return!F},fireWith:function(M,U){return h&&(!r||F)&&(U=U||[],U=[M,U.slice?U.slice():U],t?F.push(U):T(U)),this},fire:function(){return N.fireWith(this,arguments)},fired:function(){return!!r}};return N}})(Gt);(function(e){var n=Array.prototype.slice;function i(r){var t=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],f="pending",S={state:function(){return f},always:function(){return L.done(arguments).fail(arguments),this},then:function(){var h=arguments;return i(function(F){e.each(t,function(T,N){var M=e.isFunction(h[T])&&h[T];L[N[1]](function(){var U=M&&M.apply(this,arguments);if(U&&e.isFunction(U.promise))U.promise().done(F.resolve).fail(F.reject).progress(F.notify);else{var w=this===S?F.promise():this,I=M?[U]:arguments;F[N[0]+"With"](w,I)}})}),h=null}).promise()},promise:function(h){return h!=null?e.extend(h,S):S}},L={};return e.each(t,function(h,F){var T=F[2],N=F[3];S[F[1]]=T.add,N&&T.add(function(){f=N},t[h^1][2].disable,t[2][2].lock),L[F[0]]=function(){return L[F[0]+"With"](this===L?S:this,arguments),this},L[F[0]+"With"]=T.fireWith}),S.promise(L),r&&r.call(L,L),L}e.when=function(r){var t=n.call(arguments),f=t.length,S=0,L=f!==1||r&&e.isFunction(r.promise)?f:0,h=L===1?r:i(),F,T,N,M=function(U,w,I){return function(k){w[U]=this,I[U]=arguments.length>1?n.call(arguments):k,I===F?h.notifyWith(w,I):--L||h.resolveWith(w,I)}};if(f>1)for(F=new Array(f),T=new Array(f),N=new Array(f);S<f;++S)t[S]&&e.isFunction(t[S].promise)?t[S].promise().done(M(S,N,t)).fail(h.reject).progress(M(S,T,F)):--L;return L||h.resolveWith(N,t),h.promise()},e.Deferred=i})(Gt);(function(e){var n=1,i,r=Array.prototype.slice,t=e.isFunction,f=function(c){return typeof c=="string"},S={},L={},h="onfocusin"in window,F={focus:"focusin",blur:"focusout"},T={mouseenter:"mouseover",mouseleave:"mouseout"};L.click=L.mousedown=L.mouseup=L.mousemove="MouseEvents";function N(c){return c._zid||(c._zid=n++)}function M(c,d,o,a){if(d=U(d),d.ns)var s=w(d.ns);return(S[N(c)]||[]).filter(function(v){return v&&(!d.e||v.e==d.e)&&(!d.ns||s.test(v.ns))&&(!o||N(v.fn)===N(o))&&(!a||v.sel==a)})}function U(c){var d=(""+c).split(".");return{e:d[0],ns:d.slice(1).sort().join(" ")}}function w(c){return new RegExp("(?:^| )"+c.replace(" "," .* ?")+"(?: |$)")}function I(c,d){return c.del&&!h&&c.e in F||!!d}function k(c){return T[c]||h&&F[c]||c}function x(c,d,o,a,s,v,m){var _=N(c),g=S[_]||(S[_]=[]);d.split(/\s/).forEach(function(A){if(A=="ready")return e(document).ready(o);var y=U(A);y.fn=o,y.sel=s,y.e in T&&(o=function(b){var P=b.relatedTarget;if(!P||P!==this&&!e.contains(this,P))return y.fn.apply(this,arguments)}),y.del=v;var p=v||o;y.proxy=function(b){if(b=u(b),!b.isImmediatePropagationStopped()){b.data=a;var P=p.apply(c,b._args==i?[b]:[b].concat(b._args));return P===!1&&(b.preventDefault(),b.stopPropagation()),P}},y.i=g.length,g.push(y),"addEventListener"in c&&c.addEventListener(k(y.e),y.proxy,I(y,m))})}function D(c,d,o,a,s){var v=N(c);(d||"").split(/\s/).forEach(function(m){M(c,m,o,a).forEach(function(_){delete S[v][_.i],"removeEventListener"in c&&c.removeEventListener(k(_.e),_.proxy,I(_,s))})})}e.event={add:x,remove:D},e.proxy=function(c,d){var o=2 in arguments&&r.call(arguments,2);if(t(c)){var a=function(){return c.apply(d,o?o.concat(r.call(arguments)):arguments)};return a._zid=N(c),a}else{if(f(d))return o?(o.unshift(c[d],c),e.proxy.apply(null,o)):e.proxy(c[d],c);throw new TypeError("expected function")}},e.fn.bind=function(c,d,o){return this.on(c,d,o)},e.fn.unbind=function(c,d){return this.off(c,d)},e.fn.one=function(c,d,o,a){return this.on(c,d,o,a,1)};var R=function(){return!0},O=function(){return!1},C=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,E={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function u(c,d){return(d||!c.isDefaultPrevented)&&(d||(d=c),e.each(E,function(o,a){var s=d[o];c[o]=function(){return this[a]=R,s&&s.apply(d,arguments)},c[a]=O}),c.timeStamp||(c.timeStamp=Date.now()),(d.defaultPrevented!==i?d.defaultPrevented:"returnValue"in d?d.returnValue===!1:d.getPreventDefault&&d.getPreventDefault())&&(c.isDefaultPrevented=R)),c}function l(c){var d,o={originalEvent:c};for(d in c)!C.test(d)&&c[d]!==i&&(o[d]=c[d]);return u(o,c)}e.fn.delegate=function(c,d,o){return this.on(d,c,o)},e.fn.undelegate=function(c,d,o){return this.off(d,c,o)},e.fn.live=function(c,d){return e(document.body).delegate(this.selector,c,d),this},e.fn.die=function(c,d){return e(document.body).undelegate(this.selector,c,d),this},e.fn.on=function(c,d,o,a,s){var v,m,_=this;return c&&!f(c)?(e.each(c,function(g,A){_.on(g,d,o,A,s)}),_):(!f(d)&&!t(a)&&a!==!1&&(a=o,o=d,d=i),(a===i||o===!1)&&(a=o,o=i),a===!1&&(a=O),_.each(function(g,A){s&&(v=function(y){return D(A,y.type,a),a.apply(this,arguments)}),d&&(m=function(y){var p,b=e(y.target).closest(d,A).get(0);if(b&&b!==A)return p=e.extend(l(y),{currentTarget:b,liveFired:A}),(v||a).apply(b,[p].concat(r.call(arguments,1)))}),x(A,c,a,o,d,m||v)}))},e.fn.off=function(c,d,o){var a=this;return c&&!f(c)?(e.each(c,function(s,v){a.off(s,d,v)}),a):(!f(d)&&!t(o)&&o!==!1&&(o=d,d=i),o===!1&&(o=O),a.each(function(){D(this,c,o,d)}))},e.fn.trigger=function(c,d){return c=f(c)||e.isPlainObject(c)?e.Event(c):u(c),c._args=d,this.each(function(){c.type in F&&typeof this[c.type]=="function"?this[c.type]():"dispatchEvent"in this?this.dispatchEvent(c):e(this).triggerHandler(c,d)})},e.fn.triggerHandler=function(c,d){var o,a;return this.each(function(s,v){o=l(f(c)?e.Event(c):c),o._args=d,o.target=v,e.each(M(v,c.type||c),function(m,_){if(a=_.proxy(o),o.isImmediatePropagationStopped())return!1})}),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(c){e.fn[c]=function(d){return 0 in arguments?this.bind(c,d):this.trigger(c)}}),e.Event=function(c,d){f(c)||(d=c,c=d.type);var o=document.createEvent(L[c]||"Events"),a=!0;if(d)for(var s in d)s=="bubbles"?a=!!d[s]:o[s]=d[s];return o.initEvent(c,a,!0),u(o)}})(Gt);(function(){try{getComputedStyle(void 0)}catch{var e=getComputedStyle;window.getComputedStyle=function(i,r){try{return e(i,r)}catch{return null}}}})();(function(e){var n=e.zepto,i=n.qsa,r=n.matches;function t(T){return T=e(T),!!(T.width()||T.height())&&T.css("display")!=="none"}var f=e.expr[":"]={visible:function(){if(t(this))return this},hidden:function(){if(!t(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(T){if(T===0)return this},last:function(T,N){if(T===N.length-1)return this},eq:function(T,N,M){if(T===M)return this},contains:function(T,N,M){if(e(this).text().indexOf(M)>-1)return this},has:function(T,N,M){if(n.qsa(this,M).length)return this}},S=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),L=/^\s*>/,h="Zepto"+ +new Date;function F(T,N){T=T.replace(/=#\]/g,'="#"]');var M,U,w=S.exec(T);if(w&&w[2]in f&&(M=f[w[2]],U=w[3],T=w[1],U)){var I=Number(U);isNaN(I)?U=U.replace(/^["']|["']$/g,""):U=I}return N(T,M,U)}n.qsa=function(T,N){return F(N,function(M,U,w){try{var I;!M&&U?M="*":L.test(M)&&(I=e(T).addClass(h),M="."+h+" "+M);var k=i(T,M)}catch(x){throw console.error("error performing selector: %o",N),x}finally{I&&I.removeClass(h)}return U?n.uniq(e.map(k,function(x,D){return U.call(x,D,k,w)})):k})},n.matches=function(T,N){return F(N,function(M,U,w){return(!M||r(T,M))&&(!U||U.call(T,null,w)===T)})}})(Gt);var ve=Gt,vc=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],gc=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],fe={},pc=function(){try{return localStorage.setItem("clappr","clappr"),localStorage.removeItem("clappr"),!0}catch{return!1}},mc=function(){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!n}catch{return!!(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==void 0&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}},yc=function(n){var i=n.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],r;if(/trident/i.test(i[1]))return r=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:parseInt(r[1]||"")};if(i[1]==="Chrome"){if(r=n.match(/\bOPR\/(\d+)/),r!=null)return{name:"Opera",version:parseInt(r[1])};if(r=n.match(/\bEdge\/(\d+)/),r!=null)return{name:"Edge",version:parseInt(r[1])}}else/android/i.test(n)&&(r=n.match(/version\/(\d+)/i))&&(i.splice(1,1,"Android WebView"),i.splice(2,1,r[1]));return i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],{name:i[0],version:parseInt(i[1])}},Ec=function(){var n={},i=fe.userAgent.toLowerCase(),r=Vs(vc),t;try{for(r.s();!(t=r.n()).done;){var f=t.value,S=new RegExp(f.identifier.toLowerCase()),L=S.exec(i);if(L!=null&&L[1]){if(n.name=f.name,n.group=f.group,f.versionIdentifier){var h=new RegExp(f.versionIdentifier.toLowerCase()),F=h.exec(i);F!=null&&F[1]&&Ea(F[1],n)}else Ea(L[1],n);break}}}catch(T){r.e(T)}finally{r.f()}return n},Ea=function(n,i){var r=n.split(".",2);i.fullVersion=n,r[0]&&(i.majorVersion=parseInt(r[0])),r[1]&&(i.minorVersion=parseInt(r[1]))},Ac=function(){var n={},i=fe.userAgent.toLowerCase(),r=Vs(gc),t;try{for(r.s();!(t=r.n()).done;){var f=t.value,S=new RegExp(f.identifier.toLowerCase()),L=S.exec(i);if(L!=null){if(n.name=f.name,n.group=f.group,f.version)Gn(f.version,f.versionSeparator?f.versionSeparator:".",n);else if(L[1])Gn(L[1],f.versionSeparator?f.versionSeparator:".",n);else if(f.versionIdentifier){var h=new RegExp(f.versionIdentifier.toLowerCase()),F=h.exec(i);F!=null&&F[1]&&Gn(F[1],f.versionSeparator?f.versionSeparator:".",n)}break}}}catch(T){r.e(T)}finally{r.f()}return n},Gn=function(n,i,r){var t=i.substr(0,1)=="["?new RegExp(i,"g"):i,f=n.split(t,2);i!="."&&(n=n.replace(new RegExp(i,"g"),".")),r.fullVersion=n,f&&f[0]&&(r.majorVersion=parseInt(f[0])),f&&f[1]&&(r.minorVersion=parseInt(f[1]))},_c=function(){var n={};return n.width=ve(window).width(),n.height=ve(window).height(),n},Tc=function(){switch(window.orientation){case-90:case 90:fe.viewport.orientation="landscape";break;default:fe.viewport.orientation="portrait";break}},bc=function(n){var i=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/,r=i.exec(n),t=r&&(r[1]||r[2])||"";return t},Gs=yc(navigator.userAgent);fe.isEdge=/Edg|EdgiOS|EdgA/i.test(navigator.userAgent);fe.isChrome=/Chrome|CriOS/i.test(navigator.userAgent)&&!fe.isEdge;fe.isSafari=/Safari/i.test(navigator.userAgent)&&!fe.isChrome&&!fe.isEdge;fe.isFirefox=/Firefox/i.test(navigator.userAgent);fe.isLegacyIE=!!window.ActiveXObject;fe.isIE=fe.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent);fe.isIE11=/trident.*rv:11/i.test(navigator.userAgent);fe.isChromecast=fe.isChrome&&/CrKey/i.test(navigator.userAgent);fe.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent);fe.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);fe.isAndroid=/Android/i.test(navigator.userAgent);fe.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent);fe.isWin8App=/MSAppHost/i.test(navigator.userAgent);fe.isWiiU=/WiiU/i.test(navigator.userAgent);fe.isPS4=/PlayStation 4/i.test(navigator.userAgent);fe.hasLocalstorage=pc();fe.hasFlash=mc();fe.name=Gs.name;fe.version=Gs.version;fe.userAgent=navigator.userAgent;fe.data=Ec();fe.os=Ac();fe.isWindows=/^Windows$/i.test(fe.os.group);fe.isMacOS=/^Mac OS$/i.test(fe.os.group);fe.isLinux=/^Linux$/i.test(fe.os.group);fe.viewport=_c();fe.device=bc(fe.userAgent);typeof window.orientation<"u"&&Tc();var Hn={},jn=[],Sc=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window),xc=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Cc(e,n){if(n)for(var i in n){var r=Object.getOwnPropertyDescriptor(n,i);r?Object.defineProperty(e,i,r):e[i]=n[i]}return e}function br(e,n){var i=(function(r){Fe(f,r);var t=Be(f);function f(){var S;Se(this,f);for(var L=arguments.length,h=new Array(L),F=0;F<L;F++)h[F]=arguments[F];return S=t.call.apply(t,[this].concat(h)),n.initialize&&n.initialize.apply(xn(S),h),S}return xe(f)})(e);return Cc(i.prototype,n),i}function Lc(e,n){if(!isFinite(e))return"--:--";e=e*1e3,e=parseInt(e/1e3);var i=e%60;e=parseInt(e/60);var r=e%60;e=parseInt(e/60);var t=e%24,f=parseInt(e/24),S="";return f&&f>0&&(S+=f+":",t<1&&(S+="00:")),(t&&t>0||n)&&(S+=("0"+t).slice(-2)+":"),S+=("0"+r).slice(-2)+":",S+=("0"+i).slice(-2),S.trim()}var Lr={fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function(n){if(n.requestFullscreen)return n.requestFullscreen();if(n.webkitRequestFullscreen){if(typeof n.then=="function")return n.webkitRequestFullscreen();n.webkitRequestFullscreen()}else{if(n.mozRequestFullScreen)return n.mozRequestFullScreen();if(n.msRequestFullscreen)return n.msRequestFullscreen();n.querySelector&&n.querySelector("video")&&n.querySelector("video").webkitEnterFullScreen?n.querySelector("video").webkitEnterFullScreen():n.webkitEnterFullScreen&&n.webkitEnterFullScreen()}},cancelFullscreen:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;n.exitFullscreen?n.exitFullscreen():n.webkitCancelFullScreen?n.webkitCancelFullScreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen()},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},Dc=(function(){function e(){Se(this,e)}return xe(e,null,[{key:"_defaultConfig",value:function(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function(i){try{return this._defaultConfig()[i].parse(this._defaultConfig()[i].value)}catch{return}}},{key:"_createKeyspace",value:function(i){return"clappr.".concat(document.domain,".").concat(i)}},{key:"restore",value:function(i){return fe.hasLocalstorage&&localStorage[this._createKeyspace(i)]?this._defaultConfig()[i].parse(localStorage[this._createKeyspace(i)]):this._defaultValueFor(i)}},{key:"persist",value:function(i,r){if(fe.hasLocalstorage)try{return localStorage[this._createKeyspace(i)]=r,!0}catch{return!1}}}]),e})(),Aa=(function(){function e(){Se(this,e)}return xe(e,null,[{key:"params",get:function(){var i=window.location.search.substring(1);return i!==this.query&&(this._urlParams=this.parse(i),this.query=i),this._urlParams}},{key:"hashParams",get:function(){var i=window.location.hash.substring(1);return i!==this.hash&&(this._hashParams=this.parse(i),this.hash=i),this._hashParams}},{key:"parse",value:function(i){for(var r,t=/\+/g,f=/([^&=]+)=?([^&]*)/g,S=function(F){return decodeURIComponent(F.replace(t," "))},L={};r=f.exec(i);)L[S(r[1]).toLowerCase()]=S(r[2]);return L}}]),e})();function Oc(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"t",n=0,i=Aa.params[e]||Aa.hashParams[e]||"",r=i.match(/[0-9]+[hms]+/g)||[];if(r.length>0){var t={h:3600,m:60,s:1};r.forEach(function(f){if(f){var S=f[f.length-1],L=parseInt(f.slice(0,f.length-1),10);n+=L*t[S]}})}else i&&(n=parseInt(i,10));return n}function Cn(e){Hn[e]||(Hn[e]=0);var n=++Hn[e];return e+n}function ci(e){return e-parseFloat(e)+1>=0}function Pc(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function Ic(){return window.navigator&&window.navigator.language}function Rc(){return window.performance&&window.performance.now?performance.now():Date.now()}function kc(e,n){var i=e.indexOf(n);i>=0&&e.splice(i,1)}function Mc(e,n){return e===void 0||n===void 0?!1:n.find(function(i){return e.toLowerCase()===i.toLowerCase()})!==void 0}function wc(e,n){n=Object.assign({inline:!1,muted:!1,timeout:250,type:"video",source:hc.mp4,element:null},n);var i=n.element?n.element:document.createElement(n.type);i.muted=n.muted,n.muted===!0&&i.setAttribute("muted","muted"),n.inline===!0&&i.setAttribute("playsinline","playsinline"),i.src=n.source;var r=i.play(),t=setTimeout(function(){f(!1,new Error("Timeout ".concat(n.timeout," ms has been reached")))},n.timeout),f=function(L){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;clearTimeout(t),e(L,h)};r!==void 0?r.then(function(){return f(!0)}).catch(function(S){return f(!1,S)}):f(!0)}var Hr=(function(){function e(){Se(this,e)}return xe(e,null,[{key:"configure",value:function(i){this.options=ve.extend(!0,this.options,i)}},{key:"create",value:function(i){return this.options.recycleVideo&&i==="video"&&jn.length>0?jn.shift():document.createElement(i)}},{key:"garbage",value:function(i){!this.options.recycleVideo||i.tagName.toUpperCase()!=="VIDEO"||(ve(i).children().remove(),Object.values(i.attributes).forEach(function(r){return i.removeAttribute(r.name)}),jn.push(i))}}]),e})();Hr.options={recycleVideo:!1};var Nc=(function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:500;Se(this,e),this.delay=n,this.lastTime=0}return xe(e,[{key:"handle",value:function(i,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=new Date().getTime(),S=f-this.lastTime;S<this.delay&&S>0&&(r(),t&&i.preventDefault()),this.lastTime=f}}]),e})(),Ht={Config:Dc,Fullscreen:Lr,extend:br,formatTime:Lc,now:Rc,removeArrayItem:kc,listContainsIgnoreCase:Mc},Ln="font-weight: bold; font-size: 13px;",Fc="color: #006600;"+Ln,Bc="color: #0000ff;"+Ln,Hs="color: #ff8000;"+Ln,_a="color: #ff0000;"+Ln,js=0,fi=1,Ys=2,Bi=3,Uc=Bi,Kc=[Bc,Fc,Hs,_a,_a],Ta=["debug","info","warn","error","disabled"],Ee=(function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fi,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Uc;Se(this,e),this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"],this.level=n,this.previousLevel=this.level,this.offLevel=i}return xe(e,[{key:"level",get:function(){return this._level},set:function(i){this._level=i}},{key:"debug",value:function(i){this.log(i,js,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(i){this.log(i,fi,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(i){this.log(i,Ys,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(i){this.log(i,Bi,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+Ta[this.level],Hs)}},{key:"log",value:function(i,r,t){if(!(this.EXCLUDE_LIST.indexOf(t[0])>=0)&&!(r<this.level)){t||(t=i,i=null);var f=Kc[r],S="";i&&(S="["+i+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+Ta[r]+"]"+S,f].concat(t))}}}]),e})();Ee.LEVEL_DEBUG=js;Ee.LEVEL_INFO=fi;Ee.LEVEL_WARN=Ys;Ee.LEVEL_ERROR=Bi;Ee.getInstance=function(){return this._instance===void 0&&(this._instance=new this),this._instance};Ee.setLevel=function(e){this.getInstance().level=e};Ee.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)};Ee.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)};Ee.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)};Ee.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var Wc=Array.prototype.slice,ba=/\s+/,en=function(n,i,r,t){if(!r)return!0;if(Er(r)==="object"){for(var f in r)n[i].apply(n,[f,r[f]].concat(t));return!1}if(ba.test(r)){for(var S=r.split(ba),L=0,h=S.length;L<h;L++)n[i].apply(n,[S[L]].concat(t));return!1}return!0},Sa=function(n,i,r,t){var f,S=-1,L=n.length,h=i[0],F=i[1],T=i[2];N();function N(){try{switch(i.length){case 0:for(;++S<L;)(f=n[S]).callback.call(f.ctx);return;case 1:for(;++S<L;)(f=n[S]).callback.call(f.ctx,h);return;case 2:for(;++S<L;)(f=n[S]).callback.call(f.ctx,h,F);return;case 3:for(;++S<L;)(f=n[S]).callback.call(f.ctx,h,F,T);return;default:for(;++S<L;)(f=n[S]).callback.apply(f.ctx,i);return}}catch(M){Ee.error.apply(Ee,[r,"error on event",t,"trigger","-",M]),N()}}},G=(function(){function e(){Se(this,e)}return xe(e,[{key:"on",value:function(i,r,t){if(!en(this,"on",i,[r,t])||!r)return this;this._events||(this._events={});var f=this._events[i]||(this._events[i]=[]);return f.push({callback:r,context:t,ctx:t||this}),this}},{key:"once",value:function(i,r,t){var f=this,S;if(!en(this,"once",i,[r,t])||!r)return this;var L=function(){return f.off(i,S)};return S=function(){L(),r.apply(this,arguments)},this.on(i,S,t)}},{key:"off",value:function(i,r,t){var f,S,L,h,F,T,N,M;if(!this._events||!en(this,"off",i,[r,t]))return this;if(!i&&!r&&!t)return this._events=void 0,this;for(h=i?[i]:Object.keys(this._events),F=0,T=h.length;F<T;F++)if(i=h[F],L=this._events[i],L){if(this._events[i]=f=[],r||t)for(N=0,M=L.length;N<M;N++)S=L[N],(r&&r!==S.callback&&r!==S.callback._callback||t&&t!==S.context)&&f.push(S);f.length||delete this._events[i]}return this}},{key:"trigger",value:function(i){var r=this.name||this.constructor.name;if(Ee.debug.apply(Ee,[r].concat(Array.prototype.slice.call(arguments))),!this._events)return this;var t=Wc.call(arguments,1);if(!en(this,"trigger",i,t))return this;var f=this._events[i],S=this._events.all;return f&&Sa(f,t,r,i),S&&Sa(S,arguments,r,i),this}},{key:"stopListening",value:function(i,r,t){var f=this._listeningTo;if(!f)return this;var S=!r&&!t;!t&&Er(r)==="object"&&(t=this),i&&((f={})[i._listenId]=i);for(var L in f)i=f[L],i.off(r,t,this),(S||Object.keys(i._events).length===0)&&delete this._listeningTo[L];return this}}],[{key:"register",value:function(i){e.Custom||(e.Custom={});var r=typeof i=="string"&&i.toUpperCase().trim();r&&!e.Custom[r]?e.Custom[r]=r.toLowerCase().split("_").map(function(t,f){return f===0?t:t=t[0].toUpperCase()+t.slice(1)}).join(""):Ee.error("Events","Error when register event: "+i)}},{key:"listAvailableCustomEvents",value:function(){return e.Custom||(e.Custom={}),Object.keys(e.Custom).filter(function(i){return typeof e.Custom[i]=="string"})}}]),e})(),xa={listenTo:"on",listenToOnce:"once"};Object.keys(xa).forEach(function(e){G.prototype[e]=function(n,i,r){var t=this._listeningTo||(this._listeningTo={}),f=n._listenId||(n._listenId=Cn("l"));return t[f]=n,!r&&Er(i)==="object"&&(r=this),n[xa[e]](i,r,this),this}});G.PLAYER_READY="ready";G.PLAYER_RESIZE="resize";G.PLAYER_FULLSCREEN="fullscreen";G.PLAYER_PLAY="play";G.PLAYER_PAUSE="pause";G.PLAYER_STOP="stop";G.PLAYER_ENDED="ended";G.PLAYER_SEEK="seek";G.PLAYER_ERROR="playererror";G.ERROR="error";G.PLAYER_TIMEUPDATE="timeupdate";G.PLAYER_VOLUMEUPDATE="volumeupdate";G.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable";G.PLAYBACK_PROGRESS="playback:progress";G.PLAYBACK_TIMEUPDATE="playback:timeupdate";G.PLAYBACK_READY="playback:ready";G.PLAYBACK_BUFFERING="playback:buffering";G.PLAYBACK_BUFFERFULL="playback:bufferfull";G.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate";G.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata";G.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate";G.PLAYBACK_BITRATE="playback:bitrate";G.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available";G.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start";G.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end";G.PLAYBACK_PLAYBACKSTATE="playback:playbackstate";G.PLAYBACK_DVR="playback:dvr";G.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable";G.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable";G.PLAYBACK_ENDED="playback:ended";G.PLAYBACK_PLAY_INTENT="playback:play:intent";G.PLAYBACK_PLAY="playback:play";G.PLAYBACK_PAUSE="playback:pause";G.PLAYBACK_SEEK="playback:seek";G.PLAYBACK_SEEKED="playback:seeked";G.PLAYBACK_STOP="playback:stop";G.PLAYBACK_ERROR="playback:error";G.PLAYBACK_STATS_ADD="playback:stats:add";G.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded";G.PLAYBACK_LEVEL_SWITCH="playback:level:switch";G.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available";G.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed";G.PLAYBACK_AUDIO_AVAILABLE="playback:audio:available";G.PLAYBACK_AUDIO_CHANGED="playback:audio:changed";G.CORE_CONTAINERS_CREATED="core:containers:created";G.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed";G.CORE_OPTIONS_CHANGE="core:options:change";G.CORE_READY="core:ready";G.CORE_FULLSCREEN="core:fullscreen";G.CORE_RESIZE="core:resize";G.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed";G.CORE_MOUSE_MOVE="core:mousemove";G.CORE_MOUSE_LEAVE="core:mouseleave";G.CONTAINER_PLAYBACKSTATE="container:playbackstate";G.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr";G.CONTAINER_BITRATE="container:bitrate";G.CONTAINER_STATS_REPORT="container:stats:report";G.CONTAINER_DESTROYED="container:destroyed";G.CONTAINER_READY="container:ready";G.CONTAINER_RESIZE="container:resize";G.CONTAINER_ERROR="container:error";G.CONTAINER_LOADEDMETADATA="container:loadedmetadata";G.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available";G.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed";G.CONTAINER_AUDIO_AVAILABLE="container:audio:available";G.CONTAINER_AUDIO_CHANGED="container:audio:changed";G.CONTAINER_TIMEUPDATE="container:timeupdate";G.CONTAINER_PROGRESS="container:progress";G.CONTAINER_PLAY="container:play";G.CONTAINER_STOP="container:stop";G.CONTAINER_PAUSE="container:pause";G.CONTAINER_ENDED="container:ended";G.CONTAINER_CLICK="container:click";G.CONTAINER_DBLCLICK="container:dblclick";G.CONTAINER_CONTEXTMENU="container:contextmenu";G.CONTAINER_MOUSE_ENTER="container:mouseenter";G.CONTAINER_MOUSE_LEAVE="container:mouseleave";G.CONTAINER_MOUSE_UP="container:mouseup";G.CONTAINER_MOUSE_DOWN="container:mousedown";G.CONTAINER_SEEK="container:seek";G.CONTAINER_SEEKED="container:seeked";G.CONTAINER_VOLUME="container:volume";G.CONTAINER_FULLSCREEN="container:fullscreen";G.CONTAINER_STATE_BUFFERING="container:state:buffering";G.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull";G.CONTAINER_SETTINGSUPDATE="container:settingsupdate";G.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate";G.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show";G.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide";G.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable";G.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable";G.CONTAINER_STATS_ADD="container:stats:add";G.CONTAINER_OPTIONS_CHANGE="container:options:change";G.MEDIACONTROL_RENDERED="mediacontrol:rendered";G.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen";G.MEDIACONTROL_SHOW="mediacontrol:show";G.MEDIACONTROL_HIDE="mediacontrol:hide";G.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar";G.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar";G.MEDIACONTROL_PLAYING="mediacontrol:playing";G.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying";G.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged";G.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change";var ar=(function(e){Fe(i,e);var n=Be(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Se(this,i),r=n.call(this,t),r._options=t,r.uniqueId=Cn("o"),r}return xe(i,[{key:"options",get:function(){return this._options}}]),i})(G),qt={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Yn=/(.)^/,Vc={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},Gc=/\\|'|\r|\n|\t|\u2028|\u2029/g,Hc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},jc=new RegExp(`[&<>"']`,"g"),Ca=function(n){return n===null?"":(""+n).replace(jc,function(i){return Hc[i]})},Yc=0,at=function(n,i){var r,t=new RegExp([(qt.escape||Yn).source,(qt.interpolate||Yn).source,(qt.evaluate||Yn).source].join("|")+"|$","g"),f=0,S="__p+='";n.replace(t,function(h,F,T,N,M){return S+=n.slice(f,M).replace(Gc,function(U){return"\\"+Vc[U]}),F&&(S+=`'+
((__t=(`+F+`))==null?'':escapeExpr(__t))+
'`),T&&(S+=`'+
((__t=(`+T+`))==null?'':__t)+
'`),N&&(S+=`';
`+N+`
__p+='`),f=M+h.length,h}),S+=`';
`,qt.variable||(S=`with(obj||{}){
`+S+`}
`),S=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+S+`return __p;
//# sourceURL=/microtemplates/source[`+Yc+++"]";try{r=new Function(qt.variable||"obj","escapeExpr",S)}catch(h){throw h.source=S,h}if(i)return r(i,Ca);var L=function(F){return r.call(this,F,Ca)};return L.source="function("+(qt.variable||"obj")+`){
`+S+"}",L};at.settings=qt;var Qe={getStyleFor:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{baseUrl:""};return ve('<style class="clappr-style"></style>').html(at(n.toString())(i))}},$c=/^(\S+)\s*(.*)$/,zr=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.cid=Cn("c"),t._ensureElement(),t.delegateEvents(),t}return xe(i,[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}},{key:"$",value:function(t){return this.$el.find(t)}},{key:"render",value:function(){return this}},{key:"destroy",value:function(){return this.$el.remove(),this.stopListening(),this.undelegateEvents(),this}},{key:"setElement",value:function(t,f){return this.$el&&this.undelegateEvents(),this.$el=ve.zepto.isZ(t)?t:ve(t),this.el=this.$el[0],f!==!1&&this.delegateEvents(),this}},{key:"delegateEvents",value:function(t){t||(t=this.events),this.undelegateEvents();for(var f in t){var S=t[f];if(S&&S.constructor!==Function&&(S=this[t[f]]),!!S){var L=f.match($c),h=L[1],F=L[2];h+=".delegateEvents"+this.cid,F===""?this.$el.on(h,S.bind(this)):this.$el.on(h,F,S.bind(this))}}return this}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"_ensureElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var t=ve.extend(!0,{},this.attributes);this.id&&(t.id=this.id),this.className&&(t.class=this.className);var f=ve(Hr.create(this.tagName)).attr(t);this.setElement(f,!1)}}}]),i})(ar),ot=(function(e){Fe(i,e);var n=Be(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0;return Se(this,i),r=n.call(this,t),r.core=f,r}return xe(i,[{key:"name",get:function(){return"error"}},{key:"createError",value:function(t){if(!this.core){Ee.warn(this.name,"Core is not set. Error: ",t);return}this.core.trigger(G.ERROR,t)}}],[{key:"Levels",get:function(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]),i})(ar),jt={createError:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{useCodePrefix:!0},r=this.constructor&&this.constructor.type||"",t=this.name||r,f=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n,S="".concat(t,":").concat(n&&n.code||"unknown"),L={description:"",level:ot.Levels.FATAL,origin:t,scope:r,raw:{}},h=Object.assign({},L,n,{code:i.useCodePrefix?S:n.code});if(f&&h.level==ot.Levels.FATAL&&!h.UI){var F={title:f.t("default_error_title"),message:f.t("default_error_message")};h.UI=F}return this.playerError?this.playerError.createError(h):Ee.warn(t,"PlayerError is not defined. Error: ",h),h}},Tt=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t.render(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"getExternalInterface",value:function(){return{}}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"render",value:function(){return this}}]),i})(zr);Object.assign(Tt.prototype,jt);Tt.extend=function(e){return br(Tt,e)};Tt.type="core";var zc=`.container[data-container] {
  position: absolute;
  background-color: black;
  height: 100%;
  width: 100%;
  max-width: 100%; }
  .container[data-container] .chromeless {
    cursor: default; }

[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {
  cursor: pointer; }
`,$s=(function(e){Fe(i,e);var n=Be(i);function i(r,t,f){var S;return Se(this,i),S=n.call(this,r),S._i18n=t,S.currentTime=0,S.volume=100,S.playback=r.playback,S.playerError=f,S.settings=ve.extend(!0,{},S.playback.settings),S.isReady=!1,S.mediaControlDisabled=!1,S.plugins=[S.playback],S.dblTapHandler=new Nc(500),S.clickTimer=null,S.clickDelay=200,S.actionsMetadata={},S.bindEvents(),S}return xe(i,[{key:"name",get:function(){return"Container"}},{key:"attributes",get:function(){return{class:"container","data-container":""}}},{key:"events",get:function(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function(){return this.playback.ended}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"i18n",get:function(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function(){return this.playback.closedCaptionsTrackId},set:function(t){this.playback.closedCaptionsTrackId=t}},{key:"audioTracks",get:function(){return this.playback.audioTracks}},{key:"currentAudioTrack",get:function(){return this.playback.currentAudioTrack}},{key:"bindEvents",value:function(){this.listenTo(this.playback,G.PLAYBACK_PROGRESS,this.onProgress),this.listenTo(this.playback,G.PLAYBACK_TIMEUPDATE,this.timeUpdated),this.listenTo(this.playback,G.PLAYBACK_READY,this.ready),this.listenTo(this.playback,G.PLAYBACK_BUFFERING,this.onBuffering),this.listenTo(this.playback,G.PLAYBACK_BUFFERFULL,this.bufferfull),this.listenTo(this.playback,G.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.playback,G.PLAYBACK_LOADEDMETADATA,this.loadedMetadata),this.listenTo(this.playback,G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.playback,G.PLAYBACK_BITRATE,this.updateBitrate),this.listenTo(this.playback,G.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged),this.listenTo(this.playback,G.PLAYBACK_DVR,this.playbackDvrStateChanged),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl),this.listenTo(this.playback,G.PLAYBACK_SEEK,this.onSeek),this.listenTo(this.playback,G.PLAYBACK_SEEKED,this.onSeeked),this.listenTo(this.playback,G.PLAYBACK_ENDED,this.onEnded),this.listenTo(this.playback,G.PLAYBACK_PLAY,this.playing),this.listenTo(this.playback,G.PLAYBACK_PAUSE,this.paused),this.listenTo(this.playback,G.PLAYBACK_STOP,this.stopped),this.listenTo(this.playback,G.PLAYBACK_ERROR,this.error),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged),this.listenTo(this.playback,G.PLAYBACK_AUDIO_AVAILABLE,this.audioAvailable),this.listenTo(this.playback,G.PLAYBACK_AUDIO_CHANGED,this.audioChanged)}},{key:"subtitleAvailable",value:function(){this.trigger(G.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function(t){this.trigger(G.CONTAINER_SUBTITLE_CHANGED,t)}},{key:"audioAvailable",value:function(t){this.trigger(G.CONTAINER_AUDIO_AVAILABLE,t)}},{key:"audioChanged",value:function(t){this.trigger(G.CONTAINER_AUDIO_CHANGED,t)}},{key:"playbackStateChanged",value:function(t){this.trigger(G.CONTAINER_PLAYBACKSTATE,t)}},{key:"playbackDvrStateChanged",value:function(t){this.settings=this.playback.settings,this.dvrInUse=t,this.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,t)}},{key:"updateBitrate",value:function(t){this.trigger(G.CONTAINER_BITRATE,t)}},{key:"statsReport",value:function(t){this.trigger(G.CONTAINER_STATS_REPORT,t)}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function(){return!!this.dvrInUse}},{key:"destroy",value:function(){this.disableResizeObserver(),this.trigger(G.CONTAINER_DESTROYED,this,this.name),this.stopListening(),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove()}},{key:"setStyle",value:function(t){this.$el.css(t)}},{key:"animate",value:function(t,f){return this.$el.animate(t,f).promise()}},{key:"ready",value:function(){this.isReady=!0,this.trigger(G.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"error",value:function(t){this.isReady||this.ready(),this.trigger(G.CONTAINER_ERROR,t,this.name)}},{key:"loadedMetadata",value:function(t){this.trigger(G.CONTAINER_LOADEDMETADATA,t)}},{key:"timeUpdated",value:function(t){this.currentTime=t.current,this.trigger(G.CONTAINER_TIMEUPDATE,t,this.name)}},{key:"onProgress",value:function(){for(var t=arguments.length,f=new Array(t),S=0;S<t;S++)f[S]=arguments[S];this.trigger.apply(this,[G.CONTAINER_PROGRESS].concat(f,[this.name]))}},{key:"playing",value:function(){this.trigger(G.CONTAINER_PLAY,this.name,this.actionsMetadata.playEvent||{}),this.actionsMetadata.playEvent={}}},{key:"paused",value:function(){this.trigger(G.CONTAINER_PAUSE,this.name,this.actionsMetadata.pauseEvent||{}),this.actionsMetadata.pauseEvent={}}},{key:"stopped",value:function(){this.trigger(G.CONTAINER_STOP,this.actionsMetadata.stopEvent||{}),this.actionsMetadata.stopEvent={}}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.playEvent=t,this.playback.play(t)}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.stopEvent=t,this.playback.stop(t),this.currentTime=0}},{key:"switchAudioTrack",value:function(t){this.playback.switchAudioTrack(t)}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.pauseEvent=t,this.playback.pause(t)}},{key:"onEnded",value:function(){this.trigger(G.CONTAINER_ENDED,this,this.name),this.currentTime=0}},{key:"clicked",value:function(){var t=this;(!this.options.chromeless||this.options.allowUserInteraction)&&(this.clickTimer=setTimeout(function(){t.clickTimer&&t.trigger(G.CONTAINER_CLICK,t,t.name)},this.clickDelay))}},{key:"cancelClicked",value:function(){clearTimeout(this.clickTimer),this.clickTimer=null}},{key:"dblClicked",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&(this.cancelClicked(),this.trigger(G.CONTAINER_DBLCLICK,this,this.name))}},{key:"dblTap",value:function(t){var f=this;(!this.options.chromeless||this.options.allowUserInteraction)&&this.dblTapHandler.handle(t,function(){f.cancelClicked(),f.trigger(G.CONTAINER_DBLCLICK,f,f.name)})}},{key:"onContextMenu",value:function(t){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_CONTEXTMENU,t,this.name)}},{key:"seek",value:function(t){this.playback.seek(t)}},{key:"onSeek",value:function(t){this.trigger(G.CONTAINER_SEEK,t,this.name)}},{key:"onSeeked",value:function(){this.trigger(G.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function(t){var f=this.getDuration();if(t>=0&&t<=100){var S=f*(t/100);this.seek(S)}}},{key:"setVolume",value:function(t){this.volume=parseFloat(t),this.trigger(G.CONTAINER_VOLUME,this.volume,this.name),this.playback.volume(this.volume)}},{key:"fullscreen",value:function(){this.trigger(G.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(f){return f.name===t})[0]}},{key:"mouseEnter",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_DOWN)}},{key:"settingsUpdate",value:function(){this.settings=this.playback.settings,this.trigger(G.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function(t){this.trigger(G.CONTAINER_HIGHDEFINITIONUPDATE,t)}},{key:"isHighDefinitionInUse",value:function(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function(){this.mediaControlDisabled||(this.mediaControlDisabled=!0,this.trigger(G.CONTAINER_MEDIACONTROL_DISABLE))}},{key:"enableMediaControl",value:function(){this.mediaControlDisabled&&(this.mediaControlDisabled=!1,this.trigger(G.CONTAINER_MEDIACONTROL_ENABLE))}},{key:"updateStyle",value:function(){!this.options.chromeless||this.options.allowUserInteraction?this.$el.removeClass("chromeless"):this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver(),this.resizeObserverInterval=setInterval(function(){return t.checkResize()},500)}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function(){var t={width:this.el.clientWidth,height:this.el.clientHeight},f=this.currentSize||{},S=f.width,L=f.height,h=L!==t.height||S!==t.width;h&&(this.currentSize=t,this.trigger(G.CONTAINER_RESIZE,t))}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t),this.updateStyle(),this.playback.configure(this.options),this.trigger(G.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=Qe.getStyleFor(zc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.$el.append(this.playback.render().el),this.updateStyle(),this.checkResize(),this.enableResizeObserver(),this}}]),i})(zr);Object.assign($s.prototype,jt);var me=(function(e){Fe(i,e);var n=Be(i);function i(r,t,f){var S;return Se(this,i),S=n.call(this,r),S.settings={},S._i18n=t,S.playerError=f,S._consented=!1,S}return xe(i,[{key:"isAudioOnly",get:function(){return!1}},{key:"isAdaptive",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"i18n",get:function(){return this._i18n}},{key:"buffering",get:function(){return!1}},{key:"consent",value:function(t){typeof t=="function"&&t()}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){}},{key:"seek",value:function(t){}},{key:"seekPercentage",value:function(t){}},{key:"getStartTimeOffset",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",get:function(){return!1}},{key:"hasClosedCaptionsTracks",get:function(){return this.closedCaptionsTracks.length>0}},{key:"closedCaptionsTracks",get:function(){return[]}},{key:"closedCaptionsTrackId",get:function(){return-1},set:function(t){}},{key:"audioTracks",get:function(){return[]}},{key:"currentAudioTrack",get:function(){return null}},{key:"switchAudioTrack",value:function(t){}},{key:"getPlaybackType",value:function(){return i.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"volume",value:function(t){}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t)}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(f,S){f&&t.play()})}},{key:"canAutoPlay",value:function(t){t(!0,null)}}]),i})(zr);Object.assign(me.prototype,jt);me.extend=function(e){return br(me,e)};me.canPlay=function(e,n){return!1};me.VOD="vod";me.AOD="aod";me.LIVE="live";me.NO_OP="no_op";me.type="playback";var Xc=(function(e){Fe(i,e);var n=Be(i);function i(r,t,f,S){var L;return Se(this,i),L=n.call(this,r),L._i18n=f,L.loader=t,L.playerError=S,L}return xe(i,[{key:"options",get:function(){return this._options},set:function(t){this._options=t}},{key:"createContainers",value:function(){var t=this;return ve.Deferred(function(f){f.resolve(t.options.sources.map(function(S){return t.createContainer(S)}))})}},{key:"findPlaybackPlugin",value:function(t,f){return this.loader.playbackPlugins.filter(function(S){return S.canPlay(t,f)})[0]}},{key:"createContainer",value:function(t){var f=null,S=this.options.mimeType;Er(t)==="object"?(f=t.source.toString(),t.mimeType&&(S=t.mimeType)):f=t.toString(),f.match(/^\/\//)&&(f=window.location.protocol+f);var L=qr(qr({},this.options),{},{src:f,mimeType:S}),h=this.findPlaybackPlugin(f,S),F=h?new h(L,this._i18n,this.playerError):new me;L=qr(qr({},L),{},{playback:F});var T=new $s(L,this._i18n,this.playerError),N=ve.Deferred();return N.promise(T),this.addContainerPlugins(T),this.listenToOnce(T,G.CONTAINER_READY,function(){return N.resolve(T)}),T}},{key:"addContainerPlugins",value:function(t){this.loader.containerPlugins.forEach(function(f){t.addPlugin(new f(t))})}}]),i})(ar),Qc=`[data-player] {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -o-user-select: none;
  user-select: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transform: translate3d(0, 0, 0);
  position: relative;
  margin: 0;
  padding: 0;
  border: 0;
  font-style: normal;
  font-weight: normal;
  text-align: center;
  overflow: hidden;
  font-size: 100%;
  font-family: "Roboto", "Open Sans", Arial, sans-serif;
  text-shadow: 0 0 0;
  box-sizing: border-box; }
  [data-player]:focus {
    outline: 0; }
  [data-player] * {
    box-sizing: inherit; }
  [data-player] > * {
    float: none;
    max-width: none; }
  [data-player] > div {
    display: block; }
  [data-player].fullscreen {
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0; }
  [data-player].nocursor {
    cursor: none; }

.clappr-style {
  display: none !important; }
`,Zc=`[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,
[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,
[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,
[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,
[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,
[data-player] b, [data-player] u, [data-player] i, [data-player] center,
[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,
[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,
[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,
[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,
[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,
[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,
[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {
  margin: 0;
  padding: 0;
  border: 0;
  font: inherit;
  font-size: 100%;
  vertical-align: baseline; }

[data-player] table {
  border-collapse: collapse;
  border-spacing: 0; }

[data-player] caption, [data-player] th, [data-player] td {
  text-align: left;
  font-weight: normal;
  vertical-align: middle; }

[data-player] q, [data-player] blockquote {
  quotes: none; }
  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {
    content: "";
    content: none; }

[data-player] a img {
  border: none; }
`,zs=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.playerError=new ot(r,xn(t)),t.configureDomRecycler(),t.firstResize=!0,t.plugins=[],t.containers=[],t._boundFullscreenHandler=function(){return t.handleFullscreenChange()},ve(document).bind("fullscreenchange",t._boundFullscreenHandler),ve(document).bind("MSFullscreenChange",t._boundFullscreenHandler),ve(document).bind("mozfullscreenchange",t._boundFullscreenHandler),fe.isMobile&&ve(window).bind("resize",function(f){t.handleWindowResize(f)}),t}return xe(i,[{key:"events",get:function(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function(){return!!this.ready}},{key:"i18n",get:function(){return this.getPlugin("strings")||{t:function(f){return f}}}},{key:"mediaControl",get:function(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl?this._dummyMediaControl:(this._dummyMediaControl=new Tt(this),this._dummyMediaControl)}},{key:"activeContainer",get:function(){return this._activeContainer},set:function(t){this._activeContainer=t,this.trigger(G.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function(){return this.activeContainer&&this.activeContainer.playback}},{key:"activePlaybackEl",get:function(){if(this.activePlayback)return this.activePlayback.$el?this.activePlayback.$el.find("video")[0]:this.activePlayback.el}},{key:"configureDomRecycler",value:function(){var t=this.options&&this.options.playback&&this.options.playback.recycleVideo;Hr.configure({recycleVideo:t})}},{key:"createContainers",value:function(t){this.defer=ve.Deferred(),this.defer.promise(this),this.containerFactory=new Xc(t,t.loader,this.i18n,this.playerError),this.prepareContainers()}},{key:"prepareContainers",value:function(){var t=this;this.containerFactory.createContainers().then(function(f){return t.setupContainers(f)}).then(function(f){return t.resolveOnContainersReady(f)})}},{key:"updateSize",value:function(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function(){fe.isiOS||(this.$el.addClass("fullscreen"),this.$el.removeAttr("style"),this.previousSize={width:this.options.width,height:this.options.height},this.currentSize={width:ve(window).width(),height:ve(window).height()})}},{key:"setPlayerSize",value:function(){this.$el.removeClass("fullscreen"),this.currentSize=this.previousSize,this.previousSize={width:ve(window).width(),height:ve(window).height()},this.resize(this.currentSize)}},{key:"resize",value:function(t){!ci(t.height)&&!ci(t.width)?(this.el.style.height="".concat(t.height),this.el.style.width="".concat(t.width)):(this.el.style.height="".concat(t.height,"px"),this.el.style.width="".concat(t.width,"px")),this.previousSize={width:this.options.width,height:this.options.height},this.options.width=t.width,this.options.height=t.height,this.currentSize=t,this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver();var f=function(){t.triggerResize({width:t.el.clientWidth,height:t.el.clientHeight})};this.resizeObserverInterval=setInterval(f,500)}},{key:"triggerResize",value:function(t){var f=this.firstResize||this.oldHeight!==t.height||this.oldWidth!==t.width;f&&(this.oldHeight=t.height,this.oldWidth=t.width,this.computedSize=t,this.firstResize=!1,this.trigger(G.CORE_RESIZE,t))}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval),this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function(t){var f=this;ve.when.apply(ve,t).done(function(){f.defer.resolve(f),f.ready=!0,f.trigger(G.CORE_READY)})}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(f){return f.name===t})[0]}},{key:"load",value:function(t,f){this.options.mimeType=f,t=t&&t.constructor===Array?t:[t],this.options.sources=t,this.containers.forEach(function(S){return S.destroy()}),this.containerFactory.options=ve.extend(!0,this.options,{sources:t}),this.prepareContainers()}},{key:"destroy",value:function(){this.disableResizeObserver(),this.containers.forEach(function(t){return t.destroy()}),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove(),ve(document).unbind("fullscreenchange",this._boundFullscreenHandler),ve(document).unbind("MSFullscreenChange",this._boundFullscreenHandler),ve(document).unbind("mozfullscreenchange",this._boundFullscreenHandler),this.stopListening()}},{key:"handleFullscreenChange",value:function(){this.trigger(G.CORE_FULLSCREEN,this.isFullscreen()),this.updateSize()}},{key:"handleWindowResize",value:function(t){var f=window.innerWidth>window.innerHeight?"landscape":"portrait";this._screenOrientation!==f&&(this._screenOrientation=f,this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight}),this.trigger(G.CORE_SCREEN_ORIENTATION_CHANGED,{event:t,orientation:this._screenOrientation}))}},{key:"removeContainer",value:function(t){this.stopListening(t),this.containers=this.containers.filter(function(f){return f!==t})}},{key:"setupContainer",value:function(t){this.listenTo(t,G.CONTAINER_DESTROYED,this.removeContainer),this.containers.push(t)}},{key:"setupContainers",value:function(t){return t.forEach(this.setupContainer.bind(this)),this.trigger(G.CORE_CONTAINERS_CREATED),this.renderContainers(),this.activeContainer=t[0],this.render(),this.appendToParent(),this.containers}},{key:"renderContainers",value:function(){var t=this;this.containers.forEach(function(f){return t.el.appendChild(f.render().el)})}},{key:"createContainer",value:function(t,f){var S=this.containerFactory.createContainer(t,f);return this.setupContainer(S),this.el.appendChild(S.render().el),S}},{key:"getCurrentContainer",value:function(){return this.activeContainer}},{key:"getCurrentPlayback",value:function(){return this.activePlayback}},{key:"getPlaybackType",value:function(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function(){var t=Lr.fullscreenElement();return t&&t===this.el||t&&t===this.activePlaybackEl||this.activePlaybackEl&&this.activePlaybackEl.webkitDisplayingFullscreen||!1}},{key:"toggleFullscreen",value:function(){var t=this;if(this.isFullscreen()){var f=fe.isiOS?this.activePlaybackEl:document;Lr.cancelFullscreen(f),!fe.isiOS&&this.$el.removeClass("fullscreen nocursor")}else{var S=fe.isiOS?this.activePlaybackEl:this.el;if(!S)return;fe.isSafari||fe.isiOS?Lr.requestFullscreen(S):Lr.requestFullscreen(S).then(function(L){return L},function(L){return setTimeout(function(){if(!t.isFullscreen())throw new ReferenceError(L)},600)}),!fe.isiOS&&this.$el.addClass("fullscreen")}}},{key:"onMouseMove",value:function(t){this.trigger(G.CORE_MOUSE_MOVE,t)}},{key:"onMouseLeave",value:function(t){this.trigger(G.CORE_MOUSE_LEAVE,t)}},{key:"configure",value:function(t){var f=this;this._options=ve.extend(!0,this._options,t),this.configureDomRecycler();var S=t.source||t.sources;S&&this.load(S,t.mimeType||this.options.mimeType),this.trigger(G.CORE_OPTIONS_CHANGE,t),this.containers.forEach(function(L){return L.configure(f.options)})}},{key:"appendToParent",value:function(){var t=Qe.getStyleFor(Qc.toString(),{baseUrl:this.options.baseUrl}),f=Qe.getStyleFor(Zc.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]),this.options.includeResetStyle&&this.$el.append(f[0]);var S=this.$el.parent()&&this.$el.parent().length;!S&&this.$el.appendTo(this.options.parentElement)}},{key:"render",value:function(){this.options.width=this.options.width||this.$el.width(),this.options.height=this.options.height||this.$el.height();var t={width:this.options.width,height:this.options.height};return this.previousSize=this.currentSize=this.computedSize=t,this.updateSize(),this.enableResizeObserver(),this}}]),i})(zr);Object.assign(zs.prototype,jt);var Jc=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.player=r,t}return xe(i,[{key:"loader",get:function(){return this.player.loader}},{key:"create",value:function(){return this.options.loader=this.loader,this.core=new zs(this.options),this.addCorePlugins(),this.core.createContainers(this.options),this.core}},{key:"addCorePlugins",value:function(){var t=this;return this.loader.corePlugins.forEach(function(f){var S=new f(t.core);t.core.addPlugin(S),t.setupExternalInterface(S)}),this.core}},{key:"setupExternalInterface",value:function(t){var f=t.getExternalInterface();for(var S in f)this.player[S]=f[S].bind(t)}}]),i})(ar),qc=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,tn=(function(){function e(n,i,r){Se(this,e),this.major=parseInt(n||0,10),this.minor=parseInt(i||0,10),this.patch=parseInt(r||0,10)}return xe(e,[{key:"compare",value:function(i){var r=this.major-i.major;return r=r||this.minor-i.minor,r=r||this.patch-i.patch,r}},{key:"inc",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"patch";return typeof this[i]<"u"&&(this[i]+=1),this}},{key:"satisfies",value:function(i,r){return this.compare(i)>=0&&(!r||this.compare(r)<0)}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}],[{key:"parse",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=i.match(qc)||[],t=li(r,4),f=t[1],S=t[2],L=t[3];return typeof f>"u"?null:new e(f,S,L)}}]),e})(),La=function(n,i){return!n||!i?{}:Object.entries(n).filter(function(r){var t=li(r,2),f=t[1];return f.type===i}).reduce(function(r,t){var f=li(t,2),S=f[0],L=f[1];return r[S]=L,r},{})},sr=(function(){var e={plugins:{},playbacks:[]},n="0.4.27";return(function(){function i(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Se(this,i),this.playerId=t,this.playbackPlugins=pr(e.playbacks);var f=i.registeredPlugins,S=f.core,L=f.container;this.containerPlugins=Object.values(L),this.corePlugins=Object.values(S),Array.isArray(r)||this.validateExternalPluginsType(r),this.addExternalPlugins(r)}return xe(i,[{key:"groupPluginsByType",value:function(t){return Array.isArray(t)&&(t=t.reduce(function(f,S){return f[S.type]||(f[S.type]=[]),f[S.type].push(S),f},{})),t}},{key:"removeDups",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=function(N,M){return N[M.prototype.name]&&f||(N[M.prototype.name]&&delete N[M.prototype.name],N[M.prototype.name]=M),N},L=t.reduceRight(S,Object.create(null)),h=[];for(var F in L)h.unshift(L[F]);return h}},{key:"addExternalPlugins",value:function(t){var f=typeof t.loadExternalPluginsFirst=="boolean"?t.loadExternalPluginsFirst:!0,S=typeof t.loadExternalPlaybacksFirst=="boolean"?t.loadExternalPlaybacksFirst:!0;if(t=this.groupPluginsByType(t),t.playback){var L=t.playback.filter(function(T){return i.checkVersionSupport(T),!0});this.playbackPlugins=S?this.removeDups(L.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(L),!0)}if(t.container){var h=t.container.filter(function(T){return i.checkVersionSupport(T),!0});this.containerPlugins=f?this.removeDups(h.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(h),!0)}if(t.core){var F=t.core.filter(function(T){return i.checkVersionSupport(T),!0});this.corePlugins=f?this.removeDups(F.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(F),!0)}}},{key:"validateExternalPluginsType",value:function(t){var f=["playback","container","core"];f.forEach(function(S){(t[S]||[]).forEach(function(L){var h="external "+L.type+" plugin on "+S+" array";if(L.type!==S)throw new ReferenceError(h)})})}}],[{key:"registeredPlaybacks",get:function(){return pr(e.playbacks)}},{key:"registeredPlugins",get:function(){var t=e.plugins,f=La(t,"core"),S=La(t,"container");return{core:f,container:S}}},{key:"checkVersionSupport",value:function(t){var f=t.prototype,S=f.supportedVersion,L=f.name;if(!S||!S.min)return Ee.warn("Loader","missing version information for ".concat(L)),!1;var h=S.max?tn.parse(S.max):tn.parse(S.min).inc("minor"),F=tn.parse(S.min);return tn.parse(n).satisfies(F,h)?!0:(Ee.warn("Loader","unsupported plugin ".concat(L,": Clappr version ").concat(n," does not match required range [").concat(F,",").concat(h,")")),!1)}},{key:"registerPlugin",value:function(t){if(!t||!t.prototype.name)return Ee.warn("Loader","missing information to register plugin: ".concat(t)),!1;i.checkVersionSupport(t);var f=e.plugins;if(!f)return!1;var S=f[t.prototype.name];return S&&Ee.warn("Loader","overriding plugin entry: ".concat(t.prototype.name," - ").concat(S)),f[t.prototype.name]=t,!0}},{key:"registerPlayback",value:function(t){if(!t||!t.prototype.name)return!1;i.checkVersionSupport(t);var f=e.playbacks,S=f.findIndex(function(h){return h.prototype.name===t.prototype.name});if(S>=0){var L=f[S];f.splice(S,1),Ee.warn("Loader","overriding playback entry: ".concat(L.name," - ").concat(L))}return e.playbacks=[t].concat(pr(f)),!0}},{key:"unregisterPlugin",value:function(t){if(!t)return!1;var f=e.plugins,S=f[t];return S?(delete f[t],!0):!1}},{key:"unregisterPlayback",value:function(t){if(!t)return!1;var f=e.playbacks,S=f.findIndex(function(L){return L.prototype.name===t});return S<0?!1:(f.splice(S,1),e.playbacks=f,!0)}},{key:"clearPlugins",value:function(){e.plugins={}}},{key:"clearPlaybacks",value:function(){e.playbacks=[]}}]),i})()})(),ef=Pc().replace(/\/[^/]+$/,""),Xs=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;Se(this,i),t=n.call(this,r);var f={recycleVideo:!0},S={playerId:Cn(""),persistConfig:!0,width:640,height:360,baseUrl:ef,allowUserInteraction:fe.isMobile,includeResetStyle:!0,playback:f};t._options=ve.extend(!0,S,r),t.options.sources=t._normalizeSources(r),t.options.chromeless||(t.options.allowUserInteraction=!0),t.options.allowUserInteraction||(t.options.disableKeyboardShortcuts=!0),t._registerOptionEventListeners(t.options.events),t._coreFactory=new Jc(xn(t));var L=t._getParentElement(t.options);return L&&t.attachTo(L),t}return xe(i,[{key:"loader",get:function(){return this._loader||(this._loader=new sr(this.options.plugins||{},this.options.playerId)),this._loader},set:function(t){this._loader=t}},{key:"ended",get:function(){return this.core.activeContainer.ended}},{key:"buffering",get:function(){return this.core.activeContainer.buffering}},{key:"isReady",get:function(){return!!this._ready}},{key:"eventsMapping",get:function(){return{onReady:G.PLAYER_READY,onResize:G.PLAYER_RESIZE,onPlay:G.PLAYER_PLAY,onPause:G.PLAYER_PAUSE,onStop:G.PLAYER_STOP,onEnded:G.PLAYER_ENDED,onSeek:G.PLAYER_SEEK,onError:G.PLAYER_ERROR,onTimeUpdate:G.PLAYER_TIMEUPDATE,onVolumeUpdate:G.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:G.PLAYER_SUBTITLE_AVAILABLE}}},{key:"_getParentElement",value:function(t){var f=t.parentId,S=t.parent;return f?document.querySelector(f):S}},{key:"attachTo",value:function(t){return this.options.parentElement=t,this.core=this._coreFactory.create(),this._addEventListeners(),this}},{key:"_addEventListeners",value:function(){return this.core.isReady?this._onReady():this.listenToOnce(this.core,G.CORE_READY,this._onReady),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged),this.listenTo(this.core,G.CORE_FULLSCREEN,this._onFullscreenChange),this.listenTo(this.core,G.CORE_RESIZE,this._onResize),this}},{key:"_addContainerEventListeners",value:function(){var t=this.core.activeContainer;return t&&(this.listenTo(t,G.CONTAINER_PLAY,this._onPlay),this.listenTo(t,G.CONTAINER_PAUSE,this._onPause),this.listenTo(t,G.CONTAINER_STOP,this._onStop),this.listenTo(t,G.CONTAINER_ENDED,this._onEnded),this.listenTo(t,G.CONTAINER_SEEK,this._onSeek),this.listenTo(t,G.CONTAINER_ERROR,this._onError),this.listenTo(t,G.CONTAINER_TIMEUPDATE,this._onTimeUpdate),this.listenTo(t,G.CONTAINER_VOLUME,this._onVolumeUpdate),this.listenTo(t,G.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)),this}},{key:"_registerOptionEventListeners",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=Object.keys(f).length>0;return L&&Object.keys(S).forEach(function(h){var F=t.eventsMapping[h];F&&t.off(F,S[h])}),Object.keys(f).forEach(function(h){var F=t.eventsMapping[h];if(F){var T=f[h];T=typeof T=="function"&&T,T&&t.on(F,T)}}),this}},{key:"_containerChanged",value:function(){this.stopListening(),this._addEventListeners()}},{key:"_onReady",value:function(){this._ready=!0,this._addContainerEventListeners(),this.trigger(G.PLAYER_READY)}},{key:"_onFullscreenChange",value:function(t){this.trigger(G.PLAYER_FULLSCREEN,t)}},{key:"_onVolumeUpdate",value:function(t){this.trigger(G.PLAYER_VOLUMEUPDATE,t)}},{key:"_onSubtitleAvailable",value:function(){this.trigger(G.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function(t){this.trigger(G.PLAYER_RESIZE,t)}},{key:"_onPlay",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PLAY,f)}},{key:"_onPause",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PAUSE,f)}},{key:"_onStop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.trigger(G.PLAYER_STOP,this.getCurrentTime(),t)}},{key:"_onEnded",value:function(){this.trigger(G.PLAYER_ENDED)}},{key:"_onSeek",value:function(t){this.trigger(G.PLAYER_SEEK,t)}},{key:"_onTimeUpdate",value:function(t){this.trigger(G.PLAYER_TIMEUPDATE,t)}},{key:"_onError",value:function(t){this.trigger(G.PLAYER_ERROR,t)}},{key:"_normalizeSources",value:function(t){var f=t.sources||(t.source!==void 0?[t.source]:[]);return f.length===0?[{source:"",mimeType:""}]:f}},{key:"resize",value:function(t){return this.core.resize(t),this}},{key:"load",value:function(t,f,S){return S!==void 0&&this.configure({autoPlay:!!S}),this.core.load(t,f),this}},{key:"destroy",value:function(){return this.stopListening(),this.core.destroy(),this}},{key:"consent",value:function(t){this.core.getCurrentPlayback().consent(t)}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.play(t),this}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.pause(t),this}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.stop(t),this}},{key:"seek",value:function(t){return this.core.activeContainer.seek(t),this}},{key:"seekPercentage",value:function(t){return this.core.activeContainer.seekPercentage(t),this}},{key:"mute",value:function(){return this.core.activePlayback.mute(),this}},{key:"unmute",value:function(){return this.core.activePlayback.unmute(),this}},{key:"isPlaying",value:function(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._registerOptionEventListeners(t.events,this.options.events),this.core.configure(t),this}},{key:"getPlugin",value:function(t){var f=this.core.plugins.concat(this.core.activeContainer.plugins);return f.filter(function(S){return S.name===t})[0]}},{key:"getCurrentTime",value:function(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function(){return this.core.activeContainer.getDuration()}}]),i})(ar);Object.assign(Xs.prototype,jt);var nr=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"bindEvents",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),i})(ar);Object.assign(nr.prototype,jt);nr.extend=function(e){return br(nr,e)};nr.type="container";var Kt=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"getExternalInterface",value:function(){return{}}},{key:"destroy",value:function(){this.stopListening()}}]),i})(ar);Object.assign(Kt.prototype,jt);Kt.extend=function(e){return br(Kt,e)};Kt.type="core";var ir=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"bindEvents",value:function(){}}]),i})(zr);Object.assign(ir.prototype,jt);ir.extend=function(e){return br(ir,e)};ir.type="container";var tf=`<% for (var i = 0; i < tracks.length; i++) { %>
  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">
<% }; %>
`,rf=`[data-html5-video] {
  position: absolute;
  height: 100%;
  width: 100%;
  display: block; }
`,Ar={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};Ar.ogv=Ar.ogg;Ar["3gp"]=Ar["3gpp"];var jr={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},nf=Object.keys(jr).reduce(function(e,n){return[].concat(pr(e),pr(jr[n]))},[]),Da={code:"unknown",message:"unknown"},At=(function(e){Fe(i,e);var n=Be(i);function i(){var r;Se(this,i);for(var t=arguments.length,f=new Array(t),S=0;S<t;S++)f[S]=arguments[S];r=n.call.apply(n,[this].concat(f)),r._destroyed=!1,r._loadStarted=!1,r._isBuffering=!1,r._playheadMoving=!1,r._playheadMovingTimer=null,r._stopped=!1,r._ccTrackId=-1,r._setupSrc(r.options.src),r.options.playback||(r.options.playback=r.options||{}),r.options.playback.disableContextMenu=r.options.playback.disableContextMenu||r.options.disableVideoTagContextMenu,r._minDvrSize=r.isValidMinimumDVRSizeConfig?r.minimumDVRSizeConfig:60;var L=r.options.playback,h=L.preload||(fe.isSafari?"auto":r.options.preload),F;return r.options.poster&&(typeof r.options.poster=="string"?F=r.options.poster:typeof r.options.poster.url=="string"&&(F=r.options.poster.url)),ve.extend(!0,r.el,{muted:r.options.mute,defaultMuted:r.options.mute,loop:r.options.loop,poster:F,preload:h||"metadata",crossOrigin:L.crossOrigin,"x-webkit-playsinline":L.playInline}),(L.controls||r.options.useVideoTagDefaultControls)&&r.$el.attr("controls",""),L.playInline&&r.$el.attr({playsinline:"playsinline"}),L.crossOrigin&&r.$el.attr({crossorigin:L.crossOrigin}),r.settings={default:["seekbar"]},r.settings.left=["playpause","position","duration"],r.settings.right=["fullscreen","volume","hd-indicator"],L.externalTracks&&r._setupExternalTracks(L.externalTracks),r.options.autoPlay&&r.attemptAutoPlay(),r}return xe(i,[{key:"name",get:function(){return"html5_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function(){var t=this.options.src,f=i._mimeTypesForUrl(t,jr,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||nf.indexOf(f[0])>=0}},{key:"attributes",get:function(){return{"data-html5-video":""}}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}},{key:"isLive",get:function(){return this.getPlaybackType()===me.LIVE}},{key:"dvrEnabled",get:function(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function(){return typeof this.minimumDVRSizeConfig<"u"&&typeof this.minimumDVRSizeConfig=="number"}},{key:"configure",value:function(t){tr(Lt(i.prototype),"configure",this).call(this,t),this.el.loop=!!t.loop}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(f,S){S&&Ee.warn(t.name,"autoplay error.",{result:f,error:S}),f&&setTimeout(function(){return!t._destroyed&&t.play()},0)})}},{key:"canAutoPlay",value:function(t){if(this.options.disableCanAutoPlay){t(!0,null);return}var f={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||!1,muted:this.options.mute||!1};fe.isMobile&&Hr.options.recycleVideo&&(f.element=this.el),wc(t,f)}},{key:"_setupExternalTracks",value:function(t){this._externalTracks=t.map(function(f){return{kind:f.kind||"subtitles",label:f.label,lang:f.lang,src:f.src}})}},{key:"_setupSrc",value:function(t){this.el.src!==t&&(this._ccIsSetup=!1,this.el.src=t,this._src=this.el.src)}},{key:"_onLoadedMetadata",value:function(t){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_LOADEDMETADATA,{duration:t.target.duration,data:t}),this._updateSettings();var f=typeof this._options.autoSeekFromUrl>"u"||this._options.autoSeekFromUrl;this.getPlaybackType()!==me.LIVE&&f&&this._checkInitialSeek()}},{key:"_onDurationChange",value:function(){this._updateSettings(),this._onTimeUpdate(),this._onProgress()}},{key:"_updateSettings",value:function(){this.getPlaybackType()===me.VOD||this.getPlaybackType()===me.AOD?this.settings.left=["playpause","position","duration"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function(){var t=this.tagName==="audio"?me.AOD:me.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?me.LIVE:t}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"consent",value:function(t){var f=this;if(this.isPlaying()||this.el._consented)tr(Lt(i.prototype),"consent",this).call(this,t);else{var S=function L(){f.el.removeEventListener("loadedmetadata",L,!1),f.el.removeEventListener("error",L,!1),f.el._consented=!0,tr(Lt(i.prototype),"consent",f).call(f,t)};this.el.addEventListener("loadedmetadata",S,!1),this.el.addEventListener("error",S,!1),this.el.load()}}},{key:"play",value:function(){this.trigger(G.PLAYBACK_PLAY_INTENT),this._stopped=!1,this._setupSrc(this._src),this._handleBufferingEvents();var t=this.el.play();t&&t.catch&&t.catch(function(){})}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this.el.removeAttribute("src"),this.el.load(),this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_STOP)}},{key:"volume",value:function(t){t===0?(this.$el.attr({muted:"true"}),this.el.muted=!0):(this.$el.attr({muted:null}),this.el.muted=!1,this.el.volume=t/100)}},{key:"mute",value:function(){this.el.muted=!0}},{key:"unmute",value:function(){this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted===!0||this.el.volume===0}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startPlayheadMovingChecks",value:function(){this._playheadMovingTimer===null&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){this._playheadMovingTimer!==null&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var t=this._playheadMovingTimeOnCheck,f=this.el.currentTime;this._playheadMoving=t!==f,this._playheadMovingTimeOnCheck=f,this._handleBufferingEvents()}},{key:"_onWaiting",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function(){this._checkForClosedCaptions(),this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PLAY)}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function(){this.trigger(G.PLAYBACK_SEEK,this.getCurrentTime()),this._handleBufferingEvents()}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingEvents",value:function(){var t=!this.el.ended&&!this.el.paused,f=this._loadStarted&&!this.el.ended&&!this._stopped&&(t&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!==f&&(this._isBuffering=f,f?this.trigger(G.PLAYBACK_BUFFERING,this.name):this.trigger(G.PLAYBACK_BUFFERFULL,this.name))}},{key:"_onError",value:function(){var t=this.el.error||Da,f=t.code,S=t.message,L=f===Da.code,h=this.createError({code:f,description:S,raw:this.el.error,level:L?ot.Levels.WARN:ot.Levels.FATAL});L?Ee.warn(this.name,"HTML5 unknown error: ",h):this.trigger(G.PLAYBACK_ERROR,h)}},{key:"destroy",value:function(){this._destroyed=!0,this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange),tr(Lt(i.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this.el.load(),this._src=null,Hr.garbage(this.el)}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function(t){t<0&&(Ee.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this.el.seekable.start(0),this.el.currentTime=t}},{key:"seekPercentage",value:function(t){var f=this.el.duration*(t/100);this.seek(f)}},{key:"_checkInitialSeek",value:function(){var t=Oc();t!==0&&this.seek(t)}},{key:"getCurrentTime",value:function(){return this.el.currentTime}},{key:"getDuration",value:function(){if(this.isLive){if(this.el.seekable.length>0)return this.el.seekable.end(0)-this.el.seekable.start(0);this._scheduleUpdateSettingsCheck()}return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function(){var t=this;this._updateSettingsCheckInFlight||(this._updateSettingsCheckInFlight=setTimeout(function(){t._updateSettings(),t._updateSettingsCheckInFlight=null},1e3))}},{key:"_onTimeUpdate",value:function(){var t=this.isLive?this.getDuration():this.el.duration;this.trigger(G.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:t},this.name)}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],f=0,S=0;S<this.el.buffered.length;S++)t=[].concat(pr(t),[{start:this.el.buffered.start(S),end:this.el.buffered.end(S)}]),this.el.currentTime>=t[S].start&&this.el.currentTime<=t[S].end&&(f=S);var L={start:t[f].start,current:t[f].end,total:this.el.duration};this.trigger(G.PLAYBACK_PROGRESS,L,t)}}},{key:"_typeFor",value:function(t){var f=i._mimeTypesForUrl(t,Ar,this.options.mimeType);f.length===0&&(f=i._mimeTypesForUrl(t,jr,this.options.mimeType));var S=f[0]||"";return S.split(";")[0]}},{key:"_ready",value:function(){this._isReadyState||(this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_checkForClosedCaptions",value:function(){if(this.isHTML5Video&&!this._ccIsSetup){if(this.hasClosedCaptionsTracks){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this.handleTextTrackChange=this._handleTextTrackChange.bind(this),this.el.textTracks.addEventListener("change",this.handleTextTrackChange)}this._ccIsSetup=!0}}},{key:"_handleTextTrackChange",value:function(){var t=this.closedCaptionsTracks,f=t.find(function(S){return S.track.mode==="showing"})||{id:-1};this._ccTrackId!==f.id&&(this._ccTrackId=f.id,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:f.id}))}},{key:"isHTML5Video",get:function(){return this.name===i.prototype.name}},{key:"closedCaptionsTracks",get:function(){var t=0,f=function(){return t++},S=this.el.textTracks?Array.from(this.el.textTracks):[];return S.filter(function(L){return L.kind==="subtitles"||L.kind==="captions"}).map(function(L){return{id:f(),name:L.label,track:L}})}},{key:"closedCaptionsTrackId",get:function(){return this._ccTrackId},set:function(t){if(ci(t)){var f=this.closedCaptionsTracks,S;t!==-1&&(S=f.find(function(L){return L.id===t}),!S||S.track.mode==="showing")||(f.filter(function(L){return L.track.mode!=="hidden"}).forEach(function(L){return L.track.mode="hidden"}),S&&(S.track.mode="showing"),this._ccTrackId=t,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:t}))}}},{key:"template",get:function(){return at(tf)}},{key:"render",value:function(){this.options.playback.disableContextMenu&&this.$el.on("contextmenu",function(){return!1}),this._externalTracks&&this._externalTracks.length>0&&this.$el.html(this.template({tracks:this._externalTracks})),this._ready();var t=Qe.getStyleFor(rf.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this}}]),i})(me);At._mimeTypesForUrl=function(e,n,i){var r=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],t=i||r&&n[r.toLowerCase()]||[];return t.constructor===Array?t:[t]};At._canPlay=function(e,n,i,r){var t=At._mimeTypesForUrl(i,n,r),f=document.createElement(e);return!!t.filter(function(S){return!!f.canPlayType(S).replace(/no/,"")})[0]};At.canPlay=function(e,n){return At._canPlay("audio",jr,e,n)||At._canPlay("video",Ar,e,n)};var Qs=(function(e){Fe(i,e);var n=Be(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"html5_audio"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return"audio"}},{key:"isAudioOnly",get:function(){return!0}},{key:"updateSettings",value:function(){this.settings.left=["playpause","position","duration"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function(){return me.AOD}}]),i})(At);Qs.canPlay=function(e,n){var i={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]};return At._canPlay("audio",i,e,n)};var af=`[data-html-img] {
  max-width: 100%;
  max-height: 100%; }
`,Zs=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.el.src=r.src,t}return xe(i,[{key:"name",get:function(){return"html_img"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return"img"}},{key:"attributes",get:function(){return{"data-html-img":""}}},{key:"events",get:function(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}},{key:"getPlaybackType",value:function(){return me.NO_OP}},{key:"render",value:function(){var t=Qe.getStyleFor(af.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.trigger(G.PLAYBACK_READY,this.name),this}},{key:"_onLoad",value:function(){this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function(t){var f=t.type==="error"?"load error":"loading aborted";this.trigger(G.PLAYBACK_ERROR,{message:f},this.name)}}]),i})(me);Zs.canPlay=function(e){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(e)};var sf=`<canvas data-no-op-canvas></canvas>
<p data-no-op-msg><%=message%></p><p>
</p>`,of=`[data-no-op] {
  position: absolute;
  height: 100%;
  width: 100%;
  text-align: center; }

[data-no-op] p[data-no-op-msg] {
  position: absolute;
  text-align: center;
  font-size: 25px;
  left: 0;
  right: 0;
  color: white;
  padding: 10px;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%);
  max-height: 100%;
  overflow: auto; }

[data-no-op] canvas[data-no-op-canvas] {
  background-color: #777;
  height: 100%;
  width: 100%; }
`,Js=(function(e){Fe(i,e);var n=Be(i);function i(){var r;Se(this,i);for(var t=arguments.length,f=new Array(t),S=0;S<t;S++)f[S]=arguments[S];return r=n.call.apply(n,[this].concat(f)),r._noiseFrameNum=-1,r}return xe(i,[{key:"name",get:function(){return"no_op"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(sf)}},{key:"attributes",get:function(){return{"data-no-op":""}}},{key:"render",value:function(){var t=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported"),f=Qe.getStyleFor(of.toString(),{baseUrl:this.options.baseUrl});this.$el.append(f[0]),this.$el.html(this.template({message:t})),this.trigger(G.PLAYBACK_READY,this.name);var S=!!(this.options.poster&&this.options.poster.showForNoOp);return(this.options.autoPlay||!S)&&this._animate(),this}},{key:"_noise",value:function(){if(this._noiseFrameNum=(this._noiseFrameNum+1)%5,!this._noiseFrameNum){var t=this.context.createImageData(this.context.canvas.width,this.context.canvas.height),f;try{f=new Uint32Array(t.data.buffer)}catch{f=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4);for(var S=t.data,L=0;L<S.length;L++)f[L]=S[L]}for(var h=f.length,F=Math.random()*6+4,T=0,N=0,M=0;M<h;){if(T<0){T=F*Math.random();var U=Math.pow(Math.random(),.4);N=255*U<<24}T-=1,f[M++]=N}this.context.putImageData(t,0,0)}}},{key:"_loop",value:function(){var t=this;this._stop||(this._noise(),this._animationHandle=Sc(function(){return t._loop()}))}},{key:"destroy",value:function(){this._animationHandle&&(xc(this._animationHandle),this._stop=!0)}},{key:"_animate",value:function(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0],this.context=this.canvas.getContext("2d"),this._loop()}}]),i})(me);Js.canPlay=function(e){return!0};var lf=(function(e){Fe(i,e);var n=Be(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t._initializeMessages(),t}return xe(i,[{key:"name",get:function(){return"strings"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"t",value:function(t){var f=this._language(),S=this._messages.en,L=f&&this._messages[f]||S;return L[t]||S[t]||t}},{key:"_language",value:function(){return this.core.options.language||Ic()}},{key:"_initializeMessages",value:function(){var t={en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zurck zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser untersttzt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador no supporta a reproduo deste video. Por favor, tente usar um navegador diferente.",default_error_title:"No foi possvel reproduzir o vdeo.",default_error_message:"Ocorreu um problema ao tentar carregar o vdeo."},es_am:{live:"vivo",back_to_live:"volver en vivo",disabled:"No disponible",playback_not_supported:"Su navegador no soporta la reproduccin de este video. Por favor, utilice un navegador diferente.",default_error_title:"No se puede reproducir el video.",default_error_message:"Se ha producido un error al cargar el video."},es:{live:"en directo",back_to_live:"volver al directo",disabled:"No disponible",playback_not_supported:"Este navegador no es compatible para reproducir este vdeo. Utilice un navegador diferente.",default_error_title:"No se puede reproducir el vdeo.",default_error_message:"Se ha producido un problema al cargar el vdeo."},ru:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"      . ,   ."},bg:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"       . ,    .",default_error_title:"     .",default_error_message:"     ."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"Dsactiv",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vido. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vido.",default_error_message:"Un problme est survenu lors du chargement de la vido."},tr:{live:"canl",back_to_live:"canl yayna dn",disabled:"Engelli",playback_not_supported:"Taraycnz bu videoyu oynatma desteine sahip deil. Ltfen farkl bir tarayc ile deneyin."},et:{live:"Otselekanne",back_to_live:"Tagasi otselekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"",back_to_live:"  ",disabled:"",playback_not_supported:"       .    .",default_error_title:"   .",default_error_message:"    ."},zh:{live:"",back_to_live:"",disabled:"",playback_not_supported:"",default_error_title:"",default_error_message:""}};this._messages=ve.extend(!0,t,this.core.options.strings||{}),this._messages["de-DE"]=this._messages.de,this._messages["pt-BR"]=this._messages.pt,this._messages["en-US"]=this._messages.en,this._messages["bg-BG"]=this._messages.bg,this._messages["es-419"]=this._messages.es_am,this._messages["es-ES"]=this._messages.es,this._messages["fr-FR"]=this._messages.fr,this._messages["tr-TR"]=this._messages.tr,this._messages["et-EE"]=this._messages.et,this._messages["ar-IQ"]=this._messages.ar,this._messages["zh-CN"]=this._messages.zh}}]),i})(Kt),uf=(function(e){Fe(i,e);var n=Be(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"sources"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function(){var t=this.core.containers.filter(function(f){return f.playback.name!=="no_op"})[0]||this.core.containers[0];t&&this.core.containers.forEach(function(f){f!==t&&f.destroy()})}}]),i})(Kt);sr.registerPlugin(lf);sr.registerPlugin(uf);sr.registerPlayback(Js);sr.registerPlayback(Zs);sr.registerPlayback(Qs);sr.registerPlayback(At);function et(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function cf(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gf(r.key),r)}}function tt(e,n,i){return n&&cf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rt(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&di(e,n)}function Wt(e){return Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Wt(e)}function di(e,n){return di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},di(e,n)}function ff(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function df(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qs(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return df(e)}function nt(e){var n=ff();return function(){var r=Wt(e),t;if(n){var f=Wt(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return qs(this,t)}}function hf(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=Wt(e),e!==null););return e}function mr(){return typeof Reflect<"u"&&Reflect.get?mr=Reflect.get.bind():mr=function(n,i,r){var t=hf(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},mr.apply(this,arguments)}function vf(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function gf(e){var n=vf(e,"string");return typeof n=="symbol"?n:String(n)}var pf=(function(e){rt(i,e);var n=nt(i);function i(r){return et(this,i),n.call(this,r)}return tt(i,[{key:"name",get:function(){return"click_to_pause"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"config",get:function(){return this.container.options.clickToPauseConfig||{}}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_CLICK,this.click),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate)}},{key:"click",value:function(){var t=this.config.onClickPayload;(this.container.getPlaybackType()!==me.LIVE||this.container.isDvrEnabled())&&(this.container.isPlaying()?this.container.pause(t):this.container.play(t))}},{key:"settingsUpdate",value:function(){var t=this.container.getPlaybackType()!==me.LIVE||this.container.isDvrEnabled();if(t!==this.pointerEnabled){var f=t?"addClass":"removeClass";this.container.$el[f]("pointer-enabled"),this.pointerEnabled=t}}}]),i})(nr),mf=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve">
<path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1
	c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9
	C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"/>
</svg>`,yf=`<button type="button" class="cc-button media-control-button media-control-icon" data-cc-button aria-label="<%= ariaLabel %>"></button>
<ul>
  <% if (title) { %>
  <li data-title><%= title %></li>
  <% }; %>
  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>
  <% for (var i = 0; i < tracks.length; i++) { %>
    <li><a href="#" data-cc-select="<%= tracks[i].id %>"><%= tracks[i].label %></a></li>
  <% }; %>
</ul>
`,Ef=`.cc-controls[data-cc-controls] {
  float: right;
  position: relative;
  display: none; }
  .cc-controls[data-cc-controls].available {
    display: block; }
  .cc-controls[data-cc-controls] .cc-button {
    padding: 6px !important; }
    .cc-controls[data-cc-controls] .cc-button.enabled {
      display: block;
      opacity: 1.0; }
      .cc-controls[data-cc-controls] .cc-button.enabled:hover {
        opacity: 1.0;
        text-shadow: none; }
  .cc-controls[data-cc-controls] > ul {
    list-style-type: none;
    position: absolute;
    bottom: 25px;
    border: 1px solid black;
    display: none;
    background-color: #e6e6e6; }
  .cc-controls[data-cc-controls] li {
    font-size: 10px; }
    .cc-controls[data-cc-controls] li[data-title] {
      background-color: #c3c2c2;
      padding: 5px; }
    .cc-controls[data-cc-controls] li a {
      color: #444;
      padding: 2px 10px;
      display: block;
      text-decoration: none; }
      .cc-controls[data-cc-controls] li a:hover {
        background-color: #555;
        color: white; }
        .cc-controls[data-cc-controls] li a:hover a {
          color: white;
          text-decoration: none; }
    .cc-controls[data-cc-controls] li.current a {
      color: #f00; }
`,Af=(function(e){rt(i,e);var n=nt(i);function i(r){var t;et(this,i),t=n.call(this,r);var f=r.options.closedCaptionsConfig;return t._title=f&&f.title?f.title:null,t._ariaLabel=f&&f.ariaLabel?f.ariaLabel:"cc-button",t._labelCb=f&&f.labelCallback&&typeof f.labelCallback=="function"?f.labelCallback:function(S){return S.name},t}return tt(i,[{key:"name",get:function(){return"closed_captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(yf)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,G.CONTAINER_SUBTITLE_AVAILABLE,this.onSubtitleAvailable),this.listenTo(this.container,G.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,G.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){this.ccAvailable(!1),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(t){this.setCurrentContextMenuElement(t.id)}},{key:"onTrackSelect",value:function(t){var f=parseInt(t.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=f,this.hideContextMenu(),t.stopPropagation(),!1}},{key:"ccAvailable",value:function(t){var f=t?"addClass":"removeClass";this.$el[f]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(t){return this.$el.find("ul a"+(isNaN(t)?"":'[data-cc-select="'+t+'"]')).parent()}},{key:"setCurrentContextMenuElement",value:function(t){if(this._trackId!==t){this.contextMenuElement().removeClass("current"),this.contextMenuElement(t).addClass("current");var f=t>-1?"addClass":"removeClass";this.$ccButton[f]("enabled"),this._trackId=t}}},{key:"renderCcButton",value:function(){for(var t=this.container?this.container.closedCaptionsTracks:[],f=0;f<t.length;f++)t[f].label=this._labelCb(t[f]);var S=Qe.getStyleFor(Ef,{baseUrl:this.options.baseUrl});this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(mf),this.$el.append(S[0])}},{key:"render",value:function(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");return t[0]?this.$el.insertAfter(t):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),i})(Tt),_f=`<div class="live-info"><%= live %></div>
<button type="button" class="live-button" aria-label="<%= backToLive %>"><%= backToLive %></button>
`,Tf=`.dvr-controls[data-dvr-controls] {
  display: inline-block;
  float: left;
  color: #fff;
  line-height: 32px;
  font-size: 10px;
  font-weight: bold;
  margin-left: 6px; }
  .dvr-controls[data-dvr-controls] .live-info {
    cursor: default;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase; }
    .dvr-controls[data-dvr-controls] .live-info:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #ff0101; }
    .dvr-controls[data-dvr-controls] .live-info.disabled {
      opacity: 0.3; }
      .dvr-controls[data-dvr-controls] .live-info.disabled:before {
        background-color: #fff; }
  .dvr-controls[data-dvr-controls] .live-button {
    cursor: pointer;
    outline: none;
    display: none;
    border: 0;
    color: #fff;
    background-color: transparent;
    height: 32px;
    padding: 0;
    opacity: 0.7;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase;
    transition: all 0.1s ease; }
    .dvr-controls[data-dvr-controls] .live-button:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #fff; }
    .dvr-controls[data-dvr-controls] .live-button:hover {
      opacity: 1;
      text-shadow: rgba(255, 255, 255, 0.75) 0 0 5px; }

.dvr .dvr-controls[data-dvr-controls] .live-info {
  display: none; }

.dvr .dvr-controls[data-dvr-controls] .live-button {
  display: block; }

.dvr.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #005aff; }

.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #ff0101; }
`,bf=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.settingsUpdate(),t}return tt(i,[{key:"template",get:function(){return at(_f)}},{key:"name",get:function(){return"dvr_controls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"events",get:function(){return{"click .live-button":"click"}}},{key:"attributes",get:function(){return{class:"dvr-controls","data-dvr-controls":""}}},{key:"bindEvents",value:function(){this.bindCoreEvents(),this.bindContainerEvents()}},{key:"bindCoreEvents",value:function(){var t=this;this.core.mediaControl.settings?(this.listenTo(this.core.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.settingsUpdate),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.render)):setTimeout(function(){return t.bindCoreEvents()},100)}},{key:"bindContainerEvents",value:function(){this.core.activeContainer&&(this.listenToOnce(this.core.activeContainer,G.CONTAINER_TIMEUPDATE,this.render),this.listenTo(this.core.activeContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.dvrChanged))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"dvrChanged",value:function(t){this.core.getPlaybackType()===me.LIVE&&(this.settingsUpdate(),this.core.mediaControl.$el.addClass("live"),t?(this.core.mediaControl.$el.addClass("dvr"),this.core.mediaControl.$el.find(".media-control-indicator[data-position], .media-control-indicator[data-duration]").hide()):this.core.mediaControl.$el.removeClass("dvr"))}},{key:"click",value:function(){var t=this.core.mediaControl,f=t.container;f.isPlaying()||f.play(),t.$el.hasClass("dvr")&&f.seek(f.getDuration())}},{key:"settingsUpdate",value:function(){var t=this;this.stopListening(),this.core.mediaControl.$el.removeClass("live"),this.shouldRender()&&(this.render(),this.$el.click(function(){return t.click()})),this.bindEvents()}},{key:"shouldRender",value:function(){var t=this.core.options.useDvrControls===void 0||!!this.core.options.useDvrControls;return t&&this.core.getPlaybackType()===me.LIVE}},{key:"render",value:function(){var t=Qe.getStyleFor(Tf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({live:this.core.i18n.t("live"),backToLive:this.core.i18n.t("back_to_live")})),this.$el.append(t[0]),this.shouldRender()&&(this.core.mediaControl.$el.addClass("live"),this.core.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.$el)),this}}]),i})(Tt),Sf=(function(e){rt(i,e);var n=nt(i);function i(){return et(this,i),n.apply(this,arguments)}return tt(i,[{key:"name",get:function(){return"end_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);var t=this.core.activeContainer;t&&(this.listenTo(t,G.CONTAINER_ENDED,this.ended),this.listenTo(t,G.CONTAINER_STOP,this.ended))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"ended",value:function(){var t=typeof this.core.options.exitFullscreenOnEnd>"u"||this.core.options.exitFullscreenOnEnd;t&&this.core.isFullscreen()&&this.core.toggleFullscreen()}}]),i})(Kt),xf=`<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`,Cf=`<div class="player-error-screen__content" data-error-screen>
  <% if (icon) { %>
  <div class="player-error-screen__icon" data-error-screen><%= icon %></div>
  <% } %>
  <div class="player-error-screen__title" data-error-screen><%= title %></div>
  <div class="player-error-screen__message" data-error-screen><%= message %></div>
  <div class="player-error-screen__code" data-error-screen>Error code: <%= code %></div>
  <div class="player-error-screen__reload" data-error-screen><%= reloadIcon %></div>
</div>
`,Lf=`[data-player] .player-error-screen {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #CCCACA;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center; }
  [data-player] .player-error-screen__content[data-error-screen] {
    font-size: 14px;
    color: #CCCACA;
    margin-top: 45px; }
  [data-player] .player-error-screen__title[data-error-screen] {
    font-weight: bold;
    line-height: 30px;
    font-size: 18px; }
  [data-player] .player-error-screen__message[data-error-screen] {
    width: 90%;
    margin: 0 auto; }
  [data-player] .player-error-screen__code[data-error-screen] {
    font-size: 13px;
    margin-top: 15px; }
  [data-player] .player-error-screen__reload {
    cursor: pointer;
    width: 30px;
    margin: 15px auto 0 !important; }
`,Df=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.options.disableErrorScreen?qs(t,t.disable()):t}return tt(i,[{key:"name",get:function(){return"error_screen"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(Cf)}},{key:"container",get:function(){return this.core.getCurrentContainer()}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.ERROR,this.onError),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onContainerChanged)}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var t=this;this.listenToOnce(this.core,G.CORE_READY,function(){return t.container.play()}),this.core.load(this.options.sources,this.options.mimeType),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onContainerChanged",value:function(){this.err=null,this.unbindReload(),this.hide()}},{key:"onError",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.level===ot.Levels.FATAL&&(this.err=t,this.container.disableMediaControl(),this.container.stop(),this.show())}},{key:"show",value:function(){this.render(),this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"render",value:function(){if(this.err){var t=Qe.getStyleFor(Lf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({title:this.err.UI.title,message:this.err.UI.message,code:this.err.code,icon:this.err.UI.icon||"",reloadIcon:xf})),this.$el.append(t[0]),this.core.$el.append(this.el),this.bindReload(),this}}}]),i})(Tt),er=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"/>
</svg>`,hi=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 14.76H6.43V1.24H1.71v13.52zm7.86-13.52v13.52h4.716V1.24H9.573z"/>
</svg>`,Of=ve('link[rel="shortcut icon"]'),Pf=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t._container=null,t.configure(),t}return tt(i,[{key:"name",get:function(){return"favicon"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"oldIcon",get:function(){return Of}},{key:"configure",value:function(){this.core.options.changeFavicon?this.enabled||(this.stopListening(this.core,G.CORE_OPTIONS_CHANGE),this.enable()):this.enabled&&(this.disable(),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure))}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.core.activeContainer&&this.containerChanged()}},{key:"containerChanged",value:function(){this._container&&this.stopListening(this._container),this._container=this.core.activeContainer,this.listenTo(this._container,G.CONTAINER_PLAY,this.setPlayIcon),this.listenTo(this._container,G.CONTAINER_PAUSE,this.setPauseIcon),this.listenTo(this._container,G.CONTAINER_STOP,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ENDED,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ERROR,this.resetIcon),this.resetIcon()}},{key:"disable",value:function(){mr(Wt(i.prototype),"disable",this).call(this),this.resetIcon()}},{key:"destroy",value:function(){mr(Wt(i.prototype),"destroy",this).call(this),this.resetIcon()}},{key:"createIcon",value:function(t){var f=ve("<canvas/>");f[0].width=16,f[0].height=16;var S=f[0].getContext("2d");S.fillStyle="#000";var L=ve(t).find("path").attr("d"),h=new Path2D(L);S.fill(h);var F=ve('<link rel="shortcut icon" type="image/png"/>');return F.attr("href",f[0].toDataURL("image/png")),F}},{key:"setPlayIcon",value:function(){this.playIcon||(this.playIcon=this.createIcon(er)),this.changeIcon(this.playIcon)}},{key:"setPauseIcon",value:function(){this.pauseIcon||(this.pauseIcon=this.createIcon(hi)),this.changeIcon(this.pauseIcon)}},{key:"resetIcon",value:function(){ve('link[rel="shortcut icon"]').remove(),ve("head").append(this.oldIcon)}},{key:"changeIcon",value:function(t){t&&(ve('link[rel="shortcut icon"]').remove(),ve("head").append(t))}}]),i})(Kt),If=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.container.options.gaAccount&&(t.account=t.container.options.gaAccount,t.trackerName=t.container.options.gaTrackerName?t.container.options.gaTrackerName+".":"Clappr.",t.domainName=t.container.options.gaDomainName,t.currentHDState=void 0,t.embedScript()),t}return tt(i,[{key:"name",get:function(){return"google_analytics"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"embedScript",value:function(){var t=this;if(window._gat)this.addEventListeners();else{var f=document.createElement("script");f.setAttribute("type","text/javascript"),f.setAttribute("async","async"),f.setAttribute("src","//www.google-analytics.com/ga.js"),f.onload=function(){return t.addEventListeners()},document.body.appendChild(f)}}},{key:"addEventListeners",value:function(){var t=this;this.container&&(this.listenTo(this.container,G.CONTAINER_READY,this.onReady),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PAUSE,this.onPause),this.listenTo(this.container,G.CONTAINER_ENDED,this.onEnded),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.listenTo(this.container,G.CONTAINER_PLAYBACKSTATE,this.onPlaybackChanged),this.listenTo(this.container,G.CONTAINER_VOLUME,function(f){return t.onVolumeChanged(f)}),this.listenTo(this.container,G.CONTAINER_SEEK,function(f){return t.onSeek(f)}),this.listenTo(this.container,G.CONTAINER_FULL_SCREEN,this.onFullscreen),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.onHD),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.onDVR)),_gaq.push([this.trackerName+"_setAccount",this.account]),this.domainName&&_gaq.push([this.trackerName+"_setDomainName",this.domainName])}},{key:"onReady",value:function(){this.push(["Video","Playback",this.container.playback.name])}},{key:"onPlay",value:function(){this.push(["Video","Play",this.container.playback.src])}},{key:"onStop",value:function(){this.push(["Video","Stop",this.container.playback.src])}},{key:"onEnded",value:function(){this.push(["Video","Ended",this.container.playback.src])}},{key:"onBuffering",value:function(){this.push(["Video","Buffering",this.container.playback.src])}},{key:"onBufferFull",value:function(){this.push(["Video","Bufferfull",this.container.playback.src])}},{key:"onError",value:function(){this.push(["Video","Error",this.container.playback.src])}},{key:"onHD",value:function(t){var f=t?"ON":"OFF";f!==this.currentHDState&&(this.currentHDState=f,this.push(["Video","HD - "+f,this.container.playback.src]))}},{key:"onPlaybackChanged",value:function(t){t.type!==null&&this.push(["Video","Playback Type - "+t.type,this.container.playback.src])}},{key:"onDVR",value:function(t){var f=t?"ON":"OFF";this.push(["Interaction","DVR - "+f,this.container.playback.src])}},{key:"onPause",value:function(){this.push(["Video","Pause",this.container.playback.src])}},{key:"onSeek",value:function(){this.push(["Video","Seek",this.container.playback.src])}},{key:"onVolumeChanged",value:function(){this.push(["Interaction","Volume",this.container.playback.src])}},{key:"onFullscreen",value:function(){this.push(["Interaction","Fullscreen",this.container.playback.src])}},{key:"push",value:function(t){var f=[this.trackerName+"_trackEvent"].concat(t);_gaq.push(f)}}]),i})(nr),ue=function(n){this.element=n||window.document,this.initialize()};ue.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};ue.KEY_CODES_BY_NAME={};(function(){for(var e in ue.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(ue.KEY_NAMES_BY_CODE,e)&&(ue.KEY_CODES_BY_NAME[ue.KEY_NAMES_BY_CODE[e]]=+e)})();ue.MODIFIERS=["shift","ctrl","alt"];ue.registerEvent=(function(){if(document.addEventListener)return function(e,n,i){e.addEventListener(n,i,!1)};if(document.attachEvent)return function(e,n,i){e.attachEvent("on"+n,i)}})();ue.unregisterEvent=(function(){if(document.removeEventListener)return function(e,n,i){e.removeEventListener(n,i,!1)};if(document.detachEvent)return function(e,n,i){e.detachEvent("on"+n,i)}})();ue.stringContains=function(e,n){return e.indexOf(n)!==-1};ue.neatString=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")};ue.capitalize=function(e){return e.toLowerCase().replace(/^./,function(n){return n.toUpperCase()})};ue.isString=function(e){return ue.stringContains(Object.prototype.toString.call(e),"String")};ue.arrayIncludes=(function(){return Array.prototype.indexOf?function(e,n){return e.indexOf(n)!==-1}:function(e,n){for(var i=0;i<e.length;i++)if(e[i]===n)return!0;return!1}})();ue.extractModifiers=function(e){var n,i;for(n=[],i=0;i<ue.MODIFIERS.length;i++)ue.stringContains(e,ue.MODIFIERS[i])&&n.push(ue.MODIFIERS[i]);return n};ue.extractKey=function(e){var n,i;for(n=ue.neatString(e).split(" "),i=0;i<n.length;i++)if(!ue.arrayIncludes(ue.MODIFIERS,n[i]))return n[i]};ue.modifiersAndKey=function(e){var n,i;return ue.stringContains(e,"any")?ue.neatString(e).split(" ").slice(0,2).join(" "):(n=ue.extractModifiers(e),i=ue.extractKey(e),i&&!ue.arrayIncludes(ue.MODIFIERS,i)&&n.push(i),n.join(" "))};ue.keyName=function(e){return ue.KEY_NAMES_BY_CODE[e+""]};ue.keyCode=function(e){return+ue.KEY_CODES_BY_NAME[e]};ue.prototype.initialize=function(){var e,n=this;for(this.lastKeyCode=-1,this.lastModifiers={},e=0;e<ue.MODIFIERS.length;e++)this.lastModifiers[ue.MODIFIERS[e]]=!1;this.keysDown={any:[]},this.keysUp={any:[]},this.downHandler=this.handler("down"),this.upHandler=this.handler("up"),ue.registerEvent(this.element,"keydown",this.downHandler),ue.registerEvent(this.element,"keyup",this.upHandler),ue.registerEvent(window,"unload",function i(){ue.unregisterEvent(n.element,"keydown",n.downHandler),ue.unregisterEvent(n.element,"keyup",n.upHandler),ue.unregisterEvent(window,"unload",i)})};ue.prototype.handler=function(e){var n=this;return function(i){var r,t,f;for(i=i||window.event,n.lastKeyCode=i.keyCode,r=0;r<ue.MODIFIERS.length;r++)n.lastModifiers[ue.MODIFIERS[r]]=i[ue.MODIFIERS[r]+"Key"];for(ue.arrayIncludes(ue.MODIFIERS,ue.keyName(n.lastKeyCode))&&(n.lastModifiers[ue.keyName(n.lastKeyCode)]=!0),t=n["keys"+ue.capitalize(e)],r=0;r<t.any.length;r++)t.any[r](i)===!1&&i.preventDefault&&i.preventDefault();if(f=n.lastModifiersAndKey(),t[f])for(r=0;r<t[f].length;r++)t[f][r](i)===!1&&i.preventDefault&&i.preventDefault()}};ue.prototype.registerKeys=function(e,n,i){var r,t,f=this["keys"+ue.capitalize(e)];for(ue.isString(n)&&(n=[n]),r=0;r<n.length;r++)t=n[r],t=ue.modifiersAndKey(t+""),f[t]?f[t].push(i):f[t]=[i];return this};ue.prototype.unregisterKeys=function(e,n,i){var r,t,f,S=this["keys"+ue.capitalize(e)];for(ue.isString(n)&&(n=[n]),r=0;r<n.length;r++)if(f=n[r],f=ue.modifiersAndKey(f+""),i===null)delete S[f];else if(S[f]){for(t=0;t<S[f].length;t++)if(String(S[f][t])===String(i)){S[f].splice(t,1);break}}return this};ue.prototype.off=function(e){return this.unregisterKeys("down",e,null)};ue.prototype.delegate=function(e,n,i){return i!==null||i!==void 0?this.registerKeys(e,n,i):this.unregisterKeys(e,n,i)};ue.prototype.down=function(e,n){return this.delegate("down",e,n)};ue.prototype.up=function(e,n){return this.delegate("up",e,n)};ue.prototype.lastKey=function(e){return e?this.lastModifiers[e]:ue.keyName(this.lastKeyCode)};ue.prototype.lastModifiersAndKey=function(){var e,n;for(e=[],n=0;n<ue.MODIFIERS.length;n++)this.lastKey(ue.MODIFIERS[n])&&e.push(ue.MODIFIERS[n]);return ue.arrayIncludes(e,this.lastKey())||e.push(this.lastKey()),e.join(" ")};var Rf=`.media-control-notransition {
  transition: none !important; }

.media-control[data-media-control] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 9999;
  pointer-events: none; }
  .media-control[data-media-control].dragging {
    pointer-events: auto;
    cursor: grabbing !important;
    cursor: url("closed-hand.cur"), move; }
    .media-control[data-media-control].dragging * {
      cursor: grabbing !important;
      cursor: url("closed-hand.cur"), move; }
  .media-control[data-media-control] .media-control-background[data-background] {
    position: absolute;
    height: 40%;
    width: 100%;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
    will-change: transform, opacity;
    transition: opacity 0.6s ease-out; }
  .media-control[data-media-control] .media-control-icon {
    line-height: 0;
    letter-spacing: 0;
    speak: none;
    color: #fff;
    opacity: 0.5;
    vertical-align: middle;
    text-align: left;
    transition: all 0.1s ease; }
  .media-control[data-media-control] .media-control-icon:hover {
    color: white;
    opacity: 0.75;
    text-shadow: rgba(255, 255, 255, 0.8) 0 0 5px; }
  .media-control[data-media-control].media-control-hide .media-control-background[data-background] {
    opacity: 0; }
  .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] {
    transform: translateY(50px); }
    .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
      opacity: 0; }
  .media-control[data-media-control] .media-control-layer[data-controls] {
    position: absolute;
    transform: translateY(-7px);
    bottom: 0;
    width: 100%;
    height: 32px;
    font-size: 0;
    vertical-align: middle;
    pointer-events: auto;
    transition: bottom 0.4s ease-out; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-left-panel[data-media-control] {
      position: absolute;
      top: 0;
      left: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-center-panel[data-media-control] {
      height: 100%;
      text-align: center;
      line-height: 32px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-right-panel[data-media-control] {
      position: absolute;
      top: 0;
      right: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button {
      background-color: transparent;
      border: 0;
      margin: 0 6px;
      padding: 0;
      cursor: pointer;
      display: inline-block;
      width: 32px;
      height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg {
        width: 100%;
        height: 22px; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg path {
          fill: white; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button:focus {
        outline: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-play] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-pause] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-stop] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-fullscreen] {
        float: right;
        background-color: transparent;
        border: 0;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator] {
        background-color: transparent;
        border: 0;
        cursor: default;
        display: none;
        float: right;
        height: 100%; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled {
          display: block;
          opacity: 1.0; }
          .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled:hover {
            opacity: 1.0;
            text-shadow: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playpause] {
        float: left; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playstop] {
        float: left; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position], .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      display: inline-block;
      font-size: 10px;
      color: white;
      cursor: default;
      line-height: 32px;
      position: relative; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position] {
      margin: 0 6px 0 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      color: rgba(255, 255, 255, 0.5);
      margin-right: 6px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration]:before {
        content: "|";
        margin-right: 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] {
      position: absolute;
      top: -20px;
      left: 0;
      display: inline-block;
      vertical-align: middle;
      width: 100%;
      height: 25px;
      cursor: pointer; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] {
        width: 100%;
        height: 1px;
        position: relative;
        top: 12px;
        background-color: #666666; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-1[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #c2c2c2;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #005aff;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0;
          position: absolute;
          top: -3px;
          width: 5px;
          height: 7px;
          background-color: rgba(255, 255, 255, 0.5);
          transition: opacity 0.1s ease; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar]:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
        opacity: 1; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled {
        cursor: default; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
        position: absolute;
        transform: translateX(-50%);
        top: 2px;
        left: 0;
        width: 20px;
        height: 20px;
        opacity: 1;
        transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] .bar-scrubber-icon[data-seekbar] {
          position: absolute;
          left: 6px;
          top: 6px;
          width: 8px;
          height: 8px;
          border-radius: 10px;
          box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
          background-color: white; }
    .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] {
      float: right;
      display: inline-block;
      height: 32px;
      cursor: pointer;
      margin: 0 6px;
      box-sizing: border-box; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] {
        float: left;
        bottom: 0; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] {
          background-color: transparent;
          border: 0;
          box-sizing: content-box;
          width: 32px;
          height: 32px;
          opacity: 0.5; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume]:hover {
            opacity: 0.75; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg {
            height: 24px;
            position: relative;
            top: 3px; }
            .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg path {
              fill: white; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume].muted svg {
            margin-left: 2px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] {
        float: left;
        position: relative;
        overflow: hidden;
        top: 6px;
        width: 42px;
        height: 18px;
        padding: 3px 0;
        transition: width .2s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] {
          height: 1px;
          position: relative;
          top: 7px;
          margin: 0 3px;
          background-color: #666666; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-1[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #c2c2c2;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-2[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #005aff;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-hover[data-volume] {
            opacity: 0;
            position: absolute;
            top: -3px;
            width: 5px;
            height: 7px;
            background-color: rgba(255, 255, 255, 0.5);
            transition: opacity 0.1s ease; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] {
          position: absolute;
          transform: translateX(-50%);
          top: 0px;
          left: 0;
          width: 20px;
          height: 20px;
          opacity: 1;
          transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] .bar-scrubber-icon[data-volume] {
            position: absolute;
            left: 6px;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 10px;
            box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
            background-color: white; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume] {
          float: left;
          width: 4px;
          padding-left: 2px;
          height: 12px;
          opacity: 0.5;
          box-shadow: inset 2px 0 0 white;
          transition: transform .2s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume].fill {
            box-shadow: inset 2px 0 0 #fff;
            opacity: 1; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:nth-of-type(1) {
            padding-left: 0; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:hover {
            transform: scaleY(1.5); }
  .media-control[data-media-control].w320 .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume].volume-bar-hide {
    width: 0;
    height: 12px;
    top: 9px;
    padding: 0; }
`,kf=`<div class="media-control-background" data-background></div>
<div class="media-control-layer" data-controls>
  <%  var renderBar = function(name) { %>
      <div class="bar-container" data-<%= name %>>
        <div class="bar-background" data-<%= name %>>
          <div class="bar-fill-1" data-<%= name %>></div>
          <div class="bar-fill-2" data-<%= name %>></div>
          <div class="bar-hover" data-<%= name %>></div>
        </div>
        <div class="bar-scrubber" data-<%= name %>>
          <div class="bar-scrubber-icon" data-<%= name %>></div>
        </div>
      </div>
  <%  }; %>
  <%  var renderSegmentedBar = function(name, segments) {
      segments = segments || 10; %>
    <div class="bar-container" data-<%= name %>>
    <% for (var i = 0; i < segments; i++) { %>
      <div class="segmented-bar-element" data-<%= name %>></div>
    <% } %>
    </div>
  <% }; %>
  <% var renderDrawer = function(name, renderContent) { %>
      <div class="drawer-container" data-<%= name %>>
        <div class="drawer-icon-container" data-<%= name %>>
          <div class="drawer-icon media-control-icon" data-<%= name %>></div>
          <span class="drawer-text" data-<%= name %>></span>
        </div>
        <% renderContent(name); %>
      </div>
  <% }; %>
  <% var renderIndicator = function(name) { %>
      <div class="media-control-indicator" data-<%= name %>></div>
  <% }; %>
  <% var renderButton = function(name) { %>
    <button type="button" class="media-control-button media-control-icon" data-<%= name %> aria-label="<%= name %>"></button>
  <% }; %>
  <%  var templates = {
        bar: renderBar,
        segmentedBar: renderSegmentedBar,
      };
      var render = function(settingsList) {
        settingsList.forEach(function(setting) {
          if(setting === "seekbar") {
            renderBar(setting);
          } else if (setting === "volume") {
            renderDrawer(setting, settings.volumeBarTemplate ? templates[settings.volumeBarTemplate] : function(name) { return renderSegmentedBar(name); });
          } else if (setting === "duration" || setting === "position") {
            renderIndicator(setting);
          } else {
            renderButton(setting);
          }
        });
      }; %>
  <% if (settings.default && settings.default.length) { %>
  <div class="media-control-center-panel" data-media-control>
    <% render(settings.default); %>
  </div>
  <% } %>
  <% if (settings.left && settings.left.length) { %>
  <div class="media-control-left-panel" data-media-control>
    <% render(settings.left); %>
  </div>
  <% } %>
  <% if (settings.right && settings.right.length) { %>
  <div class="media-control-right-panel" data-media-control>
    <% render(settings.right); %>
  </div>
  <% } %>
</div>
`,Oa=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 1.24h12.6v13.52h-12.6z"/>
</svg>`,Pa=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M11.5 11h-.002v1.502L7.798 10H4.5V6h3.297l3.7-2.502V4.5h.003V11zM11 4.49L7.953 6.5H5v3h2.953L11 11.51V4.49z"/>
</svg>`,Mf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M9.75 11.51L6.7 9.5H3.75v-3H6.7L9.75 4.49v.664l.497.498V3.498L6.547 6H3.248v4h3.296l3.7 2.502v-2.154l-.497.5v.662zm3-5.165L12.404 6l-1.655 1.653L9.093 6l-.346.345L10.402 8 8.747 9.654l.346.347 1.655-1.653L12.403 10l.348-.346L11.097 8l1.655-1.655z"/>
</svg>`,Ia=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M7.156 8L4 11.156V8.5H3V13h4.5v-1H4.844L8 8.844 7.156 8zM8.5 3v1h2.657L8 7.157 8.846 8 12 4.844V7.5h1V3H8.5z"/>
</svg>`,wf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M13.5 3.344l-.844-.844L9.5 5.656V3h-1v4.5H13v-1h-2.656L13.5 3.344zM3 9.5h2.656L2.5 12.656l.844.844L6.5 10.344V13h1V8.5H3v1z"/>
</svg>`,Nf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M5.375 7.062H2.637V4.26H.502v7.488h2.135V8.9h2.738v2.848h2.133V4.26H5.375v2.802zm5.97-2.81h-2.84v7.496h2.798c2.65 0 4.195-1.607 4.195-3.77v-.022c0-2.162-1.523-3.704-4.154-3.704zm2.06 3.758c0 1.21-.81 1.896-2.03 1.896h-.83V6.093h.83c1.22 0 2.03.696 2.03 1.896v.02z"/>
</svg>`,Ra=Ht.Config,ka=Ht.Fullscreen,Ma=Ht.formatTime,Ff=Ht.extend,$n=Ht.removeArrayItem,vi=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.persistConfig=t.options.persistConfig,t.currentPositionValue=null,t.currentDurationValue=null,t.keepVisible=!1,t.fullScreenOnVideoTagSupported=null,t.setInitialVolume(),t.settings={left:["play","stop","pause"],right:["volume"],default:["position","seekbar","duration"]},t.kibo=new ue(t.options.focusElement),t.bindKeyEvents(),t.container?ve.isEmptyObject(t.container.settings)||(t.settings=ve.extend({},t.container.settings)):t.settings={},t.userDisabled=!1,(t.container&&t.container.mediaControlDisabled||t.options.chromeless)&&t.disable(),t.stopDragHandler=function(f){return t.stopDrag(f)},t.updateDragHandler=function(f){return t.updateDrag(f)},ve(document).bind("mouseup",t.stopDragHandler),ve(document).bind("mousemove",t.updateDragHandler),t}return tt(i,[{key:"name",get:function(){return"media_control"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"disabled",get:function(){var t=this.container&&this.container.getPlaybackType()===me.NO_OP;return this.userDisabled||t}},{key:"container",get:function(){return this.core&&this.core.activeContainer}},{key:"playback",get:function(){return this.core&&this.core.activePlayback}},{key:"attributes",get:function(){return{class:"media-control","data-media-control":""}}},{key:"events",get:function(){return{"click [data-play]":"play","click [data-pause]":"pause","click [data-playpause]":"togglePlayPause","click [data-stop]":"stop","click [data-playstop]":"togglePlayStop","click [data-fullscreen]":"toggleFullscreen","click .bar-container[data-seekbar]":"seek","click .bar-container[data-volume]":"onVolumeClick","click .drawer-icon[data-volume]":"toggleMute","mouseenter .drawer-container[data-volume]":"showVolumeBar","mouseleave .drawer-container[data-volume]":"hideVolumeBar","mousedown .bar-container[data-volume]":"startVolumeDrag","mousemove .bar-container[data-volume]":"mousemoveOnVolumeBar","mousedown .bar-scrubber[data-seekbar]":"startSeekDrag","mousemove .bar-container[data-seekbar]":"mousemoveOnSeekBar","mouseleave .bar-container[data-seekbar]":"mouseleaveOnSeekBar","mouseenter .media-control-layer[data-controls]":"setUserKeepVisible","mouseleave .media-control-layer[data-controls]":"resetUserKeepVisible"}}},{key:"template",get:function(){return at(kf)}},{key:"volume",get:function(){return this.container&&this.container.isReady?this.container.volume:this.intendedVolume}},{key:"muted",get:function(){return this.volume===0}},{key:"getExternalInterface",value:function(){var t=this;return{setVolume:this.setVolume,getVolume:function(){return t.volume}}}},{key:"bindEvents",value:function(){var t=this;this.stopListening(),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onActiveContainerChanged),this.listenTo(this.core,G.CORE_MOUSE_MOVE,this.show),this.listenTo(this.core,G.CORE_MOUSE_LEAVE,function(){return t.hide(t.options.hideMediaControlDelay)}),this.listenTo(this.core,G.CORE_FULLSCREEN,this.show),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_RESIZE,this.playerResize),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container&&(this.listenTo(this.container,G.CONTAINER_PLAY,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_PAUSE,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_STOP,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_DBLCLICK,this.toggleFullscreen),this.listenTo(this.container,G.CONTAINER_TIMEUPDATE,this.onTimeUpdate),this.listenTo(this.container,G.CONTAINER_PROGRESS,this.updateProgressBar),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_DISABLE,this.disable),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_ENABLE,this.enable),this.listenTo(this.container,G.CONTAINER_ENDED,this.ended),this.listenTo(this.container,G.CONTAINER_VOLUME,this.onVolumeChanged),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.setInitialVolume),this.container.playback.el.nodeName.toLowerCase()==="video"&&this.listenToOnce(this.container,G.CONTAINER_LOADEDMETADATA,this.onLoadedMetadataOnVideoTag))}},{key:"disable",value:function(){this.userDisabled=!0,this.hide(),this.unbindKeyEvents(),this.$el.hide()}},{key:"enable",value:function(){this.options.chromeless||(this.userDisabled=!1,this.bindKeyEvents(),this.show())}},{key:"play",value:function(){this.container&&this.container.play()}},{key:"pause",value:function(){this.container&&this.container.pause()}},{key:"stop",value:function(){this.container&&this.container.stop()}},{key:"setInitialVolume",value:function(){var t=this.persistConfig?Ra.restore("volume"):100,f=this.container&&this.container.options||this.options;this.setVolume(f.mute?0:t,!0)}},{key:"onVolumeChanged",value:function(){this.updateVolumeUI()}},{key:"onLoadedMetadataOnVideoTag",value:function(){var t=this.playback&&this.playback.el;!ka.fullscreenEnabled()&&t.webkitSupportsFullscreen&&(this.fullScreenOnVideoTagSupported=!0,this.settingsUpdate())}},{key:"updateVolumeUI",value:function(){if(this.rendered){this.$volumeBarContainer.find(".bar-fill-2").css({});var t=this.$volumeBarContainer.width(),f=this.$volumeBarBackground.width(),S=(t-f)/2,L=f*this.volume/100+S;this.$volumeBarFill.css({width:"".concat(this.volume,"%")}),this.$volumeBarScrubber.css({left:L}),this.$volumeBarContainer.find(".segmented-bar-element").removeClass("fill");var h=Math.ceil(this.volume/10);this.$volumeBarContainer.find(".segmented-bar-element").slice(0,h).addClass("fill"),this.$volumeIcon.html(""),this.$volumeIcon.removeClass("muted"),this.muted?(this.$volumeIcon.append(Mf),this.$volumeIcon.addClass("muted")):this.$volumeIcon.append(Pa),this.applyButtonStyle(this.$volumeIcon)}}},{key:"changeTogglePlay",value:function(){this.$playPauseToggle.html(""),this.$playStopToggle.html(""),this.container&&this.container.isPlaying()?(this.$playPauseToggle.append(hi),this.$playStopToggle.append(Oa),this.trigger(G.MEDIACONTROL_PLAYING)):(this.$playPauseToggle.append(er),this.$playStopToggle.append(er),this.trigger(G.MEDIACONTROL_NOTPLAYING),fe.isMobile&&this.show()),this.applyButtonStyle(this.$playPauseToggle),this.applyButtonStyle(this.$playStopToggle)}},{key:"mousemoveOnSeekBar",value:function(t){if(this.settings.seekEnabled){var f=t.pageX-this.$seekBarContainer.offset().left-this.$seekBarHover.width()/2;this.$seekBarHover.css({left:f})}this.trigger(G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,t)}},{key:"mouseleaveOnSeekBar",value:function(t){this.trigger(G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,t)}},{key:"onVolumeClick",value:function(t){this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"mousemoveOnVolumeBar",value:function(t){this.draggingVolumeBar&&this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"playerResize",value:function(t){this.$fullscreenToggle.html("");var f=this.core.isFullscreen()?wf:Ia;this.$fullscreenToggle.append(f),this.applyButtonStyle(this.$fullscreenToggle),this.$el.find(".media-control").length!==0&&this.$el.removeClass("w320"),(t.width<=320||this.options.hideVolumeBar)&&this.$el.addClass("w320")}},{key:"togglePlayPause",value:function(){return this.container.isPlaying()?this.container.pause():this.container.play(),!1}},{key:"togglePlayStop",value:function(){this.container.isPlaying()?this.container.stop():this.container.play()}},{key:"startSeekDrag",value:function(t){this.settings.seekEnabled&&(this.draggingSeekBar=!0,this.$el.addClass("dragging"),this.$seekBarLoaded.addClass("media-control-notransition"),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition"),t&&t.preventDefault())}},{key:"startVolumeDrag",value:function(t){this.draggingVolumeBar=!0,this.$el.addClass("dragging"),t&&t.preventDefault()}},{key:"stopDrag",value:function(t){this.draggingSeekBar&&this.seek(t),this.$el.removeClass("dragging"),this.$seekBarLoaded.removeClass("media-control-notransition"),this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition dragging"),this.draggingSeekBar=!1,this.draggingVolumeBar=!1}},{key:"updateDrag",value:function(t){if(this.draggingSeekBar){t.preventDefault();var f=t.pageX-this.$seekBarContainer.offset().left,S=f/this.$seekBarContainer.width()*100;S=Math.min(100,Math.max(S,0)),this.setSeekPercentage(S)}else this.draggingVolumeBar&&(t.preventDefault(),this.setVolume(this.getVolumeFromUIEvent(t)))}},{key:"getVolumeFromUIEvent",value:function(t){var f=t.pageX-this.$volumeBarContainer.offset().left,S=f/this.$volumeBarContainer.width()*100;return S}},{key:"toggleMute",value:function(){this.setVolume(this.muted?100:0)}},{key:"setVolume",value:function(t){var f=this,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t=Math.min(100,Math.max(t,0)),this.intendedVolume=t,this.persistConfig&&!S&&Ra.persist("volume",t);var L=function(){f.container&&f.container.isReady?f.container.setVolume(t):f.listenToOnce(f.container,G.CONTAINER_READY,function(){f.container.setVolume(t)})};this.container?L():this.listenToOnce(this,G.MEDIACONTROL_CONTAINERCHANGED,function(){return L()})}},{key:"toggleFullscreen",value:function(){this.trigger(G.MEDIACONTROL_FULLSCREEN,this.name),this.container.fullscreen(),this.core.toggleFullscreen(),this.resetUserKeepVisible()}},{key:"onActiveContainerChanged",value:function(){this.fullScreenOnVideoTagSupported=null,this.bindEvents(),this.setInitialVolume(),this.changeTogglePlay(),this.bindContainerEvents(),this.settingsUpdate(),this.container&&this.container.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.container.isDvrInUse()),this.container&&this.container.mediaControlDisabled&&this.disable(),this.trigger(G.MEDIACONTROL_CONTAINERCHANGED)}},{key:"showVolumeBar",value:function(){this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.$volumeBarContainer.removeClass("volume-bar-hide")}},{key:"hideVolumeBar",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:400;this.$volumeBarContainer&&(this.draggingVolumeBar?this.hideVolumeId=setTimeout(function(){return t.hideVolumeBar()},f):(this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.hideVolumeId=setTimeout(function(){return t.$volumeBarContainer.addClass("volume-bar-hide")},f)))}},{key:"ended",value:function(){this.changeTogglePlay()}},{key:"updateProgressBar",value:function(t){var f=t.start/t.total*100,S=t.current/t.total*100;this.$seekBarLoaded.css({left:"".concat(f,"%"),width:"".concat(S-f,"%")})}},{key:"onTimeUpdate",value:function(t){if(!this.draggingSeekBar){var f=t.current<0?t.total:t.current;this.currentPositionValue=f,this.currentDurationValue=t.total,this.renderSeekBar()}}},{key:"renderSeekBar",value:function(){if(!(this.currentPositionValue===null||this.currentDurationValue===null)){this.currentSeekBarPercentage=100,this.container&&(this.container.getPlaybackType()!==me.LIVE||this.container.isDvrInUse())&&(this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100),this.setSeekPercentage(this.currentSeekBarPercentage);var t=Ma(this.currentPositionValue),f=Ma(this.currentDurationValue);t!==this.displayedPosition&&(this.$position.text(t),this.displayedPosition=t),f!==this.displayedDuration&&(this.$duration.text(f),this.displayedDuration=f)}}},{key:"seek",value:function(t){if(this.settings.seekEnabled){var f=t.pageX-this.$seekBarContainer.offset().left,S=f/this.$seekBarContainer.width()*100;return S=Math.min(100,Math.max(S,0)),this.container&&this.container.seekPercentage(S),this.setSeekPercentage(S),!1}}},{key:"setKeepVisible",value:function(){this.keepVisible=!0}},{key:"resetKeepVisible",value:function(){this.keepVisible=!1}},{key:"setUserKeepVisible",value:function(){this.userKeepVisible=!0}},{key:"resetUserKeepVisible",value:function(){this.userKeepVisible=!1}},{key:"isVisible",value:function(){return!this.$el.hasClass("media-control-hide")}},{key:"show",value:function(t){var f=this;if(!this.disabled){var S=2e3,L=t&&t.clientX!==this.lastMouseX&&t.clientY!==this.lastMouseY;(!t||L||navigator.userAgent.match(/firefox/i))&&(clearTimeout(this.hideId),this.$el.show(),this.trigger(G.MEDIACONTROL_SHOW,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_SHOW,this.name),this.$el.removeClass("media-control-hide"),this.hideId=setTimeout(function(){return f.hide()},S),t&&(this.lastMouseX=t.clientX,this.lastMouseY=t.clientY));var h=!0;this.updateCursorStyle(h)}}},{key:"hide",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this.isVisible()){var S=f||2e3;if(clearTimeout(this.hideId),!(!this.disabled&&this.options.hideMediaControl===!1)){var L=this.userKeepVisible||this.keepVisible,h=this.draggingSeekBar||this.draggingVolumeBar;if(!this.disabled&&(f||L||h))this.hideId=setTimeout(function(){return t.hide()},S);else{this.trigger(G.MEDIACONTROL_HIDE,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_HIDE,this.name),this.$el.addClass("media-control-hide"),this.hideVolumeBar(0);var F=!1;this.updateCursorStyle(F)}}}}},{key:"updateCursorStyle",value:function(t){t?this.core.$el.removeClass("nocursor"):this.core.isFullscreen()&&this.core.$el.addClass("nocursor")}},{key:"settingsUpdate",value:function(){var t=this.getSettings();t&&!this.fullScreenOnVideoTagSupported&&!ka.fullscreenEnabled()&&(t.default&&$n(t.default,"fullscreen"),t.left&&$n(t.left,"fullscreen"),t.right&&$n(t.right,"fullscreen"));var f=JSON.stringify(this.settings)!==JSON.stringify(t);f&&(this.settings=t,this.render())}},{key:"getSettings",value:function(){return ve.extend(!0,{},this.container&&this.container.settings)}},{key:"highDefinitionUpdate",value:function(t){this.isHD=t;var f=t?"addClass":"removeClass";this.$hdIndicator[f]("enabled")}},{key:"createCachedElements",value:function(){var t=this.$el.find(".media-control-layer");this.$duration=t.find(".media-control-indicator[data-duration]"),this.$fullscreenToggle=t.find("button.media-control-button[data-fullscreen]"),this.$playPauseToggle=t.find("button.media-control-button[data-playpause]"),this.$playStopToggle=t.find("button.media-control-button[data-playstop]"),this.$position=t.find(".media-control-indicator[data-position]"),this.$seekBarContainer=t.find(".bar-container[data-seekbar]"),this.$seekBarHover=t.find(".bar-hover[data-seekbar]"),this.$seekBarLoaded=t.find(".bar-fill-1[data-seekbar]"),this.$seekBarPosition=t.find(".bar-fill-2[data-seekbar]"),this.$seekBarScrubber=t.find(".bar-scrubber[data-seekbar]"),this.$volumeBarContainer=t.find(".bar-container[data-volume]"),this.$volumeContainer=t.find(".drawer-container[data-volume]"),this.$volumeIcon=t.find(".drawer-icon[data-volume]"),this.$volumeBarBackground=this.$el.find(".bar-background[data-volume]"),this.$volumeBarFill=this.$el.find(".bar-fill-1[data-volume]"),this.$volumeBarScrubber=this.$el.find(".bar-scrubber[data-volume]"),this.$hdIndicator=this.$el.find("button.media-control-button[data-hd-indicator]"),this.resetIndicators(),this.initializeIcons()}},{key:"resetIndicators",value:function(){this.displayedPosition=this.$position.text(),this.displayedDuration=this.$duration.text()}},{key:"initializeIcons",value:function(){var t=this.$el.find(".media-control-layer");t.find("button.media-control-button[data-play]").append(er),t.find("button.media-control-button[data-pause]").append(hi),t.find("button.media-control-button[data-stop]").append(Oa),this.$playPauseToggle.append(er),this.$playStopToggle.append(er),this.$volumeIcon.append(Pa),this.$fullscreenToggle.append(Ia),this.$hdIndicator.append(Nf)}},{key:"setSeekPercentage",value:function(t){t=Math.max(Math.min(t,100),0),this.displayedSeekBarPercentage!==t&&(this.displayedSeekBarPercentage=t,this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition"),this.$seekBarPosition.css({width:"".concat(t,"%")}),this.$seekBarScrubber.css({left:"".concat(t,"%")}))}},{key:"seekRelative",value:function(t){if(this.settings.seekEnabled){var f=this.container.getCurrentTime(),S=this.container.getDuration(),L=Math.min(Math.max(f+t,0),S);L=Math.min(L*100/S,100),this.container.seekPercentage(L)}}},{key:"bindKeyAndShow",value:function(t,f){var S=this;this.kibo.down(t,function(){return S.show(),f()})}},{key:"bindKeyEvents",value:function(){var t=this;if(!(fe.isMobile||this.options.disableKeyboardShortcuts)){this.unbindKeyEvents(),this.kibo=new ue(this.options.focusElement||this.options.parentElement),this.bindKeyAndShow("space",function(){return t.togglePlayPause()}),this.bindKeyAndShow("left",function(){return t.seekRelative(-5)}),this.bindKeyAndShow("right",function(){return t.seekRelative(5)}),this.bindKeyAndShow("shift left",function(){return t.seekRelative(-10)}),this.bindKeyAndShow("shift right",function(){return t.seekRelative(10)}),this.bindKeyAndShow("shift ctrl left",function(){return t.seekRelative(-15)}),this.bindKeyAndShow("shift ctrl right",function(){return t.seekRelative(15)});var f=["1","2","3","4","5","6","7","8","9","0"];f.forEach(function(S){t.bindKeyAndShow(S,function(){t.settings.seekEnabled&&t.container&&t.container.seekPercentage(S*10)})})}}},{key:"unbindKeyEvents",value:function(){this.kibo&&(this.kibo.off("space"),this.kibo.off("left"),this.kibo.off("right"),this.kibo.off("shift left"),this.kibo.off("shift right"),this.kibo.off("shift ctrl left"),this.kibo.off("shift ctrl right"),this.kibo.off(["1","2","3","4","5","6","7","8","9","0"]))}},{key:"parseColors",value:function(){if(this.options.mediacontrol){this.buttonsColor=this.options.mediacontrol.buttons;var t=this.options.mediacontrol.seekbar;this.$el.find(".bar-fill-2[data-seekbar]").css("background-color",t),this.$el.find(".media-control-icon svg path").css("fill",this.buttonsColor),this.$el.find(".segmented-bar-element[data-volume]").css("boxShadow","inset 2px 0 0 "+this.buttonsColor)}}},{key:"applyButtonStyle",value:function(t){this.buttonsColor&&t&&ve(t).find("svg path").css("fill",this.buttonsColor)}},{key:"destroy",value:function(){ve(document).unbind("mouseup",this.stopDragHandler),ve(document).unbind("mousemove",this.updateDragHandler),this.unbindKeyEvents(),this.stopListening(),mr(Wt(i.prototype),"destroy",this).call(this)}},{key:"configure",value:function(t){this.options.chromeless||t.source||t.sources?this.disable():this.enable(),this.trigger(G.MEDIACONTROL_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=this,f=this.options.hideMediaControlDelay||2e3;this.settings&&this.$el.html(this.template({settings:this.settings}));var S=Qe.getStyleFor(Rf,{baseUrl:this.options.baseUrl});this.$el.append(S[0]),this.createCachedElements(),this.$playPauseToggle.addClass("paused"),this.$playStopToggle.addClass("stopped"),this.changeTogglePlay(),this.container&&(this.hideId=setTimeout(function(){return t.hide()},f),this.disabled&&this.hide()),fe.isSafari&&fe.isMobile&&(fe.version<10?this.$volumeContainer.css("display","none"):this.$volumeBarContainer.css("display","none")),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition");var L=0;return this.displayedSeekBarPercentage&&(L=this.displayedSeekBarPercentage),this.displayedSeekBarPercentage=null,this.setSeekPercentage(L),setTimeout(function(){!t.settings.seekEnabled&&t.$seekBarContainer.addClass("seek-disabled"),!fe.isMobile&&!t.options.disableKeyboardShortcuts&&t.bindKeyEvents(),t.playerResize({width:t.options.width,height:t.options.height}),t.hideVolumeBar(0)},0),this.parseColors(),this.highDefinitionUpdate(this.isHD),this.core.$el.append(this.el),this.rendered=!0,this.updateVolumeUI(),this.trigger(G.MEDIACONTROL_RENDERED),this}}]),i})(Tt);vi.extend=function(e){return Ff(vi,e)};var Bf=`<div class="play-wrapper" data-poster></div>
`,Uf=`.player-poster[data-poster] {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  height: 100%;
  width: 100%;
  z-index: 998;
  top: 0;
  left: 0;
  background-color: transparent;
  background-size: cover;
  background-repeat: no-repeat;
  background-position: 50% 50%; }
  .player-poster[data-poster].clickable {
    cursor: pointer; }
  .player-poster[data-poster]:hover .play-wrapper[data-poster] {
    opacity: 1; }
  .player-poster[data-poster] .play-wrapper[data-poster] {
    width: 100%;
    height: 25%;
    margin: 0 auto;
    opacity: 0.75;
    transition: opacity 0.1s ease; }
    .player-poster[data-poster] .play-wrapper[data-poster] svg {
      height: 100%; }
      .player-poster[data-poster] .play-wrapper[data-poster] svg path {
        fill: #fff; }
`,Kf=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.hasStartedPlaying=!1,t.playRequested=!1,t.render(),setTimeout(function(){return t.update()},0),t}return tt(i,[{key:"name",get:function(){return"poster"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(Bf)}},{key:"shouldRender",get:function(){var t=!!(this.options.poster&&this.options.poster.showForNoOp);return this.container.playback.name!=="html_img"&&(this.container.playback.getPlaybackType()!==me.NO_OP||t)}},{key:"attributes",get:function(){return{class:"player-poster","data-poster":""}}},{key:"events",get:function(){return{click:"clicked"}}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||this.options.poster.showOnVideoEnd===void 0}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.update),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.update),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.render),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.showOnVideoEnd&&this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop)}},{key:"onError",value:function(t){this.hasFatalError=t.level===ot.Levels.FATAL,this.hasFatalError&&(this.hasStartedPlaying=!1,this.playRequested=!1,this.showPlayButton())}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"updatePlayButton",value:function(t){t&&(!this.options.chromeless||this.options.allowUserInteraction)?this.showPlayButton():this.hidePlayButton()}},{key:"showPlayButton",value:function(){this.hasFatalError&&!this.options.disableErrorScreen||(this.$playButton.show(),this.$el.addClass("clickable"))}},{key:"hidePlayButton",value:function(){this.$playButton.hide(),this.$el.removeClass("clickable")}},{key:"clicked",value:function(){if(!this.hasStartedPlaying)return(!this.options.chromeless||this.options.allowUserInteraction)&&(this.playRequested=!0,this.update(),this.container.playback&&(this.container.playback._consented=!0),this.container.play()),!1}},{key:"shouldHideOnPlay",value:function(){return!this.container.playback.isAudioOnly}},{key:"update",value:function(){if(this.shouldRender){var t=!this.playRequested&&!this.hasStartedPlaying&&!this.container.buffering;this.updatePlayButton(t),this.updatePoster()}}},{key:"updatePoster",value:function(){this.hasStartedPlaying?this.hidePoster():this.showPoster()}},{key:"showPoster",value:function(){this.container.disableMediaControl(),this.$el.show()}},{key:"hidePoster",value:function(){this.container.enableMediaControl(),this.shouldHideOnPlay()&&this.$el.hide()}},{key:"render",value:function(){if(this.shouldRender){var t=Qe.getStyleFor(Uf,{baseUrl:this.options.baseUrl});this.$el.html(this.template()),this.$el.append(t[0]);var f=this.options.poster&&this.options.poster.custom===void 0;if(f){var S=this.options.poster.url||this.options.poster;this.$el.css({"background-image":"url("+S+")"}),this.removeVideoElementPoster()}else this.options.poster&&(this.$el.css({background:this.options.poster.custom}),this.removeVideoElementPoster());this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(er),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var L=this.options.mediacontrol&&this.options.mediacontrol.buttons;return L&&this.$el.find("svg path").css("fill",L),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(L=this.options.mediacontrol.buttons,this.$playButton.css("color",L)),this.update(),this}}},{key:"removeVideoElementPoster",value:function(){this.container.playback&&this.container.playback.$el&&this.container.playback.$el[0]&&this.container.playback.$el[0].removeAttribute&&this.container.playback.$el[0].removeAttribute("poster")}}]),i})(ir),Wf=`<span data-seek-time></span>
<span data-duration></span>
`,Vf=`.seek-time[data-seek-time] {
  position: absolute;
  white-space: nowrap;
  height: 20px;
  line-height: 20px;
  font-size: 0;
  left: -100%;
  bottom: 55px;
  background-color: rgba(2, 2, 2, 0.5);
  z-index: 9999;
  transition: opacity 0.1s ease; }
  .seek-time[data-seek-time].hidden[data-seek-time] {
    opacity: 0; }
  .seek-time[data-seek-time] [data-seek-time] {
    display: inline-block;
    color: white;
    font-size: 10px;
    padding-left: 7px;
    padding-right: 7px;
    vertical-align: top; }
  .seek-time[data-seek-time] [data-duration] {
    display: inline-block;
    color: rgba(255, 255, 255, 0.5);
    font-size: 10px;
    padding-right: 7px;
    vertical-align: top; }
    .seek-time[data-seek-time] [data-duration]:before {
      content: "|";
      margin-right: 7px; }
`,wa=Ht.formatTime,Gf=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.hoveringOverSeekBar=!1,t.hoverPosition=null,t.duration=null,t.firstFragDateTime=null,t.actualLiveTime=!!t.mediaControl.options.actualLiveTime,t.actualLiveTime&&(t.mediaControl.options.actualLiveServerTime?t.actualLiveServerTimeDiff=new Date().getTime()-new Date(t.mediaControl.options.actualLiveServerTime).getTime():t.actualLiveServerTimeDiff=0),t}return tt(i,[{key:"name",get:function(){return"seek_time"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(Wf)}},{key:"attributes",get:function(){return{class:"seek-time","data-seek-time":""}}},{key:"mediaControl",get:function(){return this.core.mediaControl}},{key:"mediaControlContainer",get:function(){return this.mediaControl.container}},{key:"isLiveStreamWithDvr",get:function(){return this.mediaControlContainer&&this.mediaControlContainer.getPlaybackType()===me.LIVE&&this.mediaControlContainer.isDvrEnabled()}},{key:"durationShown",get:function(){return this.isLiveStreamWithDvr&&!this.actualLiveTime}},{key:"useActualLiveTime",get:function(){return this.actualLiveTime&&this.isLiveStreamWithDvr}},{key:"bindEvents",value:function(){this.listenTo(this.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.showTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.hideTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged),this.mediaControlContainer&&(this.listenTo(this.mediaControlContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.update),this.listenTo(this.mediaControlContainer,G.CONTAINER_TIMEUPDATE,this.updateDuration))}},{key:"onContainerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"updateDuration",value:function(t){this.duration=t.total,this.firstFragDateTime=t.firstFragDateTime,this.update()}},{key:"showTime",value:function(t){this.hoveringOverSeekBar=!0,this.calculateHoverPosition(t),this.update()}},{key:"hideTime",value:function(){this.hoveringOverSeekBar=!1,this.update()}},{key:"calculateHoverPosition",value:function(t){var f=t.pageX-this.mediaControl.$seekBarContainer.offset().left;this.hoverPosition=Math.min(1,Math.max(f/this.mediaControl.$seekBarContainer.width(),0))}},{key:"getSeekTime",value:function(){var t,f,S,L;return this.useActualLiveTime?(this.firstFragDateTime?(L=new Date(this.firstFragDateTime),S=new Date(this.firstFragDateTime),S.setHours(0,0,0,0),f=(L.getTime()-S.getTime())/1e3+this.duration):(S=new Date(new Date().getTime()-this.actualLiveServerTimeDiff),L=new Date(S),f=(L-S.setHours(0,0,0,0))/1e3),t=f-this.duration+this.hoverPosition*this.duration,t<0&&(t+=86400)):t=this.hoverPosition*this.duration,{seekTime:t,secondsSinceMidnight:f}}},{key:"update",value:function(){if(this.rendered)if(!this.shouldBeVisible())this.$el.hide(),this.$el.css("left","-100%");else{var t=this.getSeekTime(),f=wa(t.seekTime,this.useActualLiveTime);if(f!==this.displayedSeekTime&&(this.$seekTimeEl.text(f),this.displayedSeekTime=f),this.durationShown){this.$durationEl.show();var S=wa(this.actualLiveTime?t.secondsSinceMidnight:this.duration,this.actualLiveTime);S!==this.displayedDuration&&(this.$durationEl.text(S),this.displayedDuration=S)}else this.$durationEl.hide();this.$el.show();var L=this.mediaControl.$seekBarContainer.width(),h=this.$el.width(),F=this.hoverPosition*L;F-=h/2,F=Math.max(0,Math.min(F,L-h)),this.$el.css("left",F)}}},{key:"shouldBeVisible",value:function(){return this.mediaControlContainer&&this.mediaControlContainer.settings.seekEnabled&&this.hoveringOverSeekBar&&this.hoverPosition!==null&&this.duration!==null}},{key:"render",value:function(){var t=Qe.getStyleFor(Vf,{baseUrl:this.options.baseUrl});this.rendered=!0,this.displayedDuration=null,this.displayedSeekTime=null,this.$el.html(this.template()),this.$el.append(t[0]),this.$el.hide(),this.mediaControl.$el.append(this.el),this.$seekTimeEl=this.$el.find("[data-seek-time]"),this.$durationEl=this.$el.find("[data-duration]"),this.$durationEl.hide(),this.update()}}]),i})(Tt),Hf=`<div data-bounce1></div><div data-bounce2></div><div data-bounce3></div>
`,jf=`.spinner-three-bounce[data-spinner] {
  position: absolute;
  margin: 0 auto;
  width: 70px;
  text-align: center;
  z-index: 999;
  left: 0;
  right: 0;
  margin-left: auto;
  margin-right: auto;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%); }
  .spinner-three-bounce[data-spinner] > div {
    width: 18px;
    height: 18px;
    background-color: #FFFFFF;
    border-radius: 100%;
    display: inline-block;
    animation: bouncedelay 1.4s infinite ease-in-out;
    /* Prevent first frame from flickering when animation starts */
    animation-fill-mode: both; }
  .spinner-three-bounce[data-spinner] [data-bounce1] {
    animation-delay: -0.32s; }
  .spinner-three-bounce[data-spinner] [data-bounce2] {
    animation-delay: -0.16s; }

@keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0); }
  40% {
    transform: scale(1); } }
`,Na=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.template=at(Hf),t.showTimeout=null,t.listenTo(t.container,G.CONTAINER_STATE_BUFFERING,t.onBuffering),t.listenTo(t.container,G.CONTAINER_STATE_BUFFERFULL,t.onBufferFull),t.listenTo(t.container,G.CONTAINER_STOP,t.onStop),t.listenTo(t.container,G.CONTAINER_ENDED,t.onStop),t.listenTo(t.container,G.CONTAINER_ERROR,t.onStop),t.render(),t}return tt(i,[{key:"name",get:function(){return"spinner"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"attributes",get:function(){return{"data-spinner":"",class:"spinner-three-bounce"}}},{key:"onBuffering",value:function(){this.show()}},{key:"onBufferFull",value:function(){this.hide()}},{key:"onStop",value:function(){this.hide()}},{key:"show",value:function(){var t=this;this.showTimeout===null&&(this.showTimeout=setTimeout(function(){return t.$el.show()},300))}},{key:"hide",value:function(){this.showTimeout!==null&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.$el.hide()}},{key:"render",value:function(){var t=Qe.getStyleFor(jf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template()),this.$el.append(t[0]),this.container.$el.append(this.$el),this.$el.hide(),this.container.buffering&&this.onBuffering(),this}}]),i})(ir),Fa=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.setInitialAttrs(),t.reportInterval=t.options.reportInterval||5e3,t.state="IDLE",t}return tt(i,[{key:"name",get:function(){return"stats"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.container.playback,G.PLAYBACK_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop),this.listenTo(this.container,G.CONTAINER_DESTROYED,this.onStop),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_STATS_ADD,this.onStatsAdd),this.listenTo(this.container,G.CONTAINER_BITRATE,this.onStatsAdd),this.listenTo(this.container.playback,G.PLAYBACK_STATS_ADD,this.onStatsAdd)}},{key:"setInitialAttrs",value:function(){this.firstPlay=!0,this.startupTime=0,this.rebufferingTime=0,this.watchingTime=0,this.rebuffers=0,this.externalMetrics={}}},{key:"onPlay",value:function(){this.state="PLAYING",this.watchingTimeInit=Date.now(),this.intervalId||(this.intervalId=setInterval(this.report.bind(this),this.reportInterval))}},{key:"onStop",value:function(){clearInterval(this.intervalId),this.report(),this.intervalId=void 0,this.state="STOPPED"}},{key:"onBuffering",value:function(){this.firstPlay?this.startupTimeInit=Date.now():this.rebufferingTimeInit=Date.now(),this.state="BUFFERING",this.rebuffers++}},{key:"onBufferFull",value:function(){this.firstPlay&&this.startupTimeInit?(this.firstPlay=!1,this.startupTime=Date.now()-this.startupTimeInit,this.watchingTimeInit=Date.now()):this.rebufferingTimeInit&&(this.rebufferingTime+=this.getRebufferingTime()),this.rebufferingTimeInit=void 0,this.state="PLAYING"}},{key:"getRebufferingTime",value:function(){return Date.now()-this.rebufferingTimeInit}},{key:"getWatchingTime",value:function(){var t=Date.now()-this.watchingTimeInit;return t-this.rebufferingTime}},{key:"isRebuffering",value:function(){return!!this.rebufferingTimeInit}},{key:"onStatsAdd",value:function(t){ve.extend(this.externalMetrics,t)}},{key:"getStats",value:function(){var t={startupTime:this.startupTime,rebuffers:this.rebuffers,rebufferingTime:this.isRebuffering()?this.rebufferingTime+this.getRebufferingTime():this.rebufferingTime,watchingTime:this.isRebuffering()?this.getWatchingTime()-this.getRebufferingTime():this.getWatchingTime()};return ve.extend(t,this.externalMetrics),t}},{key:"report",value:function(){this.container.statsReport(this.getStats())}}]),i})(nr),Yf=`<div class="clappr-watermark" data-watermark data-watermark-<%=position %>>
<% if(typeof imageLink !== 'undefined') { %>
<a target="_blank" href="<%= imageLink %>">
<% } %>
<img src="<%= imageUrl %>">
<% if(typeof imageLink !== 'undefined') { %>
</a>
<% } %>
</div>
`,$f=`.clappr-watermark[data-watermark] {
  position: absolute;
  min-width: 70px;
  max-width: 200px;
  width: 12%;
  text-align: center;
  z-index: 10; }

.clappr-watermark[data-watermark] a {
  outline: none;
  cursor: pointer; }

.clappr-watermark[data-watermark] img {
  max-width: 100%; }

.clappr-watermark[data-watermark-bottom-left] {
  bottom: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-bottom-right] {
  bottom: 10px;
  right: 42px; }

.clappr-watermark[data-watermark-top-left] {
  top: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-top-right] {
  top: 10px;
  right: 37px; }
`,Ba=(function(e){rt(i,e);var n=nt(i);function i(r){var t;return et(this,i),t=n.call(this,r),t.configure(),t}return tt(i,[{key:"name",get:function(){return"watermark"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return at(Yf)}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.configure)}},{key:"configure",value:function(){this.position=this.options.position||"bottom-right",this.options.watermark?(this.imageUrl=this.options.watermark,this.imageLink=this.options.watermarkLink,this.render()):this.$el.remove()}},{key:"onPlay",value:function(){this.hidden||this.$el.show()}},{key:"onStop",value:function(){this.$el.hide()}},{key:"render",value:function(){this.$el.hide();var t=Qe.getStyleFor($f,{baseUrl:this.options.baseUrl}),f={position:this.position,imageUrl:this.imageUrl,imageLink:this.imageLink};return this.$el.html(this.template(f)),this.$el.append(t[0]),this.container.$el.append(this.$el),this}}]),i})(ir);function Ua(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function zn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Ua(Object(i),!0).forEach(function(r){Qf(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ua(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function zf(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Ka(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eo(r.key),r)}}function Xf(e,n,i){return n&&Ka(e.prototype,n),i&&Ka(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qf(e,n,i){return n=eo(n),n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Zf(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&gi(e,n)}function mt(e){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},mt(e)}function gi(e,n){return gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},gi(e,n)}function Jf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ed(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qf(e)}function td(e){var n=Jf();return function(){var r=mt(e),t;if(n){var f=mt(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return ed(this,t)}}function rd(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=mt(e),e!==null););return e}function Ft(){return typeof Reflect<"u"&&Reflect.get?Ft=Reflect.get.bind():Ft=function(n,i,r){var t=rd(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},Ft.apply(this,arguments)}function nd(e){return id(e)||ad(e)||sd(e)||od()}function id(e){if(Array.isArray(e))return pi(e)}function ad(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sd(e,n){if(e){if(typeof e=="string")return pi(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pi(e,n)}}function pi(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function od(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ld(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function eo(e){var n=ld(e,"string");return typeof n=="symbol"?n:String(n)}var ud=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var to={exports:{}};(function(e,n){typeof window<"u"&&(function(r,t){e.exports=t()})(ud,()=>(()=>{var i={"./src/config.ts":((S,L,h)=>{h.r(L),h.d(L,{enableStreamingMode:()=>_,hlsDefaultConfig:()=>s,mergeConfig:()=>m});var F=h("./src/controller/abr-controller.ts"),T=h("./src/controller/audio-stream-controller.ts"),N=h("./src/controller/audio-track-controller.ts"),M=h("./src/controller/subtitle-stream-controller.ts"),U=h("./src/controller/subtitle-track-controller.ts"),w=h("./src/controller/buffer-controller.ts"),I=h("./src/controller/timeline-controller.ts"),k=h("./src/controller/cap-level-controller.ts"),x=h("./src/controller/fps-controller.ts"),D=h("./src/controller/eme-controller.ts"),R=h("./src/controller/cmcd-controller.ts"),O=h("./src/utils/xhr-loader.ts"),C=h("./src/utils/fetch-loader.ts"),E=h("./src/utils/cues.ts"),u=h("./src/utils/mediakeys-helper.ts"),l=h("./src/utils/logger.ts");function c(){return c=Object.assign?Object.assign.bind():function(g){for(var A=1;A<arguments.length;A++){var y=arguments[A];for(var p in y)Object.prototype.hasOwnProperty.call(y,p)&&(g[p]=y[p])}return g},c.apply(this,arguments)}function d(g,A){var y=Object.keys(g);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(g);A&&(p=p.filter(function(b){return Object.getOwnPropertyDescriptor(g,b).enumerable})),y.push.apply(y,p)}return y}function o(g){for(var A=1;A<arguments.length;A++){var y=arguments[A]!=null?arguments[A]:{};A%2?d(Object(y),!0).forEach(function(p){a(g,p,y[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(y)):d(Object(y)).forEach(function(p){Object.defineProperty(g,p,Object.getOwnPropertyDescriptor(y,p))})}return g}function a(g,A,y){return A in g?Object.defineProperty(g,A,{value:y,enumerable:!0,configurable:!0,writable:!0}):g[A]=y,g}var s=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:O.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:F.default,bufferController:w.default,capLevelController:k.default,fpsController:x.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:u.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},v()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:U.default,timelineController:I.TimelineController,audioStreamController:T.default,audioTrackController:N.default,emeController:D.default,cmcdController:R.default});function v(){return{cueHandler:E.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function m(g,A){if((A.liveSyncDurationCount||A.liveMaxLatencyDurationCount)&&(A.liveSyncDuration||A.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(A.liveMaxLatencyDurationCount!==void 0&&(A.liveSyncDurationCount===void 0||A.liveMaxLatencyDurationCount<=A.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(A.liveMaxLatencyDuration!==void 0&&(A.liveSyncDuration===void 0||A.liveMaxLatencyDuration<=A.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return c({},g,A)}function _(g){var A=g.loader;if(A!==C.default&&A!==O.default)l.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),g.progressive=!1;else{var y=(0,C.fetchSupported)();y&&(g.loader=C.default,g.progressive=!0,g.enableSoftwareAES=!0,l.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}}),"./src/controller/abr-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>D});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/ewma-bandwidth-estimator.ts"),N=h("./src/events.ts"),M=h("./src/errors.ts"),U=h("./src/types/loader.ts"),w=h("./src/utils/logger.ts");function I(R,O){for(var C=0;C<O.length;C++){var E=O[C];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(R,E.key,E)}}function k(R,O,C){return O&&I(R.prototype,O),Object.defineProperty(R,"prototype",{writable:!1}),R}var x=(function(){function R(C){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=C;var E=C.config;this.bwEstimator=new T.default(E.abrEwmaSlowVoD,E.abrEwmaFastVoD,E.abrEwmaDefaultEstimate),this.registerListeners()}var O=R.prototype;return O.registerListeners=function(){var E=this.hls;E.on(N.Events.FRAG_LOADING,this.onFragLoading,this),E.on(N.Events.FRAG_LOADED,this.onFragLoaded,this),E.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(N.Events.ERROR,this.onError,this)},O.unregisterListeners=function(){var E=this.hls;E.off(N.Events.FRAG_LOADING,this.onFragLoading,this),E.off(N.Events.FRAG_LOADED,this.onFragLoaded,this),E.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(N.Events.ERROR,this.onError,this)},O.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},O.onFragLoading=function(E,u){var l=u.frag;if(l.type===U.PlaylistLevelType.MAIN&&!this.timer){var c;this.fragCurrent=l,this.partCurrent=(c=u.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)}},O.onLevelLoaded=function(E,u){var l=this.hls.config;u.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},O._abandonRulesCheck=function(){var E=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.autoLevelEnabled;l.config;var d=l.media;if(!(!E||!d)){var o=u?u.stats:E.stats,a=u?u.duration:E.duration;if(o.aborted||o.loaded&&o.loaded===o.total||E.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!c||d.paused||!d.playbackRate||!d.readyState)){var s=l.mainForwardBufferInfo;if(s!==null){var v=performance.now()-o.loading.start,m=Math.abs(d.playbackRate);if(!(v<=500*a/m)){var _=o.loaded&&o.loading.first,g=this.bwEstimator.getEstimate(),A=l.levels,y=l.minAutoLevel,p=A[E.level],b=o.total||Math.max(o.loaded,Math.round(a*p.maxBitrate/8)),P=_?o.loaded*1e3/v:0,B=P?(b-o.loaded)/P:b*8/g,V=s.len/m;if(!(B<=V)){var W=Number.POSITIVE_INFINITY,j;for(j=E.level-1;j>y;j--){var $=A[j].maxBitrate;if(W=P?a*$/(8*.8*P):a*$/g,W<V)break}W>=B||(w.logger.warn("Fragment "+E.sn+(u?" part "+u.index:"")+" of level "+E.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+j+`
      Current BW estimate: `+((0,F.isFiniteNumber)(g)?(g/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+B.toFixed(3)+` s
      Estimated load time for the next fragment: `+W.toFixed(3)+` s
      Time to underbuffer: `+V.toFixed(3)+" s"),l.nextLoadLevel=j,_&&this.bwEstimator.sample(v,o.loaded),this.clearTimer(),E.loader&&(this.fragCurrent=this.partCurrent=null,E.loader.abort()),l.trigger(N.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:E,part:u,stats:o}))}}}}}},O.onFragLoaded=function(E,u){var l=u.frag,c=u.part;if(l.type===U.PlaylistLevelType.MAIN&&(0,F.isFiniteNumber)(l.sn)){var d=c?c.stats:l.stats,o=c?c.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[l.level],s=(a.loaded?a.loaded.bytes:0)+d.loaded,v=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:s,duration:v},a.realBitrate=Math.round(8*s/v)}if(l.bitrateTest){var m={stats:d,frag:l,part:c,id:l.type};this.onFragBuffered(N.Events.FRAG_BUFFERED,m)}}},O.onFragBuffered=function(E,u){var l=u.frag,c=u.part,d=c?c.stats:l.stats;if(!d.aborted&&!(l.type!==U.PlaylistLevelType.MAIN||l.sn==="initSegment")){var o=d.parsing.end-d.loading.start;this.bwEstimator.sample(o,d.loaded),d.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},O.onError=function(E,u){switch(u.details){case M.ErrorDetails.FRAG_LOAD_ERROR:case M.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},O.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},O.getNextABRAutoLevel=function(){var E=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.maxAutoLevel,d=l.config,o=l.minAutoLevel,a=l.media,s=u?u.duration:E?E.duration:0;a&&a.currentTime;var v=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,m=this.bwEstimator?this.bwEstimator.getEstimate():d.abrEwmaDefaultEstimate,_=l.mainForwardBufferInfo,g=(_?_.len:0)/v,A=this.findBestLevel(m,o,c,g,d.abrBandWidthFactor,d.abrBandWidthUpFactor);if(A>=0)return A;w.logger.trace((g?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var y=s?Math.min(s,d.maxStarvationDelay):d.maxStarvationDelay,p=d.abrBandWidthFactor,b=d.abrBandWidthUpFactor;if(!g){var P=this.bitrateTestDelay;if(P){var B=s?Math.min(s,d.maxLoadingDelay):d.maxLoadingDelay;y=B-P,w.logger.trace("bitrate test took "+Math.round(1e3*P)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*y)+" ms"),p=b=1}}return A=this.findBestLevel(m,o,c,g+y,p,b),Math.max(A,0)},O.findBestLevel=function(E,u,l,c,d,o){for(var a,s=this.fragCurrent,v=this.partCurrent,m=this.lastLoadedFragLevel,_=this.hls.levels,g=_[m],A=!!(g!=null&&(a=g.details)!==null&&a!==void 0&&a.live),y=g?.codecSet,p=v?v.duration:s?s.duration:0,b=l;b>=u;b--){var P=_[b];if(!(!P||y&&P.codecSet!==y)){var B=P.details,V=(v?B?.partTarget:B?.averagetargetduration)||p,W=void 0;b<=m?W=d*E:W=o*E;var j=_[b].maxBitrate,$=j*V/W;if(w.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(W)+"/"+j+"/"+V+"/"+c+"/"+$),W>j&&($===0||!(0,F.isFiniteNumber)($)||A&&!this.bitrateTestDelay||$<c))return b}}return-1},k(R,[{key:"nextAutoLevel",get:function(){var E=this._nextAutoLevel,u=this.bwEstimator;if(E!==-1&&!u.canEstimate())return E;var l=this.getNextABRAutoLevel();return E!==-1&&this.hls.levels[l].loadError?E:(E!==-1&&(l=Math.min(E,l)),l)},set:function(E){this._nextAutoLevel=E}}]),R})();const D=x}),"./src/controller/audio-stream-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>a});var F=h("./src/polyfills/number.ts"),T=h("./src/controller/base-stream-controller.ts"),N=h("./src/events.ts"),M=h("./src/utils/buffer-helper.ts"),U=h("./src/controller/fragment-tracker.ts"),w=h("./src/types/level.ts"),I=h("./src/types/loader.ts"),k=h("./src/loader/fragment.ts"),x=h("./src/demux/chunk-cache.ts"),D=h("./src/demux/transmuxer-interface.ts"),R=h("./src/types/transmuxer.ts"),O=h("./src/controller/fragment-finders.ts"),C=h("./src/utils/discontinuities.ts"),E=h("./src/errors.ts");function u(){return u=Object.assign?Object.assign.bind():function(s){for(var v=1;v<arguments.length;v++){var m=arguments[v];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(s[_]=m[_])}return s},u.apply(this,arguments)}function l(s,v){s.prototype=Object.create(v.prototype),s.prototype.constructor=s,c(s,v)}function c(s,v){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,g){return _.__proto__=g,_},c(s,v)}var d=100,o=(function(s){l(v,s);function v(_,g){var A;return A=s.call(this,_,g,"[audio-stream-controller]")||this,A.videoBuffer=null,A.videoTrackCC=-1,A.waitingVideoCC=-1,A.audioSwitch=!1,A.trackId=-1,A.waitingData=null,A.mainDetails=null,A.bufferFlushed=!1,A.cachedTrackLoadedData=null,A._registerListeners(),A}var m=v.prototype;return m.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},m._registerListeners=function(){var g=this.hls;g.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.on(N.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),g.on(N.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),g.on(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.on(N.Events.ERROR,this.onError,this),g.on(N.Events.BUFFER_RESET,this.onBufferReset,this),g.on(N.Events.BUFFER_CREATED,this.onBufferCreated,this),g.on(N.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),g.on(N.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),g.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m._unregisterListeners=function(){var g=this.hls;g.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.off(N.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),g.off(N.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),g.off(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.off(N.Events.ERROR,this.onError,this),g.off(N.Events.BUFFER_RESET,this.onBufferReset,this),g.off(N.Events.BUFFER_CREATED,this.onBufferCreated,this),g.off(N.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),g.off(N.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),g.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m.onInitPtsFound=function(g,A){var y=A.frag,p=A.id,b=A.initPTS;if(p==="main"){var P=y.cc;this.initPTS[y.cc]=b,this.log("InitPTS for cc: "+P+" found from main: "+b),this.videoTrackCC=P,this.state===T.State.WAITING_INIT_PTS&&this.tick()}},m.startLoad=function(g){if(!this.levels){this.startPosition=g,this.state=T.State.STOPPED;return}var A=this.lastCurrentTime;this.stopLoad(),this.setInterval(d),this.fragLoadError=0,A>0&&g===-1?(this.log("Override startPosition with lastCurrentTime @"+A.toFixed(3)),g=A,this.state=T.State.IDLE):(this.loadedmetadata=!1,this.state=T.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=g,this.tick()},m.doTick=function(){switch(this.state){case T.State.IDLE:this.doTickIdle();break;case T.State.WAITING_TRACK:{var g,A=this.levels,y=this.trackId,p=A==null||(g=A[y])===null||g===void 0?void 0:g.details;if(p){if(this.waitForCdnTuneIn(p))break;this.state=T.State.WAITING_INIT_PTS}break}case T.State.FRAG_LOADING_WAITING_RETRY:{var b,P=performance.now(),B=this.retryDate;(!B||P>=B||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=T.State.IDLE);break}case T.State.WAITING_INIT_PTS:{var V=this.waitingData;if(V){var W=V.frag,j=V.part,$=V.cache,Q=V.complete;if(this.initPTS[W.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=T.State.FRAG_LOADING;var Z=$.flush(),ee={frag:W,part:j,payload:Z,networkDetails:null};this._handleFragmentLoadProgress(ee),Q&&s.prototype._handleFragmentLoadComplete.call(this,ee)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+W.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var se=this.getLoadPosition(),Y=M.BufferHelper.bufferInfo(this.mediaBuffer,se,this.config.maxBufferHole),X=(0,O.fragmentWithinToleranceTest)(Y.end,this.config.maxFragLookUpTolerance,W);X<0&&(this.log("Waiting fragment cc ("+W.cc+") @ "+W.start+" cancelled because another fragment at "+Y.end+" is needed"),this.clearWaitingFragment())}}else this.state=T.State.IDLE}}this.onTickEnd()},m.clearWaitingFragment=function(){var g=this.waitingData;g&&(this.fragmentTracker.removeFragment(g.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=T.State.IDLE)},m.resetLoadingState=function(){this.clearWaitingFragment(),s.prototype.resetLoadingState.call(this)},m.onTickEnd=function(){var g=this.media;!g||!g.readyState||(this.lastCurrentTime=g.currentTime)},m.doTickIdle=function(){var g,A,y=this.hls,p=this.levels,b=this.media,P=this.trackId,B=y.config;if(!(!p||!p[P])&&!(!b&&(this.startFragRequested||!B.startFragPrefetch))){var V=p[P],W=V.details;if(!W||W.live&&this.levelLastLoaded!==P||this.waitForCdnTuneIn(W)){this.state=T.State.WAITING_TRACK;return}var j=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&j&&(this.bufferFlushed=!1,this.afterBufferFlushed(j,k.ElementaryStreamTypes.AUDIO,I.PlaylistLevelType.AUDIO));var $=this.getFwdBufferInfo(j,I.PlaylistLevelType.AUDIO);if($!==null){var Q=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,I.PlaylistLevelType.MAIN),Z=$.len,ee=this.getMaxBufferLength(Q?.len),se=this.audioSwitch;if(!(Z>=ee&&!se)){if(!se&&this._streamEnded($,W)){y.trigger(N.Events.BUFFER_EOS,{type:"audio"}),this.state=T.State.ENDED;return}var Y=W.fragments,X=Y[0].start,q=$.end;if(se&&b){var re=this.getLoadPosition();q=re,W.PTSKnown&&re<X&&($.end>X||$.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),b.currentTime=X+.05)}if(!(Q&&q>Q.end+W.targetduration)&&!((!Q||!Q.len)&&$.len)){var te=this.getNextFragment(q,W);if(!te){this.bufferFlushed=!0;return}((g=te.decryptdata)===null||g===void 0?void 0:g.keyFormat)==="identity"&&!((A=te.decryptdata)!==null&&A!==void 0&&A.key)?this.loadKey(te,W):this.loadFragment(te,W,q)}}}}},m.getMaxBufferLength=function(g){var A=s.prototype.getMaxBufferLength.call(this);return g?Math.max(A,g):A},m.onMediaDetaching=function(){this.videoBuffer=null,s.prototype.onMediaDetaching.call(this)},m.onAudioTracksUpdated=function(g,A){var y=A.audioTracks;this.resetTransmuxer(),this.levels=y.map(function(p){return new w.Level(p)})},m.onAudioTrackSwitching=function(g,A){var y=!!A.url;this.trackId=A.id;var p=this.fragCurrent;p!=null&&p.loader&&p.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),y?this.setInterval(d):this.resetTransmuxer(),y?(this.audioSwitch=!0,this.state=T.State.IDLE):this.state=T.State.STOPPED,this.tick()},m.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},m.onLevelLoaded=function(g,A){this.mainDetails=A.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(N.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},m.onAudioTrackLoaded=function(g,A){var y;if(this.mainDetails==null){this.cachedTrackLoadedData=A;return}var p=this.levels,b=A.details,P=A.id;if(!p){this.warn("Audio tracks were reset while loading level "+P);return}this.log("Track "+P+" loaded ["+b.startSN+","+b.endSN+"],duration:"+b.totalduration);var B=p[P],V=0;if(b.live||(y=B.details)!==null&&y!==void 0&&y.live){var W=this.mainDetails;if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed||!W)return;!B.details&&b.hasProgramDateTime&&W.hasProgramDateTime?((0,C.alignMediaPlaylistByPDT)(b,W),V=b.fragments[0].start):V=this.alignPlaylists(b,B.details)}B.details=b,this.levelLastLoaded=P,!this.startFragRequested&&(this.mainDetails||!b.live)&&this.setStartPosition(B.details,V),this.state===T.State.WAITING_TRACK&&!this.waitForCdnTuneIn(b)&&(this.state=T.State.IDLE),this.tick()},m._handleFragmentLoadProgress=function(g){var A,y=g.frag,p=g.part,b=g.payload,P=this.config,B=this.trackId,V=this.levels;if(!V){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+y.sn+" of level "+y.level+" will not be buffered");return}var W=V[B];console.assert(W,"Audio track is defined on fragment load progress");var j=W.details;console.assert(j,"Audio track details are defined on fragment load progress");var $=P.defaultAudioCodec||W.audioCodec||"mp4a.40.2",Q=this.transmuxer;Q||(Q=this.transmuxer=new D.default(this.hls,I.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var Z=this.initPTS[y.cc],ee=(A=y.initSegment)===null||A===void 0?void 0:A.data;if(Z!==void 0){var se=!1,Y=p?p.index:-1,X=Y!==-1,q=new R.ChunkMetadata(y.level,y.sn,y.stats.chunkCount,b.byteLength,Y,X);Q.push(b,ee,$,"",y,p,j.totalduration,se,q,Z)}else{this.log("Unknown video PTS for cc "+y.cc+", waiting for video PTS before demuxing audio frag "+y.sn+" of ["+j.startSN+" ,"+j.endSN+"],track "+B);var re=this.waitingData=this.waitingData||{frag:y,part:p,cache:new x.default,complete:!1},te=re.cache;te.push(new Uint8Array(b)),this.waitingVideoCC=this.videoTrackCC,this.state=T.State.WAITING_INIT_PTS}},m._handleFragmentLoadComplete=function(g){if(this.waitingData){this.waitingData.complete=!0;return}s.prototype._handleFragmentLoadComplete.call(this,g)},m.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},m.onBufferCreated=function(g,A){var y=A.tracks.audio;y&&(this.mediaBuffer=y.buffer||null),A.tracks.video&&(this.videoBuffer=A.tracks.video.buffer||null)},m.onFragBuffered=function(g,A){var y=A.frag,p=A.part;if(y.type!==I.PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&y.type===I.PlaylistLevelType.MAIN){var b;(b=this.videoBuffer||this.media)!==null&&b!==void 0&&b.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(y)){this.warn("Fragment "+y.sn+(p?" p: "+p.index:"")+" of level "+y.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}y.sn!=="initSegment"&&(this.fragPrevious=y,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(N.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(y,p)},m.onError=function(g,A){switch(A.details){case E.ErrorDetails.FRAG_LOAD_ERROR:case E.ErrorDetails.FRAG_LOAD_TIMEOUT:case E.ErrorDetails.KEY_LOAD_ERROR:case E.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.AUDIO,A);break;case E.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case E.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==T.State.ERROR&&this.state!==T.State.STOPPED&&(this.state=A.fatal?T.State.ERROR:T.State.IDLE,this.warn(A.details+" while loading frag, switching to "+this.state+" state"));break;case E.ErrorDetails.BUFFER_FULL_ERROR:if(A.parent==="audio"&&(this.state===T.State.PARSING||this.state===T.State.PARSED)){var y=!0,p=this.getFwdBufferInfo(this.mediaBuffer,I.PlaylistLevelType.AUDIO);p&&p.len>.5&&(y=!this.reduceMaxBufferLength(p.len)),y&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},m.onBufferFlushed=function(g,A){var y=A.type;y===k.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},m._handleTransmuxComplete=function(g){var A,y="audio",p=this.hls,b=g.remuxResult,P=g.chunkMeta,B=this.getCurrentContext(P);if(!B){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(P.level);return}var V=B.frag,W=B.part,j=B.level.details,$=b.audio,Q=b.text,Z=b.id3,ee=b.initSegment;if(!(this.fragContextChanged(V)||!j)){if(this.state=T.State.PARSING,this.audioSwitch&&$&&this.completeAudioSwitch(),ee!=null&&ee.tracks&&(this._bufferInitSegment(ee.tracks,V,P),p.trigger(N.Events.FRAG_PARSING_INIT_SEGMENT,{frag:V,id:y,tracks:ee.tracks})),$){var se=$.startPTS,Y=$.endPTS,X=$.startDTS,q=$.endDTS;W&&(W.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:se,endPTS:Y,startDTS:X,endDTS:q}),V.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,se,Y,X,q),this.bufferFragmentData($,V,W,P)}if(Z!=null&&(A=Z.samples)!==null&&A!==void 0&&A.length){var re=u({id:y,frag:V,details:j},Z);p.trigger(N.Events.FRAG_PARSING_METADATA,re)}if(Q){var te=u({id:y,frag:V,details:j},Q);p.trigger(N.Events.FRAG_PARSING_USERDATA,te)}}},m._bufferInitSegment=function(g,A,y){if(this.state===T.State.PARSING){g.video&&delete g.video;var p=g.audio;if(p){p.levelCodec=p.codec,p.id="audio",this.log("Init audio buffer, container:"+p.container+", codecs[parsed]=["+p.codec+"]"),this.hls.trigger(N.Events.BUFFER_CODECS,g);var b=p.initSegment;if(b!=null&&b.byteLength){var P={type:"audio",frag:A,part:null,chunkMeta:y,parent:A.type,data:b};this.hls.trigger(N.Events.BUFFER_APPENDING,P)}this.tick()}}},m.loadFragment=function(g,A,y){var p=this.fragmentTracker.getState(g);this.fragCurrent=g,(this.audioSwitch||p===U.FragmentState.NOT_LOADED||p===U.FragmentState.PARTIAL)&&(g.sn==="initSegment"?this._loadInitSegment(g):A.live&&!(0,F.isFiniteNumber)(this.initPTS[g.cc])?(this.log("Waiting for video PTS in continuity counter "+g.cc+" of live stream before loading audio fragment "+g.sn+" of level "+this.trackId),this.state=T.State.WAITING_INIT_PTS):(this.startFragRequested=!0,s.prototype.loadFragment.call(this,g,A,y)))},m.completeAudioSwitch=function(){var g=this.hls,A=this.media,y=this.trackId;A&&(this.log("Switching audio track : flushing all audio"),s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,g.trigger(N.Events.AUDIO_TRACK_SWITCHED,{id:y})},v})(T.default);const a=o}),"./src/controller/audio-track-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>D});var F=h("./src/events.ts"),T=h("./src/errors.ts"),N=h("./src/controller/base-playlist-controller.ts"),M=h("./src/types/loader.ts");function U(R,O){for(var C=0;C<O.length;C++){var E=O[C];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(R,E.key,E)}}function w(R,O,C){return O&&U(R.prototype,O),Object.defineProperty(R,"prototype",{writable:!1}),R}function I(R,O){R.prototype=Object.create(O.prototype),R.prototype.constructor=R,k(R,O)}function k(R,O){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,u){return E.__proto__=u,E},k(R,O)}var x=(function(R){I(O,R);function O(E){var u;return u=R.call(this,E,"[audio-track-controller]")||this,u.tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.trackName="",u.selectDefaultTrack=!0,u.registerListeners(),u}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(F.Events.LEVEL_LOADING,this.onLevelLoading,this),u.on(F.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.on(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.on(F.Events.ERROR,this.onError,this)},C.unregisterListeners=function(){var u=this.hls;u.off(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(F.Events.LEVEL_LOADING,this.onLevelLoading,this),u.off(F.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.off(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.off(F.Events.ERROR,this.onError,this)},C.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,R.prototype.destroy.call(this)},C.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},C.onManifestParsed=function(u,l){this.tracks=l.audioTracks||[]},C.onAudioTrackLoaded=function(u,l){var c=l.id,d=l.details,o=this.tracksInGroup[c];if(!o){this.warn("Invalid audio track id "+c);return}var a=o.details;o.details=l.details,this.log("audioTrack "+c+" loaded ["+d.startSN+"-"+d.endSN+"]"),c===this.trackId&&(this.retryCount=0,this.playlistLoaded(c,l,a))},C.onLevelLoading=function(u,l){this.switchLevel(l.level)},C.onLevelSwitching=function(u,l){this.switchLevel(l.level)},C.switchLevel=function(u){var l=this.hls.levels[u];if(l!=null&&l.audioGroupIds){var c=l.audioGroupIds[l.urlId];if(this.groupId!==c){this.groupId=c;var d=this.tracks.filter(function(a){return!c||a.groupId===c});this.selectDefaultTrack&&!d.some(function(a){return a.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=d;var o={audioTracks:d};this.log("Updating audio tracks, "+d.length+' track(s) found in "'+c+'" group-id'),this.hls.trigger(F.Events.AUDIO_TRACKS_UPDATED,o),this.selectInitialTrack()}}},C.onError=function(u,l){R.prototype.onError.call(this,u,l),!(l.fatal||!l.context)&&l.context.type===M.PlaylistContextType.AUDIO_TRACK&&l.context.id===this.trackId&&l.context.groupId===this.groupId&&this.retryLoadingOrFail(l)},C.setAudioTrack=function(u){var l=this.tracksInGroup;if(u<0||u>=l.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var c=l[this.trackId];this.log("Now switching to audio-track index "+u);var d=l[u],o=d.id,a=d.groupId,s=a===void 0?"":a,v=d.name,m=d.type,_=d.url;if(this.trackId=u,this.trackName=v,this.selectDefaultTrack=!1,this.hls.trigger(F.Events.AUDIO_TRACK_SWITCHING,{id:o,groupId:s,name:v,type:m,url:_}),!(d.details&&!d.details.live)){var g=this.switchParams(d.url,c?.details);this.loadPlaylist(g)}},C.selectInitialTrack=function(){var u=this.tracksInGroup;console.assert(u.length,"Initial audio track should be selected when tracks are known");var l=this.trackName,c=this.findTrackId(l)||this.findTrackId();c!==-1?this.setAudioTrack(c):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},C.findTrackId=function(u){for(var l=this.tracksInGroup,c=0;c<l.length;c++){var d=l[c];if((!this.selectDefaultTrack||d.default)&&(!u||u===d.name))return d.id}return-1},C.loadPlaylist=function(u){var l=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(l)){var c=l.id,d=l.groupId,o=l.url;if(u)try{o=u.addDirectives(o)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("loading audio-track playlist for id: "+c),this.clearTimer(),this.hls.trigger(F.Events.AUDIO_TRACK_LOADING,{url:o,id:c,groupId:d,deliveryDirectives:u||null})}},w(O,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(u){this.selectDefaultTrack=!1,this.setAudioTrack(u)}}]),O})(N.default);const D=x}),"./src/controller/base-playlist-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>w});var F=h("./src/polyfills/number.ts"),T=h("./src/types/level.ts"),N=h("./src/controller/level-helper.ts"),M=h("./src/utils/logger.ts"),U=h("./src/errors.ts"),w=(function(){function I(x,D){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,D+":"),this.warn=M.logger.warn.bind(M.logger,D+":"),this.hls=x}var k=I.prototype;return k.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},k.onError=function(D,R){R.fatal&&R.type===U.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},k.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},k.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},k.stopLoad=function(){this.canLoad=!1,this.clearTimer()},k.switchParams=function(D,R){var O=R?.renditionReports;if(O)for(var C=0;C<O.length;C++){var E=O[C],u=""+E.URI;if(u===D.slice(-u.length)){var l=parseInt(E["LAST-MSN"]),c=parseInt(E["LAST-PART"]);if(R&&this.hls.config.lowLatencyMode){var d=Math.min(R.age-R.partTarget,R.targetduration);c!==void 0&&d>R.partTarget&&(c+=1)}if((0,F.isFiniteNumber)(l))return new T.HlsUrlParameters(l,(0,F.isFiniteNumber)(c)?c:void 0,T.HlsSkip.No)}}},k.loadPlaylist=function(D){},k.shouldLoadTrack=function(D){return this.canLoad&&D&&!!D.url&&(!D.details||D.details.live)},k.playlistLoaded=function(D,R,O){var C=this,E=R.details,u=R.stats,l=u.loading.end?Math.max(0,self.performance.now()-u.loading.end):0;if(E.advancedDateTime=Date.now()-l,E.live||O!=null&&O.live){if(E.reloaded(O),O&&this.log("live playlist "+D+" "+(E.advanced?"REFRESHED "+E.lastPartSn+"-"+E.lastPartIndex:"MISSED")),O&&E.fragments.length>0&&(0,N.mergeDetails)(O,E),!this.canLoad||!E.live)return;var c,d=void 0,o=void 0;if(E.canBlockReload&&E.endSN&&E.advanced){var a=this.hls.config.lowLatencyMode,s=E.lastPartSn,v=E.endSN,m=E.lastPartIndex,_=m!==-1,g=s===v,A=a?0:m;_?(d=g?v+1:s,o=g?A:m+1):d=v+1;var y=E.age,p=y+E.ageHeader,b=Math.min(p-E.partTarget,E.targetduration*1.5);if(b>0){if(O&&b>O.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+O.tuneInGoal+" to: "+b+" with playlist age: "+E.age),b=0;else{var P=Math.floor(b/E.targetduration);if(d+=P,o!==void 0){var B=Math.round(b%E.targetduration/E.partTarget);o+=B}this.log("CDN Tune-in age: "+E.ageHeader+"s last advanced "+y.toFixed(2)+"s goal: "+b+" skip sn "+P+" to part "+o)}E.tuneInGoal=b}if(c=this.getDeliveryDirectives(E,R.deliveryDirectives,d,o),a||!g){this.loadPlaylist(c);return}}else c=this.getDeliveryDirectives(E,R.deliveryDirectives,d,o);var V=(0,N.computeReloadInterval)(E,u);d!==void 0&&E.canBlockReload&&(V-=E.partTarget||1),this.log("reload live playlist "+D+" in "+Math.round(V)+" ms"),this.timer=self.setTimeout(function(){return C.loadPlaylist(c)},V)}else this.clearTimer()},k.getDeliveryDirectives=function(D,R,O,C){var E=(0,T.getSkipValue)(D,O);return R!=null&&R.skip&&D.deltaUpdateFailed&&(O=R.msn,C=R.part,E=T.HlsSkip.No),new T.HlsUrlParameters(O,C,E)},k.retryLoadingOrFail=function(D){var R=this,O=this.hls.config,C=this.retryCount<O.levelLoadingMaxRetry;if(C){var E;if(this.retryCount++,D.details.indexOf("LoadTimeOut")>-1&&(E=D.context)!==null&&E!==void 0&&E.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+D.details+'"'),this.loadPlaylist();else{var u=Math.min(Math.pow(2,this.retryCount)*O.levelLoadingRetryDelay,O.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return R.loadPlaylist()},u),this.warn("retry playlist loading #"+this.retryCount+" in "+u+' ms after "'+D.details+'"')}}else this.warn('cannot recover from error "'+D.details+'"'),this.clearTimer(),D.fatal=!0;return C},I})()}),"./src/controller/base-stream-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{State:()=>v,default:()=>m});var F=h("./src/polyfills/number.ts"),T=h("./src/task-loop.ts"),N=h("./src/controller/fragment-tracker.ts"),M=h("./src/utils/buffer-helper.ts"),U=h("./src/utils/logger.ts"),w=h("./src/events.ts"),I=h("./src/errors.ts"),k=h("./src/types/transmuxer.ts"),x=h("./src/utils/mp4-tools.ts"),D=h("./src/utils/discontinuities.ts"),R=h("./src/controller/fragment-finders.ts"),O=h("./src/controller/level-helper.ts"),C=h("./src/loader/fragment-loader.ts"),E=h("./src/crypt/decrypter.ts"),u=h("./src/utils/time-ranges.ts"),l=h("./src/types/loader.ts");function c(_,g){for(var A=0;A<g.length;A++){var y=g[A];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(_,y.key,y)}}function d(_,g,A){return g&&c(_.prototype,g),Object.defineProperty(_,"prototype",{writable:!1}),_}function o(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function a(_,g){_.prototype=Object.create(g.prototype),_.prototype.constructor=_,s(_,g)}function s(_,g){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,p){return y.__proto__=p,y},s(_,g)}var v={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},m=(function(_){a(g,_);function g(y,p,b){var P;return P=_.call(this)||this,P.hls=void 0,P.fragPrevious=null,P.fragCurrent=null,P.fragmentTracker=void 0,P.transmuxer=null,P._state=v.STOPPED,P.media=null,P.mediaBuffer=null,P.config=void 0,P.bitrateTest=!1,P.lastCurrentTime=0,P.nextLoadPosition=0,P.startPosition=0,P.loadedmetadata=!1,P.fragLoadError=0,P.retryDate=0,P.levels=null,P.fragmentLoader=void 0,P.levelLastLoaded=null,P.startFragRequested=!1,P.decrypter=void 0,P.initPTS=[],P.onvseeking=null,P.onvended=null,P.logPrefix="",P.log=void 0,P.warn=void 0,P.logPrefix=b,P.log=U.logger.log.bind(U.logger,b+":"),P.warn=U.logger.warn.bind(U.logger,b+":"),P.hls=y,P.fragmentLoader=new C.default(y.config),P.fragmentTracker=p,P.config=y.config,P.decrypter=new E.default(y,y.config),y.on(w.Events.KEY_LOADED,P.onKeyLoaded,o(P)),y.on(w.Events.LEVEL_SWITCHING,P.onLevelSwitching,o(P)),P}var A=g.prototype;return A.doTick=function(){this.onTickEnd()},A.onTickEnd=function(){},A.startLoad=function(p){},A.stopLoad=function(){this.fragmentLoader.abort();var p=this.fragCurrent;p&&this.fragmentTracker.removeFragment(p),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=v.STOPPED},A._streamEnded=function(p,b){var P=this.fragCurrent,B=this.fragmentTracker;if(!b.live&&P&&this.media&&P.sn>=b.endSN&&!p.nextStart){var V=b.partList;if(V!=null&&V.length){var W=V[V.length-1],j=M.BufferHelper.isBuffered(this.media,W.start+W.duration/2);return j}var $=B.getState(P);return $===N.FragmentState.PARTIAL||$===N.FragmentState.OK}return!1},A.onMediaAttached=function(p,b){var P=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),P.addEventListener("seeking",this.onvseeking),P.addEventListener("ended",this.onvended);var B=this.config;this.levels&&B.autoStartLoad&&this.state===v.STOPPED&&this.startLoad(B.startPosition)},A.onMediaDetaching=function(){var p=this.media;p!=null&&p.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),p&&this.onvseeking&&this.onvended&&(p.removeEventListener("seeking",this.onvseeking),p.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},A.onMediaSeeking=function(){var p=this.config,b=this.fragCurrent,P=this.media,B=this.mediaBuffer,V=this.state,W=P?P.currentTime:0,j=M.BufferHelper.bufferInfo(B||P,W,p.maxBufferHole);if(this.log("media seeking to "+((0,F.isFiniteNumber)(W)?W.toFixed(3):W)+", state: "+V),V===v.ENDED)this.resetLoadingState();else if(b){var $=p.maxFragLookUpTolerance,Q=b.start-$,Z=b.start+b.duration+$;if(!j.len||Z<j.start||Q>j.end){var ee=W>Z;(W<Q||ee)&&(ee&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState())}}P&&(this.lastCurrentTime=W),!this.loadedmetadata&&!j.len&&(this.nextLoadPosition=this.startPosition=W),this.tickImmediate()},A.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},A.onKeyLoaded=function(p,b){if(!(this.state!==v.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=v.IDLE;var P=this.levels[b.frag.level].details;P&&this.loadFragment(b.frag,P,b.frag.start)}},A.onLevelSwitching=function(p,b){this.fragLoadError=0},A.onHandlerDestroying=function(){this.stopLoad(),_.prototype.onHandlerDestroying.call(this)},A.onHandlerDestroyed=function(){this.state=v.STOPPED,this.hls.off(w.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,_.prototype.onHandlerDestroyed.call(this)},A.loadKey=function(p,b){this.log("Loading key for "+p.sn+" of ["+b.startSN+"-"+b.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+p.level),this.state=v.KEY_LOADING,this.fragCurrent=p,this.hls.trigger(w.Events.KEY_LOADING,{frag:p})},A.loadFragment=function(p,b,P){this._loadFragForPlayback(p,b,P)},A._loadFragForPlayback=function(p,b,P){var B=this,V=function(j){if(B.fragContextChanged(p)){B.warn("Fragment "+p.sn+(j.part?" p: "+j.part.index:"")+" of level "+p.level+" was dropped during download."),B.fragmentTracker.removeFragment(p);return}p.stats.chunkCount++,B._handleFragmentLoadProgress(j)};this._doFragLoad(p,b,P,V).then(function(W){if(W){B.fragLoadError=0;var j=B.state;if(B.fragContextChanged(p)){(j===v.FRAG_LOADING||!B.fragCurrent&&j===v.PARSING)&&(B.fragmentTracker.removeFragment(p),B.state=v.IDLE);return}"payload"in W&&(B.log("Loaded fragment "+p.sn+" of level "+p.level),B.hls.trigger(w.Events.FRAG_LOADED,W)),B._handleFragmentLoadComplete(W)}}).catch(function(W){B.state===v.STOPPED||B.state===v.ERROR||(B.warn(W),B.resetFragmentLoading(p))})},A.flushMainBuffer=function(p,b,P){if(P===void 0&&(P=null),!!(p-b)){var B={startOffset:p,endOffset:b,type:P};this.fragLoadError=0,this.hls.trigger(w.Events.BUFFER_FLUSHING,B)}},A._loadInitSegment=function(p){var b=this;this._doFragLoad(p).then(function(P){if(!P||b.fragContextChanged(p)||!b.levels)throw new Error("init load aborted");return P}).then(function(P){var B=b.hls,V=P.payload,W=p.decryptdata;if(V&&V.byteLength>0&&W&&W.key&&W.iv&&W.method==="AES-128"){var j=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(V),W.key.buffer,W.iv.buffer).then(function($){var Q=self.performance.now();return B.trigger(w.Events.FRAG_DECRYPTED,{frag:p,payload:$,stats:{tstart:j,tdecrypt:Q}}),P.payload=$,P})}return P}).then(function(P){var B=b.fragCurrent,V=b.hls,W=b.levels;if(!W)throw new Error("init load aborted, missing levels");var j=W[p.level].details;console.assert(j,"Level details are defined when init segment is loaded");var $=p.stats;b.state=v.IDLE,b.fragLoadError=0,p.data=new Uint8Array(P.payload),$.parsing.start=$.buffering.start=self.performance.now(),$.parsing.end=$.buffering.end=self.performance.now(),P.frag===B&&V.trigger(w.Events.FRAG_BUFFERED,{stats:$,frag:B,part:null,id:p.type}),b.tick()}).catch(function(P){b.state===v.STOPPED||b.state===v.ERROR||(b.warn(P),b.resetFragmentLoading(p))})},A.fragContextChanged=function(p){var b=this.fragCurrent;return!p||!b||p.level!==b.level||p.sn!==b.sn||p.urlId!==b.urlId},A.fragBufferedComplete=function(p,b){var P,B,V=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+p.type+" sn: "+p.sn+(b?" part: "+b.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+p.level+" "+(V?u.default.toString(M.BufferHelper.getBuffered(V)):"(detached)")),this.state=v.IDLE,V&&(!this.loadedmetadata&&p.type==l.PlaylistLevelType.MAIN&&V.buffered.length&&((P=this.fragCurrent)===null||P===void 0?void 0:P.sn)===((B=this.fragPrevious)===null||B===void 0?void 0:B.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},A.seekToStartPos=function(){},A._handleFragmentLoadComplete=function(p){var b=this.transmuxer;if(b){var P=p.frag,B=p.part,V=p.partsLoaded,W=!V||V.length===0||V.some(function($){return!$}),j=new k.ChunkMetadata(P.level,P.sn,P.stats.chunkCount+1,0,B?B.index:-1,!W);b.flush(j)}},A._handleFragmentLoadProgress=function(p){},A._doFragLoad=function(p,b,P,B){var V=this;if(P===void 0&&(P=null),!this.levels)throw new Error("frag load aborted, missing levels");if(P=Math.max(p.start,P||0),this.config.lowLatencyMode&&b){var W=b.partList;if(W&&B){P>p.end&&b.fragmentHint&&(p=b.fragmentHint);var j=this.getNextPart(W,p,P);if(j>-1){var $=W[j];return this.log("Loading part sn: "+p.sn+" p: "+$.index+" cc: "+p.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+j+"-"+(W.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+p.level+", target: "+parseFloat(P.toFixed(3))),this.nextLoadPosition=$.start+$.duration,this.state=v.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:p,part:W[j],targetBufferTime:P}),this.doFragPartsLoad(p,W,j,B).catch(function(Q){return V.handleFragLoadError(Q)})}else if(!p.url||this.loadedEndOfParts(W,P))return Promise.resolve(null)}}return this.log("Loading fragment "+p.sn+" cc: "+p.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+p.level+", target: "+parseFloat(P.toFixed(3))),(0,F.isFiniteNumber)(p.sn)&&!this.bitrateTest&&(this.nextLoadPosition=p.start+p.duration),this.state=v.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:p,targetBufferTime:P}),this.fragmentLoader.load(p,B).catch(function(Q){return V.handleFragLoadError(Q)})},A.doFragPartsLoad=function(p,b,P,B){var V=this;return new Promise(function(W,j){var $=[],Q=function Z(ee){var se=b[ee];V.fragmentLoader.loadPart(p,se,B).then(function(Y){$[se.index]=Y;var X=Y.part;V.hls.trigger(w.Events.FRAG_LOADED,Y);var q=b[ee+1];if(q&&q.fragment===p)Z(ee+1);else return W({frag:p,part:X,partsLoaded:$})}).catch(j)};Q(P)})},A.handleFragLoadError=function(p){var b=p.data;return b&&b.details===I.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(w.Events.ERROR,b),null},A._handleTransmuxerFlush=function(p){var b=this.getCurrentContext(p);if(!b||this.state!==v.PARSING){this.fragCurrent||(this.state=v.IDLE);return}var P=b.frag,B=b.part,V=b.level,W=self.performance.now();P.stats.parsing.end=W,B&&(B.stats.parsing.end=W),this.updateLevelTiming(P,B,V,p.partial)},A.getCurrentContext=function(p){var b=this.levels,P=p.level,B=p.sn,V=p.part;if(!b||!b[P])return this.warn("Levels object was unset while buffering fragment "+B+" of level "+P+". The current chunk will not be buffered."),null;var W=b[P],j=V>-1?(0,O.getPartWith)(W,B,V):null,$=j?j.fragment:(0,O.getFragmentWithSN)(W,B,this.fragCurrent);return $?{frag:$,part:j,level:W}:null},A.bufferFragmentData=function(p,b,P,B){if(!(!p||this.state!==v.PARSING)){var V=p.data1,W=p.data2,j=V;if(V&&W&&(j=(0,x.appendUint8Array)(V,W)),!(!j||!j.length)){var $={type:p.type,frag:b,part:P,chunkMeta:B,parent:b.type,data:j};this.hls.trigger(w.Events.BUFFER_APPENDING,$),p.dropped&&p.independent&&!P&&this.flushBufferGap(b)}}},A.flushBufferGap=function(p){var b=this.media;if(b){if(!M.BufferHelper.isBuffered(b,b.currentTime)){this.flushMainBuffer(0,p.start);return}var P=b.currentTime,B=M.BufferHelper.bufferInfo(b,P,0),V=p.duration,W=Math.min(this.config.maxFragLookUpTolerance*2,V*.25),j=Math.max(Math.min(p.start-W,B.end-W),P+W);p.start-j>W&&this.flushMainBuffer(j,p.start)}},A.getFwdBufferInfo=function(p,b){var P=this.config,B=this.getLoadPosition();if(!(0,F.isFiniteNumber)(B))return null;var V=M.BufferHelper.bufferInfo(p,B,P.maxBufferHole);if(V.len===0&&V.nextStart!==void 0){var W=this.fragmentTracker.getBufferedFrag(B,b);if(W&&V.nextStart<W.end)return M.BufferHelper.bufferInfo(p,B,Math.max(V.nextStart,P.maxBufferHole))}return V},A.getMaxBufferLength=function(p){var b=this.config,P;return p?P=Math.max(8*b.maxBufferSize/p,b.maxBufferLength):P=b.maxBufferLength,Math.min(P,b.maxMaxBufferLength)},A.reduceMaxBufferLength=function(p){var b=this.config,P=p||b.maxBufferLength;return b.maxMaxBufferLength>=P?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1},A.getNextFragment=function(p,b){var P=b.fragments,B=P.length;if(!B)return null;var V=this.config,W=P[0].start,j;if(b.live){var $=V.initialLiveManifestSize;if(B<$)return this.warn("Not enough fragments to start playback (have: "+B+", need: "+$+")"),null;!b.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(j=this.getInitialLiveFragment(b,P),this.startPosition=j?this.hls.liveSyncPosition||j.start:p)}else p<=W&&(j=P[0]);if(!j){var Q=V.lowLatencyMode?b.partEnd:b.fragmentEnd;j=this.getFragmentAtPosition(p,Q,b)}return this.mapToInitFragWhenRequired(j)},A.mapToInitFragWhenRequired=function(p){return p!=null&&p.initSegment&&!(p!=null&&p.initSegment.data)&&!this.bitrateTest?p.initSegment:p},A.getNextPart=function(p,b,P){for(var B=-1,V=!1,W=!0,j=0,$=p.length;j<$;j++){var Q=p[j];if(W=W&&!Q.independent,B>-1&&P<Q.start)break;var Z=Q.loaded;!Z&&(V||Q.independent||W)&&Q.fragment===b&&(B=j),V=Z}return B},A.loadedEndOfParts=function(p,b){var P=p[p.length-1];return P&&b>P.start&&P.loaded},A.getInitialLiveFragment=function(p,b){var P=this.fragPrevious,B=null;if(P){if(p.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+P.programDateTime),B=(0,R.findFragmentByPDT)(b,P.endProgramDateTime,this.config.maxFragLookUpTolerance)),!B){var V=P.sn+1;if(V>=p.startSN&&V<=p.endSN){var W=b[V-p.startSN];P.cc===W.cc&&(B=W,this.log("Live playlist, switching playlist, load frag with next SN: "+B.sn))}B||(B=(0,R.findFragWithCC)(b,P.cc),B&&this.log("Live playlist, switching playlist, load frag with same CC: "+B.sn))}}else{var j=this.hls.liveSyncPosition;j!==null&&(B=this.getFragmentAtPosition(j,this.bitrateTest?p.fragmentEnd:p.edge,p))}return B},A.getFragmentAtPosition=function(p,b,P){var B=this.config,V=this.fragPrevious,W=P.fragments,j=P.endSN,$=P.fragmentHint,Q=B.maxFragLookUpTolerance,Z=!!(B.lowLatencyMode&&P.partList&&$);Z&&$&&!this.bitrateTest&&(W=W.concat($),j=$.sn);var ee;if(p<b){var se=p>b-Q?0:Q;ee=(0,R.findFragmentByPTS)(V,W,p,se)}else ee=W[W.length-1];if(ee){var Y=ee.sn-P.startSN;if(this.fragmentTracker.getState(ee)===N.FragmentState.OK&&(V=ee),V&&ee.sn===V.sn&&!Z){var X=V&&ee.level===V.level;if(X){var q=W[Y+1];ee.sn<j&&this.fragmentTracker.getState(q)!==N.FragmentState.OK?(this.log("SN "+ee.sn+" just loaded, load next one: "+q.sn),ee=q):ee=null}}}return ee},A.synchronizeToLiveEdge=function(p){var b=this.config,P=this.media;if(P){var B=this.hls.liveSyncPosition,V=P.currentTime,W=p.fragments[0].start,j=p.edge,$=V>=W-b.maxFragLookUpTolerance&&V<=j;if(B!==null&&P.duration>B&&(V<B||!$)){var Q=b.liveMaxLatencyDuration!==void 0?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*p.targetduration;(!$&&P.readyState<4||V<j-Q)&&(this.loadedmetadata||(this.nextLoadPosition=B),P.readyState&&(this.warn("Playback: "+V.toFixed(3)+" is located too far from the end of live sliding playlist: "+j+", reset currentTime to : "+B.toFixed(3)),P.currentTime=B))}}},A.alignPlaylists=function(p,b){var P=this.levels,B=this.levelLastLoaded,V=this.fragPrevious,W=B!==null?P[B]:null,j=p.fragments.length;if(!j)return this.warn("No fragments in live playlist"),0;var $=p.fragments[0].start,Q=!b,Z=p.alignedSliding&&(0,F.isFiniteNumber)($);if(Q||!Z&&!$){(0,D.alignStream)(V,W,p);var ee=p.fragments[0].start;return this.log("Live playlist sliding: "+ee.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+p.startSN+" prev-sn: "+(V?V.sn:"na")+" fragments: "+j),ee}return $},A.waitForCdnTuneIn=function(p){var b=3;return p.live&&p.canBlockReload&&p.partTarget&&p.tuneInGoal>Math.max(p.partHoldBack,p.partTarget*b)},A.setStartPosition=function(p,b){var P=this.startPosition;if(P<b&&(P=-1),P===-1||this.lastCurrentTime===-1){var B=p.startTimeOffset;(0,F.isFiniteNumber)(B)?(P=b+B,B<0&&(P+=p.totalduration),P=Math.min(Math.max(b,P),b+p.totalduration),this.log("Start time offset "+B+" found in playlist, adjust startPosition to "+P),this.startPosition=P):p.live?P=this.hls.liveSyncPosition||b:this.startPosition=P=0,this.lastCurrentTime=P}this.nextLoadPosition=P},A.getLoadPosition=function(){var p=this.media,b=0;return this.loadedmetadata&&p?b=p.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition),b},A.handleFragLoadAborted=function(p,b){this.transmuxer&&p.sn!=="initSegment"&&p.stats.aborted&&(this.warn("Fragment "+p.sn+(b?" part"+b.index:"")+" of level "+p.level+" was aborted"),this.resetFragmentLoading(p))},A.resetFragmentLoading=function(p){(!this.fragCurrent||!this.fragContextChanged(p)&&this.state!==v.FRAG_LOADING_WAITING_RETRY)&&(this.state=v.IDLE)},A.onFragmentOrKeyLoadError=function(p,b){if(!b.fatal){var P=b.frag;if(!(!P||P.type!==p)){var B=this.fragCurrent;console.assert(B&&P.sn===B.sn&&P.level===B.level&&P.urlId===B.urlId,"Frag load error must match current frag to retry");var V=this.config;if(this.fragLoadError+1<=V.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var W=Math.min(Math.pow(2,this.fragLoadError)*V.fragLoadingRetryDelay,V.fragLoadingMaxRetryTimeout);this.warn("Fragment "+P.sn+" of "+p+" "+P.level+" failed to load, retrying in "+W+"ms"),this.retryDate=self.performance.now()+W,this.fragLoadError++,this.state=v.FRAG_LOADING_WAITING_RETRY}else b.levelRetry?(p===l.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=v.IDLE):(U.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=v.ERROR)}}},A.afterBufferFlushed=function(p,b,P){if(p){var B=M.BufferHelper.getBuffered(p);this.fragmentTracker.detectEvictedFragments(b,B,P),this.state===v.ENDED&&this.resetLoadingState()}},A.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=v.IDLE},A.resetStartWhenNotLoaded=function(p){if(!this.loadedmetadata){this.startFragRequested=!1;var b=this.levels?this.levels[p].details:null;b!=null&&b.live?(this.startPosition=-1,this.setStartPosition(b,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},A.updateLevelTiming=function(p,b,P,B){var V=this,W=P.details;console.assert(!!W,"level.details must be defined");var j=Object.keys(p.elementaryStreams).reduce(function($,Q){var Z=p.elementaryStreams[Q];if(Z){var ee=Z.endPTS-Z.startPTS;if(ee<=0)return V.warn("Could not parse fragment "+p.sn+" "+Q+" duration reliably ("+ee+")"),$||!1;var se=B?0:(0,O.updateFragPTSDTS)(W,p,Z.startPTS,Z.endPTS,Z.startDTS,Z.endDTS);return V.hls.trigger(w.Events.LEVEL_PTS_UPDATED,{details:W,level:P,drift:se,type:Q,frag:p,start:Z.startPTS,end:Z.endPTS}),!0}return $},!1);j||(this.warn("Found no media in fragment "+p.sn+" of level "+P.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=v.PARSED,this.hls.trigger(w.Events.FRAG_PARSED,{frag:p,part:b})},A.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},d(g,[{key:"state",get:function(){return this._state},set:function(p){var b=this._state;b!==p&&(this._state=p,this.log(b+"->"+p))}}]),g})(T.default)}),"./src/controller/buffer-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>R});var F=h("./src/polyfills/number.ts"),T=h("./src/events.ts"),N=h("./src/utils/logger.ts"),M=h("./src/errors.ts"),U=h("./src/utils/buffer-helper.ts"),w=h("./src/utils/mediasource-helper.ts"),I=h("./src/loader/fragment.ts"),k=h("./src/controller/buffer-operation-queue.ts"),x=(0,w.getMediaSource)(),D=/([ha]vc.)(?:\.[^.,]+)+/,R=(function(){function O(E){var u=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var l=u.hls,c=u.media,d=u.mediaSource;N.logger.log("[buffer-controller]: Media source opened"),c&&(u.updateMediaElementDuration(),l.trigger(T.Events.MEDIA_ATTACHED,{media:c})),d&&d.removeEventListener("sourceopen",u._onMediaSourceOpen),u.checkPendingTracks()},this._onMediaSourceClose=function(){N.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){N.logger.log("[buffer-controller]: Media source ended")},this.hls=E,this._initSourceBuffer(),this.registerListeners()}var C=O.prototype;return C.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},C.destroy=function(){this.unregisterListeners(),this.details=null},C.registerListeners=function(){var u=this.hls;u.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(T.Events.BUFFER_RESET,this.onBufferReset,this),u.on(T.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.on(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.on(T.Events.BUFFER_EOS,this.onBufferEos,this),u.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.on(T.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.on(T.Events.FRAG_PARSED,this.onFragParsed,this),u.on(T.Events.FRAG_CHANGED,this.onFragChanged,this)},C.unregisterListeners=function(){var u=this.hls;u.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(T.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(T.Events.BUFFER_RESET,this.onBufferReset,this),u.off(T.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.off(T.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.off(T.Events.BUFFER_EOS,this.onBufferEos,this),u.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.off(T.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.off(T.Events.FRAG_PARSED,this.onFragParsed,this),u.off(T.Events.FRAG_CHANGED,this.onFragChanged,this)},C._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new k.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},C.onManifestParsed=function(u,l){var c=2;(l.audio&&!l.video||!l.altAudio)&&(c=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=c,this.details=null,N.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},C.onMediaAttaching=function(u,l){var c=this.media=l.media;if(c&&x){var d=this.mediaSource=new x;d.addEventListener("sourceopen",this._onMediaSourceOpen),d.addEventListener("sourceended",this._onMediaSourceEnded),d.addEventListener("sourceclose",this._onMediaSourceClose),c.src=self.URL.createObjectURL(d),this._objectUrl=c.src}},C.onMediaDetaching=function(){var u=this.media,l=this.mediaSource,c=this._objectUrl;if(l){if(N.logger.log("[buffer-controller]: media source detaching"),l.readyState==="open")try{l.endOfStream()}catch(d){N.logger.warn("[buffer-controller]: onMediaDetaching: "+d.message+" while calling endOfStream")}this.onBufferReset(),l.removeEventListener("sourceopen",this._onMediaSourceOpen),l.removeEventListener("sourceended",this._onMediaSourceEnded),l.removeEventListener("sourceclose",this._onMediaSourceClose),u&&(c&&self.URL.revokeObjectURL(c),u.src===c?(u.removeAttribute("src"),u.load()):N.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(T.Events.MEDIA_DETACHED,void 0)},C.onBufferReset=function(){var u=this;this.getSourceBufferTypes().forEach(function(l){var c=u.sourceBuffer[l];try{c&&(u.removeBufferListeners(l),u.mediaSource&&u.mediaSource.removeSourceBuffer(c),u.sourceBuffer[l]=void 0)}catch(d){N.logger.warn("[buffer-controller]: Failed to reset the "+l+" buffer",d)}}),this._initSourceBuffer()},C.onBufferCodecs=function(u,l){var c=this,d=this.getSourceBufferTypes().length;Object.keys(l).forEach(function(o){if(d){var a=c.tracks[o];if(a&&typeof a.buffer.changeType=="function"){var s=l[o],v=s.id,m=s.codec,_=s.levelCodec,g=s.container,A=s.metadata,y=(a.levelCodec||a.codec).replace(D,"$1"),p=(_||m).replace(D,"$1");if(y!==p){var b=g+";codecs="+(_||m);c.appendChangeType(o,b),N.logger.log("[buffer-controller]: switching codec "+y+" to "+p),c.tracks[o]={buffer:a.buffer,codec:m,container:g,levelCodec:_,metadata:A,id:v}}}}else c.pendingTracks[o]=l[o]}),!d&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},C.appendChangeType=function(u,l){var c=this,d=this.operationQueue,o={execute:function(){var s=c.sourceBuffer[u];s&&(N.logger.log("[buffer-controller]: changing "+u+" sourceBuffer type to "+l),s.changeType(l)),d.shiftAndExecuteNext(u)},onStart:function(){},onComplete:function(){},onError:function(s){N.logger.warn("[buffer-controller]: Failed to change "+u+" SourceBuffer type",s)}};d.append(o,u)},C.onBufferAppending=function(u,l){var c=this,d=this.hls,o=this.operationQueue,a=this.tracks,s=l.data,v=l.type,m=l.frag,_=l.part,g=l.chunkMeta,A=g.buffering[v],y=self.performance.now();A.start=y;var p=m.stats.buffering,b=_?_.stats.buffering:null;p.start===0&&(p.start=y),b&&b.start===0&&(b.start=y);var P=a.audio,B=v==="audio"&&g.id===1&&P?.container==="audio/mpeg",V={execute:function(){if(A.executeStart=self.performance.now(),B){var j=c.sourceBuffer[v];if(j){var $=m.start-j.timestampOffset;Math.abs($)>=.1&&(N.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+m.start+" (delta: "+$+") sn: "+m.sn+")"),j.timestampOffset=m.start)}}c.appendExecutor(s,v)},onStart:function(){},onComplete:function(){var j=self.performance.now();A.executeEnd=A.end=j,p.first===0&&(p.first=j),b&&b.first===0&&(b.first=j);var $=c.sourceBuffer,Q={};for(var Z in $)Q[Z]=U.BufferHelper.getBuffered($[Z]);c.appendError=0,c.hls.trigger(T.Events.BUFFER_APPENDED,{type:v,frag:m,part:_,chunkMeta:g,parent:m.type,timeRanges:Q})},onError:function(j){N.logger.error("[buffer-controller]: Error encountered while trying to append to the "+v+" SourceBuffer",j);var $={type:M.ErrorTypes.MEDIA_ERROR,parent:m.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:j,fatal:!1};j.code===DOMException.QUOTA_EXCEEDED_ERR?$.details=M.ErrorDetails.BUFFER_FULL_ERROR:(c.appendError++,$.details=M.ErrorDetails.BUFFER_APPEND_ERROR,c.appendError>d.config.appendErrorMaxRetry&&(N.logger.error("[buffer-controller]: Failed "+d.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),$.fatal=!0,d.stopLoad())),d.trigger(T.Events.ERROR,$)}};o.append(V,v)},C.onBufferFlushing=function(u,l){var c=this,d=this.operationQueue,o=function(s){return{execute:c.removeExecutor.bind(c,s,l.startOffset,l.endOffset),onStart:function(){},onComplete:function(){c.hls.trigger(T.Events.BUFFER_FLUSHED,{type:s})},onError:function(m){N.logger.warn("[buffer-controller]: Failed to remove from "+s+" SourceBuffer",m)}}};l.type?d.append(o(l.type),l.type):this.getSourceBufferTypes().forEach(function(a){d.append(o(a),a)})},C.onFragParsed=function(u,l){var c=this,d=l.frag,o=l.part,a=[],s=o?o.elementaryStreams:d.elementaryStreams;s[I.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(s[I.ElementaryStreamTypes.AUDIO]&&a.push("audio"),s[I.ElementaryStreamTypes.VIDEO]&&a.push("video"));var v=function(){var _=self.performance.now();d.stats.buffering.end=_,o&&(o.stats.buffering.end=_);var g=o?o.stats:d.stats;c.hls.trigger(T.Events.FRAG_BUFFERED,{frag:d,part:o,stats:g,id:d.type})};a.length===0&&N.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+d.type+" level: "+d.level+" sn: "+d.sn),this.blockBuffers(v,a)},C.onFragChanged=function(u,l){this.flushBackBuffer()},C.onBufferEos=function(u,l){var c=this,d=this.getSourceBufferTypes().reduce(function(o,a){var s=c.sourceBuffer[a];return(!l.type||l.type===a)&&s&&!s.ended&&(s.ended=!0,N.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),o&&!!(!s||s.ended)},!0);d&&this.blockBuffers(function(){var o=c.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},C.onLevelUpdated=function(u,l){var c=l.details;c.fragments.length&&(this.details=c,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},C.flushBackBuffer=function(){var u=this.hls,l=this.details,c=this.media,d=this.sourceBuffer;if(!(!c||l===null)){var o=this.getSourceBufferTypes();if(o.length){var a=l.live&&u.config.liveBackBufferLength!==null?u.config.liveBackBufferLength:u.config.backBufferLength;if(!(!(0,F.isFiniteNumber)(a)||a<0)){var s=c.currentTime,v=l.levelTargetDuration,m=Math.max(a,v),_=Math.floor(s/v)*v-m;o.forEach(function(g){var A=d[g];if(A){var y=U.BufferHelper.getBuffered(A);y.length>0&&_>y.start(0)&&(u.trigger(T.Events.BACK_BUFFER_REACHED,{bufferEnd:_}),l.live&&u.trigger(T.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:_}),u.trigger(T.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:_,type:g}))}})}}}},C.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var u=this.details,l=this.hls,c=this.media,d=this.mediaSource,o=u.fragments[0].start+u.totalduration,a=c.duration,s=(0,F.isFiniteNumber)(d.duration)?d.duration:0;u.live&&l.config.liveDurationInfinity?(N.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),d.duration=1/0,this.updateSeekableRange(u)):(o>s&&o>a||!(0,F.isFiniteNumber)(a))&&(N.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),d.duration=o)}},C.updateSeekableRange=function(u){var l=this.mediaSource,c=u.fragments,d=c.length;if(d&&u.live&&l!==null&&l!==void 0&&l.setLiveSeekableRange){var o=Math.max(0,c[0].start),a=Math.max(o,o+u.totalduration);l.setLiveSeekableRange(o,a)}},C.checkPendingTracks=function(){var u=this.bufferCodecEventsExpected,l=this.operationQueue,c=this.pendingTracks,d=Object.keys(c).length;if(d&&!u||d===2){this.createSourceBuffers(c),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(T.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(a){l.executeNext(a)})}},C.createSourceBuffers=function(u){var l=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");var d=0;for(var o in u)if(!l[o]){var a=u[o];if(!a)throw Error("source buffer exists for track "+o+", however track does not");var s=a.levelCodec||a.codec,v=a.container+";codecs="+s;N.logger.log("[buffer-controller]: creating sourceBuffer("+v+")");try{var m=l[o]=c.addSourceBuffer(v),_=o;this.addBufferListener(_,"updatestart",this._onSBUpdateStart),this.addBufferListener(_,"updateend",this._onSBUpdateEnd),this.addBufferListener(_,"error",this._onSBUpdateError),this.tracks[o]={buffer:m,codec:s,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id},d++}catch(g){N.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+g.message),this.hls.trigger(T.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:g,mimeType:v})}}d&&this.hls.trigger(T.Events.BUFFER_CREATED,{tracks:this.tracks})},C._onSBUpdateStart=function(u){var l=this.operationQueue,c=l.current(u);c.onStart()},C._onSBUpdateEnd=function(u){var l=this.operationQueue,c=l.current(u);c.onComplete(),l.shiftAndExecuteNext(u)},C._onSBUpdateError=function(u,l){N.logger.error("[buffer-controller]: "+u+" SourceBuffer error",l),this.hls.trigger(T.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var c=this.operationQueue.current(u);c&&c.onError(l)},C.removeExecutor=function(u,l,c){var d=this.media,o=this.mediaSource,a=this.operationQueue,s=this.sourceBuffer,v=s[u];if(!d||!o||!v){N.logger.warn("[buffer-controller]: Attempting to remove from the "+u+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(u);return}var m=(0,F.isFiniteNumber)(d.duration)?d.duration:1/0,_=(0,F.isFiniteNumber)(o.duration)?o.duration:1/0,g=Math.max(0,l),A=Math.min(c,m,_);A>g?(N.logger.log("[buffer-controller]: Removing ["+g+","+A+"] from the "+u+" SourceBuffer"),console.assert(!v.updating,u+" sourceBuffer must not be updating"),v.remove(g,A)):a.shiftAndExecuteNext(u)},C.appendExecutor=function(u,l){var c=this.operationQueue,d=this.sourceBuffer,o=d[l];if(!o){N.logger.warn("[buffer-controller]: Attempting to append to the "+l+" SourceBuffer, but it does not exist"),c.shiftAndExecuteNext(l);return}o.ended=!1,console.assert(!o.updating,l+" sourceBuffer must not be updating"),o.appendBuffer(u)},C.blockBuffers=function(u,l){var c=this;if(l===void 0&&(l=this.getSourceBufferTypes()),!l.length){N.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(u);return}var d=this.operationQueue,o=l.map(function(a){return d.appendBlocker(a)});Promise.all(o).then(function(){u(),l.forEach(function(a){var s=c.sourceBuffer[a];(!s||!s.updating)&&d.shiftAndExecuteNext(a)})})},C.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},C.addBufferListener=function(u,l,c){var d=this.sourceBuffer[u];if(d){var o=c.bind(this,u);this.listeners[u].push({event:l,listener:o}),d.addEventListener(l,o)}},C.removeBufferListeners=function(u){var l=this.sourceBuffer[u];l&&this.listeners[u].forEach(function(c){l.removeEventListener(c.event,c.listener)})},O})()}),"./src/controller/buffer-operation-queue.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>T});var F=h("./src/utils/logger.ts"),T=(function(){function N(U){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=U}var M=N.prototype;return M.append=function(w,I){var k=this.queues[I];k.push(w),k.length===1&&this.buffers[I]&&this.executeNext(I)},M.insertAbort=function(w,I){var k=this.queues[I];k.unshift(w),this.executeNext(I)},M.appendBlocker=function(w){var I,k=new Promise(function(D){I=D}),x={execute:I,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(x,w),k},M.executeNext=function(w){var I=this.buffers,k=this.queues,x=I[w],D=k[w];if(D.length){var R=D[0];try{R.execute()}catch(O){F.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),R.onError(O),(!x||!x.updating)&&(D.shift(),this.executeNext(w))}}},M.shiftAndExecuteNext=function(w){this.queues[w].shift(),this.executeNext(w)},M.current=function(w){return this.queues[w][0]},N})()}),"./src/controller/cap-level-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>U});var F=h("./src/events.ts");function T(w,I){for(var k=0;k<I.length;k++){var x=I[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(w,x.key,x)}}function N(w,I,k){return I&&T(w.prototype,I),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=(function(){function w(k){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=k,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var I=w.prototype;return I.setStreamController=function(x){this.streamController=x},I.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},I.registerListeners=function(){var x=this.hls;x.on(F.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),x.on(F.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),x.on(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),x.on(F.Events.BUFFER_CODECS,this.onBufferCodecs,this),x.on(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.unregisterListener=function(){var x=this.hls;x.off(F.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),x.off(F.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),x.off(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),x.off(F.Events.BUFFER_CODECS,this.onBufferCodecs,this),x.off(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.onFpsDropLevelCapping=function(x,D){w.isLevelAllowed(D.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(D.droppedLevel)},I.onMediaAttaching=function(x,D){this.media=D.media instanceof HTMLVideoElement?D.media:null},I.onManifestParsed=function(x,D){var R=this.hls;this.restrictedLevels=[],this.firstLevel=D.firstLevel,R.config.capLevelToPlayerSize&&D.video&&this.startCapping()},I.onBufferCodecs=function(x,D){var R=this.hls;R.config.capLevelToPlayerSize&&D.video&&this.startCapping()},I.onMediaDetaching=function(){this.stopCapping()},I.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var x=this.hls.levels;if(x.length){var D=this.hls;D.autoLevelCapping=this.getMaxLevel(x.length-1),D.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=D.autoLevelCapping}}},I.getMaxLevel=function(x){var D=this,R=this.hls.levels;if(!R.length)return-1;var O=R.filter(function(C,E){return w.isLevelAllowed(E,D.restrictedLevels)&&E<=x});return this.clientRect=null,w.getMaxLevelByMediaSize(O,this.mediaWidth,this.mediaHeight)},I.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},I.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},I.getDimensions=function(){if(this.clientRect)return this.clientRect;var x=this.media,D={width:0,height:0};if(x){var R=x.getBoundingClientRect();D.width=R.width,D.height=R.height,!D.width&&!D.height&&(D.width=R.right-R.left||x.width||0,D.height=R.bottom-R.top||x.height||0)}return this.clientRect=D,D},w.isLevelAllowed=function(x,D){return D===void 0&&(D=[]),D.indexOf(x)===-1},w.getMaxLevelByMediaSize=function(x,D,R){if(!x||!x.length)return-1;for(var O=function(c,d){return d?c.width!==d.width||c.height!==d.height:!0},C=x.length-1,E=0;E<x.length;E+=1){var u=x[E];if((u.width>=D||u.height>=R)&&O(u,x[E+1])){C=E;break}}return C},N(w,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var x=1;if(!this.hls.config.ignoreDevicePixelRatio)try{x=self.devicePixelRatio}catch{}return x}}]),w})();const U=M}),"./src/controller/cmcd-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>R});var F=h("./src/events.ts"),T=h("./src/types/cmcd.ts"),N=h("./src/utils/buffer-helper.ts"),M=h("./src/utils/logger.ts");function U(O,C){for(var E=0;E<C.length;E++){var u=C[E];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,E){return C&&U(O.prototype,C),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){var E=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(E)return(E=E.call(O)).next.bind(E);if(Array.isArray(O)||(E=k(O))||C){E&&(O=E);var u=0;return function(){return u>=O.length?{done:!0}:{done:!1,value:O[u++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(O,C){if(O){if(typeof O=="string")return x(O,C);var E=Object.prototype.toString.call(O).slice(8,-1);if(E==="Object"&&O.constructor&&(E=O.constructor.name),E==="Map"||E==="Set")return Array.from(O);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return x(O,C)}}function x(O,C){(C==null||C>O.length)&&(C=O.length);for(var E=0,u=new Array(C);E<C;E++)u[E]=O[E];return u}function D(){return D=Object.assign?Object.assign.bind():function(O){for(var C=1;C<arguments.length;C++){var E=arguments[C];for(var u in E)Object.prototype.hasOwnProperty.call(E,u)&&(O[u]=E[u])}return O},D.apply(this,arguments)}var R=(function(){function O(E){var u=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){u.initialized&&(u.starved=!0),u.buffering=!0},this.onPlaying=function(){u.initialized||(u.initialized=!0),u.buffering=!1},this.applyPlaylistData=function(d){try{u.apply(d,{ot:T.CMCDObjectType.MANIFEST,su:!u.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(d){try{var o=d.frag,a=u.hls.levels[o.level],s=u.getObjectType(o),v={d:o.duration*1e3,ot:s};(s===T.CMCDObjectType.VIDEO||s===T.CMCDObjectType.AUDIO||s==T.CMCDObjectType.MUXED)&&(v.br=a.bitrate/1e3,v.tb=u.getTopBandwidth(s)/1e3,v.bl=u.getBufferLength(s)),u.apply(d,v)}catch(m){M.logger.warn("Could not generate segment CMCD data.",m)}},this.hls=E;var l=this.config=E.config,c=l.cmcd;c!=null&&(l.pLoader=this.createPlaylistLoader(),l.fLoader=this.createFragmentLoader(),this.sid=c.sessionId||O.uuid(),this.cid=c.contentId,this.useHeaders=c.useHeaders===!0,this.registerListeners())}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(F.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.on(F.Events.BUFFER_CREATED,this.onBufferCreated,this)},C.unregisterListeners=function(){var u=this.hls;u.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(F.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.off(F.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},C.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},C.onMediaAttached=function(u,l){this.media=l.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},C.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},C.onBufferCreated=function(u,l){var c,d;this.audioBuffer=(c=l.tracks.audio)===null||c===void 0?void 0:c.buffer,this.videoBuffer=(d=l.tracks.video)===null||d===void 0?void 0:d.buffer},C.createData=function(){var u;return{v:T.CMCDVersion,sf:T.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(u=this.media)===null||u===void 0?void 0:u.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},C.apply=function(u,l){l===void 0&&(l={}),D(l,this.createData());var c=l.ot===T.CMCDObjectType.INIT||l.ot===T.CMCDObjectType.VIDEO||l.ot===T.CMCDObjectType.MUXED;if(this.starved&&c&&(l.bs=!0,l.su=!0,this.starved=!1),l.su==null&&(l.su=this.buffering),this.useHeaders){var d=O.toHeaders(l);if(!Object.keys(d).length)return;u.headers||(u.headers={}),D(u.headers,d)}else{var o=O.toQuery(l);if(!o)return;u.url=O.appendQueryToUri(u.url,o)}},C.getObjectType=function(u){var l=u.type;if(l==="subtitle")return T.CMCDObjectType.TIMED_TEXT;if(u.sn==="initSegment")return T.CMCDObjectType.INIT;if(l==="audio")return T.CMCDObjectType.AUDIO;if(l==="main")return this.hls.audioTracks.length?T.CMCDObjectType.VIDEO:T.CMCDObjectType.MUXED},C.getTopBandwidth=function(u){var l=0,c,d=this.hls;if(u===T.CMCDObjectType.AUDIO)c=d.audioTracks;else{var o=d.maxAutoLevel,a=o>-1?o+1:d.levels.length;c=d.levels.slice(0,a)}for(var s=I(c),v;!(v=s()).done;){var m=v.value;m.bitrate>l&&(l=m.bitrate)}return l>0?l:NaN},C.getBufferLength=function(u){var l=this.hls.media,c=u===T.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!c||!l)return NaN;var d=N.BufferHelper.bufferInfo(c,l.currentTime,this.config.maxBufferHole);return d.len*1e3},C.createPlaylistLoader=function(){var u=this.config.pLoader,l=this.applyPlaylistData,c=u||this.config.loader;return(function(){function d(a){this.loader=void 0,this.loader=new c(a)}var o=d.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,v,m){l(s),this.loader.load(s,v,m)},w(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d})()},C.createFragmentLoader=function(){var u=this.config.fLoader,l=this.applyFragmentData,c=u||this.config.loader;return(function(){function d(a){this.loader=void 0,this.loader=new c(a)}var o=d.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,v,m){l(s),this.loader.load(s,v,m)},w(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d})()},O.uuid=function(){var u=URL.createObjectURL(new Blob),l=u.toString();return URL.revokeObjectURL(u),l.slice(l.lastIndexOf("/")+1)},O.serialize=function(u){for(var l=[],c=function(B){return!Number.isNaN(B)&&B!=null&&B!==""&&B!==!1},d=function(B){return Math.round(B)},o=function(B){return d(B/100)*100},a=function(B){return encodeURIComponent(B)},s={br:d,d,bl:o,dl:o,mtp:o,nor:a,rtp:o,tb:d},v=Object.keys(u||{}).sort(),m=I(v),_;!(_=m()).done;){var g=_.value,A=u[g];if(c(A)&&!(g==="v"&&A===1)&&!(g=="pr"&&A===1)){var y=s[g];y&&(A=y(A));var p=typeof A,b=void 0;g==="ot"||g==="sf"||g==="st"?b=g+"="+A:p==="boolean"?b=g:p==="number"?b=g+"="+A:b=g+"="+JSON.stringify(A),l.push(b)}}return l.join(",")},O.toHeaders=function(u){for(var l=Object.keys(u),c={},d=["Object","Request","Session","Status"],o=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},s=0,v=l;s<v.length;s++){var m=v[s],_=a[m]!=null?a[m]:1;o[_][m]=u[m]}for(var g=0;g<o.length;g++){var A=O.serialize(o[g]);A&&(c["CMCD-"+d[g]]=A)}return c},O.toQuery=function(u){return"CMCD="+encodeURIComponent(O.serialize(u))},O.appendQueryToUri=function(u,l){if(!l)return u;var c=u.includes("?")?"&":"?";return""+u+c+l},O})()}),"./src/controller/eme-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>R});var F=h("./src/events.ts"),T=h("./src/errors.ts"),N=h("./src/utils/logger.ts"),M=h("./src/utils/mediakeys-helper.ts");function U(O,C){for(var E=0;E<C.length;E++){var u=C[E];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,E){return C&&U(O.prototype,C),Object.defineProperty(O,"prototype",{writable:!1}),O}var I=3,k=function(C,E,u){var l={audioCapabilities:[],videoCapabilities:[]};return C.forEach(function(c){l.audioCapabilities.push({contentType:'audio/mp4; codecs="'+c+'"',robustness:u.audioRobustness||""})}),E.forEach(function(c){l.videoCapabilities.push({contentType:'video/mp4; codecs="'+c+'"',robustness:u.videoRobustness||""})}),[l]},x=function(C,E,u,l){if(C===M.KeySystems.WIDEVINE)return k(E,u,l);throw new Error("Unknown key-system: "+C)},D=(function(){function O(E){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=E,this._config=E.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var C=O.prototype;return C.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},C._registerListeners=function(){this.hls.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(F.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(F.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C._unregisterListeners=function(){this.hls.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(F.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(F.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C.getLicenseServerUrl=function(u){switch(u){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+u+'"')},C._attemptKeySystemAccess=function(u,l,c){var d=this,o=x(u,l,c,this._drmSystemOptions);N.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(u,o);this.mediaKeysPromise=a.then(function(s){return d._onMediaKeySystemAccessObtained(u,s)}),a.catch(function(s){N.logger.error('Failed to obtain key-system "'+u+'" access:',s)})},C._onMediaKeySystemAccessObtained=function(u,l){var c=this;N.logger.log('Access for key-system "'+u+'" obtained');var d={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:l,mediaKeySystemDomain:u};this._mediaKeysList.push(d);var o=Promise.resolve().then(function(){return l.createMediaKeys()}).then(function(a){return d.mediaKeys=a,N.logger.log('Media-keys created for key-system "'+u+'"'),c._onMediaKeysCreated(),a});return o.catch(function(a){N.logger.error("Failed to create media-keys:",a)}),o},C._onMediaKeysCreated=function(){var u=this;this._mediaKeysList.forEach(function(l){l.mediaKeysSession||(l.mediaKeysSession=l.mediaKeys.createSession(),u._onNewMediaKeySession(l.mediaKeysSession))})},C._onNewMediaKeySession=function(u){var l=this;N.logger.log("New key-system session "+u.sessionId),u.addEventListener("message",function(c){l._onKeySessionMessage(u,c.message)},!1)},C._onKeySessionMessage=function(u,l){N.logger.log("Got EME message event, creating license request"),this._requestLicense(l,function(c){N.logger.log("Received license data (length: "+(c&&c.byteLength)+"), updating key-session"),u.update(c).catch(function(d){N.logger.warn("Updating key-session failed: "+d)})})},C.onMediaEncrypted=function(u){var l=this;if(N.logger.log('Media is encrypted using "'+u.initDataType+'" init data type'),!this.mediaKeysPromise){N.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var c=function(o){l._media&&(l._attemptSetMediaKeys(o),l._generateRequestWithPreferredKeySession(u.initDataType,u.initData))};this.mediaKeysPromise.then(c).catch(c)},C._attemptSetMediaKeys=function(u){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var l=this._mediaKeysList[0];if(!l||!l.mediaKeys){N.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}N.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(l.mediaKeys),this._hasSetMediaKeys=!0}},C._generateRequestWithPreferredKeySession=function(u,l){var c=this,d=this._mediaKeysList[0];if(!d){N.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(d.mediaKeysSessionInitialized){N.logger.warn("Key-Session already initialized but requested again");return}var o=d.mediaKeysSession;if(!o){N.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!l){N.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}N.logger.log('Generating key-session request for "'+u+'" init data type'),d.mediaKeysSessionInitialized=!0,o.generateRequest(u,l).then(function(){N.logger.debug("Key-session generation succeeded")}).catch(function(a){N.logger.error("Error generating key-session request:",a),c.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},C._createLicenseXhr=function(u,l,c){var d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,d,u,l,c);var o=this._licenseXhrSetup;if(o)try{o.call(this.hls,d,u),o=void 0}catch(a){N.logger.error(a)}try{d.readyState||d.open("POST",u,!0),o&&o.call(this.hls,d,u)}catch(a){throw new Error("issue setting up KeySystem license XHR "+a)}return d},C._onLicenseRequestReadyStageChange=function(u,l,c,d){switch(u.readyState){case 4:if(u.status===200){this._requestLicenseFailureCount=0,N.logger.log("License request succeeded");var o=u.response,a=this._licenseResponseCallback;if(a)try{o=a.call(this.hls,u,l)}catch(v){N.logger.error(v)}d(o)}else{if(N.logger.error("License Request XHR failed ("+l+"). Status: "+u.status+" ("+u.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>I){this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var s=I-this._requestLicenseFailureCount+1;N.logger.warn("Retrying license request, "+s+" attempts left"),this._requestLicense(c,d)}break}},C._generateLicenseRequestChallenge=function(u,l){if(u.mediaKeySystemDomain===M.KeySystems.WIDEVINE)return l;throw new Error("unsupported key-system: "+u.mediaKeySystemDomain)},C._requestLicense=function(u,l){N.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c){N.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var d=this.getLicenseServerUrl(c.mediaKeySystemDomain),o=this._createLicenseXhr(d,u,l);N.logger.log("Sending license request to URL: "+d);var a=this._generateLicenseRequestChallenge(c,u);o.send(a)}catch(s){N.logger.error("Failure requesting DRM license: "+s),this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.KEY_SYSTEM_ERROR,details:T.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},C.onMediaAttached=function(u,l){if(this._emeEnabled){var c=l.media;this._media=c,c.addEventListener("encrypted",this._onMediaEncrypted)}},C.onMediaDetached=function(){var u=this._media,l=this._mediaKeysList;u&&(u.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(l.map(function(c){if(c.mediaKeysSession)return c.mediaKeysSession.close().catch(function(){})})).then(function(){return u.setMediaKeys(null)}).catch(function(){}))},C.onManifestParsed=function(u,l){if(this._emeEnabled){var c=l.levels.map(function(o){return o.audioCodec}).filter(function(o){return!!o}),d=l.levels.map(function(o){return o.videoCodec}).filter(function(o){return!!o});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,c,d)}},w(O,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),O})();const R=D}),"./src/controller/fps-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>M});var F=h("./src/events.ts"),T=h("./src/utils/logger.ts"),N=(function(){function U(I){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=I,this.registerListeners()}var w=U.prototype;return w.setStreamController=function(k){this.streamController=k},w.registerListeners=function(){this.hls.on(F.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},w.unregisterListeners=function(){this.hls.off(F.Events.MEDIA_ATTACHING,this.onMediaAttaching)},w.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},w.onMediaAttaching=function(k,x){var D=this.hls.config;if(D.capLevelOnFPSDrop){var R=x.media instanceof self.HTMLVideoElement?x.media:null;this.media=R,R&&typeof R.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),D.fpsDroppedMonitoringPeriod)}},w.checkFPS=function(k,x,D){var R=performance.now();if(x){if(this.lastTime){var O=R-this.lastTime,C=D-this.lastDroppedFrames,E=x-this.lastDecodedFrames,u=1e3*C/O,l=this.hls;if(l.trigger(F.Events.FPS_DROP,{currentDropped:C,currentDecoded:E,totalDroppedFrames:D}),u>0&&C>l.config.fpsDroppedMonitoringThreshold*E){var c=l.currentLevel;T.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=c)&&(c=c-1,l.trigger(F.Events.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=R,this.lastDroppedFrames=D,this.lastDecodedFrames=x}},w.checkFPSInterval=function(){var k=this.media;if(k)if(this.isVideoPlaybackQualityAvailable){var x=k.getVideoPlaybackQuality();this.checkFPS(k,x.totalVideoFrames,x.droppedVideoFrames)}else this.checkFPS(k,k.webkitDecodedFrameCount,k.webkitDroppedFrameCount)},U})();const M=N}),"./src/controller/fragment-finders.ts":((S,L,h)=>{h.r(L),h.d(L,{findFragWithCC:()=>I,findFragmentByPDT:()=>N,findFragmentByPTS:()=>M,fragmentWithinToleranceTest:()=>U,pdtWithinToleranceTest:()=>w});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/binary-search.ts");function N(k,x,D){if(x===null||!Array.isArray(k)||!k.length||!(0,F.isFiniteNumber)(x))return null;var R=k[0].programDateTime;if(x<(R||0))return null;var O=k[k.length-1].endProgramDateTime;if(x>=(O||0))return null;D=D||0;for(var C=0;C<k.length;++C){var E=k[C];if(w(x,D,E))return E}return null}function M(k,x,D,R){D===void 0&&(D=0),R===void 0&&(R=0);var O=null;if(k?O=x[k.sn-x[0].sn+1]||null:D===0&&x[0].start===0&&(O=x[0]),O&&U(D,R,O)===0)return O;var C=T.default.search(x,U.bind(null,D,R));return C||O}function U(k,x,D){k===void 0&&(k=0),x===void 0&&(x=0);var R=Math.min(x,D.duration+(D.deltaPTS?D.deltaPTS:0));return D.start+D.duration-R<=k?1:D.start-R>k&&D.start?-1:0}function w(k,x,D){var R=Math.min(x,D.duration+(D.deltaPTS?D.deltaPTS:0))*1e3,O=D.endProgramDateTime||0;return O-R>k}function I(k,x){return T.default.search(k,function(D){return D.cc<x?1:D.cc>x?-1:0})}}),"./src/controller/fragment-tracker.ts":((S,L,h)=>{h.r(L),h.d(L,{FragmentState:()=>N,FragmentTracker:()=>M});var F=h("./src/events.ts"),T=h("./src/types/loader.ts"),N;(function(I){I.NOT_LOADED="NOT_LOADED",I.APPENDING="APPENDING",I.PARTIAL="PARTIAL",I.OK="OK"})(N||(N={}));var M=(function(){function I(x){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=x,this._registerListeners()}var k=I.prototype;return k._registerListeners=function(){var D=this.hls;D.on(F.Events.BUFFER_APPENDED,this.onBufferAppended,this),D.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),D.on(F.Events.FRAG_LOADED,this.onFragLoaded,this)},k._unregisterListeners=function(){var D=this.hls;D.off(F.Events.BUFFER_APPENDED,this.onBufferAppended,this),D.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),D.off(F.Events.FRAG_LOADED,this.onFragLoaded,this)},k.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},k.getAppendedFrag=function(D,R){if(R===T.PlaylistLevelType.MAIN){var O=this.activeFragment,C=this.activeParts;if(!O)return null;if(C)for(var E=C.length;E--;){var u=C[E],l=u?u.end:O.appendedPTS;if(u.start<=D&&l!==void 0&&D<=l)return E>9&&(this.activeParts=C.slice(E-9)),u}else if(O.start<=D&&O.appendedPTS!==void 0&&D<=O.appendedPTS)return O}return this.getBufferedFrag(D,R)},k.getBufferedFrag=function(D,R){for(var O=this.fragments,C=Object.keys(O),E=C.length;E--;){var u=O[C[E]];if(u?.body.type===R&&u.buffered){var l=u.body;if(l.start<=D&&D<=l.end)return l}}return null},k.detectEvictedFragments=function(D,R,O){var C=this;Object.keys(this.fragments).forEach(function(E){var u=C.fragments[E];if(u){if(!u.buffered){u.body.type===O&&C.removeFragment(u.body);return}var l=u.range[D];l&&l.time.some(function(c){var d=!C.isTimeBuffered(c.startPTS,c.endPTS,R);return d&&C.removeFragment(u.body),d})}})},k.detectPartialFragments=function(D){var R=this,O=this.timeRanges,C=D.frag,E=D.part;if(!(!O||C.sn==="initSegment")){var u=w(C),l=this.fragments[u];l&&(Object.keys(O).forEach(function(c){var d=C.elementaryStreams[c];if(d){var o=O[c],a=E!==null||d.partial===!0;l.range[c]=R.getBufferedTimes(C,E,a,o)}}),l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},k.fragBuffered=function(D){var R=w(D),O=this.fragments[R];O&&(O.loaded=null,O.buffered=!0)},k.getBufferedTimes=function(D,R,O,C){for(var E={time:[],partial:O},u=R?R.start:D.start,l=R?R.end:D.end,c=D.minEndPTS||l,d=D.maxStartPTS||u,o=0;o<C.length;o++){var a=C.start(o)-this.bufferPadding,s=C.end(o)+this.bufferPadding;if(d>=a&&c<=s){E.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});break}else if(u<s&&l>a)E.partial=!0,E.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});else if(l<=a)break}return E},k.getPartialFragment=function(D){var R=null,O,C,E,u=0,l=this.bufferPadding,c=this.fragments;return Object.keys(c).forEach(function(d){var o=c[d];o&&U(o)&&(C=o.body.start-l,E=o.body.end+l,D>=C&&D<=E&&(O=Math.min(D-C,E-D),u<=O&&(R=o.body,u=O)))}),R},k.getState=function(D){var R=w(D),O=this.fragments[R];return O?O.buffered?U(O)?N.PARTIAL:N.OK:N.APPENDING:N.NOT_LOADED},k.isTimeBuffered=function(D,R,O){for(var C,E,u=0;u<O.length;u++){if(C=O.start(u)-this.bufferPadding,E=O.end(u)+this.bufferPadding,D>=C&&R<=E)return!0;if(R<=C)return!1}return!1},k.onFragLoaded=function(D,R){var O=R.frag,C=R.part;if(!(O.sn==="initSegment"||O.bitrateTest||C)){var E=w(O);this.fragments[E]={body:O,loaded:R,buffered:!1,range:Object.create(null)}}},k.onBufferAppended=function(D,R){var O=this,C=R.frag,E=R.part,u=R.timeRanges;if(C.type===T.PlaylistLevelType.MAIN)if(this.activeFragment=C,E){var l=this.activeParts;l||(this.activeParts=l=[]),l.push(E)}else this.activeParts=null;this.timeRanges=u,Object.keys(u).forEach(function(c){var d=u[c];if(O.detectEvictedFragments(c,d),!E)for(var o=0;o<d.length;o++)C.appendedPTS=Math.max(d.end(o),C.appendedPTS||0)})},k.onFragBuffered=function(D,R){this.detectPartialFragments(R)},k.hasFragment=function(D){var R=w(D);return!!this.fragments[R]},k.removeFragmentsInRange=function(D,R,O){var C=this;Object.keys(this.fragments).forEach(function(E){var u=C.fragments[E];if(u&&u.buffered){var l=u.body;l.type===O&&l.start<R&&l.end>D&&C.removeFragment(l)}})},k.removeFragment=function(D){var R=w(D);D.stats.loaded=0,D.clearElementaryStreamInfo(),delete this.fragments[R]},k.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},I})();function U(I){var k,x;return I.buffered&&(((k=I.range.video)===null||k===void 0?void 0:k.partial)||((x=I.range.audio)===null||x===void 0?void 0:x.partial))}function w(I){return I.type+"_"+I.level+"_"+I.urlId+"_"+I.sn}}),"./src/controller/gap-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{MAX_START_GAP_JUMP:()=>w,SKIP_BUFFER_HOLE_STEP_SECONDS:()=>I,SKIP_BUFFER_RANGE_START:()=>k,STALL_MINIMUM_DURATION_MS:()=>U,default:()=>x});var F=h("./src/utils/buffer-helper.ts"),T=h("./src/errors.ts"),N=h("./src/events.ts"),M=h("./src/utils/logger.ts"),U=250,w=2,I=.1,k=.05,x=(function(){function D(O,C,E,u){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=O,this.media=C,this.fragmentTracker=E,this.hls=u}var R=D.prototype;return R.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},R.poll=function(C,E){var u=this.config,l=this.media,c=this.stalled;if(l!==null){var d=l.currentTime,o=l.seeking,a=this.seeking&&!o,s=!this.seeking&&o;if(this.seeking=o,d!==C){if(this.moved=!0,c!==null){if(this.stallReported){var v=self.performance.now()-c;M.logger.warn("playback not stuck anymore @"+d+", after "+Math.round(v)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((s||a)&&(this.stalled=null),!(l.paused&&!o||l.ended||l.playbackRate===0||!F.BufferHelper.getBuffered(l).length)){var m=F.BufferHelper.bufferInfo(l,d,0),_=m.len>0,g=m.nextStart||0;if(!(!_&&!g)){if(o){var A=m.len>w,y=!g||E&&E.start<=d||g-d>w&&!this.fragmentTracker.getPartialFragment(d);if(A||y)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var p,b=Math.max(g,m.start||0)-d,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,B=P==null||(p=P.details)===null||p===void 0?void 0:p.live,V=B?P.details.targetduration*2:w;if(b>0&&b<=V){this._trySkipBufferHole(null);return}}var W=self.performance.now();if(c===null){this.stalled=W;return}var j=W-c;if(!(!o&&j>=U&&(this._reportStall(m),!this.media))){var $=F.BufferHelper.bufferInfo(l,d,u.maxBufferHole);this._tryFixBufferStall($,j)}}}}},R._tryFixBufferStall=function(C,E){var u=this.config,l=this.fragmentTracker,c=this.media;if(c!==null){var d=c.currentTime,o=l.getPartialFragment(d);if(o){var a=this._trySkipBufferHole(o);if(a||!this.media)return}C.len>u.maxBufferHole&&E>u.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},R._reportStall=function(C){var E=this.hls,u=this.media,l=this.stallReported;!l&&u&&(this.stallReported=!0,M.logger.warn("Playback stalling at @"+u.currentTime+" due to low buffer ("+JSON.stringify(C)+")"),E.trigger(N.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:C.len}))},R._trySkipBufferHole=function(C){var E=this.config,u=this.hls,l=this.media;if(l===null)return 0;for(var c=l.currentTime,d=0,o=F.BufferHelper.getBuffered(l),a=0;a<o.length;a++){var s=o.start(a);if(c+E.maxBufferHole>=d&&c<s){var v=Math.max(s+k,l.currentTime+I);return M.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+v),this.moved=!0,this.stalled=null,l.currentTime=v,C&&u.trigger(N.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+v,frag:C}),v}d=o.end(a)}return 0},R._tryNudgeBuffer=function(){var C=this.config,E=this.hls,u=this.media,l=this.nudgeRetry;if(u!==null){var c=u.currentTime;if(this.nudgeRetry++,l<C.nudgeMaxRetry){var d=c+(l+1)*C.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+c+" to "+d),u.currentTime=d,E.trigger(N.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+C.nudgeMaxRetry+" nudges"),E.trigger(N.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},D})()}),"./src/controller/id3-track-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>C});var F=h("./src/polyfills/number.ts"),T=h("./src/events.ts"),N=h("./src/utils/texttrack-utils.ts"),M=h("./src/demux/id3.ts"),U=h("./src/loader/date-range.ts"),w=h("./src/types/demuxer.ts"),I=.25;function k(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var x=(function(){var E=k();try{new E(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function D(E,u){return E.getTime()/1e3-u}function R(E){return Uint8Array.from(E.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var O=(function(){function E(l){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=l,this._registerListeners()}var u=E.prototype;return u.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},u._registerListeners=function(){var c=this.hls;c.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(T.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.on(T.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u._unregisterListeners=function(){var c=this.hls;c.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(T.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.off(T.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u.onMediaAttached=function(c,d){this.media=d.media},u.onMediaDetaching=function(){this.id3Track&&((0,N.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},u.onManifestLoading=function(){this.dateRangeCuesAppended={}},u.createTrack=function(c){var d=this.getID3Track(c.textTracks);return d.mode="hidden",d},u.getID3Track=function(c){if(this.media){for(var d=0;d<c.length;d++){var o=c[d];if(o.kind==="metadata"&&o.label==="id3")return(0,N.sendAddTrackEvent)(o,this.media),o}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(c,d){if(this.media){var o=this.hls.config,a=o.enableEmsgMetadataCues,s=o.enableID3MetadataCues;if(!(!a&&!s)){d.frag;var v=d.samples;d.details,this.id3Track||(this.id3Track=this.createTrack(this.media));for(var m=k(),_=0;_<v.length;_++){var g=v[_].type;if(!(g===w.MetadataSchema.emsg&&!a||!s)){var A=M.getID3Frames(v[_].data);if(A){var y=v[_].pts,p=y+v[_].duration;p>x&&(p=x);var b=p-y;b<=0&&(p=y+I);for(var P=0;P<A.length;P++){var B=A[P];if(!M.isTimeStampFrame(B)){this.updateId3CueEnds(y);var V=new m(y,p,"");V.value=B,g&&(V.type=g),this.id3Track.addCue(V)}}}}}}}},u.updateId3CueEnds=function(c){var d,o=(d=this.id3Track)===null||d===void 0?void 0:d.cues;if(o)for(var a=o.length;a--;){var s=o[a];s.startTime<c&&s.endTime===x&&(s.endTime=c)}},u.onBufferFlushing=function(c,d){var o=d.startOffset,a=d.endOffset,s=d.type,v=this.id3Track,m=this.hls;if(m){var _=m.config,g=_.enableEmsgMetadataCues,A=_.enableID3MetadataCues;if(v&&(g||A)){var y;s==="audio"?y=function(b){return b.type===w.MetadataSchema.audioId3&&A}:s==="video"?y=function(b){return b.type===w.MetadataSchema.emsg&&g}:y=function(b){return b.type===w.MetadataSchema.audioId3&&A||b.type===w.MetadataSchema.emsg&&g},(0,N.removeCuesInRange)(v,o,a,y)}}},u.onLevelUpdated=function(c,d){var o=this,a=d.details;if(!(!this.media||!a.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var s=this.dateRangeCuesAppended,v=this.id3Track,m=a.dateRanges,_=Object.keys(m);if(v)for(var g=Object.keys(s).filter(function(W){return!_.includes(W)}),A=function(j){var $=g[j];Object.keys(s[$].cues).forEach(function(Q){v.removeCue(s[$].cues[Q])}),delete s[$]},y=g.length;y--;)A(y);var p=a.fragments[a.fragments.length-1];if(!(_.length===0||!(0,F.isFiniteNumber)(p?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var b=p.programDateTime/1e3-p.start,P=k(),B=function(j){var $=_[j],Q=m[$],Z=s[$],ee=Z?.cues||{},se=Z?.durationKnown||!1,Y=D(Q.startDate,b),X=x,q=Q.endDate;if(q)X=D(q,b),se=!0;else if(Q.endOnNext&&!se){var re=_.reduce(function(J,ae){var ie=m[ae];return ie.class===Q.class&&ie.id!==ae&&ie.startDate>Q.startDate&&J.push(ie),J},[]).sort(function(J,ae){return J.startDate.getTime()-ae.startDate.getTime()})[0];re&&(X=D(re.startDate,b),se=!0)}for(var te=Object.keys(Q.attr),ne=0;ne<te.length;ne++){var K=te[ne];if(!(K===U.DateRangeAttribute.ID||K===U.DateRangeAttribute.CLASS||K===U.DateRangeAttribute.START_DATE||K===U.DateRangeAttribute.DURATION||K===U.DateRangeAttribute.END_DATE||K===U.DateRangeAttribute.END_ON_NEXT)){var H=ee[K];if(H)se&&!Z.durationKnown&&(H.endTime=X);else{var z=Q.attr[K];H=new P(Y,X,""),(K===U.DateRangeAttribute.SCTE35_OUT||K===U.DateRangeAttribute.SCTE35_IN)&&(z=R(z)),H.value={key:K,data:z},H.type=w.MetadataSchema.dateRange,o.id3Track.addCue(H),ee[K]=H}}}s[$]={cues:ee,dateRange:Q,durationKnown:se}},V=0;V<_.length;V++)B(V)}}},E})();const C=O}),"./src/controller/latency-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>w});var F=h("./src/errors.ts"),T=h("./src/events.ts"),N=h("./src/utils/logger.ts");function M(I,k){for(var x=0;x<k.length;x++){var D=k[x];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(I,D.key,D)}}function U(I,k,x){return k&&M(I.prototype,k),Object.defineProperty(I,"prototype",{writable:!1}),I}var w=(function(){function I(x){var D=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return D.timeupdate()},this.hls=x,this.config=x.config,this.registerListeners()}var k=I.prototype;return k.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},k.registerListeners=function(){this.hls.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(T.Events.ERROR,this.onError,this)},k.unregisterListeners=function(){this.hls.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(T.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(T.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(T.Events.ERROR,this.onError)},k.onMediaAttached=function(D,R){this.media=R.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},k.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},k.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},k.onLevelUpdated=function(D,R){var O=R.details;this.levelDetails=O,O.advanced&&this.timeupdate(),!O.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},k.onError=function(D,R){R.details===F.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,N.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},k.timeupdate=function(){var D=this.media,R=this.levelDetails;if(!(!D||!R)){this.currentTime=D.currentTime;var O=this.computeLatency();if(O!==null){this._latency=O;var C=this.config,E=C.lowLatencyMode,u=C.maxLiveSyncPlaybackRate;if(!(!E||u===1)){var l=this.targetLatency;if(l!==null){var c=O-l,d=Math.min(this.maxLatency,l+R.targetduration),o=c<d;if(R.live&&o&&c>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,u)),s=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;D.playbackRate=Math.min(a,Math.max(1,s))}else D.playbackRate!==1&&D.playbackRate!==0&&(D.playbackRate=1)}}}}},k.estimateLiveEdge=function(){var D=this.levelDetails;return D===null?null:D.edge+D.age},k.computeLatency=function(){var D=this.estimateLiveEdge();return D===null?null:D-this.currentTime},U(I,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var D=this.config,R=this.levelDetails;return D.liveMaxLatencyDuration!==void 0?D.liveMaxLatencyDuration:R?D.liveMaxLatencyDurationCount*R.targetduration:0}},{key:"targetLatency",get:function(){var D=this.levelDetails;if(D===null)return null;var R=D.holdBack,O=D.partHoldBack,C=D.targetduration,E=this.config,u=E.liveSyncDuration,l=E.liveSyncDurationCount,c=E.lowLatencyMode,d=this.hls.userConfig,o=c&&O||R;(d.liveSyncDuration||d.liveSyncDurationCount||o===0)&&(o=u!==void 0?u:l*C);var a=C,s=1;return o+Math.min(this.stallCount*s,a)}},{key:"liveSyncPosition",get:function(){var D=this.estimateLiveEdge(),R=this.targetLatency,O=this.levelDetails;if(D===null||R===null||O===null)return null;var C=O.edge,E=D-R-this.edgeStalled,u=C-O.totalduration,l=C-(this.config.lowLatencyMode&&O.partTarget||O.targetduration);return Math.min(Math.max(u,E),l)}},{key:"drift",get:function(){var D=this.levelDetails;return D===null?1:D.drift}},{key:"edgeStalled",get:function(){var D=this.levelDetails;if(D===null)return 0;var R=(this.config.lowLatencyMode&&D.partTarget||D.targetduration)*3;return Math.max(D.age-R,0)}},{key:"forwardBufferLength",get:function(){var D=this.media,R=this.levelDetails;if(!D||!R)return 0;var O=D.buffered.length;return(O?D.buffered.end(O-1):R.edge)-this.currentTime}}]),I})()}),"./src/controller/level-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>E});var F=h("./src/types/level.ts"),T=h("./src/events.ts"),N=h("./src/errors.ts"),M=h("./src/utils/codecs.ts"),U=h("./src/controller/level-helper.ts"),w=h("./src/controller/base-playlist-controller.ts"),I=h("./src/types/loader.ts");function k(){return k=Object.assign?Object.assign.bind():function(u){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(u[d]=c[d])}return u},k.apply(this,arguments)}function x(u,l){for(var c=0;c<l.length;c++){var d=l[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}function D(u,l,c){return l&&x(u.prototype,l),Object.defineProperty(u,"prototype",{writable:!1}),u}function R(u,l){u.prototype=Object.create(l.prototype),u.prototype.constructor=u,O(u,l)}function O(u,l){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,o){return d.__proto__=o,d},O(u,l)}var C=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),E=(function(u){R(l,u);function l(d){var o;return o=u.call(this,d,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var c=l.prototype;return c._registerListeners=function(){var o=this.hls;o.on(T.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(T.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(T.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(T.Events.ERROR,this.onError,this)},c._unregisterListeners=function(){var o=this.hls;o.off(T.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(T.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(T.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(T.Events.ERROR,this.onError,this)},c.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,u.prototype.destroy.call(this)},c.startLoad=function(){var o=this._levels;o.forEach(function(a){a.loadError=0}),u.prototype.startLoad.call(this)},c.onManifestLoaded=function(o,a){var s=[],v=[],m=[],_,g={},A,y=!1,p=!1,b=!1;if(a.levels.forEach(function(W){var j=W.attrs;y=y||!!(W.width&&W.height),p=p||!!W.videoCodec,b=b||!!W.audioCodec,C&&W.audioCodec&&W.audioCodec.indexOf("mp4a.40.34")!==-1&&(W.audioCodec=void 0);var $=W.bitrate+"-"+W.attrs.RESOLUTION+"-"+W.attrs.CODECS;A=g[$],A?A.url.push(W.url):(A=new F.Level(W),g[$]=A,s.push(A)),j&&(j.AUDIO&&(0,U.addGroupId)(A,"audio",j.AUDIO),j.SUBTITLES&&(0,U.addGroupId)(A,"text",j.SUBTITLES))}),(y||p)&&b&&(s=s.filter(function(W){var j=W.videoCodec,$=W.width,Q=W.height;return!!j||!!($&&Q)})),s=s.filter(function(W){var j=W.audioCodec,$=W.videoCodec;return(!j||(0,M.isCodecSupportedInMp4)(j,"audio"))&&(!$||(0,M.isCodecSupportedInMp4)($,"video"))}),a.audioTracks&&(v=a.audioTracks.filter(function(W){return!W.audioCodec||(0,M.isCodecSupportedInMp4)(W.audioCodec,"audio")}),(0,U.assignTrackIdsByGroup)(v)),a.subtitles&&(m=a.subtitles,(0,U.assignTrackIdsByGroup)(m)),s.length>0){_=s[0].bitrate,s.sort(function(W,j){return W.bitrate-j.bitrate}),this._levels=s;for(var P=0;P<s.length;P++)if(s[P].bitrate===_){this._firstLevel=P,this.log("manifest loaded, "+s.length+" level(s) found, first bitrate: "+_);break}var B=b&&!p,V={levels:s,audioTracks:v,subtitleTracks:m,firstLevel:this._firstLevel,stats:a.stats,audio:b,video:p,altAudio:!B&&v.some(function(W){return!!W.url})};this.hls.trigger(T.Events.MANIFEST_PARSED,V),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(T.Events.ERROR,{type:N.ErrorTypes.MEDIA_ERROR,details:N.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},c.onError=function(o,a){var s;if(u.prototype.onError.call(this,o,a),!a.fatal){var v=a.context,m=this._levels[this.currentLevelIndex];if(v&&(v.type===I.PlaylistContextType.AUDIO_TRACK&&m.audioGroupIds&&v.groupId===m.audioGroupIds[m.urlId]||v.type===I.PlaylistContextType.SUBTITLE_TRACK&&m.textGroupIds&&v.groupId===m.textGroupIds[m.urlId])){this.redundantFailover(this.currentLevelIndex);return}var _=!1,g=!0,A;switch(a.details){case N.ErrorDetails.FRAG_LOAD_ERROR:case N.ErrorDetails.FRAG_LOAD_TIMEOUT:case N.ErrorDetails.KEY_LOAD_ERROR:case N.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var y=a.frag.type===I.PlaylistLevelType.MAIN?a.frag.level:this.currentLevelIndex,p=this._levels[y];p?(p.fragmentError++,p.fragmentError>this.hls.config.fragLoadingMaxRetry&&(A=y)):A=y}break;case N.ErrorDetails.LEVEL_LOAD_ERROR:case N.ErrorDetails.LEVEL_LOAD_TIMEOUT:v&&(v.deliveryDirectives&&(g=!1),A=v.level),_=!0;break;case N.ErrorDetails.REMUX_ALLOC_ERROR:A=(s=a.level)!=null?s:this.currentLevelIndex,_=!0;break}A!==void 0&&this.recoverLevel(a,A,_,g)}},c.recoverLevel=function(o,a,s,v){var m=o.details,_=this._levels[a];if(_.loadError++,s){var g=this.retryLoadingOrFail(o);if(g)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(v){var A=_.url.length;if(A>1&&_.loadError<A)o.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){for(var y=-1,p=this._levels,b=p.length;b--;){var P=(b+this.currentLevelIndex)%p.length;if(P!==this.currentLevelIndex&&p[P].loadError===0){y=P;break}}y>-1&&this.currentLevelIndex!==y&&(this.warn(m+": switch to "+y),o.levelRetry=!0,this.hls.nextAutoLevel=y)}}},c.redundantFailover=function(o){var a=this._levels[o],s=a.url.length;if(s>1){var v=(a.urlId+1)%s;this.warn("Switching to redundant URL-id "+v),this._levels.forEach(function(m){m.urlId=v}),this.level=o}},c.onFragLoaded=function(o,a){var s=a.frag;if(s!==void 0&&s.type===I.PlaylistLevelType.MAIN){var v=this._levels[s.level];v!==void 0&&(v.fragmentError=0,v.loadError=0)}},c.onLevelLoaded=function(o,a){var s,v=a.level,m=a.details,_=this._levels[v];if(!_){var g;this.warn("Invalid level index "+v),(g=a.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(m.deltaUpdateFailed=!0);return}v===this.currentLevelIndex?(_.fragmentError===0&&(_.loadError=0,this.retryCount=0),this.playlistLoaded(v,a,_.details)):(s=a.deliveryDirectives)!==null&&s!==void 0&&s.skip&&(m.deltaUpdateFailed=!0)},c.onAudioTrackSwitched=function(o,a){var s=this.hls.levels[this.currentLevelIndex];if(s&&s.audioGroupIds){for(var v=-1,m=this.hls.audioTracks[a.id].groupId,_=0;_<s.audioGroupIds.length;_++)if(s.audioGroupIds[_]===m){v=_;break}v!==s.urlId&&(s.urlId=v,this.startLoad())}},c.loadPlaylist=function(o){var a=this.currentLevelIndex,s=this._levels[a];if(this.canLoad&&s&&s.url.length>0){var v=s.urlId,m=s.url[v];if(o)try{m=o.addDirectives(m)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("Attempt loading level index "+a+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+v+" "+m),this.clearTimer(),this.hls.trigger(T.Events.LEVEL_LOADING,{url:m,level:a,id:v,deliveryDirectives:o||null})}},c.removeLevel=function(o,a){var s=function(_,g){return g!==a},v=this._levels.filter(function(m,_){return _!==o?!0:m.url.length>1&&a!==void 0?(m.url=m.url.filter(s),m.audioGroupIds&&(m.audioGroupIds=m.audioGroupIds.filter(s)),m.textGroupIds&&(m.textGroupIds=m.textGroupIds.filter(s)),m.urlId=0,!0):!1}).map(function(m,_){var g=m.details;return g!=null&&g.fragments&&g.fragments.forEach(function(A){A.level=_}),m});this._levels=v,this.hls.trigger(T.Events.LEVELS_UPDATED,{levels:v})},D(l,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var a,s=this._levels;if(s.length!==0&&!(this.currentLevelIndex===o&&(a=s[o])!==null&&a!==void 0&&a.details)){if(o<0||o>=s.length){var v=o<0;if(this.hls.trigger(T.Events.ERROR,{type:N.ErrorTypes.OTHER_ERROR,details:N.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:v,reason:"invalid level idx"}),v)return;o=Math.min(o,s.length-1)}this.clearTimer();var m=this.currentLevelIndex,_=s[m],g=s[o];this.log("switching to level "+o+" from "+m),this.currentLevelIndex=o;var A=k({},g,{level:o,maxBitrate:g.maxBitrate,uri:g.uri,urlId:g.urlId});delete A._urlId,this.hls.trigger(T.Events.LEVEL_SWITCHING,A);var y=g.details;if(!y||y.live){var p=this.switchParams(g.uri,_?.details);this.loadPlaylist(p)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),l})(w.default)}),"./src/controller/level-helper.ts":((S,L,h)=>{h.r(L),h.d(L,{addGroupId:()=>U,addSliding:()=>u,adjustSliding:()=>E,assignTrackIdsByGroup:()=>w,computeReloadInterval:()=>l,getFragmentWithSN:()=>c,getPartWith:()=>d,mapFragmentIntersection:()=>C,mapPartIntersection:()=>O,mergeDetails:()=>D,updateFragPTSDTS:()=>x,updatePTS:()=>I});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/logger.ts"),N=h("./src/loader/date-range.ts");function M(){return M=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var v in s)Object.prototype.hasOwnProperty.call(s,v)&&(o[v]=s[v])}return o},M.apply(this,arguments)}function U(o,a,s){switch(a){case"audio":o.audioGroupIds||(o.audioGroupIds=[]),o.audioGroupIds.push(s);break;case"text":o.textGroupIds||(o.textGroupIds=[]),o.textGroupIds.push(s);break}}function w(o){var a={};o.forEach(function(s){var v=s.groupId||"";s.id=a[v]=a[v]||0,a[v]++})}function I(o,a,s){var v=o[a],m=o[s];k(v,m)}function k(o,a){var s=a.startPTS;if((0,F.isFiniteNumber)(s)){var v=0,m;a.sn>o.sn?(v=s-o.start,m=o):(v=o.start-s,m=a),m.duration!==v&&(m.duration=v)}else if(a.sn>o.sn){var _=o.cc===a.cc;_&&o.minEndPTS?a.start=o.start+(o.minEndPTS-o.start):a.start=o.start+o.duration}else a.start=Math.max(o.start-a.duration,0)}function x(o,a,s,v,m,_){var g=v-s;g<=0&&(T.logger.warn("Fragment should have a positive duration",a),v=s+a.duration,_=m+a.duration);var A=s,y=v,p=a.startPTS,b=a.endPTS;if((0,F.isFiniteNumber)(p)){var P=Math.abs(p-s);(0,F.isFiniteNumber)(a.deltaPTS)?a.deltaPTS=Math.max(P,a.deltaPTS):a.deltaPTS=P,A=Math.max(s,p),s=Math.min(s,p),m=Math.min(m,a.startDTS),y=Math.min(v,b),v=Math.max(v,b),_=Math.max(_,a.endDTS)}a.duration=v-s;var B=s-a.start;a.appendedPTS=v,a.start=a.startPTS=s,a.maxStartPTS=A,a.startDTS=m,a.endPTS=v,a.minEndPTS=y,a.endDTS=_;var V=a.sn;if(!o||V<o.startSN||V>o.endSN)return 0;var W,j=V-o.startSN,$=o.fragments;for($[j]=a,W=j;W>0;W--)k($[W],$[W-1]);for(W=j;W<$.length-1;W++)k($[W],$[W+1]);return o.fragmentHint&&k($[$.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,B}function D(o,a){for(var s=null,v=o.fragments,m=v.length-1;m>=0;m--){var _=v[m].initSegment;if(_){s=_;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;var g=0,A;if(C(o,a,function(W,j){W.relurl&&(g=W.cc-j.cc),(0,F.isFiniteNumber)(W.startPTS)&&(0,F.isFiniteNumber)(W.endPTS)&&(j.start=j.startPTS=W.startPTS,j.startDTS=W.startDTS,j.appendedPTS=W.appendedPTS,j.maxStartPTS=W.maxStartPTS,j.endPTS=W.endPTS,j.endDTS=W.endDTS,j.minEndPTS=W.minEndPTS,j.duration=W.endPTS-W.startPTS,j.duration&&(A=j),a.PTSKnown=a.alignedSliding=!0),j.elementaryStreams=W.elementaryStreams,j.loader=W.loader,j.stats=W.stats,j.urlId=W.urlId,W.initSegment&&(j.initSegment=W.initSegment,s=W.initSegment)}),s){var y=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;y.forEach(function(W){var j;(!W.initSegment||W.initSegment.relurl===((j=s)===null||j===void 0?void 0:j.relurl))&&(W.initSegment=s)})}if(a.skippedSegments)if(a.deltaUpdateFailed=a.fragments.some(function(W){return!W}),a.deltaUpdateFailed){T.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var p=a.skippedSegments;p--;)a.fragments.shift();a.startSN=a.fragments[0].sn,a.startCC=a.fragments[0].cc}else a.canSkipDateRanges&&(a.dateRanges=R(o.dateRanges,a.dateRanges,a.recentlyRemovedDateranges));var b=a.fragments;if(g){T.logger.warn("discontinuity sliding from playlist, take drift into account");for(var P=0;P<b.length;P++)b[P].cc+=g}a.skippedSegments&&(a.startCC=a.fragments[0].cc),O(o.partList,a.partList,function(W,j){j.elementaryStreams=W.elementaryStreams,j.stats=W.stats}),A?x(a,A,A.startPTS,A.endPTS,A.startDTS,A.endDTS):E(o,a),b.length&&(a.totalduration=a.edge-b[0].start),a.driftStartTime=o.driftStartTime,a.driftStart=o.driftStart;var B=a.advancedDateTime;if(a.advanced&&B){var V=a.edge;a.driftStart||(a.driftStartTime=B,a.driftStart=V),a.driftEndTime=B,a.driftEnd=V}else a.driftEndTime=o.driftEndTime,a.driftEnd=o.driftEnd,a.advancedDateTime=o.advancedDateTime}function R(o,a,s){var v=M({},o);return s&&s.forEach(function(m){delete v[m]}),Object.keys(a).forEach(function(m){var _=new N.DateRange(a[m].attr,v[m]);_.isValid?v[m]=_:T.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(a[m].attr)+'"')}),v}function O(o,a,s){if(o&&a)for(var v=0,m=0,_=o.length;m<=_;m++){var g=o[m],A=a[m+v];g&&A&&g.index===A.index&&g.fragment.sn===A.fragment.sn?s(g,A):v--}}function C(o,a,s){for(var v=a.skippedSegments,m=Math.max(o.startSN,a.startSN)-a.startSN,_=(o.fragmentHint?1:0)+(v?a.endSN:Math.min(o.endSN,a.endSN))-a.startSN,g=a.startSN-o.startSN,A=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments,y=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments,p=m;p<=_;p++){var b=y[g+p],P=A[p];v&&!P&&p<v&&(P=a.fragments[p]=b),b&&P&&s(b,P)}}function E(o,a){var s=a.startSN+a.skippedSegments-o.startSN,v=o.fragments;s<0||s>=v.length||u(a,v[s].start)}function u(o,a){if(a){for(var s=o.fragments,v=o.skippedSegments;v<s.length;v++)s[v].start+=a;o.fragmentHint&&(o.fragmentHint.start+=a)}}function l(o,a){var s=1e3*o.levelTargetDuration,v=s/2,m=o.age,_=m>0&&m<s*3,g=a.loading.end-a.loading.start,A,y=o.availabilityDelay;if(o.updated===!1)if(_){var p=333*o.misses;A=Math.max(Math.min(v,g*2),p),o.availabilityDelay=(o.availabilityDelay||0)+A}else A=v;else _?(y=Math.min(y||s/2,m),o.availabilityDelay=y,A=y+s-m):A=s-g;return Math.round(A)}function c(o,a,s){if(!o||!o.details)return null;var v=o.details,m=v.fragments[a-v.startSN];return m||(m=v.fragmentHint,m&&m.sn===a)?m:a<v.startSN&&s&&s.sn===a?s:null}function d(o,a,s){if(!o||!o.details)return null;var v=o.details.partList;if(v)for(var m=v.length;m--;){var _=v[m];if(_.index===s&&_.fragment.sn===a)return _}return null}}),"./src/controller/stream-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>d});var F=h("./src/polyfills/number.ts"),T=h("./src/controller/base-stream-controller.ts"),N=h("./src/is-supported.ts"),M=h("./src/events.ts"),U=h("./src/utils/buffer-helper.ts"),w=h("./src/controller/fragment-tracker.ts"),I=h("./src/types/loader.ts"),k=h("./src/loader/fragment.ts"),x=h("./src/demux/transmuxer-interface.ts"),D=h("./src/types/transmuxer.ts"),R=h("./src/controller/gap-controller.ts"),O=h("./src/errors.ts");function C(o,a){for(var s=0;s<a.length;s++){var v=a[s];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(o,v.key,v)}}function E(o,a,s){return a&&C(o.prototype,a),Object.defineProperty(o,"prototype",{writable:!1}),o}function u(o,a){o.prototype=Object.create(a.prototype),o.prototype.constructor=o,l(o,a)}function l(o,a){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},l(o,a)}var c=100,d=(function(o){u(a,o);function a(v,m){var _;return _=o.call(this,v,m,"[stream-controller]")||this,_.audioCodecSwap=!1,_.gapController=null,_.level=-1,_._forceStartLoad=!1,_.altAudio=!1,_.audioOnly=!1,_.fragPlaying=null,_.onvplaying=null,_.onvseeked=null,_.fragLastKbps=0,_.couldBacktrack=!1,_.backtrackFragment=null,_.audioCodecSwitch=!1,_.videoBuffer=null,_._registerListeners(),_}var s=a.prototype;return s._registerListeners=function(){var m=this.hls;m.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),m.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),m.on(M.Events.ERROR,this.onError,this),m.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),m.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),m.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),m.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),m.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),m.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var m=this.hls;m.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),m.off(M.Events.ERROR,this.onError,this),m.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),m.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),m.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),m.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),m.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),m.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},s.startLoad=function(m){if(this.levels){var _=this.lastCurrentTime,g=this.hls;if(this.stopLoad(),this.setInterval(c),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var A=g.startLevel;A===-1&&(g.config.testBandwidth&&this.levels.length>1?(A=0,this.bitrateTest=!0):A=g.nextAutoLevel),this.level=g.nextLoadLevel=A,this.loadedmetadata=!1}_>0&&m===-1&&(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),m=_),this.state=T.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=m,this.tick()}else this._forceStartLoad=!0,this.state=T.State.STOPPED},s.stopLoad=function(){this._forceStartLoad=!1,o.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case T.State.IDLE:this.doTickIdle();break;case T.State.WAITING_LEVEL:{var m,_=this.levels,g=this.level,A=_==null||(m=_[g])===null||m===void 0?void 0:m.details;if(A&&(!A.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(A))break;this.state=T.State.IDLE;break}break}case T.State.FRAG_LOADING_WAITING_RETRY:{var y,p=self.performance.now(),b=this.retryDate;(!b||p>=b||(y=this.media)!==null&&y!==void 0&&y.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=T.State.IDLE)}break}this.onTickEnd()},s.onTickEnd=function(){o.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},s.doTickIdle=function(){var m,_,g=this.hls,A=this.levelLastLoaded,y=this.levels,p=this.media,b=g.config,P=g.nextLoadLevel;if(!(A===null||!p&&(this.startFragRequested||!b.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!y||!y[P])){var B=y[P];this.level=g.nextLoadLevel=P;var V=B.details;if(!V||this.state===T.State.WAITING_LEVEL||V.live&&this.levelLastLoaded!==P){this.state=T.State.WAITING_LEVEL;return}var W=this.getMainFwdBufferInfo();if(W!==null){var j=W.len,$=this.getMaxBufferLength(B.maxBitrate);if(!(j>=$)){if(this._streamEnded(W,V)){var Q={};this.altAudio&&(Q.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,Q),this.state=T.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>W.end&&(this.backtrackFragment=null);var Z=this.backtrackFragment?this.backtrackFragment.start:W.end,ee=this.getNextFragment(Z,V);if(this.couldBacktrack&&!this.fragPrevious&&ee&&ee.sn!=="initSegment"&&this.fragmentTracker.getState(ee)!==w.FragmentState.OK){var se,Y=((se=this.backtrackFragment)!=null?se:ee).sn,X=Y-V.startSN,q=V.fragments[X-1];q&&ee.cc===q.cc&&(ee=q,this.fragmentTracker.removeFragment(q))}else this.backtrackFragment&&W.len&&(this.backtrackFragment=null);if(ee&&this.fragmentTracker.getState(ee)===w.FragmentState.OK&&this.nextLoadPosition>Z){var re=this.audioOnly&&!this.altAudio?k.ElementaryStreamTypes.AUDIO:k.ElementaryStreamTypes.VIDEO;p&&this.afterBufferFlushed(p,re,I.PlaylistLevelType.MAIN),ee=this.getNextFragment(this.nextLoadPosition,V)}ee&&(ee.initSegment&&!ee.initSegment.data&&!this.bitrateTest&&(ee=ee.initSegment),((m=ee.decryptdata)===null||m===void 0?void 0:m.keyFormat)==="identity"&&!((_=ee.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(ee,V):this.loadFragment(ee,V,Z))}}}},s.loadFragment=function(m,_,g){var A,y=this.fragmentTracker.getState(m);this.fragCurrent=m,y===w.FragmentState.NOT_LOADED?m.sn==="initSegment"?this._loadInitSegment(m):this.bitrateTest?(this.log("Fragment "+m.sn+" of level "+m.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(m)):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,m,_,g)):y===w.FragmentState.APPENDING?this.reduceMaxBufferLength(m.duration)&&this.fragmentTracker.removeFragment(m):((A=this.media)===null||A===void 0?void 0:A.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},s.getAppendedFrag=function(m){var _=this.fragmentTracker.getAppendedFrag(m,I.PlaylistLevelType.MAIN);return _&&"fragment"in _?_.fragment:_},s.getBufferedFrag=function(m){return this.fragmentTracker.getBufferedFrag(m,I.PlaylistLevelType.MAIN)},s.followingBufferedFrag=function(m){return m?this.getBufferedFrag(m.end+.5):null},s.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.nextLevelSwitch=function(){var m=this.levels,_=this.media;if(_!=null&&_.readyState){var g,A=this.getAppendedFrag(_.currentTime);if(A&&A.start>1&&this.flushMainBuffer(0,A.start-1),!_.paused&&m){var y=this.hls.nextLoadLevel,p=m[y],b=this.fragLastKbps;b&&this.fragCurrent?g=this.fragCurrent.duration*p.maxBitrate/(1e3*b)+1:g=0}else g=0;var P=this.getBufferedFrag(_.currentTime+g);if(P){var B=this.followingBufferedFrag(P);if(B){this.abortCurrentFrag();var V=B.maxStartPTS?B.maxStartPTS:B.start,W=B.duration,j=Math.max(P.end,V+Math.min(Math.max(W-this.config.maxFragLookUpTolerance,W*.5),W*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},s.abortCurrentFrag=function(){var m=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,m!=null&&m.loader&&m.loader.abort(),this.state){case T.State.KEY_LOADING:case T.State.FRAG_LOADING:case T.State.FRAG_LOADING_WAITING_RETRY:case T.State.PARSING:case T.State.PARSED:this.state=T.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},s.flushMainBuffer=function(m,_){o.prototype.flushMainBuffer.call(this,m,_,this.altAudio?"video":null)},s.onMediaAttached=function(m,_){o.prototype.onMediaAttached.call(this,m,_);var g=_.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),g.addEventListener("playing",this.onvplaying),g.addEventListener("seeked",this.onvseeked),this.gapController=new R.default(this.config,g,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var m=this.media;m&&this.onvplaying&&this.onvseeked&&(m.removeEventListener("playing",this.onvplaying),m.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),o.prototype.onMediaDetaching.call(this)},s.onMediaPlaying=function(){this.tick()},s.onMediaSeeked=function(){var m=this.media,_=m?m.currentTime:null;(0,F.isFiniteNumber)(_)&&this.log("Media seeked to "+_.toFixed(3)),this.tick()},s.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},s.onManifestParsed=function(m,_){var g=!1,A=!1,y;_.levels.forEach(function(p){y=p.audioCodec,y&&(y.indexOf("mp4a.40.2")!==-1&&(g=!0),y.indexOf("mp4a.40.5")!==-1&&(A=!0))}),this.audioCodecSwitch=g&&A&&!(0,N.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=_.levels,this.startFragRequested=!1},s.onLevelLoading=function(m,_){var g=this.levels;if(!(!g||this.state!==T.State.IDLE)){var A=g[_.level];(!A.details||A.details.live&&this.levelLastLoaded!==_.level||this.waitForCdnTuneIn(A.details))&&(this.state=T.State.WAITING_LEVEL)}},s.onLevelLoaded=function(m,_){var g,A=this.levels,y=_.level,p=_.details,b=p.totalduration;if(!A){this.warn("Levels were reset while loading level "+y);return}this.log("Level "+y+" loaded ["+p.startSN+","+p.endSN+"], cc ["+p.startCC+", "+p.endCC+"] duration:"+b);var P=this.fragCurrent;P&&(this.state===T.State.FRAG_LOADING||this.state===T.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==_.level&&P.loader&&(this.state=T.State.IDLE,this.backtrackFragment=null,P.loader.abort());var B=A[y],V=0;if(p.live||(g=B.details)!==null&&g!==void 0&&g.live){if(p.fragments[0]||(p.deltaUpdateFailed=!0),p.deltaUpdateFailed)return;V=this.alignPlaylists(p,B.details)}if(B.details=p,this.levelLastLoaded=y,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:p,level:y}),this.state===T.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(p))return;this.state=T.State.IDLE}this.startFragRequested?p.live&&this.synchronizeToLiveEdge(p):this.setStartPosition(p,V),this.tick()},s._handleFragmentLoadProgress=function(m){var _,g=m.frag,A=m.part,y=m.payload,p=this.levels;if(!p){this.warn("Levels were reset while fragment load was in progress. Fragment "+g.sn+" of level "+g.level+" will not be buffered");return}var b=p[g.level],P=b.details;if(!P){this.warn("Dropping fragment "+g.sn+" of level "+g.level+" after level details were reset");return}var B=b.videoCodec,V=P.PTSKnown||!P.live,W=(_=g.initSegment)===null||_===void 0?void 0:_.data,j=this._getAudioCodec(b),$=this.transmuxer=this.transmuxer||new x.default(this.hls,I.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),Q=A?A.index:-1,Z=Q!==-1,ee=new D.ChunkMetadata(g.level,g.sn,g.stats.chunkCount,y.byteLength,Q,Z),se=this.initPTS[g.cc];$.push(y,W,j,B,g,A,P.totalduration,V,ee,se)},s.onAudioTrackSwitching=function(m,_){var g=this.altAudio,A=!!_.url,y=_.id;if(!A){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var p=this.fragCurrent;p!=null&&p.loader&&(this.log("Switching to main audio track, cancel main fragment load"),p.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var b=this.hls;g&&b.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),b.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:y})}},s.onAudioTrackSwitched=function(m,_){var g=_.id,A=!!this.hls.audioTracks[g].url;if(A){var y=this.videoBuffer;y&&this.mediaBuffer!==y&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=y)}this.altAudio=A,this.tick()},s.onBufferCreated=function(m,_){var g=_.tracks,A,y,p=!1;for(var b in g){var P=g[b];if(P.id==="main"){if(y=b,A=P,b==="video"){var B=g[b];B&&(this.videoBuffer=B.buffer)}}else p=!0}p&&A?(this.log("Alternate track found, use "+y+".buffered to schedule main fragment loading"),this.mediaBuffer=A.buffer):this.mediaBuffer=this.media},s.onFragBuffered=function(m,_){var g=_.frag,A=_.part;if(!(g&&g.type!==I.PlaylistLevelType.MAIN)){if(this.fragContextChanged(g)){this.warn("Fragment "+g.sn+(A?" p: "+A.index:"")+" of level "+g.level+" finished buffering, but was aborted. state: "+this.state),this.state===T.State.PARSED&&(this.state=T.State.IDLE);return}var y=A?A.stats:g.stats;this.fragLastKbps=Math.round(8*y.total/(y.buffering.end-y.loading.first)),g.sn!=="initSegment"&&(this.fragPrevious=g),this.fragBufferedComplete(g,A)}},s.onError=function(m,_){switch(_.details){case O.ErrorDetails.FRAG_LOAD_ERROR:case O.ErrorDetails.FRAG_LOAD_TIMEOUT:case O.ErrorDetails.KEY_LOAD_ERROR:case O.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.MAIN,_);break;case O.ErrorDetails.LEVEL_LOAD_ERROR:case O.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==T.State.ERROR&&(_.fatal?(this.warn(""+_.details),this.state=T.State.ERROR):!_.levelRetry&&this.state===T.State.WAITING_LEVEL&&(this.state=T.State.IDLE));break;case O.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="main"&&(this.state===T.State.PARSING||this.state===T.State.PARSED)){var g=!0,A=this.getFwdBufferInfo(this.media,I.PlaylistLevelType.MAIN);A&&A.len>.5&&(g=!this.reduceMaxBufferLength(A.len)),g&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},s.checkBuffer=function(){var m=this.media,_=this.gapController;if(!(!m||!_||!m.readyState)){if(this.loadedmetadata||!U.BufferHelper.getBuffered(m).length){var g=this.state!==T.State.IDLE?this.fragCurrent:null;_.poll(this.lastCurrentTime,g)}this.lastCurrentTime=m.currentTime}},s.onFragLoadEmergencyAborted=function(){this.state=T.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},s.onBufferFlushed=function(m,_){var g=_.type;if(g!==k.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var A=(g===k.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(A,g,I.PlaylistLevelType.MAIN)}},s.onLevelsUpdated=function(m,_){this.levels=_.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s.seekToStartPos=function(){var m=this.media;if(m){var _=m.currentTime,g=this.startPosition;if(g>=0&&_<g){if(m.seeking){this.log("could not seek to "+g+", already seeking at "+_);return}var A=U.BufferHelper.getBuffered(m),y=A.length?A.start(0):0,p=y-g;p>0&&(p<this.config.maxBufferHole||p<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+p+" to match buffer start"),g+=p,this.startPosition=g),this.log("seek to target start position "+g+" from current time "+_),m.currentTime=g}}},s._getAudioCodec=function(m){var _=this.config.defaultAudioCodec||m.audioCodec;return this.audioCodecSwap&&_&&(this.log("Swapping audio codec"),_.indexOf("mp4a.40.5")!==-1?_="mp4a.40.2":_="mp4a.40.5"),_},s._loadBitrateTestFrag=function(m){var _=this;m.bitrateTest=!0,this._doFragLoad(m).then(function(g){var A=_.hls;if(!(!g||A.nextLoadLevel||_.fragContextChanged(m))){_.fragLoadError=0,_.state=T.State.IDLE,_.startFragRequested=!1,_.bitrateTest=!1;var y=m.stats;y.parsing.start=y.parsing.end=y.buffering.start=y.buffering.end=self.performance.now(),A.trigger(M.Events.FRAG_LOADED,g),m.bitrateTest=!1}})},s._handleTransmuxComplete=function(m){var _,g="main",A=this.hls,y=m.remuxResult,p=m.chunkMeta,b=this.getCurrentContext(p);if(!b){this.warn("The loading context changed while buffering fragment "+p.sn+" of level "+p.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(p.level);return}var P=b.frag,B=b.part,V=b.level,W=y.video,j=y.text,$=y.id3,Q=y.initSegment,Z=V.details,ee=this.altAudio?void 0:y.audio;if(!this.fragContextChanged(P)){if(this.state=T.State.PARSING,Q){Q.tracks&&(this._bufferInitSegment(V,Q.tracks,P,p),A.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:g,tracks:Q.tracks}));var se=Q.initPTS,Y=Q.timescale;(0,F.isFiniteNumber)(se)&&(this.initPTS[P.cc]=se,A.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:g,initPTS:se,timescale:Y}))}if(W&&y.independent!==!1){if(Z){var X=W.startPTS,q=W.endPTS,re=W.startDTS,te=W.endDTS;if(B)B.elementaryStreams[W.type]={startPTS:X,endPTS:q,startDTS:re,endDTS:te};else if(W.firstKeyFrame&&W.independent&&(this.couldBacktrack=!0),W.dropped&&W.independent){var ne=this.getMainFwdBufferInfo(),K=(ne?ne.end:this.getLoadPosition())+this.config.maxBufferHole,H=W.firstKeyFramePTS?W.firstKeyFramePTS:X;if(K<H-this.config.maxBufferHole){this.backtrack(P);return}P.setElementaryStreamInfo(W.type,P.start,q,P.start,te,!0)}P.setElementaryStreamInfo(W.type,X,q,re,te),this.backtrackFragment&&(this.backtrackFragment=P),this.bufferFragmentData(W,P,B,p)}}else if(y.independent===!1){this.backtrack(P);return}if(ee){var z=ee.startPTS,J=ee.endPTS,ae=ee.startDTS,ie=ee.endDTS;B&&(B.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:z,endPTS:J,startDTS:ae,endDTS:ie}),P.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,z,J,ae,ie),this.bufferFragmentData(ee,P,B,p)}if(Z&&$!==null&&$!==void 0&&(_=$.samples)!==null&&_!==void 0&&_.length){var le={id:g,frag:P,details:Z,samples:$.samples};A.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(Z&&j){var oe={id:g,frag:P,details:Z,samples:j.samples};A.trigger(M.Events.FRAG_PARSING_USERDATA,oe)}}},s._bufferInitSegment=function(m,_,g,A){var y=this;if(this.state===T.State.PARSING){this.audioOnly=!!_.audio&&!_.video,this.altAudio&&!this.audioOnly&&delete _.audio;var p=_.audio,b=_.video,P=_.audiovideo;if(p){var B=m.audioCodec,V=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),p.metadata.channelCount!==1&&V.indexOf("firefox")===-1&&(B="mp4a.40.5")),V.indexOf("android")!==-1&&p.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),m.audioCodec&&m.audioCodec!==B&&this.log('Swapping manifest audio codec "'+m.audioCodec+'" for "'+B+'"'),p.levelCodec=B,p.id="main",this.log("Init audio buffer, container:"+p.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(m.audioCodec||"")+"/"+p.codec+"]")}b&&(b.levelCodec=m.videoCodec,b.id="main",this.log("Init video buffer, container:"+b.container+", codecs[level/parsed]=["+(m.videoCodec||"")+"/"+b.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(m.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,_),Object.keys(_).forEach(function(W){var j=_[W],$=j.initSegment;$!=null&&$.byteLength&&y.hls.trigger(M.Events.BUFFER_APPENDING,{type:W,data:$,frag:g,part:null,chunkMeta:A,parent:g.type})}),this.tick()}},s.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,I.PlaylistLevelType.MAIN)},s.backtrack=function(m){this.couldBacktrack=!0,this.backtrackFragment=m,this.resetTransmuxer(),this.flushBufferGap(m),this.fragmentTracker.removeFragment(m),this.fragPrevious=null,this.nextLoadPosition=m.start,this.state=T.State.IDLE},s.checkFragmentChanged=function(){var m=this.media,_=null;if(m&&m.readyState>1&&m.seeking===!1){var g=m.currentTime;if(U.BufferHelper.isBuffered(m,g)?_=this.getAppendedFrag(g):U.BufferHelper.isBuffered(m,g+.1)&&(_=this.getAppendedFrag(g+.1)),_){this.backtrackFragment=null;var A=this.fragPlaying,y=_.level;(!A||_.sn!==A.sn||A.level!==y||_.urlId!==A.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:_}),(!A||A.level!==y)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:y}),this.fragPlaying=_)}}},E(a,[{key:"nextLevel",get:function(){var m=this.nextBufferedFrag;return m?m.level:-1}},{key:"currentFrag",get:function(){var m=this.media;return m?this.fragPlaying||this.getAppendedFrag(m.currentTime):null}},{key:"currentProgramDateTime",get:function(){var m=this.media;if(m){var _=m.currentTime,g=this.currentFrag;if(g&&(0,F.isFiniteNumber)(_)&&(0,F.isFiniteNumber)(g.programDateTime)){var A=g.programDateTime+(_-g.start)*1e3;return new Date(A)}}return null}},{key:"currentLevel",get:function(){var m=this.currentFrag;return m?m.level:-1}},{key:"nextBufferedFrag",get:function(){var m=this.currentFrag;return m?this.followingBufferedFrag(m):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),a})(T.default)}),"./src/controller/subtitle-stream-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{SubtitleStreamController:()=>u});var F=h("./src/events.ts"),T=h("./src/utils/buffer-helper.ts"),N=h("./src/controller/fragment-finders.ts"),M=h("./src/utils/discontinuities.ts"),U=h("./src/controller/level-helper.ts"),w=h("./src/controller/fragment-tracker.ts"),I=h("./src/controller/base-stream-controller.ts"),k=h("./src/types/loader.ts"),x=h("./src/types/level.ts");function D(c,d){for(var o=0;o<d.length;o++){var a=d[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(c,a.key,a)}}function R(c,d,o){return d&&D(c.prototype,d),Object.defineProperty(c,"prototype",{writable:!1}),c}function O(c,d){c.prototype=Object.create(d.prototype),c.prototype.constructor=c,C(c,d)}function C(c,d){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},C(c,d)}var E=500,u=(function(c){O(d,c);function d(a,s){var v;return v=c.call(this,a,s,"[subtitle-stream-controller]")||this,v.levels=[],v.currentTrackId=-1,v.tracksBuffered=[],v.mainDetails=null,v._registerListeners(),v}var o=d.prototype;return o.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},o._registerListeners=function(){var s=this.hls;s.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.on(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.on(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.on(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(F.Events.ERROR,this.onError,this),s.on(F.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.on(F.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.on(F.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.on(F.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.on(F.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o._unregisterListeners=function(){var s=this.hls;s.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.off(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.off(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.off(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(F.Events.ERROR,this.onError,this),s.off(F.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.off(F.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.off(F.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.off(F.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.off(F.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o.startLoad=function(s){this.stopLoad(),this.state=I.State.IDLE,this.setInterval(E),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=s,this.tick()},o.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},o.onLevelLoaded=function(s,v){this.mainDetails=v.details},o.onSubtitleFragProcessed=function(s,v){var m=v.frag,_=v.success;if(this.fragPrevious=m,this.state=I.State.IDLE,!!_){var g=this.tracksBuffered[this.currentTrackId];if(g){for(var A,y=m.start,p=0;p<g.length;p++)if(y>=g[p].start&&y<=g[p].end){A=g[p];break}var b=m.start+m.duration;A?A.end=b:(A={start:y,end:b},g.push(A)),this.fragmentTracker.fragBuffered(m)}}},o.onBufferFlushing=function(s,v){var m=v.startOffset,_=v.endOffset;if(m===0&&_!==Number.POSITIVE_INFINITY){var g=this.currentTrackId,A=this.levels;if(!A.length||!A[g]||!A[g].details)return;var y=A[g].details,p=y.targetduration,b=_-p;if(b<=0)return;v.endOffsetSubtitles=Math.max(0,b),this.tracksBuffered.forEach(function(P){for(var B=0;B<P.length;){if(P[B].end<=b){P.shift();continue}else if(P[B].start<b)P[B].start=b;else break;B++}}),this.fragmentTracker.removeFragmentsInRange(m,b,k.PlaylistLevelType.SUBTITLE)}},o.onFragBuffered=function(s,v){if(!this.loadedmetadata&&v.frag.type===k.PlaylistLevelType.MAIN){var m;(m=this.media)!==null&&m!==void 0&&m.buffered.length&&(this.loadedmetadata=!0)}},o.onError=function(s,v){var m,_=v.frag;!_||_.type!==k.PlaylistLevelType.SUBTITLE||((m=this.fragCurrent)!==null&&m!==void 0&&m.loader&&this.fragCurrent.loader.abort(),this.state=I.State.IDLE)},o.onSubtitleTracksUpdated=function(s,v){var m=this,_=v.subtitleTracks;this.tracksBuffered=[],this.levels=_.map(function(g){return new x.Level(g)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(g){m.tracksBuffered[g.id]=[]}),this.mediaBuffer=null},o.onSubtitleTrackSwitch=function(s,v){if(this.currentTrackId=v.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var m=this.levels[this.currentTrackId];m!=null&&m.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,m&&this.setInterval(E)},o.onSubtitleTrackLoaded=function(s,v){var m,_=v.details,g=v.id,A=this.currentTrackId,y=this.levels;if(y.length){var p=y[A];if(!(g>=y.length||g!==A||!p)){this.mediaBuffer=this.mediaBufferTimeRanges;var b=0;if(_.live||(m=p.details)!==null&&m!==void 0&&m.live){var P=this.mainDetails;if(_.deltaUpdateFailed||!P)return;var B=P.fragments[0];p.details?(b=this.alignPlaylists(_,p.details),b===0&&B&&(b=B.start,(0,U.addSliding)(_,b))):_.hasProgramDateTime&&P.hasProgramDateTime?((0,M.alignMediaPlaylistByPDT)(_,P),b=_.fragments[0].start):B&&(b=B.start,(0,U.addSliding)(_,b))}if(p.details=_,this.levelLastLoaded=g,!this.startFragRequested&&(this.mainDetails||!_.live)&&this.setStartPosition(p.details,b),this.tick(),_.live&&!this.fragCurrent&&this.media&&this.state===I.State.IDLE){var V=(0,N.findFragmentByPTS)(null,_.fragments,this.media.currentTime,0);V||(this.warn("Subtitle playlist not aligned with playback"),p.details=void 0)}}}},o._handleFragmentLoadComplete=function(s){var v=s.frag,m=s.payload,_=v.decryptdata,g=this.hls;if(!this.fragContextChanged(v)&&m&&m.byteLength>0&&_&&_.key&&_.iv&&_.method==="AES-128"){var A=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(m),_.key.buffer,_.iv.buffer).then(function(y){var p=performance.now();g.trigger(F.Events.FRAG_DECRYPTED,{frag:v,payload:y,stats:{tstart:A,tdecrypt:p}})})}},o.doTick=function(){if(!this.media){this.state=I.State.IDLE;return}if(this.state===I.State.IDLE){var s=this.currentTrackId,v=this.levels;if(!v.length||!v[s]||!v[s].details)return;var m=v[s].details,_=m.targetduration,g=this.config,A=this.getLoadPosition(),y=T.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],A-_,g.maxBufferHole),p=y.end,b=y.len,P=this.getFwdBufferInfo(this.media,k.PlaylistLevelType.MAIN),B=this.getMaxBufferLength(P?.len)+_;if(b>B)return;console.assert(m,"Subtitle track details are defined on idle subtitle stream controller tick");var V=m.fragments,W=V.length,j=m.edge,$,Q=this.fragPrevious;if(p<j){var Z=g.maxFragLookUpTolerance;$=(0,N.findFragmentByPTS)(Q,V,Math.max(V[0].start,p),Z),!$&&Q&&Q.start<V[0].start&&($=V[0])}else $=V[W-1];if($=this.mapToInitFragWhenRequired($),!$||this.fragmentTracker.getState($)!==w.FragmentState.NOT_LOADED)return;$.encrypted?this.loadKey($,m):this.loadFragment($,m,p)}},o.getMaxBufferLength=function(s){var v=c.prototype.getMaxBufferLength.call(this);return s?Math.max(v,s):v},o.loadFragment=function(s,v,m){this.fragCurrent=s,s.sn==="initSegment"?this._loadInitSegment(s):(this.startFragRequested=!0,c.prototype.loadFragment.call(this,s,v,m))},R(d,[{key:"mediaBufferTimeRanges",get:function(){return new l(this.tracksBuffered[this.currentTrackId]||[])}}]),d})(I.default),l=function(d){this.buffered=void 0;var o=function(s,v,m){if(v=v>>>0,v>m-1)throw new DOMException("Failed to execute '"+s+"' on 'TimeRanges': The index provided ("+v+") is greater than the maximum bound ("+m+")");return d[v][s]};this.buffered={get length(){return d.length},end:function(s){return o("end",s,d.length)},start:function(s){return o("start",s,d.length)}}}}),"./src/controller/subtitle-track-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>R});var F=h("./src/events.ts"),T=h("./src/utils/texttrack-utils.ts"),N=h("./src/controller/base-playlist-controller.ts"),M=h("./src/types/loader.ts");function U(O,C){for(var E=0;E<C.length;E++){var u=C[E];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,E){return C&&U(O.prototype,C),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){O.prototype=Object.create(C.prototype),O.prototype.constructor=O,k(O,C)}function k(O,C){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,l){return u.__proto__=l,u},k(O,C)}var x=(function(O){I(C,O);function C(u){var l;return l=O.call(this,u,"[subtitle-track-controller]")||this,l.media=null,l.tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.selectDefaultTrack=!0,l.queuedDefaultTrack=-1,l.trackChangeListener=function(){return l.onTextTracksChanged()},l.asyncPollTrackChange=function(){return l.pollTrackChange(0)},l.useTextTrackPolling=!1,l.subtitlePollingInterval=-1,l._subtitleDisplay=!0,l.registerListeners(),l}var E=C.prototype;return E.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,O.prototype.destroy.call(this)},E.registerListeners=function(){var l=this.hls;l.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(F.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(F.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(F.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.on(F.Events.ERROR,this.onError,this)},E.unregisterListeners=function(){var l=this.hls;l.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(F.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(F.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(F.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(F.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.off(F.Events.ERROR,this.onError,this)},E.onMediaAttached=function(l,c){this.media=c.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},E.pollTrackChange=function(l){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,l)},E.onMediaDetaching=function(){if(this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var l=D(this.media.textTracks);l.forEach(function(c){(0,T.clearCurrentCues)(c)}),this.subtitleTrack=-1,this.media=null}},E.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},E.onManifestParsed=function(l,c){this.tracks=c.subtitleTracks},E.onSubtitleTrackLoaded=function(l,c){var d=c.id,o=c.details,a=this.trackId,s=this.tracksInGroup[a];if(!s){this.warn("Invalid subtitle track id "+d);return}var v=s.details;s.details=c.details,this.log("subtitle track "+d+" loaded ["+o.startSN+"-"+o.endSN+"]"),d===this.trackId&&(this.retryCount=0,this.playlistLoaded(d,c,v))},E.onLevelLoading=function(l,c){this.switchLevel(c.level)},E.onLevelSwitching=function(l,c){this.switchLevel(c.level)},E.switchLevel=function(l){var c=this.hls.levels[l];if(c!=null&&c.textGroupIds){var d=c.textGroupIds[c.urlId];if(this.groupId!==d){var o=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,a=this.tracks.filter(function(m){return!d||m.groupId===d});this.tracksInGroup=a;var s=this.findTrackId(o?.name)||this.findTrackId();this.groupId=d;var v={subtitleTracks:a};this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+d+'" group-id'),this.hls.trigger(F.Events.SUBTITLE_TRACKS_UPDATED,v),s!==-1&&this.setSubtitleTrack(s,o)}}},E.findTrackId=function(l){for(var c=this.tracksInGroup,d=0;d<c.length;d++){var o=c[d];if((!this.selectDefaultTrack||o.default)&&(!l||l===o.name))return o.id}return-1},E.onError=function(l,c){O.prototype.onError.call(this,l,c),!(c.fatal||!c.context)&&c.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&c.context.id===this.trackId&&c.context.groupId===this.groupId&&this.retryLoadingOrFail(c)},E.loadPlaylist=function(l){var c=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(c)){var d=c.id,o=c.groupId,a=c.url;if(l)try{a=l.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+d),this.hls.trigger(F.Events.SUBTITLE_TRACK_LOADING,{url:a,id:d,groupId:o,deliveryDirectives:l||null})}},E.toggleTrackModes=function(l){var c=this,d=this.media,o=this.trackId;if(d){var a=D(d.textTracks),s=a.filter(function(_){return _.groupId===c.groupId});if(l===-1)[].slice.call(a).forEach(function(_){_.mode="disabled"});else{var v=s[o];v&&(v.mode="disabled")}var m=s[l];m&&(m.mode=this.subtitleDisplay?"showing":"hidden")}},E.setSubtitleTrack=function(l,c){var d,o=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=l;return}if(this.trackId!==l&&this.toggleTrackModes(l),!(this.trackId===l&&(l===-1||(d=o[l])!==null&&d!==void 0&&d.details)||l<-1||l>=o.length)){this.clearTimer();var a=o[l];if(this.log("Switching to subtitle track "+l),this.trackId=l,a){var s=a.id,v=a.groupId,m=v===void 0?"":v,_=a.name,g=a.type,A=a.url;this.hls.trigger(F.Events.SUBTITLE_TRACK_SWITCH,{id:s,groupId:m,name:_,type:g,url:A});var y=this.switchParams(a.url,c?.details);this.loadPlaylist(y)}else this.hls.trigger(F.Events.SUBTITLE_TRACK_SWITCH,{id:l})}},E.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var l=-1,c=D(this.media.textTracks),d=0;d<c.length;d++)if(c[d].mode==="hidden")l=d;else if(c[d].mode==="showing"){l=d;break}this.subtitleTrack!==l&&(this.subtitleTrack=l)}},w(C,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(l){this._subtitleDisplay=l,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1;var c=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(l,c)}}]),C})(N.default);function D(O){for(var C=[],E=0;E<O.length;E++){var u=O[E];u.kind==="subtitles"&&u.label&&C.push(O[E])}return C}const R=x}),"./src/controller/timeline-controller.ts":((S,L,h)=>{h.r(L),h.d(L,{TimelineController:()=>R});var F=h("./src/polyfills/number.ts"),T=h("./src/events.ts"),N=h("./src/utils/cea-608-parser.ts"),M=h("./src/utils/output-filter.ts"),U=h("./src/utils/webvtt-parser.ts"),w=h("./src/utils/texttrack-utils.ts"),I=h("./src/utils/imsc1-ttml-parser.ts"),k=h("./src/utils/mp4-tools.ts"),x=h("./src/types/loader.ts"),D=h("./src/utils/logger.ts"),R=(function(){function u(c){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=E(),this.captionsProperties=void 0,this.hls=c,this.config=c.config,this.Cues=c.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var d=new M.default(this,"textTrack1"),o=new M.default(this,"textTrack2"),a=new M.default(this,"textTrack3"),s=new M.default(this,"textTrack4");this.cea608Parser1=new N.default(1,d,o),this.cea608Parser2=new N.default(3,a,s)}c.on(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),c.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(T.Events.MANIFEST_LOADED,this.onManifestLoaded,this),c.on(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),c.on(T.Events.FRAG_LOADING,this.onFragLoading,this),c.on(T.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(T.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),c.on(T.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),c.on(T.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.on(T.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),c.on(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var l=u.prototype;return l.destroy=function(){var d=this.hls;d.off(T.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(T.Events.MANIFEST_LOADED,this.onManifestLoaded,this),d.off(T.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),d.off(T.Events.FRAG_LOADING,this.onFragLoading,this),d.off(T.Events.FRAG_LOADED,this.onFragLoaded,this),d.off(T.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),d.off(T.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),d.off(T.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),d.off(T.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),d.off(T.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},l.addCues=function(d,o,a,s,v){for(var m=!1,_=v.length;_--;){var g=v[_],A=C(g[0],g[1],o,a);if(A>=0&&(g[0]=Math.min(g[0],o),g[1]=Math.max(g[1],a),m=!0,A/(a-o)>.5))return}if(m||v.push([o,a]),this.config.renderTextTracksNatively){var y=this.captionsTracks[d];this.Cues.newCue(y,o,a,s)}else{var p=this.Cues.newCue(null,o,a,s);this.hls.trigger(T.Events.CUES_PARSED,{type:"captions",cues:p,track:d})}},l.onInitPtsFound=function(d,o){var a=this,s=o.frag,v=o.id,m=o.initPTS,_=o.timescale,g=this.unparsedVttFrags;v==="main"&&(this.initPTS[s.cc]=m,this.timescale[s.cc]=_),g.length&&(this.unparsedVttFrags=[],g.forEach(function(A){a.onFragLoaded(T.Events.FRAG_LOADED,A)}))},l.getExistingTrack=function(d){var o=this.media;if(o)for(var a=0;a<o.textTracks.length;a++){var s=o.textTracks[a];if(s[d])return s}return null},l.createCaptionsTrack=function(d){this.config.renderTextTracksNatively?this.createNativeTrack(d):this.createNonNativeTrack(d)},l.createNativeTrack=function(d){if(!this.captionsTracks[d]){var o=this.captionsProperties,a=this.captionsTracks,s=this.media,v=o[d],m=v.label,_=v.languageCode,g=this.getExistingTrack(d);if(g)a[d]=g,(0,w.clearCurrentCues)(a[d]),(0,w.sendAddTrackEvent)(a[d],s);else{var A=this.createTextTrack("captions",m,_);A&&(A[d]=!0,a[d]=A)}}},l.createNonNativeTrack=function(d){if(!this.nonNativeCaptionsTracks[d]){var o=this.captionsProperties[d];if(o){var a=o.label,s={_id:d,label:a,kind:"captions",default:o.media?!!o.media.default:!1,closedCaptions:o.media};this.nonNativeCaptionsTracks[d]=s,this.hls.trigger(T.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},l.createTextTrack=function(d,o,a){var s=this.media;if(s)return s.addTextTrack(d,o,a)},l.onMediaAttaching=function(d,o){this.media=o.media,this._cleanTracks()},l.onMediaDetaching=function(){var d=this.captionsTracks;Object.keys(d).forEach(function(o){(0,w.clearCurrentCues)(d[o]),delete d[o]}),this.nonNativeCaptionsTracks={}},l.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=E(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},l._cleanTracks=function(){var d=this.media;if(d){var o=d.textTracks;if(o)for(var a=0;a<o.length;a++)(0,w.clearCurrentCues)(o[a])}},l.onSubtitleTracksUpdated=function(d,o){var a=this;this.textTracks=[];var s=o.subtitleTracks||[],v=s.some(function(A){return A.textCodec===I.IMSC1_CODEC});if(this.config.enableWebVTT||v&&this.config.enableIMSC1){var m=this.tracks&&s&&this.tracks.length===s.length;if(this.tracks=s||[],this.config.renderTextTracksNatively){var _=this.media?this.media.textTracks:[];this.tracks.forEach(function(A,y){var p;if(y<_.length){for(var b=null,P=0;P<_.length;P++)if(O(_[P],A)){b=_[P];break}b&&(p=b)}if(p)(0,w.clearCurrentCues)(p);else{var B=a._captionsOrSubtitlesFromCharacteristics(A);p=a.createTextTrack(B,A.name,A.lang),p&&(p.mode="disabled")}p&&(p.groupId=A.groupId,a.textTracks.push(p))})}else if(!m&&this.tracks&&this.tracks.length){var g=this.tracks.map(function(A){return{label:A.name,kind:A.type.toLowerCase(),default:A.default,subtitleTrack:A}});this.hls.trigger(T.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:g})}}},l._captionsOrSubtitlesFromCharacteristics=function(d){var o;if((o=d.attrs)!==null&&o!==void 0&&o.CHARACTERISTICS){var a=/transcribes-spoken-dialog/gi.test(d.attrs.CHARACTERISTICS),s=/describes-music-and-sound/gi.test(d.attrs.CHARACTERISTICS);if(a&&s)return"captions"}return"subtitles"},l.onManifestLoaded=function(d,o){var a=this;this.config.enableCEA708Captions&&o.captions&&o.captions.forEach(function(s){var v=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(v){var m="textTrack"+v[1],_=a.captionsProperties[m];_&&(_.label=s.name,s.lang&&(_.languageCode=s.lang),_.media=s)}})},l.closedCaptionsForLevel=function(d){var o=this.hls.levels[d.level];return o?.attrs["CLOSED-CAPTIONS"]},l.onFragLoading=function(d,o){var a=this.cea608Parser1,s=this.cea608Parser2,v=this.lastSn,m=this.lastPartIndex;if(!(!this.enabled||!(a&&s))&&o.frag.type===x.PlaylistLevelType.MAIN){var _,g,A=o.frag.sn,y=(_=o==null||(g=o.part)===null||g===void 0?void 0:g.index)!=null?_:-1;A===v+1||A===v&&y===m+1||(a.reset(),s.reset()),this.lastSn=A,this.lastPartIndex=y}},l.onFragLoaded=function(d,o){var a=o.frag,s=o.payload,v=this.initPTS,m=this.unparsedVttFrags;if(a.type===x.PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!(0,F.isFiniteNumber)(v[a.cc])){m.push(o),v.length&&this.hls.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Missing initial subtitle PTS")});return}var _=a.decryptdata,g="stats"in o;if(_==null||_.key==null||_.method!=="AES-128"||g){var A=this.tracks[a.level],y=this.vttCCs;y[a.cc]||(y[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),A&&A.textCodec===I.IMSC1_CODEC?this._parseIMSC1(a,s):this._parseVTTs(a,s,y)}}else this.hls.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})},l._parseIMSC1=function(d,o){var a=this,s=this.hls;(0,I.parseIMSC1)(o,this.initPTS[d.cc],this.timescale[d.cc],function(v){a._appendCues(v,d.level),s.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(v){D.logger.log("Failed to parse IMSC1: "+v),s.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:v})})},l._parseVTTs=function(d,o,a){var s,v=this,m=this.hls,_=(s=d.initSegment)!==null&&s!==void 0&&s.data?(0,k.appendUint8Array)(d.initSegment.data,new Uint8Array(o)):o;(0,U.parseWebVTT)(_,this.initPTS[d.cc],this.timescale[d.cc],a,d.cc,d.start,function(g){v._appendCues(g,d.level),m.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(g){v._fallbackToIMSC1(d,o),D.logger.log("Failed to parse VTT cue: "+g),m.trigger(T.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:g})})},l._fallbackToIMSC1=function(d,o){var a=this,s=this.tracks[d.level];s.textCodec||(0,I.parseIMSC1)(o,this.initPTS[d.cc],this.timescale[d.cc],function(){s.textCodec=I.IMSC1_CODEC,a._parseIMSC1(d,o)},function(){s.textCodec="wvtt"})},l._appendCues=function(d,o){var a=this.hls;if(this.config.renderTextTracksNatively){var s=this.textTracks[o];if(!s||s.mode==="disabled")return;d.forEach(function(_){return(0,w.addCueToTrack)(s,_)})}else{var v=this.tracks[o];if(!v)return;var m=v.default?"default":"subtitles"+o;a.trigger(T.Events.CUES_PARSED,{type:"subtitles",cues:d,track:m})}},l.onFragDecrypted=function(d,o){var a=o.frag;if(a.type===x.PlaylistLevelType.SUBTITLE){if(!(0,F.isFiniteNumber)(this.initPTS[a.cc])){this.unparsedVttFrags.push(o);return}this.onFragLoaded(T.Events.FRAG_LOADED,o)}},l.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},l.onFragParsingUserdata=function(d,o){var a=this.cea608Parser1,s=this.cea608Parser2;if(!(!this.enabled||!(a&&s))){var v=o.frag,m=o.samples;if(!(v.type===x.PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(v)==="NONE"))for(var _=0;_<m.length;_++){var g=m[_].bytes;if(g){var A=this.extractCea608Data(g);a.addData(m[_].pts,A[0]),s.addData(m[_].pts,A[1])}}}},l.onBufferFlushing=function(d,o){var a=o.startOffset,s=o.endOffset,v=o.endOffsetSubtitles,m=o.type,_=this.media;if(!(!_||_.currentTime<s)){if(!m||m==="video"){var g=this.captionsTracks;Object.keys(g).forEach(function(y){return(0,w.removeCuesInRange)(g[y],a,s)})}if(this.config.renderTextTracksNatively&&a===0&&v!==void 0){var A=this.textTracks;Object.keys(A).forEach(function(y){return(0,w.removeCuesInRange)(A[y],a,v)})}}},l.extractCea608Data=function(d){for(var o=[[],[]],a=d[0]&31,s=2,v=0;v<a;v++){var m=d[s++],_=127&d[s++],g=127&d[s++];if(!(_===0&&g===0)){var A=(4&m)!==0;if(A){var y=3&m;(y===0||y===1)&&(o[y].push(_),o[y].push(g))}}}return o},u})();function O(u,l){return u&&u.label===l.name&&!(u.textTrack1||u.textTrack2)}function C(u,l,c,d){return Math.min(l,d)-Math.max(u,c)}function E(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}}),"./src/crypt/aes-crypto.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});var F=(function(){function T(M,U){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=U}var N=T.prototype;return N.decrypt=function(U,w){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},w,U)},T})()}),"./src/crypt/aes-decryptor.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>N,removePadding:()=>T});var F=h("./src/utils/typed-array.ts");function T(M){var U=M.byteLength,w=U&&new DataView(M.buffer).getUint8(U-1);return w?(0,F.sliceUint8)(M,0,U-w):M}var N=(function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var U=M.prototype;return U.uint8ArrayToUint32Array_=function(I){for(var k=new DataView(I),x=new Uint32Array(4),D=0;D<4;D++)x[D]=k.getUint32(D*4);return x},U.initTable=function(){var I=this.sBox,k=this.invSBox,x=this.subMix,D=x[0],R=x[1],O=x[2],C=x[3],E=this.invSubMix,u=E[0],l=E[1],c=E[2],d=E[3],o=new Uint32Array(256),a=0,s=0,v=0;for(v=0;v<256;v++)v<128?o[v]=v<<1:o[v]=v<<1^283;for(v=0;v<256;v++){var m=s^s<<1^s<<2^s<<3^s<<4;m=m>>>8^m&255^99,I[a]=m,k[m]=a;var _=o[a],g=o[_],A=o[g],y=o[m]*257^m*16843008;D[a]=y<<24|y>>>8,R[a]=y<<16|y>>>16,O[a]=y<<8|y>>>24,C[a]=y,y=A*16843009^g*65537^_*257^a*16843008,u[m]=y<<24|y>>>8,l[m]=y<<16|y>>>16,c[m]=y<<8|y>>>24,d[m]=y,a?(a=_^o[o[o[A^_]]],s^=o[o[s]]):a=s=1}},U.expandKey=function(I){for(var k=this.uint8ArrayToUint32Array_(I),x=!0,D=0;D<k.length&&x;)x=k[D]===this.key[D],D++;if(!x){this.key=k;var R=this.keySize=k.length;if(R!==4&&R!==6&&R!==8)throw new Error("Invalid aes key size="+R);var O=this.ksRows=(R+6+1)*4,C,E,u=this.keySchedule=new Uint32Array(O),l=this.invKeySchedule=new Uint32Array(O),c=this.sBox,d=this.rcon,o=this.invSubMix,a=o[0],s=o[1],v=o[2],m=o[3],_,g;for(C=0;C<O;C++){if(C<R){_=u[C]=k[C];continue}g=_,C%R===0?(g=g<<8|g>>>24,g=c[g>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[g&255],g^=d[C/R|0]<<24):R>6&&C%R===4&&(g=c[g>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[g&255]),u[C]=_=(u[C-R]^g)>>>0}for(E=0;E<O;E++)C=O-E,E&3?g=u[C]:g=u[C-4],E<4||C<=4?l[E]=g:l[E]=a[c[g>>>24]]^s[c[g>>>16&255]]^v[c[g>>>8&255]]^m[c[g&255]],l[E]=l[E]>>>0}},U.networkToHostOrderSwap=function(I){return I<<24|(I&65280)<<8|(I&16711680)>>8|I>>>24},U.decrypt=function(I,k,x){for(var D=this.keySize+6,R=this.invKeySchedule,O=this.invSBox,C=this.invSubMix,E=C[0],u=C[1],l=C[2],c=C[3],d=this.uint8ArrayToUint32Array_(x),o=d[0],a=d[1],s=d[2],v=d[3],m=new Int32Array(I),_=new Int32Array(m.length),g,A,y,p,b,P,B,V,W,j,$,Q,Z,ee,se=this.networkToHostOrderSwap;k<m.length;){for(W=se(m[k]),j=se(m[k+1]),$=se(m[k+2]),Q=se(m[k+3]),b=W^R[0],P=Q^R[1],B=$^R[2],V=j^R[3],Z=4,ee=1;ee<D;ee++)g=E[b>>>24]^u[P>>16&255]^l[B>>8&255]^c[V&255]^R[Z],A=E[P>>>24]^u[B>>16&255]^l[V>>8&255]^c[b&255]^R[Z+1],y=E[B>>>24]^u[V>>16&255]^l[b>>8&255]^c[P&255]^R[Z+2],p=E[V>>>24]^u[b>>16&255]^l[P>>8&255]^c[B&255]^R[Z+3],b=g,P=A,B=y,V=p,Z=Z+4;g=O[b>>>24]<<24^O[P>>16&255]<<16^O[B>>8&255]<<8^O[V&255]^R[Z],A=O[P>>>24]<<24^O[B>>16&255]<<16^O[V>>8&255]<<8^O[b&255]^R[Z+1],y=O[B>>>24]<<24^O[V>>16&255]<<16^O[b>>8&255]<<8^O[P&255]^R[Z+2],p=O[V>>>24]<<24^O[b>>16&255]<<16^O[P>>8&255]<<8^O[B&255]^R[Z+3],_[k]=se(g^o),_[k+1]=se(p^a),_[k+2]=se(y^s),_[k+3]=se(A^v),o=W,a=j,s=$,v=Q,k=k+4}return _.buffer},M})()}),"./src/crypt/decrypter.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>k});var F=h("./src/crypt/aes-crypto.ts"),T=h("./src/crypt/fast-aes-key.ts"),N=h("./src/crypt/aes-decryptor.ts"),M=h("./src/utils/logger.ts"),U=h("./src/utils/mp4-tools.ts"),w=h("./src/utils/typed-array.ts"),I=16,k=(function(){function x(R,O,C){var E=C===void 0?{}:C,u=E.removePKCS7Padding,l=u===void 0?!0:u;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=R,this.config=O,this.removePKCS7Padding=l,l)try{var c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var D=x.prototype;return D.destroy=function(){this.observer=null},D.isSync=function(){return this.config.enableSoftwareAES},D.flush=function(){var O=this.currentResult;if(!O){this.reset();return}var C=new Uint8Array(O);return this.reset(),this.removePKCS7Padding?(0,N.removePadding)(C):C},D.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},D.decrypt=function(O,C,E,u){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(O),C,E);var l=this.flush();l&&u(l.buffer)}else this.webCryptoDecrypt(new Uint8Array(O),C,E).then(u)},D.softwareDecrypt=function(O,C,E){var u=this.currentIV,l=this.currentResult,c=this.remainderData;this.logOnce("JS AES decrypt"),c&&(O=(0,U.appendUint8Array)(c,O),this.remainderData=null);var d=this.getValidChunk(O);if(!d.length)return null;u&&(E=u);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new N.default),o.expandKey(C);var a=l;return this.currentResult=o.decrypt(d.buffer,0,E),this.currentIV=(0,w.sliceUint8)(d,-16).buffer,a||null},D.webCryptoDecrypt=function(O,C,E){var u=this,l=this.subtle;return(this.key!==C||!this.fastAesKey)&&(this.key=C,this.fastAesKey=new T.default(l,C)),this.fastAesKey.expandKey().then(function(c){if(!l)return Promise.reject(new Error("web crypto not initialized"));var d=new F.default(l,E);return d.decrypt(O.buffer,c)}).catch(function(c){return u.onWebCryptoError(c,O,C,E)})},D.onWebCryptoError=function(O,C,E,u){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",O),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(C,E,u)},D.getValidChunk=function(O){var C=O,E=O.length-O.length%I;return E!==O.length&&(C=(0,w.sliceUint8)(O,0,E),this.remainderData=(0,w.sliceUint8)(O,E)),C},D.logOnce=function(O){this.logEnabled&&(M.logger.log("[decrypter.ts]: "+O),this.logEnabled=!1)},x})()}),"./src/crypt/fast-aes-key.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});var F=(function(){function T(M,U){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=U}var N=T.prototype;return N.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},T})()}),"./src/demux/aacdemuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>k});var F=h("./src/demux/base-audio-demuxer.ts"),T=h("./src/demux/adts.ts"),N=h("./src/utils/logger.ts"),M=h("./src/demux/id3.ts");function U(x,D){x.prototype=Object.create(D.prototype),x.prototype.constructor=x,w(x,D)}function w(x,D){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(x,D)}var I=(function(x){U(D,x);function D(O,C){var E;return E=x.call(this)||this,E.observer=void 0,E.config=void 0,E.observer=O,E.config=C,E}var R=D.prototype;return R.resetInitSegment=function(C,E,u,l){x.prototype.resetInitSegment.call(this,C,E,u,l),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:E,duration:l,inputTimeScale:9e4,dropped:0}},D.probe=function(C){if(!C)return!1;for(var E=M.getID3Data(C,0)||[],u=E.length,l=C.length;u<l;u++)if(T.probe(C,u))return N.logger.log("ADTS sync word found !"),!0;return!1},R.canParse=function(C,E){return T.canParse(C,E)},R.appendFrame=function(C,E,u){T.initTrackConfig(C,this.observer,E,u,C.manifestCodec);var l=T.appendFrame(C,E,u,this.basePTS,this.frameIndex);if(l&&l.missing===0)return l},D})(F.default);const k=I}),"./src/demux/adts.ts":((S,L,h)=>{h.r(L),h.d(L,{appendFrame:()=>u,canGetFrameLength:()=>k,canParse:()=>D,getAudioConfig:()=>M,getFrameDuration:()=>C,getFullFrameLength:()=>I,getHeaderLength:()=>w,initTrackConfig:()=>O,isHeader:()=>x,isHeaderPattern:()=>U,parseFrameHeader:()=>E,probe:()=>R});var F=h("./src/utils/logger.ts"),T=h("./src/errors.ts"),N=h("./src/events.ts");function M(l,c,d,o){var a,s,v,m,_=navigator.userAgent.toLowerCase(),g=o,A=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((c[d+2]&192)>>>6)+1;var y=(c[d+2]&60)>>>2;if(y>A.length-1){l.trigger(N.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+y});return}return v=(c[d+2]&1)<<2,v|=(c[d+3]&192)>>>6,F.logger.log("manifest codec:"+o+", ADTS type:"+a+", samplingIndex:"+y),/firefox/i.test(_)?y>=6?(a=5,m=new Array(4),s=y-3):(a=2,m=new Array(2),s=y):_.indexOf("android")!==-1?(a=2,m=new Array(2),s=y):(a=5,m=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&y>=6?s=y-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(y>=6&&v===1||/vivaldi/i.test(_))||!o&&v===1)&&(a=2,m=new Array(2)),s=y)),m[0]=a<<3,m[0]|=(y&14)>>1,m[1]|=(y&1)<<7,m[1]|=v<<3,a===5&&(m[1]|=(s&14)>>1,m[2]=(s&1)<<7,m[2]|=8,m[3]=0),{config:m,samplerate:A[y],channelCount:v,codec:"mp4a.40."+a,manifestCodec:g}}function U(l,c){return l[c]===255&&(l[c+1]&246)===240}function w(l,c){return l[c+1]&1?7:9}function I(l,c){return(l[c+3]&3)<<11|l[c+4]<<3|(l[c+5]&224)>>>5}function k(l,c){return c+5<l.length}function x(l,c){return c+1<l.length&&U(l,c)}function D(l,c){return k(l,c)&&U(l,c)&&I(l,c)<=l.length-c}function R(l,c){if(x(l,c)){var d=w(l,c);if(c+d>=l.length)return!1;var o=I(l,c);if(o<=d)return!1;var a=c+o;return a===l.length||x(l,a)}return!1}function O(l,c,d,o,a){if(!l.samplerate){var s=M(c,d,o,a);if(!s)return;l.config=s.config,l.samplerate=s.samplerate,l.channelCount=s.channelCount,l.codec=s.codec,l.manifestCodec=s.manifestCodec,F.logger.log("parsed codec:"+l.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function C(l){return 9216e4/l}function E(l,c){var d=w(l,c);if(c+d<=l.length){var o=I(l,c)-d;if(o>0)return{headerLength:d,frameLength:o}}}function u(l,c,d,o,a){var s=C(l.samplerate),v=o+a*s,m=E(c,d),_;if(m){var g=m.frameLength,A=m.headerLength,y=A+g,p=Math.max(0,d+y-c.length);p?(_=new Uint8Array(y-A),_.set(c.subarray(d+A,c.length),0)):_=c.subarray(d+A,d+y);var b={unit:_,pts:v};return p||l.samples.push(b),{sample:b,length:y,missing:p}}var P=c.length-d;_=new Uint8Array(P),_.set(c.subarray(d,c.length),0);var B={unit:_,pts:v};return{sample:B,length:P,missing:-1}}}),"./src/demux/base-audio-demuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>x,initPTSFn:()=>k});var F=h("./src/polyfills/number.ts"),T=h("./src/demux/id3.ts"),N=h("./src/types/demuxer.ts"),M=h("./src/demux/dummy-demuxed-track.ts"),U=h("./src/utils/mp4-tools.ts"),w=h("./src/utils/typed-array.ts"),I=(function(){function D(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var R=D.prototype;return R.resetInitSegment=function(C,E,u,l){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},R.resetTimeStamp=function(C){this.initPTS=C,this.resetContiguity()},R.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},R.canParse=function(C,E){return!1},R.appendFrame=function(C,E,u){},R.demux=function(C,E){this.cachedData&&(C=(0,U.appendUint8Array)(this.cachedData,C),this.cachedData=null);var u=T.getID3Data(C,0),l=u?u.length:0,c,d=this._audioTrack,o=this._id3Track,a=u?T.getTimeStamp(u):void 0,s=C.length;for((this.basePTS===null||this.frameIndex===0&&(0,F.isFiniteNumber)(a))&&(this.basePTS=k(a,E,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),u&&u.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:N.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});l<s;){if(this.canParse(C,l)){var v=this.appendFrame(d,C,l);v?(this.frameIndex++,this.lastPTS=v.sample.pts,l+=v.length,c=l):l=s}else T.canParse(C,l)?(u=T.getID3Data(C,l),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:N.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),l+=u.length,c=l):l++;if(l===s&&c!==s){var m=(0,w.sliceUint8)(C,c);this.cachedData?this.cachedData=(0,U.appendUint8Array)(this.cachedData,m):this.cachedData=m}}return{audioTrack:d,videoTrack:(0,M.dummyTrack)(),id3Track:o,textTrack:(0,M.dummyTrack)()}},R.demuxSampleAes=function(C,E,u){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},R.flush=function(C){var E=this.cachedData;return E&&(this.cachedData=null,this.demux(E,0)),{audioTrack:this._audioTrack,videoTrack:(0,M.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,M.dummyTrack)()}},R.destroy=function(){},D})(),k=function(R,O,C){return(0,F.isFiniteNumber)(R)?R*90:O*9e4+(C||0)};const x=I}),"./src/demux/chunk-cache.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});var F=(function(){function N(){this.chunks=[],this.dataLength=0}var M=N.prototype;return M.push=function(w){this.chunks.push(w),this.dataLength+=w.length},M.flush=function(){var w=this.chunks,I=this.dataLength,k;if(w.length)w.length===1?k=w[0]:k=T(w,I);else return new Uint8Array(0);return this.reset(),k},M.reset=function(){this.chunks.length=0,this.dataLength=0},N})();function T(N,M){for(var U=new Uint8Array(M),w=0,I=0;I<N.length;I++){var k=N[I];U.set(k,w),w+=k.length}return U}}),"./src/demux/dummy-demuxed-track.ts":((S,L,h)=>{h.r(L),h.d(L,{dummyTrack:()=>F});function F(T,N){return T===void 0&&(T=""),N===void 0&&(N=9e4),{type:T,id:-1,pid:-1,inputTimeScale:N,sequenceNumber:-1,samples:[],dropped:0}}}),"./src/demux/exp-golomb.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>N});var F=h("./src/utils/logger.ts"),T=(function(){function M(w){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=w,this.bytesAvailable=w.byteLength,this.word=0,this.bitsAvailable=0}var U=M.prototype;return U.loadWord=function(){var I=this.data,k=this.bytesAvailable,x=I.byteLength-k,D=new Uint8Array(4),R=Math.min(4,k);if(R===0)throw new Error("no bytes available");D.set(I.subarray(x,x+R)),this.word=new DataView(D.buffer).getUint32(0),this.bitsAvailable=R*8,this.bytesAvailable-=R},U.skipBits=function(I){var k;this.bitsAvailable>I?(this.word<<=I,this.bitsAvailable-=I):(I-=this.bitsAvailable,k=I>>3,I-=k>>3,this.bytesAvailable-=k,this.loadWord(),this.word<<=I,this.bitsAvailable-=I)},U.readBits=function(I){var k=Math.min(this.bitsAvailable,I),x=this.word>>>32-k;return I>32&&F.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=k,this.bitsAvailable>0?this.word<<=k:this.bytesAvailable>0&&this.loadWord(),k=I-k,k>0&&this.bitsAvailable?x<<k|this.readBits(k):x},U.skipLZ=function(){var I;for(I=0;I<this.bitsAvailable;++I)if((this.word&2147483648>>>I)!==0)return this.word<<=I,this.bitsAvailable-=I,I;return this.loadWord(),I+this.skipLZ()},U.skipUEG=function(){this.skipBits(1+this.skipLZ())},U.skipEG=function(){this.skipBits(1+this.skipLZ())},U.readUEG=function(){var I=this.skipLZ();return this.readBits(I+1)-1},U.readEG=function(){var I=this.readUEG();return 1&I?1+I>>>1:-1*(I>>>1)},U.readBoolean=function(){return this.readBits(1)===1},U.readUByte=function(){return this.readBits(8)},U.readUShort=function(){return this.readBits(16)},U.readUInt=function(){return this.readBits(32)},U.skipScalingList=function(I){for(var k=8,x=8,D,R=0;R<I;R++)x!==0&&(D=this.readEG(),x=(k+D+256)%256),k=x===0?k:x},U.readSPS=function(){var I=0,k=0,x=0,D=0,R,O,C,E=this.readUByte.bind(this),u=this.readBits.bind(this),l=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),o=this.skipEG.bind(this),a=this.skipUEG.bind(this),s=this.skipScalingList.bind(this);E();var v=E();if(u(5),d(3),E(),a(),v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128){var m=l();if(m===3&&d(1),a(),a(),d(1),c())for(O=m!==3?8:12,C=0;C<O;C++)c()&&(C<6?s(16):s(64))}a();var _=l();if(_===0)l();else if(_===1)for(d(1),o(),o(),R=l(),C=0;C<R;C++)o();a(),d(1);var g=l(),A=l(),y=u(1);y===0&&d(1),d(1),c()&&(I=l(),k=l(),x=l(),D=l());var p=[1,1];if(c()&&c()){var b=E();switch(b){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:{p=[E()<<8|E(),E()<<8|E()];break}}}return{width:Math.ceil((g+1)*16-I*2-k*2),height:(2-y)*(A+1)*16-(y?2:4)*(x+D),pixelRatio:p}},U.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},M})();const N=T}),"./src/demux/id3.ts":((S,L,h)=>{h.r(L),h.d(L,{canParse:()=>U,decodeFrame:()=>D,getID3Data:()=>N,getID3Frames:()=>x,getTimeStamp:()=>w,isFooter:()=>T,isHeader:()=>F,isTimeStampFrame:()=>I,testables:()=>l,utf8ArrayToStr:()=>u});var F=function(a,s){return s+10<=a.length&&a[s]===73&&a[s+1]===68&&a[s+2]===51&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},T=function(a,s){return s+10<=a.length&&a[s]===51&&a[s+1]===68&&a[s+2]===73&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},N=function(a,s){for(var v=s,m=0;F(a,s);){m+=10;var _=M(a,s+6);m+=_,T(a,s+10)&&(m+=10),s+=m}if(m>0)return a.subarray(v,v+m)},M=function(a,s){var v=0;return v=(a[s]&127)<<21,v|=(a[s+1]&127)<<14,v|=(a[s+2]&127)<<7,v|=a[s+3]&127,v},U=function(a,s){return F(a,s)&&M(a,s+6)+10<=a.length-s},w=function(a){for(var s=x(a),v=0;v<s.length;v++){var m=s[v];if(I(m))return E(m)}},I=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},k=function(a){var s=String.fromCharCode(a[0],a[1],a[2],a[3]),v=M(a,4),m=10;return{type:s,size:v,data:a.subarray(m,m+v)}},x=function(a){for(var s=0,v=[];F(a,s);){var m=M(a,s+6);s+=10;for(var _=s+m;s+8<_;){var g=k(a.subarray(s)),A=D(g);A&&v.push(A),s+=g.size+10}T(a,s)&&(s+=10)}return v},D=function(a){return a.type==="PRIV"?R(a):a.type[0]==="W"?C(a):O(a)},R=function(a){if(!(a.size<2)){var s=u(a.data,!0),v=new Uint8Array(a.data.subarray(s.length+1));return{key:a.type,info:s,data:v.buffer}}},O=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var s=1,v=u(a.data.subarray(s),!0);s+=v.length+1;var m=u(a.data.subarray(s));return{key:a.type,info:v,data:m}}var _=u(a.data.subarray(1));return{key:a.type,data:_}}},C=function(a){if(a.type==="WXXX"){if(a.size<2)return;var s=1,v=u(a.data.subarray(s),!0);s+=v.length+1;var m=u(a.data.subarray(s));return{key:a.type,info:v,data:m}}var _=u(a.data);return{key:a.type,data:_}},E=function(a){if(a.data.byteLength===8){var s=new Uint8Array(a.data),v=s[3]&1,m=(s[4]<<23)+(s[5]<<15)+(s[6]<<7)+s[7];return m/=45,v&&(m+=4772185884e-2),Math.round(m)}},u=function(a,s){s===void 0&&(s=!1);var v=d();if(v){var m=v.decode(a);if(s){var _=m.indexOf("\0");return _!==-1?m.substring(0,_):m}return m.replace(/\0/g,"")}for(var g=a.length,A,y,p,b="",P=0;P<g;){if(A=a[P++],A===0&&s)return b;if(A===0||A===3)continue;switch(A>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(A);break;case 12:case 13:y=a[P++],b+=String.fromCharCode((A&31)<<6|y&63);break;case 14:y=a[P++],p=a[P++],b+=String.fromCharCode((A&15)<<12|(y&63)<<6|(p&63)<<0);break}}return b},l={decodeTextFrame:O},c;function d(){return!c&&typeof self.TextDecoder<"u"&&(c=new self.TextDecoder("utf-8")),c}}),"./src/demux/mp3demuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>k});var F=h("./src/demux/base-audio-demuxer.ts"),T=h("./src/demux/id3.ts"),N=h("./src/utils/logger.ts"),M=h("./src/demux/mpegaudio.ts");function U(x,D){x.prototype=Object.create(D.prototype),x.prototype.constructor=x,w(x,D)}function w(x,D){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(x,D)}var I=(function(x){U(D,x);function D(){return x.apply(this,arguments)||this}var R=D.prototype;return R.resetInitSegment=function(C,E,u,l){x.prototype.resetInitSegment.call(this,C,E,u,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:E,duration:l,inputTimeScale:9e4,dropped:0}},D.probe=function(C){if(!C)return!1;for(var E=T.getID3Data(C,0)||[],u=E.length,l=C.length;u<l;u++)if(M.probe(C,u))return N.logger.log("MPEG Audio sync word found !"),!0;return!1},R.canParse=function(C,E){return M.canParse(C,E)},R.appendFrame=function(C,E,u){if(this.basePTS!==null)return M.appendFrame(C,E,u,this.basePTS,this.frameIndex)},D})(F.default);const k=I}),"./src/demux/mp4demuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>I});var F=h("./src/polyfills/number.ts"),T=h("./src/types/demuxer.ts"),N=h("./src/utils/mp4-tools.ts"),M=h("./src/demux/dummy-demuxed-track.ts"),U=/\/emsg[-/]ID3/i,w=(function(){function k(D,R){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=R}var x=k.prototype;return x.resetTimeStamp=function(){},x.resetInitSegment=function(R,O,C,E){var u=(0,N.parseInitSegment)(R),l=this.videoTrack=(0,M.dummyTrack)("video",1),c=this.audioTrack=(0,M.dummyTrack)("audio",1),d=this.txtTrack=(0,M.dummyTrack)("text",1);if(this.id3Track=(0,M.dummyTrack)("id3",1),this.timeOffset=0,u.video){var o=u.video,a=o.id,s=o.timescale,v=o.codec;l.id=a,l.timescale=d.timescale=s,l.codec=v}if(u.audio){var m=u.audio,_=m.id,g=m.timescale,A=m.codec;c.id=_,c.timescale=g,c.codec=A}d.id=N.RemuxerTrackIdConfig.text,l.sampleDuration=0,l.duration=c.duration=E},x.resetContiguity=function(){},k.probe=function(R){return R=R.length>16384?R.subarray(0,16384):R,(0,N.findBox)(R,["moof"]).length>0},x.demux=function(R,O){this.timeOffset=O;var C=R,E=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(C=(0,N.appendUint8Array)(this.remainderData,R));var l=(0,N.segmentValidRange)(C);this.remainderData=l.remainder,E.samples=l.valid||new Uint8Array}else E.samples=C;var c=this.extractID3Track(E,O);return u.samples=(0,N.parseSamples)(O,E),{videoTrack:E,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}},x.flush=function(){var R=this.timeOffset,O=this.videoTrack,C=this.txtTrack;O.samples=this.remainderData||new Uint8Array,this.remainderData=null;var E=this.extractID3Track(O,this.timeOffset);return C.samples=(0,N.parseSamples)(R,O),{videoTrack:O,audioTrack:(0,M.dummyTrack)(),id3Track:E,textTrack:(0,M.dummyTrack)()}},x.extractID3Track=function(R,O){var C=this.id3Track;if(R.samples.length){var E=(0,N.findBox)(R.samples,["emsg"]);E&&E.forEach(function(u){var l=(0,N.parseEmsg)(u);if(U.test(l.schemeIdUri)){var c=(0,F.isFiniteNumber)(l.presentationTime)?l.presentationTime/l.timeScale:O+l.presentationTimeDelta/l.timeScale,d=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);var o=l.payload;C.samples.push({data:o,len:o.byteLength,dts:c,pts:c,type:T.MetadataSchema.emsg,duration:d})}})}return C},x.demuxSampleAes=function(R,O,C){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},x.destroy=function(){},k})();const I=w}),"./src/demux/mpegaudio.ts":((S,L,h)=>{h.r(L),h.d(L,{appendFrame:()=>w,canParse:()=>D,isHeader:()=>x,isHeaderPattern:()=>k,parseHeader:()=>I,probe:()=>R});var F=null,T=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],N=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],U=[0,1,1,4];function w(O,C,E,u,l){if(!(E+24>C.length)){var c=I(C,E);if(c&&E+c.frameLength<=C.length){var d=c.samplesPerFrame*9e4/c.sampleRate,o=u+l*d,a={unit:C.subarray(E,E+c.frameLength),pts:o,dts:o};return O.config=[],O.channelCount=c.channelCount,O.samplerate=c.sampleRate,O.samples.push(a),{sample:a,length:c.frameLength,missing:0}}}}function I(O,C){var E=O[C+1]>>3&3,u=O[C+1]>>1&3,l=O[C+2]>>4&15,c=O[C+2]>>2&3;if(E!==1&&l!==0&&l!==15&&c!==3){var d=O[C+2]>>1&1,o=O[C+3]>>6,a=E===3?3-u:u===3?3:4,s=T[a*14+l-1]*1e3,v=E===3?0:E===2?1:2,m=N[v*3+c],_=o===3?1:2,g=M[E][u],A=U[u],y=g*8*A,p=Math.floor(g*s/m+d)*A;if(F===null){var b=navigator.userAgent||"",P=b.match(/Chrome\/(\d+)/i);F=P?parseInt(P[1]):0}var B=!!F&&F<=87;return B&&u===2&&s>=224e3&&o===0&&(O[C+3]=O[C+3]|128),{sampleRate:m,channelCount:_,frameLength:p,samplesPerFrame:y}}}function k(O,C){return O[C]===255&&(O[C+1]&224)===224&&(O[C+1]&6)!==0}function x(O,C){return C+1<O.length&&k(O,C)}function D(O,C){var E=4;return k(O,C)&&E<=O.length-C}function R(O,C){if(C+1<O.length&&k(O,C)){var E=4,u=I(O,C),l=E;u!=null&&u.frameLength&&(l=u.frameLength);var c=C+l;return c===O.length||x(O,c)}return!1}}),"./src/demux/sample-aes.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>M});var F=h("./src/crypt/decrypter.ts"),T=h("./src/utils/mp4-tools.ts"),N=(function(){function U(I,k,x){this.keyData=void 0,this.decrypter=void 0,this.keyData=x,this.decrypter=new F.default(I,k,{removePKCS7Padding:!1})}var w=U.prototype;return w.decryptBuffer=function(k,x){this.decrypter.decrypt(k,this.keyData.key.buffer,this.keyData.iv.buffer,x)},w.decryptAacSample=function(k,x,D,R){var O=k[x].unit;if(!(O.length<=16)){var C=O.subarray(16,O.length-O.length%16),E=C.buffer.slice(C.byteOffset,C.byteOffset+C.length),u=this;this.decryptBuffer(E,function(l){var c=new Uint8Array(l);O.set(c,16),R||u.decryptAacSamples(k,x+1,D)})}},w.decryptAacSamples=function(k,x,D){for(;;x++){if(x>=k.length){D();return}if(!(k[x].unit.length<32)){var R=this.decrypter.isSync();if(this.decryptAacSample(k,x,D,R),!R)return}}},w.getAvcEncryptedData=function(k){for(var x=Math.floor((k.length-48)/160)*16+16,D=new Int8Array(x),R=0,O=32;O<k.length-16;O+=160,R+=16)D.set(k.subarray(O,O+16),R);return D},w.getAvcDecryptedUnit=function(k,x){for(var D=new Uint8Array(x),R=0,O=32;O<k.length-16;O+=160,R+=16)k.set(D.subarray(R,R+16),O);return k},w.decryptAvcSample=function(k,x,D,R,O,C){var E=(0,T.discardEPB)(O.data),u=this.getAvcEncryptedData(E),l=this;this.decryptBuffer(u.buffer,function(c){O.data=l.getAvcDecryptedUnit(E,c),C||l.decryptAvcSamples(k,x,D+1,R)})},w.decryptAvcSamples=function(k,x,D,R){if(k instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;x++,D=0){if(x>=k.length){R();return}for(var O=k[x].units;!(D>=O.length);D++){var C=O[D];if(!(C.data.length<=48||C.type!==1&&C.type!==5)){var E=this.decrypter.isSync();if(this.decryptAvcSample(k,x,D,R,C,E),!E)return}}}},U})();const M=N}),"./src/demux/transmuxer-interface.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>x});var F=h("./src/demux/webworkify-webpack.js"),T=h("./src/events.ts"),N=h("./src/demux/transmuxer.ts"),M=h("./src/utils/logger.ts"),U=h("./src/errors.ts"),w=h("./src/utils/mediasource-helper.ts"),I=h("./node_modules/eventemitter3/index.js"),k=(0,w.getMediaSource)()||{isTypeSupported:function(){return!1}},x=(function(){function D(O,C,E,u){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var c=O.config;this.hls=O,this.id=C,this.useWorker=!!c.enableWorker,this.onTransmuxComplete=E,this.onFlush=u;var d=function(m,_){_=_||{},_.frag=l.frag,_.id=l.id,l.hls.trigger(m,_)};this.observer=new I.EventEmitter,this.observer.on(T.Events.FRAG_DECRYPTED,d),this.observer.on(T.Events.ERROR,d);var o={mp4:k.isTypeSupported("video/mp4"),mpeg:k.isTypeSupported("audio/mpeg"),mp3:k.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){M.logger.log("demuxing in webworker");var s;try{s=this.worker=(0,F.default)("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),s.addEventListener("message",this.onwmsg),s.onerror=function(v){l.useWorker=!1,M.logger.warn("Exception in webworker, fallback to inline"),l.hls.trigger(T.Events.ERROR,{type:U.ErrorTypes.OTHER_ERROR,details:U.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(v.message+"  ("+v.filename+":"+v.lineno+")")})},s.postMessage({cmd:"init",typeSupported:o,vendor:a,id:C,config:JSON.stringify(c)})}catch(v){M.logger.warn("Error in worker:",v),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),s&&self.URL.revokeObjectURL(s.objectURL),this.transmuxer=new N.default(this.observer,o,c,a,C),this.worker=null}}else this.transmuxer=new N.default(this.observer,o,c,a,C)}var R=D.prototype;return R.destroy=function(){var C=this.worker;if(C)C.removeEventListener("message",this.onwmsg),C.terminate(),this.worker=null,this.onwmsg=void 0;else{var E=this.transmuxer;E&&(E.destroy(),this.transmuxer=null)}var u=this.observer;u&&u.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},R.push=function(C,E,u,l,c,d,o,a,s,v){var m,_,g=this;s.transmuxing.start=self.performance.now();var A=this.transmuxer,y=this.worker,p=d?d.start:c.start,b=c.decryptdata,P=this.frag,B=!(P&&c.cc===P.cc),V=!(P&&s.level===P.level),W=P?s.sn-P.sn:-1,j=this.part?s.part-this.part.index:-1,$=W===0&&s.id>1&&s.id===P?.stats.chunkCount,Q=!V&&(W===1||W===0&&(j===1||$&&j<=0)),Z=self.performance.now();(V||W||c.stats.parsing.start===0)&&(c.stats.parsing.start=Z),d&&(j||!Q)&&(d.stats.parsing.start=Z);var ee=!(P&&((m=c.initSegment)===null||m===void 0?void 0:m.url)===((_=P.initSegment)===null||_===void 0?void 0:_.url)),se=new N.TransmuxState(B,Q,a,V,p,ee);if(!Q||B||ee){M.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+s.sn+" p: "+s.part+" level: "+s.level+" id: "+s.id+`
        discontinuity: `+B+`
        trackSwitch: `+V+`
        contiguous: `+Q+`
        accurateTimeOffset: `+a+`
        timeOffset: `+p+`
        initSegmentChange: `+ee);var Y=new N.TransmuxConfig(u,l,E,o,v);this.configureTransmuxer(Y)}if(this.frag=c,this.part=d,y)y.postMessage({cmd:"demux",data:C,decryptdata:b,chunkMeta:s,state:se},C instanceof ArrayBuffer?[C]:[]);else if(A){var X=A.push(C,b,s,se);(0,N.isPromise)(X)?X.then(function(q){g.handleTransmuxComplete(q)}):this.handleTransmuxComplete(X)}},R.flush=function(C){var E=this;C.transmuxing.start=self.performance.now();var u=this.transmuxer,l=this.worker;if(l)l.postMessage({cmd:"flush",chunkMeta:C});else if(u){var c=u.flush(C);(0,N.isPromise)(c)?c.then(function(d){E.handleFlushResult(d,C)}):this.handleFlushResult(c,C)}},R.handleFlushResult=function(C,E){var u=this;C.forEach(function(l){u.handleTransmuxComplete(l)}),this.onFlush(E)},R.onWorkerMessage=function(C){var E=C.data,u=this.hls;switch(E.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(E.data);break}case"flush":{this.onFlush(E.data);break}case"workerLog":M.logger[E.data.logType]&&M.logger[E.data.logType](E.data.message);break;default:{E.data=E.data||{},E.data.frag=this.frag,E.data.id=this.id,u.trigger(E.event,E.data);break}}},R.configureTransmuxer=function(C){var E=this.worker,u=this.transmuxer;E?E.postMessage({cmd:"configure",config:C}):u&&u.configure(C)},R.handleTransmuxComplete=function(C){C.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(C)},D})()}),"./src/demux/transmuxer-worker.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>U});var F=h("./src/demux/transmuxer.ts"),T=h("./src/events.ts"),N=h("./src/utils/logger.ts"),M=h("./node_modules/eventemitter3/index.js");function U(D){var R=new M.EventEmitter,O=function(u,l){D.postMessage({event:u,data:l})};R.on(T.Events.FRAG_DECRYPTED,O),R.on(T.Events.ERROR,O);var C=function(){var u=function(d){var o=function(s){O("workerLog",{logType:d,message:s})};N.logger[d]=o};for(var l in N.logger)u(l)};D.addEventListener("message",function(E){var u=E.data;switch(u.cmd){case"init":{var l=JSON.parse(u.config);D.transmuxer=new F.default(R,u.typeSupported,l,u.vendor,u.id),(0,N.enableLogs)(l.debug,u.id),C(),O("init",null);break}case"configure":{D.transmuxer.configure(u.config);break}case"demux":{var c=D.transmuxer.push(u.data,u.decryptdata,u.chunkMeta,u.state);(0,F.isPromise)(c)?c.then(function(a){w(D,a)}):w(D,c);break}case"flush":{var d=u.chunkMeta,o=D.transmuxer.flush(d);(0,F.isPromise)(o)?o.then(function(a){k(D,a,d)}):k(D,o,d);break}}})}function w(D,R){if(x(R.remuxResult))return!1;var O=[],C=R.remuxResult,E=C.audio,u=C.video;return E&&I(O,E),u&&I(O,u),D.postMessage({event:"transmuxComplete",data:R},O),!0}function I(D,R){R.data1&&D.push(R.data1.buffer),R.data2&&D.push(R.data2.buffer)}function k(D,R,O){var C=R.reduce(function(E,u){return w(D,u)||E},!1);C||D.postMessage({event:"transmuxComplete",data:R[0]}),D.postMessage({event:"flush",data:O})}function x(D){return!D.audio&&!D.video&&!D.text&&!D.id3&&!D.initSegment}}),"./src/demux/transmuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{TransmuxConfig:()=>c,TransmuxState:()=>d,default:()=>C,isPromise:()=>l});var F=h("./src/events.ts"),T=h("./src/errors.ts"),N=h("./src/crypt/decrypter.ts"),M=h("./src/demux/aacdemuxer.ts"),U=h("./src/demux/mp4demuxer.ts"),w=h("./src/demux/tsdemuxer.ts"),I=h("./src/demux/mp3demuxer.ts"),k=h("./src/remux/mp4-remuxer.ts"),x=h("./src/remux/passthrough-remuxer.ts"),D=h("./src/utils/logger.ts"),R;try{R=self.performance.now.bind(self.performance)}catch{D.logger.debug("Unable to use Performance API on this environment"),R=self.Date.now}var O=[{demux:w.default,remux:k.default},{demux:U.default,remux:x.default},{demux:M.default,remux:k.default},{demux:I.default,remux:k.default}],C=(function(){function o(s,v,m,_,g){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=s,this.typeSupported=v,this.config=m,this.vendor=_,this.id=g}var a=o.prototype;return a.configure=function(v){this.transmuxConfig=v,this.decrypter&&this.decrypter.reset()},a.push=function(v,m,_,g){var A=this,y=_.transmuxing;y.executeStart=R();var p=new Uint8Array(v),b=this.config,P=this.currentTransmuxState,B=this.transmuxConfig;g&&(this.currentTransmuxState=g);var V=g||P,W=V.contiguous,j=V.discontinuity,$=V.trackSwitch,Q=V.accurateTimeOffset,Z=V.timeOffset,ee=V.initSegmentChange,se=B.audioCodec,Y=B.videoCodec,X=B.defaultInitPts,q=B.duration,re=B.initSegmentData;(j||$||ee)&&this.resetInitSegment(re,se,Y,q),(j||ee)&&this.resetInitialTimestamp(X),W||this.resetContiguity();var te=E(p,m);if(te&&te.method==="AES-128"){var ne=this.getDecrypter();if(b.enableSoftwareAES){var K=ne.softwareDecrypt(p,te.key.buffer,te.iv.buffer);if(!K)return y.executeEnd=R(),u(_);p=new Uint8Array(K)}else return this.decryptionPromise=ne.webCryptoDecrypt(p,te.key.buffer,te.iv.buffer).then(function(J){var ae=A.push(J,null,_);return A.decryptionPromise=null,ae}),this.decryptionPromise}this.needsProbing(p,j,$)&&this.configureTransmuxer(p,B);var H=this.transmux(p,te,Z,Q,_),z=this.currentTransmuxState;return z.contiguous=!0,z.discontinuity=!1,z.trackSwitch=!1,y.executeEnd=R(),H},a.flush=function(v){var m=this,_=v.transmuxing;_.executeStart=R();var g=this.decrypter,A=this.currentTransmuxState,y=this.decryptionPromise;if(y)return y.then(function(){return m.flush(v)});var p=[],b=A.timeOffset;if(g){var P=g.flush();P&&p.push(this.push(P,null,v))}var B=this.demuxer,V=this.remuxer;if(!B||!V)return this.observer.emit(F.Events.ERROR,F.Events.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),_.executeEnd=R(),[u(v)];var W=B.flush(b);return l(W)?W.then(function(j){return m.flushRemux(p,j,v),p}):(this.flushRemux(p,W,v),p)},a.flushRemux=function(v,m,_){var g=m.audioTrack,A=m.videoTrack,y=m.id3Track,p=m.textTrack,b=this.currentTransmuxState,P=b.accurateTimeOffset,B=b.timeOffset;D.logger.log("[transmuxer.ts]: Flushed fragment "+_.sn+(_.part>-1?" p: "+_.part:"")+" of level "+_.level);var V=this.remuxer.remux(g,A,y,p,B,P,!0,this.id);v.push({remuxResult:V,chunkMeta:_}),_.transmuxing.executeEnd=R()},a.resetInitialTimestamp=function(v){var m=this.demuxer,_=this.remuxer;!m||!_||(m.resetTimeStamp(v),_.resetTimeStamp(v))},a.resetContiguity=function(){var v=this.demuxer,m=this.remuxer;!v||!m||(v.resetContiguity(),m.resetNextTimestamp())},a.resetInitSegment=function(v,m,_,g){var A=this.demuxer,y=this.remuxer;!A||!y||(A.resetInitSegment(v,m,_,g),y.resetInitSegment(v,m,_))},a.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},a.transmux=function(v,m,_,g,A){var y;return m&&m.method==="SAMPLE-AES"?y=this.transmuxSampleAes(v,m,_,g,A):y=this.transmuxUnencrypted(v,_,g,A),y},a.transmuxUnencrypted=function(v,m,_,g){var A=this.demuxer.demux(v,m,!1,!this.config.progressive),y=A.audioTrack,p=A.videoTrack,b=A.id3Track,P=A.textTrack,B=this.remuxer.remux(y,p,b,P,m,_,!1,this.id);return{remuxResult:B,chunkMeta:g}},a.transmuxSampleAes=function(v,m,_,g,A){var y=this;return this.demuxer.demuxSampleAes(v,m,_).then(function(p){var b=y.remuxer.remux(p.audioTrack,p.videoTrack,p.id3Track,p.textTrack,_,g,!1,y.id);return{remuxResult:b,chunkMeta:A}})},a.configureTransmuxer=function(v,m){for(var _=this.config,g=this.observer,A=this.typeSupported,y=this.vendor,p=m.audioCodec,b=m.defaultInitPts,P=m.duration,B=m.initSegmentData,V=m.videoCodec,W,j=0,$=O.length;j<$;j++)if(O[j].demux.probe(v)){W=O[j];break}W||(D.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),W={demux:U.default,remux:x.default});var Q=this.demuxer,Z=this.remuxer,ee=W.remux,se=W.demux;(!Z||!(Z instanceof ee))&&(this.remuxer=new ee(g,_,A,y)),(!Q||!(Q instanceof se))&&(this.demuxer=new se(g,_,A),this.probe=se.probe),this.resetInitSegment(B,p,V,P),this.resetInitialTimestamp(b)},a.needsProbing=function(v,m,_){return!this.demuxer||!this.remuxer||m||_},a.getDecrypter=function(){var v=this.decrypter;return v||(v=this.decrypter=new N.default(this.observer,this.config)),v},o})();function E(o,a){var s=null;return o.byteLength>0&&a!=null&&a.key!=null&&a.iv!==null&&a.method!=null&&(s=a),s}var u=function(a){return{remuxResult:{},chunkMeta:a}};function l(o){return"then"in o&&o.then instanceof Function}var c=function(a,s,v,m,_){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=a,this.videoCodec=s,this.initSegmentData=v,this.duration=m,this.defaultInitPts=_},d=function(a,s,v,m,_,g){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=a,this.contiguous=s,this.accurateTimeOffset=v,this.trackSwitch=m,this.timeOffset=_,this.initSegmentChange=g}}),"./src/demux/tsdemuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>d});var F=h("./src/demux/adts.ts"),T=h("./src/demux/mpegaudio.ts"),N=h("./src/demux/exp-golomb.ts"),M=h("./src/demux/sample-aes.ts"),U=h("./src/events.ts"),w=h("./src/utils/mp4-tools.ts"),I=h("./src/utils/logger.ts"),k=h("./src/errors.ts"),x=h("./src/types/demuxer.ts");function D(){return D=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var v in s)Object.prototype.hasOwnProperty.call(s,v)&&(o[v]=s[v])}return o},D.apply(this,arguments)}var R=188,O=(function(){function o(s,v,m){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=s,this.config=v,this.typeSupported=m}o.probe=function(v){var m=o.syncOffset(v);return m>0&&I.logger.warn("MPEG2-TS detected but first sync word found @ offset "+m),m!==-1},o.syncOffset=function(v){for(var m=Math.min(R*5,v.length-R*2)+1,_=0;_<m;){if(v[_]===71&&v[_+R]===71)return _;_++}return-1},o.createTrack=function(v,m){return{container:v==="video"||v==="audio"?"video/mp2t":void 0,type:v,id:w.RemuxerTrackIdConfig[v],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:v==="audio"?m:void 0}};var a=o.prototype;return a.resetInitSegment=function(v,m,_,g){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video"),this._audioTrack=o.createTrack("audio",g),this._id3Track=o.createTrack("id3"),this._txtTrack=o.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=m,this.videoCodec=_,this._duration=g},a.resetTimeStamp=function(){},a.resetContiguity=function(){var v=this._audioTrack,m=this._avcTrack,_=this._id3Track;v&&(v.pesData=null),m&&(m.pesData=null),_&&(_.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},a.demux=function(v,m,_,g){_===void 0&&(_=!1),g===void 0&&(g=!1),_||(this.sampleAes=null);var A,y=this._avcTrack,p=this._audioTrack,b=this._id3Track,P=this._txtTrack,B=y.pid,V=y.pesData,W=p.pid,j=b.pid,$=p.pesData,Q=b.pesData,Z=null,ee=this.pmtParsed,se=this._pmtId,Y=v.length;if(this.remainderData&&(v=(0,w.appendUint8Array)(this.remainderData,v),Y=v.length,this.remainderData=null),Y<R&&!g)return this.remainderData=v,{audioTrack:p,videoTrack:y,id3Track:b,textTrack:P};var X=Math.max(0,o.syncOffset(v));Y-=(Y-X)%R,Y<v.byteLength&&!g&&(this.remainderData=new Uint8Array(v.buffer,Y,v.buffer.byteLength-Y));for(var q=0,re=X;re<Y;re+=R)if(v[re]===71){var te=!!(v[re+1]&64),ne=((v[re+1]&31)<<8)+v[re+2],K=(v[re+3]&48)>>4,H=void 0;if(K>1){if(H=re+5+v[re+4],H===re+R)continue}else H=re+4;switch(ne){case B:te&&(V&&(A=l(V))&&this.parseAVCPES(y,P,A,!1),V={data:[],size:0}),V&&(V.data.push(v.subarray(H,re+R)),V.size+=re+R-H);break;case W:if(te){if($&&(A=l($)))switch(p.segmentCodec){case"aac":this.parseAACPES(p,A);break;case"mp3":this.parseMPEGPES(p,A);break}$={data:[],size:0}}$&&($.data.push(v.subarray(H,re+R)),$.size+=re+R-H);break;case j:te&&(Q&&(A=l(Q))&&this.parseID3PES(b,A),Q={data:[],size:0}),Q&&(Q.data.push(v.subarray(H,re+R)),Q.size+=re+R-H);break;case 0:te&&(H+=v[H]+1),se=this._pmtId=E(v,H);break;case se:{te&&(H+=v[H]+1);var z=u(v,H,this.typeSupported,_);B=z.avc,B>0&&(y.pid=B),W=z.audio,W>0&&(p.pid=W,p.segmentCodec=z.segmentCodec),j=z.id3,j>0&&(b.pid=j),Z!==null&&!ee&&(I.logger.log("unknown PID '"+Z+"' in TS found"),Z=null,re=X-188),ee=this.pmtParsed=!0;break}case 17:case 8191:break;default:Z=ne;break}}else q++;q>0&&this.observer.emit(U.Events.ERROR,U.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+q+" TS packet/s that do not start with 0x47"}),y.pesData=V,p.pesData=$,b.pesData=Q;var J={audioTrack:p,videoTrack:y,id3Track:b,textTrack:P};return g&&this.extractRemainingSamples(J),J},a.flush=function(){var v=this.remainderData;this.remainderData=null;var m;return v?m=this.demux(v,-1,!1,!0):m={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(m),this.sampleAes?this.decrypt(m,this.sampleAes):m},a.extractRemainingSamples=function(v){var m=v.audioTrack,_=v.videoTrack,g=v.id3Track,A=v.textTrack,y=_.pesData,p=m.pesData,b=g.pesData,P;if(y&&(P=l(y))?(this.parseAVCPES(_,A,P,!0),_.pesData=null):_.pesData=y,p&&(P=l(p))){switch(m.segmentCodec){case"aac":this.parseAACPES(m,P);break;case"mp3":this.parseMPEGPES(m,P);break}m.pesData=null}else p!=null&&p.size&&I.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=p;b&&(P=l(b))?(this.parseID3PES(g,P),g.pesData=null):g.pesData=b},a.demuxSampleAes=function(v,m,_){var g=this.demux(v,_,!0,!this.config.progressive),A=this.sampleAes=new M.default(this.observer,this.config,m);return this.decrypt(g,A)},a.decrypt=function(v,m){return new Promise(function(_){var g=v.audioTrack,A=v.videoTrack;g.samples&&g.segmentCodec==="aac"?m.decryptAacSamples(g.samples,0,function(){A.samples?m.decryptAvcSamples(A.samples,0,0,function(){_(v)}):_(v)}):A.samples&&m.decryptAvcSamples(A.samples,0,0,function(){_(v)})})},a.destroy=function(){this._duration=0},a.parseAVCPES=function(v,m,_,g){var A=this,y=this.parseAVCNALu(v,_.data),p=this.avcSample,b,P=!1;_.data=null,p&&y.length&&!v.audFound&&(c(p,v),p=this.avcSample=C(!1,_.pts,_.dts,"")),y.forEach(function(B){switch(B.type){case 1:{b=!0,p||(p=A.avcSample=C(!0,_.pts,_.dts,"")),p.frame=!0;var V=B.data;if(P&&V.length>4){var W=new N.default(V).readSliceType();(W===2||W===4||W===7||W===9)&&(p.key=!0)}break}case 5:b=!0,p||(p=A.avcSample=C(!0,_.pts,_.dts,"")),p.key=!0,p.frame=!0;break;case 6:{b=!0,(0,w.parseSEIMessageFromNALu)(B.data,1,_.pts,m.samples);break}case 7:if(b=!0,P=!0,!v.sps){var j=new N.default(B.data),$=j.readSPS();v.width=$.width,v.height=$.height,v.pixelRatio=$.pixelRatio,v.sps=[B.data],v.duration=A._duration;for(var Q=B.data.subarray(1,4),Z="avc1.",ee=0;ee<3;ee++){var se=Q[ee].toString(16);se.length<2&&(se="0"+se),Z+=se}v.codec=Z}break;case 8:b=!0,v.pps||(v.pps=[B.data]);break;case 9:b=!1,v.audFound=!0,p&&c(p,v),p=A.avcSample=C(!1,_.pts,_.dts,"");break;case 12:b=!0;break;default:b=!1,p&&(p.debug+="unknown NAL "+B.type+" ");break}if(p&&b){var Y=p.units;Y.push(B)}}),g&&p&&(c(p,v),this.avcSample=null)},a.getLastNalUnit=function(v){var m,_=this.avcSample,g;if((!_||_.units.length===0)&&(_=v[v.length-1]),(m=_)!==null&&m!==void 0&&m.units){var A=_.units;g=A[A.length-1]}return g},a.parseAVCNALu=function(v,m){var _=m.byteLength,g=v.naluState||0,A=g,y=[],p=0,b,P,B,V=-1,W=0;for(g===-1&&(V=0,W=m[0]&31,g=0,p=1);p<_;){if(b=m[p++],!g){g=b?0:1;continue}if(g===1){g=b?0:2;continue}if(!b)g=3;else if(b===1){if(V>=0){var j={data:m.subarray(V,p-g-1),type:W};y.push(j)}else{var $=this.getLastNalUnit(v.samples);if($&&(A&&p<=4-A&&$.state&&($.data=$.data.subarray(0,$.data.byteLength-A)),P=p-g-1,P>0)){var Q=new Uint8Array($.data.byteLength+P);Q.set($.data,0),Q.set(m.subarray(0,P),$.data.byteLength),$.data=Q,$.state=0}}p<_?(B=m[p]&31,V=p,W=B,g=0):g=-1}else g=0}if(V>=0&&g>=0){var Z={data:m.subarray(V,_),type:W,state:g};y.push(Z)}if(y.length===0){var ee=this.getLastNalUnit(v.samples);if(ee){var se=new Uint8Array(ee.data.byteLength+m.byteLength);se.set(ee.data,0),se.set(m,ee.data.byteLength),ee.data=se}}return v.naluState=g,y},a.parseAACPES=function(v,m){var _=0,g=this.aacOverFlow,A=m.data;if(g){this.aacOverFlow=null;var y=g.missing,p=g.sample.unit.byteLength;if(y===-1){var b=new Uint8Array(p+A.byteLength);b.set(g.sample.unit,0),b.set(A,p),A=b}else{var P=p-y;g.sample.unit.set(A.subarray(0,y),P),v.samples.push(g.sample),_=g.missing}}var B,V;for(B=_,V=A.length;B<V-1&&!F.isHeader(A,B);B++);if(B!==_){var W,j;if(B<V-1?(W="AAC PES did not start with ADTS header,offset:"+B,j=!1):(W="no ADTS header found in AAC PES",j=!0),I.logger.warn("parsing error:"+W),this.observer.emit(U.Events.ERROR,U.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:W}),j)return}F.initTrackConfig(v,this.observer,A,B,this.audioCodec);var $;if(m.pts!==void 0)$=m.pts;else if(g){var Q=F.getFrameDuration(v.samplerate);$=g.sample.pts+Q}else{I.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var Z=0,ee;B<V;)if(ee=F.appendFrame(v,A,B,$,Z),B+=ee.length,ee.missing){this.aacOverFlow=ee;break}else for(Z++;B<V-1&&!F.isHeader(A,B);B++);},a.parseMPEGPES=function(v,m){var _=m.data,g=_.length,A=0,y=0,p=m.pts;if(p===void 0){I.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;y<g;)if(T.isHeader(_,y)){var b=T.appendFrame(v,_,y,p,A);if(b)y+=b.length,A++;else break}else y++},a.parseID3PES=function(v,m){if(m.pts===void 0){I.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var _=D({},m,{type:this._avcTrack?x.MetadataSchema.emsg:x.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});v.samples.push(_)},o})();function C(o,a,s,v){return{key:o,frame:!1,pts:a,dts:s,units:[],debug:v,length:0}}function E(o,a){return(o[a+10]&31)<<8|o[a+11]}function u(o,a,s,v){var m={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},_=(o[a+1]&15)<<8|o[a+2],g=a+3+_-4,A=(o[a+10]&15)<<8|o[a+11];for(a+=12+A;a<g;){var y=(o[a+1]&31)<<8|o[a+2];switch(o[a]){case 207:if(!v){I.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:m.audio===-1&&(m.audio=y);break;case 21:m.id3===-1&&(m.id3=y);break;case 219:if(!v){I.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:m.avc===-1&&(m.avc=y);break;case 3:case 4:s.mpeg!==!0&&s.mp3!==!0?I.logger.log("MPEG audio found, not supported in this browser"):m.audio===-1&&(m.audio=y,m.segmentCodec="mp3");break;case 36:I.logger.warn("Unsupported HEVC stream type found");break}a+=((o[a+3]&15)<<8|o[a+4])+5}return m}function l(o){var a=0,s,v,m,_,g,A=o.data;if(!o||o.size===0)return null;for(;A[0].length<19&&A.length>1;){var y=new Uint8Array(A[0].length+A[1].length);y.set(A[0]),y.set(A[1],A[0].length),A[0]=y,A.splice(1,1)}s=A[0];var p=(s[0]<<16)+(s[1]<<8)+s[2];if(p===1){if(v=(s[4]<<8)+s[5],v&&v>o.size-6)return null;var b=s[7];b&192&&(_=(s[9]&14)*536870912+(s[10]&255)*4194304+(s[11]&254)*16384+(s[12]&255)*128+(s[13]&254)/2,b&64?(g=(s[14]&14)*536870912+(s[15]&255)*4194304+(s[16]&254)*16384+(s[17]&255)*128+(s[18]&254)/2,_-g>54e5&&(I.logger.warn(Math.round((_-g)/9e4)+"s delta between PTS and DTS, align them"),_=g)):g=_),m=s[8];var P=m+9;if(o.size<=P)return null;o.size-=P;for(var B=new Uint8Array(o.size),V=0,W=A.length;V<W;V++){s=A[V];var j=s.byteLength;if(P)if(P>j){P-=j;continue}else s=s.subarray(P),j-=P,P=0;B.set(s,a),a+=j}return v&&(v-=m+3),{data:B,pts:_,dts:g,len:v}}return null}function c(o,a){if(o.units.length&&o.frame){if(o.pts===void 0){var s=a.samples,v=s.length;if(v){var m=s[v-1];o.pts=m.pts,o.dts=m.dts}else{a.dropped++;return}}a.samples.push(o)}o.debug.length&&I.logger.log(o.pts+"/"+o.dts+":"+o.debug)}const d=O}),"./src/demux/webworkify-webpack.js":((S,L,h)=>{h.r(L),h.d(L,{default:()=>R});var F=function(){var C=ENTRY_MODULE,E={},u=function c(d){var o=E[d];if(o!==void 0)return o.exports;var a=E[d]={exports:{}};return C[d].call(a.exports,a,a.exports,c),a.exports};u.m=C,(function(){u.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return u.d(d,{a:d}),d}})(),(function(){u.d=function(c,d){for(var o in d)u.o(d,o)&&!u.o(c,o)&&Object.defineProperty(c,o,{enumerable:!0,get:d[o]})}})(),(function(){u.o=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)}})(),(function(){u.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}})();var l=u(ENTRY_MODULE);return l.default||l},T=F.toString().split("ENTRY_MODULE"),N="[\\.|\\-|\\+|\\w|/|@]+",M="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+N+").*?\\)";function U(O){return(O+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function w(O){return!isNaN(1*O)}function I(O,C,E){var u={};u[E]=[];var l=C.toString().replace(/^"[^"]+"/,"function"),c=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||l.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!c)return u;for(var d=c[1],o=new RegExp("(\\\\n|\\W)"+U(d)+M,"g"),a;a=o.exec(l);)a[3]!=="dll-reference"&&u[E].push(a[3]);for(o=new RegExp("\\("+U(d)+'\\("(dll-reference\\s('+N+'))"\\)\\)'+M,"g");a=o.exec(l);)O[a[2]]||(u[E].push(a[1]),O[a[2]]=h(a[1]).m),u[a[2]]=u[a[2]]||[],u[a[2]].push(a[4]);for(var s=Object.keys(u),v=0;v<s.length;v++)for(var m=0;m<u[s[v]].length;m++)w(u[s[v]][m])&&(u[s[v]][m]=1*u[s[v]][m]);return u}function k(O){var C=Object.keys(O);return C.reduce(function(E,u){return E||O[u].length>0},!1)}function x(O,C){for(var E={main:[C]},u={main:[]},l={main:{}};k(E);)for(var c=Object.keys(E),d=0;d<c.length;d++){var o=c[d],a=E[o],s=a.pop();if(l[o]=l[o]||{},!(l[o][s]||!O[o][s])){l[o][s]=!0,u[o]=u[o]||[],u[o].push(s);for(var v=I(O,O[o][s],o),m=Object.keys(v),_=0;_<m.length;_++)E[m[_]]=E[m[_]]||[],E[m[_]]=E[m[_]].concat(v[m[_]])}}return u}function D(O,C,E,u){var l=O[u].map(function(c){return'"'+c+'": '+C[u][c].toString().replace(/^"[^"]+"/,"function")}).join(",");return T[0]+"{"+l+"}"+T[1]+'"'+E+'"'+T[2]}function R(O,C){C=C||{};var E={main:h.m},u=C.all?{main:Object.keys(E.main)}:x(E,O),l="";Object.keys(u).filter(function(s){return s!=="main"}).forEach(function(s){for(var v=0;u[s][v];)v++;u[s].push(v),E[s][v]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+("var "+s+" = ("+D(u,E,v,modules)+`)();
`)}),l=l+("new (("+D(u,E,O,"main")+")())(self);");var c=new window.Blob([l],{type:"text/javascript"}),d=window.URL||window.webkitURL||window.mozURL||window.msURL,o=d.createObjectURL(c),a=new window.Worker(o);return a.objectURL=o,a}}),"./src/errors.ts":((S,L,h)=>{h.r(L),h.d(L,{ErrorDetails:()=>T,ErrorTypes:()=>F});var F;(function(N){N.NETWORK_ERROR="networkError",N.MEDIA_ERROR="mediaError",N.KEY_SYSTEM_ERROR="keySystemError",N.MUX_ERROR="muxError",N.OTHER_ERROR="otherError"})(F||(F={}));var T;(function(N){N.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",N.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",N.KEY_SYSTEM_NO_SESSION="keySystemNoSession",N.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",N.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",N.MANIFEST_LOAD_ERROR="manifestLoadError",N.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",N.MANIFEST_PARSING_ERROR="manifestParsingError",N.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",N.LEVEL_EMPTY_ERROR="levelEmptyError",N.LEVEL_LOAD_ERROR="levelLoadError",N.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",N.LEVEL_SWITCH_ERROR="levelSwitchError",N.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",N.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",N.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",N.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",N.FRAG_LOAD_ERROR="fragLoadError",N.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",N.FRAG_DECRYPT_ERROR="fragDecryptError",N.FRAG_PARSING_ERROR="fragParsingError",N.REMUX_ALLOC_ERROR="remuxAllocError",N.KEY_LOAD_ERROR="keyLoadError",N.KEY_LOAD_TIMEOUT="keyLoadTimeOut",N.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",N.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",N.BUFFER_APPEND_ERROR="bufferAppendError",N.BUFFER_APPENDING_ERROR="bufferAppendingError",N.BUFFER_STALLED_ERROR="bufferStalledError",N.BUFFER_FULL_ERROR="bufferFullError",N.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",N.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",N.INTERNAL_EXCEPTION="internalException",N.INTERNAL_ABORTED="aborted",N.UNKNOWN="unknown"})(T||(T={}))}),"./src/events.ts":((S,L,h)=>{h.r(L),h.d(L,{Events:()=>F});var F;(function(T){T.MEDIA_ATTACHING="hlsMediaAttaching",T.MEDIA_ATTACHED="hlsMediaAttached",T.MEDIA_DETACHING="hlsMediaDetaching",T.MEDIA_DETACHED="hlsMediaDetached",T.BUFFER_RESET="hlsBufferReset",T.BUFFER_CODECS="hlsBufferCodecs",T.BUFFER_CREATED="hlsBufferCreated",T.BUFFER_APPENDING="hlsBufferAppending",T.BUFFER_APPENDED="hlsBufferAppended",T.BUFFER_EOS="hlsBufferEos",T.BUFFER_FLUSHING="hlsBufferFlushing",T.BUFFER_FLUSHED="hlsBufferFlushed",T.MANIFEST_LOADING="hlsManifestLoading",T.MANIFEST_LOADED="hlsManifestLoaded",T.MANIFEST_PARSED="hlsManifestParsed",T.LEVEL_SWITCHING="hlsLevelSwitching",T.LEVEL_SWITCHED="hlsLevelSwitched",T.LEVEL_LOADING="hlsLevelLoading",T.LEVEL_LOADED="hlsLevelLoaded",T.LEVEL_UPDATED="hlsLevelUpdated",T.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",T.LEVELS_UPDATED="hlsLevelsUpdated",T.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",T.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",T.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",T.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",T.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",T.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",T.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",T.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",T.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",T.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",T.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",T.CUES_PARSED="hlsCuesParsed",T.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",T.INIT_PTS_FOUND="hlsInitPtsFound",T.FRAG_LOADING="hlsFragLoading",T.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",T.FRAG_LOADED="hlsFragLoaded",T.FRAG_DECRYPTED="hlsFragDecrypted",T.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",T.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",T.FRAG_PARSING_METADATA="hlsFragParsingMetadata",T.FRAG_PARSED="hlsFragParsed",T.FRAG_BUFFERED="hlsFragBuffered",T.FRAG_CHANGED="hlsFragChanged",T.FPS_DROP="hlsFpsDrop",T.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",T.ERROR="hlsError",T.DESTROYING="hlsDestroying",T.KEY_LOADING="hlsKeyLoading",T.KEY_LOADED="hlsKeyLoaded",T.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",T.BACK_BUFFER_REACHED="hlsBackBufferReached"})(F||(F={}))}),"./src/hls.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>c});var F=h("./node_modules/url-toolkit/src/url-toolkit.js"),T=h("./src/loader/playlist-loader.ts"),N=h("./src/loader/key-loader.ts"),M=h("./src/controller/id3-track-controller.ts"),U=h("./src/controller/latency-controller.ts"),w=h("./src/controller/level-controller.ts"),I=h("./src/controller/fragment-tracker.ts"),k=h("./src/controller/stream-controller.ts"),x=h("./src/is-supported.ts"),D=h("./src/utils/logger.ts"),R=h("./src/config.ts"),O=h("./node_modules/eventemitter3/index.js"),C=h("./src/events.ts"),E=h("./src/errors.ts");function u(d,o){for(var a=0;a<o.length;a++){var s=o[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}function l(d,o,a){return o&&u(d.prototype,o),a&&u(d,a),Object.defineProperty(d,"prototype",{writable:!1}),d}var c=(function(){d.isSupported=function(){return(0,x.isSupported)()};function d(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new O.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var s=this.config=(0,R.mergeConfig)(d.DefaultConfig,a);this.userConfig=a,(0,D.enableLogs)(s.debug,"Hls instance"),this._autoLevelCapping=-1,s.progressive&&(0,R.enableStreamingMode)(s);var v=s.abrController,m=s.bufferController,_=s.capLevelController,g=s.fpsController,A=this.abrController=new v(this),y=this.bufferController=new m(this),p=this.capLevelController=new _(this),b=new g(this),P=new T.default(this),B=new N.default(this),V=new M.default(this),W=this.levelController=new w.default(this),j=new I.FragmentTracker(this),$=this.streamController=new k.default(this,j);p.setStreamController($),b.setStreamController($);var Q=[P,B,W,$];this.networkControllers=Q;var Z=[A,y,p,b,V,j];this.audioTrackController=this.createController(s.audioTrackController,null,Q),this.createController(s.audioStreamController,j,Q),this.subtitleTrackController=this.createController(s.subtitleTrackController,null,Q),this.createController(s.subtitleStreamController,j,Q),this.createController(s.timelineController,null,Z),this.emeController=this.createController(s.emeController,null,Z),this.cmcdController=this.createController(s.cmcdController,null,Z),this.latencyController=this.createController(U.default,null,Z),this.coreComponents=Z}var o=d.prototype;return o.createController=function(s,v,m){if(s){var _=v?new s(this,v):new s(this);return m&&m.push(_),_}return null},o.on=function(s,v,m){m===void 0&&(m=this),this._emitter.on(s,v,m)},o.once=function(s,v,m){m===void 0&&(m=this),this._emitter.once(s,v,m)},o.removeAllListeners=function(s){this._emitter.removeAllListeners(s)},o.off=function(s,v,m,_){m===void 0&&(m=this),this._emitter.off(s,v,m,_)},o.listeners=function(s){return this._emitter.listeners(s)},o.emit=function(s,v,m){return this._emitter.emit(s,v,m)},o.trigger=function(s,v){if(this.config.debug)return this.emit(s,s,v);try{return this.emit(s,s,v)}catch(m){D.logger.error("An internal error happened while handling event "+s+'. Error message: "'+m.message+'". Here is a stacktrace:',m),this.trigger(C.Events.ERROR,{type:E.ErrorTypes.OTHER_ERROR,details:E.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:s,error:m})}return!1},o.listenerCount=function(s){return this._emitter.listenerCount(s)},o.destroy=function(){D.logger.log("destroy"),this.trigger(C.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(s){return s.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(s){return s.destroy()}),this.coreComponents.length=0},o.attachMedia=function(s){D.logger.log("attachMedia"),this._media=s,this.trigger(C.Events.MEDIA_ATTACHING,{media:s})},o.detachMedia=function(){D.logger.log("detachMedia"),this.trigger(C.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(s){this.stopLoad();var v=this.media,m=this.url,_=this.url=F.buildAbsoluteURL(self.location.href,s,{alwaysNormalize:!0});D.logger.log("loadSource:"+_),v&&m&&m!==_&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(v)),this.trigger(C.Events.MANIFEST_LOADING,{url:s})},o.startLoad=function(s){s===void 0&&(s=-1),D.logger.log("startLoad("+s+")"),this.networkControllers.forEach(function(v){v.startLoad(s)})},o.stopLoad=function(){D.logger.log("stopLoad"),this.networkControllers.forEach(function(s){s.stopLoad()})},o.swapAudioCodec=function(){D.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){D.logger.log("recoverMediaError");var s=this._media;this.detachMedia(),s&&this.attachMedia(s)},o.removeLevel=function(s,v){v===void 0&&(v=0),this.levelController.removeLevel(s,v)},l(d,[{key:"levels",get:function(){var s=this.levelController.levels;return s||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(s){D.logger.log("set currentLevel:"+s),this.loadLevel=s,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(s){D.logger.log("set nextLevel:"+s),this.levelController.manualLevel=s,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(s){D.logger.log("set loadLevel:"+s),this.levelController.manualLevel=s}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(s){this.levelController.nextLoadLevel=s}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(s){D.logger.log("set firstLevel:"+s),this.levelController.firstLevel=s}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(s){D.logger.log("set startLevel:"+s),s!==-1&&(s=Math.max(s,this.minAutoLevel)),this.levelController.startLevel=s}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(s){var v=!!s;v!==this.config.capLevelToPlayerSize&&(v?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=v)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(s){this._autoLevelCapping!==s&&(D.logger.log("set autoLevelCapping:"+s),this._autoLevelCapping=s)}},{key:"bandwidthEstimate",get:function(){var s=this.abrController.bwEstimator;return s?s.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var s=this.levels,v=this.config.minAutoBitrate;if(!s)return 0;for(var m=s.length,_=0;_<m;_++)if(s[_].maxBitrate>=v)return _;return 0}},{key:"maxAutoLevel",get:function(){var s=this.levels,v=this.autoLevelCapping,m;return v===-1&&s&&s.length?m=s.length-1:m=v,m}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(s){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,s)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var s=this.audioTrackController;return s?s.audioTracks:[]}},{key:"audioTrack",get:function(){var s=this.audioTrackController;return s?s.audioTrack:-1},set:function(s){var v=this.audioTrackController;v&&(v.audioTrack=s)}},{key:"subtitleTracks",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTrack:-1},set:function(s){var v=this.subtitleTrackController;v&&(v.subtitleTrack=s)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var s=this.subtitleTrackController;return s?s.subtitleDisplay:!1},set:function(s){var v=this.subtitleTrackController;v&&(v.subtitleDisplay=s)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(s){this.config.lowLatencyMode=s}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.9"}},{key:"Events",get:function(){return C.Events}},{key:"ErrorTypes",get:function(){return E.ErrorTypes}},{key:"ErrorDetails",get:function(){return E.ErrorDetails}},{key:"DefaultConfig",get:function(){return d.defaultConfig?d.defaultConfig:R.hlsDefaultConfig},set:function(s){d.defaultConfig=s}}]),d})();c.defaultConfig=void 0}),"./src/is-supported.ts":((S,L,h)=>{h.r(L),h.d(L,{changeTypeSupported:()=>M,isSupported:()=>N});var F=h("./src/utils/mediasource-helper.ts");function T(){return self.SourceBuffer||self.WebKitSourceBuffer}function N(){var U=(0,F.getMediaSource)();if(!U)return!1;var w=T(),I=U&&typeof U.isTypeSupported=="function"&&U.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),k=!w||w.prototype&&typeof w.prototype.appendBuffer=="function"&&typeof w.prototype.remove=="function";return!!I&&!!k}function M(){var U,w=T();return typeof(w==null||(U=w.prototype)===null||U===void 0?void 0:U.changeType)=="function"}}),"./src/loader/date-range.ts":((S,L,h)=>{h.r(L),h.d(L,{DateRange:()=>k,DateRangeAttribute:()=>I});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/attr-list.ts"),N=h("./src/utils/logger.ts");function M(){return M=Object.assign?Object.assign.bind():function(x){for(var D=1;D<arguments.length;D++){var R=arguments[D];for(var O in R)Object.prototype.hasOwnProperty.call(R,O)&&(x[O]=R[O])}return x},M.apply(this,arguments)}function U(x,D){for(var R=0;R<D.length;R++){var O=D[R];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(x,O.key,O)}}function w(x,D,R){return D&&U(x.prototype,D),Object.defineProperty(x,"prototype",{writable:!1}),x}var I;(function(x){x.ID="ID",x.CLASS="CLASS",x.START_DATE="START-DATE",x.DURATION="DURATION",x.END_DATE="END-DATE",x.END_ON_NEXT="END-ON-NEXT",x.PLANNED_DURATION="PLANNED-DURATION",x.SCTE35_OUT="SCTE35-OUT",x.SCTE35_IN="SCTE35-IN"})(I||(I={}));var k=(function(){function x(D,R){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,R){var O=R.attr;for(var C in O)if(Object.prototype.hasOwnProperty.call(D,C)&&D[C]!==O[C]){N.logger.warn('DATERANGE tag attribute: "'+C+'" does not match for tags with ID: "'+D.ID+'"'),this._badValueForSameId=C;break}D=M(new T.AttrList({}),O,D)}if(this.attr=D,this._startDate=new Date(D[I.START_DATE]),I.END_DATE in this.attr){var E=new Date(this.attr[I.END_DATE]);(0,F.isFiniteNumber)(E.getTime())&&(this._endDate=E)}}return w(x,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var R=this.duration;return R!==null?new Date(this._startDate.getTime()+R*1e3):null}},{key:"duration",get:function(){if(I.DURATION in this.attr){var R=this.attr.decimalFloatingPoint(I.DURATION);if((0,F.isFiniteNumber)(R))return R}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return I.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(I.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(I.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,F.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),x})()}),"./src/loader/fragment-loader.ts":((S,L,h)=>{h.r(L),h.d(L,{LoadError:()=>C,default:()=>R});var F=h("./src/polyfills/number.ts"),T=h("./src/errors.ts");function N(E,u){E.prototype=Object.create(u.prototype),E.prototype.constructor=E,k(E,u)}function M(E){var u=typeof Map=="function"?new Map:void 0;return M=function(c){if(c===null||!I(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,d)}function d(){return U(c,arguments,x(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),k(d,c)},M(E)}function U(E,u,l){return w()?U=Reflect.construct.bind():U=function(d,o,a){var s=[null];s.push.apply(s,o);var v=Function.bind.apply(d,s),m=new v;return a&&k(m,a.prototype),m},U.apply(null,arguments)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I(E){return Function.toString.call(E).indexOf("[native code]")!==-1}function k(E,u){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},k(E,u)}function x(E){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},x(E)}var D=Math.pow(2,17),R=(function(){function E(l){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=l}var u=E.prototype;return u.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},u.abort=function(){this.loader&&this.loader.abort()},u.load=function(c,d){var o=this,a=c.url;if(!a)return Promise.reject(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var s=this.config,v=s.fLoader,m=s.loader;return new Promise(function(_,g){o.loader&&o.loader.destroy();var A=o.loader=c.loader=v?new v(s):new m(s),y=O(c),p={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:c.sn==="initSegment"?1/0:D};c.stats=A.stats,A.load(y,p,{onSuccess:function(P,B,V,W){o.resetLoader(c,A),_({frag:c,part:null,payload:P.data,networkDetails:W})},onError:function(P,B,V){o.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,response:P,networkDetails:V}))},onAbort:function(P,B,V){o.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,networkDetails:V}))},onTimeout:function(P,B,V){o.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,networkDetails:V}))},onProgress:function(P,B,V,W){d&&d({frag:c,part:null,payload:V,networkDetails:W})}})})},u.loadPart=function(c,d,o){var a=this;this.abort();var s=this.config,v=s.fLoader,m=s.loader;return new Promise(function(_,g){a.loader&&a.loader.destroy();var A=a.loader=c.loader=v?new v(s):new m(s),y=O(c,d),p={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:D};d.stats=A.stats,A.load(y,p,{onSuccess:function(P,B,V,W){a.resetLoader(c,A),a.updateStatsFromPart(c,d);var j={frag:c,part:d,payload:P.data,networkDetails:W};o(j),_(j)},onError:function(P,B,V){a.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,part:d,response:P,networkDetails:V}))},onAbort:function(P,B,V){c.stats.aborted=d.stats.aborted,a.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,part:d,networkDetails:V}))},onTimeout:function(P,B,V){a.resetLoader(c,A),g(new C({type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,part:d,networkDetails:V}))}})})},u.updateStatsFromPart=function(c,d){var o=c.stats,a=d.stats,s=a.total;if(o.loaded+=a.loaded,s){var v=Math.round(c.duration/d.duration),m=Math.min(Math.round(o.loaded/s),v),_=v-m,g=_*Math.round(o.loaded/m);o.total=o.loaded+g}else o.total=Math.max(o.loaded,o.total);var A=o.loading,y=a.loading;A.start?A.first+=y.first-y.start:(A.start=y.start,A.first=y.first),A.end=y.end},u.resetLoader=function(c,d){c.loader=null,this.loader===d&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),d.destroy()},E})();function O(E,u){u===void 0&&(u=null);var l=u||E,c={frag:E,part:u,responseType:"arraybuffer",url:l.url,headers:{},rangeStart:0,rangeEnd:0},d=l.byteRangeStartOffset,o=l.byteRangeEndOffset;return(0,F.isFiniteNumber)(d)&&(0,F.isFiniteNumber)(o)&&(c.rangeStart=d,c.rangeEnd=o),c}var C=(function(E){N(u,E);function u(l){for(var c,d=arguments.length,o=new Array(d>1?d-1:0),a=1;a<d;a++)o[a-1]=arguments[a];return c=E.call.apply(E,[this].concat(o))||this,c.data=void 0,c.data=l,c}return u})(M(Error))}),"./src/loader/fragment.ts":((S,L,h)=>{h.r(L),h.d(L,{BaseSegment:()=>R,ElementaryStreamTypes:()=>D,Fragment:()=>O,Part:()=>C});var F=h("./src/polyfills/number.ts"),T=h("./node_modules/url-toolkit/src/url-toolkit.js"),N=h("./src/utils/logger.ts"),M=h("./src/loader/level-key.ts"),U=h("./src/loader/load-stats.ts");function w(E,u){E.prototype=Object.create(u.prototype),E.prototype.constructor=E,I(E,u)}function I(E,u){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},I(E,u)}function k(E,u){for(var l=0;l<u.length;l++){var c=u[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(E,c.key,c)}}function x(E,u,l){return u&&k(E.prototype,u),Object.defineProperty(E,"prototype",{writable:!1}),E}var D;(function(E){E.AUDIO="audio",E.VIDEO="video",E.AUDIOVIDEO="audiovideo"})(D||(D={}));var R=(function(){function E(l){var c;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(c={},c[D.AUDIO]=null,c[D.VIDEO]=null,c[D.AUDIOVIDEO]=null,c),this.baseurl=l}var u=E.prototype;return u.setByteRange=function(c,d){var o=c.split("@",2),a=[];o.length===1?a[0]=d?d.byteRangeEndOffset:0:a[0]=parseInt(o[1]),a[1]=parseInt(o[0])+a[0],this._byteRange=a},x(E,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,T.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(c){this._url=c}}]),E})(),O=(function(E){w(u,E);function u(c,d){var o;return o=E.call(this,d)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new U.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=c,o}var l=u.prototype;return l.createInitializationVector=function(d){for(var o=new Uint8Array(16),a=12;a<16;a++)o[a]=d>>8*(15-a)&255;return o},l.setDecryptDataFromLevelKey=function(d,o){var a=d;return d?.method==="AES-128"&&d.uri&&!d.iv&&(a=M.LevelKey.fromURI(d.uri),a.method=d.method,a.iv=this.createInitializationVector(o),a.keyFormat="identity"),a},l.setElementaryStreamInfo=function(d,o,a,s,v,m){m===void 0&&(m=!1);var _=this.elementaryStreams,g=_[d];if(!g){_[d]={startPTS:o,endPTS:a,startDTS:s,endDTS:v,partial:m};return}g.startPTS=Math.min(g.startPTS,o),g.endPTS=Math.max(g.endPTS,a),g.startDTS=Math.min(g.startDTS,s),g.endDTS=Math.max(g.endDTS,v)},l.clearElementaryStreamInfo=function(){var d=this.elementaryStreams;d[D.AUDIO]=null,d[D.VIDEO]=null,d[D.AUDIOVIDEO]=null},x(u,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var d=this.sn;typeof d!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&N.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),d=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,d)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,F.isFiniteNumber)(this.programDateTime))return null;var d=(0,F.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+d*1e3}},{key:"encrypted",get:function(){var d;return!!((d=this.decryptdata)!==null&&d!==void 0&&d.keyFormat&&this.decryptdata.uri)}}]),u})(R),C=(function(E){w(u,E);function u(l,c,d,o,a){var s;s=E.call(this,d)||this,s.fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new U.LoadStats,s.duration=l.decimalFloatingPoint("DURATION"),s.gap=l.bool("GAP"),s.independent=l.bool("INDEPENDENT"),s.relurl=l.enumeratedString("URI"),s.fragment=c,s.index=o;var v=l.enumeratedString("BYTERANGE");return v&&s.setByteRange(v,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return x(u,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var c=this.elementaryStreams;return!!(c.audio||c.video||c.audiovideo)}}]),u})(R)}),"./src/loader/key-loader.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>M});var F=h("./src/events.ts"),T=h("./src/errors.ts"),N=h("./src/utils/logger.ts"),M=(function(){function U(I){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=I,this.registerListeners()}var w=U.prototype;return w.startLoad=function(k){},w.stopLoad=function(){this.destroyInternalLoaders()},w.registerListeners=function(){this.hls.on(F.Events.KEY_LOADING,this.onKeyLoading,this)},w.unregisterListeners=function(){this.hls.off(F.Events.KEY_LOADING,this.onKeyLoading)},w.destroyInternalLoaders=function(){for(var k in this.loaders){var x=this.loaders[k];x&&x.destroy()}this.loaders={}},w.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},w.onKeyLoading=function(k,x){var D=x.frag,R=D.type,O=this.loaders[R];if(!D.decryptdata){N.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var C=D.decryptdata.uri;if(C!==this.decrypturl||this.decryptkey===null){var E=this.hls.config;if(O&&(N.logger.warn("abort previous key loader for type:"+R),O.abort()),!C){N.logger.warn("key uri is falsy");return}var u=E.loader,l=D.loader=this.loaders[R]=new u(E);this.decrypturl=C,this.decryptkey=null;var c={url:C,frag:D,responseType:"arraybuffer"},d={timeout:E.fragLoadingTimeOut,maxRetry:0,retryDelay:E.fragLoadingRetryDelay,maxRetryDelay:E.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};l.load(c,d,o)}else this.decryptkey&&(D.decryptdata.key=this.decryptkey,this.hls.trigger(F.Events.KEY_LOADED,{frag:D}))},w.loadsuccess=function(k,x,D){var R=D.frag;if(!R.decryptdata){N.logger.error("after key load, decryptdata unset");return}this.decryptkey=R.decryptdata.key=new Uint8Array(k.data),R.loader=null,delete this.loaders[R.type],this.hls.trigger(F.Events.KEY_LOADED,{frag:R})},w.loaderror=function(k,x){var D=x.frag,R=D.loader;R&&R.abort(),delete this.loaders[D.type],this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:D,response:k})},w.loadtimeout=function(k,x){var D=x.frag,R=D.loader;R&&R.abort(),delete this.loaders[D.type],this.hls.trigger(F.Events.ERROR,{type:T.ErrorTypes.NETWORK_ERROR,details:T.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:D})},U})()}),"./src/loader/level-details.ts":((S,L,h)=>{h.r(L),h.d(L,{LevelDetails:()=>U});var F=h("./src/polyfills/number.ts");function T(w,I){for(var k=0;k<I.length;k++){var x=I[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(w,x.key,x)}}function N(w,I,k){return I&&T(w.prototype,I),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=10,U=(function(){function w(k){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=k}var I=w.prototype;return I.reloaded=function(x){if(!x){this.advanced=!0,this.updated=!0;return}var D=this.lastPartSn-x.lastPartSn,R=this.lastPartIndex-x.lastPartIndex;this.updated=this.endSN!==x.endSN||!!R||!!D,this.advanced=this.endSN>x.endSN||D>0||D===0&&R>0,this.updated||this.advanced?this.misses=Math.floor(x.misses*.6):this.misses=x.misses+1,this.availabilityDelay=x.availabilityDelay},N(w,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?(0,F.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var x=this.driftEndTime-this.driftStartTime;if(x>0){var D=this.driftEnd-this.driftStart;return D*1e3/x}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var x;return(x=this.fragments)!==null&&x!==void 0&&x.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),w})()}),"./src/loader/level-key.ts":((S,L,h)=>{h.r(L),h.d(L,{LevelKey:()=>M});var F=h("./node_modules/url-toolkit/src/url-toolkit.js");function T(U,w){for(var I=0;I<w.length;I++){var k=w[I];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(U,k.key,k)}}function N(U,w,I){return w&&T(U.prototype,w),Object.defineProperty(U,"prototype",{writable:!1}),U}var M=(function(){U.fromURL=function(I,k){return new U(I,k)},U.fromURI=function(I){return new U(I)};function U(w,I){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,I?this._uri=(0,F.buildAbsoluteURL)(w,I,{alwaysNormalize:!0}):this._uri=w}return N(U,[{key:"uri",get:function(){return this._uri}}]),U})()}),"./src/loader/load-stats.ts":((S,L,h)=>{h.r(L),h.d(L,{LoadStats:()=>F});var F=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}),"./src/loader/m3u8-parser.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>l});var F=h("./src/polyfills/number.ts"),T=h("./node_modules/url-toolkit/src/url-toolkit.js"),N=h("./src/loader/date-range.ts"),M=h("./src/loader/fragment.ts"),U=h("./src/loader/level-details.ts"),w=h("./src/loader/level-key.ts"),I=h("./src/utils/attr-list.ts"),k=h("./src/utils/logger.ts"),x=h("./src/utils/codecs.ts"),D=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,R=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),C=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),E=/\.(mp4|m4s|m4v|m4a)$/i;function u(v){var m,_;return E.test((m=(_=T.parseURL(v))===null||_===void 0?void 0:_.path)!=null?m:"")}var l=(function(){function v(){}return v.findGroup=function(_,g){for(var A=0;A<_.length;A++){var y=_[A];if(y.id===g)return y}},v.convertAVC1ToAVCOTI=function(_){var g=_.split(".");if(g.length>2){var A=g.shift()+".";return A+=parseInt(g.shift()).toString(16),A+=("000"+parseInt(g.shift()).toString(16)).slice(-4),A}return _},v.resolve=function(_,g){return T.buildAbsoluteURL(g,_,{alwaysNormalize:!0})},v.parseMasterPlaylist=function(_,g){var A=[],y=[],p={},b=!1;D.lastIndex=0;for(var P;(P=D.exec(_))!=null;)if(P[1]){var B,V=new I.AttrList(P[1]),W={attrs:V,bitrate:V.decimalInteger("AVERAGE-BANDWIDTH")||V.decimalInteger("BANDWIDTH"),name:V.NAME,url:v.resolve(P[2],g)},j=V.decimalResolution("RESOLUTION");j&&(W.width=j.width,W.height=j.height),c((V.CODECS||"").split(/[ ,]+/).filter(function(Z){return Z}),W),W.videoCodec&&W.videoCodec.indexOf("avc1")!==-1&&(W.videoCodec=v.convertAVC1ToAVCOTI(W.videoCodec)),(B=W.unknownCodecs)!==null&&B!==void 0&&B.length||y.push(W),A.push(W)}else if(P[3]){var $=new I.AttrList(P[3]);$["DATA-ID"]&&(b=!0,p[$["DATA-ID"]]=$)}var Q=y.length>0&&y.length<A.length;return{levels:Q?y:A,sessionData:b?p:null}},v.parseMasterPlaylistMedia=function(_,g,A,y){y===void 0&&(y=[]);var p,b=[],P=0;for(R.lastIndex=0;(p=R.exec(_))!==null;){var B=new I.AttrList(p[1]);if(B.TYPE===A){var V={attrs:B,bitrate:0,id:P++,groupId:B["GROUP-ID"],instreamId:B["INSTREAM-ID"],name:B.NAME||B.LANGUAGE||"",type:A,default:B.bool("DEFAULT"),autoselect:B.bool("AUTOSELECT"),forced:B.bool("FORCED"),lang:B.LANGUAGE,url:B.URI?v.resolve(B.URI,g):""};if(y.length){var W=v.findGroup(y,V.groupId)||y[0];d(V,W,"audioCodec"),d(V,W,"textCodec")}b.push(V)}}return b},v.parseLevelPlaylist=function(_,g,A,y,p){var b=new U.LevelDetails(g),P=b.fragments,B=null,V=0,W=0,j=0,$=0,Q=null,Z=new M.Fragment(y,g),ee,se,Y,X=-1,q=!1;for(O.lastIndex=0,b.m3u8=_;(ee=O.exec(_))!==null;){q&&(q=!1,Z=new M.Fragment(y,g),Z.start=j,Z.sn=V,Z.cc=$,Z.level=A,B&&(Z.initSegment=B,Z.rawProgramDateTime=B.rawProgramDateTime,B.rawProgramDateTime=null));var re=ee[1];if(re){Z.duration=parseFloat(re);var te=(" "+ee[2]).slice(1);Z.title=te||null,Z.tagList.push(te?["INF",re,te]:["INF",re])}else if(ee[3])(0,F.isFiniteNumber)(Z.duration)&&(Z.start=j,Y&&(Z.levelkey=Y),Z.sn=V,Z.level=A,Z.cc=$,Z.urlId=p,P.push(Z),Z.relurl=(" "+ee[3]).slice(1),a(Z,Q),Q=Z,j+=Z.duration,V++,W=0,q=!0);else if(ee[4]){var ne=(" "+ee[4]).slice(1);Q?Z.setByteRange(ne,Q):Z.setByteRange(ne)}else if(ee[5])Z.rawProgramDateTime=(" "+ee[5]).slice(1),Z.tagList.push(["PROGRAM-DATE-TIME",Z.rawProgramDateTime]),X===-1&&(X=P.length);else{if(ee=ee[0].match(C),!ee){k.logger.warn("No matches on slow regex match for level playlist!");continue}for(se=1;se<ee.length&&!(typeof ee[se]<"u");se++);var K=(" "+ee[se]).slice(1),H=(" "+ee[se+1]).slice(1),z=ee[se+2]?(" "+ee[se+2]).slice(1):"";switch(K){case"PLAYLIST-TYPE":b.type=H.toUpperCase();break;case"MEDIA-SEQUENCE":V=b.startSN=parseInt(H);break;case"SKIP":{var J=new I.AttrList(H),ae=J.decimalInteger("SKIPPED-SEGMENTS");if((0,F.isFiniteNumber)(ae)){b.skippedSegments=ae;for(var ie=ae;ie--;)P.unshift(null);V+=ae}var le=J.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(b.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":b.targetduration=parseFloat(H);break;case"VERSION":b.version=parseInt(H);break;case"EXTM3U":break;case"ENDLIST":b.live=!1;break;case"#":(H||z)&&Z.tagList.push(z?[H,z]:[H]);break;case"DISCONTINUITY":$++,Z.tagList.push(["DIS"]);break;case"GAP":Z.tagList.push([K]);break;case"BITRATE":Z.tagList.push([K,H]);break;case"DATERANGE":{var oe=new I.AttrList(H),ce=new N.DateRange(oe,b.dateRanges[oe.ID]);ce.isValid||b.skippedSegments?b.dateRanges[ce.id]=ce:k.logger.warn('Ignoring invalid DATERANGE tag: "'+H+'"'),Z.tagList.push(["EXT-X-DATERANGE",H]);break}case"DISCONTINUITY-SEQUENCE":$=parseInt(H);break;case"KEY":{var he,de=new I.AttrList(H),pe=de.enumeratedString("METHOD"),Ae=de.URI,Pe=de.hexadecimalInteger("IV"),De=de.enumeratedString("KEYFORMATVERSIONS"),Me=de.enumeratedString("KEYID"),He=(he=de.enumeratedString("KEYFORMAT"))!=null?he:"identity",Ce=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(Ce.indexOf(He)>-1){k.logger.warn("Keyformat "+He+" is not supported from the manifest");continue}else if(He!=="identity")continue;pe&&(Y=w.LevelKey.fromURL(g,Ae),Ae&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(pe)>=0&&(Y.method=pe,Y.keyFormat=He,Me&&(Y.keyID=Me),De&&(Y.keyFormatVersions=De),Y.iv=Pe));break}case"START":{var we=new I.AttrList(H),Ie=we.decimalFloatingPoint("TIME-OFFSET");(0,F.isFiniteNumber)(Ie)&&(b.startTimeOffset=Ie);break}case"MAP":{var Ne=new I.AttrList(H);if(Z.duration){var it=new M.Fragment(y,g);s(it,Ne,A,Y),B=it,Z.initSegment=B,B.rawProgramDateTime&&!Z.rawProgramDateTime&&(Z.rawProgramDateTime=B.rawProgramDateTime)}else s(Z,Ne,A,Y),B=Z,q=!0;break}case"SERVER-CONTROL":{var Re=new I.AttrList(H);b.canBlockReload=Re.bool("CAN-BLOCK-RELOAD"),b.canSkipUntil=Re.optionalFloat("CAN-SKIP-UNTIL",0),b.canSkipDateRanges=b.canSkipUntil>0&&Re.bool("CAN-SKIP-DATERANGES"),b.partHoldBack=Re.optionalFloat("PART-HOLD-BACK",0),b.holdBack=Re.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Ke=new I.AttrList(H);b.partTarget=Ke.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Ze=b.partList;Ze||(Ze=b.partList=[]);var Yt=W>0?Ze[Ze.length-1]:void 0,$t=W++,or=new M.Part(new I.AttrList(H),Z,g,$t,Yt);Ze.push(or),Z.duration+=or.duration;break}case"PRELOAD-HINT":{var dt=new I.AttrList(H);b.preloadHint=dt;break}case"RENDITION-REPORT":{var Dn=new I.AttrList(H);b.renditionReports=b.renditionReports||[],b.renditionReports.push(Dn);break}default:k.logger.warn("line parsed but not handled: "+ee);break}}}Q&&!Q.relurl?(P.pop(),j-=Q.duration,b.partList&&(b.fragmentHint=Q)):b.partList&&(a(Z,Q),Z.cc=$,b.fragmentHint=Z);var zt=P.length,bt=P[0],lr=P[zt-1];if(j+=b.skippedSegments*b.targetduration,j>0&&zt&&lr){b.averagetargetduration=j/zt;var Xt=lr.sn;b.endSN=Xt!=="initSegment"?Xt:0,bt&&(b.startCC=bt.cc,bt.initSegment||b.fragments.every(function(Xr){return Xr.relurl&&u(Xr.relurl)})&&(k.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),Z=new M.Fragment(y,g),Z.relurl=lr.relurl,Z.level=A,Z.sn="initSegment",bt.initSegment=Z,b.needSidxRanges=!0))}else b.endSN=0,b.startCC=0;return b.fragmentHint&&(j+=b.fragmentHint.duration),b.totalduration=j,b.endCC=$,X>0&&o(P,X),b},v})();function c(v,m){["video","audio","text"].forEach(function(_){var g=v.filter(function(y){return(0,x.isCodecType)(y,_)});if(g.length){var A=g.filter(function(y){return y.lastIndexOf("avc1",0)===0||y.lastIndexOf("mp4a",0)===0});m[_+"Codec"]=A.length>0?A[0]:g[0],v=v.filter(function(y){return g.indexOf(y)===-1})}}),m.unknownCodecs=v}function d(v,m,_){var g=m[_];g&&(v[_]=g)}function o(v,m){for(var _=v[m],g=m;g--;){var A=v[g];if(!A)return;A.programDateTime=_.programDateTime-A.duration*1e3,_=A}}function a(v,m){v.rawProgramDateTime?v.programDateTime=Date.parse(v.rawProgramDateTime):m!=null&&m.programDateTime&&(v.programDateTime=m.endProgramDateTime),(0,F.isFiniteNumber)(v.programDateTime)||(v.programDateTime=null,v.rawProgramDateTime=null)}function s(v,m,_,g){v.relurl=m.URI,m.BYTERANGE&&v.setByteRange(m.BYTERANGE),v.level=_,v.sn="initSegment",g&&(v.levelkey=g),v.initSegment=null}}),"./src/loader/playlist-loader.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>O});var F=h("./src/polyfills/number.ts"),T=h("./src/events.ts"),N=h("./src/errors.ts"),M=h("./src/utils/logger.ts"),U=h("./src/utils/mp4-tools.ts"),w=h("./src/loader/m3u8-parser.ts"),I=h("./src/types/loader.ts"),k=h("./src/utils/attr-list.ts");function x(C){var E=C.type;switch(E){case I.PlaylistContextType.AUDIO_TRACK:return I.PlaylistLevelType.AUDIO;case I.PlaylistContextType.SUBTITLE_TRACK:return I.PlaylistLevelType.SUBTITLE;default:return I.PlaylistLevelType.MAIN}}function D(C,E){var u=C.url;return(u===void 0||u.indexOf("data:")===0)&&(u=E.url),u}var R=(function(){function C(u){this.hls=void 0,this.loaders=Object.create(null),this.hls=u,this.registerListeners()}var E=C.prototype;return E.startLoad=function(l){},E.stopLoad=function(){this.destroyInternalLoaders()},E.registerListeners=function(){var l=this.hls;l.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(T.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(T.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.on(T.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},E.unregisterListeners=function(){var l=this.hls;l.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(T.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(T.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.off(T.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},E.createInternalLoader=function(l){var c=this.hls.config,d=c.pLoader,o=c.loader,a=d||o,s=new a(c);return l.loader=s,this.loaders[l.type]=s,s},E.getInternalLoader=function(l){return this.loaders[l.type]},E.resetInternalLoader=function(l){this.loaders[l]&&delete this.loaders[l]},E.destroyInternalLoaders=function(){for(var l in this.loaders){var c=this.loaders[l];c&&c.destroy(),this.resetInternalLoader(l)}},E.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},E.onManifestLoading=function(l,c){var d=c.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:I.PlaylistContextType.MANIFEST,url:d,deliveryDirectives:null})},E.onLevelLoading=function(l,c){var d=c.id,o=c.level,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:null,level:o,responseType:"text",type:I.PlaylistContextType.LEVEL,url:a,deliveryDirectives:s})},E.onAudioTrackLoading=function(l,c){var d=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.AUDIO_TRACK,url:a,deliveryDirectives:s})},E.onSubtitleTrackLoading=function(l,c){var d=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.SUBTITLE_TRACK,url:a,deliveryDirectives:s})},E.load=function(l){var c,d=this.hls.config,o=this.getInternalLoader(l);if(o){var a=o.context;if(a&&a.url===l.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+l.type),o.abort()}var s,v,m,_;switch(l.type){case I.PlaylistContextType.MANIFEST:s=d.manifestLoadingMaxRetry,v=d.manifestLoadingTimeOut,m=d.manifestLoadingRetryDelay,_=d.manifestLoadingMaxRetryTimeout;break;case I.PlaylistContextType.LEVEL:case I.PlaylistContextType.AUDIO_TRACK:case I.PlaylistContextType.SUBTITLE_TRACK:s=0,v=d.levelLoadingTimeOut;break;default:s=d.levelLoadingMaxRetry,v=d.levelLoadingTimeOut,m=d.levelLoadingRetryDelay,_=d.levelLoadingMaxRetryTimeout;break}if(o=this.createInternalLoader(l),(c=l.deliveryDirectives)!==null&&c!==void 0&&c.part){var g;if(l.type===I.PlaylistContextType.LEVEL&&l.level!==null?g=this.hls.levels[l.level].details:l.type===I.PlaylistContextType.AUDIO_TRACK&&l.id!==null?g=this.hls.audioTracks[l.id].details:l.type===I.PlaylistContextType.SUBTITLE_TRACK&&l.id!==null&&(g=this.hls.subtitleTracks[l.id].details),g){var A=g.partTarget,y=g.targetduration;A&&y&&(v=Math.min(Math.max(A*3,y*.8)*1e3,v))}}var p={timeout:v,maxRetry:s,retryDelay:m,maxRetryDelay:_,highWaterMark:0},b={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o.load(l,p,b)},E.loadsuccess=function(l,c,d,o){if(o===void 0&&(o=null),d.isSidxRequest){this.handleSidxRequest(l,d),this.handlePlaylistLoaded(l,c,d,o);return}this.resetInternalLoader(d.type);var a=l.data;if(a.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(l,d,"no EXTM3U delimiter",o);return}c.parsing.start=performance.now(),a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(l,c,d,o):this.handleMasterPlaylist(l,c,d,o)},E.loaderror=function(l,c,d){d===void 0&&(d=null),this.handleNetworkError(c,d,!1,l)},E.loadtimeout=function(l,c,d){d===void 0&&(d=null),this.handleNetworkError(c,d,!0)},E.handleMasterPlaylist=function(l,c,d,o){var a=this.hls,s=l.data,v=D(l,d),m=w.default.parseMasterPlaylist(s,v),_=m.levels,g=m.sessionData;if(!_.length){this.handleManifestParsingError(l,d,"no level found in manifest",o);return}var A=_.map(function(V){return{id:V.attrs.AUDIO,audioCodec:V.audioCodec}}),y=_.map(function(V){return{id:V.attrs.SUBTITLES,textCodec:V.textCodec}}),p=w.default.parseMasterPlaylistMedia(s,v,"AUDIO",A),b=w.default.parseMasterPlaylistMedia(s,v,"SUBTITLES",y),P=w.default.parseMasterPlaylistMedia(s,v,"CLOSED-CAPTIONS");if(p.length){var B=p.some(function(V){return!V.url});!B&&_[0].audioCodec&&!_[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new k.AttrList({}),bitrate:0,url:""}))}a.trigger(T.Events.MANIFEST_LOADED,{levels:_,audioTracks:p,subtitles:b,captions:P,url:v,stats:c,networkDetails:o,sessionData:g})},E.handleTrackOrLevelPlaylist=function(l,c,d,o){var a=this.hls,s=d.id,v=d.level,m=d.type,_=D(l,d),g=(0,F.isFiniteNumber)(s)?s:0,A=(0,F.isFiniteNumber)(v)?v:g,y=x(d),p=w.default.parseLevelPlaylist(l.data,_,A,y,g);if(!p.fragments.length){a.trigger(T.Events.ERROR,{type:N.ErrorTypes.NETWORK_ERROR,details:N.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:_,reason:"no fragments found in level",level:typeof d.level=="number"?d.level:void 0});return}if(m===I.PlaylistContextType.MANIFEST){var b={attrs:new k.AttrList({}),bitrate:0,details:p,name:"",url:_};a.trigger(T.Events.MANIFEST_LOADED,{levels:[b],audioTracks:[],url:_,stats:c,networkDetails:o,sessionData:null})}if(c.parsing.end=performance.now(),p.needSidxRanges){var P,B=(P=p.fragments[0].initSegment)===null||P===void 0?void 0:P.url;this.load({url:B,isSidxRequest:!0,type:m,level:v,levelDetails:p,id:s,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}d.levelDetails=p,this.handlePlaylistLoaded(l,c,d,o)},E.handleSidxRequest=function(l,c){var d=new Uint8Array(l.data),o=(0,U.findBox)(d,["sidx"])[0];if(o){var a=(0,U.parseSegmentIndex)(o);if(a){var s=a.references,v=c.levelDetails;s.forEach(function(m,_){var g=m.info,A=v.fragments[_];if(A.byteRange.length===0&&A.setByteRange(String(1+g.end-g.start)+"@"+String(g.start)),A.initSegment){var y=(0,U.findBox)(d,["moov"])[0],p=y?y.length:null;A.initSegment.setByteRange(String(p)+"@0")}})}}},E.handleManifestParsingError=function(l,c,d,o){this.hls.trigger(T.Events.ERROR,{type:N.ErrorTypes.NETWORK_ERROR,details:N.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:c.type===I.PlaylistContextType.MANIFEST,url:l.url,reason:d,response:l,context:c,networkDetails:o})},E.handleNetworkError=function(l,c,d,o){d===void 0&&(d=!1),M.logger.warn("[playlist-loader]: A network "+(d?"timeout":"error")+" occurred while loading "+l.type+" level: "+l.level+" id: "+l.id+' group-id: "'+l.groupId+'"');var a=N.ErrorDetails.UNKNOWN,s=!1,v=this.getInternalLoader(l);switch(l.type){case I.PlaylistContextType.MANIFEST:a=d?N.ErrorDetails.MANIFEST_LOAD_TIMEOUT:N.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case I.PlaylistContextType.LEVEL:a=d?N.ErrorDetails.LEVEL_LOAD_TIMEOUT:N.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.AUDIO_TRACK:a=d?N.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:N.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.SUBTITLE_TRACK:a=d?N.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:N.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}v&&this.resetInternalLoader(l.type);var m={type:N.ErrorTypes.NETWORK_ERROR,details:a,fatal:s,url:l.url,loader:v,context:l,networkDetails:c};o&&(m.response=o),this.hls.trigger(T.Events.ERROR,m)},E.handlePlaylistLoaded=function(l,c,d,o){var a=d.type,s=d.level,v=d.id,m=d.groupId,_=d.loader,g=d.levelDetails,A=d.deliveryDirectives;if(!(g!=null&&g.targetduration)){this.handleManifestParsingError(l,d,"invalid target duration",o);return}if(_)switch(g.live&&(_.getCacheAge&&(g.ageHeader=_.getCacheAge()||0),(!_.getCacheAge||isNaN(g.ageHeader))&&(g.ageHeader=0)),a){case I.PlaylistContextType.MANIFEST:case I.PlaylistContextType.LEVEL:this.hls.trigger(T.Events.LEVEL_LOADED,{details:g,level:s||0,id:v||0,stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(T.Events.AUDIO_TRACK_LOADED,{details:g,id:v||0,groupId:m||"",stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(T.Events.SUBTITLE_TRACK_LOADED,{details:g,id:v||0,groupId:m||"",stats:c,networkDetails:o,deliveryDirectives:A});break}},C})();const O=R}),"./src/polyfills/number.ts":((S,L,h)=>{h.r(L),h.d(L,{MAX_SAFE_INTEGER:()=>T,isFiniteNumber:()=>F});var F=Number.isFinite||function(N){return typeof N=="number"&&isFinite(N)},T=Number.MAX_SAFE_INTEGER||9007199254740991}),"./src/remux/aac-helper.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>T});var F=(function(){function N(){}return N.getSilentFrame=function(U,w){switch(U){case"mp4a.40.2":if(w===1)return new Uint8Array([0,200,0,128,35,128]);if(w===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(w===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(w===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(w===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(w===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(w===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},N})();const T=F}),"./src/remux/mp4-generator.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>N});var F=Math.pow(2,32)-1,T=(function(){function M(){}return M.init=function(){M.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var w;for(w in M.types)M.types.hasOwnProperty(w)&&(M.types[w]=[w.charCodeAt(0),w.charCodeAt(1),w.charCodeAt(2),w.charCodeAt(3)]);var I=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),k=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);M.HDLR_TYPES={video:I,audio:k};var x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),D=new Uint8Array([0,0,0,0,0,0,0,0]);M.STTS=M.STSC=M.STCO=D,M.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),M.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),M.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),M.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var R=new Uint8Array([105,115,111,109]),O=new Uint8Array([97,118,99,49]),C=new Uint8Array([0,0,0,1]);M.FTYP=M.box(M.types.ftyp,R,C,R,O),M.DINF=M.box(M.types.dinf,M.box(M.types.dref,x))},M.box=function(w){for(var I=8,k=arguments.length,x=new Array(k>1?k-1:0),D=1;D<k;D++)x[D-1]=arguments[D];for(var R=x.length,O=R;R--;)I+=x[R].byteLength;var C=new Uint8Array(I);for(C[0]=I>>24&255,C[1]=I>>16&255,C[2]=I>>8&255,C[3]=I&255,C.set(w,4),R=0,I=8;R<O;R++)C.set(x[R],I),I+=x[R].byteLength;return C},M.hdlr=function(w){return M.box(M.types.hdlr,M.HDLR_TYPES[w])},M.mdat=function(w){return M.box(M.types.mdat,w)},M.mdhd=function(w,I){I*=w;var k=Math.floor(I/(F+1)),x=Math.floor(I%(F+1));return M.box(M.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,x>>24,x>>16&255,x>>8&255,x&255,85,196,0,0]))},M.mdia=function(w){return M.box(M.types.mdia,M.mdhd(w.timescale,w.duration),M.hdlr(w.type),M.minf(w))},M.mfhd=function(w){return M.box(M.types.mfhd,new Uint8Array([0,0,0,0,w>>24,w>>16&255,w>>8&255,w&255]))},M.minf=function(w){return w.type==="audio"?M.box(M.types.minf,M.box(M.types.smhd,M.SMHD),M.DINF,M.stbl(w)):M.box(M.types.minf,M.box(M.types.vmhd,M.VMHD),M.DINF,M.stbl(w))},M.moof=function(w,I,k){return M.box(M.types.moof,M.mfhd(w),M.traf(k,I))},M.moov=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trak(w[I]);return M.box.apply(null,[M.types.moov,M.mvhd(w[0].timescale,w[0].duration)].concat(k).concat(M.mvex(w)))},M.mvex=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trex(w[I]);return M.box.apply(null,[M.types.mvex].concat(k))},M.mvhd=function(w,I){I*=w;var k=Math.floor(I/(F+1)),x=Math.floor(I%(F+1)),D=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,x>>24,x>>16&255,x>>8&255,x&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return M.box(M.types.mvhd,D)},M.sdtp=function(w){var I=w.samples||[],k=new Uint8Array(4+I.length),x,D;for(x=0;x<I.length;x++)D=I[x].flags,k[x+4]=D.dependsOn<<4|D.isDependedOn<<2|D.hasRedundancy;return M.box(M.types.sdtp,k)},M.stbl=function(w){return M.box(M.types.stbl,M.stsd(w),M.box(M.types.stts,M.STTS),M.box(M.types.stsc,M.STSC),M.box(M.types.stsz,M.STSZ),M.box(M.types.stco,M.STCO))},M.avc1=function(w){var I=[],k=[],x,D,R;for(x=0;x<w.sps.length;x++)D=w.sps[x],R=D.byteLength,I.push(R>>>8&255),I.push(R&255),I=I.concat(Array.prototype.slice.call(D));for(x=0;x<w.pps.length;x++)D=w.pps[x],R=D.byteLength,k.push(R>>>8&255),k.push(R&255),k=k.concat(Array.prototype.slice.call(D));var O=M.box(M.types.avcC,new Uint8Array([1,I[3],I[4],I[5],255,224|w.sps.length].concat(I).concat([w.pps.length]).concat(k))),C=w.width,E=w.height,u=w.pixelRatio[0],l=w.pixelRatio[1];return M.box(M.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,C>>8&255,C&255,E>>8&255,E&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),O,M.box(M.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),M.box(M.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,l>>24,l>>16&255,l>>8&255,l&255])))},M.esds=function(w){var I=w.config.length;return new Uint8Array([0,0,0,0,3,23+I,0,1,0,4,15+I,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([I]).concat(w.config).concat([6,1,2]))},M.mp4a=function(w){var I=w.samplerate;return M.box(M.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]),M.box(M.types.esds,M.esds(w)))},M.mp3=function(w){var I=w.samplerate;return M.box(M.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]))},M.stsd=function(w){return w.type==="audio"?w.segmentCodec==="mp3"&&w.codec==="mp3"?M.box(M.types.stsd,M.STSD,M.mp3(w)):M.box(M.types.stsd,M.STSD,M.mp4a(w)):M.box(M.types.stsd,M.STSD,M.avc1(w))},M.tkhd=function(w){var I=w.id,k=w.duration*w.timescale,x=w.width,D=w.height,R=Math.floor(k/(F+1)),O=Math.floor(k%(F+1));return M.box(M.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,I>>24&255,I>>16&255,I>>8&255,I&255,0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255,O>>24,O>>16&255,O>>8&255,O&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,x>>8&255,x&255,0,0,D>>8&255,D&255,0,0]))},M.traf=function(w,I){var k=M.sdtp(w),x=w.id,D=Math.floor(I/(F+1)),R=Math.floor(I%(F+1));return M.box(M.types.traf,M.box(M.types.tfhd,new Uint8Array([0,0,0,0,x>>24,x>>16&255,x>>8&255,x&255])),M.box(M.types.tfdt,new Uint8Array([1,0,0,0,D>>24,D>>16&255,D>>8&255,D&255,R>>24,R>>16&255,R>>8&255,R&255])),M.trun(w,k.length+16+20+8+16+8+8),k)},M.trak=function(w){return w.duration=w.duration||4294967295,M.box(M.types.trak,M.tkhd(w),M.mdia(w))},M.trex=function(w){var I=w.id;return M.box(M.types.trex,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,I&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},M.trun=function(w,I){var k=w.samples||[],x=k.length,D=12+16*x,R=new Uint8Array(D),O,C,E,u,l,c;for(I+=8+D,R.set([w.type==="video"?1:0,0,15,1,x>>>24&255,x>>>16&255,x>>>8&255,x&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255],0),O=0;O<x;O++)C=k[O],E=C.duration,u=C.size,l=C.flags,c=C.cts,R.set([E>>>24&255,E>>>16&255,E>>>8&255,E&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.paddingValue<<1|l.isNonSync,l.degradPrio&61440,l.degradPrio&15,c>>>24&255,c>>>16&255,c>>>8&255,c&255],12+16*O);return M.box(M.types.trun,R)},M.initSegment=function(w){M.types||M.init();var I=M.moov(w),k=new Uint8Array(M.FTYP.byteLength+I.byteLength);return k.set(M.FTYP),k.set(I,M.FTYP.byteLength),k},M})();T.types=void 0,T.HDLR_TYPES=void 0,T.STTS=void 0,T.STSC=void 0,T.STCO=void 0,T.STSZ=void 0,T.VMHD=void 0,T.SMHD=void 0,T.STSD=void 0,T.FTYP=void 0,T.DINF=void 0;const N=T}),"./src/remux/mp4-remuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>u,flushTextTrackMetadataCueSamples:()=>d,flushTextTrackUserdataCueSamples:()=>o,normalizePts:()=>l});var F=h("./src/polyfills/number.ts"),T=h("./src/remux/aac-helper.ts"),N=h("./src/remux/mp4-generator.ts"),M=h("./src/events.ts"),U=h("./src/errors.ts"),w=h("./src/utils/logger.ts"),I=h("./src/types/loader.ts"),k=h("./src/utils/timescale-conversion.ts");function x(){return x=Object.assign?Object.assign.bind():function(v){for(var m=1;m<arguments.length;m++){var _=arguments[m];for(var g in _)Object.prototype.hasOwnProperty.call(_,g)&&(v[g]=_[g])}return v},x.apply(this,arguments)}var D=10*1e3,R=1024,O=1152,C=null,E=null,u=(function(){function v(_,g,A,y){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=_,this.config=g,this.typeSupported=A,this.ISGenerated=!1,C===null){var p=navigator.userAgent||"",b=p.match(/Chrome\/(\d+)/i);C=b?parseInt(b[1]):0}if(E===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);E=P?parseInt(P[1]):0}}var m=v.prototype;return m.destroy=function(){},m.resetTimeStamp=function(g){w.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=g},m.resetNextTimestamp=function(){w.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},m.resetInitSegment=function(){w.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},m.getVideoStartPts=function(g){var A=!1,y=g.reduce(function(p,b){var P=b.pts-p;return P<-4294967296?(A=!0,l(p,b.pts)):P>0?p:b.pts},g[0].pts);return A&&w.logger.debug("PTS rollover detected"),y},m.remux=function(g,A,y,p,b,P,B,V){var W,j,$,Q,Z,ee,se=b,Y=b,X=g.pid>-1,q=A.pid>-1,re=A.samples.length,te=g.samples.length>0,ne=B&&re>0||re>1,K=(!X||te)&&(!q||ne)||this.ISGenerated||B;if(K){this.ISGenerated||($=this.generateIS(g,A,b));var H=this.isVideoContiguous,z=-1,J;if(ne&&(z=c(A.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(ee=!0,z>0){w.logger.warn("[mp4-remuxer]: Dropped "+z+" out of "+re+" video samples due to a missing keyframe");var ae=this.getVideoStartPts(A.samples);A.samples=A.samples.slice(z),A.dropped+=z,Y+=(A.samples[0].pts-ae)/A.inputTimeScale,J=Y}else z===-1&&(w.logger.warn("[mp4-remuxer]: No keyframe found out of "+re+" video samples"),ee=!1);if(this.ISGenerated){if(te&&ne){var ie=this.getVideoStartPts(A.samples),le=l(g.samples[0].pts,ie)-ie,oe=le/A.inputTimeScale;se+=Math.max(0,oe),Y+=Math.max(0,-oe)}if(te){if(g.samplerate||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),$=this.generateIS(g,A,b)),j=this.remuxAudio(g,se,this.isAudioContiguous,P,q||ne||V===I.PlaylistLevelType.AUDIO?Y:void 0),ne){var ce=j?j.endPTS-j.startPTS:0;A.inputTimeScale||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),$=this.generateIS(g,A,b)),W=this.remuxVideo(A,Y,H,ce)}}else ne&&(W=this.remuxVideo(A,Y,H,0));W&&(W.firstKeyFrame=z,W.independent=z!==-1,W.firstKeyFramePTS=J)}}return this.ISGenerated&&(y.samples.length&&(Z=d(y,b,this._initPTS,this._initDTS)),p.samples.length&&(Q=o(p,b,this._initPTS))),{audio:j,video:W,initSegment:$,independent:ee,text:Q,id3:Z}},m.generateIS=function(g,A,y){var p=g.samples,b=A.samples,P=this.typeSupported,B={},V=!(0,F.isFiniteNumber)(this._initPTS),W="audio/mp4",j,$,Q;if(V&&(j=$=1/0),g.config&&p.length&&(g.timescale=g.samplerate,g.segmentCodec==="mp3"&&(P.mpeg?(W="audio/mpeg",g.codec=""):P.mp3&&(g.codec="mp3")),B.audio={id:"audio",container:W,codec:g.codec,initSegment:g.segmentCodec==="mp3"&&P.mpeg?new Uint8Array(0):N.default.initSegment([g]),metadata:{channelCount:g.channelCount}},V&&(Q=g.inputTimeScale,j=$=p[0].pts-Math.round(Q*y))),A.sps&&A.pps&&b.length&&(A.timescale=A.inputTimeScale,B.video={id:"main",container:"video/mp4",codec:A.codec,initSegment:N.default.initSegment([A]),metadata:{width:A.width,height:A.height}},V)){Q=A.inputTimeScale;var Z=this.getVideoStartPts(b),ee=Math.round(Q*y);$=Math.min($,l(b[0].dts,Z)-ee),j=Math.min(j,Z-ee)}if(Object.keys(B).length)return this.ISGenerated=!0,V&&(this._initPTS=j,this._initDTS=$),{tracks:B,initPTS:j,timescale:Q}},m.remuxVideo=function(g,A,y,p){var b=g.inputTimeScale,P=g.samples,B=[],V=P.length,W=this._initPTS,j=this.nextAvcDts,$=8,Q=this.videoSampleDuration,Z,ee,se=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,X=!1;if(!y||j===null){var q=A*b,re=P[0].pts-l(P[0].dts,P[0].pts);j=q-re}for(var te=0;te<V;te++){var ne=P[te];ne.pts=l(ne.pts-W,j),ne.dts=l(ne.dts-W,j),ne.dts<P[te>0?te-1:te].dts&&(X=!0)}X&&P.sort(function(In,Vi){var uo=In.dts-Vi.dts,co=In.pts-Vi.pts;return uo||co}),Z=P[0].dts,ee=P[P.length-1].dts;var K=ee-Z,H=K?Math.round(K/(V-1)):Q||g.inputTimeScale/30;if(y){var z=Z-j,J=z>H,ae=z<-1;if((J||ae)&&(J?w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)(z,!0)+" ms ("+z+"dts) hole between fragments detected, filling it"):w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)(-z,!0)+" ms ("+z+"dts) overlapping between fragments detected"),!ae||j>P[0].pts)){Z=j;var ie=P[0].pts-z;P[0].dts=Z,P[0].pts=ie,w.logger.log("Video: First PTS/DTS adjusted: "+(0,k.toMsFromMpegTsClock)(ie,!0)+"/"+(0,k.toMsFromMpegTsClock)(Z,!0)+", delta: "+(0,k.toMsFromMpegTsClock)(z,!0)+" ms")}}Z=Math.max(0,Z);for(var le=0,oe=0,ce=0;ce<V;ce++){for(var he=P[ce],de=he.units,pe=de.length,Ae=0,Pe=0;Pe<pe;Pe++)Ae+=de[Pe].data.length;oe+=Ae,le+=pe,he.length=Ae,he.dts=Math.max(he.dts,Z),se=Math.min(he.pts,se),Y=Math.max(he.pts,Y)}ee=P[V-1].dts;var De=oe+4*le+8,Me;try{Me=new Uint8Array(De)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:U.ErrorTypes.MUX_ERROR,details:U.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:De,reason:"fail allocating video mdat "+De});return}var He=new DataView(Me.buffer);He.setUint32(0,De),Me.set(N.default.types.mdat,4);for(var Ce=!1,we=Number.POSITIVE_INFINITY,Ie=Number.POSITIVE_INFINITY,Ne=Number.NEGATIVE_INFINITY,it=Number.NEGATIVE_INFINITY,Re=0;Re<V;Re++){for(var Ke=P[Re],Ze=Ke.units,Yt=0,$t=0,or=Ze.length;$t<or;$t++){var dt=Ze[$t],Dn=dt.data,zt=dt.data.byteLength;He.setUint32($,zt),$+=4,Me.set(Dn,$),$+=zt,Yt+=4+zt}var bt=void 0;if(Re<V-1)Q=P[Re+1].dts-Ke.dts,bt=P[Re+1].pts-Ke.pts;else{var lr=this.config,Xt=Re>0?Ke.dts-P[Re-1].dts:H;if(bt=Re>0?Ke.pts-P[Re-1].pts:H,lr.stretchShortVideoTrack&&this.nextAudioPts!==null){var Xr=Math.floor(lr.maxBufferHole*b),On=(p?se+p*b:this.nextAudioPts)-Ke.pts;On>Xr?(Q=On-Xt,Q<0?Q=Xt:Ce=!0,w.logger.log("[mp4-remuxer]: It is approximately "+On/90+" ms to the next segment; using duration "+Q/90+" ms for the last video frame.")):Q=Xt}else Q=Xt}var no=Math.round(Ke.pts-Ke.dts);we=Math.min(we,Q),Ne=Math.max(Ne,Q),Ie=Math.min(Ie,bt),it=Math.max(it,bt),B.push(new a(Ke.key,Q,Yt,no))}if(B.length){if(C){if(C<70){var Ui=B[0].flags;Ui.dependsOn=2,Ui.isNonSync=0}}else if(E&&it-Ie<Ne-we&&H/Ne<.025&&B[0].cts===0){w.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Pn=Z,st=0,Ki=B.length;st<Ki;st++){var Wi=Pn+B[st].duration,io=Pn+B[st].cts;if(st<Ki-1){var ao=Wi+B[st+1].cts;B[st].duration=ao-io}else B[st].duration=st?B[st-1].duration:H;B[st].cts=0,Pn=Wi}}}console.assert(Q!==null,"mp4SampleDuration must be computed"),Q=Ce||!Q?H:Q,this.nextAvcDts=j=ee+Q,this.videoSampleDuration=Q,this.isVideoContiguous=!0;var so=N.default.moof(g.sequenceNumber++,Z,x({},g,{samples:B})),oo="video",lo={data1:so,data2:Me,startPTS:se/b,endPTS:(Y+Q)/b,startDTS:Z/b,endDTS:j/b,type:oo,hasAudio:!1,hasVideo:!0,nb:B.length,dropped:g.dropped};return g.samples=[],g.dropped=0,console.assert(Me.length,"MDAT length must not be zero"),lo},m.remuxAudio=function(g,A,y,p,b){var P=g.inputTimeScale,B=g.samplerate?g.samplerate:P,V=P/B,W=g.segmentCodec==="aac"?R:O,j=W*V,$=this._initPTS,Q=g.segmentCodec==="mp3"&&this.typeSupported.mpeg,Z=[],ee=b!==void 0,se=g.samples,Y=Q?0:8,X=this.nextAudioPts||-1,q=A*P;if(this.isAudioContiguous=y=y||se.length&&X>0&&(p&&Math.abs(q-X)<9e3||Math.abs(l(se[0].pts-$,q)-X)<20*j),se.forEach(function(dt){dt.pts=l(dt.pts-$,q)}),!y||X<0){if(se=se.filter(function(dt){return dt.pts>=0}),!se.length)return;b===0?X=0:p&&!ee?X=Math.max(0,q):X=se[0].pts}if(g.segmentCodec==="aac")for(var re=this.config.maxAudioFramesDrift,te=0,ne=X;te<se.length;te++){var K=se[te],H=K.pts,z=H-ne,J=Math.abs(1e3*z/P);if(z<=-re*j&&ee)te===0&&(w.logger.warn("Audio frame @ "+(H/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*z/P)+" ms."),this.nextAudioPts=X=ne=H);else if(z>=re*j&&J<D&&ee){var ae=Math.round(z/j);ne=H-ae*j,ne<0&&(ae--,ne+=j),te===0&&(this.nextAudioPts=X=ne),w.logger.warn("[mp4-remuxer]: Injecting "+ae+" audio frame @ "+(ne/P).toFixed(3)+"s due to "+Math.round(1e3*z/P)+" ms gap.");for(var ie=0;ie<ae;ie++){var le=Math.max(ne,0),oe=T.default.getSilentFrame(g.manifestCodec||g.codec,g.channelCount);oe||(w.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=K.unit.subarray()),se.splice(te,0,{unit:oe,pts:le}),ne+=j,te++}}K.pts=ne,ne+=j}for(var ce=null,he=null,de,pe=0,Ae=se.length;Ae--;)pe+=se[Ae].unit.byteLength;for(var Pe=0,De=se.length;Pe<De;Pe++){var Me=se[Pe],He=Me.unit,Ce=Me.pts;if(he!==null){var we=Z[Pe-1];we.duration=Math.round((Ce-he)/V)}else if(y&&g.segmentCodec==="aac"&&(Ce=X),ce=Ce,pe>0){pe+=Y;try{de=new Uint8Array(pe)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:U.ErrorTypes.MUX_ERROR,details:U.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:pe,reason:"fail allocating audio mdat "+pe});return}if(!Q){var Ie=new DataView(de.buffer);Ie.setUint32(0,pe),de.set(N.default.types.mdat,4)}}else return;de.set(He,Y);var Ne=He.byteLength;Y+=Ne,Z.push(new a(!0,W,Ne,0)),he=Ce}var it=Z.length;if(it){var Re=Z[Z.length-1];this.nextAudioPts=X=he+V*Re.duration;var Ke=Q?new Uint8Array(0):N.default.moof(g.sequenceNumber++,ce/V,x({},g,{samples:Z}));g.samples=[];var Ze=ce/P,Yt=X/P,$t="audio",or={data1:Ke,data2:de,startPTS:Ze,endPTS:Yt,startDTS:Ze,endDTS:Yt,type:$t,hasAudio:!0,hasVideo:!1,nb:it};return this.isAudioContiguous=!0,console.assert(de.length,"MDAT length must not be zero"),or}},m.remuxEmptyAudio=function(g,A,y,p){var b=g.inputTimeScale,P=g.samplerate?g.samplerate:b,B=b/P,V=this.nextAudioPts,W=(V!==null?V:p.startDTS*b)+this._initDTS,j=p.endDTS*b+this._initDTS,$=B*R,Q=Math.ceil((j-W)/$),Z=T.default.getSilentFrame(g.manifestCodec||g.codec,g.channelCount);if(w.logger.warn("[mp4-remuxer]: remux empty Audio"),!Z){w.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var ee=[],se=0;se<Q;se++){var Y=W+se*$;ee.push({unit:Z,pts:Y,dts:Y})}return g.samples=ee,this.remuxAudio(g,A,y,!1)},v})();function l(v,m){var _;if(m===null)return v;for(m<v?_=-8589934592:_=8589934592;Math.abs(v-m)>4294967296;)v+=_;return v}function c(v){for(var m=0;m<v.length;m++)if(v[m].key)return m;return-1}function d(v,m,_,g){var A=v.samples.length;if(A){for(var y=v.inputTimeScale,p=0;p<A;p++){var b=v.samples[p];b.pts=l(b.pts-_,m*y)/y,b.dts=l(b.dts-g,m*y)/y}var P=v.samples;return v.samples=[],{samples:P}}}function o(v,m,_){var g=v.samples.length;if(g){for(var A=v.inputTimeScale,y=0;y<g;y++){var p=v.samples[y];p.pts=l(p.pts-_,m*A)/A}v.samples.sort(function(P,B){return P.pts-B.pts});var b=v.samples;return v.samples=[],{samples:b}}}var a=function(m,_,g,A){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=_,this.size=g,this.cts=A,this.flags=new s(m)},s=function(m){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=m?2:1,this.isNonSync=m?0:1}}),"./src/remux/passthrough-remuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>k});var F=h("./src/polyfills/number.ts"),T=h("./src/remux/mp4-remuxer.ts"),N=h("./src/utils/mp4-tools.ts"),M=h("./src/loader/fragment.ts"),U=h("./src/utils/logger.ts"),w=(function(){function x(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var D=x.prototype;return D.destroy=function(){},D.resetTimeStamp=function(O){this.initPTS=O,this.lastEndTime=null},D.resetNextTimestamp=function(){this.lastEndTime=null},D.resetInitSegment=function(O,C,E){this.audioCodec=C,this.videoCodec=E,this.generateInitSegment(O),this.emitInitSegment=!0},D.generateInitSegment=function(O){var C=this.audioCodec,E=this.videoCodec;if(!O||!O.byteLength){this.initTracks=void 0,this.initData=void 0;return}var u=this.initData=(0,N.parseInitSegment)(O);C||(C=I(u.audio,M.ElementaryStreamTypes.AUDIO)),E||(E=I(u.video,M.ElementaryStreamTypes.VIDEO));var l={};u.audio&&u.video?l.audiovideo={container:"video/mp4",codec:C+","+E,initSegment:O,id:"main"}:u.audio?l.audio={container:"audio/mp4",codec:C,initSegment:O,id:"audio"}:u.video?l.video={container:"video/mp4",codec:E,initSegment:O,id:"main"}:U.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=l},D.remux=function(O,C,E,u,l){var c,d=this.initPTS,o=this.lastEndTime,a={audio:void 0,video:void 0,text:u,id3:E,initSegment:void 0};(0,F.isFiniteNumber)(o)||(o=this.lastEndTime=l||0);var s=C.samples;if(!s||!s.length)return a;var v={initPTS:void 0,timescale:1},m=this.initData;if((!m||!m.length)&&(this.generateInitSegment(s),m=this.initData),!m||!m.length)return U.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),a;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);var _=(0,N.getStartDTS)(m,s);(0,F.isFiniteNumber)(d)||(this.initPTS=v.initPTS=d=_-l);var g=(0,N.getDuration)(s,m),A=O?_-d:o,y=A+g;(0,N.offsetStartDTS)(m,s,d),g>0?this.lastEndTime=y:(U.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var p=!!m.audio,b=!!m.video,P="";p&&(P+="audio"),b&&(P+="video");var B={data1:s,startPTS:A,startDTS:A,endPTS:y,endDTS:y,type:P,hasAudio:p,hasVideo:b,nb:1,dropped:0};a.audio=B.type==="audio"?B:void 0,a.video=B.type!=="audio"?B:void 0,a.initSegment=v;var V=(c=this.initPTS)!=null?c:0;return a.id3=(0,T.flushTextTrackMetadataCueSamples)(E,l,V,V),u.samples.length&&(a.text=(0,T.flushTextTrackUserdataCueSamples)(u,l,V)),a},x})();function I(x,D){var R=x?.codec;return R&&R.length>4?R:R==="hvc1"||R==="hev1"?"hvc1.1.c.L120.90":R==="av01"?"av01.0.04M.08":R==="avc1"||D===M.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const k=w}),"./src/task-loop.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});var F=(function(){function T(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var N=T.prototype;return N.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},N.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},N.onHandlerDestroyed=function(){},N.hasInterval=function(){return!!this._tickInterval},N.hasNextTick=function(){return!!this._tickTimer},N.setInterval=function(U){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,U),!0)},N.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},N.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},N.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},N.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},N.doTick=function(){},T})()}),"./src/types/cmcd.ts":((S,L,h)=>{h.r(L),h.d(L,{CMCDObjectType:()=>T,CMCDStreamType:()=>M,CMCDStreamingFormat:()=>N,CMCDVersion:()=>F});var F=1,T;(function(U){U.MANIFEST="m",U.AUDIO="a",U.VIDEO="v",U.MUXED="av",U.INIT="i",U.CAPTION="c",U.TIMED_TEXT="tt",U.KEY="k",U.OTHER="o"})(T||(T={}));var N;(function(U){U.DASH="d",U.HLS="h",U.SMOOTH="s",U.OTHER="o"})(N||(N={}));var M;(function(U){U.VOD="v",U.LIVE="l"})(M||(M={}))}),"./src/types/demuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{MetadataSchema:()=>F});var F;(function(T){T.audioId3="org.id3",T.dateRange="com.apple.quicktime.HLS",T.emsg="https://aomedia.org/emsg/ID3"})(F||(F={}))}),"./src/types/level.ts":((S,L,h)=>{h.r(L),h.d(L,{HlsSkip:()=>N,HlsUrlParameters:()=>U,Level:()=>w,getSkipValue:()=>M});function F(I,k){for(var x=0;x<k.length;x++){var D=k[x];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(I,D.key,D)}}function T(I,k,x){return k&&F(I.prototype,k),Object.defineProperty(I,"prototype",{writable:!1}),I}var N;(function(I){I.No="",I.Yes="YES",I.v2="v2"})(N||(N={}));function M(I,k){var x=I.canSkipUntil,D=I.canSkipDateRanges,R=I.endSN,O=k!==void 0?k-R:0;return x&&O<x?D?N.v2:N.Yes:N.No}var U=(function(){function I(x,D,R){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=x,this.part=D,this.skip=R}var k=I.prototype;return k.addDirectives=function(D){var R=new self.URL(D);return this.msn!==void 0&&R.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&R.searchParams.set("_HLS_part",this.part.toString()),this.skip&&R.searchParams.set("_HLS_skip",this.skip),R.toString()},I})(),w=(function(){function I(k){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[k.url],this.attrs=k.attrs,this.bitrate=k.bitrate,k.details&&(this.details=k.details),this.id=k.id||0,this.name=k.name,this.width=k.width||0,this.height=k.height||0,this.audioCodec=k.audioCodec,this.videoCodec=k.videoCodec,this.unknownCodecs=k.unknownCodecs,this.codecSet=[k.videoCodec,k.audioCodec].filter(function(x){return x}).join(",").replace(/\.[^.,]+/g,"")}return T(I,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(x){var D=x%this.url.length;this._urlId!==D&&(this.details=void 0,this._urlId=D)}}]),I})()}),"./src/types/loader.ts":((S,L,h)=>{h.r(L),h.d(L,{PlaylistContextType:()=>F,PlaylistLevelType:()=>T});var F;(function(N){N.MANIFEST="manifest",N.LEVEL="level",N.AUDIO_TRACK="audioTrack",N.SUBTITLE_TRACK="subtitleTrack"})(F||(F={}));var T;(function(N){N.MAIN="main",N.AUDIO="audio",N.SUBTITLE="subtitle"})(T||(T={}))}),"./src/types/transmuxer.ts":((S,L,h)=>{h.r(L),h.d(L,{ChunkMetadata:()=>F});var F=function(M,U,w,I,k,x){I===void 0&&(I=0),k===void 0&&(k=-1),x===void 0&&(x=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=T(),this.buffering={audio:T(),video:T(),audiovideo:T()},this.level=M,this.sn=U,this.id=w,this.size=I,this.part=k,this.partial=x};function T(){return{start:0,executeStart:0,executeEnd:0,end:0}}}),"./src/utils/attr-list.ts":((S,L,h)=>{h.r(L),h.d(L,{AttrList:()=>N});var F=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,N=(function(){function M(w){typeof w=="string"&&(w=M.parseAttrList(w));for(var I in w)w.hasOwnProperty(I)&&(this[I]=w[I])}var U=M.prototype;return U.decimalInteger=function(I){var k=parseInt(this[I],10);return k>Number.MAX_SAFE_INTEGER?1/0:k},U.hexadecimalInteger=function(I){if(this[I]){var k=(this[I]||"0x").slice(2);k=(k.length&1?"0":"")+k;for(var x=new Uint8Array(k.length/2),D=0;D<k.length/2;D++)x[D]=parseInt(k.slice(D*2,D*2+2),16);return x}else return null},U.hexadecimalIntegerAsNumber=function(I){var k=parseInt(this[I],16);return k>Number.MAX_SAFE_INTEGER?1/0:k},U.decimalFloatingPoint=function(I){return parseFloat(this[I])},U.optionalFloat=function(I,k){var x=this[I];return x?parseFloat(x):k},U.enumeratedString=function(I){return this[I]},U.bool=function(I){return this[I]==="YES"},U.decimalResolution=function(I){var k=F.exec(this[I]);if(k!==null)return{width:parseInt(k[1],10),height:parseInt(k[2],10)}},M.parseAttrList=function(I){var k,x={},D='"';for(T.lastIndex=0;(k=T.exec(I))!==null;){var R=k[2];R.indexOf(D)===0&&R.lastIndexOf(D)===R.length-1&&(R=R.slice(1,-1)),x[k[1]]=R}return x},M})()}),"./src/utils/binary-search.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>T});var F={search:function(M,U){for(var w=0,I=M.length-1,k=null,x=null;w<=I;){k=(w+I)/2|0,x=M[k];var D=U(x);if(D>0)w=k+1;else if(D<0)I=k-1;else return x}return null}};const T=F}),"./src/utils/buffer-helper.ts":((S,L,h)=>{h.r(L),h.d(L,{BufferHelper:()=>N});var F=h("./src/utils/logger.ts"),T={length:0,start:function(){return 0},end:function(){return 0}},N=(function(){function M(){}return M.isBuffered=function(w,I){try{if(w){for(var k=M.getBuffered(w),x=0;x<k.length;x++)if(I>=k.start(x)&&I<=k.end(x))return!0}}catch{}return!1},M.bufferInfo=function(w,I,k){try{if(w){var x=M.getBuffered(w),D=[],R;for(R=0;R<x.length;R++)D.push({start:x.start(R),end:x.end(R)});return this.bufferedInfo(D,I,k)}}catch{}return{len:0,start:I,end:I,nextStart:void 0}},M.bufferedInfo=function(w,I,k){I=Math.max(0,I),w.sort(function(a,s){var v=a.start-s.start;return v||s.end-a.end});var x=[];if(k)for(var D=0;D<w.length;D++){var R=x.length;if(R){var O=x[R-1].end;w[D].start-O<k?w[D].end>O&&(x[R-1].end=w[D].end):x.push(w[D])}else x.push(w[D])}else x=w;for(var C=0,E,u=I,l=I,c=0;c<x.length;c++){var d=x[c].start,o=x[c].end;if(I+k>=d&&I<o)u=d,l=o,C=l-I;else if(I+k<d){E=d;break}}return{len:C,start:u||0,end:l||0,nextStart:E}},M.getBuffered=function(w){try{return w.buffered}catch(I){return F.logger.log("failed to get media.buffered",I),T}},M})()}),"./src/utils/cea-608-parser.ts":((S,L,h)=>{h.r(L),h.d(L,{CaptionScreen:()=>c,Row:()=>l,default:()=>m});var F=h("./src/utils/logger.ts"),T={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},N=function(g){var A=g;return T.hasOwnProperty(g)&&(A=T[g]),String.fromCharCode(A)},M=15,U=100,w={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},I={17:2,18:4,21:6,22:8,23:10,19:13,20:15},k={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},x={25:2,26:4,29:6,30:8,31:10,27:13,28:15},D=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],R;(function(_){_[_.ERROR=0]="ERROR",_[_.TEXT=1]="TEXT",_[_.WARNING=2]="WARNING",_[_.INFO=2]="INFO",_[_.DEBUG=3]="DEBUG",_[_.DATA=3]="DATA"})(R||(R={}));var O=(function(){function _(){this.time=null,this.verboseLevel=R.ERROR}var g=_.prototype;return g.log=function(y,p){this.verboseLevel>=y&&F.logger.log(this.time+" ["+y+"] "+p)},_})(),C=function(g){for(var A=[],y=0;y<g.length;y++)A.push(g[y].toString(16));return A},E=(function(){function _(A,y,p,b,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=A||"white",this.underline=y||!1,this.italics=p||!1,this.background=b||"black",this.flash=P||!1}var g=_.prototype;return g.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},g.setStyles=function(y){for(var p=["foreground","underline","italics","background","flash"],b=0;b<p.length;b++){var P=p[b];y.hasOwnProperty(P)&&(this[P]=y[P])}},g.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},g.equals=function(y){return this.foreground===y.foreground&&this.underline===y.underline&&this.italics===y.italics&&this.background===y.background&&this.flash===y.flash},g.copy=function(y){this.foreground=y.foreground,this.underline=y.underline,this.italics=y.italics,this.background=y.background,this.flash=y.flash},g.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},_})(),u=(function(){function _(A,y,p,b,P,B){this.uchar=void 0,this.penState=void 0,this.uchar=A||" ",this.penState=new E(y,p,b,P,B)}var g=_.prototype;return g.reset=function(){this.uchar=" ",this.penState.reset()},g.setChar=function(y,p){this.uchar=y,this.penState.copy(p)},g.setPenState=function(y){this.penState.copy(y)},g.equals=function(y){return this.uchar===y.uchar&&this.penState.equals(y.penState)},g.copy=function(y){this.uchar=y.uchar,this.penState.copy(y.penState)},g.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},_})(),l=(function(){function _(A){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var y=0;y<U;y++)this.chars.push(new u);this.logger=A,this.pos=0,this.currPenState=new E}var g=_.prototype;return g.equals=function(y){for(var p=!0,b=0;b<U;b++)if(!this.chars[b].equals(y.chars[b])){p=!1;break}return p},g.copy=function(y){for(var p=0;p<U;p++)this.chars[p].copy(y.chars[p])},g.isEmpty=function(){for(var y=!0,p=0;p<U;p++)if(!this.chars[p].isEmpty()){y=!1;break}return y},g.setCursor=function(y){this.pos!==y&&(this.pos=y),this.pos<0?(this.logger.log(R.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>U&&(this.logger.log(R.DEBUG,"Too large cursor position "+this.pos),this.pos=U)},g.moveCursor=function(y){var p=this.pos+y;if(y>1)for(var b=this.pos+1;b<p+1;b++)this.chars[b].setPenState(this.currPenState);this.setCursor(p)},g.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},g.insertChar=function(y){y>=144&&this.backSpace();var p=N(y);if(this.pos>=U){this.logger.log(R.ERROR,"Cannot insert "+y.toString(16)+" ("+p+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(p,this.currPenState),this.moveCursor(1)},g.clearFromPos=function(y){var p;for(p=y;p<U;p++)this.chars[p].reset()},g.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},g.clearToEndOfRow=function(){this.clearFromPos(this.pos)},g.getTextString=function(){for(var y=[],p=!0,b=0;b<U;b++){var P=this.chars[b].uchar;P!==" "&&(p=!1),y.push(P)}return p?"":y.join("")},g.setPenStyles=function(y){this.currPenState.setStyles(y);var p=this.chars[this.pos];p.setPenState(this.currPenState)},_})(),c=(function(){function _(A){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var y=0;y<M;y++)this.rows.push(new l(A));this.logger=A,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var g=_.prototype;return g.reset=function(){for(var y=0;y<M;y++)this.rows[y].clear();this.currRow=M-1},g.equals=function(y){for(var p=!0,b=0;b<M;b++)if(!this.rows[b].equals(y.rows[b])){p=!1;break}return p},g.copy=function(y){for(var p=0;p<M;p++)this.rows[p].copy(y.rows[p])},g.isEmpty=function(){for(var y=!0,p=0;p<M;p++)if(!this.rows[p].isEmpty()){y=!1;break}return y},g.backSpace=function(){var y=this.rows[this.currRow];y.backSpace()},g.clearToEndOfRow=function(){var y=this.rows[this.currRow];y.clearToEndOfRow()},g.insertChar=function(y){var p=this.rows[this.currRow];p.insertChar(y)},g.setPen=function(y){var p=this.rows[this.currRow];p.setPenStyles(y)},g.moveCursor=function(y){var p=this.rows[this.currRow];p.moveCursor(y)},g.setCursor=function(y){this.logger.log(R.INFO,"setCursor: "+y);var p=this.rows[this.currRow];p.setCursor(y)},g.setPAC=function(y){this.logger.log(R.INFO,"pacData = "+JSON.stringify(y));var p=y.row-1;if(this.nrRollUpRows&&p<this.nrRollUpRows-1&&(p=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==p){for(var b=0;b<M;b++)this.rows[b].clear();var P=this.currRow+1-this.nrRollUpRows,B=this.lastOutputScreen;if(B){var V=B.rows[P].cueStartTime,W=this.logger.time;if(V&&W!==null&&V<W)for(var j=0;j<this.nrRollUpRows;j++)this.rows[p-this.nrRollUpRows+j+1].copy(B.rows[P+j])}}this.currRow=p;var $=this.rows[this.currRow];if(y.indent!==null){var Q=y.indent,Z=Math.max(Q-1,0);$.setCursor(y.indent),y.color=$.chars[Z].penState.foreground}var ee={foreground:y.color,underline:y.underline,italics:y.italics,background:"black",flash:!1};this.setPen(ee)},g.setBkgData=function(y){this.logger.log(R.INFO,"bkgData = "+JSON.stringify(y)),this.backSpace(),this.setPen(y),this.insertChar(32)},g.setRollUpRows=function(y){this.nrRollUpRows=y},g.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(R.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(R.TEXT,this.getDisplayText());var y=this.currRow+1-this.nrRollUpRows,p=this.rows.splice(y,1)[0];p.clear(),this.rows.splice(this.currRow,0,p),this.logger.log(R.INFO,"Rolling up")},g.getDisplayText=function(y){y=y||!1;for(var p=[],b="",P=-1,B=0;B<M;B++){var V=this.rows[B].getTextString();V&&(P=B+1,y?p.push("Row "+P+": '"+V+"'"):p.push(V.trim()))}return p.length>0&&(y?b="["+p.join(" | ")+"]":b=p.join(`
`)),b},g.getTextAndFormat=function(){return this.rows},_})(),d=(function(){function _(A,y,p){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=A,this.outputFilter=y,this.mode=null,this.verbose=0,this.displayedMemory=new c(p),this.nonDisplayedMemory=new c(p),this.lastOutputScreen=new c(p),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=p}var g=_.prototype;return g.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},g.getHandler=function(){return this.outputFilter},g.setHandler=function(y){this.outputFilter=y},g.setPAC=function(y){this.writeScreen.setPAC(y)},g.setBkgData=function(y){this.writeScreen.setBkgData(y)},g.setMode=function(y){y!==this.mode&&(this.mode=y,this.logger.log(R.INFO,"MODE="+y),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=y)},g.insertChars=function(y){for(var p=0;p<y.length;p++)this.writeScreen.insertChar(y[p]);var b=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(R.INFO,b+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(R.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},g.ccRCL=function(){this.logger.log(R.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},g.ccBS=function(){this.logger.log(R.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},g.ccAOF=function(){},g.ccAON=function(){},g.ccDER=function(){this.logger.log(R.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},g.ccRU=function(y){this.logger.log(R.INFO,"RU("+y+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(y)},g.ccFON=function(){this.logger.log(R.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},g.ccRDC=function(){this.logger.log(R.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},g.ccTR=function(){this.logger.log(R.INFO,"TR"),this.setMode("MODE_TEXT")},g.ccRTD=function(){this.logger.log(R.INFO,"RTD"),this.setMode("MODE_TEXT")},g.ccEDM=function(){this.logger.log(R.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},g.ccCR=function(){this.logger.log(R.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},g.ccENM=function(){this.logger.log(R.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},g.ccEOC=function(){if(this.logger.log(R.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var y=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=y,this.writeScreen=this.nonDisplayedMemory,this.logger.log(R.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},g.ccTO=function(y){this.logger.log(R.INFO,"TO("+y+") - Tab Offset"),this.writeScreen.moveCursor(y)},g.ccMIDROW=function(y){var p={flash:!1};if(p.underline=y%2===1,p.italics=y>=46,p.italics)p.foreground="white";else{var b=Math.floor(y/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];p.foreground=P[b]}this.logger.log(R.INFO,"MIDROW: "+JSON.stringify(p)),this.writeScreen.setPen(p)},g.outputDataUpdate=function(y){y===void 0&&(y=!1);var p=this.logger.time;p!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=p:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,p,this.lastOutputScreen),y&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:p),this.lastOutputScreen.copy(this.displayedMemory))},g.cueSplitAtTime=function(y){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,y,this.displayedMemory),this.cueStartTime=y))},_})(),o=(function(){function _(A,y,p){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var b=new O;this.channels=[null,new d(A,y,b),new d(A+1,p,b)],this.cmdHistory=v(),this.logger=b}var g=_.prototype;return g.getHandler=function(y){return this.channels[y].getHandler()},g.setHandler=function(y,p){this.channels[y].setHandler(p)},g.addData=function(y,p){var b,P,B,V=!1;this.logger.time=y;for(var W=0;W<p.length;W+=2)if(P=p[W]&127,B=p[W+1]&127,!(P===0&&B===0)){if(this.logger.log(R.DATA,"["+C([p[W],p[W+1]])+"] -> ("+C([P,B])+")"),b=this.parseCmd(P,B),b||(b=this.parseMidrow(P,B)),b||(b=this.parsePAC(P,B)),b||(b=this.parseBackgroundAttributes(P,B)),!b&&(V=this.parseChars(P,B),V)){var j=this.currentChannel;if(j&&j>0){var $=this.channels[j];$.insertChars(V)}else this.logger.log(R.WARNING,"No channel found yet. TEXT-MODE?")}!b&&!V&&this.logger.log(R.WARNING,"Couldn't parse cleaned data "+C([P,B])+" orig: "+C([p[W],p[W+1]]))}},g.parseCmd=function(y,p){var b=this.cmdHistory,P=(y===20||y===28||y===21||y===29)&&p>=32&&p<=47,B=(y===23||y===31)&&p>=33&&p<=35;if(!(P||B))return!1;if(s(y,p,b))return a(null,null,b),this.logger.log(R.DEBUG,"Repeated command ("+C([y,p])+") is dropped"),!0;var V=y===20||y===21||y===23?1:2,W=this.channels[V];return y===20||y===21||y===28||y===29?p===32?W.ccRCL():p===33?W.ccBS():p===34?W.ccAOF():p===35?W.ccAON():p===36?W.ccDER():p===37?W.ccRU(2):p===38?W.ccRU(3):p===39?W.ccRU(4):p===40?W.ccFON():p===41?W.ccRDC():p===42?W.ccTR():p===43?W.ccRTD():p===44?W.ccEDM():p===45?W.ccCR():p===46?W.ccENM():p===47&&W.ccEOC():W.ccTO(p-32),a(y,p,b),this.currentChannel=V,!0},g.parseMidrow=function(y,p){var b=0;if((y===17||y===25)&&p>=32&&p<=47){if(y===17?b=1:b=2,b!==this.currentChannel)return this.logger.log(R.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[b];return P?(P.ccMIDROW(p),this.logger.log(R.DEBUG,"MIDROW ("+C([y,p])+")"),!0):!1}return!1},g.parsePAC=function(y,p){var b,P=this.cmdHistory,B=(y>=17&&y<=23||y>=25&&y<=31)&&p>=64&&p<=127,V=(y===16||y===24)&&p>=64&&p<=95;if(!(B||V))return!1;if(s(y,p,P))return a(null,null,P),!0;var W=y<=23?1:2;p>=64&&p<=95?b=W===1?w[y]:k[y]:b=W===1?I[y]:x[y];var j=this.channels[W];return j?(j.setPAC(this.interpretPAC(b,p)),a(y,p,P),this.currentChannel=W,!0):!1},g.interpretPAC=function(y,p){var b,P={color:null,italics:!1,indent:null,underline:!1,row:y};return p>95?b=p-96:b=p-64,P.underline=(b&1)===1,b<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(b/2)]:b<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((b-16)/2)*4,P},g.parseChars=function(y,p){var b,P=null,B=null;if(y>=25?(b=2,B=y-8):(b=1,B=y),B>=17&&B<=19){var V;B===17?V=p+80:B===18?V=p+112:V=p+144,this.logger.log(R.INFO,"Special char '"+N(V)+"' in channel "+b),P=[V]}else y>=32&&y<=127&&(P=p===0?[y]:[y,p]);if(P){var W=C(P);this.logger.log(R.DEBUG,"Char codes =  "+W.join(",")),a(y,p,this.cmdHistory)}return P},g.parseBackgroundAttributes=function(y,p){var b=(y===16||y===24)&&p>=32&&p<=47,P=(y===23||y===31)&&p>=45&&p<=47;if(!(b||P))return!1;var B,V={};y===16||y===24?(B=Math.floor((p-32)/2),V.background=D[B],p%2===1&&(V.background=V.background+"_semi")):p===45?V.background="transparent":(V.foreground="black",p===47&&(V.underline=!0));var W=y<=23?1:2,j=this.channels[W];return j.setBkgData(V),a(y,p,this.cmdHistory),!0},g.reset=function(){for(var y=0;y<Object.keys(this.channels).length;y++){var p=this.channels[y];p&&p.reset()}this.cmdHistory=v()},g.cueSplitAtTime=function(y){for(var p=0;p<this.channels.length;p++){var b=this.channels[p];b&&b.cueSplitAtTime(y)}},_})();function a(_,g,A){A.a=_,A.b=g}function s(_,g,A){return A.a===_&&A.b===g}function v(){return{a:null,b:null}}const m=o}),"./src/utils/codecs.ts":((S,L,h)=>{h.r(L),h.d(L,{isCodecSupportedInMp4:()=>N,isCodecType:()=>T});var F={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function T(M,U){var w=F[U];return!!w&&w[M.slice(0,4)]===!0}function N(M,U){return MediaSource.isTypeSupported((U||"video")+'/mp4;codecs="'+M+'"')}}),"./src/utils/cues.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>w});var F=h("./src/utils/vttparser.ts"),T=h("./src/utils/webvtt-parser.ts"),N=h("./src/utils/texttrack-utils.ts"),M=/\s/,U={newCue:function(k,x,D,R){for(var O=[],C,E,u,l,c,d=self.VTTCue||self.TextTrackCue,o=0;o<R.rows.length;o++)if(C=R.rows[o],u=!0,l=0,c="",!C.isEmpty()){for(var a=0;a<C.chars.length;a++)M.test(C.chars[a].uchar)&&u?l++:(c+=C.chars[a].uchar,u=!1);C.cueStartTime=x,x===D&&(D+=1e-4),l>=16?l--:l++;var s=(0,F.fixLineBreaks)(c.trim()),v=(0,T.generateCueId)(x,D,s);(!k||!k.cues||!k.cues.getCueById(v))&&(E=new d(x,D,s),E.id=v,E.line=o+1,E.align="left",E.position=10+Math.min(80,Math.floor(l*8/32)*10),O.push(E))}return k&&O.length&&(O.sort(function(m,_){return m.line==="auto"||_.line==="auto"?0:m.line>8&&_.line>8?_.line-m.line:m.line-_.line}),O.forEach(function(m){return(0,N.addCueToTrack)(k,m)})),O}};const w=U}),"./src/utils/discontinuities.ts":((S,L,h)=>{h.r(L),h.d(L,{adjustSlidingStart:()=>k,alignMediaPlaylistByPDT:()=>O,alignPDT:()=>R,alignStream:()=>x,findDiscontinuousReferenceFrag:()=>w,findFirstFragWithCC:()=>M,shouldAlignOnDiscontinuities:()=>U});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/logger.ts"),N=h("./src/controller/level-helper.ts");function M(C,E){for(var u=null,l=0,c=C.length;l<c;l++){var d=C[l];if(d&&d.cc===E){u=d;break}}return u}function U(C,E,u){return!!(E.details&&(u.endCC>u.startCC||C&&C.cc<u.startCC))}function w(C,E,u){var l=C.fragments,c=E.fragments;if(!c.length||!l.length){T.logger.log("No fragments to align");return}var d=M(l,c[0].cc);if(!d||d&&!d.startPTS){T.logger.log("No frag in previous level to align on");return}return d}function I(C,E){if(C){var u=C.start+E;C.start=C.startPTS=u,C.endPTS=u+C.duration}}function k(C,E){for(var u=E.fragments,l=0,c=u.length;l<c;l++)I(u[l],C);E.fragmentHint&&I(E.fragmentHint,C),E.alignedSliding=!0}function x(C,E,u){E&&(D(C,u,E),!u.alignedSliding&&E.details&&R(u,E.details),!u.alignedSliding&&E.details&&!u.skippedSegments&&(0,N.adjustSliding)(E.details,u))}function D(C,E,u){if(U(C,u,E)){var l=w(u.details,E);l&&(0,F.isFiniteNumber)(l.start)&&(T.logger.log("Adjusting PTS using last level due to CC increase within current level "+E.url),k(l.start,E))}}function R(C,E){if(!(!E.fragments.length||!C.hasProgramDateTime||!E.hasProgramDateTime)){var u=E.fragments[0].programDateTime,l=C.fragments[0].programDateTime,c=(l-u)/1e3+E.fragments[0].start;c&&(0,F.isFiniteNumber)(c)&&(T.logger.log("Adjusting PTS using programDateTime delta "+(l-u)+"ms, sliding:"+c.toFixed(3)+" "+C.url+" "),k(c,C))}}function O(C,E){if(!(!C.hasProgramDateTime||!E.hasProgramDateTime)){var u=C.fragments,l=E.fragments;if(!(!u.length||!l.length)){var c=Math.round(l.length/2)-1,d=l[c],o=M(u,d.cc)||u[Math.round(u.length/2)-1],a=d.programDateTime,s=o.programDateTime;if(!(a===null||s===null)){var v=(s-a)/1e3-(o.start-d.start);k(v,C)}}}}}),"./src/utils/ewma-bandwidth-estimator.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>N});var F=h("./src/utils/ewma.ts"),T=(function(){function M(w,I,k){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=k,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new F.default(w),this.fast_=new F.default(I)}var U=M.prototype;return U.update=function(I,k){var x=this.slow_,D=this.fast_;this.slow_.halfLife!==I&&(this.slow_=new F.default(I,x.getEstimate(),x.getTotalWeight())),this.fast_.halfLife!==k&&(this.fast_=new F.default(k,D.getEstimate(),D.getTotalWeight()))},U.sample=function(I,k){I=Math.max(I,this.minDelayMs_);var x=8*k,D=I/1e3,R=x/D;this.fast_.sample(D,R),this.slow_.sample(D,R)},U.canEstimate=function(){var I=this.fast_;return I&&I.getTotalWeight()>=this.minWeight_},U.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},U.destroy=function(){},M})();const N=T}),"./src/utils/ewma.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>T});var F=(function(){function N(U,w,I){w===void 0&&(w=0),I===void 0&&(I=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=U,this.alpha_=U?Math.exp(Math.log(.5)/U):0,this.estimate_=w,this.totalWeight_=I}var M=N.prototype;return M.sample=function(w,I){var k=Math.pow(this.alpha_,w);this.estimate_=I*(1-k)+k*this.estimate_,this.totalWeight_+=w},M.getTotalWeight=function(){return this.totalWeight_},M.getEstimate=function(){if(this.alpha_){var w=1-Math.pow(this.alpha_,this.totalWeight_);if(w)return this.estimate_/w}return this.estimate_},N})();const T=F}),"./src/utils/fetch-loader.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>c,fetchSupported:()=>O});var F=h("./src/polyfills/number.ts"),T=h("./src/loader/load-stats.ts"),N=h("./src/demux/chunk-cache.ts");function M(d,o){d.prototype=Object.create(o.prototype),d.prototype.constructor=d,x(d,o)}function U(d){var o=typeof Map=="function"?new Map:void 0;return U=function(s){if(s===null||!k(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(s))return o.get(s);o.set(s,v)}function v(){return w(s,arguments,D(this).constructor)}return v.prototype=Object.create(s.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),x(v,s)},U(d)}function w(d,o,a){return I()?w=Reflect.construct.bind():w=function(v,m,_){var g=[null];g.push.apply(g,m);var A=Function.bind.apply(v,g),y=new A;return _&&x(y,_.prototype),y},w.apply(null,arguments)}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k(d){return Function.toString.call(d).indexOf("[native code]")!==-1}function x(d,o){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,v){return s.__proto__=v,s},x(d,o)}function D(d){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},D(d)}function R(){return R=Object.assign?Object.assign.bind():function(d){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(d[s]=a[s])}return d},R.apply(this,arguments)}function O(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var C=(function(){function d(a){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=a.fetchSetup||u,this.controller=new self.AbortController,this.stats=new T.LoadStats}var o=d.prototype;return o.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function(){var s=this.response;(!s||!s.ok)&&(this.stats.aborted=!0,this.controller.abort())},o.abort=function(){var s;this.abortInternal(),(s=this.callbacks)!==null&&s!==void 0&&s.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function(s,v,m){var _=this,g=this.stats;if(g.loading.start)throw new Error("Loader can only be used once.");g.loading.start=self.performance.now();var A=E(s,this.controller.signal),y=m.onProgress,p=s.responseType==="arraybuffer",b=p?"byteLength":"length";this.context=s,this.config=v,this.callbacks=m,this.request=this.fetchSetup(s,A),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){_.abortInternal(),m.onTimeout(g,s,_.response)},v.timeout),self.fetch(this.request).then(function(P){if(_.response=_.loader=P,!P.ok){var B=P.status,V=P.statusText;throw new l(V||"fetch, bad network response",B,P)}return g.loading.first=Math.max(self.performance.now(),g.loading.start),g.total=parseInt(P.headers.get("Content-Length")||"0"),y&&(0,F.isFiniteNumber)(v.highWaterMark)?_.loadProgressively(P,g,s,v.highWaterMark,y):p?P.arrayBuffer():P.text()}).then(function(P){var B=_.response;self.clearTimeout(_.requestTimeout),g.loading.end=Math.max(self.performance.now(),g.loading.first);var V=P[b];V&&(g.loaded=g.total=V);var W={url:B.url,data:P};y&&!(0,F.isFiniteNumber)(v.highWaterMark)&&y(g,s,P,B),m.onSuccess(W,g,s,B)}).catch(function(P){if(self.clearTimeout(_.requestTimeout),!g.aborted){var B=P&&P.code||0,V=P?P.message:null;m.onError({code:B,text:V},s,P?P.details:null)}})},o.getCacheAge=function(){var s=null;if(this.response){var v=this.response.headers.get("age");s=v?parseFloat(v):null}return s},o.loadProgressively=function(s,v,m,_,g){_===void 0&&(_=0);var A=new N.default,y=s.body.getReader(),p=function b(){return y.read().then(function(P){if(P.done)return A.dataLength&&g(v,m,A.flush(),s),Promise.resolve(new ArrayBuffer(0));var B=P.value,V=B.length;return v.loaded+=V,V<_||A.dataLength?(A.push(B),A.dataLength>=_&&g(v,m,A.flush(),s)):g(v,m,B,s),b()}).catch(function(){return Promise.reject()})};return p()},d})();function E(d,o){var a={method:"GET",mode:"cors",credentials:"same-origin",signal:o,headers:new self.Headers(R({},d.headers))};return d.rangeEnd&&a.headers.set("Range","bytes="+d.rangeStart+"-"+String(d.rangeEnd-1)),a}function u(d,o){return new self.Request(d.url,o)}var l=(function(d){M(o,d);function o(a,s,v){var m;return m=d.call(this,a)||this,m.code=void 0,m.details=void 0,m.code=s,m.details=v,m}return o})(U(Error));const c=C}),"./src/utils/imsc1-ttml-parser.ts":((S,L,h)=>{h.r(L),h.d(L,{IMSC1_CODEC:()=>k,parseIMSC1:()=>O});var F=h("./src/utils/mp4-tools.ts"),T=h("./src/utils/vttparser.ts"),N=h("./src/utils/vttcue.ts"),M=h("./src/demux/id3.ts"),U=h("./src/utils/timescale-conversion.ts"),w=h("./src/utils/webvtt-parser.ts");function I(){return I=Object.assign?Object.assign.bind():function(m){for(var _=1;_<arguments.length;_++){var g=arguments[_];for(var A in g)Object.prototype.hasOwnProperty.call(g,A)&&(m[A]=g[A])}return m},I.apply(this,arguments)}var k="stpp.ttml.im1t",x=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,D=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,R={left:"start",center:"center",right:"end",start:"start",end:"end"};function O(m,_,g,A,y){var p=(0,F.findBox)(new Uint8Array(m),["mdat"]);if(p.length===0){y(new Error("Could not parse IMSC1 mdat"));return}var b=p.map(function(B){return(0,M.utf8ArrayToStr)(B)}),P=(0,U.toTimescaleFromScale)(_,1,g);try{b.forEach(function(B){return A(C(B,P))})}catch(B){y(B)}}function C(m,_){var g=new DOMParser,A=g.parseFromString(m,"text/xml"),y=A.getElementsByTagName("tt")[0];if(!y)throw new Error("Invalid ttml");var p={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},b=Object.keys(p).reduce(function(j,$){return j[$]=y.getAttribute("ttp:"+$)||p[$],j},{}),P=y.getAttribute("xml:space")!=="preserve",B=u(E(y,"styling","style")),V=u(E(y,"layout","region")),W=E(y,"body","[begin]");return[].map.call(W,function(j){var $=l(j,P);if(!$||!j.hasAttribute("begin"))return null;var Q=a(j.getAttribute("begin"),b),Z=a(j.getAttribute("dur"),b),ee=a(j.getAttribute("end"),b);if(Q===null)throw o(j);if(ee===null){if(Z===null)throw o(j);ee=Q+Z}var se=new N.default(Q-_,ee-_,$);se.id=(0,w.generateCueId)(se.startTime,se.endTime,se.text);var Y=V[j.getAttribute("region")],X=B[j.getAttribute("style")];se.position=10,se.size=80;var q=c(Y,X,B),re=q.textAlign;if(re){var te=R[re];te&&(se.lineAlign=te),se.align=re}return I(se,q),se}).filter(function(j){return j!==null})}function E(m,_,g){var A=m.getElementsByTagName(_)[0];return A?[].slice.call(A.querySelectorAll(g)):[]}function u(m){return m.reduce(function(_,g){var A=g.getAttribute("xml:id");return A&&(_[A]=g),_},{})}function l(m,_){return[].slice.call(m.childNodes).reduce(function(g,A,y){var p;return A.nodeName==="br"&&y?g+`
`:(p=A.childNodes)!==null&&p!==void 0&&p.length?l(A,_):_?g+A.textContent.trim().replace(/\s+/g," "):g+A.textContent},"")}function c(m,_,g){var A="http://www.w3.org/ns/ttml#styling",y=null,p=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],b=m!=null&&m.hasAttribute("style")?m.getAttribute("style"):null;return b&&g.hasOwnProperty(b)&&(y=g[b]),p.reduce(function(P,B){var V=d(_,A,B)||d(m,A,B)||d(y,A,B);return V&&(P[B]=V),P},{})}function d(m,_,g){return m&&m.hasAttributeNS(_,g)?m.getAttributeNS(_,g):null}function o(m){return new Error("Could not parse ttml timestamp "+m)}function a(m,_){if(!m)return null;var g=(0,T.parseTimeStamp)(m);return g===null&&(x.test(m)?g=s(m,_):D.test(m)&&(g=v(m,_))),g}function s(m,_){var g=x.exec(m),A=(g[4]|0)+(g[5]|0)/_.subFrameRate;return(g[1]|0)*3600+(g[2]|0)*60+(g[3]|0)+A/_.frameRate}function v(m,_){var g=D.exec(m),A=Number(g[1]),y=g[2];switch(y){case"h":return A*3600;case"m":return A*60;case"ms":return A*1e3;case"f":return A/_.frameRate;case"t":return A/_.tickRate}return A}}),"./src/utils/logger.ts":((S,L,h)=>{h.r(L),h.d(L,{enableLogs:()=>w,logger:()=>I});var F=function(){},T={trace:F,debug:F,log:F,warn:F,info:F,error:F},N=T;function M(k){var x=self.console[k];return x?x.bind(self.console,"["+k+"] >"):F}function U(k){for(var x=arguments.length,D=new Array(x>1?x-1:0),R=1;R<x;R++)D[R-1]=arguments[R];D.forEach(function(O){N[O]=k[O]?k[O].bind(k):M(O)})}function w(k,x){if(self.console&&k===!0||typeof k=="object"){U(k,"debug","log","info","warn","error");try{N.log('Debug logs enabled for "'+x+'"')}catch{N=T}}else N=T}var I=N}),"./src/utils/mediakeys-helper.ts":((S,L,h)=>{h.r(L),h.d(L,{KeySystems:()=>F,requestMediaKeySystemAccess:()=>T});var F;(function(N){N.WIDEVINE="com.widevine.alpha",N.PLAYREADY="com.microsoft.playready"})(F||(F={}));var T=(function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})()}),"./src/utils/mediasource-helper.ts":((S,L,h)=>{h.r(L),h.d(L,{getMediaSource:()=>F});function F(){return self.MediaSource||self.WebKitMediaSource}}),"./src/utils/mp4-tools.ts":((S,L,h)=>{h.r(L),h.d(L,{RemuxerTrackIdConfig:()=>w,appendUint8Array:()=>a,bin2str:()=>I,computeRawDurationFromSamples:()=>c,discardEPB:()=>g,findBox:()=>O,getDuration:()=>l,getStartDTS:()=>u,offsetStartDTS:()=>d,parseEmsg:()=>A,parseInitSegment:()=>E,parseSEIMessageFromNALu:()=>_,parseSamples:()=>s,parseSegmentIndex:()=>C,readSint32:()=>D,readUint16:()=>k,readUint32:()=>x,segmentValidRange:()=>o,writeUint32:()=>R});var F=h("./src/utils/typed-array.ts"),T=h("./src/loader/fragment.ts"),N=h("./src/demux/id3.ts"),M=Math.pow(2,32)-1,U=[].push,w={video:1,audio:2,id3:3,text:4};function I(y){return String.fromCharCode.apply(null,y)}function k(y,p){var b=y[p]<<8|y[p+1];return b<0?65536+b:b}function x(y,p){var b=D(y,p);return b<0?4294967296+b:b}function D(y,p){return y[p]<<24|y[p+1]<<16|y[p+2]<<8|y[p+3]}function R(y,p,b){y[p]=b>>24,y[p+1]=b>>16&255,y[p+2]=b>>8&255,y[p+3]=b&255}function O(y,p){var b=[];if(!p.length)return b;for(var P=y.byteLength,B=0;B<P;){var V=x(y,B),W=I(y.subarray(B+4,B+8)),j=V>1?B+V:P;if(W===p[0])if(p.length===1)b.push(y.subarray(B+8,j));else{var $=O(y.subarray(B+8,j),p.slice(1));$.length&&U.apply(b,$)}B=j}return b}function C(y){var p=[],b=y[0],P=8,B=x(y,P);P+=4;var V=0,W=0;b===0?P+=8:P+=16,P+=2;var j=y.length+W,$=k(y,P);P+=2;for(var Q=0;Q<$;Q++){var Z=P,ee=x(y,Z);Z+=4;var se=ee&2147483647,Y=(ee&2147483648)>>>31;if(Y===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var X=x(y,Z);Z+=4,p.push({referenceSize:se,subsegmentDuration:X,info:{duration:X/B,start:j,end:j+se-1}}),j+=se,Z+=4,P=Z}return{earliestPresentationTime:V,timescale:B,version:b,referencesCount:$,references:p}}function E(y){for(var p=[],b=O(y,["moov","trak"]),P=0;P<b.length;P++){var B=b[P],V=O(B,["tkhd"])[0];if(V){var W=V[0],j=W===0?12:20,$=x(V,j),Q=O(B,["mdia","mdhd"])[0];if(Q){W=Q[0],j=W===0?12:20;var Z=x(Q,j),ee=O(B,["mdia","hdlr"])[0];if(ee){var se=I(ee.subarray(8,12)),Y={soun:T.ElementaryStreamTypes.AUDIO,vide:T.ElementaryStreamTypes.VIDEO}[se];if(Y){var X=O(B,["mdia","minf","stbl","stsd"])[0],q=void 0;X&&(q=I(X.subarray(12,16))),p[$]={timescale:Z,type:Y},p[Y]={timescale:Z,id:$,codec:q}}}}}}var re=O(y,["moov","mvex","trex"]);return re.forEach(function(te){var ne=x(te,4),K=p[ne];K&&(K.default={duration:x(te,12),flags:x(te,20)})}),p}function u(y,p){return O(p,["moof","traf"]).reduce(function(b,P){var B=O(P,["tfdt"])[0],V=B[0],W=O(P,["tfhd"]).reduce(function(j,$){var Q=x($,4),Z=y[Q];if(Z){var ee=x(B,4);V===1&&(ee*=Math.pow(2,32),ee+=x(B,8));var se=Z.timescale||9e4,Y=ee/se;if(isFinite(Y)&&(j===null||Y<j))return Y}return j},null);return W!==null&&isFinite(W)&&(b===null||W<b)?W:b},null)||0}function l(y,p){for(var b=0,P=0,B=0,V=O(y,["moof","traf"]),W=0;W<V.length;W++){var j=V[W],$=O(j,["tfhd"])[0],Q=x($,4),Z=p[Q];if(Z){var ee=Z.default,se=x($,0)|ee?.flags,Y=ee?.duration;se&8&&(se&2?Y=x($,12):Y=x($,8));for(var X=Z.timescale||9e4,q=O(j,["trun"]),re=0;re<q.length;re++){if(b=c(q[re]),!b&&Y){var te=x(q[re],4);b=Y*te}Z.type===T.ElementaryStreamTypes.VIDEO?P+=b/X:Z.type===T.ElementaryStreamTypes.AUDIO&&(B+=b/X)}}}if(P===0&&B===0){for(var ne=0,K=O(y,["sidx"]),H=0;H<K.length;H++){var z=C(K[H]);z!=null&&z.references&&(ne+=z.references.reduce(function(J,ae){return J+ae.info.duration||0},0))}return ne}return P||B}function c(y){var p=x(y,0),b=8;p&1&&(b+=4),p&4&&(b+=4);for(var P=0,B=x(y,4),V=0;V<B;V++){if(p&256){var W=x(y,b);P+=W,b+=4}p&512&&(b+=4),p&1024&&(b+=4),p&2048&&(b+=4)}return P}function d(y,p,b){O(p,["moof","traf"]).forEach(function(P){O(P,["tfhd"]).forEach(function(B){var V=x(B,4),W=y[V];if(W){var j=W.timescale||9e4;O(P,["tfdt"]).forEach(function($){var Q=$[0],Z=x($,4);if(Q===0)Z-=b*j,Z=Math.max(Z,0),R($,4,Z);else{Z*=Math.pow(2,32),Z+=x($,8),Z-=b*j,Z=Math.max(Z,0);var ee=Math.floor(Z/(M+1)),se=Math.floor(Z%(M+1));R($,4,ee),R($,8,se)}})}})})}function o(y){var p={valid:null,remainder:null},b=O(y,["moof"]);if(b){if(b.length<2)return p.remainder=y,p}else return p;var P=b[b.length-1];return p.valid=(0,F.sliceUint8)(y,0,P.byteOffset-8),p.remainder=(0,F.sliceUint8)(y,P.byteOffset-8),p}function a(y,p){var b=new Uint8Array(y.length+p.length);return b.set(y),b.set(p,y.length),b}function s(y,p){var b=[],P=p.samples,B=p.timescale,V=p.id,W=!1,j=O(P,["moof"]);return j.map(function($){var Q=$.byteOffset-8,Z=O($,["traf"]);Z.map(function(ee){var se=O(ee,["tfdt"]).map(function(Y){var X=Y[0],q=x(Y,4);return X===1&&(q*=Math.pow(2,32),q+=x(Y,8)),q/B})[0];return se!==void 0&&(y=se),O(ee,["tfhd"]).map(function(Y){var X=x(Y,4),q=x(Y,0)&16777215,re=(q&1)!==0,te=(q&2)!==0,ne=(q&8)!==0,K=0,H=(q&16)!==0,z=0,J=(q&32)!==0,ae=8;X===V&&(re&&(ae+=8),te&&(ae+=4),ne&&(K=x(Y,ae),ae+=4),H&&(z=x(Y,ae),ae+=4),J&&(ae+=4),p.type==="video"&&(W=v(p.codec)),O(ee,["trun"]).map(function(ie){var le=ie[0],oe=x(ie,0)&16777215,ce=(oe&1)!==0,he=0,de=(oe&4)!==0,pe=(oe&256)!==0,Ae=0,Pe=(oe&512)!==0,De=0,Me=(oe&1024)!==0,He=(oe&2048)!==0,Ce=0,we=x(ie,4),Ie=8;ce&&(he=x(ie,Ie),Ie+=4),de&&(Ie+=4);for(var Ne=he+Q,it=0;it<we;it++){if(pe?(Ae=x(ie,Ie),Ie+=4):Ae=K,Pe?(De=x(ie,Ie),Ie+=4):De=z,Me&&(Ie+=4),He&&(le===0?Ce=x(ie,Ie):Ce=D(ie,Ie),Ie+=4),p.type===T.ElementaryStreamTypes.VIDEO)for(var Re=0;Re<De;){var Ke=x(P,Ne);if(Ne+=4,m(W,P[Ne])){var Ze=P.subarray(Ne,Ne+Ke);_(Ze,W?2:1,y+Ce/B,b)}Ne+=Ke,Re+=Ke+4}y+=Ae/B}}))})})}),b}function v(y){if(!y)return!1;var p=y.indexOf("."),b=p<0?y:y.substring(0,p);return b==="hvc1"||b==="hev1"||b==="dvh1"||b==="dvhe"}function m(y,p){if(y){var b=p>>1&63;return b===39||b===40}else{var P=p&31;return P===6}}function _(y,p,b,P){var B=g(y),V=0;V+=p;for(var W=0,j=0,$=!1,Q=0;V<B.length;){W=0;do{if(V>=B.length)break;Q=B[V++],W+=Q}while(Q===255);j=0;do{if(V>=B.length)break;Q=B[V++],j+=Q}while(Q===255);var Z=B.length-V;if(!$&&W===4&&V<B.length){$=!0;var ee=B[V++];if(ee===181){var se=k(B,V);if(V+=2,se===49){var Y=x(B,V);if(V+=4,Y===1195456820){var X=B[V++];if(X===3){var q=B[V++],re=31&q,te=64&q,ne=te?2+re*3:0,K=new Uint8Array(ne);if(te){K[0]=q;for(var H=1;H<ne;H++)K[H]=B[V++]}P.push({type:X,payloadType:W,pts:b,bytes:K})}}}}}else if(W===5&&j<Z){if($=!0,j>16){for(var z=[],J=0;J<16;J++){var ae=B[V++].toString(16);z.push(ae.length==1?"0"+ae:ae),(J===3||J===5||J===7||J===9)&&z.push("-")}for(var ie=j-16,le=new Uint8Array(ie),oe=0;oe<ie;oe++)le[oe]=B[V++];P.push({payloadType:W,pts:b,uuid:z.join(""),userData:(0,N.utf8ArrayToStr)(le),userDataBytes:le})}}else if(j<Z)V+=j;else if(j>Z)break}}function g(y){for(var p=y.byteLength,b=[],P=1;P<p-2;)y[P]===0&&y[P+1]===0&&y[P+2]===3?(b.push(P+2),P+=2):P++;if(b.length===0)return y;var B=p-b.length,V=new Uint8Array(B),W=0;for(P=0;P<B;W++,P++)W===b[0]&&(W++,b.shift()),V[P]=y[W];return V}function A(y){var p=y[0],b="",P="",B=0,V=0,W=0,j=0,$=0,Q=0;if(p===0){for(;I(y.subarray(Q,Q+1))!=="\0";)b+=I(y.subarray(Q,Q+1)),Q+=1;for(b+=I(y.subarray(Q,Q+1)),Q+=1;I(y.subarray(Q,Q+1))!=="\0";)P+=I(y.subarray(Q,Q+1)),Q+=1;P+=I(y.subarray(Q,Q+1)),Q+=1,B=x(y,12),V=x(y,16),j=x(y,20),$=x(y,24),Q=28}else if(p===1){Q+=4,B=x(y,Q),Q+=4;var Z=x(y,Q);Q+=4;var ee=x(y,Q);for(Q+=4,W=Math.pow(2,32)*Z+ee,Number.isSafeInteger(W)||(W=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),j=x(y,Q),Q+=4,$=x(y,Q),Q+=4;I(y.subarray(Q,Q+1))!=="\0";)b+=I(y.subarray(Q,Q+1)),Q+=1;for(b+=I(y.subarray(Q,Q+1)),Q+=1;I(y.subarray(Q,Q+1))!=="\0";)P+=I(y.subarray(Q,Q+1)),Q+=1;P+=I(y.subarray(Q,Q+1)),Q+=1}var se=y.subarray(Q,y.byteLength);return{schemeIdUri:b,value:P,timeScale:B,presentationTime:W,presentationTimeDelta:V,eventDuration:j,id:$,payload:se}}}),"./src/utils/output-filter.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});var F=(function(){function T(M,U){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=U}var N=T.prototype;return N.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},N.newCue=function(U,w,I){(this.startTime===null||this.startTime>U)&&(this.startTime=U),this.endTime=w,this.screen=I,this.timelineController.createCaptionsTrack(this.trackName)},N.reset=function(){this.cueRanges=[],this.startTime=null},T})()}),"./src/utils/texttrack-utils.ts":((S,L,h)=>{h.r(L),h.d(L,{addCueToTrack:()=>N,clearCurrentCues:()=>M,getCuesInRange:()=>I,removeCuesInRange:()=>U,sendAddTrackEvent:()=>T});var F=h("./src/utils/logger.ts");function T(k,x){var D;try{D=new Event("addtrack")}catch{D=document.createEvent("Event"),D.initEvent("addtrack",!1,!1)}D.track=k,x.dispatchEvent(D)}function N(k,x){var D=k.mode;if(D==="disabled"&&(k.mode="hidden"),k.cues&&!k.cues.getCueById(x.id))try{if(k.addCue(x),!k.cues.getCueById(x.id))throw new Error("addCue is failed for: "+x)}catch(O){F.logger.debug("[texttrack-utils]: "+O);var R=new self.TextTrackCue(x.startTime,x.endTime,x.text);R.id=x.id,k.addCue(R)}D==="disabled"&&(k.mode=D)}function M(k){var x=k.mode;if(x==="disabled"&&(k.mode="hidden"),k.cues)for(var D=k.cues.length;D--;)k.removeCue(k.cues[D]);x==="disabled"&&(k.mode=x)}function U(k,x,D,R){var O=k.mode;if(O==="disabled"&&(k.mode="hidden"),k.cues&&k.cues.length>0)for(var C=I(k.cues,x,D),E=0;E<C.length;E++)(!R||R(C[E]))&&k.removeCue(C[E]);O==="disabled"&&(k.mode=O)}function w(k,x){if(x<k[0].startTime)return 0;var D=k.length-1;if(x>k[D].endTime)return-1;for(var R=0,O=D;R<=O;){var C=Math.floor((O+R)/2);if(x<k[C].startTime)O=C-1;else if(x>k[C].startTime&&R<D)R=C+1;else return C}return k[R].startTime-x<x-k[O].startTime?R:O}function I(k,x,D){var R=[],O=w(k,x);if(O>-1)for(var C=O,E=k.length;C<E;C++){var u=k[C];if(u.startTime>=x&&u.endTime<=D)R.push(u);else if(u.startTime>D)return R}return R}}),"./src/utils/time-ranges.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>T});var F={toString:function(M){for(var U="",w=M.length,I=0;I<w;I++)U+="["+M.start(I).toFixed(3)+","+M.end(I).toFixed(3)+"]";return U}};const T=F}),"./src/utils/timescale-conversion.ts":((S,L,h)=>{h.r(L),h.d(L,{toMpegTsClockFromTimescale:()=>U,toMsFromMpegTsClock:()=>M,toTimescaleFromBase:()=>T,toTimescaleFromScale:()=>N});var F=9e4;function T(w,I,k,x){k===void 0&&(k=1),x===void 0&&(x=!1);var D=w*I*k;return x?Math.round(D):D}function N(w,I,k,x){return k===void 0&&(k=1),x===void 0&&(x=!1),T(w,I,1/k,x)}function M(w,I){return I===void 0&&(I=!1),T(w,1e3,1/F,I)}function U(w,I){return I===void 0&&(I=1),T(w,F,1/I)}}),"./src/utils/typed-array.ts":((S,L,h)=>{h.r(L),h.d(L,{sliceUint8:()=>F});function F(T,N,M){return Uint8Array.prototype.slice?T.slice(N,M):new Uint8Array(Array.prototype.slice.call(T,N,M))}}),"./src/utils/vttcue.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>F});const F=(function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var T=["","lr","rl"],N=["start","middle","end","left","right"];function M(x,D){if(typeof D!="string"||!Array.isArray(x))return!1;var R=D.toLowerCase();return~x.indexOf(R)?R:!1}function U(x){return M(T,x)}function w(x){return M(N,x)}function I(x){for(var D=arguments.length,R=new Array(D>1?D-1:0),O=1;O<D;O++)R[O-1]=arguments[O];for(var C=1;C<arguments.length;C++){var E=arguments[C];for(var u in E)x[u]=E[u]}return x}function k(x,D,R){var O=this,C={enumerable:!0};O.hasBeenReset=!1;var E="",u=!1,l=x,c=D,d=R,o=null,a="",s=!0,v="auto",m="start",_=50,g="middle",A=50,y="middle";Object.defineProperty(O,"id",I({},C,{get:function(){return E},set:function(b){E=""+b}})),Object.defineProperty(O,"pauseOnExit",I({},C,{get:function(){return u},set:function(b){u=!!b}})),Object.defineProperty(O,"startTime",I({},C,{get:function(){return l},set:function(b){if(typeof b!="number")throw new TypeError("Start time must be set to a number.");l=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"endTime",I({},C,{get:function(){return c},set:function(b){if(typeof b!="number")throw new TypeError("End time must be set to a number.");c=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"text",I({},C,{get:function(){return d},set:function(b){d=""+b,this.hasBeenReset=!0}})),Object.defineProperty(O,"region",I({},C,{get:function(){return o},set:function(b){o=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"vertical",I({},C,{get:function(){return a},set:function(b){var P=U(b);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");a=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"snapToLines",I({},C,{get:function(){return s},set:function(b){s=!!b,this.hasBeenReset=!0}})),Object.defineProperty(O,"line",I({},C,{get:function(){return v},set:function(b){if(typeof b!="number"&&b!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");v=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"lineAlign",I({},C,{get:function(){return m},set:function(b){var P=w(b);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");m=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"position",I({},C,{get:function(){return _},set:function(b){if(b<0||b>100)throw new Error("Position must be between 0 and 100.");_=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"positionAlign",I({},C,{get:function(){return g},set:function(b){var P=w(b);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");g=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"size",I({},C,{get:function(){return A},set:function(b){if(b<0||b>100)throw new Error("Size must be between 0 and 100.");A=b,this.hasBeenReset=!0}})),Object.defineProperty(O,"align",I({},C,{get:function(){return y},set:function(b){var P=w(b);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");y=P,this.hasBeenReset=!0}})),O.displayState=void 0}return k.prototype.getCueAsHTML=function(){var x=self.WebVTT;return x.convertCueToDOMTree(self,this.text)},k})()}),"./src/utils/vttparser.ts":((S,L,h)=>{h.r(L),h.d(L,{VTTParser:()=>D,fixLineBreaks:()=>x,parseTimeStamp:()=>N});var F=h("./src/utils/vttcue.ts"),T=(function(){function R(){}var O=R.prototype;return O.decode=function(E,u){if(!E)return"";if(typeof E!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(E))},R})();function N(R){function O(E,u,l,c){return(E|0)*3600+(u|0)*60+(l|0)+parseFloat(c||0)}var C=R.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return C?parseFloat(C[2])>59?O(C[2],C[3],0,C[4]):O(C[1],C[2],C[3],C[4]):null}var M=(function(){function R(){this.values=Object.create(null)}var O=R.prototype;return O.set=function(E,u){!this.get(E)&&u!==""&&(this.values[E]=u)},O.get=function(E,u,l){return l?this.has(E)?this.values[E]:u[l]:this.has(E)?this.values[E]:u},O.has=function(E){return E in this.values},O.alt=function(E,u,l){for(var c=0;c<l.length;++c)if(u===l[c]){this.set(E,u);break}},O.integer=function(E,u){/^-?\d+$/.test(u)&&this.set(E,parseInt(u,10))},O.percent=function(E,u){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(u)){var l=parseFloat(u);if(l>=0&&l<=100)return this.set(E,l),!0}return!1},R})();function U(R,O,C,E){var u=E?R.split(E):[R];for(var l in u)if(typeof u[l]=="string"){var c=u[l].split(C);if(c.length===2){var d=c[0],o=c[1];O(d,o)}}}var w=new F.default(0,0,""),I=w.align==="middle"?"middle":"center";function k(R,O,C){var E=R;function u(){var d=N(R);if(d===null)throw new Error("Malformed timestamp: "+E);return R=R.replace(/^[^\sa-zA-Z-]+/,""),d}function l(d,o){var a=new M;U(d,function(m,_){var g;switch(m){case"region":for(var A=C.length-1;A>=0;A--)if(C[A].id===_){a.set(m,C[A].region);break}break;case"vertical":a.alt(m,_,["rl","lr"]);break;case"line":g=_.split(","),a.integer(m,g[0]),a.percent(m,g[0])&&a.set("snapToLines",!1),a.alt(m,g[0],["auto"]),g.length===2&&a.alt("lineAlign",g[1],["start",I,"end"]);break;case"position":g=_.split(","),a.percent(m,g[0]),g.length===2&&a.alt("positionAlign",g[1],["start",I,"end","line-left","line-right","auto"]);break;case"size":a.percent(m,_);break;case"align":a.alt(m,_,["start",I,"end","left","right"]);break}},/:/,/\s/),o.region=a.get("region",null),o.vertical=a.get("vertical","");var s=a.get("line","auto");s==="auto"&&w.line===-1&&(s=-1),o.line=s,o.lineAlign=a.get("lineAlign","start"),o.snapToLines=a.get("snapToLines",!0),o.size=a.get("size",100),o.align=a.get("align",I);var v=a.get("position","auto");v==="auto"&&w.position===50&&(v=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=v}function c(){R=R.replace(/^\s+/,"")}if(c(),O.startTime=u(),c(),R.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+E);R=R.slice(3),c(),O.endTime=u(),c(),l(R,O)}function x(R){return R.replace(/<br(?: \/)?>/gi,`
`)}var D=(function(){function R(){this.state="INITIAL",this.buffer="",this.decoder=new T,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var O=R.prototype;return O.parse=function(E){var u=this;E&&(u.buffer+=u.decoder.decode(E,{stream:!0}));function l(){var v=u.buffer,m=0;for(v=x(v);m<v.length&&v[m]!=="\r"&&v[m]!==`
`;)++m;var _=v.slice(0,m);return v[m]==="\r"&&++m,v[m]===`
`&&++m,u.buffer=v.slice(m),_}function c(v){U(v,function(m,_){},/:/)}try{var d="";if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;d=l();var o=d.match(/^()?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var a=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(a?a=!1:d=l(),u.state){case"HEADER":/:/.test(d)?c(d):d||(u.state="ID");continue;case"NOTE":d||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){u.state="NOTE";break}if(!d)continue;if(u.cue=new F.default(0,0,""),u.state="CUE",d.indexOf("-->")===-1){u.cue.id=d;continue}case"CUE":if(!u.cue){u.state="BADCUE";continue}try{k(d,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":{var s=d.indexOf("-->")!==-1;if(!d||s&&(a=!0)){u.oncue&&u.cue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}if(u.cue===null)continue;u.cue.text&&(u.cue.text+=`
`),u.cue.text+=d}continue;case"BADCUE":d||(u.state="ID")}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},O.flush=function(){var E=this;try{if((E.cue||E.state==="HEADER")&&(E.buffer+=`

`,E.parse()),E.state==="INITIAL"||E.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(u){E.onparsingerror&&E.onparsingerror(u)}return E.onflush&&E.onflush(),this},R})()}),"./src/utils/webvtt-parser.ts":((S,L,h)=>{h.r(L),h.d(L,{generateCueId:()=>D,parseWebVTT:()=>O});var F=h("./src/polyfills/number.ts"),T=h("./src/utils/vttparser.ts"),N=h("./src/demux/id3.ts"),M=h("./src/utils/timescale-conversion.ts"),U=h("./src/remux/mp4-remuxer.ts"),w=/\r\n|\n\r|\n|\r/g,I=function(E,u,l){return l===void 0&&(l=0),E.slice(l,l+u.length)===u},k=function(E){var u=parseInt(E.slice(-3)),l=parseInt(E.slice(-6,-4)),c=parseInt(E.slice(-9,-7)),d=E.length>9?parseInt(E.substring(0,E.indexOf(":"))):0;if(!(0,F.isFiniteNumber)(u)||!(0,F.isFiniteNumber)(l)||!(0,F.isFiniteNumber)(c)||!(0,F.isFiniteNumber)(d))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+E);return u+=1e3*l,u+=60*1e3*c,u+=3600*1e3*d,u},x=function(E){for(var u=5381,l=E.length;l;)u=u*33^E.charCodeAt(--l);return(u>>>0).toString()};function D(C,E,u){return x(C.toString())+x(E.toString())+x(u)}var R=function(E,u,l){var c=E[u],d=E[c.prevCC];if(!d||!d.new&&c.new){E.ccOffset=E.presentationOffset=c.start,c.new=!1;return}for(;(o=d)!==null&&o!==void 0&&o.new;){var o;E.ccOffset+=c.start-d.start,c.new=!1,c=d,d=E[c.prevCC]}E.presentationOffset=l};function O(C,E,u,l,c,d,o,a){var s=new T.VTTParser,v=(0,N.utf8ArrayToStr)(new Uint8Array(C)).trim().replace(w,`
`).split(`
`),m=[],_=(0,M.toMpegTsClockFromTimescale)(E,u),g="00:00.000",A=0,y=0,p,b=!0;s.oncue=function(P){var B=l[c],V=l.ccOffset,W=(A-_)/9e4;B!=null&&B.new&&(y!==void 0?V=l.ccOffset=B.start:R(l,c,W)),W&&(V=W-l.presentationOffset);var j=P.endTime-P.startTime,$=(0,U.normalizePts)((P.startTime+V-y)*9e4,d*9e4)/9e4;P.startTime=Math.max($,0),P.endTime=Math.max($+j,0);var Q=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(Q)),P.id||(P.id=D(P.startTime,P.endTime,Q)),P.endTime>0&&m.push(P)},s.onparsingerror=function(P){p=P},s.onflush=function(){if(p){a(p);return}o(m)},v.forEach(function(P){if(b)if(I(P,"X-TIMESTAMP-MAP=")){b=!1,P.slice(16).split(",").forEach(function(B){I(B,"LOCAL:")?g=B.slice(6):I(B,"MPEGTS:")&&(A=parseInt(B.slice(7)))});try{y=k(g)/1e3}catch(B){p=B}return}else P===""&&(b=!1);s.parse(P+`
`)}),s.flush()}}),"./src/utils/xhr-loader.ts":((S,L,h)=>{h.r(L),h.d(L,{default:()=>U});var F=h("./src/utils/logger.ts"),T=h("./src/loader/load-stats.ts"),N=/^age:\s*[\d.]+\s*$/m,M=(function(){function w(k){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=k?k.xhrSetup:null,this.stats=new T.LoadStats,this.retryDelay=0}var I=w.prototype;return I.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},I.abortInternal=function(){var x=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),x&&(x.onreadystatechange=null,x.onprogress=null,x.readyState!==4&&(this.stats.aborted=!0,x.abort()))},I.abort=function(){var x;this.abortInternal(),(x=this.callbacks)!==null&&x!==void 0&&x.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},I.load=function(x,D,R){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=x,this.config=D,this.callbacks=R,this.retryDelay=D.retryDelay,this.loadInternal()},I.loadInternal=function(){var x=this.config,D=this.context;if(x){var R=this.loader=new self.XMLHttpRequest,O=this.stats;O.loading.first=0,O.loaded=0;var C=this.xhrSetup;try{if(C)try{C(R,D.url)}catch{R.open("GET",D.url,!0),C(R,D.url)}R.readyState||R.open("GET",D.url,!0);var E=this.context.headers;if(E)for(var u in E)R.setRequestHeader(u,E[u])}catch(l){this.callbacks.onError({code:R.status,text:l.message},D,R);return}D.rangeEnd&&R.setRequestHeader("Range","bytes="+D.rangeStart+"-"+(D.rangeEnd-1)),R.onreadystatechange=this.readystatechange.bind(this),R.onprogress=this.loadprogress.bind(this),R.responseType=D.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),x.timeout),R.send()}},I.readystatechange=function(){var x=this.context,D=this.loader,R=this.stats;if(!(!x||!D)){var O=D.readyState,C=this.config;if(!R.aborted&&O>=2)if(self.clearTimeout(this.requestTimeout),R.loading.first===0&&(R.loading.first=Math.max(self.performance.now(),R.loading.start)),O===4){D.onreadystatechange=null,D.onprogress=null;var E=D.status,u=D.responseType==="arraybuffer";if(E>=200&&E<300&&(u&&D.response||D.responseText!==null)){R.loading.end=Math.max(self.performance.now(),R.loading.first);var l,c;if(u?(l=D.response,c=l.byteLength):(l=D.responseText,c=l.length),R.loaded=R.total=c,!this.callbacks)return;var d=this.callbacks.onProgress;if(d&&d(R,x,l,D),!this.callbacks)return;var o={url:D.responseURL,data:l};this.callbacks.onSuccess(o,R,x,D)}else R.retry>=C.maxRetry||E>=400&&E<499?(F.logger.error(E+" while loading "+x.url),this.callbacks.onError({code:E,text:D.statusText},x,D)):(F.logger.warn(E+" while loading "+x.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,C.maxRetryDelay),R.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),C.timeout)}},I.loadtimeout=function(){F.logger.warn("timeout while loading "+this.context.url);var x=this.callbacks;x&&(this.abortInternal(),x.onTimeout(this.stats,this.context,this.loader))},I.loadprogress=function(x){var D=this.stats;D.loaded=x.loaded,x.lengthComputable&&(D.total=x.total)},I.getCacheAge=function(){var x=null;if(this.loader&&N.test(this.loader.getAllResponseHeaders())){var D=this.loader.getResponseHeader("age");x=D?parseFloat(D):null}return x},w})();const U=M}),"./node_modules/eventemitter3/index.js":(S=>{var L=Object.prototype.hasOwnProperty,h="~";function F(){}Object.create&&(F.prototype=Object.create(null),new F().__proto__||(h=!1));function T(w,I,k){this.fn=w,this.context=I,this.once=k||!1}function N(w,I,k,x,D){if(typeof k!="function")throw new TypeError("The listener must be a function");var R=new T(k,x||w,D),O=h?h+I:I;return w._events[O]?w._events[O].fn?w._events[O]=[w._events[O],R]:w._events[O].push(R):(w._events[O]=R,w._eventsCount++),w}function M(w,I){--w._eventsCount===0?w._events=new F:delete w._events[I]}function U(){this._events=new F,this._eventsCount=0}U.prototype.eventNames=function(){var I=[],k,x;if(this._eventsCount===0)return I;for(x in k=this._events)L.call(k,x)&&I.push(h?x.slice(1):x);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(k)):I},U.prototype.listeners=function(I){var k=h?h+I:I,x=this._events[k];if(!x)return[];if(x.fn)return[x.fn];for(var D=0,R=x.length,O=new Array(R);D<R;D++)O[D]=x[D].fn;return O},U.prototype.listenerCount=function(I){var k=h?h+I:I,x=this._events[k];return x?x.fn?1:x.length:0},U.prototype.emit=function(I,k,x,D,R,O){var C=h?h+I:I;if(!this._events[C])return!1;var E=this._events[C],u=arguments.length,l,c;if(E.fn){switch(E.once&&this.removeListener(I,E.fn,void 0,!0),u){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,k),!0;case 3:return E.fn.call(E.context,k,x),!0;case 4:return E.fn.call(E.context,k,x,D),!0;case 5:return E.fn.call(E.context,k,x,D,R),!0;case 6:return E.fn.call(E.context,k,x,D,R,O),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];E.fn.apply(E.context,l)}else{var d=E.length,o;for(c=0;c<d;c++)switch(E[c].once&&this.removeListener(I,E[c].fn,void 0,!0),u){case 1:E[c].fn.call(E[c].context);break;case 2:E[c].fn.call(E[c].context,k);break;case 3:E[c].fn.call(E[c].context,k,x);break;case 4:E[c].fn.call(E[c].context,k,x,D);break;default:if(!l)for(o=1,l=new Array(u-1);o<u;o++)l[o-1]=arguments[o];E[c].fn.apply(E[c].context,l)}}return!0},U.prototype.on=function(I,k,x){return N(this,I,k,x,!1)},U.prototype.once=function(I,k,x){return N(this,I,k,x,!0)},U.prototype.removeListener=function(I,k,x,D){var R=h?h+I:I;if(!this._events[R])return this;if(!k)return M(this,R),this;var O=this._events[R];if(O.fn)O.fn===k&&(!D||O.once)&&(!x||O.context===x)&&M(this,R);else{for(var C=0,E=[],u=O.length;C<u;C++)(O[C].fn!==k||D&&!O[C].once||x&&O[C].context!==x)&&E.push(O[C]);E.length?this._events[R]=E.length===1?E[0]:E:M(this,R)}return this},U.prototype.removeAllListeners=function(I){var k;return I?(k=h?h+I:I,this._events[k]&&M(this,k)):(this._events=new F,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=h,U.EventEmitter=U,S.exports=U}),"./node_modules/url-toolkit/src/url-toolkit.js":(function(S){(function(L){var h=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,F=/^(?=([^\/?#]*))\1([^]*)$/,T=/(?:\/|^)\.(?=\/)/g,N=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,M={buildAbsoluteURL:function(U,w,I){if(I=I||{},U=U.trim(),w=w.trim(),!w){if(!I.alwaysNormalize)return U;var k=M.parseURL(U);if(!k)throw new Error("Error trying to parse base URL.");return k.path=M.normalizePath(k.path),M.buildURLFromParts(k)}var x=M.parseURL(w);if(!x)throw new Error("Error trying to parse relative URL.");if(x.scheme)return I.alwaysNormalize?(x.path=M.normalizePath(x.path),M.buildURLFromParts(x)):w;var D=M.parseURL(U);if(!D)throw new Error("Error trying to parse base URL.");if(!D.netLoc&&D.path&&D.path[0]!=="/"){var R=F.exec(D.path);D.netLoc=R[1],D.path=R[2]}D.netLoc&&!D.path&&(D.path="/");var O={scheme:D.scheme,netLoc:x.netLoc,path:null,params:x.params,query:x.query,fragment:x.fragment};if(!x.netLoc&&(O.netLoc=D.netLoc,x.path[0]!=="/"))if(!x.path)O.path=D.path,x.params||(O.params=D.params,x.query||(O.query=D.query));else{var C=D.path,E=C.substring(0,C.lastIndexOf("/")+1)+x.path;O.path=M.normalizePath(E)}return O.path===null&&(O.path=I.alwaysNormalize?M.normalizePath(x.path):x.path),M.buildURLFromParts(O)},parseURL:function(U){var w=h.exec(U);return w?{scheme:w[1]||"",netLoc:w[2]||"",path:w[3]||"",params:w[4]||"",query:w[5]||"",fragment:w[6]||""}:null},normalizePath:function(U){for(U=U.split("").reverse().join("").replace(T,"");U.length!==(U=U.replace(N,"")).length;);return U.split("").reverse().join("")},buildURLFromParts:function(U){return U.scheme+U.netLoc+U.path+U.params+U.query+U.fragment}};S.exports=M})()})},r={};function t(S){var L=r[S];if(L!==void 0)return L.exports;var h=r[S]={exports:{}};return i[S].call(h.exports,h,h.exports,t),h.exports}t.m=i,t.n=S=>{var L=S&&S.__esModule?()=>S.default:()=>S;return t.d(L,{a:L}),L},t.d=(S,L)=>{for(var h in L)t.o(L,h)&&!t.o(S,h)&&Object.defineProperty(S,h,{enumerable:!0,get:L[h]})},t.o=(S,L)=>Object.prototype.hasOwnProperty.call(S,L),t.r=S=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})};var f=t("./src/hls.ts");return f=f.default,f})())})(to);var Oe=cd(to.exports),fd=Ht.now,dd=Ht.listContainsIgnoreCase,hd=-1,vd=16;G.register("PLAYBACK_FRAGMENT_CHANGED");G.register("PLAYBACK_FRAGMENT_PARSING_METADATA");var ro=(function(e){Zf(i,e);var n=td(i);function i(){var r;zf(this,i);for(var t=arguments.length,f=new Array(t),S=0;S<t;S++)f[S]=arguments[S];return r=n.call.apply(n,[this].concat(f)),r.options.hlsPlayback=zn(zn({},r.defaultOptions),r.options.hlsPlayback),r._setInitialState(),r}return Xf(i,[{key:"name",get:function(){return"hls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return this._currentLevel===null||this._currentLevel===void 0?hd:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(G.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"latency",get:function(){return this._hls.latency}},{key:"currentProgramDateTime",get:function(){return this._hls.playingDate}},{key:"_startTime",get:function(){return this._playbackType===me.LIVE&&this._playlistType!=="EVENT"?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return fd()}},{key:"_extrapolatedStartTime",get:function(){if(!this._localStartTimeCorrelation)return this._playableRegionStartTime;var t=this._localStartTimeCorrelation,f=this._now-t.local,S=(t.remote+f)/1e3;return Math.min(S,this._playableRegionStartTime+this._extrapolatedWindowDuration)}},{key:"_extrapolatedEndTime",get:function(){var t=this._playableRegionStartTime+this._playableRegionDuration;if(!this._localEndTimeCorrelation)return t;var f=this._localEndTimeCorrelation,S=this._now-f.local,L=(f.remote+S)/1e3;return Math.max(t-this._extrapolatedWindowDuration,Math.min(L,t))}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return this._segmentTargetDuration===null?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!0}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"sourceMedia",get:function(){return this.options.src}},{key:"currentTimestamp",get:function(){if(!this._currentFragment)return null;var t=this._currentFragment.programDateTime,f=this.el.currentTime,S=f-this._currentFragment.start,L=t+S*1e3;return L/1e3}},{key:"_setInitialState",value:function(){this._minDvrSize=typeof this.options.hlsMinimumDvrSize>"u"?60:this.options.hlsMinimumDvrSize,this._extrapolatedWindowNumSegments=!this.options.playback||typeof this.options.playback.extrapolatedWindowNumSegments>"u"?2:this.options.playback.extrapolatedWindowNumSegments,this._playbackType=me.VOD,this._lastTimeUpdate={current:0,total:0},this._lastDuration=null,this._playableRegionStartTime=0,this._localStartTimeCorrelation=null,this._localEndTimeCorrelation=null,this._playableRegionDuration=0,this._programDateTime=0,this._durationExcludesAfterLiveSyncPoint=!1,this._segmentTargetDuration=null,this._playlistType=null,this._recoverAttemptsRemaining=this.options.hlsRecoverAttempts||vd}},{key:"_setup",value:function(){this._destroyHLSInstance(),this._createHLSInstance(),this._listenHLSEvents(),this._attachHLSMedia()}},{key:"_destroyHLSInstance",value:function(){this._hls&&(this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._setInitialState(),this._hls.destroy(),this._hls=null)}},{key:"_createHLSInstance",value:function(){var t=zn({},this.options.playback.hlsjsConfig);this._hls=new Oe(t)}},{key:"_attachHLSMedia",value:function(){this._hls&&this._hls.attachMedia(this.el)}},{key:"_listenHLSEvents",value:function(){var t=this;this._hls&&(this._hls.once(Oe.Events.MEDIA_ATTACHED,function(){t.options.hlsPlayback.preload&&t._hls.loadSource(t.options.src)}),this._hls.on(Oe.Events.MANIFEST_PARSED,function(){return t._manifestParsed=!0}),this._hls.on(Oe.Events.LEVEL_LOADED,function(f,S){return t._updatePlaybackType(f,S)}),this._hls.on(Oe.Events.LEVEL_UPDATED,function(f,S){return t._onLevelUpdated(f,S)}),this._hls.on(Oe.Events.LEVEL_SWITCHING,function(f,S){return t._onLevelSwitch(f,S)}),this._hls.on(Oe.Events.FRAG_CHANGED,function(f,S){return t._onFragmentChanged(f,S)}),this._hls.on(Oe.Events.FRAG_LOADED,function(f,S){return t._onFragmentLoaded(f,S)}),this._hls.on(Oe.Events.FRAG_PARSING_METADATA,function(f,S){return t._onFragmentParsingMetadata(f,S)}),this._hls.on(Oe.Events.ERROR,function(f,S){return t._onHLSJSError(f,S)}),this._hls.on(Oe.Events.SUBTITLE_TRACK_LOADED,function(f,S){return t._onSubtitleLoaded(f,S)}),this._hls.on(Oe.Events.SUBTITLE_TRACKS_UPDATED,function(){return t._ccTracksUpdated=!0}),this.bindCustomListeners())}},{key:"bindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(f){var S=f.eventName,L=f.once?"once":"on";S&&t._hls["".concat(L)](S,f.callback)})}},{key:"unbindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(f){var S=f.eventName;S&&t._hls.off(S,f.callback)})}},{key:"_onFragmentParsingMetadata",value:function(t,f){this.trigger(G.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:f})}},{key:"render",value:function(){return this._ready(),Ft(mt(i.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(!this._hls&&this._setup(),this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(t,f,S){if(!this._recoveredDecodingError)this._recoveredDecodingError=!0,this._hls.recoverMediaError();else if(!this._recoveredAudioCodecError)this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError();else{Ee.error("hlsjs: failed to recover",{evt:t,data:f}),S.level=ot.Levels.FATAL;var L=this.createError(S);this.trigger(G.PLAYBACK_ERROR,L),this.stop()}}},{key:"_setupSrc",value:function(t){}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval(function(){t._onDurationChange(),t._onTimeUpdate()},100))}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(t){var f=t>0?this._duration*(t/100):this._duration;this.seek(f)}},{key:"seek",value:function(t){t<0&&(Ee.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this._startTime,this.el.currentTime=t}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function(){this._playbackType===me.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(t,f){var S={code:"".concat(f.type,"_").concat(f.details),description:"".concat(this.name," error: type: ").concat(f.type,", details: ").concat(f.details),raw:f},L;if(f.response&&(S.description+=", response: ".concat(JSON.stringify(f.response))),f.fatal)if(this._recoverAttemptsRemaining>0)switch(this._recoverAttemptsRemaining-=1,f.type){case Oe.ErrorTypes.NETWORK_ERROR:switch(f.details){case Oe.ErrorDetails.MANIFEST_LOAD_ERROR:case Oe.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case Oe.ErrorDetails.MANIFEST_PARSING_ERROR:case Oe.ErrorDetails.LEVEL_LOAD_ERROR:case Oe.ErrorDetails.LEVEL_LOAD_TIMEOUT:Ee.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:f}),L=this.createError(S),this.trigger(G.PLAYBACK_ERROR,L),this.stop();break;default:Ee.warn("hlsjs: trying to recover from network error.",{evt:t,data:f}),S.level=ot.Levels.WARN,this._hls.startLoad();break}break;case Oe.ErrorTypes.MEDIA_ERROR:Ee.warn("hlsjs: trying to recover from media error.",{evt:t,data:f}),S.level=ot.Levels.WARN,this._recover(t,f,S);break;default:Ee.error("hlsjs: could not recover from error.",{evt:t,data:f}),L=this.createError(S),this.trigger(G.PLAYBACK_ERROR,L),this.stop();break}else Ee.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:f}),L=this.createError(S),this.trigger(G.PLAYBACK_ERROR,L),this.stop();else{if(this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(f)){Ee.error("hlsjs: could not load decrypt key.",{evt:t,data:f}),L=this.createError(S),this.trigger(G.PLAYBACK_ERROR,L),this.stop();return}S.level=ot.Levels.WARN,Ee.warn("hlsjs: non-fatal error occurred",{evt:t,data:f})}}},{key:"_keyIsDenied",value:function(t){return t.type===Oe.ErrorTypes.NETWORK_ERROR&&t.details===Oe.ErrorDetails.KEY_LOAD_ERROR&&t.response&&t.response.code>=400}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},f=this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total;f||(this._lastTimeUpdate=t,this.trigger(G.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,Ft(mt(i.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],f=0,S=0;S<this.el.buffered.length;S++)t=[].concat(nd(t),[{start:Math.max(0,this.el.buffered.start(S)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(S)-this._playableRegionStartTime)}]),this.el.currentTime>=t[S].start&&this.el.currentTime<=t[S].end&&(f=S);var L={start:t[f].start,current:t[f].end,total:this.getDuration()};this.trigger(G.PLAYBACK_PROGRESS,L,t)}}},{key:"load",value:function(t){this._stopTimeUpdateTimer(),this.options.src=t,this._setup()}},{key:"play",value:function(){!this._hls&&this._setup(),!this._manifestParsed&&!this.options.hlsPlayback.preload&&this._hls.loadSource(this.options.src),Ft(mt(i.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){this._hls&&(this.el.pause(),this.dvrEnabled&&this._updateDvr(!0))}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&Ft(mt(i.prototype),"stop",this).call(this),this._destroyHLSInstance()}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._destroyHLSInstance(),Ft(mt(i.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(t,f){this._playbackType=f.details.live?me.LIVE:me.VOD,this._onLevelUpdated(t,f),this._ccTracksUpdated&&this._playbackType===me.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map(function(t,f){return{id:f,level:t,label:"".concat(t.bitrate/1e3,"Kbps")}}),this.trigger(G.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(t,f){this._segmentTargetDuration=f.details.targetduration,this._playlistType=f.details.type||null;var S=!1,L=!1,h=f.details.fragments,F=this._playableRegionStartTime,T=this._playableRegionDuration;if(h.length!==0){if(h[0].rawProgramDateTime&&(this._programDateTime=h[0].rawProgramDateTime),this._playableRegionStartTime!==h[0].start&&(S=!0,this._playableRegionStartTime=h[0].start),S)if(!this._localStartTimeCorrelation)this._localStartTimeCorrelation={local:this._now,remote:(h[0].start+this._extrapolatedWindowDuration/2)*1e3};else{var N=this._localStartTimeCorrelation,M=this._now-N.local,U=(N.remote+M)/1e3;U<h[0].start?this._localStartTimeCorrelation={local:this._now,remote:h[0].start*1e3}:U>F+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:Math.max(h[0].start,F+this._extrapolatedWindowDuration)*1e3})}var w=f.details.totalduration;if(this._playbackType===me.LIVE){var I=f.details.targetduration,k=this.options.playback.hlsjsConfig||{},x=k.liveSyncDurationCount||Oe.DefaultConfig.liveSyncDurationCount,D=I*x;D<=w?(w-=D,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1}w!==this._playableRegionDuration&&(L=!0,this._playableRegionDuration=w);var R=h[0].start+w,O=F+T,C=R!==O;if(C)if(!this._localEndTimeCorrelation)this._localEndTimeCorrelation={local:this._now,remote:R*1e3};else{var E=this._localEndTimeCorrelation,u=this._now-E.local,l=(E.remote+u)/1e3;l>R?this._localEndTimeCorrelation={local:this._now,remote:R*1e3}:l<R-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:(R-this._extrapolatedWindowDuration)*1e3}:l>O&&(this._localEndTimeCorrelation={local:this._now,remote:O*1e3})}L&&this._onDurationChange(),S&&this._onProgress()}}},{key:"_onFragmentChanged",value:function(t,f){this._currentFragment=f.frag,this.trigger(G.Custom.PLAYBACK_FRAGMENT_CHANGED,f)}},{key:"_onFragmentLoaded",value:function(t,f){this.trigger(G.PLAYBACK_FRAGMENT_LOADED,f)}},{key:"_onSubtitleLoaded",value:function(){if(!this._ccIsSetup){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this._playbackType===me.LIVE?-1:this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this._ccIsSetup=!0}}},{key:"_onLevelSwitch",value:function(t,f){this.levels.length||this._fillLevels(),this.trigger(G.PLAYBACK_LEVEL_SWITCH_END),this.trigger(G.PLAYBACK_LEVEL_SWITCH,f);var S=this._hls.levels[f.level];S&&(this.highDefinition=S.height>=720||S.bitrate/1e3>=2e3,this.trigger(G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(G.PLAYBACK_BITRATE,{height:S.height,width:S.width,bandwidth:S.bitrate,bitrate:S.bitrate,level:f.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===me.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===me.VOD||this.dvrEnabled}}],[{key:"HLSJS",get:function(){return Oe}}]),i})(At);ro.canPlay=function(e,n){var i=e.split("?")[0].match(/.*\.(.*)$/)||[],r=i.length>1&&i[1].toLowerCase()==="m3u8"||dd(n,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!!(Oe.isSupported()&&r)};const gd=["id"],pd=Ri({__name:"VClappr",props:{el:{type:String,required:!0,default:"player"},elModifiers:{},source:{type:String,required:!0},sourceModifiers:{},options:{type:Object,required:!1,default:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},dashShakaConfig:{}},poster:"https://picsum.photos/3840/2160"}},optionsModifiers:{}},emits:Il(["init","ready","resize","play","pause","stop","ended","seek","error","time-updated","volume-updated","subtitle-available"],["update:el","update:source","update:options"]),setup(e,{emit:n}){const i=n,r=Bn(e,"el"),t=Bn(e,"source"),f=Bn(e,"options"),S=zo(null);gs(async()=>{await L()}),ps(()=>{S.value?.destroy(),S.value=null}),nn(S,()=>{S.value&&i("init",S.value)});const L=async()=>new Promise((h,F)=>{r.value?(S.value=new Xs({parentId:`#${r.value}`,source:t.value,plugins:[vi,Af,Sf,Na,Ba,Fa,pf,bf,Df,Pf,If,Kf,Gf,Na,Fa,Ba,ro],events:{onReady:T=>{i("ready",T)},onResize:T=>{i("resize",T)},onPlay:()=>{i("play",!0)},onPause:()=>{i("pause",!0)},onStop:T=>{i("stop",T)},onEnded:()=>{i("ended",!0)},onSeek:T=>{i("seek",T)},onError:T=>{i("error",T)},onTimeUpdate:T=>{i("time-updated",T)},onVolumeUpdate:T=>{i("volume-updated",T)},onSubtitleAvailable:T=>{i("subtitle-available",T)}},...f.value}),h("Player created!")):F(new Error("Root element not found"))});return(h,F)=>(gr(),Nr("div",{id:r.value},null,8,gd))}}),md={class:"w-screen h-screen bg-gradient-49"},yd=Ri({__name:"App",setup(e){const n=En({clappr:null,source:"https://download.samplelib.com/mp4/sample-30s.mp4",poster:"http://clappr.io/poster.png",options:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}}}}),i=U=>{console.log("onInit Event: ",U),n.clappr=U},r=U=>{console.log("onResize Event: ",U)},t=U=>{console.log("onPlay Event: ",U)},f=U=>{console.log("onPause Event: ",U)},S=U=>{console.log("onStop Event: ",U)},L=U=>{console.log("onEnded Event: ",U)},h=U=>{console.log("onSeek Event: ",U)},F=U=>{console.log("onError Event: ",U)},T=U=>{console.log("onTimeUpdate Event: ",U)},N=U=>{console.log("onVolumeUpdate Event: ",U)},M=U=>{console.log("onSubtitleAvailable Event: ",U)};return(U,w)=>(gr(),Nr("main",md,[ft(ei(tc),{url:"https://github.com/vinayakkulkarni/v-clappr"}),ft(ei(pd),{el:"player",source:n.source,options:n.options,class:"mx-auto w-1/2 h-full",onInit:i,onResize:r,onPlay:t,onPause:f,onStop:S,onEnded:L,onSeek:h,onError:F,onTimeUpdated:T,onVolumeUpdated:N,onSubtitleAvailable:M},null,8,["source","options"]),w[0]||(w[0]=ct("div",{class:"absolute bottom-4 right-4"},[ct("a",{href:"https://app.netlify.com/sites/v-clappr/deploys","aria-label":"View deploys on Netlify",target:"_blank",rel:"noopener noreferrer",class:"gray-400"},[ct("img",{src:"https://www.netlify.com/img/global/badges/netlify-color-accent.svg",alt:"Deploys by Netlify"})])],-1))]))}}),Ed=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},Ad=Ed(yd,[["__scopeId","data-v-df96a186"]]);Ku(Ad).mount("#app");
