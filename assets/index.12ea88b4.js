(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function a(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=a(r);fetch(r.href,l)}})();function Sa(t,i){const a=Object.create(null),n=t.split(",");for(let r=0;r<n.length;r++)a[n[r]]=!0;return i?r=>!!a[r.toLowerCase()]:r=>!!a[r]}const uc="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",cc=Sa(uc);function bo(t){return!!t||t===""}function ka(t){if(We(t)){const i={};for(let a=0;a<t.length;a++){const n=t[a],r=Dt(n)?hc(n):ka(n);if(r)for(const l in r)i[l]=r[l]}return i}else{if(Dt(t))return t;if(vt(t))return t}}const fc=/;(?![^(]*\))/g,dc=/:(.+)/;function hc(t){const i={};return t.split(fc).forEach(a=>{if(a){const n=a.split(dc);n.length>1&&(i[n[0].trim()]=n[1].trim())}}),i}function Ra(t){let i="";if(Dt(t))i=t;else if(We(t))for(let a=0;a<t.length;a++){const n=Ra(t[a]);n&&(i+=n+" ")}else if(vt(t))for(const a in t)t[a]&&(i+=a+" ");return i.trim()}const lt={},cn=[],ir=()=>{},gc=()=>!1,pc=/^on[^a-z]/,Ei=t=>pc.test(t),Ca=t=>t.startsWith("onUpdate:"),Mt=Object.assign,wa=(t,i)=>{const a=t.indexOf(i);a>-1&&t.splice(a,1)},vc=Object.prototype.hasOwnProperty,Ze=(t,i)=>vc.call(t,i),We=Array.isArray,Nn=t=>_i(t)==="[object Map]",mc=t=>_i(t)==="[object Set]",ze=t=>typeof t=="function",Dt=t=>typeof t=="string",La=t=>typeof t=="symbol",vt=t=>t!==null&&typeof t=="object",To=t=>vt(t)&&ze(t.then)&&ze(t.catch),yc=Object.prototype.toString,_i=t=>yc.call(t),Ac=t=>_i(t).slice(8,-1),Ec=t=>_i(t)==="[object Object]",Ia=t=>Dt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,fi=Sa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bi=t=>{const i=Object.create(null);return a=>i[a]||(i[a]=t(a))},_c=/-(\w)/g,pr=bi(t=>t.replace(_c,(i,a)=>a?a.toUpperCase():"")),bc=/\B([A-Z])/g,_n=bi(t=>t.replace(bc,"-$1").toLowerCase()),Ti=bi(t=>t.charAt(0).toUpperCase()+t.slice(1)),Hi=bi(t=>t?`on${Ti(t)}`:""),Mn=(t,i)=>!Object.is(t,i),ji=(t,i)=>{for(let a=0;a<t.length;a++)t[a](i)},gi=(t,i,a)=>{Object.defineProperty(t,i,{configurable:!0,enumerable:!1,value:a})},Tc=t=>{const i=parseFloat(t);return isNaN(i)?t:i};let ks;const xc=()=>ks||(ks=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ur;class Sc{constructor(i=!1){this.detached=i,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ur,!i&&ur&&(this.index=(ur.scopes||(ur.scopes=[])).push(this)-1)}run(i){if(this.active){const a=ur;try{return ur=this,i()}finally{ur=a}}}on(){ur=this}off(){ur=this.parent}stop(i){if(this.active){let a,n;for(a=0,n=this.effects.length;a<n;a++)this.effects[a].stop();for(a=0,n=this.cleanups.length;a<n;a++)this.cleanups[a]();if(this.scopes)for(a=0,n=this.scopes.length;a<n;a++)this.scopes[a].stop(!0);if(!this.detached&&this.parent&&!i){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this.active=!1}}}function kc(t,i=ur){i&&i.active&&i.effects.push(t)}const Oa=t=>{const i=new Set(t);return i.w=0,i.n=0,i},xo=t=>(t.w&Ir)>0,So=t=>(t.n&Ir)>0,Rc=({deps:t})=>{if(t.length)for(let i=0;i<t.length;i++)t[i].w|=Ir},Cc=t=>{const{deps:i}=t;if(i.length){let a=0;for(let n=0;n<i.length;n++){const r=i[n];xo(r)&&!So(r)?r.delete(t):i[a++]=r,r.w&=~Ir,r.n&=~Ir}i.length=a}},ra=new WeakMap;let Dn=0,Ir=1;const na=30;let tr;const qr=Symbol(""),ia=Symbol("");class Da{constructor(i,a=null,n){this.fn=i,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,kc(this,n)}run(){if(!this.active)return this.fn();let i=tr,a=wr;for(;i;){if(i===this)return;i=i.parent}try{return this.parent=tr,tr=this,wr=!0,Ir=1<<++Dn,Dn<=na?Rc(this):Rs(this),this.fn()}finally{Dn<=na&&Cc(this),Ir=1<<--Dn,tr=this.parent,wr=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){tr===this?this.deferStop=!0:this.active&&(Rs(this),this.onStop&&this.onStop(),this.active=!1)}}function Rs(t){const{deps:i}=t;if(i.length){for(let a=0;a<i.length;a++)i[a].delete(t);i.length=0}}let wr=!0;const ko=[];function bn(){ko.push(wr),wr=!1}function Tn(){const t=ko.pop();wr=t===void 0?!0:t}function Gt(t,i,a){if(wr&&tr){let n=ra.get(t);n||ra.set(t,n=new Map);let r=n.get(a);r||n.set(a,r=Oa()),Ro(r)}}function Ro(t,i){let a=!1;Dn<=na?So(t)||(t.n|=Ir,a=!xo(t)):a=!t.has(tr),a&&(t.add(tr),tr.deps.push(t))}function br(t,i,a,n,r,l){const f=ra.get(t);if(!f)return;let g=[];if(i==="clear")g=[...f.values()];else if(a==="length"&&We(t))f.forEach((T,m)=>{(m==="length"||m>=n)&&g.push(T)});else switch(a!==void 0&&g.push(f.get(a)),i){case"add":We(t)?Ia(a)&&g.push(f.get("length")):(g.push(f.get(qr)),Nn(t)&&g.push(f.get(ia)));break;case"delete":We(t)||(g.push(f.get(qr)),Nn(t)&&g.push(f.get(ia)));break;case"set":Nn(t)&&g.push(f.get(qr));break}if(g.length===1)g[0]&&aa(g[0]);else{const T=[];for(const m of g)m&&T.push(...m);aa(Oa(T))}}function aa(t,i){const a=We(t)?t:[...t];for(const n of a)n.computed&&Cs(n);for(const n of a)n.computed||Cs(n)}function Cs(t,i){(t!==tr||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const wc=Sa("__proto__,__v_isRef,__isVue"),Co=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(La)),Lc=Pa(),Ic=Pa(!1,!0),Oc=Pa(!0),ws=Dc();function Dc(){const t={};return["includes","indexOf","lastIndexOf"].forEach(i=>{t[i]=function(...a){const n=rt(this);for(let l=0,f=this.length;l<f;l++)Gt(n,"get",l+"");const r=n[i](...a);return r===-1||r===!1?n[i](...a.map(rt)):r}}),["push","pop","shift","unshift","splice"].forEach(i=>{t[i]=function(...a){bn();const n=rt(this)[i].apply(this,a);return Tn(),n}}),t}function Pa(t=!1,i=!1){return function(n,r,l){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return i;if(r==="__v_raw"&&l===(t?i?Xc:Do:i?Oo:Io).get(n))return n;const f=We(n);if(!t&&f&&Ze(ws,r))return Reflect.get(ws,r,l);const g=Reflect.get(n,r,l);return(La(r)?Co.has(r):wc(r))||(t||Gt(n,"get",r),i)?g:Ot(g)?f&&Ia(r)?g:g.value:vt(g)?t?Po(g):Si(g):g}}const Pc=wo(),Nc=wo(!0);function wo(t=!1){return function(a,n,r,l){let f=a[n];if(pn(f)&&Ot(f)&&!Ot(r))return!1;if(!t&&(!pi(r)&&!pn(r)&&(f=rt(f),r=rt(r)),!We(a)&&Ot(f)&&!Ot(r)))return f.value=r,!0;const g=We(a)&&Ia(n)?Number(n)<a.length:Ze(a,n),T=Reflect.set(a,n,r,l);return a===rt(l)&&(g?Mn(r,f)&&br(a,"set",n,r):br(a,"add",n,r)),T}}function Fc(t,i){const a=Ze(t,i);t[i];const n=Reflect.deleteProperty(t,i);return n&&a&&br(t,"delete",i,void 0),n}function Mc(t,i){const a=Reflect.has(t,i);return(!La(i)||!Co.has(i))&&Gt(t,"has",i),a}function Bc(t){return Gt(t,"iterate",We(t)?"length":qr),Reflect.ownKeys(t)}const Lo={get:Lc,set:Pc,deleteProperty:Fc,has:Mc,ownKeys:Bc},Uc={get:Oc,set(t,i){return!0},deleteProperty(t,i){return!0}},Kc=Mt({},Lo,{get:Ic,set:Nc}),Na=t=>t,xi=t=>Reflect.getPrototypeOf(t);function ri(t,i,a=!1,n=!1){t=t.__v_raw;const r=rt(t),l=rt(i);a||(i!==l&&Gt(r,"get",i),Gt(r,"get",l));const{has:f}=xi(r),g=n?Na:a?Ba:Bn;if(f.call(r,i))return g(t.get(i));if(f.call(r,l))return g(t.get(l));t!==r&&t.get(i)}function ni(t,i=!1){const a=this.__v_raw,n=rt(a),r=rt(t);return i||(t!==r&&Gt(n,"has",t),Gt(n,"has",r)),t===r?a.has(t):a.has(t)||a.has(r)}function ii(t,i=!1){return t=t.__v_raw,!i&&Gt(rt(t),"iterate",qr),Reflect.get(t,"size",t)}function Ls(t){t=rt(t);const i=rt(this);return xi(i).has.call(i,t)||(i.add(t),br(i,"add",t,t)),this}function Is(t,i){i=rt(i);const a=rt(this),{has:n,get:r}=xi(a);let l=n.call(a,t);l||(t=rt(t),l=n.call(a,t));const f=r.call(a,t);return a.set(t,i),l?Mn(i,f)&&br(a,"set",t,i):br(a,"add",t,i),this}function Os(t){const i=rt(this),{has:a,get:n}=xi(i);let r=a.call(i,t);r||(t=rt(t),r=a.call(i,t)),n&&n.call(i,t);const l=i.delete(t);return r&&br(i,"delete",t,void 0),l}function Ds(){const t=rt(this),i=t.size!==0,a=t.clear();return i&&br(t,"clear",void 0,void 0),a}function ai(t,i){return function(n,r){const l=this,f=l.__v_raw,g=rt(f),T=i?Na:t?Ba:Bn;return!t&&Gt(g,"iterate",qr),f.forEach((m,A)=>n.call(r,T(m),T(A),l))}}function si(t,i,a){return function(...n){const r=this.__v_raw,l=rt(r),f=Nn(l),g=t==="entries"||t===Symbol.iterator&&f,T=t==="keys"&&f,m=r[t](...n),A=a?Na:i?Ba:Bn;return!i&&Gt(l,"iterate",T?ia:qr),{next(){const{value:U,done:w}=m.next();return w?{value:U,done:w}:{value:g?[A(U[0]),A(U[1])]:A(U),done:w}},[Symbol.iterator](){return this}}}}function kr(t){return function(...i){return t==="delete"?!1:this}}function Vc(){const t={get(l){return ri(this,l)},get size(){return ii(this)},has:ni,add:Ls,set:Is,delete:Os,clear:Ds,forEach:ai(!1,!1)},i={get(l){return ri(this,l,!1,!0)},get size(){return ii(this)},has:ni,add:Ls,set:Is,delete:Os,clear:Ds,forEach:ai(!1,!0)},a={get(l){return ri(this,l,!0)},get size(){return ii(this,!0)},has(l){return ni.call(this,l,!0)},add:kr("add"),set:kr("set"),delete:kr("delete"),clear:kr("clear"),forEach:ai(!0,!1)},n={get(l){return ri(this,l,!0,!0)},get size(){return ii(this,!0)},has(l){return ni.call(this,l,!0)},add:kr("add"),set:kr("set"),delete:kr("delete"),clear:kr("clear"),forEach:ai(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(l=>{t[l]=si(l,!1,!1),a[l]=si(l,!0,!1),i[l]=si(l,!1,!0),n[l]=si(l,!0,!0)}),[t,a,i,n]}const[Gc,Hc,jc,Yc]=Vc();function Fa(t,i){const a=i?t?Yc:jc:t?Hc:Gc;return(n,r,l)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?n:Reflect.get(Ze(a,r)&&r in n?a:n,r,l)}const zc={get:Fa(!1,!1)},Wc={get:Fa(!1,!0)},$c={get:Fa(!0,!1)},Io=new WeakMap,Oo=new WeakMap,Do=new WeakMap,Xc=new WeakMap;function qc(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Zc(t){return t.__v_skip||!Object.isExtensible(t)?0:qc(Ac(t))}function Si(t){return pn(t)?t:Ma(t,!1,Lo,zc,Io)}function Qc(t){return Ma(t,!1,Kc,Wc,Oo)}function Po(t){return Ma(t,!0,Uc,$c,Do)}function Ma(t,i,a,n,r){if(!vt(t)||t.__v_raw&&!(i&&t.__v_isReactive))return t;const l=r.get(t);if(l)return l;const f=Zc(t);if(f===0)return t;const g=new Proxy(t,f===2?n:a);return r.set(t,g),g}function fn(t){return pn(t)?fn(t.__v_raw):!!(t&&t.__v_isReactive)}function pn(t){return!!(t&&t.__v_isReadonly)}function pi(t){return!!(t&&t.__v_isShallow)}function No(t){return fn(t)||pn(t)}function rt(t){const i=t&&t.__v_raw;return i?rt(i):t}function Fo(t){return gi(t,"__v_skip",!0),t}const Bn=t=>vt(t)?Si(t):t,Ba=t=>vt(t)?Po(t):t;function Mo(t){wr&&tr&&(t=rt(t),Ro(t.dep||(t.dep=Oa())))}function Bo(t,i){t=rt(t),t.dep&&aa(t.dep)}function Ot(t){return!!(t&&t.__v_isRef===!0)}function Jc(t){return ef(t,!1)}function ef(t,i){return Ot(t)?t:new tf(t,i)}class tf{constructor(i,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?i:rt(i),this._value=a?i:Bn(i)}get value(){return Mo(this),this._value}set value(i){const a=this.__v_isShallow||pi(i)||pn(i);i=a?i:rt(i),Mn(i,this._rawValue)&&(this._rawValue=i,this._value=a?i:Bn(i),Bo(this))}}function rf(t){return Ot(t)?t.value:t}const nf={get:(t,i,a)=>rf(Reflect.get(t,i,a)),set:(t,i,a,n)=>{const r=t[i];return Ot(r)&&!Ot(a)?(r.value=a,!0):Reflect.set(t,i,a,n)}};function Uo(t){return fn(t)?t:new Proxy(t,nf)}var Ko;class af{constructor(i,a,n,r){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this[Ko]=!1,this._dirty=!0,this.effect=new Da(i,()=>{this._dirty||(this._dirty=!0,Bo(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const i=rt(this);return Mo(i),(i._dirty||!i._cacheable)&&(i._dirty=!1,i._value=i.effect.run()),i._value}set value(i){this._setter(i)}}Ko="__v_isReadonly";function sf(t,i,a=!1){let n,r;const l=ze(t);return l?(n=t,r=ir):(n=t.get,r=t.set),new af(n,r,l||!r,a)}function Lr(t,i,a,n){let r;try{r=n?t(...n):t()}catch(l){ki(l,i,a)}return r}function ar(t,i,a,n){if(ze(t)){const l=Lr(t,i,a,n);return l&&To(l)&&l.catch(f=>{ki(f,i,a)}),l}const r=[];for(let l=0;l<t.length;l++)r.push(ar(t[l],i,a,n));return r}function ki(t,i,a,n=!0){const r=i?i.vnode:null;if(i){let l=i.parent;const f=i.proxy,g=a;for(;l;){const m=l.ec;if(m){for(let A=0;A<m.length;A++)if(m[A](t,f,g)===!1)return}l=l.parent}const T=i.appContext.config.errorHandler;if(T){Lr(T,null,10,[t,f,g]);return}}of(t,a,r,n)}function of(t,i,a,n=!0){console.error(t)}let Un=!1,sa=!1;const It=[];let fr=0;const dn=[];let Ar=null,zr=0;const Vo=Promise.resolve();let Ua=null;function oa(t){const i=Ua||Vo;return t?i.then(this?t.bind(this):t):i}function lf(t){let i=fr+1,a=It.length;for(;i<a;){const n=i+a>>>1;Kn(It[n])<t?i=n+1:a=n}return i}function Ka(t){(!It.length||!It.includes(t,Un&&t.allowRecurse?fr+1:fr))&&(t.id==null?It.push(t):It.splice(lf(t.id),0,t),Go())}function Go(){!Un&&!sa&&(sa=!0,Ua=Vo.then(jo))}function uf(t){const i=It.indexOf(t);i>fr&&It.splice(i,1)}function cf(t){We(t)?dn.push(...t):(!Ar||!Ar.includes(t,t.allowRecurse?zr+1:zr))&&dn.push(t),Go()}function Ps(t,i=Un?fr+1:0){for(;i<It.length;i++){const a=It[i];a&&a.pre&&(It.splice(i,1),i--,a())}}function Ho(t){if(dn.length){const i=[...new Set(dn)];if(dn.length=0,Ar){Ar.push(...i);return}for(Ar=i,Ar.sort((a,n)=>Kn(a)-Kn(n)),zr=0;zr<Ar.length;zr++)Ar[zr]();Ar=null,zr=0}}const Kn=t=>t.id==null?1/0:t.id,ff=(t,i)=>{const a=Kn(t)-Kn(i);if(a===0){if(t.pre&&!i.pre)return-1;if(i.pre&&!t.pre)return 1}return a};function jo(t){sa=!1,Un=!0,It.sort(ff);const i=ir;try{for(fr=0;fr<It.length;fr++){const a=It[fr];a&&a.active!==!1&&Lr(a,null,14)}}finally{fr=0,It.length=0,Ho(),Un=!1,Ua=null,(It.length||dn.length)&&jo()}}function df(t,i,...a){if(t.isUnmounted)return;const n=t.vnode.props||lt;let r=a;const l=i.startsWith("update:"),f=l&&i.slice(7);if(f&&f in n){const A=`${f==="modelValue"?"model":f}Modifiers`,{number:U,trim:w}=n[A]||lt;w&&(r=a.map(L=>L.trim())),U&&(r=a.map(Tc))}let g,T=n[g=Hi(i)]||n[g=Hi(pr(i))];!T&&l&&(T=n[g=Hi(_n(i))]),T&&ar(T,t,6,r);const m=n[g+"Once"];if(m){if(!t.emitted)t.emitted={};else if(t.emitted[g])return;t.emitted[g]=!0,ar(m,t,6,r)}}function Yo(t,i,a=!1){const n=i.emitsCache,r=n.get(t);if(r!==void 0)return r;const l=t.emits;let f={},g=!1;if(!ze(t)){const T=m=>{const A=Yo(m,i,!0);A&&(g=!0,Mt(f,A))};!a&&i.mixins.length&&i.mixins.forEach(T),t.extends&&T(t.extends),t.mixins&&t.mixins.forEach(T)}return!l&&!g?(vt(t)&&n.set(t,null),null):(We(l)?l.forEach(T=>f[T]=null):Mt(f,l),vt(t)&&n.set(t,f),f)}function Ri(t,i){return!t||!Ei(i)?!1:(i=i.slice(2).replace(/Once$/,""),Ze(t,i[0].toLowerCase()+i.slice(1))||Ze(t,_n(i))||Ze(t,i))}let hr=null,zo=null;function vi(t){const i=hr;return hr=t,zo=t&&t.type.__scopeId||null,i}function hf(t,i=hr,a){if(!i||t._n)return t;const n=(...r)=>{n._d&&js(-1);const l=vi(i);let f;try{f=t(...r)}finally{vi(l),n._d&&js(1)}return f};return n._n=!0,n._c=!0,n._d=!0,n}function Yi(t){const{type:i,vnode:a,proxy:n,withProxy:r,props:l,propsOptions:[f],slots:g,attrs:T,emit:m,render:A,renderCache:U,data:w,setupState:L,ctx:K,inheritAttrs:F}=t;let j,$;const X=vi(t);try{if(a.shapeFlag&4){const J=r||n;j=cr(A.call(J,J,U,l,L,w,K)),$=T}else{const J=i;j=cr(J.length>1?J(l,{attrs:T,slots:g,emit:m}):J(l,null)),$=i.props?T:gf(T)}}catch(J){Fn.length=0,ki(J,t,1),j=$t(Vn)}let se=j;if($&&F!==!1){const J=Object.keys($),{shapeFlag:re}=se;J.length&&re&7&&(f&&J.some(Ca)&&($=pf($,f)),se=vn(se,$))}return a.dirs&&(se=vn(se),se.dirs=se.dirs?se.dirs.concat(a.dirs):a.dirs),a.transition&&(se.transition=a.transition),j=se,vi(X),j}const gf=t=>{let i;for(const a in t)(a==="class"||a==="style"||Ei(a))&&((i||(i={}))[a]=t[a]);return i},pf=(t,i)=>{const a={};for(const n in t)(!Ca(n)||!(n.slice(9)in i))&&(a[n]=t[n]);return a};function vf(t,i,a){const{props:n,children:r,component:l}=t,{props:f,children:g,patchFlag:T}=i,m=l.emitsOptions;if(i.dirs||i.transition)return!0;if(a&&T>=0){if(T&1024)return!0;if(T&16)return n?Ns(n,f,m):!!f;if(T&8){const A=i.dynamicProps;for(let U=0;U<A.length;U++){const w=A[U];if(f[w]!==n[w]&&!Ri(m,w))return!0}}}else return(r||g)&&(!g||!g.$stable)?!0:n===f?!1:n?f?Ns(n,f,m):!0:!!f;return!1}function Ns(t,i,a){const n=Object.keys(i);if(n.length!==Object.keys(t).length)return!0;for(let r=0;r<n.length;r++){const l=n[r];if(i[l]!==t[l]&&!Ri(a,l))return!0}return!1}function mf({vnode:t,parent:i},a){for(;i&&i.subTree===t;)(t=i.vnode).el=a,i=i.parent}const yf=t=>t.__isSuspense;function Af(t,i){i&&i.pendingBranch?We(t)?i.effects.push(...t):i.effects.push(t):cf(t)}function Ef(t,i){if(wt){let a=wt.provides;const n=wt.parent&&wt.parent.provides;n===a&&(a=wt.provides=Object.create(n)),a[t]=i}}function zi(t,i,a=!1){const n=wt||hr;if(n){const r=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return a&&ze(i)?i.call(n.proxy):i}}const Fs={};function Wi(t,i,a){return Wo(t,i,a)}function Wo(t,i,{immediate:a,deep:n,flush:r,onTrack:l,onTrigger:f}=lt){const g=wt;let T,m=!1,A=!1;if(Ot(t)?(T=()=>t.value,m=pi(t)):fn(t)?(T=()=>t,n=!0):We(t)?(A=!0,m=t.some($=>fn($)||pi($)),T=()=>t.map($=>{if(Ot($))return $.value;if(fn($))return un($);if(ze($))return Lr($,g,2)})):ze(t)?i?T=()=>Lr(t,g,2):T=()=>{if(!(g&&g.isUnmounted))return U&&U(),ar(t,g,3,[w])}:T=ir,i&&n){const $=T;T=()=>un($())}let U,w=$=>{U=j.onStop=()=>{Lr($,g,4)}};if(Hn)return w=ir,i?a&&ar(i,g,3,[T(),A?[]:void 0,w]):T(),ir;let L=A?[]:Fs;const K=()=>{if(!!j.active)if(i){const $=j.run();(n||m||(A?$.some((X,se)=>Mn(X,L[se])):Mn($,L)))&&(U&&U(),ar(i,g,3,[$,L===Fs?void 0:L,w]),L=$)}else j.run()};K.allowRecurse=!!i;let F;r==="sync"?F=K:r==="post"?F=()=>Ut(K,g&&g.suspense):(K.pre=!0,g&&(K.id=g.uid),F=()=>Ka(K));const j=new Da(T,F);return i?a?K():L=j.run():r==="post"?Ut(j.run.bind(j),g&&g.suspense):j.run(),()=>{j.stop(),g&&g.scope&&wa(g.scope.effects,j)}}function _f(t,i,a){const n=this.proxy,r=Dt(t)?t.includes(".")?$o(n,t):()=>n[t]:t.bind(n,n);let l;ze(i)?l=i:(l=i.handler,a=i);const f=wt;mn(this);const g=Wo(r,l.bind(n),a);return f?mn(f):Zr(),g}function $o(t,i){const a=i.split(".");return()=>{let n=t;for(let r=0;r<a.length&&n;r++)n=n[a[r]];return n}}function un(t,i){if(!vt(t)||t.__v_skip||(i=i||new Set,i.has(t)))return t;if(i.add(t),Ot(t))un(t.value,i);else if(We(t))for(let a=0;a<t.length;a++)un(t[a],i);else if(mc(t)||Nn(t))t.forEach(a=>{un(a,i)});else if(Ec(t))for(const a in t)un(t[a],i);return t}function Xo(t){return ze(t)?{setup:t,name:t.name}:t}const di=t=>!!t.type.__asyncLoader,qo=t=>t.type.__isKeepAlive;function bf(t,i){Zo(t,"a",i)}function Tf(t,i){Zo(t,"da",i)}function Zo(t,i,a=wt){const n=t.__wdc||(t.__wdc=()=>{let r=a;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Ci(i,n,a),a){let r=a.parent;for(;r&&r.parent;)qo(r.parent.vnode)&&xf(n,i,a,r),r=r.parent}}function xf(t,i,a,n){const r=Ci(i,t,n,!0);el(()=>{wa(n[i],r)},a)}function Ci(t,i,a=wt,n=!1){if(a){const r=a[t]||(a[t]=[]),l=i.__weh||(i.__weh=(...f)=>{if(a.isUnmounted)return;bn(),mn(a);const g=ar(i,a,t,f);return Zr(),Tn(),g});return n?r.unshift(l):r.push(l),l}}const Tr=t=>(i,a=wt)=>(!Hn||t==="sp")&&Ci(t,(...n)=>i(...n),a),Sf=Tr("bm"),Qo=Tr("m"),kf=Tr("bu"),Rf=Tr("u"),Jo=Tr("bum"),el=Tr("um"),Cf=Tr("sp"),wf=Tr("rtg"),Lf=Tr("rtc");function If(t,i=wt){Ci("ec",t,i)}function Gr(t,i,a,n){const r=t.dirs,l=i&&i.dirs;for(let f=0;f<r.length;f++){const g=r[f];l&&(g.oldValue=l[f].value);let T=g.dir[n];T&&(bn(),ar(T,a,8,[t.el,g,t,i]),Tn())}}const tl="components";function Of(t,i){return Pf(tl,t,!0,i)||t}const Df=Symbol();function Pf(t,i,a=!0,n=!1){const r=hr||wt;if(r){const l=r.type;if(t===tl){const g=hd(l,!1);if(g&&(g===i||g===pr(i)||g===Ti(pr(i))))return l}const f=Ms(r[t]||l[t],i)||Ms(r.appContext[t],i);return!f&&n?l:f}}function Ms(t,i){return t&&(t[i]||t[pr(i)]||t[Ti(pr(i))])}const la=t=>t?dl(t)?Ya(t)||t.proxy:la(t.parent):null,mi=Mt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>la(t.parent),$root:t=>la(t.root),$emit:t=>t.emit,$options:t=>Va(t),$forceUpdate:t=>t.f||(t.f=()=>Ka(t.update)),$nextTick:t=>t.n||(t.n=oa.bind(t.proxy)),$watch:t=>_f.bind(t)}),Nf={get({_:t},i){const{ctx:a,setupState:n,data:r,props:l,accessCache:f,type:g,appContext:T}=t;let m;if(i[0]!=="$"){const L=f[i];if(L!==void 0)switch(L){case 1:return n[i];case 2:return r[i];case 4:return a[i];case 3:return l[i]}else{if(n!==lt&&Ze(n,i))return f[i]=1,n[i];if(r!==lt&&Ze(r,i))return f[i]=2,r[i];if((m=t.propsOptions[0])&&Ze(m,i))return f[i]=3,l[i];if(a!==lt&&Ze(a,i))return f[i]=4,a[i];ua&&(f[i]=0)}}const A=mi[i];let U,w;if(A)return i==="$attrs"&&Gt(t,"get",i),A(t);if((U=g.__cssModules)&&(U=U[i]))return U;if(a!==lt&&Ze(a,i))return f[i]=4,a[i];if(w=T.config.globalProperties,Ze(w,i))return w[i]},set({_:t},i,a){const{data:n,setupState:r,ctx:l}=t;return r!==lt&&Ze(r,i)?(r[i]=a,!0):n!==lt&&Ze(n,i)?(n[i]=a,!0):Ze(t.props,i)||i[0]==="$"&&i.slice(1)in t?!1:(l[i]=a,!0)},has({_:{data:t,setupState:i,accessCache:a,ctx:n,appContext:r,propsOptions:l}},f){let g;return!!a[f]||t!==lt&&Ze(t,f)||i!==lt&&Ze(i,f)||(g=l[0])&&Ze(g,f)||Ze(n,f)||Ze(mi,f)||Ze(r.config.globalProperties,f)},defineProperty(t,i,a){return a.get!=null?t._.accessCache[i]=0:Ze(a,"value")&&this.set(t,i,a.value,null),Reflect.defineProperty(t,i,a)}};let ua=!0;function Ff(t){const i=Va(t),a=t.proxy,n=t.ctx;ua=!1,i.beforeCreate&&Bs(i.beforeCreate,t,"bc");const{data:r,computed:l,methods:f,watch:g,provide:T,inject:m,created:A,beforeMount:U,mounted:w,beforeUpdate:L,updated:K,activated:F,deactivated:j,beforeDestroy:$,beforeUnmount:X,destroyed:se,unmounted:J,render:re,renderTracked:he,renderTriggered:ye,errorCaptured:be,serverPrefetch:Y,expose:W,inheritAttrs:ge,components:Z,directives:q,filters:oe}=i;if(m&&Mf(m,n,null,t.appContext.config.unwrapInjectedRef),f)for(const Ee in f){const Te=f[Ee];ze(Te)&&(n[Ee]=Te.bind(a))}if(r){const Ee=r.call(a,a);vt(Ee)&&(t.data=Si(Ee))}if(ua=!0,l)for(const Ee in l){const Te=l[Ee],Re=ze(Te)?Te.bind(a,a):ze(Te.get)?Te.get.bind(a,a):ir,Pe=!ze(Te)&&ze(Te.set)?Te.set.bind(a):ir,Oe=pd({get:Re,set:Pe});Object.defineProperty(n,Ee,{enumerable:!0,configurable:!0,get:()=>Oe.value,set:ke=>Oe.value=ke})}if(g)for(const Ee in g)rl(g[Ee],n,a,Ee);if(T){const Ee=ze(T)?T.call(a):T;Reflect.ownKeys(Ee).forEach(Te=>{Ef(Te,Ee[Te])})}A&&Bs(A,t,"c");function Ae(Ee,Te){We(Te)?Te.forEach(Re=>Ee(Re.bind(a))):Te&&Ee(Te.bind(a))}if(Ae(Sf,U),Ae(Qo,w),Ae(kf,L),Ae(Rf,K),Ae(bf,F),Ae(Tf,j),Ae(If,be),Ae(Lf,he),Ae(wf,ye),Ae(Jo,X),Ae(el,J),Ae(Cf,Y),We(W))if(W.length){const Ee=t.exposed||(t.exposed={});W.forEach(Te=>{Object.defineProperty(Ee,Te,{get:()=>a[Te],set:Re=>a[Te]=Re})})}else t.exposed||(t.exposed={});re&&t.render===ir&&(t.render=re),ge!=null&&(t.inheritAttrs=ge),Z&&(t.components=Z),q&&(t.directives=q)}function Mf(t,i,a=ir,n=!1){We(t)&&(t=ca(t));for(const r in t){const l=t[r];let f;vt(l)?"default"in l?f=zi(l.from||r,l.default,!0):f=zi(l.from||r):f=zi(l),Ot(f)&&n?Object.defineProperty(i,r,{enumerable:!0,configurable:!0,get:()=>f.value,set:g=>f.value=g}):i[r]=f}}function Bs(t,i,a){ar(We(t)?t.map(n=>n.bind(i.proxy)):t.bind(i.proxy),i,a)}function rl(t,i,a,n){const r=n.includes(".")?$o(a,n):()=>a[n];if(Dt(t)){const l=i[t];ze(l)&&Wi(r,l)}else if(ze(t))Wi(r,t.bind(a));else if(vt(t))if(We(t))t.forEach(l=>rl(l,i,a,n));else{const l=ze(t.handler)?t.handler.bind(a):i[t.handler];ze(l)&&Wi(r,l,t)}}function Va(t){const i=t.type,{mixins:a,extends:n}=i,{mixins:r,optionsCache:l,config:{optionMergeStrategies:f}}=t.appContext,g=l.get(i);let T;return g?T=g:!r.length&&!a&&!n?T=i:(T={},r.length&&r.forEach(m=>yi(T,m,f,!0)),yi(T,i,f)),vt(i)&&l.set(i,T),T}function yi(t,i,a,n=!1){const{mixins:r,extends:l}=i;l&&yi(t,l,a,!0),r&&r.forEach(f=>yi(t,f,a,!0));for(const f in i)if(!(n&&f==="expose")){const g=Bf[f]||a&&a[f];t[f]=g?g(t[f],i[f]):i[f]}return t}const Bf={data:Us,props:jr,emits:jr,methods:jr,computed:jr,beforeCreate:Ft,created:Ft,beforeMount:Ft,mounted:Ft,beforeUpdate:Ft,updated:Ft,beforeDestroy:Ft,beforeUnmount:Ft,destroyed:Ft,unmounted:Ft,activated:Ft,deactivated:Ft,errorCaptured:Ft,serverPrefetch:Ft,components:jr,directives:jr,watch:Kf,provide:Us,inject:Uf};function Us(t,i){return i?t?function(){return Mt(ze(t)?t.call(this,this):t,ze(i)?i.call(this,this):i)}:i:t}function Uf(t,i){return jr(ca(t),ca(i))}function ca(t){if(We(t)){const i={};for(let a=0;a<t.length;a++)i[t[a]]=t[a];return i}return t}function Ft(t,i){return t?[...new Set([].concat(t,i))]:i}function jr(t,i){return t?Mt(Mt(Object.create(null),t),i):i}function Kf(t,i){if(!t)return i;if(!i)return t;const a=Mt(Object.create(null),t);for(const n in i)a[n]=Ft(t[n],i[n]);return a}function Vf(t,i,a,n=!1){const r={},l={};gi(l,wi,1),t.propsDefaults=Object.create(null),nl(t,i,r,l);for(const f in t.propsOptions[0])f in r||(r[f]=void 0);a?t.props=n?r:Qc(r):t.type.props?t.props=r:t.props=l,t.attrs=l}function Gf(t,i,a,n){const{props:r,attrs:l,vnode:{patchFlag:f}}=t,g=rt(r),[T]=t.propsOptions;let m=!1;if((n||f>0)&&!(f&16)){if(f&8){const A=t.vnode.dynamicProps;for(let U=0;U<A.length;U++){let w=A[U];if(Ri(t.emitsOptions,w))continue;const L=i[w];if(T)if(Ze(l,w))L!==l[w]&&(l[w]=L,m=!0);else{const K=pr(w);r[K]=fa(T,g,K,L,t,!1)}else L!==l[w]&&(l[w]=L,m=!0)}}}else{nl(t,i,r,l)&&(m=!0);let A;for(const U in g)(!i||!Ze(i,U)&&((A=_n(U))===U||!Ze(i,A)))&&(T?a&&(a[U]!==void 0||a[A]!==void 0)&&(r[U]=fa(T,g,U,void 0,t,!0)):delete r[U]);if(l!==g)for(const U in l)(!i||!Ze(i,U)&&!0)&&(delete l[U],m=!0)}m&&br(t,"set","$attrs")}function nl(t,i,a,n){const[r,l]=t.propsOptions;let f=!1,g;if(i)for(let T in i){if(fi(T))continue;const m=i[T];let A;r&&Ze(r,A=pr(T))?!l||!l.includes(A)?a[A]=m:(g||(g={}))[A]=m:Ri(t.emitsOptions,T)||(!(T in n)||m!==n[T])&&(n[T]=m,f=!0)}if(l){const T=rt(a),m=g||lt;for(let A=0;A<l.length;A++){const U=l[A];a[U]=fa(r,T,U,m[U],t,!Ze(m,U))}}return f}function fa(t,i,a,n,r,l){const f=t[a];if(f!=null){const g=Ze(f,"default");if(g&&n===void 0){const T=f.default;if(f.type!==Function&&ze(T)){const{propsDefaults:m}=r;a in m?n=m[a]:(mn(r),n=m[a]=T.call(null,i),Zr())}else n=T}f[0]&&(l&&!g?n=!1:f[1]&&(n===""||n===_n(a))&&(n=!0))}return n}function il(t,i,a=!1){const n=i.propsCache,r=n.get(t);if(r)return r;const l=t.props,f={},g=[];let T=!1;if(!ze(t)){const A=U=>{T=!0;const[w,L]=il(U,i,!0);Mt(f,w),L&&g.push(...L)};!a&&i.mixins.length&&i.mixins.forEach(A),t.extends&&A(t.extends),t.mixins&&t.mixins.forEach(A)}if(!l&&!T)return vt(t)&&n.set(t,cn),cn;if(We(l))for(let A=0;A<l.length;A++){const U=pr(l[A]);Ks(U)&&(f[U]=lt)}else if(l)for(const A in l){const U=pr(A);if(Ks(U)){const w=l[A],L=f[U]=We(w)||ze(w)?{type:w}:w;if(L){const K=Hs(Boolean,L.type),F=Hs(String,L.type);L[0]=K>-1,L[1]=F<0||K<F,(K>-1||Ze(L,"default"))&&g.push(U)}}}const m=[f,g];return vt(t)&&n.set(t,m),m}function Ks(t){return t[0]!=="$"}function Vs(t){const i=t&&t.toString().match(/^\s*function (\w+)/);return i?i[1]:t===null?"null":""}function Gs(t,i){return Vs(t)===Vs(i)}function Hs(t,i){return We(i)?i.findIndex(a=>Gs(a,t)):ze(i)&&Gs(i,t)?0:-1}const al=t=>t[0]==="_"||t==="$stable",Ga=t=>We(t)?t.map(cr):[cr(t)],Hf=(t,i,a)=>{if(i._n)return i;const n=hf((...r)=>Ga(i(...r)),a);return n._c=!1,n},sl=(t,i,a)=>{const n=t._ctx;for(const r in t){if(al(r))continue;const l=t[r];if(ze(l))i[r]=Hf(r,l,n);else if(l!=null){const f=Ga(l);i[r]=()=>f}}},ol=(t,i)=>{const a=Ga(i);t.slots.default=()=>a},jf=(t,i)=>{if(t.vnode.shapeFlag&32){const a=i._;a?(t.slots=rt(i),gi(i,"_",a)):sl(i,t.slots={})}else t.slots={},i&&ol(t,i);gi(t.slots,wi,1)},Yf=(t,i,a)=>{const{vnode:n,slots:r}=t;let l=!0,f=lt;if(n.shapeFlag&32){const g=i._;g?a&&g===1?l=!1:(Mt(r,i),!a&&g===1&&delete r._):(l=!i.$stable,sl(i,r)),f=i}else i&&(ol(t,i),f={default:1});if(l)for(const g in r)!al(g)&&!(g in f)&&delete r[g]};function ll(){return{app:null,config:{isNativeTag:gc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zf=0;function Wf(t,i){return function(n,r=null){ze(n)||(n=Object.assign({},n)),r!=null&&!vt(r)&&(r=null);const l=ll(),f=new Set;let g=!1;const T=l.app={_uid:zf++,_component:n,_props:r,_container:null,_context:l,_instance:null,version:md,get config(){return l.config},set config(m){},use(m,...A){return f.has(m)||(m&&ze(m.install)?(f.add(m),m.install(T,...A)):ze(m)&&(f.add(m),m(T,...A))),T},mixin(m){return l.mixins.includes(m)||l.mixins.push(m),T},component(m,A){return A?(l.components[m]=A,T):l.components[m]},directive(m,A){return A?(l.directives[m]=A,T):l.directives[m]},mount(m,A,U){if(!g){const w=$t(n,r);return w.appContext=l,A&&i?i(w,m):t(w,m,U),g=!0,T._container=m,m.__vue_app__=T,Ya(w.component)||w.component.proxy}},unmount(){g&&(t(null,T._container),delete T._container.__vue_app__)},provide(m,A){return l.provides[m]=A,T}};return T}}function da(t,i,a,n,r=!1){if(We(t)){t.forEach((w,L)=>da(w,i&&(We(i)?i[L]:i),a,n,r));return}if(di(n)&&!r)return;const l=n.shapeFlag&4?Ya(n.component)||n.component.proxy:n.el,f=r?null:l,{i:g,r:T}=t,m=i&&i.r,A=g.refs===lt?g.refs={}:g.refs,U=g.setupState;if(m!=null&&m!==T&&(Dt(m)?(A[m]=null,Ze(U,m)&&(U[m]=null)):Ot(m)&&(m.value=null)),ze(T))Lr(T,g,12,[f,A]);else{const w=Dt(T),L=Ot(T);if(w||L){const K=()=>{if(t.f){const F=w?Ze(U,T)?U[T]:A[T]:T.value;r?We(F)&&wa(F,l):We(F)?F.includes(l)||F.push(l):w?(A[T]=[l],Ze(U,T)&&(U[T]=A[T])):(T.value=[l],t.k&&(A[t.k]=T.value))}else w?(A[T]=f,Ze(U,T)&&(U[T]=f)):L&&(T.value=f,t.k&&(A[t.k]=f))};f?(K.id=-1,Ut(K,a)):K()}}}const Ut=Af;function $f(t){return Xf(t)}function Xf(t,i){const a=xc();a.__VUE__=!0;const{insert:n,remove:r,patchProp:l,createElement:f,createText:g,createComment:T,setText:m,setElementText:A,parentNode:U,nextSibling:w,setScopeId:L=ir,insertStaticContent:K}=t,F=(B,G,ee,ie=null,ue=null,pe=null,E=!1,D=null,_=!!G.dynamicChildren)=>{if(B===G)return;B&&!On(B,G)&&(ie=Me(B),ke(B,ue,pe,!0),B=null),G.patchFlag===-2&&(_=!1,G.dynamicChildren=null);const{type:k,ref:R,shapeFlag:v}=G;switch(k){case Ha:j(B,G,ee,ie);break;case Vn:$(B,G,ee,ie);break;case $i:B==null&&X(G,ee,ie,E);break;case Er:Z(B,G,ee,ie,ue,pe,E,D,_);break;default:v&1?re(B,G,ee,ie,ue,pe,E,D,_):v&6?q(B,G,ee,ie,ue,pe,E,D,_):(v&64||v&128)&&k.process(B,G,ee,ie,ue,pe,E,D,_,ot)}R!=null&&ue&&da(R,B&&B.ref,pe,G||B,!G)},j=(B,G,ee,ie)=>{if(B==null)n(G.el=g(G.children),ee,ie);else{const ue=G.el=B.el;G.children!==B.children&&m(ue,G.children)}},$=(B,G,ee,ie)=>{B==null?n(G.el=T(G.children||""),ee,ie):G.el=B.el},X=(B,G,ee,ie)=>{[B.el,B.anchor]=K(B.children,G,ee,ie,B.el,B.anchor)},se=({el:B,anchor:G},ee,ie)=>{let ue;for(;B&&B!==G;)ue=w(B),n(B,ee,ie),B=ue;n(G,ee,ie)},J=({el:B,anchor:G})=>{let ee;for(;B&&B!==G;)ee=w(B),r(B),B=ee;r(G)},re=(B,G,ee,ie,ue,pe,E,D,_)=>{E=E||G.type==="svg",B==null?he(G,ee,ie,ue,pe,E,D,_):Y(B,G,ue,pe,E,D,_)},he=(B,G,ee,ie,ue,pe,E,D)=>{let _,k;const{type:R,props:v,shapeFlag:S,transition:I,dirs:N}=B;if(_=B.el=f(B.type,pe,v&&v.is,v),S&8?A(_,B.children):S&16&&be(B.children,_,null,ie,ue,pe&&R!=="foreignObject",E,D),N&&Gr(B,null,ie,"created"),v){for(const V in v)V!=="value"&&!fi(V)&&l(_,V,null,v[V],pe,B.children,ie,ue,dt);"value"in v&&l(_,"value",null,v.value),(k=v.onVnodeBeforeMount)&&lr(k,ie,B)}ye(_,B,B.scopeId,E,ie),N&&Gr(B,null,ie,"beforeMount");const M=(!ue||ue&&!ue.pendingBranch)&&I&&!I.persisted;M&&I.beforeEnter(_),n(_,G,ee),((k=v&&v.onVnodeMounted)||M||N)&&Ut(()=>{k&&lr(k,ie,B),M&&I.enter(_),N&&Gr(B,null,ie,"mounted")},ue)},ye=(B,G,ee,ie,ue)=>{if(ee&&L(B,ee),ie)for(let pe=0;pe<ie.length;pe++)L(B,ie[pe]);if(ue){let pe=ue.subTree;if(G===pe){const E=ue.vnode;ye(B,E,E.scopeId,E.slotScopeIds,ue.parent)}}},be=(B,G,ee,ie,ue,pe,E,D,_=0)=>{for(let k=_;k<B.length;k++){const R=B[k]=D?Rr(B[k]):cr(B[k]);F(null,R,G,ee,ie,ue,pe,E,D)}},Y=(B,G,ee,ie,ue,pe,E)=>{const D=G.el=B.el;let{patchFlag:_,dynamicChildren:k,dirs:R}=G;_|=B.patchFlag&16;const v=B.props||lt,S=G.props||lt;let I;ee&&Hr(ee,!1),(I=S.onVnodeBeforeUpdate)&&lr(I,ee,G,B),R&&Gr(G,B,ee,"beforeUpdate"),ee&&Hr(ee,!0);const N=ue&&G.type!=="foreignObject";if(k?W(B.dynamicChildren,k,D,ee,ie,N,pe):E||Te(B,G,D,null,ee,ie,N,pe,!1),_>0){if(_&16)ge(D,G,v,S,ee,ie,ue);else if(_&2&&v.class!==S.class&&l(D,"class",null,S.class,ue),_&4&&l(D,"style",v.style,S.style,ue),_&8){const M=G.dynamicProps;for(let V=0;V<M.length;V++){const z=M[V],ae=v[z],le=S[z];(le!==ae||z==="value")&&l(D,z,ae,le,ue,B.children,ee,ie,dt)}}_&1&&B.children!==G.children&&A(D,G.children)}else!E&&k==null&&ge(D,G,v,S,ee,ie,ue);((I=S.onVnodeUpdated)||R)&&Ut(()=>{I&&lr(I,ee,G,B),R&&Gr(G,B,ee,"updated")},ie)},W=(B,G,ee,ie,ue,pe,E)=>{for(let D=0;D<G.length;D++){const _=B[D],k=G[D],R=_.el&&(_.type===Er||!On(_,k)||_.shapeFlag&70)?U(_.el):ee;F(_,k,R,null,ie,ue,pe,E,!0)}},ge=(B,G,ee,ie,ue,pe,E)=>{if(ee!==ie){if(ee!==lt)for(const D in ee)!fi(D)&&!(D in ie)&&l(B,D,ee[D],null,E,G.children,ue,pe,dt);for(const D in ie){if(fi(D))continue;const _=ie[D],k=ee[D];_!==k&&D!=="value"&&l(B,D,k,_,E,G.children,ue,pe,dt)}"value"in ie&&l(B,"value",ee.value,ie.value)}},Z=(B,G,ee,ie,ue,pe,E,D,_)=>{const k=G.el=B?B.el:g(""),R=G.anchor=B?B.anchor:g("");let{patchFlag:v,dynamicChildren:S,slotScopeIds:I}=G;I&&(D=D?D.concat(I):I),B==null?(n(k,ee,ie),n(R,ee,ie),be(G.children,ee,R,ue,pe,E,D,_)):v>0&&v&64&&S&&B.dynamicChildren?(W(B.dynamicChildren,S,ee,ue,pe,E,D),(G.key!=null||ue&&G===ue.subTree)&&ul(B,G,!0)):Te(B,G,ee,R,ue,pe,E,D,_)},q=(B,G,ee,ie,ue,pe,E,D,_)=>{G.slotScopeIds=D,B==null?G.shapeFlag&512?ue.ctx.activate(G,ee,ie,E,_):oe(G,ee,ie,ue,pe,E,_):xe(B,G,_)},oe=(B,G,ee,ie,ue,pe,E)=>{const D=B.component=ld(B,ie,ue);if(qo(B)&&(D.ctx.renderer=ot),ud(D),D.asyncDep){if(ue&&ue.registerDep(D,Ae),!B.el){const _=D.subTree=$t(Vn);$(null,_,G,ee)}return}Ae(D,B,G,ee,ue,pe,E)},xe=(B,G,ee)=>{const ie=G.component=B.component;if(vf(B,G,ee))if(ie.asyncDep&&!ie.asyncResolved){Ee(ie,G,ee);return}else ie.next=G,uf(ie.update),ie.update();else G.el=B.el,ie.vnode=G},Ae=(B,G,ee,ie,ue,pe,E)=>{const D=()=>{if(B.isMounted){let{next:R,bu:v,u:S,parent:I,vnode:N}=B,M=R,V;Hr(B,!1),R?(R.el=N.el,Ee(B,R,E)):R=N,v&&ji(v),(V=R.props&&R.props.onVnodeBeforeUpdate)&&lr(V,I,R,N),Hr(B,!0);const z=Yi(B),ae=B.subTree;B.subTree=z,F(ae,z,U(ae.el),Me(ae),B,ue,pe),R.el=z.el,M===null&&mf(B,z.el),S&&Ut(S,ue),(V=R.props&&R.props.onVnodeUpdated)&&Ut(()=>lr(V,I,R,N),ue)}else{let R;const{el:v,props:S}=G,{bm:I,m:N,parent:M}=B,V=di(G);if(Hr(B,!1),I&&ji(I),!V&&(R=S&&S.onVnodeBeforeMount)&&lr(R,M,G),Hr(B,!0),v&&St){const z=()=>{B.subTree=Yi(B),St(v,B.subTree,B,ue,null)};V?G.type.__asyncLoader().then(()=>!B.isUnmounted&&z()):z()}else{const z=B.subTree=Yi(B);F(null,z,ee,ie,B,ue,pe),G.el=z.el}if(N&&Ut(N,ue),!V&&(R=S&&S.onVnodeMounted)){const z=G;Ut(()=>lr(R,M,z),ue)}(G.shapeFlag&256||M&&di(M.vnode)&&M.vnode.shapeFlag&256)&&B.a&&Ut(B.a,ue),B.isMounted=!0,G=ee=ie=null}},_=B.effect=new Da(D,()=>Ka(k),B.scope),k=B.update=()=>_.run();k.id=B.uid,Hr(B,!0),k()},Ee=(B,G,ee)=>{G.component=B;const ie=B.vnode.props;B.vnode=G,B.next=null,Gf(B,G.props,ie,ee),Yf(B,G.children,ee),bn(),Ps(),Tn()},Te=(B,G,ee,ie,ue,pe,E,D,_=!1)=>{const k=B&&B.children,R=B?B.shapeFlag:0,v=G.children,{patchFlag:S,shapeFlag:I}=G;if(S>0){if(S&128){Pe(k,v,ee,ie,ue,pe,E,D,_);return}else if(S&256){Re(k,v,ee,ie,ue,pe,E,D,_);return}}I&8?(R&16&&dt(k,ue,pe),v!==k&&A(ee,v)):R&16?I&16?Pe(k,v,ee,ie,ue,pe,E,D,_):dt(k,ue,pe,!0):(R&8&&A(ee,""),I&16&&be(v,ee,ie,ue,pe,E,D,_))},Re=(B,G,ee,ie,ue,pe,E,D,_)=>{B=B||cn,G=G||cn;const k=B.length,R=G.length,v=Math.min(k,R);let S;for(S=0;S<v;S++){const I=G[S]=_?Rr(G[S]):cr(G[S]);F(B[S],I,ee,null,ue,pe,E,D,_)}k>R?dt(B,ue,pe,!0,!1,v):be(G,ee,ie,ue,pe,E,D,_,v)},Pe=(B,G,ee,ie,ue,pe,E,D,_)=>{let k=0;const R=G.length;let v=B.length-1,S=R-1;for(;k<=v&&k<=S;){const I=B[k],N=G[k]=_?Rr(G[k]):cr(G[k]);if(On(I,N))F(I,N,ee,null,ue,pe,E,D,_);else break;k++}for(;k<=v&&k<=S;){const I=B[v],N=G[S]=_?Rr(G[S]):cr(G[S]);if(On(I,N))F(I,N,ee,null,ue,pe,E,D,_);else break;v--,S--}if(k>v){if(k<=S){const I=S+1,N=I<R?G[I].el:ie;for(;k<=S;)F(null,G[k]=_?Rr(G[k]):cr(G[k]),ee,N,ue,pe,E,D,_),k++}}else if(k>S)for(;k<=v;)ke(B[k],ue,pe,!0),k++;else{const I=k,N=k,M=new Map;for(k=N;k<=S;k++){const me=G[k]=_?Rr(G[k]):cr(G[k]);me.key!=null&&M.set(me.key,k)}let V,z=0;const ae=S-N+1;let le=!1,ne=0;const ve=new Array(ae);for(k=0;k<ae;k++)ve[k]=0;for(k=I;k<=v;k++){const me=B[k];if(z>=ae){ke(me,ue,pe,!0);continue}let ce;if(me.key!=null)ce=M.get(me.key);else for(V=N;V<=S;V++)if(ve[V-N]===0&&On(me,G[V])){ce=V;break}ce===void 0?ke(me,ue,pe,!0):(ve[ce-N]=k+1,ce>=ne?ne=ce:le=!0,F(me,G[ce],ee,null,ue,pe,E,D,_),z++)}const de=le?qf(ve):cn;for(V=de.length-1,k=ae-1;k>=0;k--){const me=N+k,ce=G[me],we=me+1<R?G[me+1].el:ie;ve[k]===0?F(null,ce,ee,we,ue,pe,E,D,_):le&&(V<0||k!==de[V]?Oe(ce,ee,we,2):V--)}}},Oe=(B,G,ee,ie,ue=null)=>{const{el:pe,type:E,transition:D,children:_,shapeFlag:k}=B;if(k&6){Oe(B.component.subTree,G,ee,ie);return}if(k&128){B.suspense.move(G,ee,ie);return}if(k&64){E.move(B,G,ee,ot);return}if(E===Er){n(pe,G,ee);for(let v=0;v<_.length;v++)Oe(_[v],G,ee,ie);n(B.anchor,G,ee);return}if(E===$i){se(B,G,ee);return}if(ie!==2&&k&1&&D)if(ie===0)D.beforeEnter(pe),n(pe,G,ee),Ut(()=>D.enter(pe),ue);else{const{leave:v,delayLeave:S,afterLeave:I}=D,N=()=>n(pe,G,ee),M=()=>{v(pe,()=>{N(),I&&I()})};S?S(pe,N,M):M()}else n(pe,G,ee)},ke=(B,G,ee,ie=!1,ue=!1)=>{const{type:pe,props:E,ref:D,children:_,dynamicChildren:k,shapeFlag:R,patchFlag:v,dirs:S}=B;if(D!=null&&da(D,null,ee,B,!0),R&256){G.ctx.deactivate(B);return}const I=R&1&&S,N=!di(B);let M;if(N&&(M=E&&E.onVnodeBeforeUnmount)&&lr(M,G,B),R&6)mt(B.component,ee,ie);else{if(R&128){B.suspense.unmount(ee,ie);return}I&&Gr(B,null,G,"beforeUnmount"),R&64?B.type.remove(B,G,ee,ue,ot,ie):k&&(pe!==Er||v>0&&v&64)?dt(k,G,ee,!1,!0):(pe===Er&&v&384||!ue&&R&16)&&dt(_,G,ee),ie&&Ne(B)}(N&&(M=E&&E.onVnodeUnmounted)||I)&&Ut(()=>{M&&lr(M,G,B),I&&Gr(B,null,G,"unmounted")},ee)},Ne=B=>{const{type:G,el:ee,anchor:ie,transition:ue}=B;if(G===Er){qe(ee,ie);return}if(G===$i){J(B);return}const pe=()=>{r(ee),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(B.shapeFlag&1&&ue&&!ue.persisted){const{leave:E,delayLeave:D}=ue,_=()=>E(ee,pe);D?D(B.el,pe,_):_()}else pe()},qe=(B,G)=>{let ee;for(;B!==G;)ee=w(B),r(B),B=ee;r(G)},mt=(B,G,ee)=>{const{bum:ie,scope:ue,update:pe,subTree:E,um:D}=B;ie&&ji(ie),ue.stop(),pe&&(pe.active=!1,ke(E,B,G,ee)),D&&Ut(D,G),Ut(()=>{B.isUnmounted=!0},G),G&&G.pendingBranch&&!G.isUnmounted&&B.asyncDep&&!B.asyncResolved&&B.suspenseId===G.pendingId&&(G.deps--,G.deps===0&&G.resolve())},dt=(B,G,ee,ie=!1,ue=!1,pe=0)=>{for(let E=pe;E<B.length;E++)ke(B[E],G,ee,ie,ue)},Me=B=>B.shapeFlag&6?Me(B.component.subTree):B.shapeFlag&128?B.suspense.next():w(B.anchor||B.el),st=(B,G,ee)=>{B==null?G._vnode&&ke(G._vnode,null,null,!0):F(G._vnode||null,B,G,null,null,null,ee),Ps(),Ho(),G._vnode=B},ot={p:F,um:ke,m:Oe,r:Ne,mt:oe,mc:be,pc:Te,pbc:W,n:Me,o:t};let pt,St;return i&&([pt,St]=i(ot)),{render:st,hydrate:pt,createApp:Wf(st,pt)}}function Hr({effect:t,update:i},a){t.allowRecurse=i.allowRecurse=a}function ul(t,i,a=!1){const n=t.children,r=i.children;if(We(n)&&We(r))for(let l=0;l<n.length;l++){const f=n[l];let g=r[l];g.shapeFlag&1&&!g.dynamicChildren&&((g.patchFlag<=0||g.patchFlag===32)&&(g=r[l]=Rr(r[l]),g.el=f.el),a||ul(f,g))}}function qf(t){const i=t.slice(),a=[0];let n,r,l,f,g;const T=t.length;for(n=0;n<T;n++){const m=t[n];if(m!==0){if(r=a[a.length-1],t[r]<m){i[n]=r,a.push(n);continue}for(l=0,f=a.length-1;l<f;)g=l+f>>1,t[a[g]]<m?l=g+1:f=g;m<t[a[l]]&&(l>0&&(i[n]=a[l-1]),a[l]=n)}}for(l=a.length,f=a[l-1];l-- >0;)a[l]=f,f=i[f];return a}const Zf=t=>t.__isTeleport,Er=Symbol(void 0),Ha=Symbol(void 0),Vn=Symbol(void 0),$i=Symbol(void 0),Fn=[];let rr=null;function Qf(t=!1){Fn.push(rr=t?null:[])}function Jf(){Fn.pop(),rr=Fn[Fn.length-1]||null}let Gn=1;function js(t){Gn+=t}function ed(t){return t.dynamicChildren=Gn>0?rr||cn:null,Jf(),Gn>0&&rr&&rr.push(t),t}function td(t,i,a,n,r,l){return ed(fl(t,i,a,n,r,l,!0))}function ha(t){return t?t.__v_isVNode===!0:!1}function On(t,i){return t.type===i.type&&t.key===i.key}const wi="__vInternal",cl=({key:t})=>t!=null?t:null,hi=({ref:t,ref_key:i,ref_for:a})=>t!=null?Dt(t)||Ot(t)||ze(t)?{i:hr,r:t,k:i,f:!!a}:t:null;function fl(t,i=null,a=null,n=0,r=null,l=t===Er?0:1,f=!1,g=!1){const T={__v_isVNode:!0,__v_skip:!0,type:t,props:i,key:i&&cl(i),ref:i&&hi(i),scopeId:zo,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null};return g?(ja(T,a),l&128&&t.normalize(T)):a&&(T.shapeFlag|=Dt(a)?8:16),Gn>0&&!f&&rr&&(T.patchFlag>0||l&6)&&T.patchFlag!==32&&rr.push(T),T}const $t=rd;function rd(t,i=null,a=null,n=0,r=null,l=!1){if((!t||t===Df)&&(t=Vn),ha(t)){const g=vn(t,i,!0);return a&&ja(g,a),Gn>0&&!l&&rr&&(g.shapeFlag&6?rr[rr.indexOf(t)]=g:rr.push(g)),g.patchFlag|=-2,g}if(gd(t)&&(t=t.__vccOpts),i){i=nd(i);let{class:g,style:T}=i;g&&!Dt(g)&&(i.class=Ra(g)),vt(T)&&(No(T)&&!We(T)&&(T=Mt({},T)),i.style=ka(T))}const f=Dt(t)?1:yf(t)?128:Zf(t)?64:vt(t)?4:ze(t)?2:0;return fl(t,i,a,n,r,f,l,!0)}function nd(t){return t?No(t)||wi in t?Mt({},t):t:null}function vn(t,i,a=!1){const{props:n,ref:r,patchFlag:l,children:f}=t,g=i?ad(n||{},i):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:g,key:g&&cl(g),ref:i&&i.ref?a&&r?We(r)?r.concat(hi(i)):[r,hi(i)]:hi(i):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:f,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:i&&t.type!==Er?l===-1?16:l|16:l,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&vn(t.ssContent),ssFallback:t.ssFallback&&vn(t.ssFallback),el:t.el,anchor:t.anchor}}function id(t=" ",i=0){return $t(Ha,null,t,i)}function cr(t){return t==null||typeof t=="boolean"?$t(Vn):We(t)?$t(Er,null,t.slice()):typeof t=="object"?Rr(t):$t(Ha,null,String(t))}function Rr(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:vn(t)}function ja(t,i){let a=0;const{shapeFlag:n}=t;if(i==null)i=null;else if(We(i))a=16;else if(typeof i=="object")if(n&65){const r=i.default;r&&(r._c&&(r._d=!1),ja(t,r()),r._c&&(r._d=!0));return}else{a=32;const r=i._;!r&&!(wi in i)?i._ctx=hr:r===3&&hr&&(hr.slots._===1?i._=1:(i._=2,t.patchFlag|=1024))}else ze(i)?(i={default:i,_ctx:hr},a=32):(i=String(i),n&64?(a=16,i=[id(i)]):a=8);t.children=i,t.shapeFlag|=a}function ad(...t){const i={};for(let a=0;a<t.length;a++){const n=t[a];for(const r in n)if(r==="class")i.class!==n.class&&(i.class=Ra([i.class,n.class]));else if(r==="style")i.style=ka([i.style,n.style]);else if(Ei(r)){const l=i[r],f=n[r];f&&l!==f&&!(We(l)&&l.includes(f))&&(i[r]=l?[].concat(l,f):f)}else r!==""&&(i[r]=n[r])}return i}function lr(t,i,a,n=null){ar(t,i,7,[a,n])}const sd=ll();let od=0;function ld(t,i,a){const n=t.type,r=(i?i.appContext:t.appContext)||sd,l={uid:od++,vnode:t,type:n,parent:i,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new Sc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:i?i.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:il(n,r),emitsOptions:Yo(n,r),emit:null,emitted:null,propsDefaults:lt,inheritAttrs:n.inheritAttrs,ctx:lt,data:lt,props:lt,attrs:lt,slots:lt,refs:lt,setupState:lt,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=i?i.root:l,l.emit=df.bind(null,l),t.ce&&t.ce(l),l}let wt=null;const mn=t=>{wt=t,t.scope.on()},Zr=()=>{wt&&wt.scope.off(),wt=null};function dl(t){return t.vnode.shapeFlag&4}let Hn=!1;function ud(t,i=!1){Hn=i;const{props:a,children:n}=t.vnode,r=dl(t);Vf(t,a,r,i),jf(t,n);const l=r?cd(t,i):void 0;return Hn=!1,l}function cd(t,i){const a=t.type;t.accessCache=Object.create(null),t.proxy=Fo(new Proxy(t.ctx,Nf));const{setup:n}=a;if(n){const r=t.setupContext=n.length>1?dd(t):null;mn(t),bn();const l=Lr(n,t,0,[t.props,r]);if(Tn(),Zr(),To(l)){if(l.then(Zr,Zr),i)return l.then(f=>{Ys(t,f,i)}).catch(f=>{ki(f,t,0)});t.asyncDep=l}else Ys(t,l,i)}else hl(t,i)}function Ys(t,i,a){ze(i)?t.type.__ssrInlineRender?t.ssrRender=i:t.render=i:vt(i)&&(t.setupState=Uo(i)),hl(t,a)}let zs;function hl(t,i,a){const n=t.type;if(!t.render){if(!i&&zs&&!n.render){const r=n.template||Va(t).template;if(r){const{isCustomElement:l,compilerOptions:f}=t.appContext.config,{delimiters:g,compilerOptions:T}=n,m=Mt(Mt({isCustomElement:l,delimiters:g},f),T);n.render=zs(r,m)}}t.render=n.render||ir}mn(t),bn(),Ff(t),Tn(),Zr()}function fd(t){return new Proxy(t.attrs,{get(i,a){return Gt(t,"get","$attrs"),i[a]}})}function dd(t){const i=n=>{t.exposed=n||{}};let a;return{get attrs(){return a||(a=fd(t))},slots:t.slots,emit:t.emit,expose:i}}function Ya(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Uo(Fo(t.exposed)),{get(i,a){if(a in i)return i[a];if(a in mi)return mi[a](t)}}))}function hd(t,i=!0){return ze(t)?t.displayName||t.name:t.name||i&&t.__name}function gd(t){return ze(t)&&"__vccOpts"in t}const pd=(t,i)=>sf(t,i,Hn);function vd(t,i,a){const n=arguments.length;return n===2?vt(i)&&!We(i)?ha(i)?$t(t,null,[i]):$t(t,i):$t(t,null,i):(n>3?a=Array.prototype.slice.call(arguments,2):n===3&&ha(a)&&(a=[a]),$t(t,i,a))}const md="3.2.41",yd="http://www.w3.org/2000/svg",Wr=typeof document<"u"?document:null,Ws=Wr&&Wr.createElement("template"),Ad={insert:(t,i,a)=>{i.insertBefore(t,a||null)},remove:t=>{const i=t.parentNode;i&&i.removeChild(t)},createElement:(t,i,a,n)=>{const r=i?Wr.createElementNS(yd,t):Wr.createElement(t,a?{is:a}:void 0);return t==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:t=>Wr.createTextNode(t),createComment:t=>Wr.createComment(t),setText:(t,i)=>{t.nodeValue=i},setElementText:(t,i)=>{t.textContent=i},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Wr.querySelector(t),setScopeId(t,i){t.setAttribute(i,"")},insertStaticContent(t,i,a,n,r,l){const f=a?a.previousSibling:i.lastChild;if(r&&(r===l||r.nextSibling))for(;i.insertBefore(r.cloneNode(!0),a),!(r===l||!(r=r.nextSibling)););else{Ws.innerHTML=n?`<svg>${t}</svg>`:t;const g=Ws.content;if(n){const T=g.firstChild;for(;T.firstChild;)g.appendChild(T.firstChild);g.removeChild(T)}i.insertBefore(g,a)}return[f?f.nextSibling:i.firstChild,a?a.previousSibling:i.lastChild]}};function Ed(t,i,a){const n=t._vtc;n&&(i=(i?[i,...n]:[...n]).join(" ")),i==null?t.removeAttribute("class"):a?t.setAttribute("class",i):t.className=i}function _d(t,i,a){const n=t.style,r=Dt(a);if(a&&!r){for(const l in a)ga(n,l,a[l]);if(i&&!Dt(i))for(const l in i)a[l]==null&&ga(n,l,"")}else{const l=n.display;r?i!==a&&(n.cssText=a):i&&t.removeAttribute("style"),"_vod"in t&&(n.display=l)}}const $s=/\s*!important$/;function ga(t,i,a){if(We(a))a.forEach(n=>ga(t,i,n));else if(a==null&&(a=""),i.startsWith("--"))t.setProperty(i,a);else{const n=bd(t,i);$s.test(a)?t.setProperty(_n(n),a.replace($s,""),"important"):t[n]=a}}const Xs=["Webkit","Moz","ms"],Xi={};function bd(t,i){const a=Xi[i];if(a)return a;let n=pr(i);if(n!=="filter"&&n in t)return Xi[i]=n;n=Ti(n);for(let r=0;r<Xs.length;r++){const l=Xs[r]+n;if(l in t)return Xi[i]=l}return i}const qs="http://www.w3.org/1999/xlink";function Td(t,i,a,n,r){if(n&&i.startsWith("xlink:"))a==null?t.removeAttributeNS(qs,i.slice(6,i.length)):t.setAttributeNS(qs,i,a);else{const l=cc(i);a==null||l&&!bo(a)?t.removeAttribute(i):t.setAttribute(i,l?"":a)}}function xd(t,i,a,n,r,l,f){if(i==="innerHTML"||i==="textContent"){n&&f(n,r,l),t[i]=a==null?"":a;return}if(i==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=a;const T=a==null?"":a;(t.value!==T||t.tagName==="OPTION")&&(t.value=T),a==null&&t.removeAttribute(i);return}let g=!1;if(a===""||a==null){const T=typeof t[i];T==="boolean"?a=bo(a):a==null&&T==="string"?(a="",g=!0):T==="number"&&(a=0,g=!0)}try{t[i]=a}catch{}g&&t.removeAttribute(i)}function Sd(t,i,a,n){t.addEventListener(i,a,n)}function kd(t,i,a,n){t.removeEventListener(i,a,n)}function Rd(t,i,a,n,r=null){const l=t._vei||(t._vei={}),f=l[i];if(n&&f)f.value=n;else{const[g,T]=Cd(i);if(n){const m=l[i]=Id(n,r);Sd(t,g,m,T)}else f&&(kd(t,g,f,T),l[i]=void 0)}}const Zs=/(?:Once|Passive|Capture)$/;function Cd(t){let i;if(Zs.test(t)){i={};let n;for(;n=t.match(Zs);)t=t.slice(0,t.length-n[0].length),i[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):_n(t.slice(2)),i]}let qi=0;const wd=Promise.resolve(),Ld=()=>qi||(wd.then(()=>qi=0),qi=Date.now());function Id(t,i){const a=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=a.attached)return;ar(Od(n,a.value),i,5,[n])};return a.value=t,a.attached=Ld(),a}function Od(t,i){if(We(i)){const a=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{a.call(t),t._stopped=!0},i.map(n=>r=>!r._stopped&&n&&n(r))}else return i}const Qs=/^on[a-z]/,Dd=(t,i,a,n,r=!1,l,f,g,T)=>{i==="class"?Ed(t,n,r):i==="style"?_d(t,a,n):Ei(i)?Ca(i)||Rd(t,i,a,n,f):(i[0]==="."?(i=i.slice(1),!0):i[0]==="^"?(i=i.slice(1),!1):Pd(t,i,n,r))?xd(t,i,n,l,f,g,T):(i==="true-value"?t._trueValue=n:i==="false-value"&&(t._falseValue=n),Td(t,i,n,r))};function Pd(t,i,a,n){return n?!!(i==="innerHTML"||i==="textContent"||i in t&&Qs.test(i)&&ze(a)):i==="spellcheck"||i==="draggable"||i==="translate"||i==="form"||i==="list"&&t.tagName==="INPUT"||i==="type"&&t.tagName==="TEXTAREA"||Qs.test(i)&&Dt(a)?!1:i in t}const Nd=Mt({patchProp:Dd},Ad);let Js;function Fd(){return Js||(Js=$f(Nd))}const Md=(...t)=>{const i=Fd().createApp(...t),{mount:a}=i;return i.mount=n=>{const r=Bd(n);if(!r)return;const l=i._component;!ze(l)&&!l.render&&!l.template&&(l.template=r.innerHTML),r.innerHTML="";const f=a(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),f},i};function Bd(t){return Dt(t)?document.querySelector(t):t}function eo(t,i){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),a.push.apply(a,n)}return a}function oi(t){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?eo(Object(a),!0).forEach(function(n){Ud(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):eo(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function yn(t){return yn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},yn(t)}function it(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function to(t,i){for(var a=0;a<i.length;a++){var n=i[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function at(t,i,a){return i&&to(t.prototype,i),a&&to(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ud(t,i,a){return i in t?Object.defineProperty(t,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[i]=a,t}function Et(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&pa(t,i)}function _r(t){return _r=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_r(t)}function pa(t,i){return pa=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},pa(t,i)}function Kd(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Li(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vd(t,i){if(i&&(typeof i=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Li(t)}function _t(t){var i=Kd();return function(){var n=_r(t),r;if(i){var l=_r(this).constructor;r=Reflect.construct(n,arguments,l)}else r=n.apply(this,arguments);return Vd(this,r)}}function Gd(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&(t=_r(t),t!==null););return t}function Xr(){return typeof Reflect<"u"&&Reflect.get?Xr=Reflect.get:Xr=function(i,a,n){var r=Gd(i,a);if(!!r){var l=Object.getOwnPropertyDescriptor(r,a);return l.get?l.get.call(arguments.length<3?i:n):l.value}},Xr.apply(this,arguments)}function va(t,i){return jd(t)||zd(t,i)||za(t,i)||$d()}function hn(t){return Hd(t)||Yd(t)||za(t)||Wd()}function Hd(t){if(Array.isArray(t))return ma(t)}function jd(t){if(Array.isArray(t))return t}function Yd(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zd(t,i){var a=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(a!=null){var n=[],r=!0,l=!1,f,g;try{for(a=a.call(t);!(r=(f=a.next()).done)&&(n.push(f.value),!(i&&n.length===i));r=!0);}catch(T){l=!0,g=T}finally{try{!r&&a.return!=null&&a.return()}finally{if(l)throw g}}return n}}function za(t,i){if(!!t){if(typeof t=="string")return ma(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ma(t,i)}}function ma(t,i){(i==null||i>t.length)&&(i=t.length);for(var a=0,n=new Array(i);a<i;a++)n[a]=t[a];return n}function Wd(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gl(t,i){var a=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=za(t))||i&&t&&typeof t.length=="number"){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(T){throw T},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,f=!1,g;return{s:function(){a=a.call(t)},n:function(){var T=a.next();return l=T.done,T},e:function(T){f=!0,g=T},f:function(){try{!l&&a.return!=null&&a.return()}finally{if(f)throw g}}}}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(i){if(this==null)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(typeof i!="function")throw new TypeError("predicate must be a function");for(var r=arguments[1],l=0;l<n;){var f=a[l];if(i.call(r,f,l,a))return f;l++}}});Object.entries||(Object.entries=function(t){for(var i=Object.keys(t),a=i.length,n=new Array(a);a--;)n[a]=[i[a],t[i[a]]];return n});Object.values||(Object.values=function(t){for(var i=Object.keys(t),a=i.length,n=new Array(a);a--;)n[a]=t[i[a]];return n});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(i,a){if(i==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(i),r=1;r<arguments.length;r++){var l=arguments[r];if(l!=null)for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(n[f]=l[f])}return n},writable:!0,configurable:!0});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(i){if(this==null)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(typeof i!="function")throw new TypeError("predicate must be a function");for(var r=arguments[1],l=0;l<n;){var f=a[l];if(i.call(r,f,l,a))return l;l++}return-1},configurable:!0,writable:!0});var Xd="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",pl={mp4:Xd},Pr=function(){var t,i,a,n,r=[],l=r.concat,f=r.filter,g=r.slice,T=window.document,m={},A={},U={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},w=/^\s*<(\w+|!)[^>]*>/,L=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,K=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,F=/^(?:body|html)$/i,j=/([A-Z])/g,$=["val","css","html","text","data","width","height","offset"],X=["after","prepend","before","append"],se=T.createElement("table"),J=T.createElement("tr"),re={tr:T.createElement("tbody"),tbody:se,thead:se,tfoot:se,td:J,th:J,"*":T.createElement("div")},he=/complete|loaded|interactive/,ye=/^[\w-]*$/,be={},Y=be.toString,W={},ge,Z,q=T.createElement("div"),oe={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},xe=Array.isArray||function(E){return E instanceof Array};W.matches=function(E,D){if(!D||!E||E.nodeType!==1)return!1;var _=E.matches||E.webkitMatchesSelector||E.mozMatchesSelector||E.oMatchesSelector||E.matchesSelector;if(_)return _.call(E,D);var k,R=E.parentNode,v=!R;return v&&(R=q).appendChild(E),k=~W.qsa(R,D).indexOf(E),v&&q.removeChild(E),k};function Ae(E){return E==null?String(E):be[Y.call(E)]||"object"}function Ee(E){return Ae(E)=="function"}function Te(E){return E!=null&&E==E.window}function Re(E){return E!=null&&E.nodeType==E.DOCUMENT_NODE}function Pe(E){return Ae(E)=="object"}function Oe(E){return Pe(E)&&!Te(E)&&Object.getPrototypeOf(E)==Object.prototype}function ke(E){var D=!!E&&"length"in E&&E.length,_=a.type(E);return _!="function"&&!Te(E)&&(_=="array"||D===0||typeof D=="number"&&D>0&&D-1 in E)}function Ne(E){return f.call(E,function(D){return D!=null})}function qe(E){return E.length>0?a.fn.concat.apply([],E):E}ge=function(E){return E.replace(/-+(.)?/g,function(D,_){return _?_.toUpperCase():""})};function mt(E){return E.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}Z=function(E){return f.call(E,function(D,_){return E.indexOf(D)==_})};function dt(E){return E in A?A[E]:A[E]=new RegExp("(^|\\s)"+E+"(\\s|$)")}function Me(E,D){return typeof D=="number"&&!U[mt(E)]?D+"px":D}function st(E){var D,_;return m[E]||(D=T.createElement(E),T.body.appendChild(D),_=getComputedStyle(D,"").getPropertyValue("display"),D.parentNode.removeChild(D),_=="none"&&(_="block"),m[E]=_),m[E]}function ot(E){return"children"in E?g.call(E.children):a.map(E.childNodes,function(D){if(D.nodeType==1)return D})}function pt(E,D){var _,k=E?E.length:0;for(_=0;_<k;_++)this[_]=E[_];this.length=k,this.selector=D||""}W.fragment=function(E,D,_){var k,R,v;return L.test(E)&&(k=a(T.createElement(RegExp.$1))),k||(E.replace&&(E=E.replace(K,"<$1></$2>")),D===t&&(D=w.test(E)&&RegExp.$1),D in re||(D="*"),v=re[D],v.innerHTML=""+E,k=a.each(g.call(v.childNodes),function(){v.removeChild(this)})),Oe(_)&&(R=a(k),a.each(_,function(S,I){$.indexOf(S)>-1?R[S](I):R.attr(S,I)})),k},W.Z=function(E,D){return new pt(E,D)},W.isZ=function(E){return E instanceof W.Z},W.init=function(E,D){var _;if(E)if(typeof E=="string")if(E=E.trim(),E[0]=="<"&&w.test(E))_=W.fragment(E,RegExp.$1,D),E=null;else{if(D!==t)return a(D).find(E);_=W.qsa(T,E)}else{if(Ee(E))return a(T).ready(E);if(W.isZ(E))return E;if(xe(E))_=Ne(E);else if(Pe(E))_=[E],E=null;else if(w.test(E))_=W.fragment(E.trim(),RegExp.$1,D),E=null;else{if(D!==t)return a(D).find(E);_=W.qsa(T,E)}}else return W.Z();return W.Z(_,E)},a=function(E,D){return W.init(E,D)};function St(E,D,_){for(i in D)_&&(Oe(D[i])||xe(D[i]))?(Oe(D[i])&&!Oe(E[i])&&(E[i]={}),xe(D[i])&&!xe(E[i])&&(E[i]=[]),St(E[i],D[i],_)):D[i]!==t&&(E[i]=D[i])}a.extend=function(E){var D,_=g.call(arguments,1);return typeof E=="boolean"&&(D=E,E=_.shift()),_.forEach(function(k){St(E,k,D)}),E},W.qsa=function(E,D){var _,k=D[0]=="#",R=!k&&D[0]==".",v=k||R?D.slice(1):D,S=ye.test(v);return E.getElementById&&S&&k?(_=E.getElementById(v))?[_]:[]:E.nodeType!==1&&E.nodeType!==9&&E.nodeType!==11?[]:g.call(S&&!k&&E.getElementsByClassName?R?E.getElementsByClassName(v):E.getElementsByTagName(D):E.querySelectorAll(D))};function B(E,D){return D==null?a(E):a(E).filter(D)}a.contains=T.documentElement.contains?function(E,D){return E!==D&&E.contains(D)}:function(E,D){for(;D&&(D=D.parentNode);)if(D===E)return!0;return!1};function G(E,D,_,k){return Ee(D)?D.call(E,_,k):D}function ee(E,D,_){_==null?E.removeAttribute(D):E.setAttribute(D,_)}function ie(E,D){var _=E.className||"",k=_&&_.baseVal!==t;if(D===t)return k?_.baseVal:_;k?_.baseVal=D:E.className=D}function ue(E){try{return E&&(E=="true"||(E=="false"?!1:E=="null"?null:+E+""==E?+E:/^[\[\{]/.test(E)?a.parseJSON(E):E))}catch{return E}}a.type=Ae,a.isFunction=Ee,a.isWindow=Te,a.isArray=xe,a.isPlainObject=Oe,a.isEmptyObject=function(E){var D;for(D in E)return!1;return!0},a.isNumeric=function(E){var D=Number(E),_=typeof E;return E!=null&&_!="boolean"&&(_!="string"||E.length)&&!isNaN(D)&&isFinite(D)||!1},a.inArray=function(E,D,_){return r.indexOf.call(D,E,_)},a.camelCase=ge,a.trim=function(E){return E==null?"":String.prototype.trim.call(E)},a.uuid=0,a.support={},a.expr={},a.noop=function(){},a.map=function(E,D){var _,k=[],R,v;if(ke(E))for(R=0;R<E.length;R++)_=D(E[R],R),_!=null&&k.push(_);else for(v in E)_=D(E[v],v),_!=null&&k.push(_);return qe(k)},a.each=function(E,D){var _,k;if(ke(E)){for(_=0;_<E.length;_++)if(D.call(E[_],_,E[_])===!1)return E}else for(k in E)if(D.call(E[k],k,E[k])===!1)return E;return E},a.grep=function(E,D){return f.call(E,D)},window.JSON&&(a.parseJSON=JSON.parse),a.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(E,D){be["[object "+D+"]"]=D.toLowerCase()}),a.fn={constructor:W.Z,length:0,forEach:r.forEach,reduce:r.reduce,push:r.push,sort:r.sort,splice:r.splice,indexOf:r.indexOf,concat:function(){var E,D,_=[];for(E=0;E<arguments.length;E++)D=arguments[E],_[E]=W.isZ(D)?D.toArray():D;return l.apply(W.isZ(this)?this.toArray():this,_)},map:function(E){return a(a.map(this,function(D,_){return E.call(D,_,D)}))},slice:function(){return a(g.apply(this,arguments))},ready:function(E){return he.test(T.readyState)&&T.body?E(a):T.addEventListener("DOMContentLoaded",function(){E(a)},!1),this},get:function(E){return E===t?g.call(this):this[E>=0?E:E+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(E){return r.every.call(this,function(D,_){return E.call(D,_,D)!==!1}),this},filter:function(E){return Ee(E)?this.not(this.not(E)):a(f.call(this,function(D){return W.matches(D,E)}))},add:function(E,D){return a(Z(this.concat(a(E,D))))},is:function(E){return this.length>0&&W.matches(this[0],E)},not:function(E){var D=[];if(Ee(E)&&E.call!==t)this.each(function(k){E.call(this,k)||D.push(this)});else{var _=typeof E=="string"?this.filter(E):ke(E)&&Ee(E.item)?g.call(E):a(E);this.forEach(function(k){_.indexOf(k)<0&&D.push(k)})}return a(D)},has:function(E){return this.filter(function(){return Pe(E)?a.contains(this,E):a(this).find(E).size()})},eq:function(E){return E===-1?this.slice(E):this.slice(E,+E+1)},first:function(){var E=this[0];return E&&!Pe(E)?E:a(E)},last:function(){var E=this[this.length-1];return E&&!Pe(E)?E:a(E)},find:function(E){var D,_=this;return E?typeof E=="object"?D=a(E).filter(function(){var k=this;return r.some.call(_,function(R){return a.contains(R,k)})}):this.length==1?D=a(W.qsa(this[0],E)):D=this.map(function(){return W.qsa(this,E)}):D=a(),D},closest:function(E,D){var _=[],k=typeof E=="object"&&a(E);return this.each(function(R,v){for(;v&&!(k?k.indexOf(v)>=0:W.matches(v,E));)v=v!==D&&!Re(v)&&v.parentNode;v&&_.indexOf(v)<0&&_.push(v)}),a(_)},parents:function(E){for(var D=[],_=this;_.length>0;)_=a.map(_,function(k){if((k=k.parentNode)&&!Re(k)&&D.indexOf(k)<0)return D.push(k),k});return B(D,E)},parent:function(E){return B(Z(this.pluck("parentNode")),E)},children:function(E){return B(this.map(function(){return ot(this)}),E)},contents:function(){return this.map(function(){return this.contentDocument||g.call(this.childNodes)})},siblings:function(E){return B(this.map(function(D,_){return f.call(ot(_.parentNode),function(k){return k!==_})}),E)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(E){return a.map(this,function(D){return D[E]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=st(this.nodeName))})},replaceWith:function(E){return this.before(E).remove()},wrap:function(E){var D=Ee(E);if(this[0]&&!D)var _=a(E).get(0),k=_.parentNode||this.length>1;return this.each(function(R){a(this).wrapAll(D?E.call(this,R):k?_.cloneNode(!0):_)})},wrapAll:function(E){if(this[0]){a(this[0]).before(E=a(E));for(var D;(D=E.children()).length;)E=D.first();a(E).append(this)}return this},wrapInner:function(E){var D=Ee(E);return this.each(function(_){var k=a(this),R=k.contents(),v=D?E.call(this,_):E;R.length?R.wrapAll(v):k.append(v)})},unwrap:function(){return this.parent().each(function(){a(this).replaceWith(a(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(E){return this.each(function(){var D=a(this);(E===t?D.css("display")=="none":E)?D.show():D.hide()})},prev:function(E){return a(this.pluck("previousElementSibling")).filter(E||"*")},next:function(E){return a(this.pluck("nextElementSibling")).filter(E||"*")},html:function(E){return 0 in arguments?this.each(function(D){var _=this.innerHTML;a(this).empty().append(G(this,E,D,_))}):0 in this?this[0].innerHTML:null},text:function(E){return 0 in arguments?this.each(function(D){var _=G(this,E,D,this.textContent);this.textContent=_==null?"":""+_}):0 in this?this.pluck("textContent").join(""):null},attr:function(E,D){var _;return typeof E=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&(_=this[0].getAttribute(E))!=null?_:t:this.each(function(k){if(this.nodeType===1)if(Pe(E))for(i in E)ee(this,i,E[i]);else ee(this,E,G(this,D,k,this.getAttribute(E)))})},removeAttr:function(E){return this.each(function(){this.nodeType===1&&E.split(" ").forEach(function(D){ee(this,D)},this)})},prop:function(E,D){return E=oe[E]||E,1 in arguments?this.each(function(_){this[E]=G(this,D,_,this[E])}):this[0]&&this[0][E]},removeProp:function(E){return E=oe[E]||E,this.each(function(){delete this[E]})},data:function(E,D){var _="data-"+E.replace(j,"-$1").toLowerCase(),k=1 in arguments?this.attr(_,D):this.attr(_);return k!==null?ue(k):t},val:function(E){return 0 in arguments?(E==null&&(E=""),this.each(function(D){this.value=G(this,E,D,this.value)})):this[0]&&(this[0].multiple?a(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(E){if(E)return this.each(function(_){var k=a(this),R=G(this,E,_,k.offset()),v=k.offsetParent().offset(),S={top:R.top-v.top,left:R.left-v.left};k.css("position")=="static"&&(S.position="relative"),k.css(S)});if(!this.length)return null;if(T.documentElement!==this[0]&&!a.contains(T.documentElement,this[0]))return{top:0,left:0};var D=this[0].getBoundingClientRect();return{left:D.left+window.pageXOffset,top:D.top+window.pageYOffset,width:Math.round(D.width),height:Math.round(D.height)}},css:function(E,D){if(arguments.length<2){var _=this[0];if(typeof E=="string")return _?_.style[ge(E)]||getComputedStyle(_,"").getPropertyValue(E):void 0;if(xe(E)){if(!_)return;var k={},R=getComputedStyle(_,"");return a.each(E,function(S,I){k[I]=_.style[ge(I)]||R.getPropertyValue(I)}),k}}var v="";if(Ae(E)=="string")!D&&D!==0?this.each(function(){this.style.removeProperty(mt(E))}):v=mt(E)+":"+Me(E,D);else for(i in E)!E[i]&&E[i]!==0?this.each(function(){this.style.removeProperty(mt(i))}):v+=mt(i)+":"+Me(i,E[i])+";";return this.each(function(){this.style.cssText+=";"+v})},index:function(E){return E?this.indexOf(a(E)[0]):this.parent().children().indexOf(this[0])},hasClass:function(E){return E?r.some.call(this,function(D){return this.test(ie(D))},dt(E)):!1},addClass:function(E){return E?this.each(function(D){if("className"in this){n=[];var _=ie(this),k=G(this,E,D,_);k.split(/\s+/g).forEach(function(R){a(this).hasClass(R)||n.push(R)},this),n.length&&ie(this,_+(_?" ":"")+n.join(" "))}}):this},removeClass:function(E){return this.each(function(D){if("className"in this){if(E===t)return ie(this,"");n=ie(this),G(this,E,D,n).split(/\s+/g).forEach(function(_){n=n.replace(dt(_)," ")}),ie(this,n.trim())}})},toggleClass:function(E,D){return E?this.each(function(_){var k=a(this),R=G(this,E,_,ie(this));R.split(/\s+/g).forEach(function(v){(D===t?!k.hasClass(v):D)?k.addClass(v):k.removeClass(v)})}):this},scrollTop:function(E){if(!!this.length){var D="scrollTop"in this[0];return E===t?D?this[0].scrollTop:this[0].pageYOffset:this.each(D?function(){this.scrollTop=E}:function(){this.scrollTo(this.scrollX,E)})}},scrollLeft:function(E){if(!!this.length){var D="scrollLeft"in this[0];return E===t?D?this[0].scrollLeft:this[0].pageXOffset:this.each(D?function(){this.scrollLeft=E}:function(){this.scrollTo(E,this.scrollY)})}},position:function(){if(!!this.length){var E=this[0],D=this.offsetParent(),_=this.offset(),k=F.test(D[0].nodeName)?{top:0,left:0}:D.offset();return _.top-=parseFloat(a(E).css("margin-top"))||0,_.left-=parseFloat(a(E).css("margin-left"))||0,k.top+=parseFloat(a(D[0]).css("border-top-width"))||0,k.left+=parseFloat(a(D[0]).css("border-left-width"))||0,{top:_.top-k.top,left:_.left-k.left}}},offsetParent:function(){return this.map(function(){for(var E=this.offsetParent||T.body;E&&!F.test(E.nodeName)&&a(E).css("position")=="static";)E=E.offsetParent;return E})}},a.fn.detach=a.fn.remove,["width","height"].forEach(function(E){var D=E.replace(/./,function(_){return _[0].toUpperCase()});a.fn[E]=function(_){var k,R=this[0];return _===t?Te(R)?R["inner"+D]:Re(R)?R.documentElement["scroll"+D]:(k=this.offset())&&k[E]:this.each(function(v){R=a(this),R.css(E,G(this,_,v,R[E]()))})}});function pe(E,D){D(E);for(var _=0,k=E.childNodes.length;_<k;_++)pe(E.childNodes[_],D)}return X.forEach(function(E,D){var _=D%2;a.fn[E]=function(){var k,R=a.map(arguments,function(I){var N=[];return k=Ae(I),k=="array"?(I.forEach(function(M){if(M.nodeType!==t)return N.push(M);if(a.zepto.isZ(M))return N=N.concat(M.get());N=N.concat(W.fragment(M))}),N):k=="object"||I==null?I:W.fragment(I)}),v,S=this.length>1;return R.length<1?this:this.each(function(I,N){v=_?N:N.parentNode,N=D==0?N.nextSibling:D==1?N.firstChild:D==2?N:null;var M=a.contains(T.documentElement,v);R.forEach(function(V){if(S)V=V.cloneNode(!0);else if(!v)return a(V).remove();v.insertBefore(V,N),M&&pe(V,function(z){if(z.nodeName!=null&&z.nodeName.toUpperCase()==="SCRIPT"&&(!z.type||z.type==="text/javascript")&&!z.src){var ae=z.ownerDocument?z.ownerDocument.defaultView:window;ae.eval.call(ae,z.innerHTML)}})})})},a.fn[_?E+"To":"insert"+(D?"Before":"After")]=function(k){return a(k)[E](this),this}}),W.Z.prototype=pt.prototype=a.fn,W.uniq=Z,W.deserializeValue=ue,a.zepto=W,a}();window.Zepto=Pr;window.$===void 0&&(window.$=Pr);(function(t){var i=+new Date,a=window.document,n,r,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,f=/^(?:text|application)\/javascript/i,g=/^(?:text|application)\/xml/i,T="application/json",m="text/html",A=/^\s*$/,U=a.createElement("a");U.href=window.location.href;function w(Z,q,oe){var xe=t.Event(q);return t(Z).trigger(xe,oe),!xe.isDefaultPrevented()}function L(Z,q,oe,xe){if(Z.global)return w(q||a,oe,xe)}t.active=0;function K(Z){Z.global&&t.active++===0&&L(Z,null,"ajaxStart")}function F(Z){Z.global&&!--t.active&&L(Z,null,"ajaxStop")}function j(Z,q){var oe=q.context;if(q.beforeSend.call(oe,Z,q)===!1||L(q,oe,"ajaxBeforeSend",[Z,q])===!1)return!1;L(q,oe,"ajaxSend",[Z,q])}function $(Z,q,oe,xe){var Ae=oe.context,Ee="success";oe.success.call(Ae,Z,Ee,q),xe&&xe.resolveWith(Ae,[Z,Ee,q]),L(oe,Ae,"ajaxSuccess",[q,oe,Z]),se(Ee,q,oe)}function X(Z,q,oe,xe,Ae){var Ee=xe.context;xe.error.call(Ee,oe,q,Z),Ae&&Ae.rejectWith(Ee,[oe,q,Z]),L(xe,Ee,"ajaxError",[oe,xe,Z||q]),se(q,oe,xe)}function se(Z,q,oe){var xe=oe.context;oe.complete.call(xe,q,Z),L(oe,xe,"ajaxComplete",[q,oe]),F(oe)}function J(Z,q,oe){if(oe.dataFilter==re)return Z;var xe=oe.context;return oe.dataFilter.call(xe,Z,q)}function re(){}t.ajaxJSONP=function(Z,q){if(!("type"in Z))return t.ajax(Z);var oe=Z.jsonpCallback,xe=(t.isFunction(oe)?oe():oe)||"Zepto"+i++,Ae=a.createElement("script"),Ee=window[xe],Te,Re=function(ke){t(Ae).triggerHandler("error",ke||"abort")},Pe={abort:Re},Oe;return q&&q.promise(Pe),t(Ae).on("load error",function(ke,Ne){clearTimeout(Oe),t(Ae).off().remove(),ke.type=="error"||!Te?X(null,Ne||"error",Pe,Z,q):$(Te[0],Pe,Z,q),window[xe]=Ee,Te&&t.isFunction(Ee)&&Ee(Te[0]),Ee=Te=void 0}),j(Pe,Z)===!1?(Re("abort"),Pe):(window[xe]=function(){Te=arguments},Ae.src=Z.url.replace(/\?(.+)=\?/,"?$1="+xe),a.head.appendChild(Ae),Z.timeout>0&&(Oe=setTimeout(function(){Re("timeout")},Z.timeout)),Pe)},t.ajaxSettings={type:"GET",beforeSend:re,success:re,error:re,complete:re,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:T,xml:"application/xml, text/xml",html:m,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:re};function he(Z){return Z&&(Z=Z.split(";",2)[0]),Z&&(Z==m?"html":Z==T?"json":f.test(Z)?"script":g.test(Z)&&"xml")||"text"}function ye(Z,q){return q==""?Z:(Z+"&"+q).replace(/[&?]{1,2}/,"?")}function be(Z){Z.processData&&Z.data&&t.type(Z.data)!="string"&&(Z.data=t.param(Z.data,Z.traditional)),Z.data&&(!Z.type||Z.type.toUpperCase()=="GET"||Z.dataType=="jsonp")&&(Z.url=ye(Z.url,Z.data),Z.data=void 0)}t.ajax=function(Z){var q=t.extend({},Z||{}),oe=t.Deferred&&t.Deferred(),xe,Ae;for(n in t.ajaxSettings)q[n]===void 0&&(q[n]=t.ajaxSettings[n]);K(q),q.crossDomain||(xe=a.createElement("a"),xe.href=q.url,xe.href=xe.href,q.crossDomain=U.protocol+"//"+U.host!=xe.protocol+"//"+xe.host),q.url||(q.url=window.location.toString()),(Ae=q.url.indexOf("#"))>-1&&(q.url=q.url.slice(0,Ae)),be(q);var Ee=q.dataType,Te=/\?.+=\?/.test(q.url);if(Te&&(Ee="jsonp"),(q.cache===!1||(!Z||Z.cache!==!0)&&(Ee=="script"||Ee=="jsonp"))&&(q.url=ye(q.url,"_="+Date.now())),Ee=="jsonp")return Te||(q.url=ye(q.url,q.jsonp?q.jsonp+"=?":q.jsonp===!1?"":"callback=?")),t.ajaxJSONP(q,oe);var Re=q.accepts[Ee],Pe={},Oe=function(Me,st){Pe[Me.toLowerCase()]=[Me,st]},ke=/^([\w-]+:)\/\//.test(q.url)?RegExp.$1:window.location.protocol,Ne=q.xhr(),qe=Ne.setRequestHeader,mt;if(oe&&oe.promise(Ne),q.crossDomain||Oe("X-Requested-With","XMLHttpRequest"),Oe("Accept",Re||"*/*"),(Re=q.mimeType||Re)&&(Re.indexOf(",")>-1&&(Re=Re.split(",",2)[0]),Ne.overrideMimeType&&Ne.overrideMimeType(Re)),(q.contentType||q.contentType!==!1&&q.data&&q.type.toUpperCase()!="GET")&&Oe("Content-Type",q.contentType||"application/x-www-form-urlencoded"),q.headers)for(r in q.headers)Oe(r,q.headers[r]);if(Ne.setRequestHeader=Oe,Ne.onreadystatechange=function(){if(Ne.readyState==4){Ne.onreadystatechange=re,clearTimeout(mt);var Me,st=!1;if(Ne.status>=200&&Ne.status<300||Ne.status==304||Ne.status==0&&ke=="file:"){if(Ee=Ee||he(q.mimeType||Ne.getResponseHeader("content-type")),Ne.responseType=="arraybuffer"||Ne.responseType=="blob")Me=Ne.response;else{Me=Ne.responseText;try{Me=J(Me,Ee,q),Ee=="script"?(0,eval)(Me):Ee=="xml"?Me=Ne.responseXML:Ee=="json"&&(Me=A.test(Me)?null:t.parseJSON(Me))}catch(ot){st=ot}if(st)return X(st,"parsererror",Ne,q,oe)}$(Me,Ne,q,oe)}else X(Ne.statusText||null,Ne.status?"error":"abort",Ne,q,oe)}},j(Ne,q)===!1)return Ne.abort(),X(null,"abort",Ne,q,oe),Ne;var dt="async"in q?q.async:!0;if(Ne.open(q.type,q.url,dt,q.username,q.password),q.xhrFields)for(r in q.xhrFields)Ne[r]=q.xhrFields[r];for(r in Pe)qe.apply(Ne,Pe[r]);return q.timeout>0&&(mt=setTimeout(function(){Ne.onreadystatechange=re,Ne.abort(),X(null,"timeout",Ne,q,oe)},q.timeout)),Ne.send(q.data?q.data:null),Ne};function Y(Z,q,oe,xe){return t.isFunction(q)&&(xe=oe,oe=q,q=void 0),t.isFunction(oe)||(xe=oe,oe=void 0),{url:Z,data:q,success:oe,dataType:xe}}t.get=function(){return t.ajax(Y.apply(null,arguments))},t.post=function(){var Z=Y.apply(null,arguments);return Z.type="POST",t.ajax(Z)},t.getJSON=function(){var Z=Y.apply(null,arguments);return Z.dataType="json",t.ajax(Z)},t.fn.load=function(Z,q,oe){if(!this.length)return this;var xe=this,Ae=Z.split(/\s/),Ee,Te=Y(Z,q,oe),Re=Te.success;return Ae.length>1&&(Te.url=Ae[0],Ee=Ae[1]),Te.success=function(Pe){xe.html(Ee?t("<div>").html(Pe.replace(l,"")).find(Ee):Pe),Re&&Re.apply(xe,arguments)},t.ajax(Te),this};var W=encodeURIComponent;function ge(Z,q,oe,xe){var Ae,Ee=t.isArray(q),Te=t.isPlainObject(q);t.each(q,function(Re,Pe){Ae=t.type(Pe),xe&&(Re=oe?xe:xe+"["+(Te||Ae=="object"||Ae=="array"?Re:"")+"]"),!xe&&Ee?Z.add(Pe.name,Pe.value):Ae=="array"||!oe&&Ae=="object"?ge(Z,Pe,oe,Re):Z.add(Re,Pe)})}t.param=function(Z,q){var oe=[];return oe.add=function(xe,Ae){t.isFunction(Ae)&&(Ae=Ae()),Ae==null&&(Ae=""),this.push(W(xe)+"="+W(Ae))},ge(oe,Z,q),oe.join("&").replace(/%20/g,"+")}})(Pr);(function(t){t.Callbacks=function(i){i=t.extend({},i);var a,n,r,l,f,g,T=[],m=!i.once&&[],A=function(w){for(a=i.memory&&w,n=!0,g=l||0,l=0,f=T.length,r=!0;T&&g<f;++g)if(T[g].apply(w[0],w[1])===!1&&i.stopOnFalse){a=!1;break}r=!1,T&&(m?m.length&&A(m.shift()):a?T.length=0:U.disable())},U={add:function(){if(T){var w=T.length,L=function(K){t.each(K,function(F,j){typeof j=="function"?(!i.unique||!U.has(j))&&T.push(j):j&&j.length&&typeof j!="string"&&L(j)})};L(arguments),r?f=T.length:a&&(l=w,A(a))}return this},remove:function(){return T&&t.each(arguments,function(w,L){for(var K;(K=t.inArray(L,T,K))>-1;)T.splice(K,1),r&&(K<=f&&--f,K<=g&&--g)}),this},has:function(w){return!!(T&&(w?t.inArray(w,T)>-1:T.length))},empty:function(){return f=T.length=0,this},disable:function(){return T=m=a=void 0,this},disabled:function(){return!T},lock:function(){return m=void 0,a||U.disable(),this},locked:function(){return!m},fireWith:function(w,L){return T&&(!n||m)&&(L=L||[],L=[w,L.slice?L.slice():L],r?m.push(L):A(L)),this},fire:function(){return U.fireWith(this,arguments)},fired:function(){return!!n}};return U}})(Pr);(function(t){var i=Array.prototype.slice;function a(n){var r=[["resolve","done",t.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",t.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",t.Callbacks({memory:1})]],l="pending",f={state:function(){return l},always:function(){return g.done(arguments).fail(arguments),this},then:function(){var T=arguments;return a(function(m){t.each(r,function(A,U){var w=t.isFunction(T[A])&&T[A];g[U[1]](function(){var L=w&&w.apply(this,arguments);if(L&&t.isFunction(L.promise))L.promise().done(m.resolve).fail(m.reject).progress(m.notify);else{var K=this===f?m.promise():this,F=w?[L]:arguments;m[U[0]+"With"](K,F)}})}),T=null}).promise()},promise:function(T){return T!=null?t.extend(T,f):f}},g={};return t.each(r,function(T,m){var A=m[2],U=m[3];f[m[1]]=A.add,U&&A.add(function(){l=U},r[T^1][2].disable,r[2][2].lock),g[m[0]]=function(){return g[m[0]+"With"](this===g?f:this,arguments),this},g[m[0]+"With"]=A.fireWith}),f.promise(g),n&&n.call(g,g),g}t.when=function(n){var r=i.call(arguments),l=r.length,f=0,g=l!==1||n&&t.isFunction(n.promise)?l:0,T=g===1?n:a(),m,A,U,w=function(L,K,F){return function(j){K[L]=this,F[L]=arguments.length>1?i.call(arguments):j,F===m?T.notifyWith(K,F):--g||T.resolveWith(K,F)}};if(l>1)for(m=new Array(l),A=new Array(l),U=new Array(l);f<l;++f)r[f]&&t.isFunction(r[f].promise)?r[f].promise().done(w(f,U,r)).fail(T.reject).progress(w(f,A,m)):--g;return g||T.resolveWith(U,r),T.promise()},t.Deferred=a})(Pr);(function(t){var i=1,a,n=Array.prototype.slice,r=t.isFunction,l=function(Y){return typeof Y=="string"},f={},g={},T="onfocusin"in window,m={focus:"focusin",blur:"focusout"},A={mouseenter:"mouseover",mouseleave:"mouseout"};g.click=g.mousedown=g.mouseup=g.mousemove="MouseEvents";function U(Y){return Y._zid||(Y._zid=i++)}function w(Y,W,ge,Z){if(W=L(W),W.ns)var q=K(W.ns);return(f[U(Y)]||[]).filter(function(oe){return oe&&(!W.e||oe.e==W.e)&&(!W.ns||q.test(oe.ns))&&(!ge||U(oe.fn)===U(ge))&&(!Z||oe.sel==Z)})}function L(Y){var W=(""+Y).split(".");return{e:W[0],ns:W.slice(1).sort().join(" ")}}function K(Y){return new RegExp("(?:^| )"+Y.replace(" "," .* ?")+"(?: |$)")}function F(Y,W){return Y.del&&!T&&Y.e in m||!!W}function j(Y){return A[Y]||T&&m[Y]||Y}function $(Y,W,ge,Z,q,oe,xe){var Ae=U(Y),Ee=f[Ae]||(f[Ae]=[]);W.split(/\s/).forEach(function(Te){if(Te=="ready")return t(document).ready(ge);var Re=L(Te);Re.fn=ge,Re.sel=q,Re.e in A&&(ge=function(Oe){var ke=Oe.relatedTarget;if(!ke||ke!==this&&!t.contains(this,ke))return Re.fn.apply(this,arguments)}),Re.del=oe;var Pe=oe||ge;Re.proxy=function(Oe){if(Oe=ye(Oe),!Oe.isImmediatePropagationStopped()){Oe.data=Z;var ke=Pe.apply(Y,Oe._args==a?[Oe]:[Oe].concat(Oe._args));return ke===!1&&(Oe.preventDefault(),Oe.stopPropagation()),ke}},Re.i=Ee.length,Ee.push(Re),"addEventListener"in Y&&Y.addEventListener(j(Re.e),Re.proxy,F(Re,xe))})}function X(Y,W,ge,Z,q){var oe=U(Y);(W||"").split(/\s/).forEach(function(xe){w(Y,xe,ge,Z).forEach(function(Ae){delete f[oe][Ae.i],"removeEventListener"in Y&&Y.removeEventListener(j(Ae.e),Ae.proxy,F(Ae,q))})})}t.event={add:$,remove:X},t.proxy=function(Y,W){var ge=2 in arguments&&n.call(arguments,2);if(r(Y)){var Z=function(){return Y.apply(W,ge?ge.concat(n.call(arguments)):arguments)};return Z._zid=U(Y),Z}else{if(l(W))return ge?(ge.unshift(Y[W],Y),t.proxy.apply(null,ge)):t.proxy(Y[W],Y);throw new TypeError("expected function")}},t.fn.bind=function(Y,W,ge){return this.on(Y,W,ge)},t.fn.unbind=function(Y,W){return this.off(Y,W)},t.fn.one=function(Y,W,ge,Z){return this.on(Y,W,ge,Z,1)};var se=function(){return!0},J=function(){return!1},re=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,he={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function ye(Y,W){return(W||!Y.isDefaultPrevented)&&(W||(W=Y),t.each(he,function(ge,Z){var q=W[ge];Y[ge]=function(){return this[Z]=se,q&&q.apply(W,arguments)},Y[Z]=J}),Y.timeStamp||(Y.timeStamp=Date.now()),(W.defaultPrevented!==a?W.defaultPrevented:"returnValue"in W?W.returnValue===!1:W.getPreventDefault&&W.getPreventDefault())&&(Y.isDefaultPrevented=se)),Y}function be(Y){var W,ge={originalEvent:Y};for(W in Y)!re.test(W)&&Y[W]!==a&&(ge[W]=Y[W]);return ye(ge,Y)}t.fn.delegate=function(Y,W,ge){return this.on(W,Y,ge)},t.fn.undelegate=function(Y,W,ge){return this.off(W,Y,ge)},t.fn.live=function(Y,W){return t(document.body).delegate(this.selector,Y,W),this},t.fn.die=function(Y,W){return t(document.body).undelegate(this.selector,Y,W),this},t.fn.on=function(Y,W,ge,Z,q){var oe,xe,Ae=this;return Y&&!l(Y)?(t.each(Y,function(Ee,Te){Ae.on(Ee,W,ge,Te,q)}),Ae):(!l(W)&&!r(Z)&&Z!==!1&&(Z=ge,ge=W,W=a),(Z===a||ge===!1)&&(Z=ge,ge=a),Z===!1&&(Z=J),Ae.each(function(Ee,Te){q&&(oe=function(Re){return X(Te,Re.type,Z),Z.apply(this,arguments)}),W&&(xe=function(Re){var Pe,Oe=t(Re.target).closest(W,Te).get(0);if(Oe&&Oe!==Te)return Pe=t.extend(be(Re),{currentTarget:Oe,liveFired:Te}),(oe||Z).apply(Oe,[Pe].concat(n.call(arguments,1)))}),$(Te,Y,Z,ge,W,xe||oe)}))},t.fn.off=function(Y,W,ge){var Z=this;return Y&&!l(Y)?(t.each(Y,function(q,oe){Z.off(q,W,oe)}),Z):(!l(W)&&!r(ge)&&ge!==!1&&(ge=W,W=a),ge===!1&&(ge=J),Z.each(function(){X(this,Y,ge,W)}))},t.fn.trigger=function(Y,W){return Y=l(Y)||t.isPlainObject(Y)?t.Event(Y):ye(Y),Y._args=W,this.each(function(){Y.type in m&&typeof this[Y.type]=="function"?this[Y.type]():"dispatchEvent"in this?this.dispatchEvent(Y):t(this).triggerHandler(Y,W)})},t.fn.triggerHandler=function(Y,W){var ge,Z;return this.each(function(q,oe){ge=be(l(Y)?t.Event(Y):Y),ge._args=W,ge.target=oe,t.each(w(oe,Y.type||Y),function(xe,Ae){if(Z=Ae.proxy(ge),ge.isImmediatePropagationStopped())return!1})}),Z},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(Y){t.fn[Y]=function(W){return 0 in arguments?this.bind(Y,W):this.trigger(Y)}}),t.Event=function(Y,W){l(Y)||(W=Y,Y=W.type);var ge=document.createEvent(g[Y]||"Events"),Z=!0;if(W)for(var q in W)q=="bubbles"?Z=!!W[q]:ge[q]=W[q];return ge.initEvent(Y,Z,!0),ye(ge)}})(Pr);(function(){try{getComputedStyle(void 0)}catch{var t=getComputedStyle;window.getComputedStyle=function(a,n){try{return t(a,n)}catch{return null}}}})();(function(t){var i=t.zepto,a=i.qsa,n=i.matches;function r(A){return A=t(A),!!(A.width()||A.height())&&A.css("display")!=="none"}var l=t.expr[":"]={visible:function(){if(r(this))return this},hidden:function(){if(!r(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(A){if(A===0)return this},last:function(A,U){if(A===U.length-1)return this},eq:function(A,U,w){if(A===w)return this},contains:function(A,U,w){if(t(this).text().indexOf(w)>-1)return this},has:function(A,U,w){if(i.qsa(this,w).length)return this}},f=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),g=/^\s*>/,T="Zepto"+ +new Date;function m(A,U){A=A.replace(/=#\]/g,'="#"]');var w,L,K=f.exec(A);if(K&&K[2]in l&&(w=l[K[2]],L=K[3],A=K[1],L)){var F=Number(L);isNaN(F)?L=L.replace(/^["']|["']$/g,""):L=F}return U(A,w,L)}i.qsa=function(A,U){return m(U,function(w,L,K){try{var F;!w&&L?w="*":g.test(w)&&(F=t(A).addClass(T),w="."+T+" "+w);var j=a(A,w)}catch($){throw console.error("error performing selector: %o",U),$}finally{F&&F.removeClass(T)}return L?i.uniq(t.map(j,function($,X){return L.call($,X,j,K)})):j})},i.matches=function(A,U){return m(U,function(w,L,K){return(!w||n(A,w))&&(!L||L.call(A,null,K)===A)})}})(Pr);var Ue=Pr,qd=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],Zd=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],Be={},Qd=function(){try{return localStorage.setItem("clappr","clappr"),localStorage.removeItem("clappr"),!0}catch{return!1}},Jd=function(){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!i}catch{return!!(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==void 0&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}},eh=function(i){var a=i.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],n;if(/trident/i.test(a[1]))return n=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:parseInt(n[1]||"")};if(a[1]==="Chrome"){if(n=i.match(/\bOPR\/(\d+)/),n!=null)return{name:"Opera",version:parseInt(n[1])};if(n=i.match(/\bEdge\/(\d+)/),n!=null)return{name:"Edge",version:parseInt(n[1])}}else/android/i.test(i)&&(n=i.match(/version\/(\d+)/i))&&(a.splice(1,1,"Android WebView"),a.splice(2,1,n[1]));return a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],{name:a[0],version:parseInt(a[1])}},th=function(){var i={},a=Be.userAgent.toLowerCase(),n=gl(qd),r;try{for(n.s();!(r=n.n()).done;){var l=r.value,f=new RegExp(l.identifier.toLowerCase()),g=f.exec(a);if(g!=null&&g[1]){if(i.name=l.name,i.group=l.group,l.versionIdentifier){var T=new RegExp(l.versionIdentifier.toLowerCase()),m=T.exec(a);m!=null&&m[1]&&ro(m[1],i)}else ro(g[1],i);break}}}catch(A){n.e(A)}finally{n.f()}return i},ro=function(i,a){var n=i.split(".",2);a.fullVersion=i,n[0]&&(a.majorVersion=parseInt(n[0])),n[1]&&(a.minorVersion=parseInt(n[1]))},rh=function(){var i={},a=Be.userAgent.toLowerCase(),n=gl(Zd),r;try{for(n.s();!(r=n.n()).done;){var l=r.value,f=new RegExp(l.identifier.toLowerCase()),g=f.exec(a);if(g!=null){if(i.name=l.name,i.group=l.group,l.version)Zi(l.version,l.versionSeparator?l.versionSeparator:".",i);else if(g[1])Zi(g[1],l.versionSeparator?l.versionSeparator:".",i);else if(l.versionIdentifier){var T=new RegExp(l.versionIdentifier.toLowerCase()),m=T.exec(a);m!=null&&m[1]&&Zi(m[1],l.versionSeparator?l.versionSeparator:".",i)}break}}}catch(A){n.e(A)}finally{n.f()}return i},Zi=function(i,a,n){var r=a.substr(0,1)=="["?new RegExp(a,"g"):a,l=i.split(r,2);a!="."&&(i=i.replace(new RegExp(a,"g"),".")),n.fullVersion=i,l&&l[0]&&(n.majorVersion=parseInt(l[0])),l&&l[1]&&(n.minorVersion=parseInt(l[1]))},nh=function(){var i={};return i.width=Ue(window).width(),i.height=Ue(window).height(),i},ih=function(){switch(window.orientation){case-90:case 90:Be.viewport.orientation="landscape";break;default:Be.viewport.orientation="portrait";break}},ah=function(i){var a=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/,n=a.exec(i),r=n&&(n[1]||n[2])||"";return r},vl=eh(navigator.userAgent);Be.isEdge=/edge/i.test(navigator.userAgent);Be.isChrome=/chrome|CriOS/i.test(navigator.userAgent)&&!Be.isEdge;Be.isSafari=/safari/i.test(navigator.userAgent)&&!Be.isChrome&&!Be.isEdge;Be.isFirefox=/firefox/i.test(navigator.userAgent);Be.isLegacyIE=!!window.ActiveXObject;Be.isIE=Be.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent);Be.isIE11=/trident.*rv:11/i.test(navigator.userAgent);Be.isChromecast=Be.isChrome&&/CrKey/i.test(navigator.userAgent);Be.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent);Be.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);Be.isAndroid=/Android/i.test(navigator.userAgent);Be.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent);Be.isWin8App=/MSAppHost/i.test(navigator.userAgent);Be.isWiiU=/WiiU/i.test(navigator.userAgent);Be.isPS4=/PlayStation 4/i.test(navigator.userAgent);Be.hasLocalstorage=Qd();Be.hasFlash=Jd();Be.name=vl.name;Be.version=vl.version;Be.userAgent=navigator.userAgent;Be.data=th();Be.os=rh();Be.viewport=nh();Be.device=ah(Be.userAgent);typeof window.orientation<"u"&&ih();var Qi={},Ji=[],ml=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}).bind(window),yl=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Al(t,i){if(i)for(var a in i){var n=Object.getOwnPropertyDescriptor(i,a);n?Object.defineProperty(t,a,n):t[a]=i[a]}return t}function xn(t,i){var a=function(n){Et(l,n);var r=_t(l);function l(){var f;it(this,l);for(var g=arguments.length,T=new Array(g),m=0;m<g;m++)T[m]=arguments[m];return f=r.call.apply(r,[this].concat(T)),i.initialize&&i.initialize.apply(Li(f),T),f}return at(l)}(t);return Al(a.prototype,i),a}function sh(t,i){if(!isFinite(t))return"--:--";t=t*1e3,t=parseInt(t/1e3);var a=t%60;t=parseInt(t/60);var n=t%60;t=parseInt(t/60);var r=t%24,l=parseInt(t/24),f="";return l&&l>0&&(f+=l+":",r<1&&(f+="00:")),(r&&r>0||i)&&(f+=("0"+r).slice(-2)+":"),f+=("0"+n).slice(-2)+":",f+=("0"+a).slice(-2),f.trim()}var Pn={fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function(i){if(i.requestFullscreen)return i.requestFullscreen();if(i.webkitRequestFullscreen){if(typeof i.then=="function")return i.webkitRequestFullscreen();i.webkitRequestFullscreen()}else{if(i.mozRequestFullScreen)return i.mozRequestFullScreen();if(i.msRequestFullscreen)return i.msRequestFullscreen();i.querySelector&&i.querySelector("video")&&i.querySelector("video").webkitEnterFullScreen?i.querySelector("video").webkitEnterFullScreen():i.webkitEnterFullScreen&&i.webkitEnterFullScreen()}},cancelFullscreen:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;i.exitFullscreen?i.exitFullscreen():i.webkitCancelFullScreen?i.webkitCancelFullScreen():i.webkitExitFullscreen?i.webkitExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.msExitFullscreen&&i.msExitFullscreen()},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},oh=function(){function t(){it(this,t)}return at(t,null,[{key:"_defaultConfig",value:function(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function(a){try{return this._defaultConfig()[a].parse(this._defaultConfig()[a].value)}catch{return}}},{key:"_createKeyspace",value:function(a){return"clappr.".concat(document.domain,".").concat(a)}},{key:"restore",value:function(a){return Be.hasLocalstorage&&localStorage[this._createKeyspace(a)]?this._defaultConfig()[a].parse(localStorage[this._createKeyspace(a)]):this._defaultValueFor(a)}},{key:"persist",value:function(a,n){if(Be.hasLocalstorage)try{return localStorage[this._createKeyspace(a)]=n,!0}catch{return!1}}}]),t}(),ya=function(){function t(){it(this,t)}return at(t,null,[{key:"params",get:function(){var a=window.location.search.substring(1);return a!==this.query&&(this._urlParams=this.parse(a),this.query=a),this._urlParams}},{key:"hashParams",get:function(){var a=window.location.hash.substring(1);return a!==this.hash&&(this._hashParams=this.parse(a),this.hash=a),this._hashParams}},{key:"parse",value:function(a){for(var n,r=/\+/g,l=/([^&=]+)=?([^&]*)/g,f=function(m){return decodeURIComponent(m.replace(r," "))},g={};n=l.exec(a);)g[f(n[1]).toLowerCase()]=f(n[2]);return g}}]),t}();function El(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"t",i=0,a=ya.params[t]||ya.hashParams[t]||"",n=a.match(/[0-9]+[hms]+/g)||[];if(n.length>0){var r={h:3600,m:60,s:1};n.forEach(function(l){if(l){var f=l[l.length-1],g=parseInt(l.slice(0,l.length-1),10);i+=g*r[f]}})}else a&&(i=parseInt(a,10));return i}function Yn(t){Qi[t]||(Qi[t]=0);var i=++Qi[t];return t+i}function Ai(t){return t-parseFloat(t)+1>=0}function _l(){var t=document.getElementsByTagName("script");return t.length?t[t.length-1].src:""}function bl(){return window.navigator&&window.navigator.language}function lh(){return window.performance&&window.performance.now?performance.now():Date.now()}function uh(t,i){var a=t.indexOf(i);a>=0&&t.splice(a,1)}function ch(t,i){return t===void 0||i===void 0?!1:i.find(function(a){return t.toLowerCase()===a.toLowerCase()})!==void 0}function Tl(t,i){i=Object.assign({inline:!1,muted:!1,timeout:250,type:"video",source:pl.mp4,element:null},i);var a=i.element?i.element:document.createElement(i.type);a.muted=i.muted,i.muted===!0&&a.setAttribute("muted","muted"),i.inline===!0&&a.setAttribute("playsinline","playsinline"),a.src=i.source;var n=a.play(),r=setTimeout(function(){l(!1,new Error("Timeout ".concat(i.timeout," ms has been reached")))},i.timeout),l=function(g){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;clearTimeout(r),t(g,T)};n!==void 0?n.then(function(){return l(!0)}).catch(function(f){return l(!1,f)}):l(!0)}var An=function(){function t(){it(this,t)}return at(t,null,[{key:"configure",value:function(a){this.options=Ue.extend(!0,this.options,a)}},{key:"create",value:function(a){return this.options.recycleVideo&&a==="video"&&Ji.length>0?Ji.shift():document.createElement(a)}},{key:"garbage",value:function(a){!this.options.recycleVideo||a.tagName.toUpperCase()!=="VIDEO"||(Ue(a).children().remove(),Object.values(a.attributes).forEach(function(n){return a.removeAttribute(n.name)}),Ji.push(a))}}]),t}();An.options={recycleVideo:!1};var xl=function(){function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:500;it(this,t),this.delay=i,this.lastTime=0}return at(t,[{key:"handle",value:function(a,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=new Date().getTime(),f=l-this.lastTime;f<this.delay&&f>0&&(n(),r&&a.preventDefault()),this.lastTime=l}}]),t}(),xr={Config:oh,Fullscreen:Pn,QueryString:ya,DomRecycler:An,assign:Al,extend:xn,formatTime:sh,seekStringToSeconds:El,uniqueId:Yn,currentScriptUrl:_l,isNumber:Ai,requestAnimationFrame:ml,cancelAnimationFrame:yl,getBrowserLanguage:bl,now:lh,removeArrayItem:uh,listContainsIgnoreCase:ch,canAutoPlayMedia:Tl,Media:pl,DoubleEventHandler:xl},Ii="font-weight: bold; font-size: 13px;",fh="color: #006600;"+Ii,dh="color: #0000ff;"+Ii,Sl="color: #ff8000;"+Ii,no="color: #ff0000;"+Ii,kl=0,Aa=1,Rl=2,Wa=3,hh=Wa,gh=[dh,fh,Sl,no,no],io=["debug","info","warn","error","disabled"],Je=function(){function t(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Aa,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hh;it(this,t),this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"],this.level=i,this.previousLevel=this.level,this.offLevel=a}return at(t,[{key:"level",get:function(){return this._level},set:function(a){this._level=a}},{key:"debug",value:function(a){this.log(a,kl,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(a){this.log(a,Aa,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(a){this.log(a,Rl,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(a){this.log(a,Wa,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+io[this.level],Sl)}},{key:"log",value:function(a,n,r){if(!(this.EXCLUDE_LIST.indexOf(r[0])>=0)&&!(n<this.level)){r||(r=a,a=null);var l=gh[n],f="";a&&(f="["+a+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+io[n]+"]"+f,l].concat(r))}}}]),t}();Je.LEVEL_DEBUG=kl;Je.LEVEL_INFO=Aa;Je.LEVEL_WARN=Rl;Je.LEVEL_ERROR=Wa;Je.getInstance=function(){return this._instance===void 0&&(this._instance=new this),this._instance};Je.setLevel=function(t){this.getInstance().level=t};Je.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)};Je.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)};Je.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)};Je.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var ph=Array.prototype.slice,ao=/\s+/,li=function(i,a,n,r){if(!n)return!0;if(yn(n)==="object"){for(var l in n)i[a].apply(i,[l,n[l]].concat(r));return!1}if(ao.test(n)){for(var f=n.split(ao),g=0,T=f.length;g<T;g++)i[a].apply(i,[f[g]].concat(r));return!1}return!0},so=function(i,a,n,r){var l,f=-1,g=i.length,T=a[0],m=a[1],A=a[2];U();function U(){try{switch(a.length){case 0:for(;++f<g;)(l=i[f]).callback.call(l.ctx);return;case 1:for(;++f<g;)(l=i[f]).callback.call(l.ctx,T);return;case 2:for(;++f<g;)(l=i[f]).callback.call(l.ctx,T,m);return;case 3:for(;++f<g;)(l=i[f]).callback.call(l.ctx,T,m,A);return;default:for(;++f<g;)(l=i[f]).callback.apply(l.ctx,a);return}}catch(w){Je.error.apply(Je,[n,"error on event",r,"trigger","-",w]),U()}}},x=function(){function t(){it(this,t)}return at(t,[{key:"on",value:function(a,n,r){if(!li(this,"on",a,[n,r])||!n)return this;this._events||(this._events={});var l=this._events[a]||(this._events[a]=[]);return l.push({callback:n,context:r,ctx:r||this}),this}},{key:"once",value:function(a,n,r){var l=this,f;if(!li(this,"once",a,[n,r])||!n)return this;var g=function(){return l.off(a,f)};return f=function(){g(),n.apply(this,arguments)},this.on(a,f,r)}},{key:"off",value:function(a,n,r){var l,f,g,T,m,A,U,w;if(!this._events||!li(this,"off",a,[n,r]))return this;if(!a&&!n&&!r)return this._events=void 0,this;for(T=a?[a]:Object.keys(this._events),m=0,A=T.length;m<A;m++)if(a=T[m],g=this._events[a],g){if(this._events[a]=l=[],n||r)for(U=0,w=g.length;U<w;U++)f=g[U],(n&&n!==f.callback&&n!==f.callback._callback||r&&r!==f.context)&&l.push(f);l.length||delete this._events[a]}return this}},{key:"trigger",value:function(a){var n=this.name||this.constructor.name;if(Je.debug.apply(Je,[n].concat(Array.prototype.slice.call(arguments))),!this._events)return this;var r=ph.call(arguments,1);if(!li(this,"trigger",a,r))return this;var l=this._events[a],f=this._events.all;return l&&so(l,r,n,a),f&&so(f,arguments,n,a),this}},{key:"stopListening",value:function(a,n,r){var l=this._listeningTo;if(!l)return this;var f=!n&&!r;!r&&yn(n)==="object"&&(r=this),a&&((l={})[a._listenId]=a);for(var g in l)a=l[g],a.off(n,r,this),(f||Object.keys(a._events).length===0)&&delete this._listeningTo[g];return this}}],[{key:"register",value:function(a){t.Custom||(t.Custom={});var n=typeof a=="string"&&a.toUpperCase().trim();n&&!t.Custom[n]?t.Custom[n]=n.toLowerCase().split("_").map(function(r,l){return l===0?r:r=r[0].toUpperCase()+r.slice(1)}).join(""):Je.error("Events","Error when register event: "+a)}},{key:"listAvailableCustomEvents",value:function(){return t.Custom||(t.Custom={}),Object.keys(t.Custom).filter(function(a){return typeof t.Custom[a]=="string"})}}]),t}(),oo={listenTo:"on",listenToOnce:"once"};Object.keys(oo).forEach(function(t){x.prototype[t]=function(i,a,n){var r=this._listeningTo||(this._listeningTo={}),l=i._listenId||(i._listenId=Yn("l"));return r[l]=i,!n&&yn(a)==="object"&&(n=this),i[oo[t]](a,n,this),this}});x.PLAYER_READY="ready";x.PLAYER_RESIZE="resize";x.PLAYER_FULLSCREEN="fullscreen";x.PLAYER_PLAY="play";x.PLAYER_PAUSE="pause";x.PLAYER_STOP="stop";x.PLAYER_ENDED="ended";x.PLAYER_SEEK="seek";x.PLAYER_ERROR="playererror";x.ERROR="error";x.PLAYER_TIMEUPDATE="timeupdate";x.PLAYER_VOLUMEUPDATE="volumeupdate";x.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable";x.PLAYBACK_PROGRESS="playback:progress";x.PLAYBACK_TIMEUPDATE="playback:timeupdate";x.PLAYBACK_READY="playback:ready";x.PLAYBACK_BUFFERING="playback:buffering";x.PLAYBACK_BUFFERFULL="playback:bufferfull";x.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate";x.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata";x.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate";x.PLAYBACK_BITRATE="playback:bitrate";x.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available";x.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start";x.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end";x.PLAYBACK_PLAYBACKSTATE="playback:playbackstate";x.PLAYBACK_DVR="playback:dvr";x.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable";x.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable";x.PLAYBACK_ENDED="playback:ended";x.PLAYBACK_PLAY_INTENT="playback:play:intent";x.PLAYBACK_PLAY="playback:play";x.PLAYBACK_PAUSE="playback:pause";x.PLAYBACK_SEEK="playback:seek";x.PLAYBACK_SEEKED="playback:seeked";x.PLAYBACK_STOP="playback:stop";x.PLAYBACK_ERROR="playback:error";x.PLAYBACK_STATS_ADD="playback:stats:add";x.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded";x.PLAYBACK_LEVEL_SWITCH="playback:level:switch";x.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available";x.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed";x.PLAYBACK_AUDIO_AVAILABLE="playback:audio:available";x.PLAYBACK_AUDIO_CHANGED="playback:audio:changed";x.CORE_CONTAINERS_CREATED="core:containers:created";x.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed";x.CORE_OPTIONS_CHANGE="core:options:change";x.CORE_READY="core:ready";x.CORE_FULLSCREEN="core:fullscreen";x.CORE_RESIZE="core:resize";x.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed";x.CORE_MOUSE_MOVE="core:mousemove";x.CORE_MOUSE_LEAVE="core:mouseleave";x.CONTAINER_PLAYBACKSTATE="container:playbackstate";x.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr";x.CONTAINER_BITRATE="container:bitrate";x.CONTAINER_STATS_REPORT="container:stats:report";x.CONTAINER_DESTROYED="container:destroyed";x.CONTAINER_READY="container:ready";x.CONTAINER_RESIZE="container:resize";x.CONTAINER_ERROR="container:error";x.CONTAINER_LOADEDMETADATA="container:loadedmetadata";x.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available";x.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed";x.CONTAINER_AUDIO_AVAILABLE="container:audio:available";x.CONTAINER_AUDIO_CHANGED="container:audio:changed";x.CONTAINER_TIMEUPDATE="container:timeupdate";x.CONTAINER_PROGRESS="container:progress";x.CONTAINER_PLAY="container:play";x.CONTAINER_STOP="container:stop";x.CONTAINER_PAUSE="container:pause";x.CONTAINER_ENDED="container:ended";x.CONTAINER_CLICK="container:click";x.CONTAINER_DBLCLICK="container:dblclick";x.CONTAINER_CONTEXTMENU="container:contextmenu";x.CONTAINER_MOUSE_ENTER="container:mouseenter";x.CONTAINER_MOUSE_LEAVE="container:mouseleave";x.CONTAINER_MOUSE_UP="container:mouseup";x.CONTAINER_MOUSE_DOWN="container:mousedown";x.CONTAINER_SEEK="container:seek";x.CONTAINER_SEEKED="container:seeked";x.CONTAINER_VOLUME="container:volume";x.CONTAINER_FULLSCREEN="container:fullscreen";x.CONTAINER_STATE_BUFFERING="container:state:buffering";x.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull";x.CONTAINER_SETTINGSUPDATE="container:settingsupdate";x.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate";x.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show";x.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide";x.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable";x.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable";x.CONTAINER_STATS_ADD="container:stats:add";x.CONTAINER_OPTIONS_CHANGE="container:options:change";x.MEDIACONTROL_RENDERED="mediacontrol:rendered";x.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen";x.MEDIACONTROL_SHOW="mediacontrol:show";x.MEDIACONTROL_HIDE="mediacontrol:hide";x.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar";x.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar";x.MEDIACONTROL_PLAYING="mediacontrol:playing";x.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying";x.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged";x.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change";var en=function(t){Et(a,t);var i=_t(a);function a(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return it(this,a),n=i.call(this,r),n._options=r,n.uniqueId=Yn("o"),n}return at(a,[{key:"options",get:function(){return this._options}}]),a}(x),Yr={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ea=/(.)^/,vh={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},mh=/\\|'|\r|\n|\t|\u2028|\u2029/g,yh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Ah=new RegExp(`[&<>"']`,"g"),lo=function(i){return i===null?"":(""+i).replace(Ah,function(a){return yh[a]})},Eh=0,Xt=function(i,a){var n,r=new RegExp([(Yr.escape||ea).source,(Yr.interpolate||ea).source,(Yr.evaluate||ea).source].join("|")+"|$","g"),l=0,f="__p+='";i.replace(r,function(T,m,A,U,w){return f+=i.slice(l,w).replace(mh,function(L){return"\\"+vh[L]}),m&&(f+=`'+
((__t=(`+m+`))==null?'':escapeExpr(__t))+
'`),A&&(f+=`'+
((__t=(`+A+`))==null?'':__t)+
'`),U&&(f+=`';
`+U+`
__p+='`),l=w+T.length,T}),f+=`';
`,Yr.variable||(f=`with(obj||{}){
`+f+`}
`),f=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+f+`return __p;
//# sourceURL=/microtemplates/source[`+Eh+++"]";try{n=new Function(Yr.variable||"obj","escapeExpr",f)}catch(T){throw T.source=f,T}if(a)return n(a,lo);var g=function(m){return n.call(this,m,lo)};return g.source="function("+(Yr.variable||"obj")+`){
`+f+"}",g};Xt.settings=Yr;var Kt={getStyleFor:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{baseUrl:""};return Ue('<style class="clappr-style"></style>').html(Xt(i.toString())(a))}},_h=/^(\S+)\s*(.*)$/,zn=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n),r.cid=Yn("c"),r._ensureElement(),r.delegateEvents(),r}return at(a,[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}},{key:"$",value:function(r){return this.$el.find(r)}},{key:"render",value:function(){return this}},{key:"destroy",value:function(){return this.$el.remove(),this.stopListening(),this.undelegateEvents(),this}},{key:"setElement",value:function(r,l){return this.$el&&this.undelegateEvents(),this.$el=Ue.zepto.isZ(r)?r:Ue(r),this.el=this.$el[0],l!==!1&&this.delegateEvents(),this}},{key:"delegateEvents",value:function(r){r||(r=this.events),this.undelegateEvents();for(var l in r){var f=r[l];if(f&&f.constructor!==Function&&(f=this[r[l]]),!!f){var g=l.match(_h),T=g[1],m=g[2];T+=".delegateEvents"+this.cid,m===""?this.$el.on(T,f.bind(this)):this.$el.on(T,m,f.bind(this))}}return this}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"_ensureElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var r=Ue.extend(!0,{},this.attributes);this.id&&(r.id=this.id),this.className&&(r.class=this.className);var l=Ue(An.create(this.tagName)).attr(r);this.setElement(l,!1)}}}]),a}(en),nr=function(t){Et(a,t);var i=_t(a);function a(){var n,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1?arguments[1]:void 0;return it(this,a),n=i.call(this,r),n.core=l,n}return at(a,[{key:"name",get:function(){return"error"}},{key:"createError",value:function(r){if(!this.core){Je.warn(this.name,"Core is not set. Error: ",r);return}this.core.trigger(x.ERROR,r)}}],[{key:"Levels",get:function(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]),a}(en),Nr={createError:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{useCodePrefix:!0},n=this.constructor&&this.constructor.type||"",r=this.name||n,l=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n,f="".concat(r,":").concat(i&&i.code||"unknown"),g={description:"",level:nr.Levels.FATAL,origin:r,scope:n,raw:{}},T=Object.assign({},g,i,{code:a.useCodePrefix?f:i.code});if(l&&T.level==nr.Levels.FATAL&&!T.UI){var m={title:l.t("default_error_title"),message:l.t("default_error_message")};T.UI=m}return this.playerError?this.playerError.createError(T):Je.warn(r,"PlayerError is not defined. Error: ",T),T}},vr=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n.options),r.core=n,r.enabled=!0,r.bindEvents(),r.render(),r}return at(a,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"getExternalInterface",value:function(){return{}}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"render",value:function(){return this}}]),a}(zn);Object.assign(vr.prototype,Nr);vr.extend=function(t){return xn(vr,t)};vr.type="core";var bh=`.container[data-container] {
  position: absolute;
  background-color: black;
  height: 100%;
  width: 100%;
  max-width: 100%; }
  .container[data-container] .chromeless {
    cursor: default; }

[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {
  cursor: pointer; }
`,Cl=function(t){Et(a,t);var i=_t(a);function a(n,r,l){var f;return it(this,a),f=i.call(this,n),f._i18n=r,f.currentTime=0,f.volume=100,f.playback=n.playback,f.playerError=l,f.settings=Ue.extend(!0,{},f.playback.settings),f.isReady=!1,f.mediaControlDisabled=!1,f.plugins=[f.playback],f.dblTapHandler=new xl(500),f.clickTimer=null,f.clickDelay=200,f.actionsMetadata={},f.bindEvents(),f}return at(a,[{key:"name",get:function(){return"Container"}},{key:"attributes",get:function(){return{class:"container","data-container":""}}},{key:"events",get:function(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function(){return this.playback.ended}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"i18n",get:function(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function(){return this.playback.closedCaptionsTrackId},set:function(r){this.playback.closedCaptionsTrackId=r}},{key:"audioTracks",get:function(){return this.playback.audioTracks}},{key:"currentAudioTrack",get:function(){return this.playback.currentAudioTrack}},{key:"bindEvents",value:function(){this.listenTo(this.playback,x.PLAYBACK_PROGRESS,this.onProgress),this.listenTo(this.playback,x.PLAYBACK_TIMEUPDATE,this.timeUpdated),this.listenTo(this.playback,x.PLAYBACK_READY,this.ready),this.listenTo(this.playback,x.PLAYBACK_BUFFERING,this.onBuffering),this.listenTo(this.playback,x.PLAYBACK_BUFFERFULL,this.bufferfull),this.listenTo(this.playback,x.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.playback,x.PLAYBACK_LOADEDMETADATA,this.loadedMetadata),this.listenTo(this.playback,x.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.playback,x.PLAYBACK_BITRATE,this.updateBitrate),this.listenTo(this.playback,x.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged),this.listenTo(this.playback,x.PLAYBACK_DVR,this.playbackDvrStateChanged),this.listenTo(this.playback,x.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl),this.listenTo(this.playback,x.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl),this.listenTo(this.playback,x.PLAYBACK_SEEK,this.onSeek),this.listenTo(this.playback,x.PLAYBACK_SEEKED,this.onSeeked),this.listenTo(this.playback,x.PLAYBACK_ENDED,this.onEnded),this.listenTo(this.playback,x.PLAYBACK_PLAY,this.playing),this.listenTo(this.playback,x.PLAYBACK_PAUSE,this.paused),this.listenTo(this.playback,x.PLAYBACK_STOP,this.stopped),this.listenTo(this.playback,x.PLAYBACK_ERROR,this.error),this.listenTo(this.playback,x.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable),this.listenTo(this.playback,x.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged),this.listenTo(this.playback,x.PLAYBACK_AUDIO_AVAILABLE,this.audioAvailable),this.listenTo(this.playback,x.PLAYBACK_AUDIO_CHANGED,this.audioChanged)}},{key:"subtitleAvailable",value:function(){this.trigger(x.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function(r){this.trigger(x.CONTAINER_SUBTITLE_CHANGED,r)}},{key:"audioAvailable",value:function(r){this.trigger(x.CONTAINER_AUDIO_AVAILABLE,r)}},{key:"audioChanged",value:function(r){this.trigger(x.CONTAINER_AUDIO_CHANGED,r)}},{key:"playbackStateChanged",value:function(r){this.trigger(x.CONTAINER_PLAYBACKSTATE,r)}},{key:"playbackDvrStateChanged",value:function(r){this.settings=this.playback.settings,this.dvrInUse=r,this.trigger(x.CONTAINER_PLAYBACKDVRSTATECHANGED,r)}},{key:"updateBitrate",value:function(r){this.trigger(x.CONTAINER_BITRATE,r)}},{key:"statsReport",value:function(r){this.trigger(x.CONTAINER_STATS_REPORT,r)}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function(){return!!this.dvrInUse}},{key:"destroy",value:function(){this.disableResizeObserver(),this.trigger(x.CONTAINER_DESTROYED,this,this.name),this.stopListening(),this.plugins.forEach(function(r){return r.destroy()}),this.$el.remove()}},{key:"setStyle",value:function(r){this.$el.css(r)}},{key:"animate",value:function(r,l){return this.$el.animate(r,l).promise()}},{key:"ready",value:function(){this.isReady=!0,this.trigger(x.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"error",value:function(r){this.isReady||this.ready(),this.trigger(x.CONTAINER_ERROR,r,this.name)}},{key:"loadedMetadata",value:function(r){this.trigger(x.CONTAINER_LOADEDMETADATA,r)}},{key:"timeUpdated",value:function(r){this.currentTime=r.current,this.trigger(x.CONTAINER_TIMEUPDATE,r,this.name)}},{key:"onProgress",value:function(){for(var r=arguments.length,l=new Array(r),f=0;f<r;f++)l[f]=arguments[f];this.trigger.apply(this,[x.CONTAINER_PROGRESS].concat(l,[this.name]))}},{key:"playing",value:function(){this.trigger(x.CONTAINER_PLAY,this.name,this.actionsMetadata.playEvent||{}),this.actionsMetadata.playEvent={}}},{key:"paused",value:function(){this.trigger(x.CONTAINER_PAUSE,this.name,this.actionsMetadata.pauseEvent||{}),this.actionsMetadata.pauseEvent={}}},{key:"stopped",value:function(){this.trigger(x.CONTAINER_STOP,this.actionsMetadata.stopEvent||{}),this.actionsMetadata.stopEvent={}}},{key:"play",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.playEvent=r,this.playback.play(r)}},{key:"stop",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.stopEvent=r,this.playback.stop(r),this.currentTime=0}},{key:"switchAudioTrack",value:function(r){this.playback.switchAudioTrack(r)}},{key:"pause",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.pauseEvent=r,this.playback.pause(r)}},{key:"onEnded",value:function(){this.trigger(x.CONTAINER_ENDED,this,this.name),this.currentTime=0}},{key:"clicked",value:function(){var r=this;(!this.options.chromeless||this.options.allowUserInteraction)&&(this.clickTimer=setTimeout(function(){r.clickTimer&&r.trigger(x.CONTAINER_CLICK,r,r.name)},this.clickDelay))}},{key:"cancelClicked",value:function(){clearTimeout(this.clickTimer),this.clickTimer=null}},{key:"dblClicked",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&(this.cancelClicked(),this.trigger(x.CONTAINER_DBLCLICK,this,this.name))}},{key:"dblTap",value:function(r){var l=this;(!this.options.chromeless||this.options.allowUserInteraction)&&this.dblTapHandler.handle(r,function(){l.cancelClicked(),l.trigger(x.CONTAINER_DBLCLICK,l,l.name)})}},{key:"onContextMenu",value:function(r){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(x.CONTAINER_CONTEXTMENU,r,this.name)}},{key:"seek",value:function(r){this.playback.seek(r)}},{key:"onSeek",value:function(r){this.trigger(x.CONTAINER_SEEK,r,this.name)}},{key:"onSeeked",value:function(){this.trigger(x.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function(r){var l=this.getDuration();if(r>=0&&r<=100){var f=l*(r/100);this.seek(f)}}},{key:"setVolume",value:function(r){this.volume=parseFloat(r),this.trigger(x.CONTAINER_VOLUME,this.volume,this.name),this.playback.volume(this.volume)}},{key:"fullscreen",value:function(){this.trigger(x.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function(){this.trigger(x.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function(){this.trigger(x.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"addPlugin",value:function(r){this.plugins.push(r)}},{key:"hasPlugin",value:function(r){return!!this.getPlugin(r)}},{key:"getPlugin",value:function(r){return this.plugins.filter(function(l){return l.name===r})[0]}},{key:"mouseEnter",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(x.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(x.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(x.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(x.CONTAINER_MOUSE_DOWN)}},{key:"settingsUpdate",value:function(){this.settings=this.playback.settings,this.trigger(x.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function(r){this.trigger(x.CONTAINER_HIGHDEFINITIONUPDATE,r)}},{key:"isHighDefinitionInUse",value:function(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function(){this.mediaControlDisabled||(this.mediaControlDisabled=!0,this.trigger(x.CONTAINER_MEDIACONTROL_DISABLE))}},{key:"enableMediaControl",value:function(){this.mediaControlDisabled&&(this.mediaControlDisabled=!1,this.trigger(x.CONTAINER_MEDIACONTROL_ENABLE))}},{key:"updateStyle",value:function(){!this.options.chromeless||this.options.allowUserInteraction?this.$el.removeClass("chromeless"):this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function(){var r=this;this.disableResizeObserver(),this.resizeObserverInterval=setInterval(function(){return r.checkResize()},500)}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function(){var r={width:this.el.clientWidth,height:this.el.clientHeight},l=this.currentSize||{},f=l.width,g=l.height,T=g!==r.height||f!==r.width;T&&(this.currentSize=r,this.trigger(x.CONTAINER_RESIZE,r))}},{key:"configure",value:function(r){this._options=Ue.extend(!0,this._options,r),this.updateStyle(),this.playback.configure(this.options),this.trigger(x.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function(){var r=Kt.getStyleFor(bh.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(r[0]),this.$el.append(this.playback.render().el),this.updateStyle(),this.checkResize(),this.enableResizeObserver(),this}}]),a}(zn);Object.assign(Cl.prototype,Nr);var je=function(t){Et(a,t);var i=_t(a);function a(n,r,l){var f;return it(this,a),f=i.call(this,n),f.settings={},f._i18n=r,f.playerError=l,f._consented=!1,f}return at(a,[{key:"isAudioOnly",get:function(){return!1}},{key:"isAdaptive",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"i18n",get:function(){return this._i18n}},{key:"buffering",get:function(){return!1}},{key:"consent",value:function(r){typeof r=="function"&&r()}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){}},{key:"seek",value:function(r){}},{key:"seekPercentage",value:function(r){}},{key:"getStartTimeOffset",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",get:function(){return!1}},{key:"hasClosedCaptionsTracks",get:function(){return this.closedCaptionsTracks.length>0}},{key:"closedCaptionsTracks",get:function(){return[]}},{key:"closedCaptionsTrackId",get:function(){return-1},set:function(r){}},{key:"audioTracks",get:function(){return[]}},{key:"currentAudioTrack",get:function(){return null}},{key:"switchAudioTrack",value:function(r){}},{key:"getPlaybackType",value:function(){return a.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"volume",value:function(r){}},{key:"configure",value:function(r){this._options=Ue.extend(!0,this._options,r)}},{key:"attemptAutoPlay",value:function(){var r=this;this.canAutoPlay(function(l,f){l&&r.play()})}},{key:"canAutoPlay",value:function(r){r(!0,null)}}]),a}(zn);Object.assign(je.prototype,Nr);je.extend=function(t){return xn(je,t)};je.canPlay=function(t,i){return!1};je.VOD="vod";je.AOD="aod";je.LIVE="live";je.NO_OP="no_op";je.type="playback";var Th=function(t){Et(a,t);var i=_t(a);function a(n,r,l,f){var g;return it(this,a),g=i.call(this,n),g._i18n=l,g.loader=r,g.playerError=f,g}return at(a,[{key:"options",get:function(){return this._options},set:function(r){this._options=r}},{key:"createContainers",value:function(){var r=this;return Ue.Deferred(function(l){l.resolve(r.options.sources.map(function(f){return r.createContainer(f)}))})}},{key:"findPlaybackPlugin",value:function(r,l){return this.loader.playbackPlugins.filter(function(f){return f.canPlay(r,l)})[0]}},{key:"createContainer",value:function(r){var l=null,f=this.options.mimeType;yn(r)==="object"?(l=r.source.toString(),r.mimeType&&(f=r.mimeType)):l=r.toString(),l.match(/^\/\//)&&(l=window.location.protocol+l);var g=oi(oi({},this.options),{},{src:l,mimeType:f}),T=this.findPlaybackPlugin(l,f),m=T?new T(g,this._i18n,this.playerError):new je;g=oi(oi({},g),{},{playback:m});var A=new Cl(g,this._i18n,this.playerError),U=Ue.Deferred();return U.promise(A),this.addContainerPlugins(A),this.listenToOnce(A,x.CONTAINER_READY,function(){return U.resolve(A)}),A}},{key:"addContainerPlugins",value:function(r){this.loader.containerPlugins.forEach(function(l){r.addPlugin(new l(r))})}}]),a}(en),xh=`[data-player] {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  -o-user-select: none;
  user-select: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transform: translate3d(0, 0, 0);
  position: relative;
  margin: 0;
  padding: 0;
  border: 0;
  font-style: normal;
  font-weight: normal;
  text-align: center;
  overflow: hidden;
  font-size: 100%;
  font-family: "Roboto", "Open Sans", Arial, sans-serif;
  text-shadow: 0 0 0;
  box-sizing: border-box; }
  [data-player]:focus {
    outline: 0; }
  [data-player] * {
    box-sizing: inherit; }
  [data-player] > * {
    float: none;
    max-width: none; }
  [data-player] > div {
    display: block; }
  [data-player].fullscreen {
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0; }
  [data-player].nocursor {
    cursor: none; }

.clappr-style {
  display: none !important; }
`,Sh=`[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,
[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,
[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,
[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,
[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,
[data-player] b, [data-player] u, [data-player] i, [data-player] center,
[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,
[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,
[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,
[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,
[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,
[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,
[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {
  margin: 0;
  padding: 0;
  border: 0;
  font: inherit;
  font-size: 100%;
  vertical-align: baseline; }

[data-player] table {
  border-collapse: collapse;
  border-spacing: 0; }

[data-player] caption, [data-player] th, [data-player] td {
  text-align: left;
  font-weight: normal;
  vertical-align: middle; }

[data-player] q, [data-player] blockquote {
  quotes: none; }
  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {
    content: "";
    content: none; }

[data-player] a img {
  border: none; }
`,wl=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n),r.playerError=new nr(n,Li(r)),r.configureDomRecycler(),r.firstResize=!0,r.plugins=[],r.containers=[],r._boundFullscreenHandler=function(){return r.handleFullscreenChange()},Ue(document).bind("fullscreenchange",r._boundFullscreenHandler),Ue(document).bind("MSFullscreenChange",r._boundFullscreenHandler),Ue(document).bind("mozfullscreenchange",r._boundFullscreenHandler),Be.isMobile&&Ue(window).bind("resize",function(l){r.handleWindowResize(l)}),r}return at(a,[{key:"events",get:function(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function(){return!!this.ready}},{key:"i18n",get:function(){return this.getPlugin("strings")||{t:function(l){return l}}}},{key:"mediaControl",get:function(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl?this._dummyMediaControl:(this._dummyMediaControl=new vr(this),this._dummyMediaControl)}},{key:"activeContainer",get:function(){return this._activeContainer},set:function(r){this._activeContainer=r,this.trigger(x.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function(){return this.activeContainer&&this.activeContainer.playback}},{key:"activePlaybackEl",get:function(){return this.activePlayback.$el.find("video")[0]||this.activePlayback.el}},{key:"configureDomRecycler",value:function(){var r=this.options&&this.options.playback&&this.options.playback.recycleVideo;An.configure({recycleVideo:r})}},{key:"createContainers",value:function(r){this.defer=Ue.Deferred(),this.defer.promise(this),this.containerFactory=new Th(r,r.loader,this.i18n,this.playerError),this.prepareContainers()}},{key:"prepareContainers",value:function(){var r=this;this.containerFactory.createContainers().then(function(l){return r.setupContainers(l)}).then(function(l){return r.resolveOnContainersReady(l)})}},{key:"updateSize",value:function(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function(){Be.isiOS||(this.$el.addClass("fullscreen"),this.$el.removeAttr("style"),this.previousSize={width:this.options.width,height:this.options.height},this.currentSize={width:Ue(window).width(),height:Ue(window).height()})}},{key:"setPlayerSize",value:function(){this.$el.removeClass("fullscreen"),this.currentSize=this.previousSize,this.previousSize={width:Ue(window).width(),height:Ue(window).height()},this.resize(this.currentSize)}},{key:"resize",value:function(r){!Ai(r.height)&&!Ai(r.width)?(this.el.style.height="".concat(r.height),this.el.style.width="".concat(r.width)):(this.el.style.height="".concat(r.height,"px"),this.el.style.width="".concat(r.width,"px")),this.previousSize={width:this.options.width,height:this.options.height},this.options.width=r.width,this.options.height=r.height,this.currentSize=r,this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function(){var r=this;this.disableResizeObserver();var l=function(){r.triggerResize({width:r.el.clientWidth,height:r.el.clientHeight})};this.resizeObserverInterval=setInterval(l,500)}},{key:"triggerResize",value:function(r){var l=this.firstResize||this.oldHeight!==r.height||this.oldWidth!==r.width;l&&(this.oldHeight=r.height,this.oldWidth=r.width,this.computedSize=r,this.firstResize=!1,this.trigger(x.CORE_RESIZE,r))}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval),this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function(r){var l=this;Ue.when.apply(Ue,r).done(function(){l.defer.resolve(l),l.ready=!0,l.trigger(x.CORE_READY)})}},{key:"addPlugin",value:function(r){this.plugins.push(r)}},{key:"hasPlugin",value:function(r){return!!this.getPlugin(r)}},{key:"getPlugin",value:function(r){return this.plugins.filter(function(l){return l.name===r})[0]}},{key:"load",value:function(r,l){this.options.mimeType=l,r=r&&r.constructor===Array?r:[r],this.options.sources=r,this.containers.forEach(function(f){return f.destroy()}),this.containerFactory.options=Ue.extend(!0,this.options,{sources:r}),this.prepareContainers()}},{key:"destroy",value:function(){this.disableResizeObserver(),this.containers.forEach(function(r){return r.destroy()}),this.plugins.forEach(function(r){return r.destroy()}),this.$el.remove(),Ue(document).unbind("fullscreenchange",this._boundFullscreenHandler),Ue(document).unbind("MSFullscreenChange",this._boundFullscreenHandler),Ue(document).unbind("mozfullscreenchange",this._boundFullscreenHandler),this.stopListening()}},{key:"handleFullscreenChange",value:function(){this.trigger(x.CORE_FULLSCREEN,this.isFullscreen()),this.updateSize()}},{key:"handleWindowResize",value:function(r){var l=window.innerWidth>window.innerHeight?"landscape":"portrait";this._screenOrientation!==l&&(this._screenOrientation=l,this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight}),this.trigger(x.CORE_SCREEN_ORIENTATION_CHANGED,{event:r,orientation:this._screenOrientation}))}},{key:"removeContainer",value:function(r){this.stopListening(r),this.containers=this.containers.filter(function(l){return l!==r})}},{key:"setupContainer",value:function(r){this.listenTo(r,x.CONTAINER_DESTROYED,this.removeContainer),this.containers.push(r)}},{key:"setupContainers",value:function(r){return r.forEach(this.setupContainer.bind(this)),this.trigger(x.CORE_CONTAINERS_CREATED),this.renderContainers(),this.activeContainer=r[0],this.render(),this.appendToParent(),this.containers}},{key:"renderContainers",value:function(){var r=this;this.containers.forEach(function(l){return r.el.appendChild(l.render().el)})}},{key:"createContainer",value:function(r,l){var f=this.containerFactory.createContainer(r,l);return this.setupContainer(f),this.el.appendChild(f.render().el),f}},{key:"getCurrentContainer",value:function(){return this.activeContainer}},{key:"getCurrentPlayback",value:function(){return this.activePlayback}},{key:"getPlaybackType",value:function(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function(){var r=Pn.fullscreenElement(),l=r&&(r===this.el||r===this.activePlaybackEl)||this.activePlaybackEl.webkitDisplayingFullscreen;return l}},{key:"toggleFullscreen",value:function(){var r=this;if(this.isFullscreen()){var l=Be.isiOS?this.activePlaybackEl:document;Pn.cancelFullscreen(l),!Be.isiOS&&this.$el.removeClass("fullscreen nocursor")}else{var f=Be.isiOS?this.activePlaybackEl:this.el;if(!f)return;Be.isSafari||Be.isiOS?Pn.requestFullscreen(f):Pn.requestFullscreen(f).then(function(g){return g},function(g){return setTimeout(function(){if(!r.isFullscreen())throw new ReferenceError(g)},600)}),!Be.isiOS&&this.$el.addClass("fullscreen")}}},{key:"onMouseMove",value:function(r){this.trigger(x.CORE_MOUSE_MOVE,r)}},{key:"onMouseLeave",value:function(r){this.trigger(x.CORE_MOUSE_LEAVE,r)}},{key:"configure",value:function(r){var l=this;this._options=Ue.extend(!0,this._options,r),this.configureDomRecycler();var f=r.source||r.sources;f&&this.load(f,r.mimeType||this.options.mimeType),this.trigger(x.CORE_OPTIONS_CHANGE,r),this.containers.forEach(function(g){return g.configure(l.options)})}},{key:"appendToParent",value:function(){var r=Kt.getStyleFor(xh.toString(),{baseUrl:this.options.baseUrl}),l=Kt.getStyleFor(Sh.toString(),{baseUrl:this.options.baseUrl});this.$el.append(r[0]),this.options.includeResetStyle&&this.$el.append(l[0]);var f=this.$el.parent()&&this.$el.parent().length;!f&&this.$el.appendTo(this.options.parentElement)}},{key:"render",value:function(){this.options.width=this.options.width||this.$el.width(),this.options.height=this.options.height||this.$el.height();var r={width:this.options.width,height:this.options.height};return this.previousSize=this.currentSize=this.computedSize=r,this.updateSize(),this.enableResizeObserver(),this}}]),a}(zn);Object.assign(wl.prototype,Nr);var kh=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n.options),r.player=n,r}return at(a,[{key:"loader",get:function(){return this.player.loader}},{key:"create",value:function(){return this.options.loader=this.loader,this.core=new wl(this.options),this.addCorePlugins(),this.core.createContainers(this.options),this.core}},{key:"addCorePlugins",value:function(){var r=this;return this.loader.corePlugins.forEach(function(l){var f=new l(r.core);r.core.addPlugin(f),r.setupExternalInterface(f)}),this.core}},{key:"setupExternalInterface",value:function(r){var l=r.getExternalInterface();for(var f in l)this.player[f]=l[f].bind(r)}}]),a}(en),Rh=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,ui=function(){function t(i,a,n){it(this,t),this.major=parseInt(i||0,10),this.minor=parseInt(a||0,10),this.patch=parseInt(n||0,10)}return at(t,[{key:"compare",value:function(a){var n=this.major-a.major;return n=n||this.minor-a.minor,n=n||this.patch-a.patch,n}},{key:"inc",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"patch";return typeof this[a]<"u"&&(this[a]+=1),this}},{key:"satisfies",value:function(a,n){return this.compare(a)>=0&&(!n||this.compare(n)<0)}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}],[{key:"parse",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=a.match(Rh)||[],r=va(n,4),l=r[1],f=r[2],g=r[3];return typeof l>"u"?null:new t(l,f,g)}}]),t}(),uo=function(i,a){return!i||!a?{}:Object.entries(i).filter(function(n){var r=va(n,2),l=r[1];return l.type===a}).reduce(function(n,r){var l=va(r,2),f=l[0],g=l[1];return n[f]=g,n},{})},tn=function(){var t={plugins:{},playbacks:[]},i="0.4.22";return function(){function a(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;it(this,a),this.playerId=r,this.playbackPlugins=hn(t.playbacks);var l=a.registeredPlugins,f=l.core,g=l.container;this.containerPlugins=Object.values(g),this.corePlugins=Object.values(f),Array.isArray(n)||this.validateExternalPluginsType(n),this.addExternalPlugins(n)}return at(a,[{key:"groupPluginsByType",value:function(r){return Array.isArray(r)&&(r=r.reduce(function(l,f){return l[f.type]||(l[f.type]=[]),l[f.type].push(f),l},{})),r}},{key:"removeDups",value:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=function(U,w){return U[w.prototype.name]&&l||(U[w.prototype.name]&&delete U[w.prototype.name],U[w.prototype.name]=w),U},g=r.reduceRight(f,Object.create(null)),T=[];for(var m in g)T.unshift(g[m]);return T}},{key:"addExternalPlugins",value:function(r){var l=typeof r.loadExternalPluginsFirst=="boolean"?r.loadExternalPluginsFirst:!0,f=typeof r.loadExternalPlaybacksFirst=="boolean"?r.loadExternalPlaybacksFirst:!0;if(r=this.groupPluginsByType(r),r.playback){var g=r.playback.filter(function(A){return a.checkVersionSupport(A),!0});this.playbackPlugins=f?this.removeDups(g.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(g),!0)}if(r.container){var T=r.container.filter(function(A){return a.checkVersionSupport(A),!0});this.containerPlugins=l?this.removeDups(T.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(T),!0)}if(r.core){var m=r.core.filter(function(A){return a.checkVersionSupport(A),!0});this.corePlugins=l?this.removeDups(m.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(m),!0)}}},{key:"validateExternalPluginsType",value:function(r){var l=["playback","container","core"];l.forEach(function(f){(r[f]||[]).forEach(function(g){var T="external "+g.type+" plugin on "+f+" array";if(g.type!==f)throw new ReferenceError(T)})})}}],[{key:"registeredPlaybacks",get:function(){return hn(t.playbacks)}},{key:"registeredPlugins",get:function(){var r=t.plugins,l=uo(r,"core"),f=uo(r,"container");return{core:l,container:f}}},{key:"checkVersionSupport",value:function(r){var l=r.prototype,f=l.supportedVersion,g=l.name;if(!f||!f.min)return Je.warn("Loader","missing version information for ".concat(g)),!1;var T=f.max?ui.parse(f.max):ui.parse(f.min).inc("minor"),m=ui.parse(f.min);return ui.parse(i).satisfies(m,T)?!0:(Je.warn("Loader","unsupported plugin ".concat(g,": Clappr version ").concat(i," does not match required range [").concat(m,",").concat(T,")")),!1)}},{key:"registerPlugin",value:function(r){if(!r||!r.prototype.name)return Je.warn("Loader","missing information to register plugin: ".concat(r)),!1;a.checkVersionSupport(r);var l=t.plugins;if(!l)return!1;var f=l[r.prototype.name];return f&&Je.warn("Loader","overriding plugin entry: ".concat(r.prototype.name," - ").concat(f)),l[r.prototype.name]=r,!0}},{key:"registerPlayback",value:function(r){if(!r||!r.prototype.name)return!1;a.checkVersionSupport(r);var l=t.playbacks,f=l.findIndex(function(T){return T.prototype.name===r.prototype.name});if(f>=0){var g=l[f];l.splice(f,1),Je.warn("Loader","overriding playback entry: ".concat(g.name," - ").concat(g))}return t.playbacks=[r].concat(hn(l)),!0}},{key:"unregisterPlugin",value:function(r){if(!r)return!1;var l=t.plugins,f=l[r];return f?(delete l[r],!0):!1}},{key:"unregisterPlayback",value:function(r){if(!r)return!1;var l=t.playbacks,f=l.findIndex(function(g){return g.prototype.name===r});return f<0?!1:(l.splice(f,1),t.playbacks=l,!0)}},{key:"clearPlugins",value:function(){t.plugins={}}},{key:"clearPlaybacks",value:function(){t.playbacks=[]}}]),a}()}(),Ch=_l().replace(/\/[^/]+$/,""),Ll=function(t){Et(a,t);var i=_t(a);function a(n){var r;it(this,a),r=i.call(this,n);var l={recycleVideo:!0},f={playerId:Yn(""),persistConfig:!0,width:640,height:360,baseUrl:Ch,allowUserInteraction:Be.isMobile,includeResetStyle:!0,playback:l};return r._options=Ue.extend(!0,f,n),r.options.sources=r._normalizeSources(n),r.options.chromeless||(r.options.allowUserInteraction=!0),r.options.allowUserInteraction||(r.options.disableKeyboardShortcuts=!0),r._registerOptionEventListeners(r.options.events),r._coreFactory=new kh(Li(r)),r.options.parentId?r.setParentId(r.options.parentId):r.options.parent&&r.attachTo(r.options.parent),r}return at(a,[{key:"loader",get:function(){return this._loader||(this._loader=new tn(this.options.plugins||{},this.options.playerId)),this._loader},set:function(r){this._loader=r}},{key:"ended",get:function(){return this.core.activeContainer.ended}},{key:"buffering",get:function(){return this.core.activeContainer.buffering}},{key:"isReady",get:function(){return!!this._ready}},{key:"eventsMapping",get:function(){return{onReady:x.PLAYER_READY,onResize:x.PLAYER_RESIZE,onPlay:x.PLAYER_PLAY,onPause:x.PLAYER_PAUSE,onStop:x.PLAYER_STOP,onEnded:x.PLAYER_ENDED,onSeek:x.PLAYER_SEEK,onError:x.PLAYER_ERROR,onTimeUpdate:x.PLAYER_TIMEUPDATE,onVolumeUpdate:x.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:x.PLAYER_SUBTITLE_AVAILABLE}}},{key:"setParentId",value:function(r){var l=document.querySelector(r);return l&&this.attachTo(l),this}},{key:"attachTo",value:function(r){return this.options.parentElement=r,this.core=this._coreFactory.create(),this._addEventListeners(),this}},{key:"_addEventListeners",value:function(){return this.core.isReady?this._onReady():this.listenToOnce(this.core,x.CORE_READY,this._onReady),this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged),this.listenTo(this.core,x.CORE_FULLSCREEN,this._onFullscreenChange),this.listenTo(this.core,x.CORE_RESIZE,this._onResize),this}},{key:"_addContainerEventListeners",value:function(){var r=this.core.activeContainer;return r&&(this.listenTo(r,x.CONTAINER_PLAY,this._onPlay),this.listenTo(r,x.CONTAINER_PAUSE,this._onPause),this.listenTo(r,x.CONTAINER_STOP,this._onStop),this.listenTo(r,x.CONTAINER_ENDED,this._onEnded),this.listenTo(r,x.CONTAINER_SEEK,this._onSeek),this.listenTo(r,x.CONTAINER_ERROR,this._onError),this.listenTo(r,x.CONTAINER_TIMEUPDATE,this._onTimeUpdate),this.listenTo(r,x.CONTAINER_VOLUME,this._onVolumeUpdate),this.listenTo(r,x.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)),this}},{key:"_registerOptionEventListeners",value:function(){var r=this,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=Object.keys(l).length>0;return g&&Object.keys(f).forEach(function(T){var m=r.eventsMapping[T];m&&r.off(m,f[T])}),Object.keys(l).forEach(function(T){var m=r.eventsMapping[T];if(m){var A=l[T];A=typeof A=="function"&&A,A&&r.on(m,A)}}),this}},{key:"_containerChanged",value:function(){this.stopListening(),this._addEventListeners()}},{key:"_onReady",value:function(){this._ready=!0,this._addContainerEventListeners(),this.trigger(x.PLAYER_READY)}},{key:"_onFullscreenChange",value:function(r){this.trigger(x.PLAYER_FULLSCREEN,r)}},{key:"_onVolumeUpdate",value:function(r){this.trigger(x.PLAYER_VOLUMEUPDATE,r)}},{key:"_onSubtitleAvailable",value:function(){this.trigger(x.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function(r){this.trigger(x.PLAYER_RESIZE,r)}},{key:"_onPlay",value:function(){this.trigger(x.PLAYER_PLAY)}},{key:"_onPause",value:function(){this.trigger(x.PLAYER_PAUSE)}},{key:"_onStop",value:function(){this.trigger(x.PLAYER_STOP,this.getCurrentTime())}},{key:"_onEnded",value:function(){this.trigger(x.PLAYER_ENDED)}},{key:"_onSeek",value:function(r){this.trigger(x.PLAYER_SEEK,r)}},{key:"_onTimeUpdate",value:function(r){this.trigger(x.PLAYER_TIMEUPDATE,r)}},{key:"_onError",value:function(r){this.trigger(x.PLAYER_ERROR,r)}},{key:"_normalizeSources",value:function(r){var l=r.sources||(r.source!==void 0?[r.source]:[]);return l.length===0?[{source:"",mimeType:""}]:l}},{key:"resize",value:function(r){return this.core.resize(r),this}},{key:"load",value:function(r,l,f){return f!==void 0&&this.configure({autoPlay:!!f}),this.core.load(r,l),this}},{key:"destroy",value:function(){return this.stopListening(),this.core.destroy(),this}},{key:"consent",value:function(r){this.core.getCurrentPlayback().consent(r)}},{key:"play",value:function(){return this.core.activeContainer.play(),this}},{key:"pause",value:function(){return this.core.activeContainer.pause(),this}},{key:"stop",value:function(){return this.core.activeContainer.stop(),this}},{key:"seek",value:function(r){return this.core.activeContainer.seek(r),this}},{key:"seekPercentage",value:function(r){return this.core.activeContainer.seekPercentage(r),this}},{key:"mute",value:function(){return this.core.activePlayback.mute(),this}},{key:"unmute",value:function(){return this.core.activePlayback.unmute(),this}},{key:"isPlaying",value:function(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._registerOptionEventListeners(r.events,this.options.events),this.core.configure(r),this}},{key:"getPlugin",value:function(r){var l=this.core.plugins.concat(this.core.activeContainer.plugins);return l.filter(function(f){return f.name===r})[0]}},{key:"getCurrentTime",value:function(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function(){return this.core.activeContainer.getDuration()}}]),a}(en);Object.assign(Ll.prototype,Nr);var Qr=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n.options),r.container=n,r.enabled=!0,r.bindEvents(),r}return at(a,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"bindEvents",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),a}(en);Object.assign(Qr.prototype,Nr);Qr.extend=function(t){return xn(Qr,t)};Qr.type="container";var Or=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n.options),r.core=n,r.enabled=!0,r.bindEvents(),r}return at(a,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"getExternalInterface",value:function(){return{}}},{key:"destroy",value:function(){this.stopListening()}}]),a}(en);Object.assign(Or.prototype,Nr);Or.extend=function(t){return xn(Or,t)};Or.type="core";var Jr=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n.options),r.container=n,r.enabled=!0,r.bindEvents(),r}return at(a,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"bindEvents",value:function(){}}]),a}(zn);Object.assign(Jr.prototype,Nr);Jr.extend=function(t){return xn(Jr,t)};Jr.type="container";var wh=`<% for (var i = 0; i < tracks.length; i++) { %>
  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">
<% }; %>
`,Lh=`[data-html5-video] {
  position: absolute;
  height: 100%;
  width: 100%;
  display: block; }
`,En={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(t){return'video/mp4; codecs="'+t+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};En.ogv=En.ogg;En["3gp"]=En["3gpp"];var jn={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},Ih=Object.keys(jn).reduce(function(t,i){return[].concat(hn(t),hn(jn[i]))},[]),co={code:"unknown",message:"unknown"},gr=function(t){Et(a,t);var i=_t(a);function a(){var n;it(this,a);for(var r=arguments.length,l=new Array(r),f=0;f<r;f++)l[f]=arguments[f];n=i.call.apply(i,[this].concat(l)),n._destroyed=!1,n._loadStarted=!1,n._isBuffering=!1,n._playheadMoving=!1,n._playheadMovingTimer=null,n._stopped=!1,n._ccTrackId=-1,n._setupSrc(n.options.src),n.options.playback||(n.options.playback=n.options||{}),n.options.playback.disableContextMenu=n.options.playback.disableContextMenu||n.options.disableVideoTagContextMenu,n._minDvrSize=n.isValidMinimumDVRSizeConfig?n.minimumDVRSizeConfig:60;var g=n.options.playback,T=g.preload||(Be.isSafari?"auto":n.options.preload),m;return n.options.poster&&(typeof n.options.poster=="string"?m=n.options.poster:typeof n.options.poster.url=="string"&&(m=n.options.poster.url)),Ue.extend(!0,n.el,{muted:n.options.mute,defaultMuted:n.options.mute,loop:n.options.loop,poster:m,preload:T||"metadata",crossOrigin:g.crossOrigin,"x-webkit-playsinline":g.playInline}),(g.controls||n.options.useVideoTagDefaultControls)&&n.$el.attr("controls",""),g.playInline&&n.$el.attr({playsinline:"playsinline"}),g.crossOrigin&&n.$el.attr({crossorigin:g.crossOrigin}),n.settings={default:["seekbar"]},n.settings.left=["playpause","position","duration"],n.settings.right=["fullscreen","volume","hd-indicator"],g.externalTracks&&n._setupExternalTracks(g.externalTracks),n.options.autoPlay&&n.attemptAutoPlay(),n}return at(a,[{key:"name",get:function(){return"html5_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function(){var r=this.options.src,l=a._mimeTypesForUrl(r,jn,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||Ih.indexOf(l[0])>=0}},{key:"attributes",get:function(){return{"data-html5-video":""}}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}},{key:"isLive",get:function(){return this.getPlaybackType()===je.LIVE}},{key:"dvrEnabled",get:function(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function(){return typeof this.minimumDVRSizeConfig<"u"&&typeof this.minimumDVRSizeConfig=="number"}},{key:"configure",value:function(r){Xr(_r(a.prototype),"configure",this).call(this,r),this.el.loop=!!r.loop}},{key:"attemptAutoPlay",value:function(){var r=this;this.canAutoPlay(function(l,f){f&&Je.warn(r.name,"autoplay error.",{result:l,error:f}),l&&setTimeout(function(){return!r._destroyed&&r.play()},0)})}},{key:"canAutoPlay",value:function(r){if(this.options.disableCanAutoPlay){r(!0,null);return}var l={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||!1,muted:this.options.mute||!1};Be.isMobile&&An.options.recycleVideo&&(l.element=this.el),Tl(r,l)}},{key:"_setupExternalTracks",value:function(r){this._externalTracks=r.map(function(l){return{kind:l.kind||"subtitles",label:l.label,lang:l.lang,src:l.src}})}},{key:"_setupSrc",value:function(r){this.el.src!==r&&(this._ccIsSetup=!1,this.el.src=r,this._src=this.el.src)}},{key:"_onLoadedMetadata",value:function(r){this._handleBufferingEvents(),this.trigger(x.PLAYBACK_LOADEDMETADATA,{duration:r.target.duration,data:r}),this._updateSettings();var l=typeof this._options.autoSeekFromUrl>"u"||this._options.autoSeekFromUrl;this.getPlaybackType()!==je.LIVE&&l&&this._checkInitialSeek()}},{key:"_onDurationChange",value:function(){this._updateSettings(),this._onTimeUpdate(),this._onProgress()}},{key:"_updateSettings",value:function(){this.getPlaybackType()===je.VOD||this.getPlaybackType()===je.AOD?this.settings.left=["playpause","position","duration"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(x.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function(){var r=this.tagName==="audio"?je.AOD:je.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?je.LIVE:r}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"consent",value:function(r){var l=this;if(this.isPlaying()||this.el._consented)Xr(_r(a.prototype),"consent",this).call(this,r);else{var f=function g(){l.el.removeEventListener("loadedmetadata",g,!1),l.el.removeEventListener("error",g,!1),l.el._consented=!0,Xr(_r(a.prototype),"consent",l).call(l,r)};this.el.addEventListener("loadedmetadata",f,!1),this.el.addEventListener("error",f,!1),this.el.load()}}},{key:"play",value:function(){this.trigger(x.PLAYBACK_PLAY_INTENT),this._stopped=!1,this._setupSrc(this._src),this._handleBufferingEvents();var r=this.el.play();r&&r.catch&&r.catch(function(){})}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this.el.removeAttribute("src"),this.el.load(),this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(x.PLAYBACK_STOP)}},{key:"volume",value:function(r){r===0?(this.$el.attr({muted:"true"}),this.el.muted=!0):(this.$el.attr({muted:null}),this.el.muted=!1,this.el.volume=r/100)}},{key:"mute",value:function(){this.el.muted=!0}},{key:"unmute",value:function(){this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted===!0||this.el.volume===0}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startPlayheadMovingChecks",value:function(){this._playheadMovingTimer===null&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){this._playheadMovingTimer!==null&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var r=this._playheadMovingTimeOnCheck,l=this.el.currentTime;this._playheadMoving=r!==l,this._playheadMovingTimeOnCheck=l,this._handleBufferingEvents()}},{key:"_onWaiting",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function(){this._checkForClosedCaptions(),this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(x.PLAYBACK_PLAY)}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(x.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function(){this.trigger(x.PLAYBACK_SEEK,this.getCurrentTime()),this._handleBufferingEvents()}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(x.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(x.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingEvents",value:function(){var r=!this.el.ended&&!this.el.paused,l=this._loadStarted&&!this.el.ended&&!this._stopped&&(r&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!==l&&(this._isBuffering=l,l?this.trigger(x.PLAYBACK_BUFFERING,this.name):this.trigger(x.PLAYBACK_BUFFERFULL,this.name))}},{key:"_onError",value:function(){var r=this.el.error||co,l=r.code,f=r.message,g=l===co.code,T=this.createError({code:l,description:f,raw:this.el.error,level:g?nr.Levels.WARN:nr.Levels.FATAL});g?Je.warn(this.name,"HTML5 unknown error: ",T):this.trigger(x.PLAYBACK_ERROR,T)}},{key:"destroy",value:function(){this._destroyed=!0,this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange),Xr(_r(a.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this.el.load(),this._src=null,An.garbage(this.el)}},{key:"_updateDvr",value:function(r){this.trigger(x.PLAYBACK_DVR,r),this.trigger(x.PLAYBACK_STATS_ADD,{dvr:r})}},{key:"seek",value:function(r){r<0&&(Je.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),r=this.getDuration()),this.dvrEnabled&&this._updateDvr(r<this.getDuration()-3),r+=this.el.seekable.start(0),this.el.currentTime=r}},{key:"seekPercentage",value:function(r){var l=this.el.duration*(r/100);this.seek(l)}},{key:"_checkInitialSeek",value:function(){var r=El();r!==0&&this.seek(r)}},{key:"getCurrentTime",value:function(){return this.el.currentTime}},{key:"getDuration",value:function(){if(this.isLive){if(this.el.seekable.length>0)return this.el.seekable.end(0)-this.el.seekable.start(0);this._scheduleUpdateSettingsCheck()}return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function(){var r=this;this._updateSettingsCheckInFlight||(this._updateSettingsCheckInFlight=setTimeout(function(){r._updateSettings(),r._updateSettingsCheckInFlight=null},1e3))}},{key:"_onTimeUpdate",value:function(){var r=this.isLive?this.getDuration():this.el.duration;this.trigger(x.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:r},this.name)}},{key:"_onProgress",value:function(){if(!!this.el.buffered.length){for(var r=[],l=0,f=0;f<this.el.buffered.length;f++)r=[].concat(hn(r),[{start:this.el.buffered.start(f),end:this.el.buffered.end(f)}]),this.el.currentTime>=r[f].start&&this.el.currentTime<=r[f].end&&(l=f);var g={start:r[l].start,current:r[l].end,total:this.el.duration};this.trigger(x.PLAYBACK_PROGRESS,g,r)}}},{key:"_typeFor",value:function(r){var l=a._mimeTypesForUrl(r,En,this.options.mimeType);l.length===0&&(l=a._mimeTypesForUrl(r,jn,this.options.mimeType));var f=l[0]||"";return f.split(";")[0]}},{key:"_ready",value:function(){this._isReadyState||(this._isReadyState=!0,this.trigger(x.PLAYBACK_READY,this.name))}},{key:"_checkForClosedCaptions",value:function(){if(this.isHTML5Video&&!this._ccIsSetup){if(this.hasClosedCaptionsTracks){this.trigger(x.PLAYBACK_SUBTITLE_AVAILABLE);var r=this.closedCaptionsTrackId;this.closedCaptionsTrackId=r,this.handleTextTrackChange=this._handleTextTrackChange.bind(this),this.el.textTracks.addEventListener("change",this.handleTextTrackChange)}this._ccIsSetup=!0}}},{key:"_handleTextTrackChange",value:function(){var r=this.closedCaptionsTracks,l=r.find(function(f){return f.track.mode==="showing"})||{id:-1};this._ccTrackId!==l.id&&(this._ccTrackId=l.id,this.trigger(x.PLAYBACK_SUBTITLE_CHANGED,{id:l.id}))}},{key:"isHTML5Video",get:function(){return this.name===a.prototype.name}},{key:"closedCaptionsTracks",get:function(){var r=0,l=function(){return r++},f=this.el.textTracks?Array.from(this.el.textTracks):[];return f.filter(function(g){return g.kind==="subtitles"||g.kind==="captions"}).map(function(g){return{id:l(),name:g.label,track:g}})}},{key:"closedCaptionsTrackId",get:function(){return this._ccTrackId},set:function(r){if(!!Ai(r)){var l=this.closedCaptionsTracks,f;r!==-1&&(f=l.find(function(g){return g.id===r}),!f||f.track.mode==="showing")||(l.filter(function(g){return g.track.mode!=="hidden"}).forEach(function(g){return g.track.mode="hidden"}),f&&(f.track.mode="showing"),this._ccTrackId=r,this.trigger(x.PLAYBACK_SUBTITLE_CHANGED,{id:r}))}}},{key:"template",get:function(){return Xt(wh)}},{key:"render",value:function(){this.options.playback.disableContextMenu&&this.$el.on("contextmenu",function(){return!1}),this._externalTracks&&this._externalTracks.length>0&&this.$el.html(this.template({tracks:this._externalTracks})),this._ready();var r=Kt.getStyleFor(Lh.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(r[0]),this}}]),a}(je);gr._mimeTypesForUrl=function(t,i,a){var n=(t.split("?")[0].match(/.*\.(.*)$/)||[])[1],r=a||n&&i[n.toLowerCase()]||[];return r.constructor===Array?r:[r]};gr._canPlay=function(t,i,a,n){var r=gr._mimeTypesForUrl(a,i,n),l=document.createElement(t);return!!r.filter(function(f){return!!l.canPlayType(f).replace(/no/,"")})[0]};gr.canPlay=function(t,i){return gr._canPlay("audio",jn,t,i)||gr._canPlay("video",En,t,i)};var Il=function(t){Et(a,t);var i=_t(a);function a(){return it(this,a),i.apply(this,arguments)}return at(a,[{key:"name",get:function(){return"html5_audio"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"tagName",get:function(){return"audio"}},{key:"isAudioOnly",get:function(){return!0}},{key:"updateSettings",value:function(){this.settings.left=["playpause","position","duration"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(x.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function(){return je.AOD}}]),a}(gr);Il.canPlay=function(t,i){var a={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]};return gr._canPlay("audio",a,t,i)};var Oh=`[data-html-img] {
  max-width: 100%;
  max-height: 100%; }
`,Ol=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n),r.el.src=n.src,r}return at(a,[{key:"name",get:function(){return"html_img"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"tagName",get:function(){return"img"}},{key:"attributes",get:function(){return{"data-html-img":""}}},{key:"events",get:function(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}},{key:"getPlaybackType",value:function(){return je.NO_OP}},{key:"render",value:function(){var r=Kt.getStyleFor(Oh.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(r[0]),this.trigger(x.PLAYBACK_READY,this.name),this}},{key:"_onLoad",value:function(){this.trigger(x.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function(r){var l=r.type==="error"?"load error":"loading aborted";this.trigger(x.PLAYBACK_ERROR,{message:l},this.name)}}]),a}(je);Ol.canPlay=function(t){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(t)};var Dh=`<canvas data-no-op-canvas></canvas>
<p data-no-op-msg><%=message%></p><p>
</p>`,Ph=`[data-no-op] {
  position: absolute;
  height: 100%;
  width: 100%;
  text-align: center; }

[data-no-op] p[data-no-op-msg] {
  position: absolute;
  text-align: center;
  font-size: 25px;
  left: 0;
  right: 0;
  color: white;
  padding: 10px;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%);
  max-height: 100%;
  overflow: auto; }

[data-no-op] canvas[data-no-op-canvas] {
  background-color: #777;
  height: 100%;
  width: 100%; }
`,Dl=function(t){Et(a,t);var i=_t(a);function a(){var n;it(this,a);for(var r=arguments.length,l=new Array(r),f=0;f<r;f++)l[f]=arguments[f];return n=i.call.apply(i,[this].concat(l)),n._noiseFrameNum=-1,n}return at(a,[{key:"name",get:function(){return"no_op"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"template",get:function(){return Xt(Dh)}},{key:"attributes",get:function(){return{"data-no-op":""}}},{key:"render",value:function(){var r=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported"),l=Kt.getStyleFor(Ph.toString(),{baseUrl:this.options.baseUrl});this.$el.append(l[0]),this.$el.html(this.template({message:r})),this.trigger(x.PLAYBACK_READY,this.name);var f=!!(this.options.poster&&this.options.poster.showForNoOp);return(this.options.autoPlay||!f)&&this._animate(),this}},{key:"_noise",value:function(){if(this._noiseFrameNum=(this._noiseFrameNum+1)%5,!this._noiseFrameNum){var r=this.context.createImageData(this.context.canvas.width,this.context.canvas.height),l;try{l=new Uint32Array(r.data.buffer)}catch{l=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4);for(var f=r.data,g=0;g<f.length;g++)l[g]=f[g]}for(var T=l.length,m=Math.random()*6+4,A=0,U=0,w=0;w<T;){if(A<0){A=m*Math.random();var L=Math.pow(Math.random(),.4);U=255*L<<24}A-=1,l[w++]=U}this.context.putImageData(r,0,0)}}},{key:"_loop",value:function(){var r=this;this._stop||(this._noise(),this._animationHandle=ml(function(){return r._loop()}))}},{key:"destroy",value:function(){this._animationHandle&&(yl(this._animationHandle),this._stop=!0)}},{key:"_animate",value:function(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0],this.context=this.canvas.getContext("2d"),this._loop()}}]),a}(je);Dl.canPlay=function(t){return!0};var Nh=function(t){Et(a,t);var i=_t(a);function a(n){var r;return it(this,a),r=i.call(this,n),r._initializeMessages(),r}return at(a,[{key:"name",get:function(){return"strings"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"t",value:function(r){var l=this._language(),f=this._messages.en,g=l&&this._messages[l]||f;return g[r]||f[r]||r}},{key:"_language",value:function(){return this.core.options.language||bl()}},{key:"_initializeMessages",value:function(){var r={en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zur\xFCck zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser unterst\xFCtzt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador n\xE3o supporta a reprodu\xE7\xE3o deste video. Por favor, tente usar um navegador diferente.",default_error_title:"N\xE3o foi poss\xEDvel reproduzir o v\xEDdeo.",default_error_message:"Ocorreu um problema ao tentar carregar o v\xEDdeo."},es_am:{live:"vivo",back_to_live:"volver en vivo",disabled:"No disponible",playback_not_supported:"Su navegador no soporta la reproducci\xF3n de este video. Por favor, utilice un navegador diferente.",default_error_title:"No se puede reproducir el video.",default_error_message:"Se ha producido un error al cargar el video."},es:{live:"en directo",back_to_live:"volver al directo",disabled:"No disponible",playback_not_supported:"Este navegador no es compatible para reproducir este v\xEDdeo. Utilice un navegador diferente.",default_error_title:"No se puede reproducir el v\xEDdeo.",default_error_message:"Se ha producido un problema al cargar el v\xEDdeo."},ru:{live:"\u043F\u0440\u044F\u043C\u043E\u0439 \u044D\u0444\u0438\u0440",back_to_live:"\u043A \u043F\u0440\u044F\u043C\u043E\u043C\u0443 \u044D\u0444\u0438\u0440\u0443",disabled:"\u041E\u0442\u043A\u043B\u044E\u0447\u0435\u043D\u043E",playback_not_supported:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0432\u043E\u0441\u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435\u043D\u0438\u0435 \u044D\u0442\u043E\u0433\u043E \u0432\u0438\u0434\u0435\u043E. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u043E\u0439 \u0431\u0440\u0430\u0443\u0437\u0435\u0440."},bg:{live:"\u043D\u0430 \u0436\u0438\u0432\u043E",back_to_live:"\u0412\u044A\u0440\u043D\u0438 \u043D\u0430 \u0436\u0438\u0432\u043E",disabled:"\u0418\u0437\u043A\u043B\u044E\u0447\u0435\u043D\u043E",playback_not_supported:"\u0412\u0430\u0448\u0438\u044F\u0442 \u0431\u0440\u0430\u0443\u0437\u044A\u0440 \u043D\u0435 \u043F\u043E\u0434\u0434\u044A\u0440\u0436\u0430 \u0432\u044A\u0437\u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0436\u0434\u0430\u043D\u0435\u0442\u043E \u043D\u0430 \u0442\u043E\u0432\u0430 \u0432\u0438\u0434\u0435\u043E. \u041C\u043E\u043B\u044F, \u043F\u0440\u043E\u0431\u0432\u0430\u0439\u0442\u0435 \u0441 \u0434\u0440\u0443\u0433 \u0431\u0440\u0430\u0443\u0437\u044A\u0440.",default_error_title:"\u0412\u0438\u0434\u0435\u043E\u0442\u043E \u043D\u0435 \u043C\u043E\u0436\u0435 \u0434\u0430 \u0441\u0435 \u0432\u044A\u0437\u043F\u0440\u043E\u0438\u0437\u0432\u0435\u0434\u0435.",default_error_message:"\u0412\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u043F\u0440\u043E\u0431\u043B\u0435\u043C \u043F\u0440\u0438 \u0437\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435\u0442\u043E \u043D\u0430 \u0432\u0438\u0434\u0435\u043E\u0442\u043E."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"D\xE9sactiv\xE9",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vid\xE9o. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vid\xE9o.",default_error_message:"Un probl\xE8me est survenu lors du chargement de la vid\xE9o."},tr:{live:"canl\u0131",back_to_live:"canl\u0131 yay\u0131na d\xF6n",disabled:"Engelli",playback_not_supported:"Taray\u0131c\u0131n\u0131z bu videoyu oynatma deste\u011Fine sahip de\u011Fil. L\xFCtfen farkl\u0131 bir taray\u0131c\u0131 ile deneyin."},et:{live:"Otse\xFClekanne",back_to_live:"Tagasi otse\xFClekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"\u0645\u0628\u0627\u0634\u0631",back_to_live:"\u0627\u0644\u0631\u062C\u0648\u0639 \u0625\u0644\u0649 \u0627\u0644\u0645\u0628\u0627\u0634\u0631",disabled:"\u0645\u0639\u0637\u0651\u0644",playback_not_supported:"\u0627\u0644\u0645\u062A\u0635\u0641\u062D \u0627\u0644\u0630\u064A \u062A\u0633\u062A\u062E\u062F\u0645\u0647 \u0644\u0627 \u064A\u062F\u0639\u0645 \u062A\u0634\u063A\u064A\u0644 \u0647\u0630\u0627 \u0627\u0644\u0641\u064A\u062F\u064A\u0648. \u0627\u0644\u0631\u062C\u0627\u0621 \u0625\u0633\u062A\u062E\u062F\u0627\u0645 \u0645\u062A\u0635\u0641\u062D \u0622\u062E\u0631.",default_error_title:"\u063A\u064A\u0631 \u0642\u0627\u062F\u0631 \u0627\u0644\u0649 \u0627\u0644\u062A\u0634\u063A\u064A\u0644.",default_error_message:"\u062D\u062F\u062B\u062A \u0645\u0634\u0643\u0644\u0629 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0641\u064A\u062F\u064A\u0648."}};this._messages=Ue.extend(!0,r,this.core.options.strings||{}),this._messages["de-DE"]=this._messages.de,this._messages["pt-BR"]=this._messages.pt,this._messages["en-US"]=this._messages.en,this._messages["bg-BG"]=this._messages.bg,this._messages["es-419"]=this._messages.es_am,this._messages["es-ES"]=this._messages.es,this._messages["fr-FR"]=this._messages.fr,this._messages["tr-TR"]=this._messages.tr,this._messages["et-EE"]=this._messages.et,this._messages["ar-IQ"]=this._messages.ar}}]),a}(Or),Fh=function(t){Et(a,t);var i=_t(a);function a(){return it(this,a),i.apply(this,arguments)}return at(a,[{key:"name",get:function(){return"sources"}},{key:"supportedVersion",get:function(){return{min:"0.4.22"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,x.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function(){var r=this.core.containers.filter(function(l){return l.playback.name!=="no_op"})[0]||this.core.containers[0];r&&this.core.containers.forEach(function(l){l!==r&&l.destroy()})}}]),a}(Or);tn.registerPlugin(Nh);tn.registerPlugin(Fh);tn.registerPlayback(Dl);tn.registerPlayback(Ol);tn.registerPlayback(Il);tn.registerPlayback(gr);function Ht(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function fo(t,i){for(var a=0;a<i.length;a++){var n=i[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jt(t,i,a){return i&&fo(t.prototype,i),a&&fo(t,a),t}function Yt(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&Ea(t,i)}function Dr(t){return Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},Dr(t)}function Ea(t,i){return Ea=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Ea(t,i)}function Mh(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pl(t,i){return i&&(typeof i=="object"||typeof i=="function")?i:Bh(t)}function zt(t){var i=Mh();return function(){var n=Dr(t),r;if(i){var l=Dr(this).constructor;r=Reflect.construct(n,arguments,l)}else r=n.apply(this,arguments);return Pl(this,r)}}function Uh(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&(t=Dr(t),t!==null););return t}function gn(t,i,a){return typeof Reflect<"u"&&Reflect.get?gn=Reflect.get:gn=function(r,l,f){var g=Uh(r,l);if(!!g){var T=Object.getOwnPropertyDescriptor(g,l);return T.get?T.get.call(f):T.value}},gn(t,i,a||t)}var Kh=function(t){Yt(a,t);var i=zt(a);function a(n){return Ht(this,a),i.call(this,n)}return jt(a,[{key:"name",get:function(){return"click_to_pause"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"config",get:function(){return this.container.options.clickToPauseConfig||{}}},{key:"bindEvents",value:function(){this.listenTo(this.container,x.CONTAINER_CLICK,this.click),this.listenTo(this.container,x.CONTAINER_SETTINGSUPDATE,this.settingsUpdate)}},{key:"click",value:function(){var r=this.config.onClickPayload;(this.container.getPlaybackType()!==je.LIVE||this.container.isDvrEnabled())&&(this.container.isPlaying()?this.container.pause(r):this.container.play(r))}},{key:"settingsUpdate",value:function(){var r=this.container.getPlaybackType()!==je.LIVE||this.container.isDvrEnabled();if(r!==this.pointerEnabled){var l=r?"addClass":"removeClass";this.container.$el[l]("pointer-enabled"),this.pointerEnabled=r}}}]),a}(Qr),Vh=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve">
<path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1
	c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9
	C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"/>
</svg>`,Gh=`<button type="button" class="cc-button media-control-button media-control-icon" data-cc-button aria-label="<%= ariaLabel %>"></button>
<ul>
  <% if (title) { %>
  <li data-title><%= title %></li>
  <% }; %>
  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>
  <% for (var i = 0; i < tracks.length; i++) { %>
    <li><a href="#" data-cc-select="<%= tracks[i].id %>"><%= tracks[i].label %></a></li>
  <% }; %>
</ul>
`,Hh=`.cc-controls[data-cc-controls] {
  float: right;
  position: relative;
  display: none; }
  .cc-controls[data-cc-controls].available {
    display: block; }
  .cc-controls[data-cc-controls] .cc-button {
    padding: 6px !important; }
    .cc-controls[data-cc-controls] .cc-button.enabled {
      display: block;
      opacity: 1.0; }
      .cc-controls[data-cc-controls] .cc-button.enabled:hover {
        opacity: 1.0;
        text-shadow: none; }
  .cc-controls[data-cc-controls] > ul {
    list-style-type: none;
    position: absolute;
    bottom: 25px;
    border: 1px solid black;
    display: none;
    background-color: #e6e6e6; }
  .cc-controls[data-cc-controls] li {
    font-size: 10px; }
    .cc-controls[data-cc-controls] li[data-title] {
      background-color: #c3c2c2;
      padding: 5px; }
    .cc-controls[data-cc-controls] li a {
      color: #444;
      padding: 2px 10px;
      display: block;
      text-decoration: none; }
      .cc-controls[data-cc-controls] li a:hover {
        background-color: #555;
        color: white; }
        .cc-controls[data-cc-controls] li a:hover a {
          color: white;
          text-decoration: none; }
    .cc-controls[data-cc-controls] li.current a {
      color: #f00; }
`,jh=function(t){Yt(a,t);var i=zt(a);function a(n){var r;Ht(this,a),r=i.call(this,n);var l=n.options.closedCaptionsConfig;return r._title=l&&l.title?l.title:null,r._ariaLabel=l&&l.ariaLabel?l.ariaLabel:"cc-button",r._labelCb=l&&l.labelCallback&&typeof l.labelCallback=="function"?l.labelCallback:function(f){return f.name},r}return jt(a,[{key:"name",get:function(){return"closed_captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"template",get:function(){return Xt(Gh)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,x.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,x.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,x.CONTAINER_SUBTITLE_AVAILABLE,this.onSubtitleAvailable),this.listenTo(this.container,x.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,x.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){this.ccAvailable(!1),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(r){this.setCurrentContextMenuElement(r.id)}},{key:"onTrackSelect",value:function(r){var l=parseInt(r.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=l,this.hideContextMenu(),r.stopPropagation(),!1}},{key:"ccAvailable",value:function(r){var l=r?"addClass":"removeClass";this.$el[l]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(r){return this.$el.find("ul a"+(isNaN(r)?"":'[data-cc-select="'+r+'"]')).parent()}},{key:"setCurrentContextMenuElement",value:function(r){if(this._trackId!==r){this.contextMenuElement().removeClass("current"),this.contextMenuElement(r).addClass("current");var l=r>-1?"addClass":"removeClass";this.$ccButton[l]("enabled"),this._trackId=r}}},{key:"renderCcButton",value:function(){for(var r=this.container?this.container.closedCaptionsTracks:[],l=0;l<r.length;l++)r[l].label=this._labelCb(r[l]);var f=Kt.getStyleFor(Hh,{baseUrl:this.options.baseUrl});this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:r})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(Vh),this.$el.append(f[0])}},{key:"render",value:function(){this.renderCcButton();var r=this.core.mediaControl.$el.find("button[data-fullscreen]");return r[0]?this.$el.insertAfter(r):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),a}(vr),Yh=`<div class="live-info"><%= live %></div>
<button type="button" class="live-button" aria-label="<%= backToLive %>"><%= backToLive %></button>
`,zh=`.dvr-controls[data-dvr-controls] {
  display: inline-block;
  float: left;
  color: #fff;
  line-height: 32px;
  font-size: 10px;
  font-weight: bold;
  margin-left: 6px; }
  .dvr-controls[data-dvr-controls] .live-info {
    cursor: default;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase; }
    .dvr-controls[data-dvr-controls] .live-info:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #ff0101; }
    .dvr-controls[data-dvr-controls] .live-info.disabled {
      opacity: 0.3; }
      .dvr-controls[data-dvr-controls] .live-info.disabled:before {
        background-color: #fff; }
  .dvr-controls[data-dvr-controls] .live-button {
    cursor: pointer;
    outline: none;
    display: none;
    border: 0;
    color: #fff;
    background-color: transparent;
    height: 32px;
    padding: 0;
    opacity: 0.7;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase;
    transition: all 0.1s ease; }
    .dvr-controls[data-dvr-controls] .live-button:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #fff; }
    .dvr-controls[data-dvr-controls] .live-button:hover {
      opacity: 1;
      text-shadow: rgba(255, 255, 255, 0.75) 0 0 5px; }

.dvr .dvr-controls[data-dvr-controls] .live-info {
  display: none; }

.dvr .dvr-controls[data-dvr-controls] .live-button {
  display: block; }

.dvr.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #005aff; }

.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #ff0101; }
`,Wh=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.settingsUpdate(),r}return jt(a,[{key:"template",get:function(){return Xt(Yh)}},{key:"name",get:function(){return"dvr_controls"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"events",get:function(){return{"click .live-button":"click"}}},{key:"attributes",get:function(){return{class:"dvr-controls","data-dvr-controls":""}}},{key:"bindEvents",value:function(){this.bindCoreEvents(),this.bindContainerEvents()}},{key:"bindCoreEvents",value:function(){var r=this;this.core.mediaControl.settings?(this.listenTo(this.core.mediaControl,x.MEDIACONTROL_CONTAINERCHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,x.MEDIACONTROL_RENDERED,this.settingsUpdate),this.listenTo(this.core,x.CORE_OPTIONS_CHANGE,this.render)):setTimeout(function(){return r.bindCoreEvents()},100)}},{key:"bindContainerEvents",value:function(){this.core.activeContainer&&(this.listenToOnce(this.core.activeContainer,x.CONTAINER_TIMEUPDATE,this.render),this.listenTo(this.core.activeContainer,x.CONTAINER_PLAYBACKDVRSTATECHANGED,this.dvrChanged))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"dvrChanged",value:function(r){this.core.getPlaybackType()===je.LIVE&&(this.settingsUpdate(),this.core.mediaControl.$el.addClass("live"),r?(this.core.mediaControl.$el.addClass("dvr"),this.core.mediaControl.$el.find(".media-control-indicator[data-position], .media-control-indicator[data-duration]").hide()):this.core.mediaControl.$el.removeClass("dvr"))}},{key:"click",value:function(){var r=this.core.mediaControl,l=r.container;l.isPlaying()||l.play(),r.$el.hasClass("dvr")&&l.seek(l.getDuration())}},{key:"settingsUpdate",value:function(){var r=this;this.stopListening(),this.core.mediaControl.$el.removeClass("live"),this.shouldRender()&&(this.render(),this.$el.click(function(){return r.click()})),this.bindEvents()}},{key:"shouldRender",value:function(){var r=this.core.options.useDvrControls===void 0||!!this.core.options.useDvrControls;return r&&this.core.getPlaybackType()===je.LIVE}},{key:"render",value:function(){var r=Kt.getStyleFor(zh,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({live:this.core.i18n.t("live"),backToLive:this.core.i18n.t("back_to_live")})),this.$el.append(r[0]),this.shouldRender()&&(this.core.mediaControl.$el.addClass("live"),this.core.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.$el)),this}}]),a}(vr),$h=function(t){Yt(a,t);var i=zt(a);function a(){return Ht(this,a),i.apply(this,arguments)}return jt(a,[{key:"name",get:function(){return"end_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);var r=this.core.activeContainer;r&&(this.listenTo(r,x.CONTAINER_ENDED,this.ended),this.listenTo(r,x.CONTAINER_STOP,this.ended))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"ended",value:function(){var r=typeof this.core.options.exitFullscreenOnEnd>"u"||this.core.options.exitFullscreenOnEnd;r&&this.core.isFullscreen()&&this.core.toggleFullscreen()}}]),a}(Or),Xh=`<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`,qh=`<div class="player-error-screen__content" data-error-screen>
  <% if (icon) { %>
  <div class="player-error-screen__icon" data-error-screen><%= icon %></div>
  <% } %>
  <div class="player-error-screen__title" data-error-screen><%= title %></div>
  <div class="player-error-screen__message" data-error-screen><%= message %></div>
  <div class="player-error-screen__code" data-error-screen>Error code: <%= code %></div>
  <div class="player-error-screen__reload" data-error-screen><%= reloadIcon %></div>
</div>
`,Zh=`[data-player] .player-error-screen {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #CCCACA;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center; }
  [data-player] .player-error-screen__content[data-error-screen] {
    font-size: 14px;
    color: #CCCACA;
    margin-top: 45px; }
  [data-player] .player-error-screen__title[data-error-screen] {
    font-weight: bold;
    line-height: 30px;
    font-size: 18px; }
  [data-player] .player-error-screen__message[data-error-screen] {
    width: 90%;
    margin: 0 auto; }
  [data-player] .player-error-screen__code[data-error-screen] {
    font-size: 13px;
    margin-top: 15px; }
  [data-player] .player-error-screen__reload {
    cursor: pointer;
    width: 30px;
    margin: 15px auto 0 !important; }
`,Qh=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.options.disableErrorScreen?Pl(r,r.disable()):r}return jt(a,[{key:"name",get:function(){return"error_screen"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"template",get:function(){return Xt(qh)}},{key:"container",get:function(){return this.core.getCurrentContainer()}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,x.ERROR,this.onError),this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this.onContainerChanged)}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var r=this;this.listenToOnce(this.core,x.CORE_READY,function(){return r.container.play()}),this.core.load(this.options.sources,this.options.mimeType),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onContainerChanged",value:function(){this.err=null,this.unbindReload(),this.hide()}},{key:"onError",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r.level===nr.Levels.FATAL&&(this.err=r,this.container.disableMediaControl(),this.container.stop(),this.show())}},{key:"show",value:function(){this.render(),this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"render",value:function(){if(!!this.err){var r=Kt.getStyleFor(Zh,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({title:this.err.UI.title,message:this.err.UI.message,code:this.err.code,icon:this.err.UI.icon||"",reloadIcon:Xh})),this.$el.append(r[0]),this.core.$el.append(this.el),this.bindReload(),this}}}]),a}(vr),$r=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"/>
</svg>`,_a=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 14.76H6.43V1.24H1.71v13.52zm7.86-13.52v13.52h4.716V1.24H9.573z"/>
</svg>`,Jh=Ue('link[rel="shortcut icon"]'),eg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r._container=null,r.configure(),r}return jt(a,[{key:"name",get:function(){return"favicon"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"oldIcon",get:function(){return Jh}},{key:"configure",value:function(){this.core.options.changeFavicon?this.enabled||(this.stopListening(this.core,x.CORE_OPTIONS_CHANGE),this.enable()):this.enabled&&(this.disable(),this.listenTo(this.core,x.CORE_OPTIONS_CHANGE,this.configure))}},{key:"bindEvents",value:function(){this.listenTo(this.core,x.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.core.activeContainer&&this.containerChanged()}},{key:"containerChanged",value:function(){this._container&&this.stopListening(this._container),this._container=this.core.activeContainer,this.listenTo(this._container,x.CONTAINER_PLAY,this.setPlayIcon),this.listenTo(this._container,x.CONTAINER_PAUSE,this.setPauseIcon),this.listenTo(this._container,x.CONTAINER_STOP,this.resetIcon),this.listenTo(this._container,x.CONTAINER_ENDED,this.resetIcon),this.listenTo(this._container,x.CONTAINER_ERROR,this.resetIcon),this.resetIcon()}},{key:"disable",value:function(){gn(Dr(a.prototype),"disable",this).call(this),this.resetIcon()}},{key:"destroy",value:function(){gn(Dr(a.prototype),"destroy",this).call(this),this.resetIcon()}},{key:"createIcon",value:function(r){var l=Ue("<canvas/>");l[0].width=16,l[0].height=16;var f=l[0].getContext("2d");f.fillStyle="#000";var g=Ue(r).find("path").attr("d"),T=new Path2D(g);f.fill(T);var m=Ue('<link rel="shortcut icon" type="image/png"/>');return m.attr("href",l[0].toDataURL("image/png")),m}},{key:"setPlayIcon",value:function(){this.playIcon||(this.playIcon=this.createIcon($r)),this.changeIcon(this.playIcon)}},{key:"setPauseIcon",value:function(){this.pauseIcon||(this.pauseIcon=this.createIcon(_a)),this.changeIcon(this.pauseIcon)}},{key:"resetIcon",value:function(){Ue('link[rel="shortcut icon"]').remove(),Ue("head").append(this.oldIcon)}},{key:"changeIcon",value:function(r){r&&(Ue('link[rel="shortcut icon"]').remove(),Ue("head").append(r))}}]),a}(Or),tg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.container.options.gaAccount&&(r.account=r.container.options.gaAccount,r.trackerName=r.container.options.gaTrackerName?r.container.options.gaTrackerName+".":"Clappr.",r.domainName=r.container.options.gaDomainName,r.currentHDState=void 0,r.embedScript()),r}return jt(a,[{key:"name",get:function(){return"google_analytics"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"embedScript",value:function(){var r=this;if(window._gat)this.addEventListeners();else{var l=document.createElement("script");l.setAttribute("type","text/javascript"),l.setAttribute("async","async"),l.setAttribute("src","//www.google-analytics.com/ga.js"),l.onload=function(){return r.addEventListeners()},document.body.appendChild(l)}}},{key:"addEventListeners",value:function(){var r=this;this.container&&(this.listenTo(this.container,x.CONTAINER_READY,this.onReady),this.listenTo(this.container,x.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,x.CONTAINER_STOP,this.onStop),this.listenTo(this.container,x.CONTAINER_PAUSE,this.onPause),this.listenTo(this.container,x.CONTAINER_ENDED,this.onEnded),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,x.CONTAINER_ERROR,this.onError),this.listenTo(this.container,x.CONTAINER_PLAYBACKSTATE,this.onPlaybackChanged),this.listenTo(this.container,x.CONTAINER_VOLUME,function(l){return r.onVolumeChanged(l)}),this.listenTo(this.container,x.CONTAINER_SEEK,function(l){return r.onSeek(l)}),this.listenTo(this.container,x.CONTAINER_FULL_SCREEN,this.onFullscreen),this.listenTo(this.container,x.CONTAINER_HIGHDEFINITIONUPDATE,this.onHD),this.listenTo(this.container,x.CONTAINER_PLAYBACKDVRSTATECHANGED,this.onDVR)),_gaq.push([this.trackerName+"_setAccount",this.account]),this.domainName&&_gaq.push([this.trackerName+"_setDomainName",this.domainName])}},{key:"onReady",value:function(){this.push(["Video","Playback",this.container.playback.name])}},{key:"onPlay",value:function(){this.push(["Video","Play",this.container.playback.src])}},{key:"onStop",value:function(){this.push(["Video","Stop",this.container.playback.src])}},{key:"onEnded",value:function(){this.push(["Video","Ended",this.container.playback.src])}},{key:"onBuffering",value:function(){this.push(["Video","Buffering",this.container.playback.src])}},{key:"onBufferFull",value:function(){this.push(["Video","Bufferfull",this.container.playback.src])}},{key:"onError",value:function(){this.push(["Video","Error",this.container.playback.src])}},{key:"onHD",value:function(r){var l=r?"ON":"OFF";l!==this.currentHDState&&(this.currentHDState=l,this.push(["Video","HD - "+l,this.container.playback.src]))}},{key:"onPlaybackChanged",value:function(r){r.type!==null&&this.push(["Video","Playback Type - "+r.type,this.container.playback.src])}},{key:"onDVR",value:function(r){var l=r?"ON":"OFF";this.push(["Interaction","DVR - "+l,this.container.playback.src])}},{key:"onPause",value:function(){this.push(["Video","Pause",this.container.playback.src])}},{key:"onSeek",value:function(){this.push(["Video","Seek",this.container.playback.src])}},{key:"onVolumeChanged",value:function(){this.push(["Interaction","Volume",this.container.playback.src])}},{key:"onFullscreen",value:function(){this.push(["Interaction","Fullscreen",this.container.playback.src])}},{key:"push",value:function(r){var l=[this.trackerName+"_trackEvent"].concat(r);_gaq.push(l)}}]),a}(Qr),Se=function(i){this.element=i||window.document,this.initialize()};Se.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};Se.KEY_CODES_BY_NAME={};(function(){for(var t in Se.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(Se.KEY_NAMES_BY_CODE,t)&&(Se.KEY_CODES_BY_NAME[Se.KEY_NAMES_BY_CODE[t]]=+t)})();Se.MODIFIERS=["shift","ctrl","alt"];Se.registerEvent=function(){if(document.addEventListener)return function(t,i,a){t.addEventListener(i,a,!1)};if(document.attachEvent)return function(t,i,a){t.attachEvent("on"+i,a)}}();Se.unregisterEvent=function(){if(document.removeEventListener)return function(t,i,a){t.removeEventListener(i,a,!1)};if(document.detachEvent)return function(t,i,a){t.detachEvent("on"+i,a)}}();Se.stringContains=function(t,i){return t.indexOf(i)!==-1};Se.neatString=function(t){return t.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")};Se.capitalize=function(t){return t.toLowerCase().replace(/^./,function(i){return i.toUpperCase()})};Se.isString=function(t){return Se.stringContains(Object.prototype.toString.call(t),"String")};Se.arrayIncludes=function(){return Array.prototype.indexOf?function(t,i){return t.indexOf(i)!==-1}:function(t,i){for(var a=0;a<t.length;a++)if(t[a]===i)return!0;return!1}}();Se.extractModifiers=function(t){var i,a;for(i=[],a=0;a<Se.MODIFIERS.length;a++)Se.stringContains(t,Se.MODIFIERS[a])&&i.push(Se.MODIFIERS[a]);return i};Se.extractKey=function(t){var i,a;for(i=Se.neatString(t).split(" "),a=0;a<i.length;a++)if(!Se.arrayIncludes(Se.MODIFIERS,i[a]))return i[a]};Se.modifiersAndKey=function(t){var i,a;return Se.stringContains(t,"any")?Se.neatString(t).split(" ").slice(0,2).join(" "):(i=Se.extractModifiers(t),a=Se.extractKey(t),a&&!Se.arrayIncludes(Se.MODIFIERS,a)&&i.push(a),i.join(" "))};Se.keyName=function(t){return Se.KEY_NAMES_BY_CODE[t+""]};Se.keyCode=function(t){return+Se.KEY_CODES_BY_NAME[t]};Se.prototype.initialize=function(){var t,i=this;for(this.lastKeyCode=-1,this.lastModifiers={},t=0;t<Se.MODIFIERS.length;t++)this.lastModifiers[Se.MODIFIERS[t]]=!1;this.keysDown={any:[]},this.keysUp={any:[]},this.downHandler=this.handler("down"),this.upHandler=this.handler("up"),Se.registerEvent(this.element,"keydown",this.downHandler),Se.registerEvent(this.element,"keyup",this.upHandler),Se.registerEvent(window,"unload",function a(){Se.unregisterEvent(i.element,"keydown",i.downHandler),Se.unregisterEvent(i.element,"keyup",i.upHandler),Se.unregisterEvent(window,"unload",a)})};Se.prototype.handler=function(t){var i=this;return function(a){var n,r,l;for(a=a||window.event,i.lastKeyCode=a.keyCode,n=0;n<Se.MODIFIERS.length;n++)i.lastModifiers[Se.MODIFIERS[n]]=a[Se.MODIFIERS[n]+"Key"];for(Se.arrayIncludes(Se.MODIFIERS,Se.keyName(i.lastKeyCode))&&(i.lastModifiers[Se.keyName(i.lastKeyCode)]=!0),r=i["keys"+Se.capitalize(t)],n=0;n<r.any.length;n++)r.any[n](a)===!1&&a.preventDefault&&a.preventDefault();if(l=i.lastModifiersAndKey(),r[l])for(n=0;n<r[l].length;n++)r[l][n](a)===!1&&a.preventDefault&&a.preventDefault()}};Se.prototype.registerKeys=function(t,i,a){var n,r,l=this["keys"+Se.capitalize(t)];for(Se.isString(i)&&(i=[i]),n=0;n<i.length;n++)r=i[n],r=Se.modifiersAndKey(r+""),l[r]?l[r].push(a):l[r]=[a];return this};Se.prototype.unregisterKeys=function(t,i,a){var n,r,l,f=this["keys"+Se.capitalize(t)];for(Se.isString(i)&&(i=[i]),n=0;n<i.length;n++)if(l=i[n],l=Se.modifiersAndKey(l+""),a===null)delete f[l];else if(f[l]){for(r=0;r<f[l].length;r++)if(String(f[l][r])===String(a)){f[l].splice(r,1);break}}return this};Se.prototype.off=function(t){return this.unregisterKeys("down",t,null)};Se.prototype.delegate=function(t,i,a){return a!==null||a!==void 0?this.registerKeys(t,i,a):this.unregisterKeys(t,i,a)};Se.prototype.down=function(t,i){return this.delegate("down",t,i)};Se.prototype.up=function(t,i){return this.delegate("up",t,i)};Se.prototype.lastKey=function(t){return t?this.lastModifiers[t]:Se.keyName(this.lastKeyCode)};Se.prototype.lastModifiersAndKey=function(){var t,i;for(t=[],i=0;i<Se.MODIFIERS.length;i++)this.lastKey(Se.MODIFIERS[i])&&t.push(Se.MODIFIERS[i]);return Se.arrayIncludes(t,this.lastKey())||t.push(this.lastKey()),t.join(" ")};var rg=`.media-control-notransition {
  transition: none !important; }

.media-control[data-media-control] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 9999;
  pointer-events: none; }
  .media-control[data-media-control].dragging {
    pointer-events: auto;
    cursor: -webkit-grabbing !important;
    cursor: grabbing !important;
    cursor: url("closed-hand.cur"), move; }
    .media-control[data-media-control].dragging * {
      cursor: -webkit-grabbing !important;
      cursor: grabbing !important;
      cursor: url("closed-hand.cur"), move; }
  .media-control[data-media-control] .media-control-background[data-background] {
    position: absolute;
    height: 40%;
    width: 100%;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
    will-change: transform, opacity;
    transition: opacity 0.6s ease-out; }
  .media-control[data-media-control] .media-control-icon {
    line-height: 0;
    letter-spacing: 0;
    speak: none;
    color: #fff;
    opacity: 0.5;
    vertical-align: middle;
    text-align: left;
    transition: all 0.1s ease; }
  .media-control[data-media-control] .media-control-icon:hover {
    color: white;
    opacity: 0.75;
    text-shadow: rgba(255, 255, 255, 0.8) 0 0 5px; }
  .media-control[data-media-control].media-control-hide .media-control-background[data-background] {
    opacity: 0; }
  .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] {
    transform: translateY(50px); }
    .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
      opacity: 0; }
  .media-control[data-media-control] .media-control-layer[data-controls] {
    position: absolute;
    transform: translateY(-7px);
    bottom: 0;
    width: 100%;
    height: 32px;
    font-size: 0;
    vertical-align: middle;
    pointer-events: auto;
    transition: bottom 0.4s ease-out; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-left-panel[data-media-control] {
      position: absolute;
      top: 0;
      left: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-center-panel[data-media-control] {
      height: 100%;
      text-align: center;
      line-height: 32px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-right-panel[data-media-control] {
      position: absolute;
      top: 0;
      right: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button {
      background-color: transparent;
      border: 0;
      margin: 0 6px;
      padding: 0;
      cursor: pointer;
      display: inline-block;
      width: 32px;
      height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg {
        width: 100%;
        height: 22px; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg path {
          fill: white; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button:focus {
        outline: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-play] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-pause] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-stop] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-fullscreen] {
        float: right;
        background-color: transparent;
        border: 0;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator] {
        background-color: transparent;
        border: 0;
        cursor: default;
        display: none;
        float: right;
        height: 100%; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled {
          display: block;
          opacity: 1.0; }
          .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled:hover {
            opacity: 1.0;
            text-shadow: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playpause] {
        float: left; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playstop] {
        float: left; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position], .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      display: inline-block;
      font-size: 10px;
      color: white;
      cursor: default;
      line-height: 32px;
      position: relative; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position] {
      margin: 0 6px 0 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      color: rgba(255, 255, 255, 0.5);
      margin-right: 6px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration]:before {
        content: "|";
        margin-right: 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] {
      position: absolute;
      top: -20px;
      left: 0;
      display: inline-block;
      vertical-align: middle;
      width: 100%;
      height: 25px;
      cursor: pointer; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] {
        width: 100%;
        height: 1px;
        position: relative;
        top: 12px;
        background-color: #666666; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-1[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #c2c2c2;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #005aff;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0;
          position: absolute;
          top: -3px;
          width: 5px;
          height: 7px;
          background-color: rgba(255, 255, 255, 0.5);
          transition: opacity 0.1s ease; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar]:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
        opacity: 1; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled {
        cursor: default; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
        position: absolute;
        transform: translateX(-50%);
        top: 2px;
        left: 0;
        width: 20px;
        height: 20px;
        opacity: 1;
        transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] .bar-scrubber-icon[data-seekbar] {
          position: absolute;
          left: 6px;
          top: 6px;
          width: 8px;
          height: 8px;
          border-radius: 10px;
          box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
          background-color: white; }
    .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] {
      float: right;
      display: inline-block;
      height: 32px;
      cursor: pointer;
      margin: 0 6px;
      box-sizing: border-box; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] {
        float: left;
        bottom: 0; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] {
          background-color: transparent;
          border: 0;
          box-sizing: content-box;
          width: 32px;
          height: 32px;
          opacity: 0.5; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume]:hover {
            opacity: 0.75; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg {
            height: 24px;
            position: relative;
            top: 3px; }
            .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg path {
              fill: white; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume].muted svg {
            margin-left: 2px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] {
        float: left;
        position: relative;
        overflow: hidden;
        top: 6px;
        width: 42px;
        height: 18px;
        padding: 3px 0;
        transition: width .2s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] {
          height: 1px;
          position: relative;
          top: 7px;
          margin: 0 3px;
          background-color: #666666; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-1[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #c2c2c2;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-2[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #005aff;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-hover[data-volume] {
            opacity: 0;
            position: absolute;
            top: -3px;
            width: 5px;
            height: 7px;
            background-color: rgba(255, 255, 255, 0.5);
            transition: opacity 0.1s ease; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] {
          position: absolute;
          transform: translateX(-50%);
          top: 0px;
          left: 0;
          width: 20px;
          height: 20px;
          opacity: 1;
          transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] .bar-scrubber-icon[data-volume] {
            position: absolute;
            left: 6px;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 10px;
            box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
            background-color: white; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume] {
          float: left;
          width: 4px;
          padding-left: 2px;
          height: 12px;
          opacity: 0.5;
          box-shadow: inset 2px 0 0 white;
          transition: transform .2s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume].fill {
            box-shadow: inset 2px 0 0 #fff;
            opacity: 1; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:nth-of-type(1) {
            padding-left: 0; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:hover {
            transform: scaleY(1.5); }
  .media-control[data-media-control].w320 .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume].volume-bar-hide {
    width: 0;
    height: 12px;
    top: 9px;
    padding: 0; }
`,ng=`<div class="media-control-background" data-background></div>
<div class="media-control-layer" data-controls>
  <%  var renderBar = function(name) { %>
      <div class="bar-container" data-<%= name %>>
        <div class="bar-background" data-<%= name %>>
          <div class="bar-fill-1" data-<%= name %>></div>
          <div class="bar-fill-2" data-<%= name %>></div>
          <div class="bar-hover" data-<%= name %>></div>
        </div>
        <div class="bar-scrubber" data-<%= name %>>
          <div class="bar-scrubber-icon" data-<%= name %>></div>
        </div>
      </div>
  <%  }; %>
  <%  var renderSegmentedBar = function(name, segments) {
      segments = segments || 10; %>
    <div class="bar-container" data-<%= name %>>
    <% for (var i = 0; i < segments; i++) { %>
      <div class="segmented-bar-element" data-<%= name %>></div>
    <% } %>
    </div>
  <% }; %>
  <% var renderDrawer = function(name, renderContent) { %>
      <div class="drawer-container" data-<%= name %>>
        <div class="drawer-icon-container" data-<%= name %>>
          <div class="drawer-icon media-control-icon" data-<%= name %>></div>
          <span class="drawer-text" data-<%= name %>></span>
        </div>
        <% renderContent(name); %>
      </div>
  <% }; %>
  <% var renderIndicator = function(name) { %>
      <div class="media-control-indicator" data-<%= name %>></div>
  <% }; %>
  <% var renderButton = function(name) { %>
    <button type="button" class="media-control-button media-control-icon" data-<%= name %> aria-label="<%= name %>"></button>
  <% }; %>
  <%  var templates = {
        bar: renderBar,
        segmentedBar: renderSegmentedBar,
      };
      var render = function(settingsList) {
        settingsList.forEach(function(setting) {
          if(setting === "seekbar") {
            renderBar(setting);
          } else if (setting === "volume") {
            renderDrawer(setting, settings.volumeBarTemplate ? templates[settings.volumeBarTemplate] : function(name) { return renderSegmentedBar(name); });
          } else if (setting === "duration" || setting === "position") {
            renderIndicator(setting);
          } else {
            renderButton(setting);
          }
        });
      }; %>
  <% if (settings.default && settings.default.length) { %>
  <div class="media-control-center-panel" data-media-control>
    <% render(settings.default); %>
  </div>
  <% } %>
  <% if (settings.left && settings.left.length) { %>
  <div class="media-control-left-panel" data-media-control>
    <% render(settings.left); %>
  </div>
  <% } %>
  <% if (settings.right && settings.right.length) { %>
  <div class="media-control-right-panel" data-media-control>
    <% render(settings.right); %>
  </div>
  <% } %>
</div>
`,ho=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 1.24h12.6v13.52h-12.6z"/>
</svg>`,go=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M11.5 11h-.002v1.502L7.798 10H4.5V6h3.297l3.7-2.502V4.5h.003V11zM11 4.49L7.953 6.5H5v3h2.953L11 11.51V4.49z"/>
</svg>`,ig=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M9.75 11.51L6.7 9.5H3.75v-3H6.7L9.75 4.49v.664l.497.498V3.498L6.547 6H3.248v4h3.296l3.7 2.502v-2.154l-.497.5v.662zm3-5.165L12.404 6l-1.655 1.653L9.093 6l-.346.345L10.402 8 8.747 9.654l.346.347 1.655-1.653L12.403 10l.348-.346L11.097 8l1.655-1.655z"/>
</svg>`,po=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M7.156 8L4 11.156V8.5H3V13h4.5v-1H4.844L8 8.844 7.156 8zM8.5 3v1h2.657L8 7.157 8.846 8 12 4.844V7.5h1V3H8.5z"/>
</svg>`,ag=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M13.5 3.344l-.844-.844L9.5 5.656V3h-1v4.5H13v-1h-2.656L13.5 3.344zM3 9.5h2.656L2.5 12.656l.844.844L6.5 10.344V13h1V8.5H3v1z"/>
</svg>`,sg=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M5.375 7.062H2.637V4.26H.502v7.488h2.135V8.9h2.738v2.848h2.133V4.26H5.375v2.802zm5.97-2.81h-2.84v7.496h2.798c2.65 0 4.195-1.607 4.195-3.77v-.022c0-2.162-1.523-3.704-4.154-3.704zm2.06 3.758c0 1.21-.81 1.896-2.03 1.896h-.83V6.093h.83c1.22 0 2.03.696 2.03 1.896v.02z"/>
</svg>`,vo=xr.Config,mo=xr.Fullscreen,yo=xr.formatTime,og=xr.extend,ta=xr.removeArrayItem,ba=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.persistConfig=r.options.persistConfig,r.currentPositionValue=null,r.currentDurationValue=null,r.keepVisible=!1,r.fullScreenOnVideoTagSupported=null,r.setInitialVolume(),r.settings={left:["play","stop","pause"],right:["volume"],default:["position","seekbar","duration"]},r.kibo=new Se(r.options.focusElement),r.bindKeyEvents(),r.container?Ue.isEmptyObject(r.container.settings)||(r.settings=Ue.extend({},r.container.settings)):r.settings={},r.userDisabled=!1,(r.container&&r.container.mediaControlDisabled||r.options.chromeless)&&r.disable(),r.stopDragHandler=function(l){return r.stopDrag(l)},r.updateDragHandler=function(l){return r.updateDrag(l)},Ue(document).bind("mouseup",r.stopDragHandler),Ue(document).bind("mousemove",r.updateDragHandler),r}return jt(a,[{key:"name",get:function(){return"media_control"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"disabled",get:function(){var r=this.container&&this.container.getPlaybackType()===je.NO_OP;return this.userDisabled||r}},{key:"container",get:function(){return this.core&&this.core.activeContainer}},{key:"playback",get:function(){return this.core&&this.core.activePlayback}},{key:"attributes",get:function(){return{class:"media-control","data-media-control":""}}},{key:"events",get:function(){return{"click [data-play]":"play","click [data-pause]":"pause","click [data-playpause]":"togglePlayPause","click [data-stop]":"stop","click [data-playstop]":"togglePlayStop","click [data-fullscreen]":"toggleFullscreen","click .bar-container[data-seekbar]":"seek","click .bar-container[data-volume]":"onVolumeClick","click .drawer-icon[data-volume]":"toggleMute","mouseenter .drawer-container[data-volume]":"showVolumeBar","mouseleave .drawer-container[data-volume]":"hideVolumeBar","mousedown .bar-container[data-volume]":"startVolumeDrag","mousemove .bar-container[data-volume]":"mousemoveOnVolumeBar","mousedown .bar-scrubber[data-seekbar]":"startSeekDrag","mousemove .bar-container[data-seekbar]":"mousemoveOnSeekBar","mouseleave .bar-container[data-seekbar]":"mouseleaveOnSeekBar","mouseenter .media-control-layer[data-controls]":"setUserKeepVisible","mouseleave .media-control-layer[data-controls]":"resetUserKeepVisible"}}},{key:"template",get:function(){return Xt(ng)}},{key:"volume",get:function(){return this.container&&this.container.isReady?this.container.volume:this.intendedVolume}},{key:"muted",get:function(){return this.volume===0}},{key:"getExternalInterface",value:function(){var r=this;return{setVolume:this.setVolume,getVolume:function(){return r.volume}}}},{key:"bindEvents",value:function(){var r=this;this.stopListening(),this.listenTo(this.core,x.CORE_ACTIVE_CONTAINER_CHANGED,this.onActiveContainerChanged),this.listenTo(this.core,x.CORE_MOUSE_MOVE,this.show),this.listenTo(this.core,x.CORE_MOUSE_LEAVE,function(){return r.hide(r.options.hideMediaControlDelay)}),this.listenTo(this.core,x.CORE_FULLSCREEN,this.show),this.listenTo(this.core,x.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,x.CORE_RESIZE,this.playerResize),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){!this.container||(this.listenTo(this.container,x.CONTAINER_PLAY,this.changeTogglePlay),this.listenTo(this.container,x.CONTAINER_PAUSE,this.changeTogglePlay),this.listenTo(this.container,x.CONTAINER_STOP,this.changeTogglePlay),this.listenTo(this.container,x.CONTAINER_DBLCLICK,this.toggleFullscreen),this.listenTo(this.container,x.CONTAINER_TIMEUPDATE,this.onTimeUpdate),this.listenTo(this.container,x.CONTAINER_PROGRESS,this.updateProgressBar),this.listenTo(this.container,x.CONTAINER_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.container,x.CONTAINER_PLAYBACKDVRSTATECHANGED,this.settingsUpdate),this.listenTo(this.container,x.CONTAINER_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.container,x.CONTAINER_MEDIACONTROL_DISABLE,this.disable),this.listenTo(this.container,x.CONTAINER_MEDIACONTROL_ENABLE,this.enable),this.listenTo(this.container,x.CONTAINER_ENDED,this.ended),this.listenTo(this.container,x.CONTAINER_VOLUME,this.onVolumeChanged),this.listenTo(this.container,x.CONTAINER_OPTIONS_CHANGE,this.setInitialVolume),this.container.playback.el.nodeName.toLowerCase()==="video"&&this.listenToOnce(this.container,x.CONTAINER_LOADEDMETADATA,this.onLoadedMetadataOnVideoTag))}},{key:"disable",value:function(){this.userDisabled=!0,this.hide(),this.unbindKeyEvents(),this.$el.hide()}},{key:"enable",value:function(){this.options.chromeless||(this.userDisabled=!1,this.bindKeyEvents(),this.show())}},{key:"play",value:function(){this.container&&this.container.play()}},{key:"pause",value:function(){this.container&&this.container.pause()}},{key:"stop",value:function(){this.container&&this.container.stop()}},{key:"setInitialVolume",value:function(){var r=this.persistConfig?vo.restore("volume"):100,l=this.container&&this.container.options||this.options;this.setVolume(l.mute?0:r,!0)}},{key:"onVolumeChanged",value:function(){this.updateVolumeUI()}},{key:"onLoadedMetadataOnVideoTag",value:function(){var r=this.playback&&this.playback.el;!mo.fullscreenEnabled()&&r.webkitSupportsFullscreen&&(this.fullScreenOnVideoTagSupported=!0,this.settingsUpdate())}},{key:"updateVolumeUI",value:function(){if(!!this.rendered){this.$volumeBarContainer.find(".bar-fill-2").css({});var r=this.$volumeBarContainer.width(),l=this.$volumeBarBackground.width(),f=(r-l)/2,g=l*this.volume/100+f;this.$volumeBarFill.css({width:"".concat(this.volume,"%")}),this.$volumeBarScrubber.css({left:g}),this.$volumeBarContainer.find(".segmented-bar-element").removeClass("fill");var T=Math.ceil(this.volume/10);this.$volumeBarContainer.find(".segmented-bar-element").slice(0,T).addClass("fill"),this.$volumeIcon.html(""),this.$volumeIcon.removeClass("muted"),this.muted?(this.$volumeIcon.append(ig),this.$volumeIcon.addClass("muted")):this.$volumeIcon.append(go),this.applyButtonStyle(this.$volumeIcon)}}},{key:"changeTogglePlay",value:function(){this.$playPauseToggle.html(""),this.$playStopToggle.html(""),this.container&&this.container.isPlaying()?(this.$playPauseToggle.append(_a),this.$playStopToggle.append(ho),this.trigger(x.MEDIACONTROL_PLAYING)):(this.$playPauseToggle.append($r),this.$playStopToggle.append($r),this.trigger(x.MEDIACONTROL_NOTPLAYING),Be.isMobile&&this.show()),this.applyButtonStyle(this.$playPauseToggle),this.applyButtonStyle(this.$playStopToggle)}},{key:"mousemoveOnSeekBar",value:function(r){if(this.settings.seekEnabled){var l=r.pageX-this.$seekBarContainer.offset().left-this.$seekBarHover.width()/2;this.$seekBarHover.css({left:l})}this.trigger(x.MEDIACONTROL_MOUSEMOVE_SEEKBAR,r)}},{key:"mouseleaveOnSeekBar",value:function(r){this.trigger(x.MEDIACONTROL_MOUSELEAVE_SEEKBAR,r)}},{key:"onVolumeClick",value:function(r){this.setVolume(this.getVolumeFromUIEvent(r))}},{key:"mousemoveOnVolumeBar",value:function(r){this.draggingVolumeBar&&this.setVolume(this.getVolumeFromUIEvent(r))}},{key:"playerResize",value:function(r){this.$fullscreenToggle.html("");var l=this.core.isFullscreen()?ag:po;this.$fullscreenToggle.append(l),this.applyButtonStyle(this.$fullscreenToggle),this.$el.find(".media-control").length!==0&&this.$el.removeClass("w320"),(r.width<=320||this.options.hideVolumeBar)&&this.$el.addClass("w320")}},{key:"togglePlayPause",value:function(){return this.container.isPlaying()?this.container.pause():this.container.play(),!1}},{key:"togglePlayStop",value:function(){this.container.isPlaying()?this.container.stop():this.container.play()}},{key:"startSeekDrag",value:function(r){!this.settings.seekEnabled||(this.draggingSeekBar=!0,this.$el.addClass("dragging"),this.$seekBarLoaded.addClass("media-control-notransition"),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition"),r&&r.preventDefault())}},{key:"startVolumeDrag",value:function(r){this.draggingVolumeBar=!0,this.$el.addClass("dragging"),r&&r.preventDefault()}},{key:"stopDrag",value:function(r){this.draggingSeekBar&&this.seek(r),this.$el.removeClass("dragging"),this.$seekBarLoaded.removeClass("media-control-notransition"),this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition dragging"),this.draggingSeekBar=!1,this.draggingVolumeBar=!1}},{key:"updateDrag",value:function(r){if(this.draggingSeekBar){r.preventDefault();var l=r.pageX-this.$seekBarContainer.offset().left,f=l/this.$seekBarContainer.width()*100;f=Math.min(100,Math.max(f,0)),this.setSeekPercentage(f)}else this.draggingVolumeBar&&(r.preventDefault(),this.setVolume(this.getVolumeFromUIEvent(r)))}},{key:"getVolumeFromUIEvent",value:function(r){var l=r.pageX-this.$volumeBarContainer.offset().left,f=l/this.$volumeBarContainer.width()*100;return f}},{key:"toggleMute",value:function(){this.setVolume(this.muted?100:0)}},{key:"setVolume",value:function(r){var l=this,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r=Math.min(100,Math.max(r,0)),this.intendedVolume=r,this.persistConfig&&!f&&vo.persist("volume",r);var g=function(){l.container&&l.container.isReady?l.container.setVolume(r):l.listenToOnce(l.container,x.CONTAINER_READY,function(){l.container.setVolume(r)})};this.container?g():this.listenToOnce(this,x.MEDIACONTROL_CONTAINERCHANGED,function(){return g()})}},{key:"toggleFullscreen",value:function(){this.trigger(x.MEDIACONTROL_FULLSCREEN,this.name),this.container.fullscreen(),this.core.toggleFullscreen(),this.resetUserKeepVisible()}},{key:"onActiveContainerChanged",value:function(){this.fullScreenOnVideoTagSupported=null,this.bindEvents(),this.setInitialVolume(),this.changeTogglePlay(),this.bindContainerEvents(),this.settingsUpdate(),this.container&&this.container.trigger(x.CONTAINER_PLAYBACKDVRSTATECHANGED,this.container.isDvrInUse()),this.container&&this.container.mediaControlDisabled&&this.disable(),this.trigger(x.MEDIACONTROL_CONTAINERCHANGED)}},{key:"showVolumeBar",value:function(){this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.$volumeBarContainer.removeClass("volume-bar-hide")}},{key:"hideVolumeBar",value:function(){var r=this,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:400;!this.$volumeBarContainer||(this.draggingVolumeBar?this.hideVolumeId=setTimeout(function(){return r.hideVolumeBar()},l):(this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.hideVolumeId=setTimeout(function(){return r.$volumeBarContainer.addClass("volume-bar-hide")},l)))}},{key:"ended",value:function(){this.changeTogglePlay()}},{key:"updateProgressBar",value:function(r){var l=r.start/r.total*100,f=r.current/r.total*100;this.$seekBarLoaded.css({left:"".concat(l,"%"),width:"".concat(f-l,"%")})}},{key:"onTimeUpdate",value:function(r){if(!this.draggingSeekBar){var l=r.current<0?r.total:r.current;this.currentPositionValue=l,this.currentDurationValue=r.total,this.renderSeekBar()}}},{key:"renderSeekBar",value:function(){if(!(this.currentPositionValue===null||this.currentDurationValue===null)){this.currentSeekBarPercentage=100,this.container&&(this.container.getPlaybackType()!==je.LIVE||this.container.isDvrInUse())&&(this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100),this.setSeekPercentage(this.currentSeekBarPercentage);var r=yo(this.currentPositionValue),l=yo(this.currentDurationValue);r!==this.displayedPosition&&(this.$position.text(r),this.displayedPosition=r),l!==this.displayedDuration&&(this.$duration.text(l),this.displayedDuration=l)}}},{key:"seek",value:function(r){if(!!this.settings.seekEnabled){var l=r.pageX-this.$seekBarContainer.offset().left,f=l/this.$seekBarContainer.width()*100;return f=Math.min(100,Math.max(f,0)),this.container&&this.container.seekPercentage(f),this.setSeekPercentage(f),!1}}},{key:"setKeepVisible",value:function(){this.keepVisible=!0}},{key:"resetKeepVisible",value:function(){this.keepVisible=!1}},{key:"setUserKeepVisible",value:function(){this.userKeepVisible=!0}},{key:"resetUserKeepVisible",value:function(){this.userKeepVisible=!1}},{key:"isVisible",value:function(){return!this.$el.hasClass("media-control-hide")}},{key:"show",value:function(r){var l=this;if(!this.disabled){var f=2e3,g=r&&r.clientX!==this.lastMouseX&&r.clientY!==this.lastMouseY;(!r||g||navigator.userAgent.match(/firefox/i))&&(clearTimeout(this.hideId),this.$el.show(),this.trigger(x.MEDIACONTROL_SHOW,this.name),this.container&&this.container.trigger(x.CONTAINER_MEDIACONTROL_SHOW,this.name),this.$el.removeClass("media-control-hide"),this.hideId=setTimeout(function(){return l.hide()},f),r&&(this.lastMouseX=r.clientX,this.lastMouseY=r.clientY));var T=!0;this.updateCursorStyle(T)}}},{key:"hide",value:function(){var r=this,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(!!this.isVisible()){var f=l||2e3;if(clearTimeout(this.hideId),!(!this.disabled&&this.options.hideMediaControl===!1)){var g=this.userKeepVisible||this.keepVisible,T=this.draggingSeekBar||this.draggingVolumeBar;if(!this.disabled&&(l||g||T))this.hideId=setTimeout(function(){return r.hide()},f);else{this.trigger(x.MEDIACONTROL_HIDE,this.name),this.container&&this.container.trigger(x.CONTAINER_MEDIACONTROL_HIDE,this.name),this.$el.addClass("media-control-hide"),this.hideVolumeBar(0);var m=!1;this.updateCursorStyle(m)}}}}},{key:"updateCursorStyle",value:function(r){r?this.core.$el.removeClass("nocursor"):this.core.isFullscreen()&&this.core.$el.addClass("nocursor")}},{key:"settingsUpdate",value:function(){var r=this.getSettings();r&&!this.fullScreenOnVideoTagSupported&&!mo.fullscreenEnabled()&&(r.default&&ta(r.default,"fullscreen"),r.left&&ta(r.left,"fullscreen"),r.right&&ta(r.right,"fullscreen"));var l=JSON.stringify(this.settings)!==JSON.stringify(r);l&&(this.settings=r,this.render())}},{key:"getSettings",value:function(){return Ue.extend(!0,{},this.container&&this.container.settings)}},{key:"highDefinitionUpdate",value:function(r){this.isHD=r;var l=r?"addClass":"removeClass";this.$hdIndicator[l]("enabled")}},{key:"createCachedElements",value:function(){var r=this.$el.find(".media-control-layer");this.$duration=r.find(".media-control-indicator[data-duration]"),this.$fullscreenToggle=r.find("button.media-control-button[data-fullscreen]"),this.$playPauseToggle=r.find("button.media-control-button[data-playpause]"),this.$playStopToggle=r.find("button.media-control-button[data-playstop]"),this.$position=r.find(".media-control-indicator[data-position]"),this.$seekBarContainer=r.find(".bar-container[data-seekbar]"),this.$seekBarHover=r.find(".bar-hover[data-seekbar]"),this.$seekBarLoaded=r.find(".bar-fill-1[data-seekbar]"),this.$seekBarPosition=r.find(".bar-fill-2[data-seekbar]"),this.$seekBarScrubber=r.find(".bar-scrubber[data-seekbar]"),this.$volumeBarContainer=r.find(".bar-container[data-volume]"),this.$volumeContainer=r.find(".drawer-container[data-volume]"),this.$volumeIcon=r.find(".drawer-icon[data-volume]"),this.$volumeBarBackground=this.$el.find(".bar-background[data-volume]"),this.$volumeBarFill=this.$el.find(".bar-fill-1[data-volume]"),this.$volumeBarScrubber=this.$el.find(".bar-scrubber[data-volume]"),this.$hdIndicator=this.$el.find("button.media-control-button[data-hd-indicator]"),this.resetIndicators(),this.initializeIcons()}},{key:"resetIndicators",value:function(){this.displayedPosition=this.$position.text(),this.displayedDuration=this.$duration.text()}},{key:"initializeIcons",value:function(){var r=this.$el.find(".media-control-layer");r.find("button.media-control-button[data-play]").append($r),r.find("button.media-control-button[data-pause]").append(_a),r.find("button.media-control-button[data-stop]").append(ho),this.$playPauseToggle.append($r),this.$playStopToggle.append($r),this.$volumeIcon.append(go),this.$fullscreenToggle.append(po),this.$hdIndicator.append(sg)}},{key:"setSeekPercentage",value:function(r){r=Math.max(Math.min(r,100),0),this.displayedSeekBarPercentage!==r&&(this.displayedSeekBarPercentage=r,this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition"),this.$seekBarPosition.css({width:"".concat(r,"%")}),this.$seekBarScrubber.css({left:"".concat(r,"%")}))}},{key:"seekRelative",value:function(r){if(!!this.settings.seekEnabled){var l=this.container.getCurrentTime(),f=this.container.getDuration(),g=Math.min(Math.max(l+r,0),f);g=Math.min(g*100/f,100),this.container.seekPercentage(g)}}},{key:"bindKeyAndShow",value:function(r,l){var f=this;this.kibo.down(r,function(){return f.show(),l()})}},{key:"bindKeyEvents",value:function(){var r=this;if(!(Be.isMobile||this.options.disableKeyboardShortcuts)){this.unbindKeyEvents(),this.kibo=new Se(this.options.focusElement||this.options.parentElement),this.bindKeyAndShow("space",function(){return r.togglePlayPause()}),this.bindKeyAndShow("left",function(){return r.seekRelative(-5)}),this.bindKeyAndShow("right",function(){return r.seekRelative(5)}),this.bindKeyAndShow("shift left",function(){return r.seekRelative(-10)}),this.bindKeyAndShow("shift right",function(){return r.seekRelative(10)}),this.bindKeyAndShow("shift ctrl left",function(){return r.seekRelative(-15)}),this.bindKeyAndShow("shift ctrl right",function(){return r.seekRelative(15)});var l=["1","2","3","4","5","6","7","8","9","0"];l.forEach(function(f){r.bindKeyAndShow(f,function(){r.settings.seekEnabled&&r.container&&r.container.seekPercentage(f*10)})})}}},{key:"unbindKeyEvents",value:function(){this.kibo&&(this.kibo.off("space"),this.kibo.off("left"),this.kibo.off("right"),this.kibo.off("shift left"),this.kibo.off("shift right"),this.kibo.off("shift ctrl left"),this.kibo.off("shift ctrl right"),this.kibo.off(["1","2","3","4","5","6","7","8","9","0"]))}},{key:"parseColors",value:function(){if(this.options.mediacontrol){this.buttonsColor=this.options.mediacontrol.buttons;var r=this.options.mediacontrol.seekbar;this.$el.find(".bar-fill-2[data-seekbar]").css("background-color",r),this.$el.find(".media-control-icon svg path").css("fill",this.buttonsColor),this.$el.find(".segmented-bar-element[data-volume]").css("boxShadow","inset 2px 0 0 "+this.buttonsColor)}}},{key:"applyButtonStyle",value:function(r){this.buttonsColor&&r&&Ue(r).find("svg path").css("fill",this.buttonsColor)}},{key:"destroy",value:function(){Ue(document).unbind("mouseup",this.stopDragHandler),Ue(document).unbind("mousemove",this.updateDragHandler),this.unbindKeyEvents(),this.stopListening(),gn(Dr(a.prototype),"destroy",this).call(this)}},{key:"configure",value:function(r){this.options.chromeless||r.source||r.sources?this.disable():this.enable(),this.trigger(x.MEDIACONTROL_OPTIONS_CHANGE)}},{key:"render",value:function(){var r=this,l=this.options.hideMediaControlDelay||2e3;this.settings&&this.$el.html(this.template({settings:this.settings}));var f=Kt.getStyleFor(rg,{baseUrl:this.options.baseUrl});this.$el.append(f[0]),this.createCachedElements(),this.$playPauseToggle.addClass("paused"),this.$playStopToggle.addClass("stopped"),this.changeTogglePlay(),this.container&&(this.hideId=setTimeout(function(){return r.hide()},l),this.disabled&&this.hide()),Be.isSafari&&Be.isMobile&&(Be.version<10?this.$volumeContainer.css("display","none"):this.$volumeBarContainer.css("display","none")),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition");var g=0;return this.displayedSeekBarPercentage&&(g=this.displayedSeekBarPercentage),this.displayedSeekBarPercentage=null,this.setSeekPercentage(g),setTimeout(function(){!r.settings.seekEnabled&&r.$seekBarContainer.addClass("seek-disabled"),!Be.isMobile&&!r.options.disableKeyboardShortcuts&&r.bindKeyEvents(),r.playerResize({width:r.options.width,height:r.options.height}),r.hideVolumeBar(0)},0),this.parseColors(),this.highDefinitionUpdate(this.isHD),this.core.$el.append(this.el),this.rendered=!0,this.updateVolumeUI(),this.trigger(x.MEDIACONTROL_RENDERED),this}}]),a}(vr);ba.extend=function(t){return og(ba,t)};var lg=`<div class="play-wrapper" data-poster></div>
`,ug=`.player-poster[data-poster] {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  height: 100%;
  width: 100%;
  z-index: 998;
  top: 0;
  left: 0;
  background-color: transparent;
  background-size: cover;
  background-repeat: no-repeat;
  background-position: 50% 50%; }
  .player-poster[data-poster].clickable {
    cursor: pointer; }
  .player-poster[data-poster]:hover .play-wrapper[data-poster] {
    opacity: 1; }
  .player-poster[data-poster] .play-wrapper[data-poster] {
    width: 100%;
    height: 25%;
    margin: 0 auto;
    opacity: 0.75;
    transition: opacity 0.1s ease; }
    .player-poster[data-poster] .play-wrapper[data-poster] svg {
      height: 100%; }
      .player-poster[data-poster] .play-wrapper[data-poster] svg path {
        fill: #fff; }
`,cg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.hasStartedPlaying=!1,r.playRequested=!1,r.render(),setTimeout(function(){return r.update()},0),r}return jt(a,[{key:"name",get:function(){return"poster"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"template",get:function(){return Xt(lg)}},{key:"shouldRender",get:function(){var r=!!(this.options.poster&&this.options.poster.showForNoOp);return this.container.playback.name!=="html_img"&&(this.container.playback.getPlaybackType()!==je.NO_OP||r)}},{key:"attributes",get:function(){return{class:"player-poster","data-poster":""}}},{key:"events",get:function(){return{click:"clicked"}}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||this.options.poster.showOnVideoEnd===void 0}},{key:"bindEvents",value:function(){this.listenTo(this.container,x.CONTAINER_STOP,this.onStop),this.listenTo(this.container,x.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERING,this.update),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERFULL,this.update),this.listenTo(this.container,x.CONTAINER_OPTIONS_CHANGE,this.render),this.listenTo(this.container,x.CONTAINER_ERROR,this.onError),this.showOnVideoEnd&&this.listenTo(this.container,x.CONTAINER_ENDED,this.onStop)}},{key:"onError",value:function(r){this.hasFatalError=r.level===nr.Levels.FATAL,this.hasFatalError&&(this.hasStartedPlaying=!1,this.playRequested=!1,this.showPlayButton())}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"updatePlayButton",value:function(r){r&&(!this.options.chromeless||this.options.allowUserInteraction)?this.showPlayButton():this.hidePlayButton()}},{key:"showPlayButton",value:function(){this.hasFatalError&&!this.options.disableErrorScreen||(this.$playButton.show(),this.$el.addClass("clickable"))}},{key:"hidePlayButton",value:function(){this.$playButton.hide(),this.$el.removeClass("clickable")}},{key:"clicked",value:function(){if(!this.hasStartedPlaying)return(!this.options.chromeless||this.options.allowUserInteraction)&&(this.playRequested=!0,this.update(),this.container.playback&&(this.container.playback._consented=!0),this.container.play()),!1}},{key:"shouldHideOnPlay",value:function(){return!this.container.playback.isAudioOnly}},{key:"update",value:function(){if(!!this.shouldRender){var r=!this.playRequested&&!this.hasStartedPlaying&&!this.container.buffering;this.updatePlayButton(r),this.updatePoster()}}},{key:"updatePoster",value:function(){this.hasStartedPlaying?this.hidePoster():this.showPoster()}},{key:"showPoster",value:function(){this.container.disableMediaControl(),this.$el.show()}},{key:"hidePoster",value:function(){this.container.enableMediaControl(),this.shouldHideOnPlay()&&this.$el.hide()}},{key:"render",value:function(){if(!!this.shouldRender){var r=Kt.getStyleFor(ug,{baseUrl:this.options.baseUrl});this.$el.html(this.template()),this.$el.append(r[0]);var l=this.options.poster&&this.options.poster.custom===void 0;if(l){var f=this.options.poster.url||this.options.poster;this.$el.css({"background-image":"url("+f+")"}),this.removeVideoElementPoster()}else this.options.poster&&(this.$el.css({background:this.options.poster.custom}),this.removeVideoElementPoster());this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append($r),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var g=this.options.mediacontrol&&this.options.mediacontrol.buttons;return g&&this.$el.find("svg path").css("fill",g),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(g=this.options.mediacontrol.buttons,this.$playButton.css("color",g)),this.update(),this}}},{key:"removeVideoElementPoster",value:function(){this.container.playback&&this.container.playback.$el&&this.container.playback.$el[0]&&this.container.playback.$el[0].removeAttribute&&this.container.playback.$el[0].removeAttribute("poster")}}]),a}(Jr),fg=`<span data-seek-time></span>
<span data-duration></span>
`,dg=`.seek-time[data-seek-time] {
  position: absolute;
  white-space: nowrap;
  height: 20px;
  line-height: 20px;
  font-size: 0;
  left: -100%;
  bottom: 55px;
  background-color: rgba(2, 2, 2, 0.5);
  z-index: 9999;
  transition: opacity 0.1s ease; }
  .seek-time[data-seek-time].hidden[data-seek-time] {
    opacity: 0; }
  .seek-time[data-seek-time] [data-seek-time] {
    display: inline-block;
    color: white;
    font-size: 10px;
    padding-left: 7px;
    padding-right: 7px;
    vertical-align: top; }
  .seek-time[data-seek-time] [data-duration] {
    display: inline-block;
    color: rgba(255, 255, 255, 0.5);
    font-size: 10px;
    padding-right: 7px;
    vertical-align: top; }
    .seek-time[data-seek-time] [data-duration]:before {
      content: "|";
      margin-right: 7px; }
`,Ao=xr.formatTime,hg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.hoveringOverSeekBar=!1,r.hoverPosition=null,r.duration=null,r.firstFragDateTime=null,r.actualLiveTime=!!r.mediaControl.options.actualLiveTime,r.actualLiveTime&&(r.mediaControl.options.actualLiveServerTime?r.actualLiveServerTimeDiff=new Date().getTime()-new Date(r.mediaControl.options.actualLiveServerTime).getTime():r.actualLiveServerTimeDiff=0),r}return jt(a,[{key:"name",get:function(){return"seek_time"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"template",get:function(){return Xt(fg)}},{key:"attributes",get:function(){return{class:"seek-time","data-seek-time":""}}},{key:"mediaControl",get:function(){return this.core.mediaControl}},{key:"mediaControlContainer",get:function(){return this.mediaControl.container}},{key:"isLiveStreamWithDvr",get:function(){return this.mediaControlContainer&&this.mediaControlContainer.getPlaybackType()===je.LIVE&&this.mediaControlContainer.isDvrEnabled()}},{key:"durationShown",get:function(){return this.isLiveStreamWithDvr&&!this.actualLiveTime}},{key:"useActualLiveTime",get:function(){return this.actualLiveTime&&this.isLiveStreamWithDvr}},{key:"bindEvents",value:function(){this.listenTo(this.mediaControl,x.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.mediaControl,x.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.showTime),this.listenTo(this.mediaControl,x.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.hideTime),this.listenTo(this.mediaControl,x.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged),this.mediaControlContainer&&(this.listenTo(this.mediaControlContainer,x.CONTAINER_PLAYBACKDVRSTATECHANGED,this.update),this.listenTo(this.mediaControlContainer,x.CONTAINER_TIMEUPDATE,this.updateDuration))}},{key:"onContainerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"updateDuration",value:function(r){this.duration=r.total,this.firstFragDateTime=r.firstFragDateTime,this.update()}},{key:"showTime",value:function(r){this.hoveringOverSeekBar=!0,this.calculateHoverPosition(r),this.update()}},{key:"hideTime",value:function(){this.hoveringOverSeekBar=!1,this.update()}},{key:"calculateHoverPosition",value:function(r){var l=r.pageX-this.mediaControl.$seekBarContainer.offset().left;this.hoverPosition=Math.min(1,Math.max(l/this.mediaControl.$seekBarContainer.width(),0))}},{key:"getSeekTime",value:function(){var r,l,f,g;return this.useActualLiveTime?(this.firstFragDateTime?(g=new Date(this.firstFragDateTime),f=new Date(this.firstFragDateTime),f.setHours(0,0,0,0),l=(g.getTime()-f.getTime())/1e3+this.duration):(f=new Date(new Date().getTime()-this.actualLiveServerTimeDiff),g=new Date(f),l=(g-f.setHours(0,0,0,0))/1e3),r=l-this.duration+this.hoverPosition*this.duration,r<0&&(r+=86400)):r=this.hoverPosition*this.duration,{seekTime:r,secondsSinceMidnight:l}}},{key:"update",value:function(){if(!!this.rendered)if(!this.shouldBeVisible())this.$el.hide(),this.$el.css("left","-100%");else{var r=this.getSeekTime(),l=Ao(r.seekTime,this.useActualLiveTime);if(l!==this.displayedSeekTime&&(this.$seekTimeEl.text(l),this.displayedSeekTime=l),this.durationShown){this.$durationEl.show();var f=Ao(this.actualLiveTime?r.secondsSinceMidnight:this.duration,this.actualLiveTime);f!==this.displayedDuration&&(this.$durationEl.text(f),this.displayedDuration=f)}else this.$durationEl.hide();this.$el.show();var g=this.mediaControl.$seekBarContainer.width(),T=this.$el.width(),m=this.hoverPosition*g;m-=T/2,m=Math.max(0,Math.min(m,g-T)),this.$el.css("left",m)}}},{key:"shouldBeVisible",value:function(){return this.mediaControlContainer&&this.mediaControlContainer.settings.seekEnabled&&this.hoveringOverSeekBar&&this.hoverPosition!==null&&this.duration!==null}},{key:"render",value:function(){var r=Kt.getStyleFor(dg,{baseUrl:this.options.baseUrl});this.rendered=!0,this.displayedDuration=null,this.displayedSeekTime=null,this.$el.html(this.template()),this.$el.append(r[0]),this.$el.hide(),this.mediaControl.$el.append(this.el),this.$seekTimeEl=this.$el.find("[data-seek-time]"),this.$durationEl=this.$el.find("[data-duration]"),this.$durationEl.hide(),this.update()}}]),a}(vr),gg=`<div data-bounce1></div><div data-bounce2></div><div data-bounce3></div>
`,pg=`.spinner-three-bounce[data-spinner] {
  position: absolute;
  margin: 0 auto;
  width: 70px;
  text-align: center;
  z-index: 999;
  left: 0;
  right: 0;
  margin-left: auto;
  margin-right: auto;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%); }
  .spinner-three-bounce[data-spinner] > div {
    width: 18px;
    height: 18px;
    background-color: #FFFFFF;
    border-radius: 100%;
    display: inline-block;
    -webkit-animation: bouncedelay 1.4s infinite ease-in-out;
            animation: bouncedelay 1.4s infinite ease-in-out;
    /* Prevent first frame from flickering when animation starts */
    -webkit-animation-fill-mode: both;
            animation-fill-mode: both; }
  .spinner-three-bounce[data-spinner] [data-bounce1] {
    -webkit-animation-delay: -0.32s;
            animation-delay: -0.32s; }
  .spinner-three-bounce[data-spinner] [data-bounce2] {
    -webkit-animation-delay: -0.16s;
            animation-delay: -0.16s; }

@-webkit-keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0); }
  40% {
    transform: scale(1); } }

@keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0); }
  40% {
    transform: scale(1); } }
`,vg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.template=Xt(gg),r.showTimeout=null,r.listenTo(r.container,x.CONTAINER_STATE_BUFFERING,r.onBuffering),r.listenTo(r.container,x.CONTAINER_STATE_BUFFERFULL,r.onBufferFull),r.listenTo(r.container,x.CONTAINER_STOP,r.onStop),r.listenTo(r.container,x.CONTAINER_ENDED,r.onStop),r.listenTo(r.container,x.CONTAINER_ERROR,r.onStop),r.render(),r}return jt(a,[{key:"name",get:function(){return"spinner"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"attributes",get:function(){return{"data-spinner":"",class:"spinner-three-bounce"}}},{key:"onBuffering",value:function(){this.show()}},{key:"onBufferFull",value:function(){this.hide()}},{key:"onStop",value:function(){this.hide()}},{key:"show",value:function(){var r=this;this.showTimeout===null&&(this.showTimeout=setTimeout(function(){return r.$el.show()},300))}},{key:"hide",value:function(){this.showTimeout!==null&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.$el.hide()}},{key:"render",value:function(){var r=Kt.getStyleFor(pg,{baseUrl:this.options.baseUrl});return this.$el.html(this.template()),this.$el.append(r[0]),this.container.$el.append(this.$el),this.$el.hide(),this.container.buffering&&this.onBuffering(),this}}]),a}(Jr),mg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.setInitialAttrs(),r.reportInterval=r.options.reportInterval||5e3,r.state="IDLE",r}return jt(a,[{key:"name",get:function(){return"stats"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"bindEvents",value:function(){this.listenTo(this.container.playback,x.PLAYBACK_PLAY,this.onPlay),this.listenTo(this.container,x.CONTAINER_STOP,this.onStop),this.listenTo(this.container,x.CONTAINER_ENDED,this.onStop),this.listenTo(this.container,x.CONTAINER_DESTROYED,this.onStop),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,x.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,x.CONTAINER_STATS_ADD,this.onStatsAdd),this.listenTo(this.container,x.CONTAINER_BITRATE,this.onStatsAdd),this.listenTo(this.container.playback,x.PLAYBACK_STATS_ADD,this.onStatsAdd)}},{key:"setInitialAttrs",value:function(){this.firstPlay=!0,this.startupTime=0,this.rebufferingTime=0,this.watchingTime=0,this.rebuffers=0,this.externalMetrics={}}},{key:"onPlay",value:function(){this.state="PLAYING",this.watchingTimeInit=Date.now(),this.intervalId||(this.intervalId=setInterval(this.report.bind(this),this.reportInterval))}},{key:"onStop",value:function(){clearInterval(this.intervalId),this.report(),this.intervalId=void 0,this.state="STOPPED"}},{key:"onBuffering",value:function(){this.firstPlay?this.startupTimeInit=Date.now():this.rebufferingTimeInit=Date.now(),this.state="BUFFERING",this.rebuffers++}},{key:"onBufferFull",value:function(){this.firstPlay&&this.startupTimeInit?(this.firstPlay=!1,this.startupTime=Date.now()-this.startupTimeInit,this.watchingTimeInit=Date.now()):this.rebufferingTimeInit&&(this.rebufferingTime+=this.getRebufferingTime()),this.rebufferingTimeInit=void 0,this.state="PLAYING"}},{key:"getRebufferingTime",value:function(){return Date.now()-this.rebufferingTimeInit}},{key:"getWatchingTime",value:function(){var r=Date.now()-this.watchingTimeInit;return r-this.rebufferingTime}},{key:"isRebuffering",value:function(){return!!this.rebufferingTimeInit}},{key:"onStatsAdd",value:function(r){Ue.extend(this.externalMetrics,r)}},{key:"getStats",value:function(){var r={startupTime:this.startupTime,rebuffers:this.rebuffers,rebufferingTime:this.isRebuffering()?this.rebufferingTime+this.getRebufferingTime():this.rebufferingTime,watchingTime:this.isRebuffering()?this.getWatchingTime()-this.getRebufferingTime():this.getWatchingTime()};return Ue.extend(r,this.externalMetrics),r}},{key:"report",value:function(){this.container.statsReport(this.getStats())}}]),a}(Qr),yg=`<div class="clappr-watermark" data-watermark data-watermark-<%=position %>>
<% if(typeof imageLink !== 'undefined') { %>
<a target="_blank" href="<%= imageLink %>">
<% } %>
<img src="<%= imageUrl %>">
<% if(typeof imageLink !== 'undefined') { %>
</a>
<% } %>
</div>
`,Ag=`.clappr-watermark[data-watermark] {
  position: absolute;
  min-width: 70px;
  max-width: 200px;
  width: 12%;
  text-align: center;
  z-index: 10; }

.clappr-watermark[data-watermark] a {
  outline: none;
  cursor: pointer; }

.clappr-watermark[data-watermark] img {
  max-width: 100%; }

.clappr-watermark[data-watermark-bottom-left] {
  bottom: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-bottom-right] {
  bottom: 10px;
  right: 42px; }

.clappr-watermark[data-watermark-top-left] {
  top: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-top-right] {
  top: 10px;
  right: 37px; }
`,Eg=function(t){Yt(a,t);var i=zt(a);function a(n){var r;return Ht(this,a),r=i.call(this,n),r.configure(),r}return jt(a,[{key:"name",get:function(){return"watermark"}},{key:"supportedVersion",get:function(){return{min:"0.4.20"}}},{key:"template",get:function(){return Xt(yg)}},{key:"bindEvents",value:function(){this.listenTo(this.container,x.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,x.CONTAINER_STOP,this.onStop),this.listenTo(this.container,x.CONTAINER_OPTIONS_CHANGE,this.configure)}},{key:"configure",value:function(){this.position=this.options.position||"bottom-right",this.options.watermark?(this.imageUrl=this.options.watermark,this.imageLink=this.options.watermarkLink,this.render()):this.$el.remove()}},{key:"onPlay",value:function(){this.hidden||this.$el.show()}},{key:"onStop",value:function(){this.$el.hide()}},{key:"render",value:function(){this.$el.hide();var r=Kt.getStyleFor(Ag,{baseUrl:this.options.baseUrl}),l={position:this.position,imageUrl:this.imageUrl,imageLink:this.imageLink};return this.$el.html(this.template(l)),this.$el.append(r[0]),this.container.$el.append(this.$el),this}}]),a}(Jr);function Eo(t,i){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),a.push.apply(a,n)}return a}function ci(t){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Eo(Object(a),!0).forEach(function(n){Tg(t,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Eo(Object(a)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))})}return t}function _g(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _o(t,i){for(var a=0;a<i.length;a++){var n=i[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bg(t,i,a){return i&&_o(t.prototype,i),a&&_o(t,a),t}function Tg(t,i,a){return i in t?Object.defineProperty(t,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[i]=a,t}function xg(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&Ta(t,i)}function dr(t){return dr=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},dr(t)}function Ta(t,i){return Ta=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},Ta(t,i)}function Sg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kg(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rg(t,i){return i&&(typeof i=="object"||typeof i=="function")?i:kg(t)}function Cg(t){var i=Sg();return function(){var n=dr(t),r;if(i){var l=dr(this).constructor;r=Reflect.construct(n,arguments,l)}else r=n.apply(this,arguments);return Rg(this,r)}}function wg(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&(t=dr(t),t!==null););return t}function Cr(t,i,a){return typeof Reflect<"u"&&Reflect.get?Cr=Reflect.get:Cr=function(r,l,f){var g=wg(r,l);if(!!g){var T=Object.getOwnPropertyDescriptor(g,l);return T.get?T.get.call(f):T.value}},Cr(t,i,a||t)}function Lg(t){return Ig(t)||Og(t)||Dg(t)||Pg()}function Ig(t){if(Array.isArray(t))return xa(t)}function Og(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Dg(t,i){if(!!t){if(typeof t=="string")return xa(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xa(t,i)}}function xa(t,i){(i==null||i>t.length)&&(i=t.length);for(var a=0,n=new Array(i);a<i;a++)n[a]=t[a];return n}function Pg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ng=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nl={exports:{}};(function(t,i){typeof window<"u"&&function(n,r){t.exports=r()}(Ng,function(){return function(a){var n={};function r(l){if(n[l])return n[l].exports;var f=n[l]={i:l,l:!1,exports:{}};return a[l].call(f.exports,f,f.exports,r),f.l=!0,f.exports}return r.m=a,r.c=n,r.d=function(l,f,g){r.o(l,f)||Object.defineProperty(l,f,{enumerable:!0,get:g})},r.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},r.t=function(l,f){if(f&1&&(l=r(l)),f&8||f&4&&typeof l=="object"&&l&&l.__esModule)return l;var g=Object.create(null);if(r.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:l}),f&2&&typeof l!="string")for(var T in l)r.d(g,T,function(m){return l[m]}.bind(null,T));return g},r.n=function(l){var f=l&&l.__esModule?function(){return l.default}:function(){return l};return r.d(f,"a",f),f},r.o=function(l,f){return Object.prototype.hasOwnProperty.call(l,f)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(a,n,r){var l=Object.prototype.hasOwnProperty,f="~";function g(){}Object.create&&(g.prototype=Object.create(null),new g().__proto__||(f=!1));function T(w,L,K){this.fn=w,this.context=L,this.once=K||!1}function m(w,L,K,F,j){if(typeof K!="function")throw new TypeError("The listener must be a function");var $=new T(K,F||w,j),X=f?f+L:L;return w._events[X]?w._events[X].fn?w._events[X]=[w._events[X],$]:w._events[X].push($):(w._events[X]=$,w._eventsCount++),w}function A(w,L){--w._eventsCount===0?w._events=new g:delete w._events[L]}function U(){this._events=new g,this._eventsCount=0}U.prototype.eventNames=function(){var L=[],K,F;if(this._eventsCount===0)return L;for(F in K=this._events)l.call(K,F)&&L.push(f?F.slice(1):F);return Object.getOwnPropertySymbols?L.concat(Object.getOwnPropertySymbols(K)):L},U.prototype.listeners=function(L){var K=f?f+L:L,F=this._events[K];if(!F)return[];if(F.fn)return[F.fn];for(var j=0,$=F.length,X=new Array($);j<$;j++)X[j]=F[j].fn;return X},U.prototype.listenerCount=function(L){var K=f?f+L:L,F=this._events[K];return F?F.fn?1:F.length:0},U.prototype.emit=function(L,K,F,j,$,X){var se=f?f+L:L;if(!this._events[se])return!1;var J=this._events[se],re=arguments.length,he,ye;if(J.fn){switch(J.once&&this.removeListener(L,J.fn,void 0,!0),re){case 1:return J.fn.call(J.context),!0;case 2:return J.fn.call(J.context,K),!0;case 3:return J.fn.call(J.context,K,F),!0;case 4:return J.fn.call(J.context,K,F,j),!0;case 5:return J.fn.call(J.context,K,F,j,$),!0;case 6:return J.fn.call(J.context,K,F,j,$,X),!0}for(ye=1,he=new Array(re-1);ye<re;ye++)he[ye-1]=arguments[ye];J.fn.apply(J.context,he)}else{var be=J.length,Y;for(ye=0;ye<be;ye++)switch(J[ye].once&&this.removeListener(L,J[ye].fn,void 0,!0),re){case 1:J[ye].fn.call(J[ye].context);break;case 2:J[ye].fn.call(J[ye].context,K);break;case 3:J[ye].fn.call(J[ye].context,K,F);break;case 4:J[ye].fn.call(J[ye].context,K,F,j);break;default:if(!he)for(Y=1,he=new Array(re-1);Y<re;Y++)he[Y-1]=arguments[Y];J[ye].fn.apply(J[ye].context,he)}}return!0},U.prototype.on=function(L,K,F){return m(this,L,K,F,!1)},U.prototype.once=function(L,K,F){return m(this,L,K,F,!0)},U.prototype.removeListener=function(L,K,F,j){var $=f?f+L:L;if(!this._events[$])return this;if(!K)return A(this,$),this;var X=this._events[$];if(X.fn)X.fn===K&&(!j||X.once)&&(!F||X.context===F)&&A(this,$);else{for(var se=0,J=[],re=X.length;se<re;se++)(X[se].fn!==K||j&&!X[se].once||F&&X[se].context!==F)&&J.push(X[se]);J.length?this._events[$]=J.length===1?J[0]:J:A(this,$)}return this},U.prototype.removeAllListeners=function(L){var K;return L?(K=f?f+L:L,this._events[K]&&A(this,K)):(this._events=new g,this._eventsCount=0),this},U.prototype.off=U.prototype.removeListener,U.prototype.addListener=U.prototype.on,U.prefixed=f,U.EventEmitter=U,a.exports=U},"./node_modules/url-toolkit/src/url-toolkit.js":function(a,n,r){(function(l){var f=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,g=/^([^\/?#]*)(.*)$/,T=/(?:\/|^)\.(?=\/)/g,m=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,A={buildAbsoluteURL:function(U,w,L){if(L=L||{},U=U.trim(),w=w.trim(),!w){if(!L.alwaysNormalize)return U;var K=A.parseURL(U);if(!K)throw new Error("Error trying to parse base URL.");return K.path=A.normalizePath(K.path),A.buildURLFromParts(K)}var F=A.parseURL(w);if(!F)throw new Error("Error trying to parse relative URL.");if(F.scheme)return L.alwaysNormalize?(F.path=A.normalizePath(F.path),A.buildURLFromParts(F)):w;var j=A.parseURL(U);if(!j)throw new Error("Error trying to parse base URL.");if(!j.netLoc&&j.path&&j.path[0]!=="/"){var $=g.exec(j.path);j.netLoc=$[1],j.path=$[2]}j.netLoc&&!j.path&&(j.path="/");var X={scheme:j.scheme,netLoc:F.netLoc,path:null,params:F.params,query:F.query,fragment:F.fragment};if(!F.netLoc&&(X.netLoc=j.netLoc,F.path[0]!=="/"))if(!F.path)X.path=j.path,F.params||(X.params=j.params,F.query||(X.query=j.query));else{var se=j.path,J=se.substring(0,se.lastIndexOf("/")+1)+F.path;X.path=A.normalizePath(J)}return X.path===null&&(X.path=L.alwaysNormalize?A.normalizePath(F.path):F.path),A.buildURLFromParts(X)},parseURL:function(U){var w=f.exec(U);return w?{scheme:w[1]||"",netLoc:w[2]||"",path:w[3]||"",params:w[4]||"",query:w[5]||"",fragment:w[6]||""}:null},normalizePath:function(U){for(U=U.split("").reverse().join("").replace(T,"");U.length!==(U=U.replace(m,"")).length;);return U.split("").reverse().join("")},buildURLFromParts:function(U){return U.scheme+U.netLoc+U.path+U.params+U.query+U.fragment}};a.exports=A})()},"./node_modules/webworkify-webpack/index.js":function(a,n,r){function l(L){var K={};function F($){if(K[$])return K[$].exports;var X=K[$]={i:$,l:!1,exports:{}};return L[$].call(X.exports,X,X.exports,F),X.l=!0,X.exports}F.m=L,F.c=K,F.i=function($){return $},F.d=function($,X,se){F.o($,X)||Object.defineProperty($,X,{configurable:!1,enumerable:!0,get:se})},F.r=function($){Object.defineProperty($,"__esModule",{value:!0})},F.n=function($){var X=$&&$.__esModule?function(){return $.default}:function(){return $};return F.d(X,"a",X),X},F.o=function($,X){return Object.prototype.hasOwnProperty.call($,X)},F.p="/",F.oe=function($){throw console.error($),$};var j=F(F.s=ENTRY_MODULE);return j.default||j}var f="[\\.|\\-|\\+|\\w|/|@]+",g="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+f+").*?\\)";function T(L){return(L+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function m(L){return!isNaN(1*L)}function A(L,K,F){var j={};j[F]=[];var $=K.toString(),X=$.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!X)return j;for(var se=X[1],J=new RegExp("(\\\\n|\\W)"+T(se)+g,"g"),re;re=J.exec($);)re[3]!=="dll-reference"&&j[F].push(re[3]);for(J=new RegExp("\\("+T(se)+'\\("(dll-reference\\s('+f+'))"\\)\\)'+g,"g");re=J.exec($);)L[re[2]]||(j[F].push(re[1]),L[re[2]]=r(re[1]).m),j[re[2]]=j[re[2]]||[],j[re[2]].push(re[4]);for(var he=Object.keys(j),ye=0;ye<he.length;ye++)for(var be=0;be<j[he[ye]].length;be++)m(j[he[ye]][be])&&(j[he[ye]][be]=1*j[he[ye]][be]);return j}function U(L){var K=Object.keys(L);return K.reduce(function(F,j){return F||L[j].length>0},!1)}function w(L,K){for(var F={main:[K]},j={main:[]},$={main:{}};U(F);)for(var X=Object.keys(F),se=0;se<X.length;se++){var J=X[se],re=F[J],he=re.pop();if($[J]=$[J]||{},!($[J][he]||!L[J][he])){$[J][he]=!0,j[J]=j[J]||[],j[J].push(he);for(var ye=A(L,L[J][he],J),be=Object.keys(ye),Y=0;Y<be.length;Y++)F[be[Y]]=F[be[Y]]||[],F[be[Y]]=F[be[Y]].concat(ye[be[Y]])}}return j}a.exports=function(L,K){K=K||{};var F={main:r.m},j=K.all?{main:Object.keys(F.main)}:w(F,L),$="";Object.keys(j).filter(function(he){return he!=="main"}).forEach(function(he){for(var ye=0;j[he][ye];)ye++;j[he].push(ye),F[he][ye]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",$=$+"var "+he+" = ("+l.toString().replace("ENTRY_MODULE",JSON.stringify(ye))+")({"+j[he].map(function(be){return""+JSON.stringify(be)+": "+F[he][be].toString()}).join(",")+`});
`}),$=$+"new (("+l.toString().replace("ENTRY_MODULE",JSON.stringify(L))+")({"+j.main.map(function(he){return""+JSON.stringify(he)+": "+F.main[he].toString()}).join(",")+"}))(self);";var X=new window.Blob([$],{type:"text/javascript"});if(K.bare)return X;var se=window.URL||window.webkitURL||window.mozURL||window.msURL,J=se.createObjectURL(X),re=new window.Worker(J);return re.objectURL=J,re}},"./src/crypt/decrypter.js":function(a,n,r){r.r(n);var l=function(){function $(se,J){this.subtle=se,this.aesIV=J}var X=$.prototype;return X.decrypt=function(J,re){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},re,J)},$}(),f=function(){function $(se,J){this.subtle=se,this.key=J}var X=$.prototype;return X.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},$}(),g=f;function T($){var X=$.byteLength,se=X&&new DataView($).getUint8(X-1);return se?$.slice(0,X-se):$}var m=function(){function $(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var X=$.prototype;return X.uint8ArrayToUint32Array_=function(J){for(var re=new DataView(J),he=new Uint32Array(4),ye=0;ye<4;ye++)he[ye]=re.getUint32(ye*4);return he},X.initTable=function(){var J=this.sBox,re=this.invSBox,he=this.subMix,ye=he[0],be=he[1],Y=he[2],W=he[3],ge=this.invSubMix,Z=ge[0],q=ge[1],oe=ge[2],xe=ge[3],Ae=new Uint32Array(256),Ee=0,Te=0,Re=0;for(Re=0;Re<256;Re++)Re<128?Ae[Re]=Re<<1:Ae[Re]=Re<<1^283;for(Re=0;Re<256;Re++){var Pe=Te^Te<<1^Te<<2^Te<<3^Te<<4;Pe=Pe>>>8^Pe&255^99,J[Ee]=Pe,re[Pe]=Ee;var Oe=Ae[Ee],ke=Ae[Oe],Ne=Ae[ke],qe=Ae[Pe]*257^Pe*16843008;ye[Ee]=qe<<24|qe>>>8,be[Ee]=qe<<16|qe>>>16,Y[Ee]=qe<<8|qe>>>24,W[Ee]=qe,qe=Ne*16843009^ke*65537^Oe*257^Ee*16843008,Z[Pe]=qe<<24|qe>>>8,q[Pe]=qe<<16|qe>>>16,oe[Pe]=qe<<8|qe>>>24,xe[Pe]=qe,Ee?(Ee=Oe^Ae[Ae[Ae[Ne^Oe]]],Te^=Ae[Ae[Te]]):Ee=Te=1}},X.expandKey=function(J){for(var re=this.uint8ArrayToUint32Array_(J),he=!0,ye=0;ye<re.length&&he;)he=re[ye]===this.key[ye],ye++;if(!he){this.key=re;var be=this.keySize=re.length;if(be!==4&&be!==6&&be!==8)throw new Error("Invalid aes key size="+be);var Y=this.ksRows=(be+6+1)*4,W,ge,Z=this.keySchedule=new Uint32Array(Y),q=this.invKeySchedule=new Uint32Array(Y),oe=this.sBox,xe=this.rcon,Ae=this.invSubMix,Ee=Ae[0],Te=Ae[1],Re=Ae[2],Pe=Ae[3],Oe,ke;for(W=0;W<Y;W++){if(W<be){Oe=Z[W]=re[W];continue}ke=Oe,W%be===0?(ke=ke<<8|ke>>>24,ke=oe[ke>>>24]<<24|oe[ke>>>16&255]<<16|oe[ke>>>8&255]<<8|oe[ke&255],ke^=xe[W/be|0]<<24):be>6&&W%be===4&&(ke=oe[ke>>>24]<<24|oe[ke>>>16&255]<<16|oe[ke>>>8&255]<<8|oe[ke&255]),Z[W]=Oe=(Z[W-be]^ke)>>>0}for(ge=0;ge<Y;ge++)W=Y-ge,ge&3?ke=Z[W]:ke=Z[W-4],ge<4||W<=4?q[ge]=ke:q[ge]=Ee[oe[ke>>>24]]^Te[oe[ke>>>16&255]]^Re[oe[ke>>>8&255]]^Pe[oe[ke&255]],q[ge]=q[ge]>>>0}},X.networkToHostOrderSwap=function(J){return J<<24|(J&65280)<<8|(J&16711680)>>8|J>>>24},X.decrypt=function(J,re,he,ye){for(var be=this.keySize+6,Y=this.invKeySchedule,W=this.invSBox,ge=this.invSubMix,Z=ge[0],q=ge[1],oe=ge[2],xe=ge[3],Ae=this.uint8ArrayToUint32Array_(he),Ee=Ae[0],Te=Ae[1],Re=Ae[2],Pe=Ae[3],Oe=new Int32Array(J),ke=new Int32Array(Oe.length),Ne,qe,mt,dt,Me,st,ot,pt,St,B,G,ee,ie,ue,pe=this.networkToHostOrderSwap;re<Oe.length;){for(St=pe(Oe[re]),B=pe(Oe[re+1]),G=pe(Oe[re+2]),ee=pe(Oe[re+3]),Me=St^Y[0],st=ee^Y[1],ot=G^Y[2],pt=B^Y[3],ie=4,ue=1;ue<be;ue++)Ne=Z[Me>>>24]^q[st>>16&255]^oe[ot>>8&255]^xe[pt&255]^Y[ie],qe=Z[st>>>24]^q[ot>>16&255]^oe[pt>>8&255]^xe[Me&255]^Y[ie+1],mt=Z[ot>>>24]^q[pt>>16&255]^oe[Me>>8&255]^xe[st&255]^Y[ie+2],dt=Z[pt>>>24]^q[Me>>16&255]^oe[st>>8&255]^xe[ot&255]^Y[ie+3],Me=Ne,st=qe,ot=mt,pt=dt,ie=ie+4;Ne=W[Me>>>24]<<24^W[st>>16&255]<<16^W[ot>>8&255]<<8^W[pt&255]^Y[ie],qe=W[st>>>24]<<24^W[ot>>16&255]<<16^W[pt>>8&255]<<8^W[Me&255]^Y[ie+1],mt=W[ot>>>24]<<24^W[pt>>16&255]<<16^W[Me>>8&255]<<8^W[st&255]^Y[ie+2],dt=W[pt>>>24]<<24^W[Me>>16&255]<<16^W[st>>8&255]<<8^W[ot&255]^Y[ie+3],ie=ie+3,ke[re]=pe(Ne^Ee),ke[re+1]=pe(dt^Te),ke[re+2]=pe(mt^Re),ke[re+3]=pe(qe^Pe),Ee=St,Te=B,Re=G,Pe=ee,re=re+4}return ye?T(ke.buffer):ke.buffer},X.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},$}(),A=m,U=r("./src/errors.ts"),w=r("./src/utils/logger.js"),L=r("./src/events.js"),K=r("./src/utils/get-self-scope.js"),F=Object(K.getSelfScope)(),j=function(){function $(se,J,re){var he=re===void 0?{}:re,ye=he.removePKCS7Padding,be=ye===void 0?!0:ye;if(this.logEnabled=!0,this.observer=se,this.config=J,this.removePKCS7Padding=be,be)try{var Y=F.crypto;Y&&(this.subtle=Y.subtle||Y.webkitSubtle)}catch{}this.disableWebCrypto=!this.subtle}var X=$.prototype;return X.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},X.decrypt=function(J,re,he,ye){var be=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(w.logger.log("JS AES decrypt"),this.logEnabled=!1);var Y=this.decryptor;Y||(this.decryptor=Y=new A),Y.expandKey(re),ye(Y.decrypt(J,0,he,this.removePKCS7Padding))}else{this.logEnabled&&(w.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var W=this.subtle;this.key!==re&&(this.key=re,this.fastAesKey=new g(W,re)),this.fastAesKey.expandKey().then(function(ge){var Z=new l(W,he);Z.decrypt(J,ge).catch(function(q){be.onWebCryptoError(q,J,re,he,ye)}).then(function(q){ye(q)})}).catch(function(ge){be.onWebCryptoError(ge,J,re,he,ye)})}},X.onWebCryptoError=function(J,re,he,ye,be){this.config.enableSoftwareAES?(w.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(re,he,ye,be)):(w.logger.error("decrypting error : "+J.message),this.observer.trigger(L.default.ERROR,{type:U.ErrorTypes.MEDIA_ERROR,details:U.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:J.message}))},X.destroy=function(){var J=this.decryptor;J&&(J.destroy(),this.decryptor=void 0)},$}();n.default=j},"./src/demux/demuxer-inline.js":function(a,n,r){r.r(n);var l=r("./src/events.js"),f=r("./src/errors.ts"),g=r("./src/crypt/decrypter.js"),T=r("./src/polyfills/number.js"),m=r("./src/utils/logger.js"),A=r("./src/utils/get-self-scope.js");function U(_,k,R,v){var S,I,N,M,V,z=navigator.userAgent.toLowerCase(),ae=v,le=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(S=((k[R+2]&192)>>>6)+1,I=(k[R+2]&60)>>>2,I>le.length-1){_.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+I});return}return M=(k[R+2]&1)<<2,M|=(k[R+3]&192)>>>6,m.logger.log("manifest codec:"+v+",ADTS data:type:"+S+",sampleingIndex:"+I+"["+le[I]+"Hz],channelConfig:"+M),/firefox/i.test(z)?I>=6?(S=5,V=new Array(4),N=I-3):(S=2,V=new Array(2),N=I):z.indexOf("android")!==-1?(S=2,V=new Array(2),N=I):(S=5,V=new Array(4),v&&(v.indexOf("mp4a.40.29")!==-1||v.indexOf("mp4a.40.5")!==-1)||!v&&I>=6?N=I-3:((v&&v.indexOf("mp4a.40.2")!==-1&&(I>=6&&M===1||/vivaldi/i.test(z))||!v&&M===1)&&(S=2,V=new Array(2)),N=I)),V[0]=S<<3,V[0]|=(I&14)>>1,V[1]|=(I&1)<<7,V[1]|=M<<3,S===5&&(V[1]|=(N&14)>>1,V[2]=(N&1)<<7,V[2]|=2<<2,V[3]=0),{config:V,samplerate:le[I],channelCount:M,codec:"mp4a.40."+S,manifestCodec:ae}}function w(_,k){return _[k]===255&&(_[k+1]&246)===240}function L(_,k){return _[k+1]&1?7:9}function K(_,k){return(_[k+3]&3)<<11|_[k+4]<<3|(_[k+5]&224)>>>5}function F(_,k){return!!(k+1<_.length&&w(_,k))}function j(_,k){if(F(_,k)){var R=L(_,k);if(k+R>=_.length)return!1;var v=K(_,k);if(v<=R)return!1;var S=k+v;if(S===_.length||S+1<_.length&&w(_,S))return!0}return!1}function $(_,k,R,v,S){if(!_.samplerate){var I=U(k,R,v,S);_.config=I.config,_.samplerate=I.samplerate,_.channelCount=I.channelCount,_.codec=I.codec,_.manifestCodec=I.manifestCodec,m.logger.log("parsed codec:"+_.codec+",rate:"+I.samplerate+",nb channel:"+I.channelCount)}}function X(_){return 1024*9e4/_}function se(_,k,R,v,S){var I,N,M,V=_.length;if(I=L(_,k),N=K(_,k),N-=I,N>0&&k+I+N<=V)return M=R+v*S,{headerLength:I,frameLength:N,stamp:M}}function J(_,k,R,v,S){var I=X(_.samplerate),N=se(k,R,v,S,I);if(N){var M=N.stamp,V=N.headerLength,z=N.frameLength,ae={unit:k.subarray(R+V,R+V+z),pts:M,dts:M};return _.samples.push(ae),{sample:ae,length:z+V}}}var re=r("./src/demux/id3.js"),he=function(){function _(R,v,S){this.observer=R,this.config=S,this.remuxer=v}var k=_.prototype;return k.resetInitSegment=function(v,S,I,N){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:S,duration:N,inputTimeScale:9e4}},k.resetTimeStamp=function(){},_.probe=function(v){if(!v)return!1;for(var S=re.default.getID3Data(v,0)||[],I=S.length,N=v.length;I<N;I++)if(j(v,I))return m.logger.log("ADTS sync word found !"),!0;return!1},k.append=function(v,S,I,N){for(var M=this._audioTrack,V=re.default.getID3Data(v,0)||[],z=re.default.getTimeStamp(V),ae=Object(T.isFiniteNumber)(z)?z*90:S*9e4,le=0,ne=ae,ve=v.length,de=V.length,me=[{pts:ne,dts:ne,data:V}];de<ve-1;)if(F(v,de)&&de+5<ve){$(M,this.observer,v,de,M.manifestCodec);var ce=J(M,v,de,ae,le);if(ce)de+=ce.length,ne=ce.sample.pts,le++;else{m.logger.log("Unable to parse AAC frame");break}}else re.default.isHeader(v,de)?(V=re.default.getID3Data(v,de),me.push({pts:ne,dts:ne,data:V}),de+=V.length):de++;this.remuxer.remux(M,{samples:[]},{samples:me,inputTimeScale:9e4},{samples:[]},S,I,N)},k.destroy=function(){},_}(),ye=he,be=r("./src/demux/mp4demuxer.js"),Y={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(k,R,v,S,I){if(!(v+24>R.length)){var N=this.parseHeader(R,v);if(N&&v+N.frameLength<=R.length){var M=N.samplesPerFrame*9e4/N.sampleRate,V=S+I*M,z={unit:R.subarray(v,v+N.frameLength),pts:V,dts:V};return k.config=[],k.channelCount=N.channelCount,k.samplerate=N.sampleRate,k.samples.push(z),{sample:z,length:N.frameLength}}}},parseHeader:function(k,R){var v=k[R+1]>>3&3,S=k[R+1]>>1&3,I=k[R+2]>>4&15,N=k[R+2]>>2&3,M=k[R+2]>>1&1;if(v!==1&&I!==0&&I!==15&&N!==3){var V=v===3?3-S:S===3?3:4,z=Y.BitratesMap[V*14+I-1]*1e3,ae=v===3?0:v===2?1:2,le=Y.SamplingRateMap[ae*3+N],ne=k[R+3]>>6===3?1:2,ve=Y.SamplesCoefficients[v][S],de=Y.BytesInSlot[S],me=ve*8*de,ce=parseInt(ve*z/le+M,10)*de;return{sampleRate:le,channelCount:ne,frameLength:ce,samplesPerFrame:me}}},isHeaderPattern:function(k,R){return k[R]===255&&(k[R+1]&224)===224&&(k[R+1]&6)!==0},isHeader:function(k,R){return!!(R+1<k.length&&this.isHeaderPattern(k,R))},probe:function(k,R){if(R+1<k.length&&this.isHeaderPattern(k,R)){var v=4,S=this.parseHeader(k,R),I=v;S&&S.frameLength&&(I=S.frameLength);var N=R+I;if(N===k.length||N+1<k.length&&this.isHeaderPattern(k,N))return!0}return!1}},W=Y,ge=function(){function _(R){this.data=R,this.bytesAvailable=R.byteLength,this.word=0,this.bitsAvailable=0}var k=_.prototype;return k.loadWord=function(){var v=this.data,S=this.bytesAvailable,I=v.byteLength-S,N=new Uint8Array(4),M=Math.min(4,S);if(M===0)throw new Error("no bytes available");N.set(v.subarray(I,I+M)),this.word=new DataView(N.buffer).getUint32(0),this.bitsAvailable=M*8,this.bytesAvailable-=M},k.skipBits=function(v){var S;this.bitsAvailable>v?(this.word<<=v,this.bitsAvailable-=v):(v-=this.bitsAvailable,S=v>>3,v-=S>>3,this.bytesAvailable-=S,this.loadWord(),this.word<<=v,this.bitsAvailable-=v)},k.readBits=function(v){var S=Math.min(this.bitsAvailable,v),I=this.word>>>32-S;return v>32&&m.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=S,this.bitsAvailable>0?this.word<<=S:this.bytesAvailable>0&&this.loadWord(),S=v-S,S>0&&this.bitsAvailable?I<<S|this.readBits(S):I},k.skipLZ=function(){var v;for(v=0;v<this.bitsAvailable;++v)if((this.word&2147483648>>>v)!==0)return this.word<<=v,this.bitsAvailable-=v,v;return this.loadWord(),v+this.skipLZ()},k.skipUEG=function(){this.skipBits(1+this.skipLZ())},k.skipEG=function(){this.skipBits(1+this.skipLZ())},k.readUEG=function(){var v=this.skipLZ();return this.readBits(v+1)-1},k.readEG=function(){var v=this.readUEG();return 1&v?1+v>>>1:-1*(v>>>1)},k.readBoolean=function(){return this.readBits(1)===1},k.readUByte=function(){return this.readBits(8)},k.readUShort=function(){return this.readBits(16)},k.readUInt=function(){return this.readBits(32)},k.skipScalingList=function(v){var S=8,I=8,N,M;for(N=0;N<v;N++)I!==0&&(M=this.readEG(),I=(S+M+256)%256),S=I===0?S:I},k.readSPS=function(){var v=0,S=0,I=0,N=0,M,V,z,ae,le,ne,ve,de=this.readUByte.bind(this),me=this.readBits.bind(this),ce=this.readUEG.bind(this),we=this.readBoolean.bind(this),Le=this.skipBits.bind(this),Ve=this.skipEG.bind(this),et=this.skipUEG.bind(this),Ge=this.skipScalingList.bind(this);if(de(),M=de(),me(5),Le(3),de(),et(),M===100||M===110||M===122||M===244||M===44||M===83||M===86||M===118||M===128){var ut=ce();if(ut===3&&Le(1),et(),et(),Le(1),we())for(ne=ut!==3?8:12,ve=0;ve<ne;ve++)we()&&(ve<6?Ge(16):Ge(64))}et();var Qe=ce();if(Qe===0)ce();else if(Qe===1)for(Le(1),Ve(),Ve(),V=ce(),ve=0;ve<V;ve++)Ve();et(),Le(1),z=ce(),ae=ce(),le=me(1),le===0&&Le(1),Le(1),we()&&(v=ce(),S=ce(),I=ce(),N=ce());var Ye=[1,1];if(we()&&we()){var tt=de();switch(tt){case 1:Ye=[1,1];break;case 2:Ye=[12,11];break;case 3:Ye=[10,11];break;case 4:Ye=[16,11];break;case 5:Ye=[40,33];break;case 6:Ye=[24,11];break;case 7:Ye=[20,11];break;case 8:Ye=[32,11];break;case 9:Ye=[80,33];break;case 10:Ye=[18,11];break;case 11:Ye=[15,11];break;case 12:Ye=[64,33];break;case 13:Ye=[160,99];break;case 14:Ye=[4,3];break;case 15:Ye=[3,2];break;case 16:Ye=[2,1];break;case 255:{Ye=[de()<<8|de(),de()<<8|de()];break}}}return{width:Math.ceil((z+1)*16-v*2-S*2),height:(2-le)*(ae+1)*16-(le?2:4)*(I+N),pixelRatio:Ye}},k.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},_}(),Z=ge,q=function(){function _(R,v,S,I){this.decryptdata=S,this.discardEPB=I,this.decrypter=new g.default(R,v,{removePKCS7Padding:!1})}var k=_.prototype;return k.decryptBuffer=function(v,S){this.decrypter.decrypt(v,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,S)},k.decryptAacSample=function(v,S,I,N){var M=v[S].unit,V=M.subarray(16,M.length-M.length%16),z=V.buffer.slice(V.byteOffset,V.byteOffset+V.length),ae=this;this.decryptBuffer(z,function(le){le=new Uint8Array(le),M.set(le,16),N||ae.decryptAacSamples(v,S+1,I)})},k.decryptAacSamples=function(v,S,I){for(;;S++){if(S>=v.length){I();return}if(!(v[S].unit.length<32)){var N=this.decrypter.isSync();if(this.decryptAacSample(v,S,I,N),!N)return}}},k.getAvcEncryptedData=function(v){for(var S=Math.floor((v.length-48)/160)*16+16,I=new Int8Array(S),N=0,M=32;M<=v.length-16;M+=160,N+=16)I.set(v.subarray(M,M+16),N);return I},k.getAvcDecryptedUnit=function(v,S){S=new Uint8Array(S);for(var I=0,N=32;N<=v.length-16;N+=160,I+=16)v.set(S.subarray(I,I+16),N);return v},k.decryptAvcSample=function(v,S,I,N,M,V){var z=this.discardEPB(M.data),ae=this.getAvcEncryptedData(z),le=this;this.decryptBuffer(ae.buffer,function(ne){M.data=le.getAvcDecryptedUnit(z,ne),V||le.decryptAvcSamples(v,S,I+1,N)})},k.decryptAvcSamples=function(v,S,I,N){for(;;S++,I=0){if(S>=v.length){N();return}for(var M=v[S].units;!(I>=M.length);I++){var V=M[I];if(!(V.data.length<=48||V.type!==1&&V.type!==5)){var z=this.decrypter.isSync();if(this.decryptAvcSample(v,S,I,N,V,z),!z)return}}}},_}(),oe=q,xe={video:1,audio:2,id3:3,text:4},Ae=function(){function _(R,v,S,I){this.observer=R,this.config=S,this.typeSupported=I,this.remuxer=v,this.sampleAes=null,this.pmtUnknownTypes={}}var k=_.prototype;return k.setDecryptData=function(v){v!=null&&v.key!=null&&v.method==="SAMPLE-AES"?this.sampleAes=new oe(this.observer,this.config,v,this.discardEPB):this.sampleAes=null},_.probe=function(v){var S=_._syncOffset(v);return S<0?!1:(S&&m.logger.warn("MPEG2-TS detected but first sync word found @ offset "+S+", junk ahead ?"),!0)},_._syncOffset=function(v){for(var S=Math.min(1e3,v.length-564),I=0;I<S;){if(v[I]===71&&v[I+188]===71&&v[I+2*188]===71)return I;I++}return-1},_.createTrack=function(v,S){return{container:v==="video"||v==="audio"?"video/mp2t":void 0,type:v,id:xe[v],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:v==="video"?0:void 0,isAAC:v==="audio"?!0:void 0,duration:v==="audio"?S:void 0}},k.resetInitSegment=function(v,S,I,N){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=_.createTrack("video",N),this._audioTrack=_.createTrack("audio",N),this._id3Track=_.createTrack("id3",N),this._txtTrack=_.createTrack("text",N),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=S,this.videoCodec=I,this._duration=N},k.resetTimeStamp=function(){},k.append=function(v,S,I,N){var M,V=v.length,z,ae,le,ne,ve,de=!1;this.pmtUnknownTypes={},this.contiguous=I;var me=this.pmtParsed,ce=this._avcTrack,we=this._audioTrack,Le=this._id3Track,Ve=ce.pid,et=we.pid,Ge=Le.pid,ut=this._pmtId,Qe=ce.pesData,Ye=we.pesData,tt=Le.pesData,nt=this._parsePAT,kt=this._parsePMT.bind(this),bt=this._parsePES,ct=this._parseAVCPES.bind(this),Lt=this._parseAACPES.bind(this),Tt=this._parseMPEGPES.bind(this),Pt=this._parseID3PES.bind(this),yt=_._syncOffset(v);for(V-=(V+yt)%188,M=yt;M<V;M+=188)if(v[M]===71){if(z=!!(v[M+1]&64),ae=((v[M+1]&31)<<8)+v[M+2],le=(v[M+3]&48)>>4,le>1){if(ne=M+5+v[M+4],ne===M+188)continue}else ne=M+4;switch(ae){case Ve:z&&(Qe&&(ve=bt(Qe))&&ct(ve,!1),Qe={data:[],size:0}),Qe&&(Qe.data.push(v.subarray(ne,M+188)),Qe.size+=M+188-ne);break;case et:z&&(Ye&&(ve=bt(Ye))&&(we.isAAC?Lt(ve):Tt(ve)),Ye={data:[],size:0}),Ye&&(Ye.data.push(v.subarray(ne,M+188)),Ye.size+=M+188-ne);break;case Ge:z&&(tt&&(ve=bt(tt))&&Pt(ve),tt={data:[],size:0}),tt&&(tt.data.push(v.subarray(ne,M+188)),tt.size+=M+188-ne);break;case 0:z&&(ne+=v[ne]+1),ut=this._pmtId=nt(v,ne);break;case ut:z&&(ne+=v[ne]+1);var ft=kt(v,ne,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,this.sampleAes!=null);Ve=ft.avc,Ve>0&&(ce.pid=Ve),et=ft.audio,et>0&&(we.pid=et,we.isAAC=ft.isAAC),Ge=ft.id3,Ge>0&&(Le.pid=Ge),de&&!me&&(m.logger.log("reparse from beginning"),de=!1,M=yt-188),me=this.pmtParsed=!0;break;case 17:case 8191:break;default:de=!0;break}}else this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});Qe&&(ve=bt(Qe))?(ct(ve,!0),ce.pesData=null):ce.pesData=Qe,Ye&&(ve=bt(Ye))?(we.isAAC?Lt(ve):Tt(ve),we.pesData=null):(Ye&&Ye.size&&m.logger.log("last AAC PES packet truncated,might overlap between fragments"),we.pesData=Ye),tt&&(ve=bt(tt))?(Pt(ve),Le.pesData=null):Le.pesData=tt,this.sampleAes==null?this.remuxer.remux(we,ce,Le,this._txtTrack,S,I,N):this.decryptAndRemux(we,ce,Le,this._txtTrack,S,I,N)},k.decryptAndRemux=function(v,S,I,N,M,V,z){if(v.samples&&v.isAAC){var ae=this;this.sampleAes.decryptAacSamples(v.samples,0,function(){ae.decryptAndRemuxAvc(v,S,I,N,M,V,z)})}else this.decryptAndRemuxAvc(v,S,I,N,M,V,z)},k.decryptAndRemuxAvc=function(v,S,I,N,M,V,z){if(S.samples){var ae=this;this.sampleAes.decryptAvcSamples(S.samples,0,0,function(){ae.remuxer.remux(v,S,I,N,M,V,z)})}else this.remuxer.remux(v,S,I,N,M,V,z)},k.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},k._parsePAT=function(v,S){return(v[S+10]&31)<<8|v[S+11]},k._trackUnknownPmt=function(v,S,I){var N=this.pmtUnknownTypes[v]||0;return N===0&&(this.pmtUnknownTypes[v]=0,S.call(m.logger,I)),this.pmtUnknownTypes[v]++,N},k._parsePMT=function(v,S,I,N){var M,V,z,ae,le={audio:-1,avc:-1,id3:-1,isAAC:!0};for(M=(v[S+1]&15)<<8|v[S+2],V=S+3+M-4,z=(v[S+10]&15)<<8|v[S+11],S+=12+z;S<V;){switch(ae=(v[S+1]&31)<<8|v[S+2],v[S]){case 207:if(!N){this._trackUnknownPmt(v[S],m.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:le.audio===-1&&(le.audio=ae);break;case 21:le.id3===-1&&(le.id3=ae);break;case 219:if(!N){this._trackUnknownPmt(v[S],m.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:le.avc===-1&&(le.avc=ae);break;case 3:case 4:I?le.audio===-1&&(le.audio=ae,le.isAAC=!1):this._trackUnknownPmt(v[S],m.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(v[S],m.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(v[S],m.logger.log,"Unknown stream type:"+v[S]);break}S+=((v[S+3]&15)<<8|v[S+4])+5}return le},k._parsePES=function(v){var S=0,I,N,M,V,z,ae,le,ne,ve,de=v.data;if(!v||v.size===0)return null;for(;de[0].length<19&&de.length>1;){var me=new Uint8Array(de[0].length+de[1].length);me.set(de[0]),me.set(de[1],de[0].length),de[0]=me,de.splice(1,1)}if(I=de[0],M=(I[0]<<16)+(I[1]<<8)+I[2],M===1){if(V=(I[4]<<8)+I[5],V&&V>v.size-6||(N=I[7],N&192&&(le=(I[9]&14)*536870912+(I[10]&255)*4194304+(I[11]&254)*16384+(I[12]&255)*128+(I[13]&254)/2,N&64?(ne=(I[14]&14)*536870912+(I[15]&255)*4194304+(I[16]&254)*16384+(I[17]&255)*128+(I[18]&254)/2,le-ne>60*9e4&&(m.logger.warn(Math.round((le-ne)/9e4)+"s delta between PTS and DTS, align them"),le=ne)):ne=le),z=I[8],ve=z+9,v.size<=ve))return null;v.size-=ve,ae=new Uint8Array(v.size);for(var ce=0,we=de.length;ce<we;ce++){I=de[ce];var Le=I.byteLength;if(ve)if(ve>Le){ve-=Le;continue}else I=I.subarray(ve),Le-=ve,ve=0;ae.set(I,S),S+=Le}return V&&(V-=z+3),{data:ae,pts:le,dts:ne,len:V}}else return null},k.pushAccesUnit=function(v,S){if(v.units.length&&v.frame){var I=S.samples,N=I.length;if(isNaN(v.pts))if(N){var M=I[N-1];v.pts=M.pts,v.dts=M.dts}else{S.dropped++;return}!this.config.forceKeyFrameOnDiscontinuity||v.key===!0||S.sps&&(N||this.contiguous)?(v.id=N,I.push(v)):S.dropped++}v.debug.length&&m.logger.log(v.pts+"/"+v.dts+":"+v.debug)},k._parseAVCPES=function(v,S){var I=this,N=this._avcTrack,M=this._parseAVCNALu(v.data),V,z=this.avcSample,ae,le=!1,ne,ve=this.pushAccesUnit.bind(this),de=function(ce,we,Le,Ve){return{key:ce,pts:we,dts:Le,units:[],debug:Ve}};v.data=null,z&&M.length&&!N.audFound&&(ve(z,N),z=this.avcSample=de(!1,v.pts,v.dts,"")),M.forEach(function(me){switch(me.type){case 1:ae=!0,z||(z=I.avcSample=de(!0,v.pts,v.dts,"")),z.frame=!0;var ce=me.data;if(le&&ce.length>4){var we=new Z(ce).readSliceType();(we===2||we===4||we===7||we===9)&&(z.key=!0)}break;case 5:ae=!0,z||(z=I.avcSample=de(!0,v.pts,v.dts,"")),z.key=!0,z.frame=!0;break;case 6:ae=!0,V=new Z(I.discardEPB(me.data)),V.readUByte();for(var Le=0,Ve=0,et=!1,Ge=0;!et&&V.bytesAvailable>1;){Le=0;do Ge=V.readUByte(),Le+=Ge;while(Ge===255);Ve=0;do Ge=V.readUByte(),Ve+=Ge;while(Ge===255);if(Le===4&&V.bytesAvailable!==0){et=!0;var ut=V.readUByte();if(ut===181){var Qe=V.readUShort();if(Qe===49){var Ye=V.readUInt();if(Ye===1195456820){var tt=V.readUByte();if(tt===3){var nt=V.readUByte(),kt=V.readUByte(),bt=31&nt,ct=[nt,kt];for(ne=0;ne<bt;ne++)ct.push(V.readUByte()),ct.push(V.readUByte()),ct.push(V.readUByte());I._insertSampleInOrder(I._txtTrack.samples,{type:3,pts:v.pts,bytes:ct})}}}}}else if(Le===5&&V.bytesAvailable!==0){if(et=!0,Ve>16){var Lt=[];for(ne=0;ne<16;ne++)Lt.push(V.readUByte().toString(16)),(ne===3||ne===5||ne===7||ne===9)&&Lt.push("-");var Tt=Ve-16,Pt=new Uint8Array(Tt);for(ne=0;ne<Tt;ne++)Pt[ne]=V.readUByte();I._insertSampleInOrder(I._txtTrack.samples,{pts:v.pts,payloadType:Le,uuid:Lt.join(""),userDataBytes:Pt,userData:Object(re.utf8ArrayToStr)(Pt.buffer)})}}else if(Ve<V.bytesAvailable)for(ne=0;ne<Ve;ne++)V.readUByte()}break;case 7:if(ae=!0,le=!0,!N.sps){V=new Z(me.data);var yt=V.readSPS();N.width=yt.width,N.height=yt.height,N.pixelRatio=yt.pixelRatio,N.sps=[me.data],N.duration=I._duration;var ft=me.data.subarray(1,4),qt="avc1.";for(ne=0;ne<3;ne++){var Zt=ft[ne].toString(16);Zt.length<2&&(Zt="0"+Zt),qt+=Zt}N.codec=qt}break;case 8:ae=!0,N.pps||(N.pps=[me.data]);break;case 9:ae=!1,N.audFound=!0,z&&ve(z,N),z=I.avcSample=de(!1,v.pts,v.dts,"");break;case 12:ae=!1;break;default:ae=!1,z&&(z.debug+="unknown NAL "+me.type+" ");break}if(z&&ae){var Bt=z.units;Bt.push(me)}}),S&&z&&(ve(z,N),this.avcSample=null)},k._insertSampleInOrder=function(v,S){var I=v.length;if(I>0){if(S.pts>=v[I-1].pts)v.push(S);else for(var N=I-1;N>=0;N--)if(S.pts<v[N].pts){v.splice(N,0,S);break}}else v.push(S)},k._getLastNalUnit=function(){var v=this.avcSample,S;if(!v||v.units.length===0){var I=this._avcTrack,N=I.samples;v=N[N.length-1]}if(v){var M=v.units;S=M[M.length-1]}return S},k._parseAVCNALu=function(v){var S=0,I=v.byteLength,N,M,V=this._avcTrack,z=V.naluState||0,ae=z,le=[],ne,ve,de=-1,me;for(z===-1&&(de=0,me=v[0]&31,z=0,S=1);S<I;){if(N=v[S++],!z){z=N?0:1;continue}if(z===1){z=N?0:2;continue}if(!N)z=3;else if(N===1){if(de>=0)ne={data:v.subarray(de,S-z-1),type:me},le.push(ne);else{var ce=this._getLastNalUnit();if(ce&&(ae&&S<=4-ae&&ce.state&&(ce.data=ce.data.subarray(0,ce.data.byteLength-ae)),M=S-z-1,M>0)){var we=new Uint8Array(ce.data.byteLength+M);we.set(ce.data,0),we.set(v.subarray(0,M),ce.data.byteLength),ce.data=we}}S<I?(ve=v[S]&31,de=S,me=ve,z=0):z=-1}else z=0}if(de>=0&&z>=0&&(ne={data:v.subarray(de,I),type:me,state:z},le.push(ne)),le.length===0){var Le=this._getLastNalUnit();if(Le){var Ve=new Uint8Array(Le.data.byteLength+v.byteLength);Ve.set(Le.data,0),Ve.set(v,Le.data.byteLength),Le.data=Ve}}return V.naluState=z,le},k.discardEPB=function(v){for(var S=v.byteLength,I=[],N=1,M,V;N<S-2;)v[N]===0&&v[N+1]===0&&v[N+2]===3?(I.push(N+2),N+=2):N++;if(I.length===0)return v;M=S-I.length,V=new Uint8Array(M);var z=0;for(N=0;N<M;z++,N++)z===I[0]&&(z++,I.shift()),V[N]=v[z];return V},k._parseAACPES=function(v){var S=this._audioTrack,I=v.data,N=v.pts,M=0,V=this.aacOverFlow,z=this.aacLastPTS,ae,le,ne,ve,de;if(V){var me=new Uint8Array(V.byteLength+I.byteLength);me.set(V,0),me.set(I,V.byteLength),I=me}for(ne=M,de=I.length;ne<de-1&&!F(I,ne);ne++);if(ne){var ce,we;if(ne<de-1?(ce="AAC PES did not start with ADTS header,offset:"+ne,we=!1):(ce="no ADTS header found in AAC PES",we=!0),m.logger.warn("parsing error:"+ce),this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:we,reason:ce}),we)return}if($(S,this.observer,I,ne,this.audioCodec),le=0,ae=X(S.samplerate),V&&z){var Le=z+ae;Math.abs(Le-N)>1&&(m.logger.log("AAC: align PTS for overlapping frames by "+Math.round((Le-N)/90)),N=Le)}for(;ne<de;)if(F(I,ne)){if(ne+5<de){var Ve=J(S,I,ne,N,le);if(Ve){ne+=Ve.length,ve=Ve.sample.pts,le++;continue}}break}else ne++;ne<de?V=I.subarray(ne,de):V=null,this.aacOverFlow=V,this.aacLastPTS=ve},k._parseMPEGPES=function(v){for(var S=v.data,I=S.length,N=0,M=0,V=v.pts;M<I;)if(W.isHeader(S,M)){var z=W.appendFrame(this._audioTrack,S,M,V,N);if(z)M+=z.length,N++;else break}else M++},k._parseID3PES=function(v){this._id3Track.samples.push(v)},_}(),Ee=Ae,Te=function(){function _(R,v,S){this.observer=R,this.config=S,this.remuxer=v}var k=_.prototype;return k.resetInitSegment=function(v,S,I,N){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:S,duration:N,inputTimeScale:9e4}},k.resetTimeStamp=function(){},_.probe=function(v){var S,I,N=re.default.getID3Data(v,0);if(N&&re.default.getTimeStamp(N)!==void 0){for(S=N.length,I=Math.min(v.length-1,S+100);S<I;S++)if(W.probe(v,S))return m.logger.log("MPEG Audio sync word found !"),!0}return!1},k.append=function(v,S,I,N){for(var M=re.default.getID3Data(v,0)||[],V=re.default.getTimeStamp(M),z=V!==void 0?90*V:S*9e4,ae=M.length,le=v.length,ne=0,ve=0,de=this._audioTrack,me=[{pts:z,dts:z,data:M}];ae<le;)if(W.isHeader(v,ae)){var ce=W.appendFrame(de,v,ae,z,ne);if(ce)ae+=ce.length,ve=ce.sample.pts,ne++;else break}else re.default.isHeader(v,ae)?(M=re.default.getID3Data(v,ae),me.push({pts:ve,dts:ve,data:M}),ae+=M.length):ae++;this.remuxer.remux(de,{samples:[]},{samples:me,inputTimeScale:9e4},{samples:[]},S,I,N)},k.destroy=function(){},_}(),Re=Te,Pe=function(){function _(){}return _.getSilentFrame=function(R,v){switch(R){case"mp4a.40.2":if(v===1)return new Uint8Array([0,200,0,128,35,128]);if(v===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(v===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(v===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(v===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(v===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(v===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}return null},_}(),Oe=Pe,ke=Math.pow(2,32)-1,Ne=function(){function _(){}return _.init=function(){_.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var R;for(R in _.types)_.types.hasOwnProperty(R)&&(_.types[R]=[R.charCodeAt(0),R.charCodeAt(1),R.charCodeAt(2),R.charCodeAt(3)]);var v=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),S=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);_.HDLR_TYPES={video:v,audio:S};var I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),N=new Uint8Array([0,0,0,0,0,0,0,0]);_.STTS=_.STSC=_.STCO=N,_.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),_.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),_.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),_.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var M=new Uint8Array([105,115,111,109]),V=new Uint8Array([97,118,99,49]),z=new Uint8Array([0,0,0,1]);_.FTYP=_.box(_.types.ftyp,M,z,M,V),_.DINF=_.box(_.types.dinf,_.box(_.types.dref,I))},_.box=function(R){for(var v=Array.prototype.slice.call(arguments,1),S=8,I=v.length,N=I,M;I--;)S+=v[I].byteLength;for(M=new Uint8Array(S),M[0]=S>>24&255,M[1]=S>>16&255,M[2]=S>>8&255,M[3]=S&255,M.set(R,4),I=0,S=8;I<N;I++)M.set(v[I],S),S+=v[I].byteLength;return M},_.hdlr=function(R){return _.box(_.types.hdlr,_.HDLR_TYPES[R])},_.mdat=function(R){return _.box(_.types.mdat,R)},_.mdhd=function(R,v){v*=R;var S=Math.floor(v/(ke+1)),I=Math.floor(v%(ke+1));return _.box(_.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,R>>24&255,R>>16&255,R>>8&255,R&255,S>>24,S>>16&255,S>>8&255,S&255,I>>24,I>>16&255,I>>8&255,I&255,85,196,0,0]))},_.mdia=function(R){return _.box(_.types.mdia,_.mdhd(R.timescale,R.duration),_.hdlr(R.type),_.minf(R))},_.mfhd=function(R){return _.box(_.types.mfhd,new Uint8Array([0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255]))},_.minf=function(R){return R.type==="audio"?_.box(_.types.minf,_.box(_.types.smhd,_.SMHD),_.DINF,_.stbl(R)):_.box(_.types.minf,_.box(_.types.vmhd,_.VMHD),_.DINF,_.stbl(R))},_.moof=function(R,v,S){return _.box(_.types.moof,_.mfhd(R),_.traf(S,v))},_.moov=function(R){for(var v=R.length,S=[];v--;)S[v]=_.trak(R[v]);return _.box.apply(null,[_.types.moov,_.mvhd(R[0].timescale,R[0].duration)].concat(S).concat(_.mvex(R)))},_.mvex=function(R){for(var v=R.length,S=[];v--;)S[v]=_.trex(R[v]);return _.box.apply(null,[_.types.mvex].concat(S))},_.mvhd=function(R,v){v*=R;var S=Math.floor(v/(ke+1)),I=Math.floor(v%(ke+1)),N=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,R>>24&255,R>>16&255,R>>8&255,R&255,S>>24,S>>16&255,S>>8&255,S&255,I>>24,I>>16&255,I>>8&255,I&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return _.box(_.types.mvhd,N)},_.sdtp=function(R){var v=R.samples||[],S=new Uint8Array(4+v.length),I,N;for(N=0;N<v.length;N++)I=v[N].flags,S[N+4]=I.dependsOn<<4|I.isDependedOn<<2|I.hasRedundancy;return _.box(_.types.sdtp,S)},_.stbl=function(R){return _.box(_.types.stbl,_.stsd(R),_.box(_.types.stts,_.STTS),_.box(_.types.stsc,_.STSC),_.box(_.types.stsz,_.STSZ),_.box(_.types.stco,_.STCO))},_.avc1=function(R){var v=[],S=[],I,N,M;for(I=0;I<R.sps.length;I++)N=R.sps[I],M=N.byteLength,v.push(M>>>8&255),v.push(M&255),v=v.concat(Array.prototype.slice.call(N));for(I=0;I<R.pps.length;I++)N=R.pps[I],M=N.byteLength,S.push(M>>>8&255),S.push(M&255),S=S.concat(Array.prototype.slice.call(N));var V=_.box(_.types.avcC,new Uint8Array([1,v[3],v[4],v[5],255,224|R.sps.length].concat(v).concat([R.pps.length]).concat(S))),z=R.width,ae=R.height,le=R.pixelRatio[0],ne=R.pixelRatio[1];return _.box(_.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,z>>8&255,z&255,ae>>8&255,ae&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),V,_.box(_.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),_.box(_.types.pasp,new Uint8Array([le>>24,le>>16&255,le>>8&255,le&255,ne>>24,ne>>16&255,ne>>8&255,ne&255])))},_.esds=function(R){var v=R.config.length;return new Uint8Array([0,0,0,0,3,23+v,0,1,0,4,15+v,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([v]).concat(R.config).concat([6,1,2]))},_.mp4a=function(R){var v=R.samplerate;return _.box(_.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,R.channelCount,0,16,0,0,0,0,v>>8&255,v&255,0,0]),_.box(_.types.esds,_.esds(R)))},_.mp3=function(R){var v=R.samplerate;return _.box(_.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,R.channelCount,0,16,0,0,0,0,v>>8&255,v&255,0,0]))},_.stsd=function(R){return R.type==="audio"?!R.isAAC&&R.codec==="mp3"?_.box(_.types.stsd,_.STSD,_.mp3(R)):_.box(_.types.stsd,_.STSD,_.mp4a(R)):_.box(_.types.stsd,_.STSD,_.avc1(R))},_.tkhd=function(R){var v=R.id,S=R.duration*R.timescale,I=R.width,N=R.height,M=Math.floor(S/(ke+1)),V=Math.floor(S%(ke+1));return _.box(_.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,v>>24&255,v>>16&255,v>>8&255,v&255,0,0,0,0,M>>24,M>>16&255,M>>8&255,M&255,V>>24,V>>16&255,V>>8&255,V&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,I>>8&255,I&255,0,0,N>>8&255,N&255,0,0]))},_.traf=function(R,v){var S=_.sdtp(R),I=R.id,N=Math.floor(v/(ke+1)),M=Math.floor(v%(ke+1));return _.box(_.types.traf,_.box(_.types.tfhd,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,I&255])),_.box(_.types.tfdt,new Uint8Array([1,0,0,0,N>>24,N>>16&255,N>>8&255,N&255,M>>24,M>>16&255,M>>8&255,M&255])),_.trun(R,S.length+16+20+8+16+8+8),S)},_.trak=function(R){return R.duration=R.duration||4294967295,_.box(_.types.trak,_.tkhd(R),_.mdia(R))},_.trex=function(R){var v=R.id;return _.box(_.types.trex,new Uint8Array([0,0,0,0,v>>24,v>>16&255,v>>8&255,v&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},_.trun=function(R,v){var S=R.samples||[],I=S.length,N=12+16*I,M=new Uint8Array(N),V,z,ae,le,ne,ve;for(v+=8+N,M.set([0,0,15,1,I>>>24&255,I>>>16&255,I>>>8&255,I&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255],0),V=0;V<I;V++)z=S[V],ae=z.duration,le=z.size,ne=z.flags,ve=z.cts,M.set([ae>>>24&255,ae>>>16&255,ae>>>8&255,ae&255,le>>>24&255,le>>>16&255,le>>>8&255,le&255,ne.isLeading<<2|ne.dependsOn,ne.isDependedOn<<6|ne.hasRedundancy<<4|ne.paddingValue<<1|ne.isNonSync,ne.degradPrio&240<<8,ne.degradPrio&15,ve>>>24&255,ve>>>16&255,ve>>>8&255,ve&255],12+16*V);return _.box(_.types.trun,M)},_.initSegment=function(R){_.types||_.init();var v=_.moov(R),S;return S=new Uint8Array(_.FTYP.byteLength+v.byteLength),S.set(_.FTYP),S.set(v,_.FTYP.byteLength),S},_}(),qe=Ne,mt=9e4;function dt(_,k,R,v){R===void 0&&(R=1),v===void 0&&(v=!1);var S=_*k*R;return v?Math.round(S):S}function Me(_,k){return k===void 0&&(k=!1),dt(_,1e3,1/mt,k)}function st(_,k){return k===void 0&&(k=1),dt(_,mt,1/k)}var ot=st(10),pt=st(.2),St=null,B=function(){function _(R,v,S,I){if(this.observer=R,this.config=v,this.typeSupported=S,this.ISGenerated=!1,St===null){var N=navigator.userAgent.match(/Chrome\/(\d+)/i);St=N?parseInt(N[1]):0}}var k=_.prototype;return k.destroy=function(){},k.resetTimeStamp=function(v){this._initPTS=this._initDTS=v},k.resetInitSegment=function(){this.ISGenerated=!1},k.getVideoStartPts=function(v){var S=!1,I=v.reduce(function(N,M){var V=M.pts-N;return V<-4294967296?(S=!0,G(N,M.pts)):V>0?N:M.pts},v[0].pts);return S&&m.logger.debug("PTS rollover detected"),I},k.remux=function(v,S,I,N,M,V,z){if(this.ISGenerated||this.generateIS(v,S,M),this.ISGenerated){var ae=v.samples.length,le=S.samples.length,ne=M,ve=M;if(ae&&le){var de=this.getVideoStartPts(S.samples),me=G(v.samples[0].pts,de)-de,ce=me/S.inputTimeScale;ne+=Math.max(0,ce),ve+=Math.max(0,-ce)}if(ae){v.timescale||(m.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(v,S,M));var we=this.remuxAudio(v,ne,V,z);if(le){var Le;we&&(Le=we.endPTS-we.startPTS),S.timescale||(m.logger.warn("regenerate InitSegment as video detected"),this.generateIS(v,S,M)),this.remuxVideo(S,ve,V,Le)}}else if(le){var Ve=this.remuxVideo(S,ve,V,0,z);Ve&&v.codec&&this.remuxEmptyAudio(v,ne,V,Ve)}}I.samples.length&&this.remuxID3(I,M),N.samples.length&&this.remuxText(N,M),this.observer.trigger(l.default.FRAG_PARSED)},k.generateIS=function(v,S,I){var N=this.observer,M=v.samples,V=S.samples,z=this.typeSupported,ae="audio/mp4",le={},ne={tracks:le},ve=this._initPTS===void 0,de,me;if(ve&&(de=me=1/0),v.config&&M.length&&(v.timescale=v.samplerate,m.logger.log("audio sampling rate : "+v.samplerate),v.isAAC||(z.mpeg?(ae="audio/mpeg",v.codec=""):z.mp3&&(v.codec="mp3")),le.audio={container:ae,codec:v.codec,initSegment:!v.isAAC&&z.mpeg?new Uint8Array:qe.initSegment([v]),metadata:{channelCount:v.channelCount}},ve&&(de=me=M[0].pts-Math.round(v.inputTimeScale*I))),S.sps&&S.pps&&V.length){var ce=S.inputTimeScale;if(S.timescale=ce,le.video={container:"video/mp4",codec:S.codec,initSegment:qe.initSegment([S]),metadata:{width:S.width,height:S.height}},ve){var we=this.getVideoStartPts(V),Le=Math.round(ce*I);me=Math.min(me,G(V[0].dts,we)-Le),de=Math.min(de,we-Le),this.observer.trigger(l.default.INIT_PTS_FOUND,{initPTS:de})}}else ve&&le.audio&&this.observer.trigger(l.default.INIT_PTS_FOUND,{initPTS:de});Object.keys(le).length?(N.trigger(l.default.FRAG_PARSING_INIT_SEGMENT,ne),this.ISGenerated=!0,ve&&(this._initPTS=de,this._initDTS=me)):N.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},k.remuxVideo=function(v,S,I,N){var M=v.timescale,V=v.samples,z=[],ae=V.length,le=this._initPTS,ne=8,ve,de,me,ce,we,Le=Number.POSITIVE_INFINITY,Ve=Number.NEGATIVE_INFINITY,et=0,Ge=!1,ut=this.nextAvcDts;if(ae!==0){if(!I){var Qe=S*M,Ye=V[0].pts-G(V[0].dts,V[0].pts);ut=Qe-Ye}for(var tt=0;tt<ae;tt++){var nt=V[tt];nt.pts=G(nt.pts-le,ut),nt.dts=G(nt.dts-le,ut),nt.dts>nt.pts&&(et=Math.max(Math.min(et,nt.pts-nt.dts),-1*pt)),nt.dts<V[tt>0?tt-1:tt].dts&&(Ge=!0)}Ge&&V.sort(function(nn,Cn){var Pi=nn.dts-Cn.dts,Ni=nn.pts-Cn.pts;return Pi||Ni||nn.id-Cn.id}),ce=V[0].dts,we=V[ae-1].dts;var kt=Math.round((we-ce)/(ae-1));if(et<0){if(et<kt*-2){m.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Me(-kt,!0)+" ms");for(var bt=et,ct=0;ct<ae;ct++)V[ct].dts=bt=Math.max(bt,V[ct].pts-kt),V[ct].pts=Math.max(bt,V[ct].pts)}else{m.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Me(et,!0)+" ms to overcome this issue");for(var Lt=0;Lt<ae;Lt++)V[Lt].dts=V[Lt].dts+et}ce=V[0].dts,we=V[ae-1].dts}if(I){var Tt=ce-ut,Pt=Tt>kt,yt=Tt<-1;if(Pt||yt){Pt?m.logger.warn("AVC: "+Me(Tt,!0)+" ms ("+Tt+"dts) hole between fragments detected, filling it"):m.logger.warn("AVC: "+Me(-Tt,!0)+" ms ("+Tt+"dts) overlapping between fragments detected"),ce=ut;var ft=V[0].pts-Tt;V[0].dts=ce,V[0].pts=ft,m.logger.log("Video: First PTS/DTS adjusted: "+Me(ft,!0)+"/"+Me(ce,!0)+", delta: "+Me(Tt,!0)+" ms")}}St&&St<75&&(ce=Math.max(0,ce));for(var qt=0,Zt=0,Bt=0;Bt<ae;Bt++){for(var Rt=V[Bt],Wt=Rt.units,Qt=Wt.length,sr=0,Fr=0;Fr<Qt;Fr++)sr+=Wt[Fr].data.length;Zt+=sr,qt+=Qt,Rt.length=sr,Rt.dts=Math.max(Rt.dts,ce),Rt.pts=Math.max(Rt.pts,Rt.dts,0),Le=Math.min(Rt.pts,Le),Ve=Math.max(Rt.pts,Ve)}we=V[ae-1].dts;var or=Zt+4*qt+8;try{de=new Uint8Array(or)}catch{this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MUX_ERROR,details:f.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:or,reason:"fail allocating video mdat "+or});return}var Mr=new DataView(de.buffer);Mr.setUint32(0,or),de.set(qe.types.mdat,4);for(var te=0;te<ae;te++){for(var Nt=V[te],Sr=Nt.units,Br=0,Jt=void 0,Sn=0,Oi=Sr.length;Sn<Oi;Sn++){var Wn=Sr[Sn],$n=Wn.data,kn=Wn.data.byteLength;Mr.setUint32(ne,kn),ne+=4,de.set($n,ne),ne+=kn,Br+=4+kn}if(te<ae-1)ve=V[te+1].dts-Nt.dts;else{var Xn=this.config,Ur=Nt.dts-V[te>0?te-1:te].dts;if(Xn.stretchShortVideoTrack){var Di=Xn.maxBufferHole,Rn=Math.floor(Di*M),rn=(N?Le+N*M:this.nextAudioPts)-Nt.pts;rn>Rn?(ve=rn-Ur,ve<0&&(ve=Ur),m.logger.log("It is approximately "+Me(rn,!1)+" ms to the next segment; using duration "+Me(ve,!1)+" ms for the last video frame.")):ve=Ur}else ve=Ur}Jt=Math.round(Nt.pts-Nt.dts),z.push({size:Br,duration:ve,cts:Jt,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Nt.key?2:1,isNonSync:Nt.key?0:1}})}this.nextAvcDts=we+ve;var Kr=v.dropped;if(v.nbNalu=0,v.dropped=0,z.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var qn=z[0].flags;qn.dependsOn=2,qn.isNonSync=0}v.samples=z,me=qe.moof(v.sequenceNumber++,ce,v),v.samples=[];var Zn={data1:me,data2:de,startPTS:Le/M,endPTS:(Ve+ve)/M,startDTS:ce/M,endDTS:this.nextAvcDts/M,type:"video",hasAudio:!1,hasVideo:!0,nb:z.length,dropped:Kr};return this.observer.trigger(l.default.FRAG_PARSING_DATA,Zn),Zn}},k.remuxAudio=function(v,S,I,N){var M=v.inputTimeScale,V=v.timescale,z=M/V,ae=v.isAAC?1024:1152,le=ae*z,ne=this._initPTS,ve=!v.isAAC&&this.typeSupported.mpeg,de,me,ce,we,Le,Ve,et=ve?0:8,Ge=v.samples,ut=[],Qe=this.nextAudioPts;if(I|=Ge.length&&Qe&&(N&&Math.abs(S-Qe/M)<.1||Math.abs(Ge[0].pts-Qe-ne)<20*le),Ge.forEach(function(Jt){Jt.pts=Jt.dts=G(Jt.pts-ne,S*M)}),Ge=Ge.filter(function(Jt){return Jt.pts>=0}),Ge.length!==0){if(I||(N?Qe=Math.max(0,S*M):Qe=Ge[0].pts),v.isAAC)for(var Ye=this.config.maxAudioFramesDrift,tt=0,nt=Qe;tt<Ge.length;){var kt=Ge[tt],bt=kt.pts,ct=bt-nt;if(ct<=-Ye*le)I||tt>0?(m.logger.warn("Dropping 1 audio frame @ "+Me(nt,!0)/1e3+"s due to "+Me(ct,!0)+" ms overlap."),Ge.splice(tt,1)):(m.logger.warn("Audio frame @ "+Me(bt,!0)/1e3+"s overlaps nextAudioPts by "+Me(ct,!0)+" ms."),nt=bt+le,tt++);else if(ct>=Ye*le&&ct<ot&&nt){var Lt=Math.round(ct/le);m.logger.warn("Injecting "+Lt+" audio frames @ "+Me(nt,!0)/1e3+"s due to "+Me(ct,!0)+" ms gap.");for(var Tt=0;Tt<Lt;Tt++){var Pt=Math.max(nt,0);me=Oe.getSilentFrame(v.manifestCodec||v.codec,v.channelCount),me||(m.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),me=kt.unit.subarray()),Ge.splice(tt,0,{unit:me,pts:Pt,dts:Pt}),nt+=le,tt++}kt.pts=kt.dts=nt,nt+=le,tt++}else kt.pts=kt.dts=nt,nt+=le,tt++}for(var yt=Ge.length,ft=0;yt--;)ft+=Ge[yt].unit.byteLength;for(var qt=0,Zt=Ge.length;qt<Zt;qt++){var Bt=Ge[qt],Rt=Bt.unit,Wt=Bt.pts;if(Ve!==void 0&&de)de.duration=Math.round((Wt-Ve)/z);else{var Qt=Wt-Qe,sr=0;if(I&&v.isAAC&&Qt){if(Qt>0&&Qt<ot)sr=Math.round((Wt-Qe)/le),m.logger.log(Me(Qt,!0)+" ms hole between AAC samples detected,filling it"),sr>0&&(me=Oe.getSilentFrame(v.manifestCodec||v.codec,v.channelCount),me||(me=Rt.subarray()),ft+=sr*me.length);else if(Qt<-12){m.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+Me(Qe,!0)+" ms / "+Me(Wt,!0)+" ms / "+Me(-Qt,!0)+" ms"),ft-=Rt.byteLength;continue}Wt=Qe}if(Le=Wt,ft>0){ft+=et;try{ce=new Uint8Array(ft)}catch{this.observer.trigger(l.default.ERROR,{type:f.ErrorTypes.MUX_ERROR,details:f.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating audio mdat "+ft});return}if(!ve){var Fr=new DataView(ce.buffer);Fr.setUint32(0,ft),ce.set(qe.types.mdat,4)}}else return;for(var or=0;or<sr;or++)me=Oe.getSilentFrame(v.manifestCodec||v.codec,v.channelCount),me||(m.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),me=Rt.subarray()),ce.set(me,et),et+=me.byteLength,de={size:me.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},ut.push(de)}ce.set(Rt,et);var Mr=Rt.byteLength;et+=Mr,de={size:Mr,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},ut.push(de),Ve=Wt}var te=0;if(yt=ut.length,yt>=2&&(te=ut[yt-2].duration,de.duration=te),yt){this.nextAudioPts=Qe=Ve+z*te,v.samples=ut,ve?we=new Uint8Array:we=qe.moof(v.sequenceNumber++,Le/z,v),v.samples=[];var Nt=Le/M,Sr=Qe/M,Br={data1:we,data2:ce,startPTS:Nt,endPTS:Sr,startDTS:Nt,endDTS:Sr,type:"audio",hasAudio:!0,hasVideo:!1,nb:yt};return this.observer.trigger(l.default.FRAG_PARSING_DATA,Br),Br}return null}},k.remuxEmptyAudio=function(v,S,I,N){var M=v.inputTimeScale,V=v.samplerate?v.samplerate:M,z=M/V,ae=this.nextAudioPts,le=(ae!==void 0?ae:N.startDTS*M)+this._initDTS,ne=N.endDTS*M+this._initDTS,ve=1024,de=z*ve,me=Math.ceil((ne-le)/de),ce=Oe.getSilentFrame(v.manifestCodec||v.codec,v.channelCount);if(m.logger.warn("remux empty Audio"),!ce){m.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}for(var we=[],Le=0;Le<me;Le++){var Ve=le+Le*de;we.push({unit:ce,pts:Ve,dts:Ve})}v.samples=we,this.remuxAudio(v,S,I)},k.remuxID3=function(v,S){var I=v.samples.length;if(!!I){for(var N=v.inputTimeScale,M=this._initPTS,V=this._initDTS,z=0;z<I;z++){var ae=v.samples[z];ae.pts=G(ae.pts-M,S*N)/N,ae.dts=G(ae.dts-V,S*N)/N}this.observer.trigger(l.default.FRAG_PARSING_METADATA,{samples:v.samples}),v.samples=[]}},k.remuxText=function(v,S){var I=v.samples.length,N=v.inputTimeScale,M=this._initPTS;if(I){for(var V=0;V<I;V++){var z=v.samples[V];z.pts=G(z.pts-M,S*N)/N}v.samples.sort(function(ae,le){return ae.pts-le.pts}),this.observer.trigger(l.default.FRAG_PARSING_USERDATA,{samples:v.samples})}v.samples=[]},_}();function G(_,k){var R;if(k===void 0)return _;for(k<_?R=-8589934592:R=8589934592;Math.abs(_-k)>4294967296;)_+=R;return _}var ee=B,ie=function(){function _(R){this.observer=R}var k=_.prototype;return k.destroy=function(){},k.resetTimeStamp=function(){},k.resetInitSegment=function(){},k.remux=function(v,S,I,N,M,V,z,ae){var le=this.observer,ne="";v&&(ne+="audio"),S&&(ne+="video"),le.trigger(l.default.FRAG_PARSING_DATA,{data1:ae,startPTS:M,startDTS:M,type:ne,hasAudio:!!v,hasVideo:!!S,nb:1,dropped:0}),le.trigger(l.default.FRAG_PARSED)},_}(),ue=ie,pe=Object(A.getSelfScope)(),E;try{E=pe.performance.now.bind(pe.performance)}catch{m.logger.debug("Unable to use Performance API on this environment"),E=pe.Date.now}var D=function(){function _(R,v,S,I){this.observer=R,this.typeSupported=v,this.config=S,this.vendor=I}var k=_.prototype;return k.destroy=function(){var v=this.demuxer;v&&v.destroy()},k.push=function(v,S,I,N,M,V,z,ae,le,ne,ve,de){var me=this;if(v.byteLength>0&&S!=null&&S.key!=null&&S.method==="AES-128"){var ce=this.decrypter;ce==null&&(ce=this.decrypter=new g.default(this.observer,this.config));var we=E();ce.decrypt(v,S.key.buffer,S.iv.buffer,function(Le){var Ve=E();me.observer.trigger(l.default.FRAG_DECRYPTED,{stats:{tstart:we,tdecrypt:Ve}}),me.pushDecrypted(new Uint8Array(Le),S,new Uint8Array(I),N,M,V,z,ae,le,ne,ve,de)})}else this.pushDecrypted(new Uint8Array(v),S,new Uint8Array(I),N,M,V,z,ae,le,ne,ve,de)},k.pushDecrypted=function(v,S,I,N,M,V,z,ae,le,ne,ve,de){var me=this.demuxer,ce=this.remuxer;if(!me||z||ae){for(var we=this.observer,Le=this.typeSupported,Ve=this.config,et=[{demux:Ee,remux:ee},{demux:be.default,remux:ue},{demux:ye,remux:ee},{demux:Re,remux:ee}],Ge,ut=0,Qe=et.length;ut<Qe&&(Ge=et[ut],!Ge.demux.probe(v));ut++);if(!Ge){we.trigger(l.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});return}(!ce||!(ce instanceof Ge.remux))&&(ce=new Ge.remux(we,Ve,Le,this.vendor)),(!me||!(me instanceof Ge.demux))&&(me=new Ge.demux(we,ce,Ve,Le),this.probe=Ge.demux.probe),this.demuxer=me,this.remuxer=ce}(z||ae)&&(me.resetInitSegment(I,N,M,ne),ce.resetInitSegment()),z&&(me.resetTimeStamp(de),ce.resetTimeStamp(de)),typeof me.setDecryptData=="function"&&me.setDecryptData(S),me.append(v,V,le,ve)},_}();n.default=D},"./src/demux/demuxer-worker.js":function(a,n,r){r.r(n);var l=r("./src/demux/demuxer-inline.js"),f=r("./src/events.js"),g=r("./src/utils/logger.js"),T=r("./node_modules/eventemitter3/index.js"),m=function(U){var w=new T.EventEmitter;w.trigger=function(F){for(var j=arguments.length,$=new Array(j>1?j-1:0),X=1;X<j;X++)$[X-1]=arguments[X];w.emit.apply(w,[F,F].concat($))},w.off=function(F){for(var j=arguments.length,$=new Array(j>1?j-1:0),X=1;X<j;X++)$[X-1]=arguments[X];w.removeListener.apply(w,[F].concat($))};var L=function(F,j){U.postMessage({event:F,data:j})};U.addEventListener("message",function(K){var F=K.data;switch(F.cmd){case"init":var j=JSON.parse(F.config);U.demuxer=new l.default(w,F.typeSupported,j,F.vendor),Object(g.enableLogs)(j.debug),L("init",null);break;case"demux":U.demuxer.push(F.data,F.decryptdata,F.initSegment,F.audioCodec,F.videoCodec,F.timeOffset,F.discontinuity,F.trackSwitch,F.contiguous,F.duration,F.accurateTimeOffset,F.defaultInitPTS);break}}),w.on(f.default.FRAG_DECRYPTED,L),w.on(f.default.FRAG_PARSING_INIT_SEGMENT,L),w.on(f.default.FRAG_PARSED,L),w.on(f.default.ERROR,L),w.on(f.default.FRAG_PARSING_METADATA,L),w.on(f.default.FRAG_PARSING_USERDATA,L),w.on(f.default.INIT_PTS_FOUND,L),w.on(f.default.FRAG_PARSING_DATA,function(K,F){var j=[],$={event:K,data:F};F.data1&&($.data1=F.data1.buffer,j.push(F.data1.buffer),delete F.data1),F.data2&&($.data2=F.data2.buffer,j.push(F.data2.buffer),delete F.data2),U.postMessage($,j)})};n.default=m},"./src/demux/id3.js":function(a,n,r){r.r(n),r.d(n,"utf8ArrayToStr",function(){return m});var l=r("./src/utils/get-self-scope.js"),f=function(){function A(){}return A.isHeader=function(w,L){return L+10<=w.length&&w[L]===73&&w[L+1]===68&&w[L+2]===51&&w[L+3]<255&&w[L+4]<255&&w[L+6]<128&&w[L+7]<128&&w[L+8]<128&&w[L+9]<128},A.isFooter=function(w,L){return L+10<=w.length&&w[L]===51&&w[L+1]===68&&w[L+2]===73&&w[L+3]<255&&w[L+4]<255&&w[L+6]<128&&w[L+7]<128&&w[L+8]<128&&w[L+9]<128},A.getID3Data=function(w,L){for(var K=L,F=0;A.isHeader(w,L);){F+=10;var j=A._readSize(w,L+6);F+=j,A.isFooter(w,L+10)&&(F+=10),L+=F}if(F>0)return w.subarray(K,K+F)},A._readSize=function(w,L){var K=0;return K=(w[L]&127)<<21,K|=(w[L+1]&127)<<14,K|=(w[L+2]&127)<<7,K|=w[L+3]&127,K},A.getTimeStamp=function(w){for(var L=A.getID3Frames(w),K=0;K<L.length;K++){var F=L[K];if(A.isTimeStampFrame(F))return A._readTimeStamp(F)}},A.isTimeStampFrame=function(w){return w&&w.key==="PRIV"&&w.info==="com.apple.streaming.transportStreamTimestamp"},A._getFrameData=function(w){var L=String.fromCharCode(w[0],w[1],w[2],w[3]),K=A._readSize(w,4),F=10;return{type:L,size:K,data:w.subarray(F,F+K)}},A.getID3Frames=function(w){for(var L=0,K=[];A.isHeader(w,L);){var F=A._readSize(w,L+6);L+=10;for(var j=L+F;L+8<j;){var $=A._getFrameData(w.subarray(L)),X=A._decodeFrame($);X&&K.push(X),L+=$.size+10}A.isFooter(w,L)&&(L+=10)}return K},A._decodeFrame=function(w){return w.type==="PRIV"?A._decodePrivFrame(w):w.type[0]==="W"?A._decodeURLFrame(w):A._decodeTextFrame(w)},A._readTimeStamp=function(w){if(w.data.byteLength===8){var L=new Uint8Array(w.data),K=L[3]&1,F=(L[4]<<23)+(L[5]<<15)+(L[6]<<7)+L[7];return F/=45,K&&(F+=4772185884e-2),Math.round(F)}},A._decodePrivFrame=function(w){if(!(w.size<2)){var L=A._utf8ArrayToStr(w.data,!0),K=new Uint8Array(w.data.subarray(L.length+1));return{key:w.type,info:L,data:K.buffer}}},A._decodeTextFrame=function(w){if(!(w.size<2))if(w.type==="TXXX"){var L=1,K=A._utf8ArrayToStr(w.data.subarray(L),!0);L+=K.length+1;var F=A._utf8ArrayToStr(w.data.subarray(L));return{key:w.type,info:K,data:F}}else{var j=A._utf8ArrayToStr(w.data.subarray(1));return{key:w.type,data:j}}},A._decodeURLFrame=function(w){if(w.type==="WXXX"){if(w.size<2)return;var L=1,K=A._utf8ArrayToStr(w.data.subarray(L),!0);L+=K.length+1;var F=A._utf8ArrayToStr(w.data.subarray(L));return{key:w.type,info:K,data:F}}else{var j=A._utf8ArrayToStr(w.data);return{key:w.type,data:j}}},A._utf8ArrayToStr=function(w,L){L===void 0&&(L=!1);var K=T();if(K){var F=K.decode(w);if(L){var j=F.indexOf("\0");return j!==-1?F.substring(0,j):F}return F.replace(/\0/g,"")}for(var $=w.length,X,se,J,re="",he=0;he<$;){if(X=w[he++],X===0&&L)return re;if(X===0||X===3)continue;switch(X>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:re+=String.fromCharCode(X);break;case 12:case 13:se=w[he++],re+=String.fromCharCode((X&31)<<6|se&63);break;case 14:se=w[he++],J=w[he++],re+=String.fromCharCode((X&15)<<12|(se&63)<<6|(J&63)<<0);break}}return re},A}(),g;function T(){var A=Object(l.getSelfScope)();return!g&&typeof A.TextDecoder<"u"&&(g=new A.TextDecoder("utf-8")),g}var m=f._utf8ArrayToStr;n.default=f},"./src/demux/mp4demuxer.js":function(a,n,r){r.r(n);var l=r("./src/utils/logger.js"),f=r("./src/events.js"),g=Math.pow(2,32)-1,T=function(){function m(U,w){this.observer=U,this.remuxer=w}var A=m.prototype;return A.resetTimeStamp=function(w){this.initPTS=w},A.resetInitSegment=function(w,L,K,F){if(w&&w.byteLength){var j=this.initData=m.parseInitSegment(w);L==null&&(L="mp4a.40.5"),K==null&&(K="avc1.42e01e");var $={};j.audio&&j.video?$.audiovideo={container:"video/mp4",codec:L+","+K,initSegment:F?w:null}:(j.audio&&($.audio={container:"audio/mp4",codec:L,initSegment:F?w:null}),j.video&&($.video={container:"video/mp4",codec:K,initSegment:F?w:null})),this.observer.trigger(f.default.FRAG_PARSING_INIT_SEGMENT,{tracks:$})}else L&&(this.audioCodec=L),K&&(this.videoCodec=K)},m.probe=function(w){return m.findBox({data:w,start:0,end:Math.min(w.length,16384)},["moof"]).length>0},m.bin2str=function(w){return String.fromCharCode.apply(null,w)},m.readUint16=function(w,L){w.data&&(L+=w.start,w=w.data);var K=w[L]<<8|w[L+1];return K<0?65536+K:K},m.readUint32=function(w,L){w.data&&(L+=w.start,w=w.data);var K=w[L]<<24|w[L+1]<<16|w[L+2]<<8|w[L+3];return K<0?4294967296+K:K},m.writeUint32=function(w,L,K){w.data&&(L+=w.start,w=w.data),w[L]=K>>24,w[L+1]=K>>16&255,w[L+2]=K>>8&255,w[L+3]=K&255},m.findBox=function(w,L){var K=[],F,j,$,X,se,J,re;if(w.data?(J=w.start,X=w.end,w=w.data):(J=0,X=w.byteLength),!L.length)return null;for(F=J;F<X;)j=m.readUint32(w,F),$=m.bin2str(w.subarray(F+4,F+8)),re=j>1?F+j:X,$===L[0]&&(L.length===1?K.push({data:w,start:F+8,end:re}):(se=m.findBox({data:w,start:F+8,end:re},L.slice(1)),se.length&&(K=K.concat(se)))),F=re;return K},m.parseSegmentIndex=function(w){var L=m.findBox(w,["moov"])[0],K=L?L.end:null,F=0,j=m.findBox(w,["sidx"]),$;if(!j||!j[0])return null;$=[],j=j[0];var X=j.data[0];F=X===0?8:16;var se=m.readUint32(j,F);F+=4;var J=0,re=0;X===0?F+=8:F+=16,F+=2;var he=j.end+re,ye=m.readUint16(j,F);F+=2;for(var be=0;be<ye;be++){var Y=F,W=m.readUint32(j,Y);Y+=4;var ge=W&2147483647,Z=(W&2147483648)>>>31;if(Z===1){console.warn("SIDX has hierarchical references (not supported)");return}var q=m.readUint32(j,Y);Y+=4,$.push({referenceSize:ge,subsegmentDuration:q,info:{duration:q/se,start:he,end:he+ge-1}}),he+=ge,Y+=4,F=Y}return{earliestPresentationTime:J,timescale:se,version:X,referencesCount:ye,references:$,moovEndOffset:K}},m.parseInitSegment=function(w){var L=[],K=m.findBox(w,["moov","trak"]);return K.forEach(function(F){var j=m.findBox(F,["tkhd"])[0];if(j){var $=j.data[j.start],X=$===0?12:20,se=m.readUint32(j,X),J=m.findBox(F,["mdia","mdhd"])[0];if(J){$=J.data[J.start],X=$===0?12:20;var re=m.readUint32(J,X),he=m.findBox(F,["mdia","hdlr"])[0];if(he){var ye=m.bin2str(he.data.subarray(he.start+8,he.start+12)),be={soun:"audio",vide:"video"}[ye];if(be){var Y=m.findBox(F,["mdia","minf","stbl","stsd"]);if(Y.length){Y=Y[0];var W=m.bin2str(Y.data.subarray(Y.start+12,Y.start+16));l.logger.log("MP4Demuxer:"+be+":"+W+" found")}L[se]={timescale:re,type:be},L[be]={timescale:re,id:se}}}}}}),L},m.getStartDTS=function(w,L){var K,F,j;return K=m.findBox(L,["moof","traf"]),F=[].concat.apply([],K.map(function($){return m.findBox($,["tfhd"]).map(function(X){var se,J,re;return se=m.readUint32(X,4),J=w[se].timescale||9e4,re=m.findBox($,["tfdt"]).map(function(he){var ye,be;return ye=he.data[he.start],be=m.readUint32(he,4),ye===1&&(be*=Math.pow(2,32),be+=m.readUint32(he,8)),be})[0],re/J})})),j=Math.min.apply(null,F),isFinite(j)?j:0},m.offsetStartDTS=function(w,L,K){m.findBox(L,["moof","traf"]).map(function(F){return m.findBox(F,["tfhd"]).map(function(j){var $=m.readUint32(j,4),X=w[$].timescale||9e4;m.findBox(F,["tfdt"]).map(function(se){var J=se.data[se.start],re=m.readUint32(se,4);if(J===0)m.writeUint32(se,4,re-K*X);else{re*=Math.pow(2,32),re+=m.readUint32(se,8),re-=K*X,re=Math.max(re,0);var he=Math.floor(re/(g+1)),ye=Math.floor(re%(g+1));m.writeUint32(se,4,he),m.writeUint32(se,8,ye)}})})})},A.append=function(w,L,K,F){var j=this.initData;j||(this.resetInitSegment(w,this.audioCodec,this.videoCodec,!1),j=this.initData);var $,X=this.initPTS;if(X===void 0){var se=m.getStartDTS(j,w);this.initPTS=X=se-L,this.observer.trigger(f.default.INIT_PTS_FOUND,{initPTS:X})}m.offsetStartDTS(j,w,X),$=m.getStartDTS(j,w),this.remuxer.remux(j.audio,j.video,null,null,$,K,F,w)},A.destroy=function(){},m}();n.default=T},"./src/errors.ts":function(a,n,r){r.r(n),r.d(n,"ErrorTypes",function(){return l}),r.d(n,"ErrorDetails",function(){return f});var l;(function(g){g.NETWORK_ERROR="networkError",g.MEDIA_ERROR="mediaError",g.KEY_SYSTEM_ERROR="keySystemError",g.MUX_ERROR="muxError",g.OTHER_ERROR="otherError"})(l||(l={}));var f;(function(g){g.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",g.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",g.KEY_SYSTEM_NO_SESSION="keySystemNoSession",g.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",g.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",g.MANIFEST_LOAD_ERROR="manifestLoadError",g.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",g.MANIFEST_PARSING_ERROR="manifestParsingError",g.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",g.LEVEL_EMPTY_ERROR="levelEmptyError",g.LEVEL_LOAD_ERROR="levelLoadError",g.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",g.LEVEL_SWITCH_ERROR="levelSwitchError",g.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",g.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",g.FRAG_LOAD_ERROR="fragLoadError",g.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",g.FRAG_DECRYPT_ERROR="fragDecryptError",g.FRAG_PARSING_ERROR="fragParsingError",g.REMUX_ALLOC_ERROR="remuxAllocError",g.KEY_LOAD_ERROR="keyLoadError",g.KEY_LOAD_TIMEOUT="keyLoadTimeOut",g.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",g.BUFFER_APPEND_ERROR="bufferAppendError",g.BUFFER_APPENDING_ERROR="bufferAppendingError",g.BUFFER_STALLED_ERROR="bufferStalledError",g.BUFFER_FULL_ERROR="bufferFullError",g.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",g.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",g.INTERNAL_EXCEPTION="internalException"})(f||(f={}))},"./src/events.js":function(a,n,r){r.r(n);var l={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"};n.default=l},"./src/hls.ts":function(a,n,r){r.r(n),r.d(n,"default",function(){return xs});var l={};r.r(l),r.d(l,"newCue",function(){return Eu});var f=r("./node_modules/url-toolkit/src/url-toolkit.js"),g=r("./src/errors.ts"),T=r("./src/polyfills/number.js"),m=r("./src/events.js"),A=r("./src/utils/logger.js"),U={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},w=function(){function p(u){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=u,this.onEvent=this.onEvent.bind(this);for(var o=arguments.length,e=new Array(o>1?o-1:0),s=1;s<o;s++)e[s-1]=arguments[s];this.handledEvents=e,this.useGenericHandler=!0,this.registerListeners()}var d=p.prototype;return d.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},d.onHandlerDestroying=function(){},d.onHandlerDestroyed=function(){},d.isEventHandler=function(){return typeof this.handledEvents=="object"&&this.handledEvents.length&&typeof this.onEvent=="function"},d.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(o){if(U[o])throw new Error("Forbidden event-name: "+o);this.hls.on(o,this.onEvent)},this)},d.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(o){this.hls.off(o,this.onEvent)},this)},d.onEvent=function(o,e){this.onEventGeneric(o,e)},d.onEventGeneric=function(o,e){var s=function(h,y){var b="on"+h.replace("hls","");if(typeof this[b]!="function")throw new Error("Event "+h+" has no generic handler in this "+this.constructor.name+" class (tried "+b+")");return this[b].bind(this,y)};try{s.call(this,o,e).call()}catch(c){A.logger.error("An internal error happened while handling event "+o+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:o,err:c})}},p}(),L=w,K;(function(p){p.MANIFEST="manifest",p.LEVEL="level",p.AUDIO_TRACK="audioTrack",p.SUBTITLE_TRACK="subtitleTrack"})(K||(K={}));var F;(function(p){p.MAIN="main",p.AUDIO="audio",p.SUBTITLE="subtitle"})(F||(F={}));var j=r("./src/demux/mp4demuxer.js");function $(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function X(p,d,u){return d&&$(p.prototype,d),u&&$(p,u),p}var se=function(){function p(d,u){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=d,this.reluri=u}return X(p,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(f.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),p}();function J(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function re(p,d,u){return d&&J(p.prototype,d),u&&J(p,u),p}var he;(function(p){p.AUDIO="audio",p.VIDEO="video"})(he||(he={}));var ye=function(){function p(){var u;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=(u={},u[he.AUDIO]=!1,u[he.VIDEO]=!1,u),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var d=p.prototype;return d.setByteRange=function(o,e){var s=o.split("@",2),c=[];s.length===1?c[0]=e?e.byteRangeEndOffset:0:c[0]=parseInt(s[1]),c[1]=parseInt(s[0])+c[0],this._byteRange=c},d.addElementaryStream=function(o){this._elementaryStreams[o]=!0},d.hasElementaryStream=function(o){return this._elementaryStreams[o]===!0},d.createInitializationVector=function(o){for(var e=new Uint8Array(16),s=12;s<16;s++)e[s]=o>>8*(15-s)&255;return e},d.setDecryptDataFromLevelKey=function(o,e){var s=o;return(o==null?void 0:o.method)&&o.uri&&!o.iv&&(s=new se(o.baseuri,o.reluri),s.method=o.method,s.iv=this.createInitializationVector(e)),s},re(p,[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(f.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(o){this._url=o}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var o=this.sn;typeof o!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&A.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),o=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,o)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(T.isFiniteNumber)(this.programDateTime))return null;var o=Object(T.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+o*1e3}},{key:"encrypted",get:function(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}]),p}();function be(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Y(p,d,u){return d&&be(p.prototype,d),u&&be(p,u),p}var W=function(){function p(d){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=d,this.version=null}return Y(p,[{key:"hasProgramDateTime",get:function(){return!!(this.fragments[0]&&Object(T.isFiniteNumber)(this.fragments[0].programDateTime))}}]),p}(),ge=/^(\d+)x(\d+)$/,Z=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,q=function(){function p(u){typeof u=="string"&&(u=p.parseAttrList(u));for(var o in u)u.hasOwnProperty(o)&&(this[o]=u[o])}var d=p.prototype;return d.decimalInteger=function(o){var e=parseInt(this[o],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},d.hexadecimalInteger=function(o){if(this[o]){var e=(this[o]||"0x").slice(2);e=(e.length&1?"0":"")+e;for(var s=new Uint8Array(e.length/2),c=0;c<e.length/2;c++)s[c]=parseInt(e.slice(c*2,c*2+2),16);return s}else return null},d.hexadecimalIntegerAsNumber=function(o){var e=parseInt(this[o],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},d.decimalFloatingPoint=function(o){return parseFloat(this[o])},d.enumeratedString=function(o){return this[o]},d.decimalResolution=function(o){var e=ge.exec(this[o]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},p.parseAttrList=function(o){var e,s={};for(Z.lastIndex=0;(e=Z.exec(o))!==null;){var c=e[2],h='"';c.indexOf(h)===0&&c.lastIndexOf(h)===c.length-1&&(c=c.slice(1,-1)),s[e[1]]=c}return s},p}(),oe=q,xe={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function Ae(p,d){var u=xe[d];return!!u&&u[p.slice(0,4)]===!0}function Ee(p,d){return MediaSource.isTypeSupported((d||"video")+'/mp4;codecs="'+p+'"')}var Te=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,Re=/#EXT-X-MEDIA:(.*)/g,Pe=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),Oe=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,ke=/\.(mp4|m4s|m4v|m4a)$/i,Ne=function(){function p(){}return p.findGroup=function(u,o){for(var e=0;e<u.length;e++){var s=u[e];if(s.id===o)return s}},p.convertAVC1ToAVCOTI=function(u){var o=u.split("."),e;return o.length>2?(e=o.shift()+".",e+=parseInt(o.shift()).toString(16),e+=("000"+parseInt(o.shift()).toString(16)).substr(-4)):e=u,e},p.resolve=function(u,o){return f.buildAbsoluteURL(o,u,{alwaysNormalize:!0})},p.parseMasterPlaylist=function(u,o){var e=[],s={},c=!1;Te.lastIndex=0;function h(H,Q){["video","audio"].forEach(function(fe){var _e=H.filter(function(Ce){return Ae(Ce,fe)});if(_e.length){var Ie=_e.filter(function(Ce){return Ce.lastIndexOf("avc1",0)===0||Ce.lastIndexOf("mp4a",0)===0});Q[fe+"Codec"]=Ie.length>0?Ie[0]:_e[0],H=H.filter(function(Ce){return _e.indexOf(Ce)===-1})}}),Q.unknownCodecs=H}for(var y;(y=Te.exec(u))!=null;)if(y[1]){var b={},C=b.attrs=new oe(y[1]);b.url=p.resolve(y[2],o);var O=C.decimalResolution("RESOLUTION");O&&(b.width=O.width,b.height=O.height),b.bitrate=C.decimalInteger("AVERAGE-BANDWIDTH")||C.decimalInteger("BANDWIDTH"),b.name=C.NAME,h([].concat((C.CODECS||"").split(/[ ,]+/)),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=p.convertAVC1ToAVCOTI(b.videoCodec)),e.push(b)}else if(y[3]){var P=new oe(y[3]);P["DATA-ID"]&&(c=!0,s[P["DATA-ID"]]=P)}return{levels:e,sessionData:c?s:null}},p.parseMasterPlaylistMedia=function(u,o,e,s){s===void 0&&(s=[]);var c,h=[],y=0;for(Re.lastIndex=0;(c=Re.exec(u))!==null;){var b=new oe(c[1]);if(b.TYPE===e){var C={attrs:b,id:y++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE,type:e,default:b.DEFAULT==="YES",autoselect:b.AUTOSELECT==="YES",forced:b.FORCED==="YES",lang:b.LANGUAGE};if(b.URI&&(C.url=p.resolve(b.URI,o)),s.length){var O=p.findGroup(s,C.groupId);C.audioCodec=O?O.codec:s[0].codec}h.push(C)}}return h},p.parseLevelPlaylist=function(u,o,e,s,c){var h=0,y=0,b=new W(o),C=0,O=null,P=new ye,H,Q,fe,_e=null;for(Pe.lastIndex=0;(H=Pe.exec(u))!==null;){var Ie=H[1];if(Ie){P.duration=parseFloat(Ie);var Ce=(" "+H[2]).slice(1);P.title=Ce||null,P.tagList.push(Ce?["INF",Ie,Ce]:["INF",Ie])}else if(H[3]){if(Object(T.isFiniteNumber)(P.duration)){var Fe=h++;P.type=s,P.start=y,fe&&(P.levelkey=fe),P.sn=Fe,P.level=e,P.cc=C,P.urlId=c,P.baseurl=o,P.relurl=(" "+H[3]).slice(1),mt(P,O),b.fragments.push(P),O=P,y+=P.duration,P=new ye}}else if(H[4]){var Ke=(" "+H[4]).slice(1);O?P.setByteRange(Ke,O):P.setByteRange(Ke)}else if(H[5])P.rawProgramDateTime=(" "+H[5]).slice(1),P.tagList.push(["PROGRAM-DATE-TIME",P.rawProgramDateTime]),_e===null&&(_e=b.fragments.length);else{if(H=H[0].match(Oe),!H){A.logger.warn("No matches on slow regex match for level playlist!");continue}for(Q=1;Q<H.length&&!(typeof H[Q]<"u");Q++);var Xe=(" "+H[Q+1]).slice(1),gt=(" "+H[Q+2]).slice(1);switch(H[Q]){case"#":P.tagList.push(gt?[Xe,gt]:[Xe]);break;case"PLAYLIST-TYPE":b.type=Xe.toUpperCase();break;case"MEDIA-SEQUENCE":h=b.startSN=parseInt(Xe);break;case"TARGETDURATION":b.targetduration=parseFloat(Xe);break;case"VERSION":b.version=parseInt(Xe);break;case"EXTM3U":break;case"ENDLIST":b.live=!1;break;case"DIS":C++,P.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":C=parseInt(Xe);break;case"KEY":{var Vt=Xe,Ct=new oe(Vt),yr=Ct.enumeratedString("METHOD"),De=Ct.URI,He=Ct.hexadecimalInteger("IV"),At=Ct.KEYFORMAT||"identity";if(At==="com.apple.streamingkeydelivery"){A.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}yr&&(fe=new se(o,De),De&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(yr)>=0&&(fe.method=yr,fe.key=null,fe.iv=He));break}case"START":{var on=new oe(Xe),ln=on.decimalFloatingPoint("TIME-OFFSET");Object(T.isFiniteNumber)(ln)&&(b.startTimeOffset=ln);break}case"MAP":{var Ln=new oe(Xe);P.relurl=Ln.URI,Ln.BYTERANGE&&P.setByteRange(Ln.BYTERANGE),P.baseurl=o,P.level=e,P.type=s,P.sn="initSegment",b.initSegment=P,P=new ye,P.rawProgramDateTime=b.initSegment.rawProgramDateTime;break}default:A.logger.warn("line parsed but not handled: "+H);break}}}return P=O,P&&!P.relurl&&(b.fragments.pop(),y-=P.duration),b.totalduration=y,b.averagetargetduration=y/b.fragments.length,b.endSN=h-1,b.startCC=b.fragments[0]?b.fragments[0].cc:0,b.endCC=C,!b.initSegment&&b.fragments.length&&b.fragments.every(function(ti){return ke.test(ti.relurl)})&&(A.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),P=new ye,P.relurl=b.fragments[0].relurl,P.baseurl=o,P.level=e,P.type=s,P.sn="initSegment",b.initSegment=P,b.needSidxRanges=!0),_e&&qe(b.fragments,_e),b},p}();function qe(p,d){for(var u=p[d],o=d-1;o>=0;o--){var e=p[o];e.programDateTime=u.programDateTime-e.duration*1e3,u=e}}function mt(p,d){p.rawProgramDateTime?p.programDateTime=Date.parse(p.rawProgramDateTime):d!=null&&d.programDateTime&&(p.programDateTime=d.endProgramDateTime),Object(T.isFiniteNumber)(p.programDateTime)||(p.programDateTime=null,p.rawProgramDateTime=null)}function dt(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Me=window,st=Me.performance,ot=function(p){dt(d,p);function d(o){var e;return e=p.call(this,o,m.default.MANIFEST_LOADING,m.default.LEVEL_LOADING,m.default.AUDIO_TRACK_LOADING,m.default.SUBTITLE_TRACK_LOADING)||this,e.loaders={},e}d.canHaveQualityLevels=function(e){return e!==K.AUDIO_TRACK&&e!==K.SUBTITLE_TRACK},d.mapContextToLevelType=function(e){var s=e.type;switch(s){case K.AUDIO_TRACK:return F.AUDIO;case K.SUBTITLE_TRACK:return F.SUBTITLE;default:return F.MAIN}},d.getResponseUrl=function(e,s){var c=e.url;return(c===void 0||c.indexOf("data:")===0)&&(c=s.url),c};var u=d.prototype;return u.createInternalLoader=function(e){var s=this.hls.config,c=s.pLoader,h=s.loader,y=c||h,b=new y(s);return e.loader=b,this.loaders[e.type]=b,b},u.getInternalLoader=function(e){return this.loaders[e.type]},u.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},u.destroyInternalLoaders=function(){for(var e in this.loaders){var s=this.loaders[e];s&&s.destroy(),this.resetInternalLoader(e)}},u.destroy=function(){this.destroyInternalLoaders(),p.prototype.destroy.call(this)},u.onManifestLoading=function(e){this.load({url:e.url,type:K.MANIFEST,level:0,id:null,responseType:"text"})},u.onLevelLoading=function(e){this.load({url:e.url,type:K.LEVEL,level:e.level,id:e.id,responseType:"text"})},u.onAudioTrackLoading=function(e){this.load({url:e.url,type:K.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},u.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:K.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},u.load=function(e){var s=this.hls.config;A.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var c=this.getInternalLoader(e);if(c){var h=c.context;if(h&&h.url===e.url)return A.logger.trace("playlist request ongoing"),!1;A.logger.warn("aborting previous loader for type: "+e.type),c.abort()}var y,b,C,O;switch(e.type){case K.MANIFEST:y=s.manifestLoadingMaxRetry,b=s.manifestLoadingTimeOut,C=s.manifestLoadingRetryDelay,O=s.manifestLoadingMaxRetryTimeout;break;case K.LEVEL:y=0,O=0,C=0,b=s.levelLoadingTimeOut;break;default:y=s.levelLoadingMaxRetry,b=s.levelLoadingTimeOut,C=s.levelLoadingRetryDelay,O=s.levelLoadingMaxRetryTimeout;break}c=this.createInternalLoader(e);var P={timeout:b,maxRetry:y,retryDelay:C,maxRetryDelay:O},H={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return A.logger.debug("Calling internal loader delegate for URL: "+e.url),c.load(e,P,H),!0},u.loadsuccess=function(e,s,c,h){if(h===void 0&&(h=null),c.isSidxRequest){this._handleSidxRequest(e,c),this._handlePlaylistLoaded(e,s,c,h);return}if(this.resetInternalLoader(c.type),typeof e.data!="string")throw new Error('expected responseType of "text" for PlaylistLoader');var y=e.data;if(s.tload=st.now(),y.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(e,c,"no EXTM3U delimiter",h);return}y.indexOf("#EXTINF:")>0||y.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,s,c,h):this._handleMasterPlaylist(e,s,c,h)},u.loaderror=function(e,s,c){c===void 0&&(c=null),this._handleNetworkError(s,c,!1,e)},u.loadtimeout=function(e,s,c){c===void 0&&(c=null),this._handleNetworkError(s,c,!0)},u._handleMasterPlaylist=function(e,s,c,h){var y=this.hls,b=e.data,C=d.getResponseUrl(e,c),O=Ne.parseMasterPlaylist(b,C),P=O.levels,H=O.sessionData;if(!P.length){this._handleManifestParsingError(e,c,"no level found in manifest",h);return}var Q=P.map(function(Fe){return{id:Fe.attrs.AUDIO,codec:Fe.audioCodec}}),fe=Ne.parseMasterPlaylistMedia(b,C,"AUDIO",Q),_e=Ne.parseMasterPlaylistMedia(b,C,"SUBTITLES"),Ie=Ne.parseMasterPlaylistMedia(b,C,"CLOSED-CAPTIONS");if(fe.length){var Ce=!1;fe.forEach(function(Fe){Fe.url||(Ce=!0)}),Ce===!1&&P[0].audioCodec&&!P[0].attrs.AUDIO&&(A.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),fe.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}y.trigger(m.default.MANIFEST_LOADED,{levels:P,audioTracks:fe,subtitles:_e,captions:Ie,url:C,stats:s,networkDetails:h,sessionData:H})},u._handleTrackOrLevelPlaylist=function(e,s,c,h){var y=this.hls,b=c.id,C=c.level,O=c.type,P=d.getResponseUrl(e,c),H=Object(T.isFiniteNumber)(b)?b:0,Q=Object(T.isFiniteNumber)(C)?C:H,fe=d.mapContextToLevelType(c),_e=Ne.parseLevelPlaylist(e.data,P,Q,fe,H);if(_e.tload=s.tload,!_e.fragments.length){y.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:P,reason:"no fragments found in level",level:typeof c.level=="number"?c.level:void 0});return}if(O===K.MANIFEST){var Ie={url:P,details:_e};y.trigger(m.default.MANIFEST_LOADED,{levels:[Ie],audioTracks:[],url:P,stats:s,networkDetails:h,sessionData:null})}if(s.tparsed=st.now(),_e.needSidxRanges){var Ce=_e.initSegment.url;this.load({url:Ce,isSidxRequest:!0,type:O,level:C,levelDetails:_e,id:b,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}c.levelDetails=_e,this._handlePlaylistLoaded(e,s,c,h)},u._handleSidxRequest=function(e,s){if(typeof e.data=="string")throw new Error("sidx request must be made with responseType of array buffer");var c=j.default.parseSegmentIndex(new Uint8Array(e.data));if(!!c){var h=c.references,y=s.levelDetails;h.forEach(function(b,C){var O=b.info;if(!!y){var P=y.fragments[C];P.byteRange.length===0&&P.setByteRange(String(1+O.end-O.start)+"@"+String(O.start))}}),y&&y.initSegment.setByteRange(String(c.moovEndOffset)+"@0")}},u._handleManifestParsingError=function(e,s,c,h){this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:c,networkDetails:h})},u._handleNetworkError=function(e,s,c,h){c===void 0&&(c=!1),h===void 0&&(h=null),A.logger.info("A network error occured while loading a "+e.type+"-type playlist");var y,b,C=this.getInternalLoader(e);switch(e.type){case K.MANIFEST:y=c?g.ErrorDetails.MANIFEST_LOAD_TIMEOUT:g.ErrorDetails.MANIFEST_LOAD_ERROR,b=!0;break;case K.LEVEL:y=c?g.ErrorDetails.LEVEL_LOAD_TIMEOUT:g.ErrorDetails.LEVEL_LOAD_ERROR,b=!1;break;case K.AUDIO_TRACK:y=c?g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,b=!1;break;default:b=!1}C&&(C.abort(),this.resetInternalLoader(e.type));var O={type:g.ErrorTypes.NETWORK_ERROR,details:y,fatal:b,url:e.url,loader:C,context:e,networkDetails:s};h&&(O.response=h),this.hls.trigger(m.default.ERROR,O)},u._handlePlaylistLoaded=function(e,s,c,h){var y=c.type,b=c.level,C=c.id,O=c.levelDetails;if(!O||!O.targetduration){this._handleManifestParsingError(e,c,"invalid target duration",h);return}var P=d.canHaveQualityLevels(c.type);if(P)this.hls.trigger(m.default.LEVEL_LOADED,{details:O,level:b||0,id:C||0,stats:s,networkDetails:h});else switch(y){case K.AUDIO_TRACK:this.hls.trigger(m.default.AUDIO_TRACK_LOADED,{details:O,id:C,stats:s,networkDetails:h});break;case K.SUBTITLE_TRACK:this.hls.trigger(m.default.SUBTITLE_TRACK_LOADED,{details:O,id:C,stats:s,networkDetails:h});break}},d}(L),pt=ot;function St(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var B=function(p){St(d,p);function d(o){var e;return e=p.call(this,o,m.default.FRAG_LOADING)||this,e.loaders={},e}var u=d.prototype;return u.destroy=function(){var e=this.loaders;for(var s in e){var c=e[s];c&&c.destroy()}this.loaders={},p.prototype.destroy.call(this)},u.onFragLoading=function(e){var s=e.frag,c=s.type,h=this.loaders,y=this.hls.config,b=y.fLoader,C=y.loader;s.loaded=0;var O=h[c];O&&(A.logger.warn("abort previous fragment loader for type: "+c),O.abort()),O=h[c]=s.loader=y.fLoader?new b(y):new C(y);var P,H,Q;P={url:s.url,frag:s,responseType:"arraybuffer",progressData:!1};var fe=s.byteRangeStartOffset,_e=s.byteRangeEndOffset;Object(T.isFiniteNumber)(fe)&&Object(T.isFiniteNumber)(_e)&&(P.rangeStart=fe,P.rangeEnd=_e),H={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:y.fragLoadingMaxRetryTimeout},Q={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},O.load(P,H,Q)},u.loadsuccess=function(e,s,c,h){h===void 0&&(h=null);var y=e.data,b=c.frag;b.loader=void 0,this.loaders[b.type]=void 0,this.hls.trigger(m.default.FRAG_LOADED,{payload:y,frag:b,stats:s,networkDetails:h})},u.loaderror=function(e,s,c){c===void 0&&(c=null);var h=s.frag,y=h.loader;y&&y.abort(),this.loaders[h.type]=void 0,this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:s.frag,response:e,networkDetails:c})},u.loadtimeout=function(e,s,c){c===void 0&&(c=null);var h=s.frag,y=h.loader;y&&y.abort(),this.loaders[h.type]=void 0,this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:s.frag,networkDetails:c})},u.loadprogress=function(e,s,c,h){h===void 0&&(h=null);var y=s.frag;y.loaded=e.loaded,this.hls.trigger(m.default.FRAG_LOAD_PROGRESS,{frag:y,stats:e,networkDetails:h})},d}(L),G=B;function ee(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var ie=function(p){ee(d,p);function d(o){var e;return e=p.call(this,o,m.default.KEY_LOADING)||this,e.loaders={},e.decryptkey=null,e.decrypturl=null,e}var u=d.prototype;return u.destroy=function(){for(var e in this.loaders){var s=this.loaders[e];s&&s.destroy()}this.loaders={},p.prototype.destroy.call(this)},u.onKeyLoading=function(e){var s=e.frag,c=s.type,h=this.loaders[c];if(!s.decryptdata){A.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var y=s.decryptdata.uri;if(y!==this.decrypturl||this.decryptkey===null){var b=this.hls.config;if(h&&(A.logger.warn("abort previous key loader for type:"+c),h.abort()),!y){A.logger.warn("key uri is falsy");return}s.loader=this.loaders[c]=new b.loader(b),this.decrypturl=y,this.decryptkey=null;var C={url:y,frag:s,responseType:"arraybuffer"},O={timeout:b.fragLoadingTimeOut,maxRetry:0,retryDelay:b.fragLoadingRetryDelay,maxRetryDelay:b.fragLoadingMaxRetryTimeout},P={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.loader.load(C,O,P)}else this.decryptkey&&(s.decryptdata.key=this.decryptkey,this.hls.trigger(m.default.KEY_LOADED,{frag:s}))},u.loadsuccess=function(e,s,c){var h=c.frag;if(!h.decryptdata){A.logger.error("after key load, decryptdata unset");return}this.decryptkey=h.decryptdata.key=new Uint8Array(e.data),h.loader=void 0,delete this.loaders[h.type],this.hls.trigger(m.default.KEY_LOADED,{frag:h})},u.loaderror=function(e,s){var c=s.frag,h=c.loader;h&&h.abort(),delete this.loaders[c.type],this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:e})},u.loadtimeout=function(e,s){var c=s.frag,h=c.loader;h&&h.abort(),delete this.loaders[c.type],this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:c})},d}(L),ue=ie;function pe(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var E={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},D=function(p){pe(d,p);function d(o){var e;return e=p.call(this,o,m.default.BUFFER_APPENDED,m.default.FRAG_BUFFERED,m.default.FRAG_LOADED)||this,e.bufferPadding=.2,e.fragments=Object.create(null),e.timeRanges=Object.create(null),e.config=o.config,e}var u=d.prototype;return u.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,L.prototype.destroy.call(this),p.prototype.destroy.call(this)},u.getBufferedFrag=function(e,s){var c=this.fragments,h=Object.keys(c).filter(function(b){var C=c[b];if(C.body.type!==s||!C.buffered)return!1;var O=C.body;return O.startPTS<=e&&e<=O.endPTS});if(h.length===0)return null;var y=h.pop();return c[y].body},u.detectEvictedFragments=function(e,s){var c=this;Object.keys(this.fragments).forEach(function(h){var y=c.fragments[h];if(!(!y||!y.buffered)){var b=y.range[e];if(!!b)for(var C=b.time,O=0;O<C.length;O++){var P=C[O];if(!c.isTimeBuffered(P.startPTS,P.endPTS,s)){c.removeFragment(y.body);break}}}})},u.detectPartialFragments=function(e){var s=this,c=this.getFragmentKey(e),h=this.fragments[c];h&&(h.buffered=!0,Object.keys(this.timeRanges).forEach(function(y){if(e.hasElementaryStream(y)){var b=s.timeRanges[y];h.range[y]=s.getBufferedTimes(e.startPTS,e.endPTS,b)}}))},u.getBufferedTimes=function(e,s,c){for(var h=[],y,b,C=!1,O=0;O<c.length;O++)if(y=c.start(O)-this.bufferPadding,b=c.end(O)+this.bufferPadding,e>=y&&s<=b){h.push({startPTS:Math.max(e,c.start(O)),endPTS:Math.min(s,c.end(O))});break}else if(e<b&&s>y)h.push({startPTS:Math.max(e,c.start(O)),endPTS:Math.min(s,c.end(O))}),C=!0;else if(s<=y)break;return{time:h,partial:C}},u.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},u.getPartialFragment=function(e){var s=this,c,h,y,b=null,C=0;return Object.keys(this.fragments).forEach(function(O){var P=s.fragments[O];s.isPartial(P)&&(h=P.body.startPTS-s.bufferPadding,y=P.body.endPTS+s.bufferPadding,e>=h&&e<=y&&(c=Math.min(e-h,y-e),C<=c&&(b=P.body,C=c)))}),b},u.getState=function(e){var s=this.getFragmentKey(e),c=this.fragments[s],h=E.NOT_LOADED;return c!==void 0&&(c.buffered?this.isPartial(c)===!0?h=E.PARTIAL:h=E.OK:h=E.APPENDING),h},u.isPartial=function(e){return e.buffered===!0&&(e.range.video!==void 0&&e.range.video.partial===!0||e.range.audio!==void 0&&e.range.audio.partial===!0)},u.isTimeBuffered=function(e,s,c){for(var h,y,b=0;b<c.length;b++){if(h=c.start(b)-this.bufferPadding,y=c.end(b)+this.bufferPadding,e>=h&&s<=y)return!0;if(s<=h)return!1}return!1},u.onFragLoaded=function(e){var s=e.frag;!Object(T.isFiniteNumber)(s.sn)||s.bitrateTest||(this.fragments[this.getFragmentKey(s)]={body:s,range:Object.create(null),buffered:!1})},u.onBufferAppended=function(e){var s=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(c){var h=s.timeRanges[c];s.detectEvictedFragments(c,h)})},u.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},u.hasFragment=function(e){var s=this.getFragmentKey(e);return this.fragments[s]!==void 0},u.removeFragment=function(e){var s=this.getFragmentKey(e);delete this.fragments[s]},u.removeAllFragments=function(){this.fragments=Object.create(null)},d}(L),_={search:function(d,u){for(var o=0,e=d.length-1,s=null,c=null;o<=e;){s=(o+e)/2|0,c=d[s];var h=u(c);if(h>0)o=s+1;else if(h<0)e=s-1;else return c}return null}},k=_,R=function(){function p(){}return p.isBuffered=function(u,o){try{if(u){for(var e=u.buffered,s=0;s<e.length;s++)if(o>=e.start(s)&&o<=e.end(s))return!0}}catch{}return!1},p.bufferInfo=function(u,o,e){try{if(u){var s=u.buffered,c=[],h;for(h=0;h<s.length;h++)c.push({start:s.start(h),end:s.end(h)});return this.bufferedInfo(c,o,e)}}catch{}return{len:0,start:o,end:o,nextStart:void 0}},p.bufferedInfo=function(u,o,e){u.sort(function(_e,Ie){var Ce=_e.start-Ie.start;return Ce||Ie.end-_e.end});var s=[];if(e)for(var c=0;c<u.length;c++){var h=s.length;if(h){var y=s[h-1].end;u[c].start-y<e?u[c].end>y&&(s[h-1].end=u[c].end):s.push(u[c])}else s.push(u[c])}else s=u;for(var b=0,C,O=o,P=o,H=0;H<s.length;H++){var Q=s[H].start,fe=s[H].end;if(o+e>=Q&&o<fe)O=Q,P=fe,b=P-o;else if(o+e<Q){C=Q;break}}return{len:b,start:O,end:P,nextStart:C}},p}(),v=r("./node_modules/eventemitter3/index.js"),S=r("./node_modules/webworkify-webpack/index.js"),I=r("./src/demux/demuxer-inline.js");function N(){return window.MediaSource||window.WebKitMediaSource}var M=r("./src/utils/get-self-scope.js");function V(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var z=function(p){V(d,p);function d(){return p.apply(this,arguments)||this}var u=d.prototype;return u.trigger=function(e){for(var s=arguments.length,c=new Array(s>1?s-1:0),h=1;h<s;h++)c[h-1]=arguments[h];this.emit.apply(this,[e,e].concat(c))},d}(v.EventEmitter),ae=Object(M.getSelfScope)(),le=N()||{isTypeSupported:function(){return!1}},ne=function(){function p(u,o){var e=this;this.hls=u,this.id=o;var s=this.observer=new z,c=u.config,h=function(P,H){H=H||{},H.frag=e.frag,H.id=e.id,u.trigger(P,H)};s.on(m.default.FRAG_DECRYPTED,h),s.on(m.default.FRAG_PARSING_INIT_SEGMENT,h),s.on(m.default.FRAG_PARSING_DATA,h),s.on(m.default.FRAG_PARSED,h),s.on(m.default.ERROR,h),s.on(m.default.FRAG_PARSING_METADATA,h),s.on(m.default.FRAG_PARSING_USERDATA,h),s.on(m.default.INIT_PTS_FOUND,h);var y={mp4:le.isTypeSupported("video/mp4"),mpeg:le.isTypeSupported("audio/mpeg"),mp3:le.isTypeSupported('audio/mp4; codecs="mp3"')},b=navigator.vendor;if(c.enableWorker&&typeof Worker<"u"){A.logger.log("demuxing in webworker");var C;try{C=this.w=S("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),C.addEventListener("message",this.onwmsg),C.onerror=function(O){u.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:O.message+" ("+O.filename+":"+O.lineno+")"}})},C.postMessage({cmd:"init",typeSupported:y,vendor:b,id:o,config:JSON.stringify(c)})}catch(O){A.logger.warn("Error in worker:",O),A.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),C&&ae.URL.revokeObjectURL(C.objectURL),this.demuxer=new I.default(s,y,c,b),this.w=void 0}}else this.demuxer=new I.default(s,y,c,b)}var d=p.prototype;return d.destroy=function(){var o=this.w;if(o)o.removeEventListener("message",this.onwmsg),o.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var s=this.observer;s&&(s.removeAllListeners(),this.observer=null)},d.push=function(o,e,s,c,h,y,b,C){var O=this.w,P=Object(T.isFiniteNumber)(h.startPTS)?h.startPTS:h.start,H=h.decryptdata,Q=this.frag,fe=!(Q&&h.cc===Q.cc),_e=!(Q&&h.level===Q.level),Ie=Q&&h.sn===Q.sn+1,Ce=!_e&&Ie;if(fe&&A.logger.log(this.id+":discontinuity detected"),_e&&A.logger.log(this.id+":switch detected"),this.frag=h,O)O.postMessage({cmd:"demux",data:o,decryptdata:H,initSegment:e,audioCodec:s,videoCodec:c,timeOffset:P,discontinuity:fe,trackSwitch:_e,contiguous:Ce,duration:y,accurateTimeOffset:b,defaultInitPTS:C},o instanceof ArrayBuffer?[o]:[]);else{var Fe=this.demuxer;Fe&&Fe.push(o,H,e,s,c,P,fe,_e,Ce,y,b,C)}},d.onWorkerMessage=function(o){var e=o.data,s=this.hls;switch(e.event){case"init":ae.URL.revokeObjectURL(this.w.objectURL);break;case m.default.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,s.trigger(e.event,e.data);break}},p}(),ve=ne;function de(p,d,u){switch(d){case"audio":p.audioGroupIds||(p.audioGroupIds=[]),p.audioGroupIds.push(u);break;case"text":p.textGroupIds||(p.textGroupIds=[]),p.textGroupIds.push(u);break}}function me(p,d,u){var o=p[d],e=p[u],s=e.startPTS;if(Object(T.isFiniteNumber)(s))u>d?(o.duration=s-o.start,o.duration<0&&A.logger.warn("negative duration computed for frag "+o.sn+",level "+o.level+", there should be some duration drift between playlist and fragment!")):(e.duration=o.start-s,e.duration<0&&A.logger.warn("negative duration computed for frag "+e.sn+",level "+e.level+", there should be some duration drift between playlist and fragment!"));else if(u>d){var c=o.cc===e.cc;e.start=o.start+(c&&o.minEndPTS?o.minEndPTS-o.start:o.duration)}else e.start=Math.max(o.start-e.duration,0)}function ce(p,d,u,o,e,s){var c=u,h=o;if(Object(T.isFiniteNumber)(d.startPTS)){var y=Math.abs(d.startPTS-u);Object(T.isFiniteNumber)(d.deltaPTS)?d.deltaPTS=Math.max(y,d.deltaPTS):d.deltaPTS=y,c=Math.max(u,d.startPTS),u=Math.min(u,d.startPTS),h=Math.min(o,d.endPTS),o=Math.max(o,d.endPTS),e=Math.min(e,d.startDTS),s=Math.max(s,d.endDTS)}var b=u-d.start;d.start=d.startPTS=u,d.maxStartPTS=c,d.endPTS=o,d.minEndPTS=h,d.startDTS=e,d.endDTS=s,d.duration=o-u;var C=d.sn;if(!p||C<p.startSN||C>p.endSN)return 0;var O,P,H;for(O=C-p.startSN,P=p.fragments,P[O]=d,H=O;H>0;H--)me(P,H,H-1);for(H=O;H<P.length-1;H++)me(P,H,H+1);return p.PTSKnown=!0,b}function we(p,d){d.initSegment&&p.initSegment&&(d.initSegment=p.initSegment);var u=0,o;if(Ve(p,d,function(c,h){u=c.cc-h.cc,Object(T.isFiniteNumber)(c.startPTS)&&(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,h.backtracked=c.backtracked,h.dropped=c.dropped,o=h),d.PTSKnown=!0}),!!d.PTSKnown){if(u){A.logger.log("discontinuity sliding from playlist, take drift into account");for(var e=d.fragments,s=0;s<e.length;s++)e[s].cc+=u}o?ce(d,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS):et(p,d),d.PTSKnown=p.PTSKnown}}function Le(p,d,u){u===void 0&&(u=0);var o=-1;Ve(p,d,function(c,h,y){h.start=c.start,o=y});var e=d.fragments;if(o<0){e.forEach(function(c){c.start+=u});return}for(var s=o+1;s<e.length;s++)e[s].start=e[s-1].start+e[s-1].duration}function Ve(p,d,u){if(!(!p||!d))for(var o=Math.max(p.startSN,d.startSN)-d.startSN,e=Math.min(p.endSN,d.endSN)-d.startSN,s=d.startSN-p.startSN,c=o;c<=e;c++){var h=p.fragments[s+c],y=d.fragments[c];if(!h||!y)break;u(h,y,c)}}function et(p,d){var u=d.startSN-p.startSN,o=p.fragments,e=d.fragments;if(!(u<0||u>o.length))for(var s=0;s<e.length;s++)e[s].start+=o[u].start}function Ge(p,d,u){var o=1e3*(d.averagetargetduration?d.averagetargetduration:d.targetduration),e=o/2;return p&&d.endSN===p.endSN&&(o=e),u&&(o=Math.max(e,o-(window.performance.now()-u))),Math.round(o)}var ut={toString:function(d){for(var u="",o=d.length,e=0;e<o;e++)u+="["+d.start(e).toFixed(3)+","+d.end(e).toFixed(3)+"]";return u}},Qe=ut;function Ye(p,d){for(var u=null,o=0;o<p.length;o+=1){var e=p[o];if(e&&e.cc===d){u=e;break}}return u}function tt(p,d){return k.search(p,function(u){return u.cc<d?1:u.cc>d?-1:0})}function nt(p,d,u){var o=!1;return d&&d.details&&u&&(u.endCC>u.startCC||p&&p.cc<u.startCC)&&(o=!0),o}function kt(p,d){var u=p.fragments,o=d.fragments;if(!o.length||!u.length){A.logger.log("No fragments to align");return}var e=Ye(u,o[0].cc);if(!e||e&&!e.startPTS){A.logger.log("No frag in previous level to align on");return}return e}function bt(p,d){d.fragments.forEach(function(u){if(u){var o=u.start+p;u.start=u.startPTS=o,u.endPTS=o+u.duration}}),d.PTSKnown=!0}function ct(p,d,u){Lt(p,u,d),!u.PTSKnown&&d&&Tt(u,d.details)}function Lt(p,d,u){if(nt(p,u,d)){var o=kt(u.details,d);o&&(A.logger.log("Adjusting PTS using last level due to CC increase within current level"),bt(o.start,d))}}function Tt(p,d){if(d&&d.fragments.length){if(!p.hasProgramDateTime||!d.hasProgramDateTime)return;var u=d.fragments[0].programDateTime,o=p.fragments[0].programDateTime,e=(o-u)/1e3+d.fragments[0].start;Object(T.isFiniteNumber)(e)&&(A.logger.log("adjusting PTS using programDateTime delta, sliding:"+e.toFixed(3)),bt(e,p))}}function Pt(p,d,u){if(d===null||!Array.isArray(p)||!p.length||!Object(T.isFiniteNumber)(d))return null;var o=p[0].programDateTime;if(d<(o||0))return null;var e=p[p.length-1].endProgramDateTime;if(d>=(e||0))return null;u=u||0;for(var s=0;s<p.length;++s){var c=p[s];if(qt(d,u,c))return c}return null}function yt(p,d,u,o){u===void 0&&(u=0),o===void 0&&(o=0);var e=null;if(p?e=d[p.sn-d[0].sn+1]:u===0&&d[0].start===0&&(e=d[0]),e&&ft(u,o,e)===0)return e;var s=k.search(d,ft.bind(null,u,o));return s||e}function ft(p,d,u){p===void 0&&(p=0),d===void 0&&(d=0);var o=Math.min(d,u.duration+(u.deltaPTS?u.deltaPTS:0));return u.start+u.duration-o<=p?1:u.start-o>p&&u.start?-1:0}function qt(p,d,u){var o=Math.min(d,u.duration+(u.deltaPTS?u.deltaPTS:0))*1e3,e=u.endProgramDateTime||0;return e-o>p}var Zt=250,Bt=2,Rt=.1,Wt=.05,Qt=function(){function p(u,o,e,s){this.config=u,this.media=o,this.fragmentTracker=e,this.hls=s,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var d=p.prototype;return d.poll=function(o){var e=this.config,s=this.media,c=this.stalled,h=s.currentTime,y=s.seeking,b=this.seeking&&!y,C=!this.seeking&&y;if(this.seeking=y,h!==o){if(this.moved=!0,c!==null){if(this.stallReported){var O=self.performance.now()-c;A.logger.warn("playback not stuck anymore @"+h+", after "+Math.round(O)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((C||b)&&(this.stalled=null),!(s.paused||s.ended||s.playbackRate===0||!s.buffered.length)){var P=R.bufferInfo(s,h,0),H=P.len>0,Q=P.nextStart||0;if(!(!H&&!Q)){if(y){var fe=P.len>Bt,_e=!Q||Q-h>Bt&&!this.fragmentTracker.getPartialFragment(h);if(fe||_e)return;this.moved=!1}if(!this.moved&&this.stalled){var Ie=Math.max(Q,P.start||0)-h;if(Ie>0&&Ie<=Bt){this._trySkipBufferHole(null);return}}var Ce=self.performance.now();if(c===null){this.stalled=Ce;return}var Fe=Ce-c;!y&&Fe>=Zt&&this._reportStall(P.len);var Ke=R.bufferInfo(s,h,e.maxBufferHole);this._tryFixBufferStall(Ke,Fe)}}},d._tryFixBufferStall=function(o,e){var s=this.config,c=this.fragmentTracker,h=this.media,y=h.currentTime,b=c.getPartialFragment(y);if(b){var C=this._trySkipBufferHole(b);if(C)return}o.len>s.maxBufferHole&&e>s.highBufferWatchdogPeriod*1e3&&(A.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},d._reportStall=function(o){var e=this.hls,s=this.media,c=this.stallReported;c||(this.stallReported=!0,A.logger.warn("Playback stalling at @"+s.currentTime+" due to low buffer (buffer="+o+")"),e.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:o}))},d._trySkipBufferHole=function(o){for(var e=this.config,s=this.hls,c=this.media,h=c.currentTime,y=0,b=0;b<c.buffered.length;b++){var C=c.buffered.start(b);if(h+e.maxBufferHole>=y&&h<C){var O=Math.max(C+Wt,c.currentTime+Rt);return A.logger.warn("skipping hole, adjusting currentTime from "+h+" to "+O),this.moved=!0,this.stalled=null,c.currentTime=O,o&&s.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+h+" to "+O,frag:o}),O}y=c.buffered.end(b)}return 0},d._tryNudgeBuffer=function(){var o=this.config,e=this.hls,s=this.media,c=s.currentTime,h=(this.nudgeRetry||0)+1;if(this.nudgeRetry=h,h<o.nudgeMaxRetry){var y=c+h*o.nudgeOffset;A.logger.warn("Nudging 'currentTime' from "+c+" to "+y),s.currentTime=y,e.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else A.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+o.nudgeMaxRetry+" nudges"),e.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},p}();function sr(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function Fr(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var or=function(p){Fr(d,p);function d(o){for(var e,s=arguments.length,c=new Array(s>1?s-1:0),h=1;h<s;h++)c[h-1]=arguments[h];return e=p.call.apply(p,[this,o].concat(c))||this,e._boundTick=void 0,e._tickTimer=null,e._tickInterval=null,e._tickCallCount=0,e._boundTick=e.tick.bind(sr(e)),e}var u=d.prototype;return u.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},u.hasInterval=function(){return!!this._tickInterval},u.hasNextTick=function(){return!!this._tickTimer},u.setInterval=function(e){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,e),!0)},u.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},u.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},u.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},u.doTick=function(){},d}(L);function Mr(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var te={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},Nt=function(p){Mr(d,p);function d(){return p.apply(this,arguments)||this}var u=d.prototype;return u.doTick=function(){},u.startLoad=function(){},u.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=te.STOPPED},u._streamEnded=function(e,s){var c=this.fragCurrent,h=this.fragmentTracker;if(!s.live&&c&&!c.backtracked&&c.sn===s.endSN&&!e.nextStart){var y=h.getState(c);return y===E.PARTIAL||y===E.OK}return!1},u.onMediaSeeking=function(){var e=this.config,s=this.media,c=this.mediaBuffer,h=this.state,y=s?s.currentTime:null,b=R.bufferInfo(c||s,y,this.config.maxBufferHole);if(A.logger.log("media seeking to "+(Object(T.isFiniteNumber)(y)?y.toFixed(3):y)),h===te.FRAG_LOADING){var C=this.fragCurrent;if(b.len===0&&C){var O=e.maxFragLookUpTolerance,P=C.start-O,H=C.start+C.duration+O;y<P||y>H?(C.loader&&(A.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),C.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=te.IDLE):A.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else h===te.ENDED&&(b.len===0&&(this.fragPrevious=null,this.fragCurrent=null),this.state=te.IDLE);s&&(this.lastCurrentTime=y),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=y),this.tick()},u.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},u.onHandlerDestroying=function(){this.stopLoad(),p.prototype.onHandlerDestroying.call(this)},u.onHandlerDestroyed=function(){this.state=te.STOPPED,this.fragmentTracker=null},u.computeLivePosition=function(e,s){var c=this.config.liveSyncDuration!==void 0?this.config.liveSyncDuration:this.config.liveSyncDurationCount*s.targetduration;return e+Math.max(0,s.totalduration-c)},d}(or);function Sr(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Br(p,d,u){return d&&Sr(p.prototype,d),u&&Sr(p,u),p}function Jt(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Sn=100,Oi=function(p){Jt(d,p);function d(o,e){var s;return s=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.MANIFEST_LOADING,m.default.MANIFEST_PARSED,m.default.LEVEL_LOADED,m.default.LEVELS_UPDATED,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.FRAG_LOAD_EMERGENCY_ABORTED,m.default.FRAG_PARSING_INIT_SEGMENT,m.default.FRAG_PARSING_DATA,m.default.FRAG_PARSED,m.default.ERROR,m.default.AUDIO_TRACK_SWITCHING,m.default.AUDIO_TRACK_SWITCHED,m.default.BUFFER_CREATED,m.default.BUFFER_APPENDED,m.default.BUFFER_FLUSHED)||this,s.fragmentTracker=e,s.config=o.config,s.audioCodecSwap=!1,s._state=te.STOPPED,s.stallReported=!1,s.gapController=null,s.altAudio=!1,s.audioOnly=!1,s.bitrateTest=!1,s}var u=d.prototype;return u.startLoad=function(e){if(this.levels){var s=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.setInterval(Sn),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var h=c.startLevel;h===-1&&(c.config.testBandwidth?(h=0,this.bitrateTest=!0):h=c.nextAutoLevel),this.level=c.nextLoadLevel=h,this.loadedmetadata=!1}s>0&&e===-1&&(A.logger.log("override startPosition with lastCurrentTime @"+s.toFixed(3)),e=s),this.state=te.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=te.STOPPED},u.stopLoad=function(){this.forceStartLoad=!1,p.prototype.stopLoad.call(this)},u.doTick=function(){switch(this.state){case te.BUFFER_FLUSHING:this.fragLoadError=0;break;case te.IDLE:this._doTickIdle();break;case te.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=te.IDLE);break;case te.FRAG_LOADING_WAITING_RETRY:var s=window.performance.now(),c=this.retryDate;(!c||s>=c||this.media&&this.media.seeking)&&(A.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=te.IDLE);break}this._checkBuffer(),this._checkFragmentChanged()},u._doTickIdle=function(){var e=this.hls,s=e.config,c=this.media;if(!(this.levelLastLoaded===void 0||!c&&(this.startFragRequested||!s.startFragPrefetch))){if(this.altAudio&&this.audioOnly){this.demuxer.frag=null;return}var h;this.loadedmetadata?h=c.currentTime:h=this.nextLoadPosition;var y=e.nextLoadLevel,b=this.levels[y];if(!!b){var C=b.bitrate,O;C?O=Math.max(8*s.maxBufferSize/C,s.maxBufferLength):O=s.maxBufferLength,O=Math.min(O,s.maxMaxBufferLength);var P=h<s.maxBufferHole?Math.max(Bt,s.maxBufferHole):s.maxBufferHole,H=R.bufferInfo(this.mediaBuffer?this.mediaBuffer:c,h,P),Q=H.len;if(!(Q>=O)){A.logger.trace("buffer length of "+Q.toFixed(3)+" is below max of "+O.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=y;var fe=b.details;if(!fe||fe.live&&this.levelLastLoaded!==y){this.state=te.WAITING_LEVEL;return}if(this._streamEnded(H,fe)){var _e={};this.altAudio&&(_e.type="video"),this.hls.trigger(m.default.BUFFER_EOS,_e),this.state=te.ENDED;return}this._fetchPayloadOrEos(h,H,fe)}}}},u._fetchPayloadOrEos=function(e,s,c){var h=this.fragPrevious;this.level;var y=c.fragments,b=y.length;if(b!==0){var C=y[0].start,O=y[b-1].start+y[b-1].duration,P=s.end,H;if(c.initSegment&&!c.initSegment.data)H=c.initSegment;else if(c.live){var Q=this.config.initialLiveManifestSize;if(b<Q){A.logger.warn("Can not start playback of a level, reason: not enough fragments "+b+" < "+Q);return}if(H=this._ensureFragmentAtLivePoint(c,P,C,O,h,y),H===null)return}else P<C&&(H=y[0]);H||(H=this._findFragment(C,h,b,y,P,O,c)),H&&(H.encrypted?this._loadKey(H,c):this._loadFragment(H,c,e,P))}},u._ensureFragmentAtLivePoint=function(e,s,c,h,y,b){var C=this.hls.config,O=this.media,P,H=1/0;if(C.liveMaxLatencyDuration!==void 0?H=C.liveMaxLatencyDuration:Object(T.isFiniteNumber)(C.liveMaxLatencyDurationCount)&&(H=C.liveMaxLatencyDurationCount*e.targetduration),s<Math.max(c-C.maxFragLookUpTolerance,h-H)){var Q=this.liveSyncPosition=this.computeLivePosition(c,e);s=Q,O&&!O.paused&&O.readyState&&O.duration>Q&&Q>O.currentTime&&(A.logger.log("buffer end: "+s.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+Q.toFixed(3)),O.currentTime=Q),this.nextLoadPosition=Q}if(e.PTSKnown&&s>h&&O&&O.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&y)if(e.hasProgramDateTime)A.logger.log("live playlist, switching playlist, load frag with same PDT: "+y.programDateTime),P=Pt(b,y.endProgramDateTime,C.maxFragLookUpTolerance);else{var fe=y.sn+1;if(fe>=e.startSN&&fe<=e.endSN){var _e=b[fe-e.startSN];y.cc===_e.cc&&(P=_e,A.logger.log("live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=k.search(b,function(Ie){return y.cc-Ie.cc}),P&&A.logger.log("live playlist, switching playlist, load frag with same CC: "+P.sn))}return P},u._findFragment=function(e,s,c,h,y,b,C){var O=this.hls.config,P;if(y<b){var H=y>b-O.maxFragLookUpTolerance?0:O.maxFragLookUpTolerance;P=yt(s,h,y,H)}else P=h[c-1];if(P){var Q=P.sn-C.startSN,fe=s&&P.level===s.level,_e=h[Q-1],Ie=h[Q+1];if(s&&P.sn===s.sn)if(fe&&!P.backtracked)if(P.sn<C.endSN){var Ce=s.deltaPTS;Ce&&Ce>O.maxBufferHole&&s.dropped&&Q?(P=_e,A.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(P=Ie,this.fragmentTracker.getState(P)!==E.OK&&A.logger.log("Re-loading fragment with SN: "+P.sn))}else P=null;else P.backtracked&&(Ie&&Ie.backtracked?(A.logger.warn("Already backtracked from fragment "+Ie.sn+", will not backtrack to fragment "+P.sn+". Loading fragment "+Ie.sn),P=Ie):(A.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),P.dropped=0,_e?(P=_e,P.backtracked=!0):Q&&(P=null)))}return P},u._loadKey=function(e,s){A.logger.log("Loading key for "+e.sn+" of ["+s.startSN+"-"+s.endSN+"], level "+this.level),this.state=te.KEY_LOADING,this.hls.trigger(m.default.KEY_LOADING,{frag:e})},u._loadFragment=function(e,s,c,h){var y=this.fragmentTracker.getState(e);this.fragCurrent=e,e.sn!=="initSegment"&&(this.startFragRequested=!0),Object(T.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||y===E.NOT_LOADED||y===E.PARTIAL?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,A.logger.log("Loading "+e.sn+" of ["+s.startSN+"-"+s.endSN+"], level "+this.level+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+parseFloat(c.toFixed(3))+", bufferEnd: "+parseFloat(h.toFixed(3))),this.hls.trigger(m.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new ve(this.hls,"main")),this.state=te.FRAG_LOADING):y===E.APPENDING&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},u.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,F.MAIN)},u.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},u._checkFragmentChanged=function(){var e,s,c=this.media;if(c&&c.readyState&&c.seeking===!1&&(s=c.currentTime,s>this.lastCurrentTime&&(this.lastCurrentTime=s),R.isBuffered(c,s)?e=this.getBufferedFrag(s):R.isBuffered(c,s+.1)&&(e=this.getBufferedFrag(s+.1)),e)){var h=e;if(h!==this.fragPlaying){this.hls.trigger(m.default.FRAG_CHANGED,{frag:h});var y=h.level;(!this.fragPlaying||this.fragPlaying.level!==y)&&this.hls.trigger(m.default.LEVEL_SWITCHED,{level:y}),this.fragPlaying=h}}},u.immediateLevelSwitch=function(){if(A.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,s;e?(s=e.paused,s||e.pause()):s=!0,this.previouslyPaused=s}var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},u.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,e.currentTime>0&&R.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},u.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var s,c=this.getBufferedFrag(e.currentTime);if(c&&c.startPTS>1&&this.flushMainBuffer(0,c.startPTS-1),e.paused)s=0;else{var h=this.hls.nextLoadLevel,y=this.levels[h],b=this.fragLastKbps;b&&this.fragCurrent?s=this.fragCurrent.duration*y.bitrate/(1e3*b)+1:s=0}var C=this.getBufferedFrag(e.currentTime+s);if(C){var O=this.followingBufferedFrag(C);if(O){var P=this.fragCurrent;P&&P.loader&&P.loader.abort(),this.fragCurrent=null;var H=Math.max(C.endPTS,O.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,O.duration));this.flushMainBuffer(H,Number.POSITIVE_INFINITY)}}}},u.flushMainBuffer=function(e,s){this.state=te.BUFFER_FLUSHING;var c={startOffset:e,endOffset:s};this.altAudio&&(c.type="video"),this.hls.trigger(m.default.BUFFER_FLUSHING,c)},u.onMediaAttached=function(e){var s=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),s.addEventListener("seeking",this.onvseeking),s.addEventListener("seeked",this.onvseeked),s.addEventListener("ended",this.onvended);var c=this.config;this.levels&&c.autoStartLoad&&this.hls.startLoad(c.startPosition),this.gapController=new Qt(c,s,this.fragmentTracker,this.hls)},u.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(A.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var s=this.levels;s&&s.forEach(function(c){c.details&&c.details.fragments.forEach(function(h){h.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},u.onMediaSeeked=function(){var e=this.media,s=e?e.currentTime:void 0;Object(T.isFiniteNumber)(s)&&A.logger.log("media seeked to "+s.toFixed(3)),this.tick()},u.onManifestLoading=function(){A.logger.log("trigger BUFFER_RESET"),this.hls.trigger(m.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},u.onManifestParsed=function(e){var s=!1,c=!1,h;e.levels.forEach(function(b){h=b.audioCodec,h&&(h.indexOf("mp4a.40.2")!==-1&&(s=!0),h.indexOf("mp4a.40.5")!==-1&&(c=!0))}),this.audioCodecSwitch=s&&c,this.audioCodecSwitch&&A.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var y=this.config;(y.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(y.startPosition)},u.onLevelLoaded=function(e){var s=e.details,c=e.level,h=this.levels[this.levelLastLoaded],y=this.levels[c],b=s.totalduration,C=0;if(A.logger.log("level "+c+" loaded ["+s.startSN+","+s.endSN+"],duration:"+b),s.live||y.details&&y.details.live){var O=y.details;O&&s.fragments.length>0?(we(O,s),C=s.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(C,O),s.PTSKnown&&Object(T.isFiniteNumber)(C)?A.logger.log("live playlist sliding:"+C.toFixed(3)):(A.logger.log("live playlist - outdated PTS, unknown sliding"),ct(this.fragPrevious,h,s))):(A.logger.log("live playlist - first load, unknown sliding"),s.PTSKnown=!1,ct(this.fragPrevious,h,s))}else s.PTSKnown=!1;if(y.details=s,this.levelLastLoaded=c,this.hls.trigger(m.default.LEVEL_UPDATED,{details:s,level:c}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var P=s.startTimeOffset;Object(T.isFiniteNumber)(P)?(P<0&&(A.logger.log("negative start time offset "+P+", count from end of last fragment"),P=C+b+P),A.logger.log("start time offset found in playlist, adjust startPosition to "+P),this.startPosition=P):s.live?(this.startPosition=this.computeLivePosition(C,s),A.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===te.WAITING_LEVEL&&(this.state=te.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE,this.tick())},u.onFragLoaded=function(e){var s=this.fragCurrent,c=this.hls,h=this.levels,y=this.media,b=e.frag;if(this.state===te.FRAG_LOADING&&s&&b.type==="main"&&b.level===s.level&&b.sn===s.sn){var C=e.stats,O=h[s.level],P=O.details;if(this.bitrateTest=!1,this.stats=C,A.logger.log("Loaded "+s.sn+" of ["+P.startSN+" ,"+P.endSN+"],level "+s.level),b.bitrateTest&&c.nextLoadLevel)this.state=te.IDLE,this.startFragRequested=!1,C.tparsed=C.tbuffered=window.performance.now(),c.trigger(m.default.FRAG_BUFFERED,{stats:C,frag:s,id:"main"}),this.tick();else if(b.sn==="initSegment")this.state=te.IDLE,C.tparsed=C.tbuffered=window.performance.now(),P.initSegment.data=e.payload,c.trigger(m.default.FRAG_BUFFERED,{stats:C,frag:s,id:"main"}),this.tick();else{A.logger.log("Parsing "+s.sn+" of ["+P.startSN+" ,"+P.endSN+"],level "+s.level+", cc "+s.cc),this.state=te.PARSING,this.pendingBuffering=!0,this.appended=!1,b.bitrateTest&&(b.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:b}));var H=!(y&&y.seeking)&&(P.PTSKnown||!P.live),Q=P.initSegment?P.initSegment.data:[],fe=this._getAudioCodec(O),_e=this.demuxer=this.demuxer||new ve(this.hls,"main");_e.push(e.payload,Q,fe,O.videoCodec,s,P.totalduration,H)}}this.fragLoadError=0},u.onFragParsingInitSegment=function(e){var s=this.fragCurrent,c=e.frag;if(s&&e.id==="main"&&c.sn===s.sn&&c.level===s.level&&this.state===te.PARSING){var h=e.tracks,y,b;if(this.audioOnly=h.audio&&!h.video,this.altAudio&&!this.audioOnly&&delete h.audio,b=h.audio,b){var C=this.levels[this.level].audioCodec,O=navigator.userAgent.toLowerCase();C&&this.audioCodecSwap&&(A.logger.log("swapping playlist audio codec"),C.indexOf("mp4a.40.5")!==-1?C="mp4a.40.2":C="mp4a.40.5"),this.audioCodecSwitch&&b.metadata.channelCount!==1&&O.indexOf("firefox")===-1&&(C="mp4a.40.5"),O.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(C="mp4a.40.2",A.logger.log("Android: force audio codec to "+C)),b.levelCodec=C,b.id=e.id}b=h.video,b&&(b.levelCodec=this.levels[this.level].videoCodec,b.id=e.id),this.hls.trigger(m.default.BUFFER_CODECS,h);for(y in h){b=h[y],A.logger.log("main track:"+y+",container:"+b.container+",codecs[level/parsed]=["+b.levelCodec+"/"+b.codec+"]");var P=b.initSegment;P&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(m.default.BUFFER_APPENDING,{type:y,data:P,parent:"main",content:"initSegment"}))}this.tick()}},u.onFragParsingData=function(e){var s=this,c=this.fragCurrent,h=e.frag;if(c&&e.id==="main"&&h.sn===c.sn&&h.level===c.level&&!(e.type==="audio"&&this.altAudio)&&this.state===te.PARSING){var y=this.levels[this.level],b=c;if(Object(T.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+c.duration,e.endDTS=e.startDTS+c.duration),e.hasAudio===!0&&b.addElementaryStream(he.AUDIO),e.hasVideo===!0&&b.addElementaryStream(he.VIDEO),A.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),e.type==="video")if(b.dropped=e.dropped,b.dropped)if(b.backtracked)A.logger.warn("Already backtracked on this fragment, appending with the gap",b.sn);else{var C=y.details;if(C&&b.sn===C.startSN)A.logger.warn("missing video frame(s) on first frag, appending with gap",b.sn);else{A.logger.warn("missing video frame(s), backtracking fragment",b.sn),this.fragmentTracker.removeFragment(b),b.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=te.IDLE,this.fragPrevious=b,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.tick();return}}else b.backtracked=!1;var O=ce(y.details,b,e.startPTS,e.endPTS,e.startDTS,e.endDTS),P=this.hls;P.trigger(m.default.LEVEL_PTS_UPDATED,{details:y.details,level:this.level,drift:O,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(H){H&&H.length&&s.state===te.PARSING&&(s.appended=!0,s.pendingBuffering=!0,P.trigger(m.default.BUFFER_APPENDING,{type:e.type,data:H,parent:"main",content:"data"}))}),this.tick()}},u.onFragParsed=function(e){var s=this.fragCurrent,c=e.frag;s&&e.id==="main"&&c.sn===s.sn&&c.level===s.level&&this.state===te.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=te.PARSED,this._checkAppendedParsed())},u.onAudioTrackSwitching=function(e){var s=this.altAudio,c=!!e.url,h=e.id;if(!c){if(this.mediaBuffer!==this.media){A.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var y=this.fragCurrent;y.loader&&(A.logger.log("switching to main audio track, cancel main fragment load"),y.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=te.IDLE}var b=this.hls;s&&b.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),b.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:h})}},u.onAudioTrackSwitched=function(e){var s=e.id,c=!!this.hls.audioTracks[s].url;if(c){var h=this.videoBuffer;h&&this.mediaBuffer!==h&&(A.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=h)}this.altAudio=c,this.tick()},u.onBufferCreated=function(e){var s=e.tracks,c,h,y=!1;for(var b in s){var C=s[b];C.id==="main"?(h=b,c=C,b==="video"&&(this.videoBuffer=s[b].buffer)):y=!0}y&&c?(A.logger.log("alternate track found, use "+h+".buffered to schedule main fragment loading"),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media},u.onBufferAppended=function(e){if(e.parent==="main"){var s=this.state;(s===te.PARSING||s===te.PARSED)&&(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===te.PARSED&&(!this.appended||!this.pendingBuffering)){var e=this.fragCurrent;if(e){var s=this.mediaBuffer?this.mediaBuffer:this.media;A.logger.log("main buffered : "+Qe.toString(s.buffered)),this.fragPrevious=e;var c=this.stats;c.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*c.total/(c.tbuffered-c.tfirst)),this.hls.trigger(m.default.FRAG_BUFFERED,{stats:c,frag:e,id:"main"}),this.state=te.IDLE}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},u.onError=function(e){var s=e.frag||this.fragCurrent;if(!(s&&s.type!=="main")){var c=!!this.media&&R.isBuffered(this.media,this.media.currentTime)&&R.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var h=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);A.logger.warn("mediaController: frag loading failed, retry in "+h+" ms"),this.retryDate=window.performance.now()+h,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=te.FRAG_LOADING_WAITING_RETRY}else A.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=te.ERROR;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==te.ERROR&&(e.fatal?(this.state=te.ERROR,A.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):!e.levelRetry&&this.state===te.WAITING_LEVEL&&(this.state=te.IDLE));break;case g.ErrorDetails.BUFFER_FULL_ERROR:e.parent==="main"&&(this.state===te.PARSING||this.state===te.PARSED)&&(c?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=te.IDLE):(A.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)));break}}},u._reduceMaxBufferLength=function(e){var s=this.config;return s.maxMaxBufferLength>=e?(s.maxMaxBufferLength/=2,A.logger.warn("main:reduce max buffer length to "+s.maxMaxBufferLength+"s"),!0):!1},u._checkBuffer=function(){var e=this.media;if(!(!e||e.readyState===0)){var s=this.mediaBuffer?this.mediaBuffer:e,c=s.buffered;!this.loadedmetadata&&c.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,c)}},u.onFragLoadEmergencyAborted=function(){this.state=te.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},u.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;if(e){var s=this.audioOnly?he.AUDIO:he.VIDEO;this.fragmentTracker.detectEvictedFragments(s,e.buffered)}this.state=te.IDLE,this.fragPrevious=null},u.onLevelsUpdated=function(e){this.levels=e.levels},u.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},u._seekToStartPos=function(){var e=this.media,s=e.currentTime,c=this.startPosition;if(s!==c&&c>=0){if(e.seeking){A.logger.log("could not seek to "+c+", already seeking at "+s);return}var h=e.buffered.length?e.buffered.start(0):0,y=h-c;y>0&&y<this.config.maxBufferHole&&(A.logger.log("adjusting start position by "+y+" to match buffer start"),c+=y,this.startPosition=c),A.logger.log("seek to target start position "+c+" from current time "+s+". ready state "+e.readyState),e.currentTime=c}},u._getAudioCodec=function(e){var s=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(A.logger.log("swapping playlist audio codec"),s&&(s.indexOf("mp4a.40.5")!==-1?s="mp4a.40.2":s="mp4a.40.5")),s},Br(d,[{key:"state",set:function(e){if(this.state!==e){var s=this.state;this._state=e,A.logger.log("main stream-controller: "+s+"->"+e),this.hls.trigger(m.default.STREAM_STATE_TRANSITION,{previousState:s,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var s=this.getBufferedFrag(e.currentTime);if(s)return s.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),d}(Nt),Wn=Oi;function $n(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function kn(p,d,u){return d&&$n(p.prototype,d),u&&$n(p,u),p}function Xn(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Ur,Di=function(p){Xn(d,p);function d(o){var e;return e=p.call(this,o,m.default.MANIFEST_LOADED,m.default.LEVEL_LOADED,m.default.AUDIO_TRACK_SWITCHED,m.default.FRAG_LOADED,m.default.ERROR)||this,e.canload=!1,e.currentLevelIndex=null,e.manualLevelIndex=-1,e.timer=null,Ur=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),e}var u=d.prototype;return u.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},u.clearTimer=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},u.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(s){s.loadError=0;var c=s.details;c&&c.live&&(s.details=void 0)}),this.timer!==null&&this.loadLevel()},u.stopLoad=function(){this.canload=!1},u.onManifestLoaded=function(e){var s=[],c=[],h,y={},b=null,C=!1,O=!1;if(e.levels.forEach(function(Q){var fe=Q.attrs;Q.loadError=0,Q.fragmentError=!1,C=C||!!Q.videoCodec,O=O||!!Q.audioCodec,Ur&&Q.audioCodec&&Q.audioCodec.indexOf("mp4a.40.34")!==-1&&(Q.audioCodec=void 0),b=y[Q.bitrate],b?b.url.push(Q.url):(Q.url=[Q.url],Q.urlId=0,y[Q.bitrate]=Q,s.push(Q)),fe&&(fe.AUDIO&&de(b||Q,"audio",fe.AUDIO),fe.SUBTITLES&&de(b||Q,"text",fe.SUBTITLES))}),C&&O&&(s=s.filter(function(Q){var fe=Q.videoCodec;return!!fe})),s=s.filter(function(Q){var fe=Q.audioCodec,_e=Q.videoCodec;return(!fe||Ee(fe,"audio"))&&(!_e||Ee(_e,"video"))}),e.audioTracks&&(c=e.audioTracks.filter(function(Q){return!Q.audioCodec||Ee(Q.audioCodec,"audio")}),c.forEach(function(Q,fe){Q.id=fe})),s.length>0){h=s[0].bitrate,s.sort(function(Q,fe){return Q.bitrate-fe.bitrate}),this._levels=s;for(var P=0;P<s.length;P++)if(s[P].bitrate===h){this._firstLevel=P,A.logger.log("manifest loaded,"+s.length+" level(s) found, first bitrate:"+h);break}var H=O&&!C;this.hls.trigger(m.default.MANIFEST_PARSED,{levels:s,audioTracks:c,firstLevel:this._firstLevel,stats:e.stats,audio:O,video:C,altAudio:!H&&c.some(function(Q){return!!Q.url})})}else this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},u.setLevelInternal=function(e){var s=this._levels,c=this.hls;if(e>=0&&e<s.length){if(this.clearTimer(),this.currentLevelIndex!==e){A.logger.log("switching to level "+e),this.currentLevelIndex=e;var h=s[e];h.level=e,c.trigger(m.default.LEVEL_SWITCHING,h)}var y=s[e],b=y.details;if(!b||b.live){var C=y.urlId;c.trigger(m.default.LEVEL_LOADING,{url:y.url[C],level:e,id:C})}}else c.trigger(m.default.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},u.onError=function(e){if(e.fatal){e.type===g.ErrorTypes.NETWORK_ERROR&&this.clearTimer();return}var s=!1,c=!1,h;switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:h=e.frag.level,c=!0;break;case g.ErrorDetails.LEVEL_LOAD_ERROR:case g.ErrorDetails.LEVEL_LOAD_TIMEOUT:h=e.context.level,s=!0;break;case g.ErrorDetails.REMUX_ALLOC_ERROR:h=e.level,s=!0;break}h!==void 0&&this.recoverLevel(e,h,s,c)},u.recoverLevel=function(e,s,c,h){var y=this,b=this.hls.config,C=e.details,O=this._levels[s],P,H,Q;if(O.loadError++,O.fragmentError=h,c)if(this.levelRetryCount+1<=b.levelLoadingMaxRetry)H=Math.min(Math.pow(2,this.levelRetryCount)*b.levelLoadingRetryDelay,b.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return y.loadLevel()},H),e.levelRetry=!0,this.levelRetryCount++,A.logger.warn("level controller, "+C+", retry in "+H+" ms, current retry count is "+this.levelRetryCount);else{A.logger.error("level controller, cannot recover from "+C+" error"),this.currentLevelIndex=null,this.clearTimer(),e.fatal=!0;return}(c||h)&&(P=O.url.length,P>1&&O.loadError<P?(O.urlId=(O.urlId+1)%P,O.details=void 0,A.logger.warn("level controller, "+C+" for level "+s+": switching to redundant URL-id "+O.urlId)):this.manualLevelIndex===-1?(Q=s===0?this._levels.length-1:s-1,A.logger.warn("level controller, "+C+": switch to "+Q),this.hls.nextAutoLevel=this.currentLevelIndex=Q):h&&(A.logger.warn("level controller, "+C+": reload a fragment"),this.currentLevelIndex=null))},u.onFragLoaded=function(e){var s=e.frag;if(s!==void 0&&s.type==="main"){var c=this._levels[s.level];c!==void 0&&(c.fragmentError=!1,c.loadError=0,this.levelRetryCount=0)}},u.onLevelLoaded=function(e){var s=this,c=e.level,h=e.details;if(c===this.currentLevelIndex){var y=this._levels[c];if(y.fragmentError||(y.loadError=0,this.levelRetryCount=0),h.live){var b=Ge(y.details,h,e.stats.trequest);A.logger.log("live playlist, reload in "+Math.round(b)+" ms"),this.timer=setTimeout(function(){return s.loadLevel()},b)}else this.clearTimer()}},u.onAudioTrackSwitched=function(e){var s=this.hls.audioTracks[e.id].groupId,c=this.hls.levels[this.currentLevelIndex];if(!!c&&c.audioGroupIds){for(var h=-1,y=0;y<c.audioGroupIds.length;y++)if(c.audioGroupIds[y]===s){h=y;break}h!==c.urlId&&(c.urlId=h,this.startLoad())}},u.loadLevel=function(){if(A.logger.debug("call to loadLevel"),this.currentLevelIndex!==null&&this.canload){var e=this._levels[this.currentLevelIndex];if(typeof e=="object"&&e.url.length>0){var s=this.currentLevelIndex,c=e.urlId,h=e.url[c];A.logger.log("Attempt loading level index "+s+" with URL-id "+c),this.hls.trigger(m.default.LEVEL_LOADING,{url:h,level:s,id:c})}}},u.removeLevel=function(e,s){var c=this.levels.filter(function(h,y){return y!==e?!0:h.url.length>1&&s!==void 0?(h.url=h.url.filter(function(b,C){return C!==s}),h.urlId=0,!0):!1}).map(function(h,y){var b=h.details;return b&&b.fragments&&b.fragments.forEach(function(C){C.level=y}),h});this._levels=c,this.hls.trigger(m.default.LEVELS_UPDATED,{levels:c})},kn(d,[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var s=this._levels;s&&(e=Math.min(e,s.length-1),(this.currentLevelIndex!==e||!s[e].details)&&this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}}]),d}(L),Rn=r("./src/demux/id3.js");function rn(p,d){var u;try{u=new Event("addtrack")}catch{u=document.createEvent("Event"),u.initEvent("addtrack",!1,!1)}u.track=p,d.dispatchEvent(u)}function Kr(p){if(p!=null&&p.cues)for(;p.cues.length>0;)p.removeCue(p.cues[0])}function qn(p,d){if(d<p[0].endTime)return p[0];if(d>p[p.length-1].endTime)return p[p.length-1];for(var u=0,o=p.length-1;u<=o;){var e=Math.floor((o+u)/2);if(d<p[e].endTime)o=e-1;else if(d>p[e].endTime)u=e+1;else return p[e]}return p[u].endTime-d<d-p[o].endTime?p[u]:p[o]}function Zn(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var nn=.25,Cn=function(p){Zn(d,p);function d(o){var e;return e=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.FRAG_PARSING_METADATA,m.default.LIVE_BACK_BUFFER_REACHED)||this,e.id3Track=void 0,e.media=void 0,e}var u=d.prototype;return u.destroy=function(){L.prototype.destroy.call(this)},u.onMediaAttached=function(e){this.media=e.media,this.media},u.onMediaDetaching=function(){Kr(this.id3Track),this.id3Track=void 0,this.media=void 0},u.getID3Track=function(e){for(var s=0;s<e.length;s++){var c=e[s];if(c.kind==="metadata"&&c.label==="id3")return rn(c,this.media),c}return this.media.addTextTrack("metadata","id3")},u.onFragParsingMetadata=function(e){var s=e.frag,c=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var h=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,y=0;y<c.length;y++){var b=Rn.default.getID3Frames(c[y].data);if(b){var C=Math.max(c[y].pts,0),O=y<c.length-1?c[y+1].pts:s.endPTS;O||(O=s.start+s.duration);var P=O-C;P<=0&&(O=C+nn);for(var H=0;H<b.length;H++){var Q=b[H];if(!Rn.default.isTimeStampFrame(Q)){var fe=new h(C,O,"");fe.value=Q,this.id3Track.addCue(fe)}}}}},u.onLiveBackBufferReached=function(e){var s=e.bufferEnd,c=this.id3Track;if(!(!c||!c.cues||!c.cues.length)){var h=qn(c.cues,s);if(!!h)for(;c.cues[0]!==h;)c.removeCue(c.cues[0])}},d}(L),Pi=Cn;function Ni(){var p=N();if(!p)return!1;var d=self.SourceBuffer||self.WebKitSourceBuffer,u=p&&typeof p.isTypeSupported=="function"&&p.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),o=!d||d.prototype&&typeof d.prototype.appendBuffer=="function"&&typeof d.prototype.remove=="function";return!!u&&!!o}var Ml=function(){function p(u){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=u?Math.exp(Math.log(.5)/u):0,this.estimate_=0,this.totalWeight_=0}var d=p.prototype;return d.sample=function(o,e){var s=Math.pow(this.alpha_,o);this.estimate_=e*(1-s)+s*this.estimate_,this.totalWeight_+=o},d.getTotalWeight=function(){return this.totalWeight_},d.getEstimate=function(){if(this.alpha_){var o=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/o}else return this.estimate_},p}(),$a=Ml,Bl=function(){function p(u,o,e,s){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=u,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new $a(o),this.fast_=new $a(e)}var d=p.prototype;return d.sample=function(o,e){o=Math.max(o,this.minDelayMs_);var s=8*e,c=o/1e3,h=s/c;this.fast_.sample(c,h),this.slow_.sample(c,h)},d.canEstimate=function(){var o=this.fast_;return o&&o.getTotalWeight()>=this.minWeight_},d.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},d.destroy=function(){},p}(),Ul=Bl;function Xa(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Kl(p,d,u){return d&&Xa(p.prototype,d),u&&Xa(p,u),p}function Vl(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function Gl(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Hl=window,jl=Hl.performance,Yl=function(p){Gl(d,p);function d(o){var e;return e=p.call(this,o,m.default.FRAG_LOADING,m.default.FRAG_LOADED,m.default.FRAG_BUFFERED,m.default.ERROR)||this,e.lastLoadedFragLevel=0,e._nextAutoLevel=-1,e.hls=o,e.timer=null,e._bwEstimator=null,e.onCheck=e._abandonRulesCheck.bind(Vl(e)),e}var u=d.prototype;return u.destroy=function(){this.clearTimer(),L.prototype.destroy.call(this)},u.onFragLoading=function(e){var s=e.frag;if(s.type==="main"&&(this.timer||(this.fragCurrent=s,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var c=this.hls,h=c.config,y=s.level,b=c.levels[y].details.live,C,O;b?(C=h.abrEwmaFastLive,O=h.abrEwmaSlowLive):(C=h.abrEwmaFastVoD,O=h.abrEwmaSlowVoD),this._bwEstimator=new Ul(c,O,C,h.abrEwmaDefaultEstimate)}},u._abandonRulesCheck=function(){var e=this.hls,s=e.media,c=this.fragCurrent;if(!!c){var h=c.loader;if(!h||h.stats&&h.stats.aborted){A.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}var y=h.stats;if(s&&y&&(!s.paused&&s.playbackRate!==0||!s.readyState)&&c.autoLevel&&c.level){var b=jl.now()-y.trequest,C=Math.abs(s.playbackRate);if(b>500*c.duration/C){var O=e.levels,P=Math.max(1,y.bw?y.bw/8:y.loaded*1e3/b),H=O[c.level];if(!H)return;var Q=H.realBitrate?Math.max(H.realBitrate,H.bitrate):H.bitrate,fe=y.total?y.total:Math.max(y.loaded,Math.round(c.duration*Q/8)),_e=s.currentTime,Ie=(fe-y.loaded)/P,Ce=(R.bufferInfo(s,_e,e.config.maxBufferHole).end-_e)/C;if(Ce<2*c.duration/C&&Ie>Ce){var Fe=e.minAutoLevel,Ke,Xe;for(Xe=c.level-1;Xe>Fe;Xe--){var gt=O[Xe].realBitrate?Math.max(O[Xe].realBitrate,O[Xe].bitrate):O[Xe].bitrate,Vt=c.duration*gt/(8*.8*P);if(Vt<Ce)break}Ke<Ie&&(A.logger.warn("loading too slow, abort fragment loading and switch to level "+Xe+":fragLoadedDelay["+Xe+"]<fragLoadedDelay["+(c.level-1)+"];bufferStarvationDelay:"+Ke.toFixed(1)+"<"+Ie.toFixed(1)+":"+Ce.toFixed(1)),e.nextLoadLevel=Xe,this._bwEstimator.sample(b,y.loaded),h.abort(),this.clearTimer(),e.trigger(m.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,stats:y}))}}}}},u.onFragLoaded=function(e){var s=e.frag;if(s.type==="main"&&Object(T.isFiniteNumber)(s.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=s.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var c=this.hls.levels[s.level],h=(c.loaded?c.loaded.bytes:0)+e.stats.loaded,y=(c.loaded?c.loaded.duration:0)+e.frag.duration;c.loaded={bytes:h,duration:y},c.realBitrate=Math.round(8*h/y)}if(e.frag.bitrateTest){var b=e.stats;b.tparsed=b.tbuffered=b.tload,this.onFragBuffered(e)}}},u.onFragBuffered=function(e){var s=e.stats,c=e.frag;if(s.aborted!==!0&&c.type==="main"&&Object(T.isFiniteNumber)(c.sn)&&(!c.bitrateTest||s.tload===s.tbuffered)){var h=s.tparsed-s.trequest;A.logger.log("latency/loading/parsing/append/kbps:"+Math.round(s.tfirst-s.trequest)+"/"+Math.round(s.tload-s.tfirst)+"/"+Math.round(s.tparsed-s.tload)+"/"+Math.round(s.tbuffered-s.tparsed)+"/"+Math.round(8*s.loaded/(s.tbuffered-s.trequest))),this._bwEstimator.sample(h,s.loaded),s.bwEstimate=this._bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=h/1e3:this.bitrateTestDelay=0}},u.onError=function(e){switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},u.clearTimer=function(){clearInterval(this.timer),this.timer=null},u._findBestLevel=function(e,s,c,h,y,b,C,O,P){for(var H=y;H>=h;H--){var Q=P[H];if(!!Q){var fe=Q.details,_e=fe?fe.totalduration/fe.fragments.length:s,Ie=fe?fe.live:!1,Ce=void 0;H<=e?Ce=C*c:Ce=O*c;var Fe=P[H].realBitrate?Math.max(P[H].realBitrate,P[H].bitrate):P[H].bitrate,Ke=Fe*_e/Ce;if(A.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+H+"/"+Math.round(Ce)+"/"+Fe+"/"+_e+"/"+b+"/"+Ke),Ce>Fe&&(!Ke||Ie&&!this.bitrateTestDelay||Ke<b))return H}}return-1},Kl(d,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,s=this._bwEstimator;if(e!==-1&&(!s||!s.canEstimate()))return e;var c=this._nextABRAutoLevel;return e!==-1&&(c=Math.min(e,c)),c},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,s=e.maxAutoLevel,c=e.levels,h=e.config,y=e.minAutoLevel,b=e.media,C=this.lastLoadedFragLevel,O=this.fragCurrent?this.fragCurrent.duration:0,P=b?b.currentTime:0,H=b&&b.playbackRate!==0?Math.abs(b.playbackRate):1,Q=this._bwEstimator?this._bwEstimator.getEstimate():h.abrEwmaDefaultEstimate,fe=(R.bufferInfo(b,P,h.maxBufferHole).end-P)/H,_e=this._findBestLevel(C,O,Q,y,s,fe,h.abrBandWidthFactor,h.abrBandWidthUpFactor,c);if(_e>=0)return _e;A.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var Ie=O?Math.min(O,h.maxStarvationDelay):h.maxStarvationDelay,Ce=h.abrBandWidthFactor,Fe=h.abrBandWidthUpFactor;if(fe===0){var Ke=this.bitrateTestDelay;if(Ke){var Xe=O?Math.min(O,h.maxLoadingDelay):h.maxLoadingDelay;Ie=Xe-Ke,A.logger.trace("bitrate test took "+Math.round(1e3*Ke)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*Ie)+" ms"),Ce=Fe=1}}return _e=this._findBestLevel(C,O,Q,y,s,fe+Ie,Ce,Fe,c),Math.max(_e,0)}}]),d}(L),zl=Yl;function Wl(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var qa=N(),$l=function(p){Wl(d,p);function d(o){var e;return e=p.call(this,o,m.default.MEDIA_ATTACHING,m.default.MEDIA_DETACHING,m.default.MANIFEST_PARSED,m.default.BUFFER_RESET,m.default.BUFFER_APPENDING,m.default.BUFFER_CODECS,m.default.BUFFER_EOS,m.default.BUFFER_FLUSHING,m.default.LEVEL_PTS_UPDATED,m.default.LEVEL_UPDATED)||this,e._msDuration=null,e._levelDuration=null,e._levelTargetDuration=10,e._live=null,e._objectUrl=null,e._needsFlush=!1,e._needsEos=!1,e.config=void 0,e.audioTimestampOffset=void 0,e.bufferCodecEventsExpected=0,e._bufferCodecEventsTotal=0,e.media=null,e.mediaSource=null,e.segments=[],e.parent=void 0,e.appending=!1,e.appended=0,e.appendError=0,e.flushBufferCounter=0,e.tracks={},e.pendingTracks={},e.sourceBuffer={},e.flushRange=[],e._onMediaSourceOpen=function(){A.logger.log("media source opened"),e.hls.trigger(m.default.MEDIA_ATTACHED,{media:e.media});var s=e.mediaSource;s&&s.removeEventListener("sourceopen",e._onMediaSourceOpen),e.checkPendingTracks()},e._onMediaSourceClose=function(){A.logger.log("media source closed")},e._onMediaSourceEnded=function(){A.logger.log("media source ended")},e._onSBUpdateEnd=function(){if(e.audioTimestampOffset&&e.sourceBuffer.audio){var s=e.sourceBuffer.audio;A.logger.warn("change mpeg audio timestamp offset from "+s.timestampOffset+" to "+e.audioTimestampOffset),s.timestampOffset=e.audioTimestampOffset,delete e.audioTimestampOffset}e._needsFlush&&e.doFlush(),e._needsEos&&e.checkEos(),e.appending=!1;var c=e.parent,h=e.segments.reduce(function(P,H){return H.parent===c?P+1:P},0),y={},b=e.sourceBuffer;for(var C in b){var O=b[C];if(!O)throw Error("handling source buffer update end error: source buffer for "+C+" uninitilized and unable to update buffered TimeRanges.");y[C]=O.buffered}e.hls.trigger(m.default.BUFFER_APPENDED,{parent:c,pending:h,timeRanges:y}),e._needsFlush||e.doAppending(),e.updateMediaElementDuration(),h===0&&e.flushLiveBackBuffer()},e._onSBUpdateError=function(s){A.logger.error("sourceBuffer error:",s),e.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},e.config=o.config,e}var u=d.prototype;return u.destroy=function(){L.prototype.destroy.call(this)},u.onLevelPtsUpdated=function(e){var s=e.type,c=this.tracks.audio;if(s==="audio"&&c&&c.container==="audio/mpeg"){var h=this.sourceBuffer.audio;if(!h)throw Error("Level PTS Updated and source buffer for audio uninitalized");var y=Math.abs(h.timestampOffset-e.start);if(y>.1){var b=h.updating;try{h.abort()}catch(C){A.logger.warn("can not abort audio buffer: "+C)}b?this.audioTimestampOffset=e.start:(A.logger.warn("change mpeg audio timestamp offset from "+h.timestampOffset+" to "+e.start),h.timestampOffset=e.start)}}},u.onManifestParsed=function(e){var s=2;(e.audio&&!e.video||!e.altAudio)&&(s=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=s,A.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},u.onMediaAttaching=function(e){var s=this.media=e.media;if(s&&qa){var c=this.mediaSource=new qa;c.addEventListener("sourceopen",this._onMediaSourceOpen),c.addEventListener("sourceended",this._onMediaSourceEnded),c.addEventListener("sourceclose",this._onMediaSourceClose),s.src=window.URL.createObjectURL(c),this._objectUrl=s.src}},u.onMediaDetaching=function(){A.logger.log("media source detaching");var e=this.mediaSource;if(e){if(e.readyState==="open")try{e.endOfStream()}catch(s){A.logger.warn("onMediaDetaching:"+s.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):A.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(m.default.MEDIA_DETACHED)},u.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,s=this.pendingTracks,c=Object.keys(s).length;(c&&!e||c===2)&&(this.createSourceBuffers(s),this.pendingTracks={},this.doAppending())},u.onBufferReset=function(){var e=this.sourceBuffer;for(var s in e){var c=e[s];try{c&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(c),c.removeEventListener("updateend",this._onSBUpdateEnd),c.removeEventListener("error",this._onSBUpdateError))}catch{}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},u.onBufferCodecs=function(e){var s=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach(function(c){s.pendingTracks[c]=e[c]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},u.createSourceBuffers=function(e){var s=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");for(var h in e)if(!s[h]){var y=e[h];if(!y)throw Error("source buffer exists for track "+h+", however track does not");var b=y.levelCodec||y.codec,C=y.container+";codecs="+b;A.logger.log("creating sourceBuffer("+C+")");try{var O=s[h]=c.addSourceBuffer(C);O.addEventListener("updateend",this._onSBUpdateEnd),O.addEventListener("error",this._onSBUpdateError),this.tracks[h]={buffer:O,codec:b,id:y.id,container:y.container,levelCodec:y.levelCodec}}catch(P){A.logger.error("error while trying to add sourceBuffer:"+P.message),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:P,mimeType:C})}}this.hls.trigger(m.default.BUFFER_CREATED,{tracks:this.tracks})},u.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},u.onBufferEos=function(e){for(var s in this.sourceBuffer)if(!e.type||e.type===s){var c=this.sourceBuffer[s];c&&!c.ended&&(c.ended=!0,A.logger.log(s+" sourceBuffer now EOS"))}this.checkEos()},u.checkEos=function(){var e=this.sourceBuffer,s=this.mediaSource;if(!s||s.readyState!=="open"){this._needsEos=!1;return}for(var c in e){var h=e[c];if(!!h){if(!h.ended)return;if(h.updating){this._needsEos=!0;return}}}A.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{s.endOfStream()}catch{A.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1},u.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},u.flushLiveBackBuffer=function(){if(!!this._live){var e=this.config.liveBackBufferLength;if(!(!isFinite(e)||e<0)){if(!this.media){A.logger.error("flushLiveBackBuffer called without attaching media");return}for(var s=this.media.currentTime,c=this.sourceBuffer,h=Object.keys(c),y=s-Math.max(e,this._levelTargetDuration),b=h.length-1;b>=0;b--){var C=h[b],O=c[C];if(O){var P=O.buffered;P.length>0&&y>P.start(0)&&this.removeBufferRange(C,O,0,y)&&this.hls.trigger(m.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:y})}}}}},u.onLevelUpdated=function(e){var s=e.details;s.fragments.length>0&&(this._levelDuration=s.totalduration+s.fragments[0].start,this._levelTargetDuration=s.averagetargetduration||s.targetduration||10,this._live=s.live,this.updateMediaElementDuration())},u.updateMediaElementDuration=function(){var e=this.config,s;if(!(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open")){for(var c in this.sourceBuffer){var h=this.sourceBuffer[c];if(h&&h.updating===!0)return}s=this.media.duration,this._msDuration===null&&(this._msDuration=this.mediaSource.duration),this._live===!0&&e.liveDurationInfinity===!0?(A.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>s||!Object(T.isFiniteNumber)(s))&&(A.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},u.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(this.flushBuffer(e.start,e.end,e.type))this.flushRange.shift(),this.flushBufferCounter=0;else{this._needsFlush=!0;return}}if(this.flushRange.length===0){this._needsFlush=!1;var s=0,c=this.sourceBuffer;try{for(var h in c){var y=c[h];y&&(s+=y.buffered.length)}}catch{A.logger.error("error while accessing sourceBuffer.buffered")}this.appended=s,this.hls.trigger(m.default.BUFFER_FLUSHED)}},u.doAppending=function(){var e=this.config,s=this.hls,c=this.segments,h=this.sourceBuffer;if(!!Object.keys(h).length){if(!this.media||this.media.error){this.segments=[],A.logger.error("trying to append although a media error occured, flush segment and abort");return}if(!this.appending){var y=c.shift();if(!!y)try{var b=h[y.type];if(!b){this._onSBUpdateEnd();return}if(b.updating){c.unshift(y);return}b.ended=!1,this.parent=y.parent,b.appendBuffer(y.data),this.appendError=0,this.appended++,this.appending=!0}catch(O){A.logger.error("error while trying to append buffer:"+O.message),c.unshift(y);var C={type:g.ErrorTypes.MEDIA_ERROR,parent:y.parent,details:"",fatal:!1};O.code===22?(this.segments=[],C.details=g.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,C.details=g.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(A.logger.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],C.fatal=!0)),s.trigger(m.default.ERROR,C)}}}},u.flushBuffer=function(e,s,c){var h=this.sourceBuffer;if(!Object.keys(h).length)return!0;var y="null";if(this.media&&(y=this.media.currentTime.toFixed(3)),A.logger.log("flushBuffer,pos/start/end: "+y+"/"+e+"/"+s),this.flushBufferCounter>=this.appended)return A.logger.warn("abort flushing too many retries"),!0;var b=h[c];if(b){if(b.ended=!1,b.updating)return A.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(c,b,e,s))return this.flushBufferCounter++,!1}return A.logger.log("buffer flushed"),!0},u.removeBufferRange=function(e,s,c,h){try{for(var y=0;y<s.buffered.length;y++){var b=s.buffered.start(y),C=s.buffered.end(y),O=Math.max(b,c),P=Math.min(C,h);if(Math.min(P,C)-O>.5){var H="null";return this.media&&(H=this.media.currentTime.toString()),A.logger.log("sb remove "+e+" ["+O+","+P+"], of ["+b+","+C+"], pos:"+H),s.remove(O,P),!0}}}catch(Q){A.logger.warn("removeBufferRange failed",Q)}return!1},d}(L),Xl=$l;function Za(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function ql(p,d,u){return d&&Za(p.prototype,d),u&&Za(p,u),p}function Zl(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Ql=function(p){Zl(d,p);function d(o){var e;return e=p.call(this,o,m.default.FPS_DROP_LEVEL_CAPPING,m.default.MEDIA_ATTACHING,m.default.MANIFEST_PARSED,m.default.LEVELS_UPDATED,m.default.BUFFER_CODECS,m.default.MEDIA_DETACHING)||this,e.autoLevelCapping=Number.POSITIVE_INFINITY,e.firstLevel=null,e.levels=[],e.media=null,e.restrictedLevels=[],e.timer=null,e.clientRect=null,e}var u=d.prototype;return u.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},u.onFpsDropLevelCapping=function(e){d.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},u.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},u.onManifestParsed=function(e){var s=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,s.config.capLevelToPlayerSize&&e.video&&this.startCapping()},u.onBufferCodecs=function(e){var s=this.hls;s.config.capLevelToPlayerSize&&e.video&&this.startCapping()},u.onLevelsUpdated=function(e){this.levels=e.levels},u.onMediaDetaching=function(){this.stopCapping()},u.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var s=this.hls;s.autoLevelCapping=this.getMaxLevel(e-1),s.autoLevelCapping>this.autoLevelCapping&&s.streamController.nextLevelSwitch(),this.autoLevelCapping=s.autoLevelCapping}}},u.getMaxLevel=function(e){var s=this;if(!this.levels)return-1;var c=this.levels.filter(function(h,y){return d.isLevelAllowed(y,s.restrictedLevels)&&y<=e});return this.clientRect=null,d.getMaxLevelByMediaSize(c,this.mediaWidth,this.mediaHeight)},u.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},u.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},u.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,s={width:0,height:0};if(e){var c=e.getBoundingClientRect();s.width=c.width,s.height=c.height,!s.width&&!s.height&&(s.width=c.right-c.left||e.width||0,s.height=c.bottom-c.top||e.height||0)}return this.clientRect=s,s},d.isLevelAllowed=function(e,s){return s===void 0&&(s=[]),s.indexOf(e)===-1},d.getMaxLevelByMediaSize=function(e,s,c){if(!e||e&&!e.length)return-1;for(var h=function(P,H){return H?P.width!==H.width||P.height!==H.height:!0},y=e.length-1,b=0;b<e.length;b+=1){var C=e[b];if((C.width>=s||C.height>=c)&&h(C,e[b+1])){y=b;break}}return y},ql(d,[{key:"mediaWidth",get:function(){return this.getDimensions().width*d.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*d.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch{}return e}}]),d}(L),Jl=Ql;function eu(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var tu=window,ru=tu.performance,nu=function(p){eu(d,p);function d(o){return p.call(this,o,m.default.MEDIA_ATTACHING)||this}var u=d.prototype;return u.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},u.onMediaAttaching=function(e){var s=this.hls.config;if(s.capLevelOnFPSDrop){var c=this.video=e.media instanceof window.HTMLVideoElement?e.media:null;typeof c.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}},u.checkFPS=function(e,s,c){var h=ru.now();if(s){if(this.lastTime){var y=h-this.lastTime,b=c-this.lastDroppedFrames,C=s-this.lastDecodedFrames,O=1e3*b/y,P=this.hls;if(P.trigger(m.default.FPS_DROP,{currentDropped:b,currentDecoded:C,totalDroppedFrames:c}),O>0&&b>P.config.fpsDroppedMonitoringThreshold*C){var H=P.currentLevel;A.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+H),H>0&&(P.autoLevelCapping===-1||P.autoLevelCapping>=H)&&(H=H-1,P.trigger(m.default.FPS_DROP_LEVEL_CAPPING,{level:H,droppedLevel:P.currentLevel}),P.autoLevelCapping=H,P.streamController.nextLevelSwitch())}}this.lastTime=h,this.lastDroppedFrames=c,this.lastDecodedFrames=s}},u.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var s=e.getVideoPlaybackQuality();this.checkFPS(e,s.totalVideoFrames,s.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},d}(L),iu=nu,au=function(){function p(u){u&&u.xhrSetup&&(this.xhrSetup=u.xhrSetup)}var d=p.prototype;return d.destroy=function(){this.abort(),this.loader=null},d.abort=function(){var o=this.loader;o&&o.readyState!==4&&(this.stats.aborted=!0,o.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},d.load=function(o,e,s){this.context=o,this.config=e,this.callbacks=s,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},d.loadInternal=function(){var o,e=this.context;o=this.loader=new window.XMLHttpRequest;var s=this.stats;s.tfirst=0,s.loaded=0;var c=this.xhrSetup;try{if(c)try{c(o,e.url)}catch{o.open("GET",e.url,!0),c(o,e.url)}o.readyState||o.open("GET",e.url,!0)}catch(h){this.callbacks.onError({code:o.status,text:h.message},e,o);return}e.rangeEnd&&o.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),o.onreadystatechange=this.readystatechange.bind(this),o.onprogress=this.loadprogress.bind(this),o.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),o.send()},d.readystatechange=function(o){var e=o.currentTarget,s=e.readyState,c=this.stats,h=this.context,y=this.config;if(!c.aborted&&s>=2)if(window.clearTimeout(this.requestTimeout),c.tfirst===0&&(c.tfirst=Math.max(window.performance.now(),c.trequest)),s===4){var b=e.status;if(b>=200&&b<300){c.tload=Math.max(c.tfirst,window.performance.now());var C,O;h.responseType==="arraybuffer"?(C=e.response,O=C.byteLength):(C=e.responseText,O=C.length),c.loaded=c.total=O;var P={url:e.responseURL,data:C};this.callbacks.onSuccess(P,c,h,e)}else c.retry>=y.maxRetry||b>=400&&b<499?(A.logger.error(b+" while loading "+h.url),this.callbacks.onError({code:b,text:e.statusText},h,e)):(A.logger.warn(b+" while loading "+h.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,y.maxRetryDelay),c.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),y.timeout)},d.loadtimeout=function(){A.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},d.loadprogress=function(o){var e=o.currentTarget,s=this.stats;s.loaded=o.loaded,o.lengthComputable&&(s.total=o.total);var c=this.callbacks.onProgress;c&&c(s,this.context,null,e)},p}(),su=au;function Qa(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function ou(p,d,u){return d&&Qa(p.prototype,d),u&&Qa(p,u),p}function lu(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var uu=function(p){lu(d,p);function d(o){var e;return e=p.call(this,o,m.default.MANIFEST_LOADING,m.default.MANIFEST_PARSED,m.default.AUDIO_TRACK_LOADED,m.default.AUDIO_TRACK_SWITCHED,m.default.LEVEL_LOADED,m.default.ERROR)||this,e._trackId=-1,e._selectDefaultTrack=!0,e.tracks=[],e.trackIdBlacklist=Object.create(null),e.audioGroupId=null,e}var u=d.prototype;return u.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},u.onManifestParsed=function(e){var s=this.tracks=e.audioTracks||[];this.hls.trigger(m.default.AUDIO_TRACKS_UPDATED,{audioTracks:s}),this._selectAudioGroup(this.hls.nextLoadLevel)},u.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length){A.logger.warn("Invalid audio track id:",e.id);return}if(A.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var s=e.details.targetduration*1e3;this.setInterval(s)}!e.details.live&&this.hasInterval()&&this.clearInterval()},u.onAudioTrackSwitched=function(e){var s=this.tracks[e.id].groupId;s&&this.audioGroupId!==s&&(this.audioGroupId=s)},u.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},u.onError=function(e){e.type===g.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(A.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},u._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details){A.logger.debug("Same id as current audio-track passed, and track details available -> no-op");return}if(e<0||e>=this.tracks.length){A.logger.warn("Invalid id passed to audio-track controller");return}var s=this.tracks[e];A.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var c=s.url,h=s.type,y=s.id;this.hls.trigger(m.default.AUDIO_TRACK_SWITCHING,{id:y,type:h,url:c}),this._loadTrackDetailsIfNeeded(s)},u.doTick=function(){this._updateTrack(this._trackId)},u._selectAudioGroup=function(e){var s=this.hls.levels[e];if(!(!s||!s.audioGroupIds)){var c=s.audioGroupIds[s.urlId];this.audioGroupId!==c&&(this.audioGroupId=c,this._selectInitialAudioTrack())}},u._selectInitialAudioTrack=function(){var e=this,s=this.tracks;if(!!s.length){var c=this.tracks[this._trackId],h=null;if(c&&(h=c.name),this._selectDefaultTrack){var y=s.filter(function(O){return O.default});y.length?s=y:A.logger.warn("No default audio tracks defined")}var b=!1,C=function(){s.forEach(function(P){b||(!e.audioGroupId||P.groupId===e.audioGroupId)&&(!h||h===P.name)&&(e._setAudioTrack(P.id),b=!0)})};C(),b||(h=null,C()),b||(A.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},u._needsTrackLoading=function(e){var s=e.details,c=e.url;return!s||s.live?!!c:!1},u._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var s=e.url,c=e.id;A.logger.log("loading audio-track playlist for id: "+c),this.hls.trigger(m.default.AUDIO_TRACK_LOADING,{url:s,id:c})}},u._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,A.logger.log("trying to update audio-track "+e);var s=this.tracks[e];this._loadTrackDetailsIfNeeded(s)}},u._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,s=this.tracks[e],c=s.name,h=s.language,y=s.groupId;A.logger.warn("Loading failed on audio track id: "+e+", group-id: "+y+', name/language: "'+c+'" / "'+h+'"');for(var b=e,C=0;C<this.tracks.length;C++)if(!this.trackIdBlacklist[C]){var O=this.tracks[C];if(O.name===c){b=C;break}}if(b===e){A.logger.warn('No fallback audio-track found for name/language: "'+c+'" / "'+h+'"');return}A.logger.log("Attempting audio-track fallback id:",b,"group-id:",this.tracks[b].groupId),this._setAudioTrack(b)},ou(d,[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}]),d}(or),cu=uu;function Ja(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function fu(p,d,u){return d&&Ja(p.prototype,d),u&&Ja(p,u),p}function du(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var hu=window,wn=hu.performance,es=100,gu=function(p){du(d,p);function d(o,e){var s;return s=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.AUDIO_TRACKS_UPDATED,m.default.AUDIO_TRACK_SWITCHING,m.default.AUDIO_TRACK_LOADED,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.FRAG_PARSING_INIT_SEGMENT,m.default.FRAG_PARSING_DATA,m.default.FRAG_PARSED,m.default.ERROR,m.default.BUFFER_RESET,m.default.BUFFER_CREATED,m.default.BUFFER_APPENDED,m.default.BUFFER_FLUSHED,m.default.INIT_PTS_FOUND)||this,s.fragmentTracker=e,s.config=o.config,s.audioCodecSwap=!1,s._state=te.STOPPED,s.initPTS=[],s.waitingFragment=null,s.videoTrackCC=null,s.waitingVideoCC=null,s}var u=d.prototype;return u.onInitPtsFound=function(e){var s=e.id,c=e.frag.cc,h=e.initPTS;s==="main"&&(this.initPTS[c]=h,this.videoTrackCC=c,A.logger.log("InitPTS for cc: "+c+" found from main: "+h),this.state===te.WAITING_INIT_PTS&&this.tick())},u.startLoad=function(e){if(this.tracks){var s=this.lastCurrentTime;this.stopLoad(),this.setInterval(es),this.fragLoadError=0,s>0&&e===-1?(A.logger.log("audio:override startPosition with lastCurrentTime @"+s.toFixed(3)),this.state=te.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=te.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=te.STOPPED},u.doTick=function(){var e,s,c,h=this.hls,y=h.config;switch(this.state){case te.ERROR:case te.PAUSED:case te.BUFFER_FLUSHING:break;case te.STARTING:this.state=te.WAITING_TRACK,this.loadedmetadata=!1;break;case te.IDLE:var b=this.tracks;if(!b||!this.media&&(this.startFragRequested||!y.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(e=this.nextLoadPosition,e===void 0)break;var C=this.mediaBuffer?this.mediaBuffer:this.media,O=this.videoBuffer?this.videoBuffer:this.media,P=e<y.maxBufferHole?Math.max(Bt,y.maxBufferHole):y.maxBufferHole,H=R.bufferInfo(C,e,P),Q=R.bufferInfo(O,e,P),fe=H.len,_e=H.end,Ie=this.fragPrevious,Ce=Math.min(y.maxBufferLength,y.maxMaxBufferLength),Fe=Math.max(Ce,Q.len),Ke=this.audioSwitch,Xe=this.trackId;if((fe<Fe||Ke)&&Xe<b.length){if(c=b[Xe].details,typeof c>"u"){this.state=te.WAITING_TRACK;break}if(!Ke&&this._streamEnded(H,c)){this.hls.trigger(m.default.BUFFER_EOS,{type:"audio"}),this.state=te.ENDED;return}var gt=c.fragments,Vt=gt.length,Ct=gt[0].start,yr=gt[Vt-1].start+gt[Vt-1].duration,De;if(Ke){if(c.live&&!c.PTSKnown)A.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),_e=0;else if(_e=e,c.PTSKnown&&e<Ct)if(H.end>Ct||H.nextStart)A.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=Ct+.05;else return}if(c.initSegment&&!c.initSegment.data)De=c.initSegment;else if(_e<=Ct){if(De=gt[0],this.videoTrackCC!==null&&De.cc!==this.videoTrackCC&&(De=tt(gt,this.videoTrackCC)),c.live&&De.loadIdx&&De.loadIdx===this.fragLoadIdx){var He=H.nextStart?H.nextStart:Ct;A.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(He+.05)),this.media.currentTime=He+.05;return}}else{var At,on=y.maxFragLookUpTolerance,ln=Ie?gt[Ie.sn-gt[0].sn+1]:void 0;_e<yr?(_e>yr-on&&(on=0),ln&&!ft(_e,on,ln)?At=ln:At=k.search(gt,function(lc){return ft(_e,on,lc)})):At=gt[Vt-1],At&&(De=At,Ct=At.start,Ie&&De.level===Ie.level&&De.sn===Ie.sn&&(De.sn<c.endSN?(De=gt[De.sn+1-c.startSN],this.fragmentTracker.getState(De)!==E.OK&&A.logger.log("SN just loaded, load next one: "+De.sn)):De=null))}De&&(De.encrypted?(A.logger.log("Loading key for "+De.sn+" of ["+c.startSN+" ,"+c.endSN+"],track "+Xe),this.state=te.KEY_LOADING,h.trigger(m.default.KEY_LOADING,{frag:De})):(this.fragCurrent=De,(Ke||this.fragmentTracker.getState(De)===E.NOT_LOADED)&&(A.logger.log("Loading "+De.sn+", cc: "+De.cc+" of ["+c.startSN+" ,"+c.endSN+"],track "+Xe+", "+(this.loadedmetadata?"currentTime":"nextLoadPosition")+": "+e+", bufferEnd: "+_e.toFixed(3)),De.sn!=="initSegment"&&(this.startFragRequested=!0),Object(T.isFiniteNumber)(De.sn)&&(this.nextLoadPosition=De.start+De.duration),h.trigger(m.default.FRAG_LOADING,{frag:De}),this.state=te.FRAG_LOADING)))}break;case te.WAITING_TRACK:s=this.tracks[this.trackId],s&&s.details&&(this.state=te.IDLE);break;case te.FRAG_LOADING_WAITING_RETRY:var Ln=wn.now(),ti=this.retryDate;C=this.media;var sc=C&&C.seeking;(!ti||Ln>=ti||sc)&&(A.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=te.IDLE);break;case te.WAITING_INIT_PTS:var In=this.waitingFragment;if(In){var Gi=In.frag.cc;if(this.initPTS[Gi]!==void 0)this.waitingFragment=null,this.state=te.FRAG_LOADING,this.onFragLoaded(In);else if(this.videoTrackCC!==this.waitingVideoCC)A.logger.log("Waiting fragment cc ("+Gi+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var Ss=R.bufferInfo(this.mediaBuffer,this.media.currentTime,y.maxBufferHole),oc=ft(Ss.end,y.maxFragLookUpTolerance,In.frag);oc<0&&(A.logger.log("Waiting fragment cc ("+Gi+") @ "+In.frag.start+" cancelled because another fragment at "+Ss.end+" is needed"),this.clearWaitingFragment())}}else this.state=te.IDLE;break}},u.clearWaitingFragment=function(){var e=this.waitingFragment;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingFragment=null,this.waitingVideoCC=null,this.state=te.IDLE)},u.onMediaAttached=function(e){var s=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),s.addEventListener("seeking",this.onvseeking),s.addEventListener("ended",this.onvended);var c=this.config;this.tracks&&c.autoStartLoad&&this.startLoad(c.startPosition)},u.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(A.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},u.onAudioTracksUpdated=function(e){A.logger.log("audio tracks updated"),this.tracks=e.audioTracks},u.onAudioTrackSwitching=function(e){var s=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.clearWaitingFragment(),this.state=te.PAUSED,s?this.setInterval(es):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),s&&(this.audioSwitch=!0,this.state=te.IDLE),this.tick()},u.onAudioTrackLoaded=function(e){var s=e.details,c=e.id,h=this.tracks[c],y=h.details,b=s.totalduration,C=0;if(A.logger.log("track "+c+" loaded ["+s.startSN+","+s.endSN+"],duration:"+b),s.live||y&&y.live?y&&s.fragments.length>0?(we(y,s),C=s.fragments[0].start,s.PTSKnown?A.logger.log("live audio playlist sliding:"+C.toFixed(3)):A.logger.log("live audio playlist - outdated PTS, unknown sliding")):(s.PTSKnown=!1,A.logger.log("live audio playlist - first load, unknown sliding")):s.PTSKnown=!1,h.details=s,!this.startFragRequested){if(this.startPosition===-1){var O=s.startTimeOffset;Object(T.isFiniteNumber)(O)?(A.logger.log("start time offset found in playlist, adjust startPosition to "+O),this.startPosition=O):s.live?(this.startPosition=this.computeLivePosition(C,s),A.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===te.WAITING_TRACK&&(this.state=te.IDLE),this.tick()},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE,this.tick())},u.onFragLoaded=function(e){var s=this.fragCurrent,c=e.frag;if(this.state===te.FRAG_LOADING&&s&&c.type==="audio"&&c.level===s.level&&c.sn===s.sn){var h=this.tracks[this.trackId],y=h.details,b=y.totalduration,C=s.level,O=s.sn,P=s.cc,H=this.config.defaultAudioCodec||h.audioCodec||"mp4a.40.2",Q=this.stats=e.stats;if(O==="initSegment")this.state=te.IDLE,Q.tparsed=Q.tbuffered=wn.now(),y.initSegment.data=e.payload,this.hls.trigger(m.default.FRAG_BUFFERED,{stats:Q,frag:s,id:"audio"}),this.tick();else{this.state=te.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new ve(this.hls,"audio"));var fe=this.initPTS[P],_e=y.initSegment?y.initSegment.data:[];if(fe!==void 0){this.pendingBuffering=!0,A.logger.log("Demuxing "+O+" of ["+y.startSN+" ,"+y.endSN+"],track "+C);var Ie=!1;this.demuxer.push(e.payload,_e,H,null,s,b,Ie,fe)}else A.logger.log("Unknown video PTS for cc "+P+", waiting for video PTS before demuxing audio frag "+O+" of ["+y.startSN+" ,"+y.endSN+"],track "+C),this.waitingFragment=e,this.waitingVideoCC=this.videoTrackCC,this.state=te.WAITING_INIT_PTS}}this.fragLoadError=0},u.onFragParsingInitSegment=function(e){var s=this.fragCurrent,c=e.frag;if(s&&e.id==="audio"&&c.sn===s.sn&&c.level===s.level&&this.state===te.PARSING){var h=e.tracks,y;if(h.video&&delete h.video,y=h.audio,y){y.levelCodec=y.codec,y.id=e.id,this.hls.trigger(m.default.BUFFER_CODECS,h),A.logger.log("audio track:audio,container:"+y.container+",codecs[level/parsed]=["+y.levelCodec+"/"+y.codec+"]");var b=y.initSegment;if(b){var C={type:"audio",data:b,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[C]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(m.default.BUFFER_APPENDING,C))}this.tick()}}},u.onFragParsingData=function(e){var s=this,c=this.fragCurrent,h=e.frag;if(c&&e.id==="audio"&&e.type==="audio"&&h.sn===c.sn&&h.level===c.level&&this.state===te.PARSING){var y=this.trackId,b=this.tracks[y],C=this.hls;Object(T.isFiniteNumber)(e.endPTS)||(e.endPTS=e.startPTS+c.duration,e.endDTS=e.startDTS+c.duration),c.addElementaryStream(he.AUDIO),A.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),ce(b.details,c,e.startPTS,e.endPTS);var O=this.media,P=!1;if(this.audioSwitch)if(O&&O.readyState){var H=O.currentTime;A.logger.log("switching audio track : currentTime:"+H),H>=e.startPTS&&(A.logger.log("switching audio track : flushing all audio"),this.state=te.BUFFER_FLUSHING,C.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),P=!0,this.audioSwitch=!1,C.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:y}))}else this.audioSwitch=!1,C.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:y});var Q=this.pendingData;if(!Q){A.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),C.trigger(m.default.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});return}this.audioSwitch||([e.data1,e.data2].forEach(function(fe){fe&&fe.length&&Q.push({type:e.type,data:fe,parent:"audio",content:"data"})}),!P&&Q.length&&(Q.forEach(function(fe){s.state===te.PARSING&&(s.pendingBuffering=!0,s.hls.trigger(m.default.BUFFER_APPENDING,fe))}),this.pendingData=[],this.appended=!0)),this.tick()}},u.onFragParsed=function(e){var s=this.fragCurrent,c=e.frag;s&&e.id==="audio"&&c.sn===s.sn&&c.level===s.level&&this.state===te.PARSING&&(this.stats.tparsed=wn.now(),this.state=te.PARSED,this._checkAppendedParsed())},u.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},u.onBufferCreated=function(e){var s=e.tracks.audio;s&&(this.mediaBuffer=s.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},u.onBufferAppended=function(e){if(e.parent==="audio"){var s=this.state;(s===te.PARSING||s===te.PARSED)&&(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},u._checkAppendedParsed=function(){if(this.state===te.PARSED&&(!this.appended||!this.pendingBuffering)){var e=this.fragCurrent,s=this.stats,c=this.hls;if(e){this.fragPrevious=e,s.tbuffered=wn.now(),c.trigger(m.default.FRAG_BUFFERED,{stats:s,frag:e,id:"audio"});var h=this.mediaBuffer?this.mediaBuffer:this.media;h&&A.logger.log("audio buffered : "+Qe.toString(h.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,c.trigger(m.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=te.IDLE}this.tick()}},u.onError=function(e){var s=e.frag;if(!(s&&s.type!=="audio"))switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:var c=e.frag;if(c&&c.type!=="audio")break;if(!e.fatal){var h=this.fragLoadError;h?h++:h=1;var y=this.config;if(h<=y.fragLoadingMaxRetry){this.fragLoadError=h;var b=Math.min(Math.pow(2,h-1)*y.fragLoadingRetryDelay,y.fragLoadingMaxRetryTimeout);A.logger.warn("AudioStreamController: frag loading failed, retry in "+b+" ms"),this.retryDate=wn.now()+b,this.state=te.FRAG_LOADING_WAITING_RETRY}else A.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=te.ERROR}break;case g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==te.ERROR&&(this.state=e.fatal?te.ERROR:te.IDLE,A.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case g.ErrorDetails.BUFFER_FULL_ERROR:if(e.parent==="audio"&&(this.state===te.PARSING||this.state===te.PARSED)){var C=this.mediaBuffer,O=this.media.currentTime,P=C&&R.isBuffered(C,O)&&R.isBuffered(C,O+.5);if(P){var H=this.config;H.maxMaxBufferLength>=H.maxBufferLength&&(H.maxMaxBufferLength/=2,A.logger.warn("AudioStreamController: reduce max buffer length to "+H.maxMaxBufferLength+"s")),this.state=te.IDLE}else A.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=te.BUFFER_FLUSHING,this.hls.trigger(m.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}break}},u.onBufferFlushed=function(){var e=this,s=this.pendingData;s&&s.length?(A.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),s.forEach(function(c){e.hls.trigger(m.default.BUFFER_APPENDING,c)}),this.appended=!0,this.pendingData=[],this.state=te.PARSED):(this.state=te.IDLE,this.fragPrevious=null,this.tick())},fu(d,[{key:"state",set:function(e){if(this.state!==e){var s=this.state;this._state=e,A.logger.log("audio stream:"+s+"->"+e)}},get:function(){return this._state}}]),d}(Nt),pu=gu,ts=function(){if(typeof window<"u"&&window.VTTCue)return window.VTTCue;var p="auto",d={"":!0,lr:!0,rl:!0},u={start:!0,middle:!0,end:!0,left:!0,right:!0};function o(h){if(typeof h!="string")return!1;var y=d[h.toLowerCase()];return y?h.toLowerCase():!1}function e(h){if(typeof h!="string")return!1;var y=u[h.toLowerCase()];return y?h.toLowerCase():!1}function s(h){for(var y=1;y<arguments.length;y++){var b=arguments[y];for(var C in b)h[C]=b[C]}return h}function c(h,y,b){var C=this,O={};O.enumerable=!0,C.hasBeenReset=!1;var P="",H=!1,Q=h,fe=y,_e=b,Ie=null,Ce="",Fe=!0,Ke="auto",Xe="start",gt=50,Vt="middle",Ct=50,yr="middle";Object.defineProperty(C,"id",s({},O,{get:function(){return P},set:function(He){P=""+He}})),Object.defineProperty(C,"pauseOnExit",s({},O,{get:function(){return H},set:function(He){H=!!He}})),Object.defineProperty(C,"startTime",s({},O,{get:function(){return Q},set:function(He){if(typeof He!="number")throw new TypeError("Start time must be set to a number.");Q=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"endTime",s({},O,{get:function(){return fe},set:function(He){if(typeof He!="number")throw new TypeError("End time must be set to a number.");fe=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"text",s({},O,{get:function(){return _e},set:function(He){_e=""+He,this.hasBeenReset=!0}})),Object.defineProperty(C,"region",s({},O,{get:function(){return Ie},set:function(He){Ie=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"vertical",s({},O,{get:function(){return Ce},set:function(He){var At=o(He);if(At===!1)throw new SyntaxError("An invalid or illegal string was specified.");Ce=At,this.hasBeenReset=!0}})),Object.defineProperty(C,"snapToLines",s({},O,{get:function(){return Fe},set:function(He){Fe=!!He,this.hasBeenReset=!0}})),Object.defineProperty(C,"line",s({},O,{get:function(){return Ke},set:function(He){if(typeof He!="number"&&He!==p)throw new SyntaxError("An invalid number or illegal string was specified.");Ke=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"lineAlign",s({},O,{get:function(){return Xe},set:function(He){var At=e(He);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");Xe=At,this.hasBeenReset=!0}})),Object.defineProperty(C,"position",s({},O,{get:function(){return gt},set:function(He){if(He<0||He>100)throw new Error("Position must be between 0 and 100.");gt=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"positionAlign",s({},O,{get:function(){return Vt},set:function(He){var At=e(He);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");Vt=At,this.hasBeenReset=!0}})),Object.defineProperty(C,"size",s({},O,{get:function(){return Ct},set:function(He){if(He<0||He>100)throw new Error("Size must be between 0 and 100.");Ct=He,this.hasBeenReset=!0}})),Object.defineProperty(C,"align",s({},O,{get:function(){return yr},set:function(He){var At=e(He);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");yr=At,this.hasBeenReset=!0}})),C.displayState=void 0}return c.prototype.getCueAsHTML=function(){var h=window.WebVTT;return h.convertCueToDOMTree(window,this.text)},c}(),vu=function(){return{decode:function(u){if(!u)return"";if(typeof u!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(u))}}};function rs(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new vu,this.regionList=[]}function mu(p){function d(o,e,s,c){return(o|0)*3600+(e|0)*60+(s|0)+(c|0)/1e3}var u=p.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return u?u[3]?d(u[1],u[2],u[3].replace(":",""),u[4]):u[1]>59?d(u[1],u[2],0,u[4]):d(0,u[1],u[2],u[4]):null}function ns(){this.values=Object.create(null)}ns.prototype={set:function(d,u){!this.get(d)&&u!==""&&(this.values[d]=u)},get:function(d,u,o){return o?this.has(d)?this.values[d]:u[o]:this.has(d)?this.values[d]:u},has:function(d){return d in this.values},alt:function(d,u,o){for(var e=0;e<o.length;++e)if(u===o[e]){this.set(d,u);break}},integer:function(d,u){/^-?\d+$/.test(u)&&this.set(d,parseInt(u,10))},percent:function(d,u){return u.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(u=parseFloat(u),u>=0&&u<=100)?(this.set(d,u),!0):!1}};function is(p,d,u,o){var e=o?p.split(o):[p];for(var s in e)if(typeof e[s]=="string"){var c=e[s].split(u);if(c.length===2){var h=c[0],y=c[1];d(h,y)}}}var Fi=new ts(0,0,0),Qn=Fi.align==="middle"?"middle":"center";function yu(p,d,u){var o=p;function e(){var h=mu(p);if(h===null)throw new Error("Malformed timestamp: "+o);return p=p.replace(/^[^\sa-zA-Z-]+/,""),h}function s(h,y){var b=new ns;is(h,function(P,H){switch(P){case"region":for(var Q=u.length-1;Q>=0;Q--)if(u[Q].id===H){b.set(P,u[Q].region);break}break;case"vertical":b.alt(P,H,["rl","lr"]);break;case"line":var fe=H.split(","),_e=fe[0];b.integer(P,_e),b.percent(P,_e)&&b.set("snapToLines",!1),b.alt(P,_e,["auto"]),fe.length===2&&b.alt("lineAlign",fe[1],["start",Qn,"end"]);break;case"position":fe=H.split(","),b.percent(P,fe[0]),fe.length===2&&b.alt("positionAlign",fe[1],["start",Qn,"end","line-left","line-right","auto"]);break;case"size":b.percent(P,H);break;case"align":b.alt(P,H,["start",Qn,"end","left","right"]);break}},/:/,/\s/),y.region=b.get("region",null),y.vertical=b.get("vertical","");var C=b.get("line","auto");C==="auto"&&Fi.line===-1&&(C=-1),y.line=C,y.lineAlign=b.get("lineAlign","start"),y.snapToLines=b.get("snapToLines",!0),y.size=b.get("size",100),y.align=b.get("align",Qn);var O=b.get("position","auto");O==="auto"&&Fi.position===50&&(O=y.align==="start"||y.align==="left"?0:y.align==="end"||y.align==="right"?100:50),y.position=O}function c(){p=p.replace(/^\s+/,"")}if(c(),d.startTime=e(),c(),p.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+o);p=p.substr(3),c(),d.endTime=e(),c(),s(p,d)}function as(p){return p.replace(/<br(?: \/)?>/gi,`
`)}rs.prototype={parse:function(d){var u=this;d&&(u.buffer+=u.decoder.decode(d,{stream:!0}));function o(){var b=u.buffer,C=0;for(b=as(b);C<b.length&&b[C]!=="\r"&&b[C]!==`
`;)++C;var O=b.substr(0,C);return b[C]==="\r"&&++C,b[C]===`
`&&++C,u.buffer=b.substr(C),O}function e(b){is(b,function(C,O){},/:/)}try{var s;if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;s=o();var c=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var h=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(h?h=!1:s=o(),u.state){case"HEADER":/:/.test(s)?e(s):s||(u.state="ID");continue;case"NOTE":s||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){u.state="NOTE";break}if(!s)continue;if(u.cue=new ts(0,0,""),u.state="CUE",s.indexOf("-->")===-1){u.cue.id=s;continue}case"CUE":try{yu(s,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":var y=s.indexOf("-->")!==-1;if(!s||y&&(h=!0)){u.oncue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}u.cue.text&&(u.cue.text+=`
`),u.cue.text+=s;continue;case"BADCUE":s||(u.state="ID");continue}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var d=this;try{if(d.buffer+=d.decoder.decode(),(d.cue||d.state==="HEADER")&&(d.buffer+=`

`,d.parse()),d.state==="INITIAL")throw new Error("Malformed WebVTT signature.")}catch(u){throw u}return d.onflush&&d.onflush(),this}};var Au=rs;function Eu(p,d,u,o){for(var e=[],s,c,h,y,b,C=window.VTTCue||TextTrackCue,O=0;O<o.rows.length;O++)if(s=o.rows[O],h=!0,y=0,b="",!s.isEmpty()){for(var P=0;P<s.chars.length;P++)s.chars[P].uchar.match(/\s/)&&h?y++:(b+=s.chars[P].uchar,h=!1);s.cueStartTime=d,d===u&&(u+=1e-4),c=new C(d,u,as(b.trim())),y>=16?y--:y++,navigator.userAgent.match(/Firefox\//)?c.line=O+1:c.line=O>7?O-2:O+1,c.align="left",c.position=Math.max(0,Math.min(100,100*(y/32))),e.push(c),p&&p.addCue(c)}return e}var ss={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},os=function(d){var u=d;return ss.hasOwnProperty(d)&&(u=ss[d]),String.fromCharCode(u)},er=15,mr=100,_u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},bu={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Tu={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},xu={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Su=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],$e;(function(p){p[p.ERROR=0]="ERROR",p[p.TEXT=1]="TEXT",p[p.WARNING=2]="WARNING",p[p.INFO=2]="INFO",p[p.DEBUG=3]="DEBUG",p[p.DATA=3]="DATA"})($e||($e={}));var ku=function(){function p(){this.time=null,this.verboseLevel=$e.ERROR}var d=p.prototype;return d.log=function(o,e){this.verboseLevel>=o&&A.logger.log(this.time+" ["+o+"] "+e)},p}(),Vr=function(d){for(var u=[],o=0;o<d.length;o++)u.push(d[o].toString(16));return u},ls=function(){function p(u,o,e,s,c){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=u||"white",this.underline=o||!1,this.italics=e||!1,this.background=s||"black",this.flash=c||!1}var d=p.prototype;return d.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},d.setStyles=function(o){for(var e=["foreground","underline","italics","background","flash"],s=0;s<e.length;s++){var c=e[s];o.hasOwnProperty(c)&&(this[c]=o[c])}},d.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},d.equals=function(o){return this.foreground===o.foreground&&this.underline===o.underline&&this.italics===o.italics&&this.background===o.background&&this.flash===o.flash},d.copy=function(o){this.foreground=o.foreground,this.underline=o.underline,this.italics=o.italics,this.background=o.background,this.flash=o.flash},d.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},p}(),Ru=function(){function p(u,o,e,s,c,h){this.uchar=void 0,this.penState=void 0,this.uchar=u||" ",this.penState=new ls(o,e,s,c,h)}var d=p.prototype;return d.reset=function(){this.uchar=" ",this.penState.reset()},d.setChar=function(o,e){this.uchar=o,this.penState.copy(e)},d.setPenState=function(o){this.penState.copy(o)},d.equals=function(o){return this.uchar===o.uchar&&this.penState.equals(o.penState)},d.copy=function(o){this.uchar=o.uchar,this.penState.copy(o.penState)},d.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},p}(),Cu=function(){function p(u){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var o=0;o<mr;o++)this.chars.push(new Ru);this.logger=u,this.pos=0,this.currPenState=new ls}var d=p.prototype;return d.equals=function(o){for(var e=!0,s=0;s<mr;s++)if(!this.chars[s].equals(o.chars[s])){e=!1;break}return e},d.copy=function(o){for(var e=0;e<mr;e++)this.chars[e].copy(o.chars[e])},d.isEmpty=function(){for(var o=!0,e=0;e<mr;e++)if(!this.chars[e].isEmpty()){o=!1;break}return o},d.setCursor=function(o){this.pos!==o&&(this.pos=o),this.pos<0?(this.logger.log($e.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>mr&&(this.logger.log($e.DEBUG,"Too large cursor position "+this.pos),this.pos=mr)},d.moveCursor=function(o){var e=this.pos+o;if(o>1)for(var s=this.pos+1;s<e+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(e)},d.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},d.insertChar=function(o){o>=144&&this.backSpace();var e=os(o);if(this.pos>=mr){this.logger.log($e.ERROR,"Cannot insert "+o.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)},d.clearFromPos=function(o){var e;for(e=o;e<mr;e++)this.chars[e].reset()},d.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},d.clearToEndOfRow=function(){this.clearFromPos(this.pos)},d.getTextString=function(){for(var o=[],e=!0,s=0;s<mr;s++){var c=this.chars[s].uchar;c!==" "&&(e=!1),o.push(c)}return e?"":o.join("")},d.setPenStyles=function(o){this.currPenState.setStyles(o);var e=this.chars[this.pos];e.setPenState(this.currPenState)},p}(),Mi=function(){function p(u){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var o=0;o<er;o++)this.rows.push(new Cu(u));this.logger=u,this.currRow=er-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var d=p.prototype;return d.reset=function(){for(var o=0;o<er;o++)this.rows[o].clear();this.currRow=er-1},d.equals=function(o){for(var e=!0,s=0;s<er;s++)if(!this.rows[s].equals(o.rows[s])){e=!1;break}return e},d.copy=function(o){for(var e=0;e<er;e++)this.rows[e].copy(o.rows[e])},d.isEmpty=function(){for(var o=!0,e=0;e<er;e++)if(!this.rows[e].isEmpty()){o=!1;break}return o},d.backSpace=function(){var o=this.rows[this.currRow];o.backSpace()},d.clearToEndOfRow=function(){var o=this.rows[this.currRow];o.clearToEndOfRow()},d.insertChar=function(o){var e=this.rows[this.currRow];e.insertChar(o)},d.setPen=function(o){var e=this.rows[this.currRow];e.setPenStyles(o)},d.moveCursor=function(o){var e=this.rows[this.currRow];e.moveCursor(o)},d.setCursor=function(o){this.logger.log($e.INFO,"setCursor: "+o);var e=this.rows[this.currRow];e.setCursor(o)},d.setPAC=function(o){this.logger.log($e.INFO,"pacData = "+JSON.stringify(o));var e=o.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var s=0;s<er;s++)this.rows[s].clear();var c=this.currRow+1-this.nrRollUpRows,h=this.lastOutputScreen;if(h){var y=h.rows[c].cueStartTime,b=this.logger.time;if(y&&b!==null&&y<b)for(var C=0;C<this.nrRollUpRows;C++)this.rows[e-this.nrRollUpRows+C+1].copy(h.rows[c+C])}}this.currRow=e;var O=this.rows[this.currRow];if(o.indent!==null){var P=o.indent,H=Math.max(P-1,0);O.setCursor(o.indent),o.color=O.chars[H].penState.foreground}var Q={foreground:o.color,underline:o.underline,italics:o.italics,background:"black",flash:!1};this.setPen(Q)},d.setBkgData=function(o){this.logger.log($e.INFO,"bkgData = "+JSON.stringify(o)),this.backSpace(),this.setPen(o),this.insertChar(32)},d.setRollUpRows=function(o){this.nrRollUpRows=o},d.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log($e.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log($e.TEXT,this.getDisplayText());var o=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(o,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log($e.INFO,"Rolling up")},d.getDisplayText=function(o){o=o||!1;for(var e=[],s="",c=-1,h=0;h<er;h++){var y=this.rows[h].getTextString();y&&(c=h+1,o?e.push("Row "+c+": '"+y+"'"):e.push(y.trim()))}return e.length>0&&(o?s="["+e.join(" | ")+"]":s=e.join(`
`)),s},d.getTextAndFormat=function(){return this.rows},p}(),us=function(){function p(u,o,e){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=u,this.outputFilter=o,this.mode=null,this.verbose=0,this.displayedMemory=new Mi(e),this.nonDisplayedMemory=new Mi(e),this.lastOutputScreen=new Mi(e),this.currRollUpRow=this.displayedMemory.rows[er-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=e}var d=p.prototype;return d.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[er-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},d.getHandler=function(){return this.outputFilter},d.setHandler=function(o){this.outputFilter=o},d.setPAC=function(o){this.writeScreen.setPAC(o)},d.setBkgData=function(o){this.writeScreen.setBkgData(o)},d.setMode=function(o){o!==this.mode&&(this.mode=o,this.logger.log($e.INFO,"MODE="+o),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=o)},d.insertChars=function(o){for(var e=0;e<o.length;e++)this.writeScreen.insertChar(o[e]);var s=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log($e.INFO,s+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log($e.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},d.ccRCL=function(){this.logger.log($e.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},d.ccBS=function(){this.logger.log($e.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},d.ccAOF=function(){},d.ccAON=function(){},d.ccDER=function(){this.logger.log($e.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},d.ccRU=function(o){this.logger.log($e.INFO,"RU("+o+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(o)},d.ccFON=function(){this.logger.log($e.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},d.ccRDC=function(){this.logger.log($e.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},d.ccTR=function(){this.logger.log($e.INFO,"TR"),this.setMode("MODE_TEXT")},d.ccRTD=function(){this.logger.log($e.INFO,"RTD"),this.setMode("MODE_TEXT")},d.ccEDM=function(){this.logger.log($e.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},d.ccCR=function(){this.logger.log($e.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},d.ccENM=function(){this.logger.log($e.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},d.ccEOC=function(){if(this.logger.log($e.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var o=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=o,this.writeScreen=this.nonDisplayedMemory,this.logger.log($e.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},d.ccTO=function(o){this.logger.log($e.INFO,"TO("+o+") - Tab Offset"),this.writeScreen.moveCursor(o)},d.ccMIDROW=function(o){var e={flash:!1};if(e.underline=o%2===1,e.italics=o>=46,e.italics)e.foreground="white";else{var s=Math.floor(o/2)-16,c=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=c[s]}this.logger.log($e.INFO,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},d.outputDataUpdate=function(o){o===void 0&&(o=!1);var e=this.logger.time;e!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=e:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),o&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e),this.lastOutputScreen.copy(this.displayedMemory))},d.cueSplitAtTime=function(o){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,o,this.displayedMemory),this.cueStartTime=o))},p}(),wu=function(){function p(u,o,e){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var s=new ku;this.channels=[null,new us(u,o,s),new us(u+1,e,s)],this.cmdHistory=fs(),this.logger=s}var d=p.prototype;return d.getHandler=function(o){return this.channels[o].getHandler()},d.setHandler=function(o,e){this.channels[o].setHandler(e)},d.addData=function(o,e){var s,c,h,y=!1;this.logger.time=o;for(var b=0;b<e.length;b+=2)if(c=e[b]&127,h=e[b+1]&127,!(c===0&&h===0)){if(this.logger.log($e.DATA,"["+Vr([e[b],e[b+1]])+"] -> ("+Vr([c,h])+")"),s=this.parseCmd(c,h),s||(s=this.parseMidrow(c,h)),s||(s=this.parsePAC(c,h)),s||(s=this.parseBackgroundAttributes(c,h)),!s&&(y=this.parseChars(c,h),y)){var C=this.currentChannel;if(C&&C>0){var O=this.channels[C];O.insertChars(y)}else this.logger.log($e.WARNING,"No channel found yet. TEXT-MODE?")}!s&&!y&&this.logger.log($e.WARNING,"Couldn't parse cleaned data "+Vr([c,h])+" orig: "+Vr([e[b],e[b+1]]))}},d.parseCmd=function(o,e){var s=this.cmdHistory,c=(o===20||o===28||o===21||o===29)&&e>=32&&e<=47,h=(o===23||o===31)&&e>=33&&e<=35;if(!(c||h))return!1;if(cs(o,e,s))return an(null,null,s),this.logger.log($e.DEBUG,"Repeated command ("+Vr([o,e])+") is dropped"),!0;var y=o===20||o===21||o===23?1:2,b=this.channels[y];return o===20||o===21||o===28||o===29?e===32?b.ccRCL():e===33?b.ccBS():e===34?b.ccAOF():e===35?b.ccAON():e===36?b.ccDER():e===37?b.ccRU(2):e===38?b.ccRU(3):e===39?b.ccRU(4):e===40?b.ccFON():e===41?b.ccRDC():e===42?b.ccTR():e===43?b.ccRTD():e===44?b.ccEDM():e===45?b.ccCR():e===46?b.ccENM():e===47&&b.ccEOC():b.ccTO(e-32),an(o,e,s),this.currentChannel=y,!0},d.parseMidrow=function(o,e){var s=0;if((o===17||o===25)&&e>=32&&e<=47){if(o===17?s=1:s=2,s!==this.currentChannel)return this.logger.log($e.ERROR,"Mismatch channel in midrow parsing"),!1;var c=this.channels[s];return c?(c.ccMIDROW(e),this.logger.log($e.DEBUG,"MIDROW ("+Vr([o,e])+")"),!0):!1}return!1},d.parsePAC=function(o,e){var s,c=this.cmdHistory,h=(o>=17&&o<=23||o>=25&&o<=31)&&e>=64&&e<=127,y=(o===16||o===24)&&e>=64&&e<=95;if(!(h||y))return!1;if(cs(o,e,c))return an(null,null,c),!0;var b=o<=23?1:2;e>=64&&e<=95?s=b===1?_u[o]:Tu[o]:s=b===1?bu[o]:xu[o];var C=this.channels[b];return C?(C.setPAC(this.interpretPAC(s,e)),an(o,e,c),this.currentChannel=b,!0):!1},d.interpretPAC=function(o,e){var s=e,c={color:null,italics:!1,indent:null,underline:!1,row:o};return e>95?s=e-96:s=e-64,c.underline=(s&1)===1,s<=13?c.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(c.italics=!0,c.color="white"):c.indent=Math.floor((s-16)/2)*4,c},d.parseChars=function(o,e){var s,c=null,h=null;if(o>=25?(s=2,h=o-8):(s=1,h=o),h>=17&&h<=19){var y=e;h===17?y=e+80:h===18?y=e+112:y=e+144,this.logger.log($e.INFO,"Special char '"+os(y)+"' in channel "+s),c=[y]}else o>=32&&o<=127&&(c=e===0?[o]:[o,e]);if(c){var b=Vr(c);this.logger.log($e.DEBUG,"Char codes =  "+b.join(",")),an(o,e,this.cmdHistory)}return c},d.parseBackgroundAttributes=function(o,e){var s=(o===16||o===24)&&e>=32&&e<=47,c=(o===23||o===31)&&e>=45&&e<=47;if(!(s||c))return!1;var h,y={};o===16||o===24?(h=Math.floor((e-32)/2),y.background=Su[h],e%2===1&&(y.background=y.background+"_semi")):e===45?y.background="transparent":(y.foreground="black",e===47&&(y.underline=!0));var b=o<=23?1:2,C=this.channels[b];return C.setBkgData(y),an(o,e,this.cmdHistory),!0},d.reset=function(){for(var o=0;o<Object.keys(this.channels).length;o++){var e=this.channels[o];e&&e.reset()}this.cmdHistory=fs()},d.cueSplitAtTime=function(o){for(var e=0;e<this.channels.length;e++){var s=this.channels[e];s&&s.cueSplitAtTime(o)}},p}();function an(p,d,u){u.a=p,u.b=d}function cs(p,d,u){return u.a===p&&u.b===d}function fs(){return{a:null,b:null}}var ds=wu,Jn=function(){function p(u,o){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=u,this.trackName=o}var d=p.prototype;return d.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},d.newCue=function(o,e,s){(this.startTime===null||this.startTime>o)&&(this.startTime=o),this.endTime=e,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)},d.reset=function(){this.cueRanges=[]},p}(),Bi=function(d,u,o){return d.substr(o||0,u.length)===u},Lu=function(d){var u=parseInt(d.substr(-3)),o=parseInt(d.substr(-6,2)),e=parseInt(d.substr(-9,2)),s=d.length>9?parseInt(d.substr(0,d.indexOf(":"))):0;if(!Object(T.isFiniteNumber)(u)||!Object(T.isFiniteNumber)(o)||!Object(T.isFiniteNumber)(e)||!Object(T.isFiniteNumber)(s))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+d);return u+=1e3*o,u+=60*1e3*e,u+=60*60*1e3*s,u},Ui=function(d){for(var u=5381,o=d.length;o;)u=u*33^d.charCodeAt(--o);return(u>>>0).toString()},Iu=function(d,u,o){var e=d[u],s=d[e.prevCC];if(!s||!s.new&&e.new){d.ccOffset=d.presentationOffset=e.start,e.new=!1;return}for(;s&&s.new;)d.ccOffset+=e.start-s.start,e.new=!1,e=s,s=d[e.prevCC];d.presentationOffset=o},Ou={parse:function(d,u,o,e,s,c){var h=/\r\n|\n\r|\n|\r/g,y=Object(Rn.utf8ArrayToStr)(new Uint8Array(d)).trim().replace(h,`
`).split(`
`),b="00:00.000",C=0,O=0,P=0,H=[],Q,fe=!0,_e=!1,Ie=new Au;Ie.oncue=function(Ce){var Fe=o[e],Ke=o.ccOffset;Fe&&Fe.new&&(O!==void 0?Ke=o.ccOffset=Fe.start:Iu(o,e,P)),P&&(Ke=P-o.presentationOffset),_e&&(Ce.startTime+=Ke-O,Ce.endTime+=Ke-O),Ce.id=Ui(Ce.startTime.toString())+Ui(Ce.endTime.toString())+Ui(Ce.text),Ce.text=decodeURIComponent(encodeURIComponent(Ce.text)),Ce.endTime>0&&H.push(Ce)},Ie.onparsingerror=function(Ce){Q=Ce},Ie.onflush=function(){if(Q&&c){c(Q);return}s(H)},y.forEach(function(Ce){if(fe)if(Bi(Ce,"X-TIMESTAMP-MAP=")){fe=!1,_e=!0,Ce.substr(16).split(",").forEach(function(Fe){Bi(Fe,"LOCAL:")?b=Fe.substr(6):Bi(Fe,"MPEGTS:")&&(C=parseInt(Fe.substr(7)))});try{u+(o[e].start*9e4||0)<0&&(u+=8589934592),C-=u,O=Lu(b)/1e3,P=C/9e4}catch(Fe){_e=!1,Q=Fe}return}else Ce===""&&(fe=!1);Ie.parse(Ce+`
`)}),Ie.flush()}},Du=Ou;function ei(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function Pu(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Nu=function(p){Pu(d,p);function d(o){var e;if(e=p.call(this,o,m.default.MEDIA_ATTACHING,m.default.MEDIA_DETACHING,m.default.FRAG_PARSING_USERDATA,m.default.FRAG_DECRYPTED,m.default.MANIFEST_LOADING,m.default.MANIFEST_LOADED,m.default.FRAG_LOADED,m.default.INIT_PTS_FOUND)||this,e.media=null,e.config=void 0,e.enabled=!0,e.Cues=void 0,e.textTracks=[],e.tracks=[],e.initPTS=[],e.unparsedVttFrags=[],e.captionsTracks={},e.nonNativeCaptionsTracks={},e.captionsProperties=void 0,e.cea608Parser1=void 0,e.cea608Parser2=void 0,e.lastSn=-1,e.prevCC=-1,e.vttCCs=hs(),e.hls=o,e.config=o.config,e.Cues=o.config.cueHandler,e.captionsProperties={textTrack1:{label:e.config.captionsTextTrack1Label,languageCode:e.config.captionsTextTrack1LanguageCode},textTrack2:{label:e.config.captionsTextTrack2Label,languageCode:e.config.captionsTextTrack2LanguageCode},textTrack3:{label:e.config.captionsTextTrack3Label,languageCode:e.config.captionsTextTrack3LanguageCode},textTrack4:{label:e.config.captionsTextTrack4Label,languageCode:e.config.captionsTextTrack4LanguageCode}},e.config.enableCEA708Captions){var s=new Jn(ei(e),"textTrack1"),c=new Jn(ei(e),"textTrack2"),h=new Jn(ei(e),"textTrack3"),y=new Jn(ei(e),"textTrack4");e.cea608Parser1=new ds(1,s,c),e.cea608Parser2=new ds(3,h,y)}return e}var u=d.prototype;return u.addCues=function(e,s,c,h,y){for(var b=!1,C=y.length;C--;){var O=y[C],P=Mu(O[0],O[1],s,c);if(P>=0&&(O[0]=Math.min(O[0],s),O[1]=Math.max(O[1],c),b=!0,P/(c-s)>.5))return}if(b||y.push([s,c]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],s,c,h);else{var H=this.Cues.newCue(null,s,c,h);this.hls.trigger(m.default.CUES_PARSED,{type:"captions",cues:H,track:e})}},u.onInitPtsFound=function(e){var s=this,c=e.frag,h=e.id,y=e.initPTS,b=this.unparsedVttFrags;h==="main"&&(this.initPTS[c.cc]=y),b.length&&(this.unparsedVttFrags=[],b.forEach(function(C){s.onFragLoaded(C)}))},u.getExistingTrack=function(e){var s=this.media;if(s)for(var c=0;c<s.textTracks.length;c++){var h=s.textTracks[c];if(h[e])return h}return null},u.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},u.createNativeTrack=function(e){if(!this.captionsTracks[e]){var s=this.captionsProperties,c=this.captionsTracks,h=this.media,y=s[e],b=y.label,C=y.languageCode,O=this.getExistingTrack(e);if(O)c[e]=O,Kr(c[e]),rn(c[e],h);else{var P=this.createTextTrack("captions",b,C);P&&(P[e]=!0,c[e]=P)}}},u.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var s=this.captionsProperties[e];if(!!s){var c=s.label,h={_id:e,label:c,kind:"captions",default:s.media?!!s.media.default:!1,closedCaptions:s.media};this.nonNativeCaptionsTracks[e]=h,this.hls.trigger(m.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[h]})}}},u.createTextTrack=function(e,s,c){var h=this.media;if(!!h)return h.addTextTrack(e,s,c)},u.destroy=function(){p.prototype.destroy.call(this)},u.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},u.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(s){Kr(e[s]),delete e[s]}),this.nonNativeCaptionsTracks={}},u.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=hs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},u._cleanTracks=function(){var e=this.media;if(!!e){var s=e.textTracks;if(s)for(var c=0;c<s.length;c++)Kr(s[c])}},u.onManifestLoaded=function(e){var s=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var c=e.subtitles||[],h=this.tracks&&c&&this.tracks.length===c.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var y=this.media?this.media.textTracks:[];this.tracks.forEach(function(C,O){var P;if(O<y.length){for(var H=null,Q=0;Q<y.length;Q++)if(Fu(y[Q],C)){H=y[Q];break}H&&(P=H)}P||(P=s.createTextTrack("subtitles",C.name,C.lang)),C.default?P.mode=s.hls.subtitleDisplay?"showing":"hidden":P.mode="disabled",s.textTracks.push(P)})}else if(!h&&this.tracks&&this.tracks.length){var b=this.tracks.map(function(C){return{label:C.name,kind:C.type.toLowerCase(),default:C.default,subtitleTrack:C}});this.hls.trigger(m.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:b})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(function(C){var O=/(?:CC|SERVICE)([1-4])/.exec(C.instreamId);if(!!O){var P="textTrack"+O[1],H=s.captionsProperties[P];!H||(H.label=C.name,C.lang&&(H.languageCode=C.lang),H.media=C)}})},u.onFragLoaded=function(e){var s=e.frag,c=e.payload,h=this.cea608Parser1,y=this.cea608Parser2,b=this.initPTS,C=this.lastSn,O=this.unparsedVttFrags;if(s.type==="main"){var P=s.sn;s.sn!==C+1&&h&&y&&(h.reset(),y.reset()),this.lastSn=P}else if(s.type==="subtitle")if(c.byteLength){if(!Object(T.isFiniteNumber)(b[s.cc])){O.push(e),b.length&&this.hls.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s});return}var H=s.decryptdata;(H==null||H.key==null||H.method!=="AES-128")&&this._parseVTTs(s,c)}else this.hls.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s})},u._parseVTTs=function(e,s){var c=this,h=this.hls,y=this.prevCC,b=this.textTracks,C=this.vttCCs;C[e.cc]||(C[e.cc]={start:e.start,prevCC:y,new:!0},this.prevCC=e.cc),Du.parse(s,this.initPTS[e.cc],C,e.cc,function(O){if(c.config.renderTextTracksNatively){var P=b[e.level];if(P.mode==="disabled"){h.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e});return}O.forEach(function(Q){if(!P.cues.getCueById(Q.id))try{if(P.addCue(Q),!P.cues.getCueById(Q.id))throw new Error("addCue is failed for: "+Q)}catch(_e){A.logger.debug("Failed occurred on adding cues: "+_e);var fe=new window.TextTrackCue(Q.startTime,Q.endTime,Q.text);fe.id=Q.id,P.addCue(fe)}})}else{var H=c.tracks[e.level].default?"default":"subtitles"+e.level;h.trigger(m.default.CUES_PARSED,{type:"subtitles",cues:O,track:H})}h.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(O){A.logger.log("Failed to parse VTT cue: "+O),h.trigger(m.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})})},u.onFragDecrypted=function(e){var s=e.frag,c=e.payload;if(s.type==="subtitle"){if(!Object(T.isFiniteNumber)(this.initPTS[s.cc])){this.unparsedVttFrags.push(e);return}this._parseVTTs(s,c)}},u.onFragParsingUserdata=function(e){var s=this.cea608Parser1,c=this.cea608Parser2;if(!(!this.enabled||!(s&&c)))for(var h=0;h<e.samples.length;h++){var y=e.samples[h].bytes;if(y){var b=this.extractCea608Data(y);s.addData(e.samples[h].pts,b[0]),c.addData(e.samples[h].pts,b[1])}}},u.extractCea608Data=function(e){for(var s=e[0]&31,c=2,h=[[],[]],y=0;y<s;y++){var b=e[c++],C=127&e[c++],O=127&e[c++],P=(4&b)!==0,H=3&b;C===0&&O===0||P&&(H===0||H===1)&&(h[H].push(C),h[H].push(O))}return h},d}(L);function Fu(p,d){return p&&p.label===d.name&&!(p.textTrack1||p.textTrack2)}function Mu(p,d,u,o){return Math.min(d,o)-Math.max(p,u)}function hs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}var Bu=Nu;function gs(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Uu(p,d,u){return d&&gs(p.prototype,d),u&&gs(p,u),p}function Ku(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var Vu=function(p){Ku(d,p);function d(o){var e;return e=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.MANIFEST_LOADED,m.default.SUBTITLE_TRACK_LOADED)||this,e.tracks=[],e.trackId=-1,e.media=null,e.stopped=!0,e.subtitleDisplay=!0,e.queuedDefaultTrack=null,e}var u=d.prototype;return u.destroy=function(){L.prototype.destroy.call(this)},u.onMediaAttached=function(e){var s=this;this.media=e.media,this.media&&(Object(T.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){s.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},u.onMediaDetaching=function(){if(!!this.media){this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(T.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack);var e=Ki(this.media.textTracks);e.forEach(function(s){Kr(s)}),this.subtitleTrack=-1,this.media=null}},u.onManifestLoaded=function(e){var s=this,c=e.subtitles||[];this.tracks=c,this.hls.trigger(m.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:c}),c.forEach(function(h){h.default&&(s.media?s.subtitleTrack=h.id:s.queuedDefaultTrack=h.id)})},u.onSubtitleTrackLoaded=function(e){var s=this,c=e.id,h=e.details,y=this.trackId,b=this.tracks,C=b[y];if(c>=b.length||c!==y||!C||this.stopped){this._clearReloadTimer();return}if(A.logger.log("subtitle track "+c+" loaded"),h.live){var O=Ge(C.details,h,e.stats.trequest);A.logger.log("Reloading live subtitle playlist in "+O+"ms"),this.timer=setTimeout(function(){s._loadCurrentTrack()},O)}else this._clearReloadTimer()},u.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},u.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},u._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},u._loadCurrentTrack=function(){var e=this.trackId,s=this.tracks,c=this.hls,h=s[e];e<0||!h||h.details&&!h.details.live||(A.logger.log("Loading subtitle track "+e),c.trigger(m.default.SUBTITLE_TRACK_LOADING,{url:h.url,id:e}))},u._toggleTrackModes=function(e){var s=this.media,c=this.subtitleDisplay,h=this.trackId;if(!!s){var y=Ki(s.textTracks);if(e===-1)[].slice.call(y).forEach(function(O){O.mode="disabled"});else{var b=y[h];b&&(b.mode="disabled")}var C=y[e];C&&(C.mode=c?"showing":"hidden")}},u._setSubtitleTrackInternal=function(e){var s=this.hls,c=this.tracks;!Object(T.isFiniteNumber)(e)||e<-1||e>=c.length||(this.trackId=e,A.logger.log("Switching to subtitle track "+e),s.trigger(m.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},u._onTextTracksChanged=function(){if(!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var e=-1,s=Ki(this.media.textTracks),c=0;c<s.length;c++)if(s[c].mode==="hidden")e=c;else if(s[c].mode==="showing"){e=c;break}this.subtitleTrack=e}},Uu(d,[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}]),d}(L);function Ki(p){for(var d=[],u=0;u<p.length;u++){var o=p[u];o.kind==="subtitles"&&o.label&&d.push(p[u])}return d}var Gu=Vu,Hu=r("./src/crypt/decrypter.js");function ju(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function Yu(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var zu=window,ps=zu.performance,Vi=500,Wu=function(p){Yu(d,p);function d(o,e){var s;return s=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHING,m.default.ERROR,m.default.KEY_LOADED,m.default.FRAG_LOADED,m.default.SUBTITLE_TRACKS_UPDATED,m.default.SUBTITLE_TRACK_SWITCH,m.default.SUBTITLE_TRACK_LOADED,m.default.SUBTITLE_FRAG_PROCESSED,m.default.LEVEL_UPDATED)||this,s.fragmentTracker=e,s.config=o.config,s.state=te.STOPPED,s.tracks=[],s.tracksBuffered=[],s.currentTrackId=-1,s.decrypter=new Hu.default(o,o.config),s.lastAVStart=0,s._onMediaSeeking=s.onMediaSeeking.bind(ju(s)),s}var u=d.prototype;return u.startLoad=function(){this.stopLoad(),this.state=te.IDLE;var e=this.tracks[this.currentTrackId];e&&e.details&&(this.setInterval(Vi),this.tick())},u.onSubtitleFragProcessed=function(e){var s=e.frag,c=e.success;if(this.fragPrevious=s,this.state=te.IDLE,!!c){var h=this.tracksBuffered[this.currentTrackId];if(!!h){for(var y,b=s.start,C=0;C<h.length;C++)if(b>=h[C].start&&b<=h[C].end){y=h[C];break}var O=s.start+s.duration;y?y.end=O:(y={start:b,end:O},h.push(y))}}},u.onMediaAttached=function(e){var s=e.media;this.media=s,s.addEventListener("seeking",this._onMediaSeeking),this.state=te.IDLE},u.onMediaDetaching=function(){var e=this;!this.media||(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(s){e.tracksBuffered[s.id]=[]}),this.media=null,this.state=te.STOPPED)},u.onError=function(e){var s=e.frag;!s||s.type!=="subtitle"||(this.fragCurrent&&this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.state=te.IDLE)},u.onSubtitleTracksUpdated=function(e){var s=this;A.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(c){s.tracksBuffered[c.id]=[]})},u.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,!this.tracks||!this.tracks.length||this.currentTrackId===-1){this.clearInterval();return}var s=this.tracks[this.currentTrackId];s&&s.details&&this.setInterval(Vi)},u.onSubtitleTrackLoaded=function(e){var s=e.id,c=e.details,h=this.currentTrackId,y=this.tracks,b=y[h];s>=y.length||s!==h||!b||(c.live&&Le(b.details,c,this.lastAVStart),b.details=c,this.setInterval(Vi))},u.onKeyLoaded=function(){this.state===te.KEY_LOADING&&(this.state=te.IDLE)},u.onFragLoaded=function(e){var s=this.fragCurrent,c=e.frag.decryptdata,h=e.frag,y=this.hls;if(this.state===te.FRAG_LOADING&&s&&e.frag.type==="subtitle"&&s.sn===e.frag.sn&&e.payload.byteLength>0&&c&&c.key&&c.method==="AES-128"){var b=ps.now();this.decrypter.decrypt(e.payload,c.key.buffer,c.iv.buffer,function(C){var O=ps.now();y.trigger(m.default.FRAG_DECRYPTED,{frag:h,payload:C,stats:{tstart:b,tdecrypt:O}})})}},u.onLevelUpdated=function(e){var s=e.details,c=s.fragments;this.lastAVStart=c.length?c[0].start:0},u.doTick=function(){if(!this.media){this.state=te.IDLE;return}switch(this.state){case te.IDLE:{var e=this.config,s=this.currentTrackId,c=this.fragmentTracker,h=this.media,y=this.tracks;if(!y||!y[s]||!y[s].details)break;var b=e.maxBufferHole,C=e.maxFragLookUpTolerance,O=Math.min(e.maxBufferLength,e.maxMaxBufferLength),P=R.bufferedInfo(this._getBuffered(),h.currentTime,b),H=P.end,Q=P.len,fe=y[s].details,_e=fe.fragments,Ie=_e.length,Ce=_e[Ie-1].start+_e[Ie-1].duration;if(Q>O)return;var Fe,Ke=this.fragPrevious;H<Ce?(Ke&&fe.hasProgramDateTime&&(Fe=Pt(_e,Ke.endProgramDateTime,C)),Fe||(Fe=yt(Ke,_e,H,C))):Fe=_e[Ie-1],Fe&&Fe.encrypted?(A.logger.log("Loading key for "+Fe.sn),this.state=te.KEY_LOADING,this.hls.trigger(m.default.KEY_LOADING,{frag:Fe})):Fe&&c.getState(Fe)===E.NOT_LOADED&&(this.fragCurrent=Fe,this.state=te.FRAG_LOADING,this.hls.trigger(m.default.FRAG_LOADING,{frag:Fe}))}}},u.stopLoad=function(){this.lastAVStart=0,this.fragPrevious=null,p.prototype.stopLoad.call(this)},u._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},u.onMediaSeeking=function(){if(this.fragCurrent){var e=this.media?this.media.currentTime:0,s=this.config.maxFragLookUpTolerance,c=this.fragCurrent.start-s,h=this.fragCurrent.start+this.fragCurrent.duration+s;(e<c||e>h)&&(this.fragCurrent.loader&&this.fragCurrent.loader.abort(),this.fragmentTracker.removeFragment(this.fragCurrent),this.fragCurrent=null,this.fragPrevious=null,this.state=te.IDLE,this.tick())}},d}(Nt),sn;(function(p){p.WIDEVINE="com.widevine.alpha",p.PLAYREADY="com.microsoft.playready"})(sn||(sn={}));var $u=function(){return typeof window<"u"&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}();function vs(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Xu(p,d,u){return d&&vs(p.prototype,d),u&&vs(p,u),p}function qu(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var ms=3,Zu=function(d,u,o){var e={audioCapabilities:[],videoCapabilities:[]};return d.forEach(function(s){e.audioCapabilities.push({contentType:'audio/mp4; codecs="'+s+'"',robustness:o.audioRobustness||""})}),u.forEach(function(s){e.videoCapabilities.push({contentType:'video/mp4; codecs="'+s+'"',robustness:o.videoRobustness||""})}),[e]},Qu=function(d,u,o,e){switch(d){case sn.WIDEVINE:return Zu(u,o,e);default:throw new Error("Unknown key-system: "+d)}},Ju=function(p){qu(d,p);function d(o){var e;return e=p.call(this,o,m.default.MEDIA_ATTACHED,m.default.MEDIA_DETACHED,m.default.MANIFEST_PARSED)||this,e._widevineLicenseUrl=void 0,e._licenseXhrSetup=void 0,e._emeEnabled=void 0,e._requestMediaKeySystemAccess=void 0,e._drmSystemOptions=void 0,e._config=void 0,e._mediaKeysList=[],e._media=null,e._hasSetMediaKeys=!1,e._requestLicenseFailureCount=0,e.mediaKeysPromise=null,e._onMediaEncrypted=function(s){if(A.logger.log('Media is encrypted using "'+s.initDataType+'" init data type'),!e.mediaKeysPromise){A.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),e.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var c=function(y){!e._media||(e._attemptSetMediaKeys(y),e._generateRequestWithPreferredKeySession(s.initDataType,s.initData))};e.mediaKeysPromise.then(c).catch(c)},e._config=o.config,e._widevineLicenseUrl=e._config.widevineLicenseUrl,e._licenseXhrSetup=e._config.licenseXhrSetup,e._emeEnabled=e._config.emeEnabled,e._requestMediaKeySystemAccess=e._config.requestMediaKeySystemAccessFunc,e._drmSystemOptions=o.config.drmSystemOptions,e}var u=d.prototype;return u.getLicenseServerUrl=function(e){switch(e){case sn.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},u._attemptKeySystemAccess=function(e,s,c){var h=this,y=Qu(e,s,c,this._drmSystemOptions);A.logger.log("Requesting encrypted media key-system access");var b=this.requestMediaKeySystemAccess(e,y);this.mediaKeysPromise=b.then(function(C){return h._onMediaKeySystemAccessObtained(e,C)}),b.catch(function(C){A.logger.error('Failed to obtain key-system "'+e+'" access:',C)})},u._onMediaKeySystemAccessObtained=function(e,s){var c=this;A.logger.log('Access for key-system "'+e+'" obtained');var h={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:s,mediaKeySystemDomain:e};this._mediaKeysList.push(h);var y=Promise.resolve().then(function(){return s.createMediaKeys()}).then(function(b){return h.mediaKeys=b,A.logger.log('Media-keys created for key-system "'+e+'"'),c._onMediaKeysCreated(),b});return y.catch(function(b){A.logger.error("Failed to create media-keys:",b)}),y},u._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach(function(s){s.mediaKeysSession||(s.mediaKeysSession=s.mediaKeys.createSession(),e._onNewMediaKeySession(s.mediaKeysSession))})},u._onNewMediaKeySession=function(e){var s=this;A.logger.log("New key-system session "+e.sessionId),e.addEventListener("message",function(c){s._onKeySessionMessage(e,c.message)},!1)},u._onKeySessionMessage=function(e,s){A.logger.log("Got EME message event, creating license request"),this._requestLicense(s,function(c){A.logger.log("Received license data (length: "+(c&&c.byteLength)+"), updating key-session"),e.update(c)})},u._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var s=this._mediaKeysList[0];if(!s||!s.mediaKeys){A.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}A.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(s.mediaKeys),this._hasSetMediaKeys=!0}},u._generateRequestWithPreferredKeySession=function(e,s){var c=this,h=this._mediaKeysList[0];if(!h){A.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(h.mediaKeysSessionInitialized){A.logger.warn("Key-Session already initialized but requested again");return}var y=h.mediaKeysSession;if(!y){A.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!s){A.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}A.logger.log('Generating key-session request for "'+e+'" init data type'),h.mediaKeysSessionInitialized=!0,y.generateRequest(e,s).then(function(){A.logger.debug("Key-session generation succeeded")}).catch(function(b){A.logger.error("Error generating key-session request:",b),c.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},u._createLicenseXhr=function(e,s,c){var h=new XMLHttpRequest,y=this._licenseXhrSetup;try{if(y)try{y(h,e)}catch{h.open("POST",e,!0),y(h,e)}h.readyState||h.open("POST",e,!0)}catch(b){throw new Error("issue setting up KeySystem license XHR "+b)}return h.responseType="arraybuffer",h.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,h,e,s,c),h},u._onLicenseRequestReadyStageChange=function(e,s,c,h){switch(e.readyState){case 4:if(e.status===200)this._requestLicenseFailureCount=0,A.logger.log("License request succeeded"),e.responseType!=="arraybuffer"&&A.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),h(e.response);else{if(A.logger.error("License Request XHR failed ("+s+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>ms){this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var y=ms-this._requestLicenseFailureCount+1;A.logger.warn("Retrying license request, "+y+" attempts left"),this._requestLicense(c,h)}break}},u._generateLicenseRequestChallenge=function(e,s){switch(e.mediaKeySystemDomain){case sn.WIDEVINE:return s}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},u._requestLicense=function(e,s){A.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c){A.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var h=this.getLicenseServerUrl(c.mediaKeySystemDomain),y=this._createLicenseXhr(h,e,s);A.logger.log("Sending license request to URL: "+h);var b=this._generateLicenseRequestChallenge(c,e);y.send(b)}catch(C){A.logger.error("Failure requesting DRM license: "+C),this.hls.trigger(m.default.ERROR,{type:g.ErrorTypes.KEY_SYSTEM_ERROR,details:g.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},u.onMediaAttached=function(e){if(!!this._emeEnabled){var s=e.media;this._media=s,s.addEventListener("encrypted",this._onMediaEncrypted)}},u.onMediaDetached=function(){var e=this._media,s=this._mediaKeysList;!e||(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(s.map(function(c){if(c.mediaKeysSession)return c.mediaKeysSession.close().catch(function(){})})).then(function(){return e.setMediaKeys(null)}).catch(function(){}))},u.onManifestParsed=function(e){if(!!this._emeEnabled){var s=e.levels.map(function(h){return h.audioCodec}),c=e.levels.map(function(h){return h.videoCodec});this._attemptKeySystemAccess(sn.WIDEVINE,s,c)}},Xu(d,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),d}(L),ec=Ju;function ys(p,d){var u=Object.keys(p);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(p);d&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(p,e).enumerable})),u.push.apply(u,o)}return u}function As(p){for(var d=1;d<arguments.length;d++){var u=arguments[d]!=null?arguments[d]:{};d%2?ys(Object(u),!0).forEach(function(o){tc(p,o,u[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(u)):ys(Object(u)).forEach(function(o){Object.defineProperty(p,o,Object.getOwnPropertyDescriptor(u,o))})}return p}function tc(p,d,u){return d in p?Object.defineProperty(p,d,{value:u,enumerable:!0,configurable:!0,writable:!0}):p[d]=u,p}var rc=As(As({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:su,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:zl,bufferController:Xl,capLevelController:Jl,fpsController:iu,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:$u,testBandwidth:!0},nc()),{},{subtitleStreamController:Wu,subtitleTrackController:Gu,timelineController:Bu,audioStreamController:pu,audioTrackController:cu,emeController:ec});function nc(){return{cueHandler:l,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Es(p,d){var u=Object.keys(p);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(p);d&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(p,e).enumerable})),u.push.apply(u,o)}return u}function _s(p){for(var d=1;d<arguments.length;d++){var u=arguments[d]!=null?arguments[d]:{};d%2?Es(Object(u),!0).forEach(function(o){ic(p,o,u[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(u)):Es(Object(u)).forEach(function(o){Object.defineProperty(p,o,Object.getOwnPropertyDescriptor(u,o))})}return p}function ic(p,d,u){return d in p?Object.defineProperty(p,d,{value:u,enumerable:!0,configurable:!0,writable:!0}):p[d]=u,p}function xt(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function bs(p,d){for(var u=0;u<d.length;u++){var o=d[u];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(p,o.key,o)}}function Ts(p,d,u){return d&&bs(p.prototype,d),u&&bs(p,u),p}function ac(p,d){p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.__proto__=d}var xs=function(p){ac(d,p),d.isSupported=function(){return Ni()},Ts(d,null,[{key:"version",get:function(){return"0.14.17"}},{key:"Events",get:function(){return m.default}},{key:"ErrorTypes",get:function(){return g.ErrorTypes}},{key:"ErrorDetails",get:function(){return g.ErrorDetails}},{key:"DefaultConfig",get:function(){return d.defaultConfig?d.defaultConfig:rc},set:function(e){d.defaultConfig=e}}]);function d(o){var e;o===void 0&&(o={}),e=p.call(this)||this,e.config=void 0,e._autoLevelCapping=void 0,e.abrController=void 0,e.capLevelController=void 0,e.levelController=void 0,e.streamController=void 0,e.networkControllers=void 0,e.audioTrackController=void 0,e.subtitleTrackController=void 0,e.emeController=void 0,e.coreComponents=void 0,e.media=null,e.url=null;var s=d.DefaultConfig;if((o.liveSyncDurationCount||o.liveMaxLatencyDurationCount)&&(o.liveSyncDuration||o.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");e.config=_s(_s({},s),o);var c=xt(e),h=c.config;if(h.liveMaxLatencyDurationCount!==void 0&&h.liveMaxLatencyDurationCount<=h.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(h.liveMaxLatencyDuration!==void 0&&(h.liveSyncDuration===void 0||h.liveMaxLatencyDuration<=h.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(A.enableLogs)(h.debug),e._autoLevelCapping=-1;var y=e.abrController=new h.abrController(xt(e)),b=new h.bufferController(xt(e)),C=e.capLevelController=new h.capLevelController(xt(e)),O=new h.fpsController(xt(e)),P=new pt(xt(e)),H=new G(xt(e)),Q=new ue(xt(e)),fe=new Pi(xt(e)),_e=e.levelController=new Di(xt(e)),Ie=new D(xt(e)),Ce=e.streamController=new Wn(xt(e),Ie),Fe=[_e,Ce],Ke=h.audioStreamController;Ke&&Fe.push(new Ke(xt(e),Ie)),e.networkControllers=Fe;var Xe=[P,H,Q,y,b,C,O,fe,Ie];if(Ke=h.audioTrackController,Ke){var gt=new Ke(xt(e));e.audioTrackController=gt,Xe.push(gt)}if(Ke=h.subtitleTrackController,Ke){var Vt=new Ke(xt(e));e.subtitleTrackController=Vt,Fe.push(Vt)}if(Ke=h.emeController,Ke){var Ct=new Ke(xt(e));e.emeController=Ct,Xe.push(Ct)}return Ke=h.subtitleStreamController,Ke&&Fe.push(new Ke(xt(e),Ie)),Ke=h.timelineController,Ke&&Xe.push(new Ke(xt(e))),e.coreComponents=Xe,e}var u=d.prototype;return u.destroy=function(){A.logger.log("destroy"),this.trigger(m.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},u.attachMedia=function(e){A.logger.log("attachMedia"),this.media=e,this.trigger(m.default.MEDIA_ATTACHING,{media:e})},u.detachMedia=function(){A.logger.log("detachMedia"),this.trigger(m.default.MEDIA_DETACHING),this.media=null},u.loadSource=function(e){e=f.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),A.logger.log("loadSource:"+e),this.url=e,this.trigger(m.default.MANIFEST_LOADING,{url:e})},u.startLoad=function(e){e===void 0&&(e=-1),A.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(s){s.startLoad(e)})},u.stopLoad=function(){A.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},u.swapAudioCodec=function(){A.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},u.recoverMediaError=function(){A.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},u.removeLevel=function(e,s){s===void 0&&(s=0),this.levelController.removeLevel(e,s)},Ts(d,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){A.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){A.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){A.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){A.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){A.logger.log("set startLevel:"+e),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var s=!!e;s!==this.config.capLevelToPlayerSize&&(s?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=s)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){A.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,s=this.config.minAutoBitrate,c=e?e.length:0,h=0;h<c;h++){var y=e[h].realBitrate?Math.max(e[h].realBitrate,e[h].bitrate):e[h].bitrate;if(y>s)return h}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,s=this.autoLevelCapping,c;return s===-1&&e&&e.length?c=e.length-1:c=s,c}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var s=this.audioTrackController;s&&(s.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var s=this.subtitleTrackController;s&&(s.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return e?e.subtitleDisplay:!1},set:function(e){var s=this.subtitleTrackController;s&&(s.subtitleDisplay=e)}}]),d}(z);xs.defaultConfig=void 0},"./src/polyfills/number.js":function(a,n,r){r.r(n),r.d(n,"isFiniteNumber",function(){return l}),r.d(n,"MAX_SAFE_INTEGER",function(){return f});var l=Number.isFinite||function(g){return typeof g=="number"&&isFinite(g)},f=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":function(a,n,r){r.r(n),r.d(n,"getSelfScope",function(){return l});function l(){return typeof window>"u"?self:window}},"./src/utils/logger.js":function(a,n,r){r.r(n),r.d(n,"enableLogs",function(){return L}),r.d(n,"logger",function(){return K});var l=r("./src/utils/get-self-scope.js");function f(){}var g={trace:f,debug:f,log:f,warn:f,info:f,error:f},T=g;function m(F,j){return j="["+F+"] > "+j,j}var A=Object(l.getSelfScope)();function U(F){var j=A.console[F];return j?function(){for(var $=arguments.length,X=new Array($),se=0;se<$;se++)X[se]=arguments[se];X[0]&&(X[0]=m(F,X[0])),j.apply(A.console,X)}:f}function w(F){for(var j=arguments.length,$=new Array(j>1?j-1:0),X=1;X<j;X++)$[X-1]=arguments[X];$.forEach(function(se){T[se]=F[se]?F[se].bind(F):U(se)})}var L=function(j){if(A.console&&j===!0||typeof j=="object"){w(j,"debug","log","info","warn","error");try{T.log()}catch{T=g}}else T=g},K=T}}).default})})(Nl);var ht=Fg(Nl.exports),Mg=xr.now,Bg=xr.assign,Ug=xr.listContainsIgnoreCase,Kg=-1;x.register("PLAYBACK_FRAGMENT_CHANGED");x.register("PLAYBACK_FRAGMENT_PARSING_METADATA");var Fl=function(t){xg(a,t);var i=Cg(a);function a(){var n;_g(this,a);for(var r=arguments.length,l=new Array(r),f=0;f<r;f++)l[f]=arguments[f];return n=i.call.apply(i,[this].concat(l)),n.options.playback=ci(ci({},n.options),n.options.playback),n.options.hlsPlayback=ci(ci({},n.defaultOptions),n.options.hlsPlayback),n._minDvrSize=typeof n.options.hlsMinimumDvrSize>"u"?60:n.options.hlsMinimumDvrSize,n._extrapolatedWindowNumSegments=!n.options.playback||typeof n.options.playback.extrapolatedWindowNumSegments>"u"?2:n.options.playback.extrapolatedWindowNumSegments,n._playbackType=je.VOD,n._lastTimeUpdate={current:0,total:0},n._lastDuration=null,n._playableRegionStartTime=0,n._localStartTimeCorrelation=null,n._localEndTimeCorrelation=null,n._playableRegionDuration=0,n._programDateTime=0,n._durationExcludesAfterLiveSyncPoint=!1,n._segmentTargetDuration=null,n._playlistType=null,n._recoverAttemptsRemaining=n.options.hlsRecoverAttempts||16,n}return bg(a,[{key:"name",get:function(){return"hls"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return this._currentLevel===null||this._currentLevel===void 0?Kg:this._currentLevel},set:function(r){this._currentLevel=r,this.trigger(x.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startTime",get:function(){return this._playbackType===je.LIVE&&this._playlistType!=="EVENT"?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return Mg()}},{key:"_extrapolatedStartTime",get:function(){if(!this._localStartTimeCorrelation)return this._playableRegionStartTime;var r=this._localStartTimeCorrelation,l=this._now-r.local,f=(r.remote+l)/1e3;return Math.min(f,this._playableRegionStartTime+this._extrapolatedWindowDuration)}},{key:"_extrapolatedEndTime",get:function(){var r=this._playableRegionStartTime+this._playableRegionDuration;if(!this._localEndTimeCorrelation)return r;var l=this._localEndTimeCorrelation,f=this._now-l.local,g=(l.remote+f)/1e3;return Math.max(r-this._extrapolatedWindowDuration,Math.min(g,r))}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return this._segmentTargetDuration===null?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!0}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"_setup",value:function(){var r=this;this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._hls&&this._hls.destroy(),this._hls=new ht(Bg({},this.options.playback.hlsjsConfig)),this._hls.once(ht.Events.MEDIA_ATTACHED,function(){r.options.hlsPlayback.preload&&r._hls.loadSource(r.options.src)}),this._hls.on(ht.Events.MANIFEST_PARSED,function(){return r._manifestParsed=!0}),this._hls.on(ht.Events.LEVEL_LOADED,function(l,f){return r._updatePlaybackType(l,f)}),this._hls.on(ht.Events.LEVEL_UPDATED,function(l,f){return r._onLevelUpdated(l,f)}),this._hls.on(ht.Events.LEVEL_SWITCHING,function(l,f){return r._onLevelSwitch(l,f)}),this._hls.on(ht.Events.FRAG_CHANGED,function(l,f){return r._onFragmentChanged(l,f)}),this._hls.on(ht.Events.FRAG_LOADED,function(l,f){return r._onFragmentLoaded(l,f)}),this._hls.on(ht.Events.FRAG_PARSING_METADATA,function(l,f){return r._onFragmentParsingMetadata(l,f)}),this._hls.on(ht.Events.ERROR,function(l,f){return r._onHLSJSError(l,f)}),this._hls.on(ht.Events.SUBTITLE_TRACK_LOADED,function(l,f){return r._onSubtitleLoaded(l,f)}),this._hls.on(ht.Events.SUBTITLE_TRACKS_UPDATED,function(){return r._ccTracksUpdated=!0}),this.bindCustomListeners(),this._hls.attachMedia(this.el)}},{key:"bindCustomListeners",value:function(){var r=this;this.customListeners.forEach(function(l){var f=l.eventName,g=l.once?"once":"on";f&&r._hls["".concat(g)](f,l.callback)})}},{key:"unbindCustomListeners",value:function(){var r=this;this.customListeners.forEach(function(l){var f=l.eventName;f&&r._hls.off(f,l.callback)})}},{key:"_onFragmentParsingMetadata",value:function(r,l){this.trigger(x.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:r,data:l})}},{key:"render",value:function(){return this._ready(),Cr(dr(a.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(!this._hls&&this._setup(),this._isReadyState=!0,this.trigger(x.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(r,l,f){if(!this._recoveredDecodingError)this._recoveredDecodingError=!0,this._hls.recoverMediaError();else if(!this._recoveredAudioCodecError)this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError();else{Je.error("hlsjs: failed to recover",{evt:r,data:l}),f.level=nr.Levels.FATAL;var g=this.createError(f);this.trigger(x.PLAYBACK_ERROR,g),this.stop()}}},{key:"_setupSrc",value:function(r){}},{key:"_startTimeUpdateTimer",value:function(){var r=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval(function(){r._onDurationChange(),r._onTimeUpdate()},100))}},{key:"_stopTimeUpdateTimer",value:function(){!this._timeUpdateTimer||(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(r){var l=this._duration;r>0&&(l=this._duration*(r/100)),this.seek(l)}},{key:"seek",value:function(r){r<0&&(Je.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),r=this.getDuration()),this.dvrEnabled&&this._updateDvr(r<this.getDuration()-3),r+=this._startTime,this.el.currentTime=r}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(r){this.trigger(x.PLAYBACK_DVR,r),this.trigger(x.PLAYBACK_STATS_ADD,{dvr:r})}},{key:"_updateSettings",value:function(){this._playbackType===je.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(x.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(r,l){var f={code:"".concat(l.type,"_").concat(l.details),description:"".concat(this.name," error: type: ").concat(l.type,", details: ").concat(l.details),raw:l},g;if(l.response&&(f.description+=", response: ".concat(JSON.stringify(l.response))),l.fatal)if(this._recoverAttemptsRemaining>0)switch(this._recoverAttemptsRemaining-=1,l.type){case ht.ErrorTypes.NETWORK_ERROR:switch(l.details){case ht.ErrorDetails.MANIFEST_LOAD_ERROR:case ht.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case ht.ErrorDetails.MANIFEST_PARSING_ERROR:case ht.ErrorDetails.LEVEL_LOAD_ERROR:case ht.ErrorDetails.LEVEL_LOAD_TIMEOUT:Je.error("hlsjs: unrecoverable network fatal error.",{evt:r,data:l}),g=this.createError(f),this.trigger(x.PLAYBACK_ERROR,g),this.stop();break;default:Je.warn("hlsjs: trying to recover from network error.",{evt:r,data:l}),f.level=nr.Levels.WARN,this._hls.startLoad();break}break;case ht.ErrorTypes.MEDIA_ERROR:Je.warn("hlsjs: trying to recover from media error.",{evt:r,data:l}),f.level=nr.Levels.WARN,this._recover(r,l,f);break;default:Je.error("hlsjs: could not recover from error.",{evt:r,data:l}),g=this.createError(f),this.trigger(x.PLAYBACK_ERROR,g),this.stop();break}else Je.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:r,data:l}),g=this.createError(f),this.trigger(x.PLAYBACK_ERROR,g),this.stop();else{if(this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(l)){Je.error("hlsjs: could not load decrypt key.",{evt:r,data:l}),g=this.createError(f),this.trigger(x.PLAYBACK_ERROR,g),this.stop();return}f.level=nr.Levels.WARN,Je.warn("hlsjs: non-fatal error occurred",{evt:r,data:l})}}},{key:"_keyIsDenied",value:function(r){return r.type===ht.ErrorTypes.NETWORK_ERROR&&r.details===ht.ErrorDetails.KEY_LOAD_ERROR&&r.response&&r.response.code>=400}},{key:"_onTimeUpdate",value:function(){var r={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},l=this._lastTimeUpdate&&r.current===this._lastTimeUpdate.current&&r.total===this._lastTimeUpdate.total;l||(this._lastTimeUpdate=r,this.trigger(x.PLAYBACK_TIMEUPDATE,r,this.name))}},{key:"_onDurationChange",value:function(){var r=this.getDuration();this._lastDuration!==r&&(this._lastDuration=r,Cr(dr(a.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(!!this.el.buffered.length){for(var r=[],l=0,f=0;f<this.el.buffered.length;f++)r=[].concat(Lg(r),[{start:Math.max(0,this.el.buffered.start(f)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(f)-this._playableRegionStartTime)}]),this.el.currentTime>=r[f].start&&this.el.currentTime<=r[f].end&&(l=f);var g={start:r[l].start,current:r[l].end,total:this.getDuration()};this.trigger(x.PLAYBACK_PROGRESS,g,r)}}},{key:"play",value:function(){!this._hls&&this._setup(),!this._manifestParsed&&!this.options.hlsPlayback.preload&&this._hls.loadSource(this.options.src),Cr(dr(a.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){!this._hls||(this.el.pause(),this.dvrEnabled&&this._updateDvr(!0))}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&(Cr(dr(a.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls)}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._hls&&(this._hls.destroy(),delete this._hls),Cr(dr(a.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(r,l){this._playbackType=l.details.live?je.LIVE:je.VOD,this._onLevelUpdated(r,l),this._ccTracksUpdated&&this._playbackType===je.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map(function(r,l){return{id:l,level:r,label:"".concat(r.bitrate/1e3,"Kbps")}}),this.trigger(x.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(r,l){this._segmentTargetDuration=l.details.targetduration,this._playlistType=l.details.type||null;var f=!1,g=!1,T=l.details.fragments,m=this._playableRegionStartTime,A=this._playableRegionDuration;if(T.length!==0){if(T[0].rawProgramDateTime&&(this._programDateTime=T[0].rawProgramDateTime),this._playableRegionStartTime!==T[0].start&&(f=!0,this._playableRegionStartTime=T[0].start),f)if(!this._localStartTimeCorrelation)this._localStartTimeCorrelation={local:this._now,remote:(T[0].start+this._extrapolatedWindowDuration/2)*1e3};else{var U=this._localStartTimeCorrelation,w=this._now-U.local,L=(U.remote+w)/1e3;L<T[0].start?this._localStartTimeCorrelation={local:this._now,remote:T[0].start*1e3}:L>m+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:Math.max(T[0].start,m+this._extrapolatedWindowDuration)*1e3})}var K=l.details.totalduration;if(this._playbackType===je.LIVE){var F=l.details.targetduration,j=this.options.playback.hlsjsConfig||{},$=j.liveSyncDurationCount||ht.DefaultConfig.liveSyncDurationCount,X=F*$;X<=K?(K-=X,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1}K!==this._playableRegionDuration&&(g=!0,this._playableRegionDuration=K);var se=T[0].start+K,J=m+A,re=se!==J;if(re)if(!this._localEndTimeCorrelation)this._localEndTimeCorrelation={local:this._now,remote:se*1e3};else{var he=this._localEndTimeCorrelation,ye=this._now-he.local,be=(he.remote+ye)/1e3;be>se?this._localEndTimeCorrelation={local:this._now,remote:se*1e3}:be<se-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:(se-this._extrapolatedWindowDuration)*1e3}:be>J&&(this._localEndTimeCorrelation={local:this._now,remote:J*1e3})}g&&this._onDurationChange(),f&&this._onProgress()}}},{key:"_onFragmentChanged",value:function(r,l){this.trigger(x.Custom.PLAYBACK_FRAGMENT_CHANGED,l)}},{key:"_onFragmentLoaded",value:function(r,l){this.trigger(x.PLAYBACK_FRAGMENT_LOADED,l)}},{key:"_onSubtitleLoaded",value:function(){if(!this._ccIsSetup){this.trigger(x.PLAYBACK_SUBTITLE_AVAILABLE);var r=this._playbackType===je.LIVE?-1:this.closedCaptionsTrackId;this.closedCaptionsTrackId=r,this._ccIsSetup=!0}}},{key:"_onLevelSwitch",value:function(r,l){this.levels.length||this._fillLevels(),this.trigger(x.PLAYBACK_LEVEL_SWITCH_END),this.trigger(x.PLAYBACK_LEVEL_SWITCH,l);var f=this._hls.levels[l.level];f&&(this.highDefinition=f.height>=720||f.bitrate/1e3>=2e3,this.trigger(x.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(x.PLAYBACK_BITRATE,{height:f.height,width:f.width,bandwidth:f.bitrate,bitrate:f.bitrate,level:l.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===je.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===je.VOD||this.dvrEnabled}}],[{key:"HLSJS",get:function(){return ht}}]),a}(gr);Fl.canPlay=function(t,i){var a=t.split("?")[0].match(/.*\.(.*)$/)||[],n=a.length>1&&a[1].toLowerCase()==="m3u8"||Ug(i,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!!(ht.isSupported()&&n)};/*!
 * v-clappr v3.0.0
 * Vue.js wrapper for Clappr
 * (c) 2022 Vinayak Kulkarni<inbox.vinayak@gmail.com>
 * Released under the MIT License
 */const Vg=Xo({name:"VClappr",props:{el:{type:String,required:!0,default:"player"},source:{type:String,required:!0,default:""},options:{type:Object,required:!1,default:()=>({width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}},poster:"https://picsum.photos/3840/2160"})}},emits:["init","ready","resize","play","pause","stop","ended","seek","error","time-updated","volume-updated","subtitle-available"],setup(t,{emit:i}){const a=Jc(null);Qo(async()=>{await oa(),await n()}),Jo(()=>{a.value.destroy(),a.value=null});const n=()=>new Promise((r,l)=>{t.el?(a.value=new Ll({parentId:`#${t.el}`,source:t.source,plugins:[Kh,jh,Wh,$h,Qh,eg,tg,ba,cg,hg,vg,mg,Eg,Fl],...t.options}),oa(()=>{i("init",a.value),a.value.configure({events:{onReady:()=>{i("ready",a.value)},onResize:f=>{i("resize",f)},onPlay:()=>{i("play",!0)},onPause:()=>{i("pause",!0)},onStop:f=>{i("stop",f)},onEnded:()=>{i("ended",!0)},onSeek:f=>{i("seek",f)},onError:f=>{i("error",f)},onTimeUpdate:f=>{i("time-updated",f)},onVolumeUpdate:f=>{i("volume-updated",f)},onSubtitleAvailable:f=>{i("subtitle-available",f)}},allowUserInteraction:!1})}),r("Player created!")):l("Root element not found")});return()=>vd("div",{attrs:{id:t.el}})}}),Gg=Xo({name:"ExampleApp",components:{VClappr:Vg},setup(){const t=Si({clappr:null,source:"https://storage.googleapis.com/shaka-demo-assets/angel-one/dash.mpd",options:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}},poster:"https://picsum.photos/3840/2160"}});return{state:t,onInit:L=>{t.clappr=L},onReady:L=>{console.log("onReady Event: ",L)},onResize:L=>{console.log("onResize Event: ",L)},onPlay:L=>{console.log("onPlay Event: ",L)},onPause:L=>{console.log("onPause Event: ",L)},onStop:L=>{console.log("onStop Event: ",L)},onEnded:L=>{console.log("onEnded Event: ",L)},onSeek:L=>{console.log("onSeek Event: ",L)},onError:L=>{console.log("onError Event: ",L)},onTimeUpdated:L=>{console.log("onTimeUpdate Event: ",L)},onVolumeUpdated:L=>{console.log("onVolumeUpdate Event: ",L)},onSubtitleAvailable:L=>{console.log("onSubtitleAvailable Event: ",L)}}}}),Hg=(t,i)=>{const a=t.__vccOpts||t;for(const[n,r]of i)a[n]=r;return a};function jg(t,i,a,n,r,l){const f=Of("v-clappr");return Qf(),td("div",null,[$t(f,{el:"player",source:t.state.source,options:t.state.options,class:"w-full h-full",onInit:t.onInit,onReady:t.onReady,onResize:t.onResize,onPlay:t.onPlay,onPause:t.onPause,onStop:t.onStop,onEnded:t.onEnded,onSeek:t.onSeek,onError:t.onError,onTimeUpdated:t.onTimeUpdated,onVolumeUpdated:t.onVolumeUpdated,onSubtitleAvailable:t.onSubtitleAvailable},null,8,["source","options","onInit","onReady","onResize","onPlay","onPause","onStop","onEnded","onSeek","onError","onTimeUpdated","onVolumeUpdated","onSubtitleAvailable"])])}const Yg=Hg(Gg,[["render",jg]]);Md(Yg).mount("#app");
