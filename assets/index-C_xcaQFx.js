(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const g of t)if(g.type==="childList")for(const b of g.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function i(t){const g={};return t.integrity&&(g.integrity=t.integrity),t.referrerPolicy&&(g.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?g.credentials="include":t.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function r(t){if(t.ep)return;t.ep=!0;const g=i(t);fetch(t.href,g)}})();/**
* @vue/shared v3.4.33
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function oi(e,n){const i=new Set(e.split(","));return n?r=>i.has(r.toLowerCase()):r=>i.has(r)}const Ce={},or=[],rt=()=>{},vo=()=>!1,on=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),li=e=>e.startsWith("onUpdate:"),Ue=Object.assign,ui=(e,n)=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)},go=Object.prototype.hasOwnProperty,_e=(e,n)=>go.call(e,n),pe=Array.isArray,br=e=>ln(e)==="[object Map]",po=e=>ln(e)==="[object Set]",ye=e=>typeof e=="function",Ke=e=>typeof e=="string",mr=e=>typeof e=="symbol",ke=e=>e!==null&&typeof e=="object",Fa=e=>(ke(e)||ye(e))&&ye(e.then)&&ye(e.catch),mo=Object.prototype.toString,ln=e=>mo.call(e),yo=e=>ln(e).slice(8,-1),Eo=e=>ln(e)==="[object Object]",ci=e=>Ke(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Sr=oi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),un=e=>{const n=Object.create(null);return i=>n[i]||(n[i]=e(i))},Ao=/-(\w)/g,Pt=un(e=>e.replace(Ao,(n,i)=>i?i.toUpperCase():"")),_o=/\B([A-Z])/g,Mt=un(e=>e.replace(_o,"-$1").toLowerCase()),Ba=un(e=>e.charAt(0).toUpperCase()+e.slice(1)),Sn=un(e=>e?`on${Ba(e)}`:""),mt=(e,n)=>!Object.is(e,n),xn=(e,...n)=>{for(let i=0;i<e.length;i++)e[i](...n)},Ua=(e,n,i,r=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:r,value:i})},To=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let Mi;const Ka=()=>Mi||(Mi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Pr(e){if(pe(e)){const n={};for(let i=0;i<e.length;i++){const r=e[i],t=Ke(r)?Co(r):Pr(r);if(t)for(const g in t)n[g]=t[g]}return n}else if(Ke(e)||ke(e))return e}const bo=/;(?![^(]*\))/g,So=/:([^]+)/,xo=/\/\*[^]*?\*\//g;function Co(e){const n={};return e.replace(xo,"").split(bo).forEach(i=>{if(i){const r=i.split(So);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function fi(e){let n="";if(Ke(e))n=e;else if(pe(e))for(let i=0;i<e.length;i++){const r=fi(e[i]);r&&(n+=r+" ")}else if(ke(e))for(const i in e)e[i]&&(n+=i+" ");return n.trim()}const Lo="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Do=oi(Lo);function Wa(e){return!!e||e===""}/**
* @vue/reactivity v3.4.33
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let at;class Oo{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=at,!n&&at&&(this.index=(at.scopes||(at.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const i=at;try{return at=this,n()}finally{at=i}}}on(){at=this}off(){at=this.parent}stop(n){if(this._active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!n){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}function Io(e,n=at){n&&n.active&&n.effects.push(e)}function Po(){return at}let Zt;class di{constructor(n,i,r,t){this.fn=n,this.trigger=i,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Io(this,t)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,wt();for(let n=0;n<this._depsLength;n++){const i=this.deps[n];if(i.computed&&(Ro(i.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),Nt()}return this._dirtyLevel>=4}set dirty(n){this._dirtyLevel=n?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=Ot,i=Zt;try{return Ot=!0,Zt=this,this._runnings++,wi(this),this.fn()}finally{Ni(this),this._runnings--,Zt=i,Ot=n}}stop(){this.active&&(wi(this),Ni(this),this.onStop&&this.onStop(),this.active=!1)}}function Ro(e){return e.value}function wi(e){e._trackId++,e._depsLength=0}function Ni(e){if(e.deps.length>e._depsLength){for(let n=e._depsLength;n<e.deps.length;n++)Va(e.deps[n],e);e.deps.length=e._depsLength}}function Va(e,n){const i=e.get(n);i!==void 0&&n._trackId!==i&&(e.delete(n),e.size===0&&e.cleanup())}let Ot=!0,Un=0;const Ga=[];function wt(){Ga.push(Ot),Ot=!1}function Nt(){const e=Ga.pop();Ot=e===void 0?!0:e}function hi(){Un++}function vi(){for(Un--;!Un&&Kn.length;)Kn.shift()()}function Ha(e,n,i){if(n.get(e)!==e._trackId){n.set(e,e._trackId);const r=e.deps[e._depsLength];r!==n?(r&&Va(r,e),e.deps[e._depsLength++]=n):e._depsLength++}}const Kn=[];function ja(e,n,i){hi();for(const r of e.keys()){let t;r._dirtyLevel<n&&(t??(t=e.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=n),r._shouldSchedule&&(t??(t=e.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Kn.push(r.scheduler)))}vi()}const Ya=(e,n)=>{const i=new Map;return i.cleanup=e,i.computed=n,i},Wn=new WeakMap,Jt=Symbol(""),Vn=Symbol("");function Ye(e,n,i){if(Ot&&Zt){let r=Wn.get(e);r||Wn.set(e,r=new Map);let t=r.get(i);t||r.set(i,t=Ya(()=>r.delete(i))),Ha(Zt,t)}}function bt(e,n,i,r,t,g){const b=Wn.get(e);if(!b)return;let P=[];if(n==="clear")P=[...b.values()];else if(i==="length"&&pe(e)){const m=Number(r);b.forEach((N,S)=>{(S==="length"||!mr(S)&&S>=m)&&P.push(N)})}else switch(i!==void 0&&P.push(b.get(i)),n){case"add":pe(e)?ci(i)&&P.push(b.get("length")):(P.push(b.get(Jt)),br(e)&&P.push(b.get(Vn)));break;case"delete":pe(e)||(P.push(b.get(Jt)),br(e)&&P.push(b.get(Vn)));break;case"set":br(e)&&P.push(b.get(Jt));break}hi();for(const m of P)m&&ja(m,4);vi()}const ko=oi("__proto__,__v_isRef,__isVue"),$a=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(mr)),Fi=Mo();function Mo(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...i){const r=be(this);for(let g=0,b=this.length;g<b;g++)Ye(r,"get",g+"");const t=r[n](...i);return t===-1||t===!1?r[n](...i.map(be)):t}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...i){wt(),hi();const r=be(this)[n].apply(this,i);return vi(),Nt(),r}}),e}function wo(e){mr(e)||(e=String(e));const n=be(this);return Ye(n,"has",e),n.hasOwnProperty(e)}class za{constructor(n=!1,i=!1){this._isReadonly=n,this._isShallow=i}get(n,i,r){const t=this._isReadonly,g=this._isShallow;if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return g;if(i==="__v_raw")return r===(t?g?zo:Ja:g?Za:Qa).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const b=pe(n);if(!t){if(b&&_e(Fi,i))return Reflect.get(Fi,i,r);if(i==="hasOwnProperty")return wo}const P=Reflect.get(n,i,r);return(mr(i)?$a.has(i):ko(i))||(t||Ye(n,"get",i),g)?P:$e(P)?b&&ci(i)?P:P.value:ke(P)?t?qa(P):fn(P):P}}class Xa extends za{constructor(n=!1){super(!1,n)}set(n,i,r,t){let g=n[i];if(!this._isShallow){const m=qt(g);if(!dr(r)&&!qt(r)&&(g=be(g),r=be(r)),!pe(n)&&$e(g)&&!$e(r))return m?!1:(g.value=r,!0)}const b=pe(n)&&ci(i)?Number(i)<n.length:_e(n,i),P=Reflect.set(n,i,r,t);return n===be(t)&&(b?mt(r,g)&&bt(n,"set",i,r):bt(n,"add",i,r)),P}deleteProperty(n,i){const r=_e(n,i);n[i];const t=Reflect.deleteProperty(n,i);return t&&r&&bt(n,"delete",i,void 0),t}has(n,i){const r=Reflect.has(n,i);return(!mr(i)||!$a.has(i))&&Ye(n,"has",i),r}ownKeys(n){return Ye(n,"iterate",pe(n)?"length":Jt),Reflect.ownKeys(n)}}class No extends za{constructor(n=!1){super(!0,n)}set(n,i){return!0}deleteProperty(n,i){return!0}}const Fo=new Xa,Bo=new No,Uo=new Xa(!0);const gi=e=>e,cn=e=>Reflect.getPrototypeOf(e);function Wr(e,n,i=!1,r=!1){e=e.__v_raw;const t=be(e),g=be(n);i||(mt(n,g)&&Ye(t,"get",n),Ye(t,"get",g));const{has:b}=cn(t),P=r?gi:i?yi:Rr;if(b.call(t,n))return P(e.get(n));if(b.call(t,g))return P(e.get(g));e!==t&&e.get(n)}function Vr(e,n=!1){const i=this.__v_raw,r=be(i),t=be(e);return n||(mt(e,t)&&Ye(r,"has",e),Ye(r,"has",t)),e===t?i.has(e):i.has(e)||i.has(t)}function Gr(e,n=!1){return e=e.__v_raw,!n&&Ye(be(e),"iterate",Jt),Reflect.get(e,"size",e)}function Bi(e,n=!1){!n&&!dr(e)&&!qt(e)&&(e=be(e));const i=be(this);return cn(i).has.call(i,e)||(i.add(e),bt(i,"add",e,e)),this}function Ui(e,n,i=!1){!i&&!dr(n)&&!qt(n)&&(n=be(n));const r=be(this),{has:t,get:g}=cn(r);let b=t.call(r,e);b||(e=be(e),b=t.call(r,e));const P=g.call(r,e);return r.set(e,n),b?mt(n,P)&&bt(r,"set",e,n):bt(r,"add",e,n),this}function Ki(e){const n=be(this),{has:i,get:r}=cn(n);let t=i.call(n,e);t||(e=be(e),t=i.call(n,e)),r&&r.call(n,e);const g=n.delete(e);return t&&bt(n,"delete",e,void 0),g}function Wi(){const e=be(this),n=e.size!==0,i=e.clear();return n&&bt(e,"clear",void 0,void 0),i}function Hr(e,n){return function(r,t){const g=this,b=g.__v_raw,P=be(b),m=n?gi:e?yi:Rr;return!e&&Ye(P,"iterate",Jt),b.forEach((N,S)=>r.call(t,m(N),m(S),g))}}function jr(e,n,i){return function(...r){const t=this.__v_raw,g=be(t),b=br(g),P=e==="entries"||e===Symbol.iterator&&b,m=e==="keys"&&b,N=t[e](...r),S=i?gi:n?yi:Rr;return!n&&Ye(g,"iterate",m?Vn:Jt),{next(){const{value:F,done:M}=N.next();return M?{value:F,done:M}:{value:P?[S(F[0]),S(F[1])]:S(F),done:M}},[Symbol.iterator](){return this}}}}function xt(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function Ko(){const e={get(g){return Wr(this,g)},get size(){return Gr(this)},has:Vr,add:Bi,set:Ui,delete:Ki,clear:Wi,forEach:Hr(!1,!1)},n={get(g){return Wr(this,g,!1,!0)},get size(){return Gr(this)},has:Vr,add(g){return Bi.call(this,g,!0)},set(g,b){return Ui.call(this,g,b,!0)},delete:Ki,clear:Wi,forEach:Hr(!1,!0)},i={get(g){return Wr(this,g,!0)},get size(){return Gr(this,!0)},has(g){return Vr.call(this,g,!0)},add:xt("add"),set:xt("set"),delete:xt("delete"),clear:xt("clear"),forEach:Hr(!0,!1)},r={get(g){return Wr(this,g,!0,!0)},get size(){return Gr(this,!0)},has(g){return Vr.call(this,g,!0)},add:xt("add"),set:xt("set"),delete:xt("delete"),clear:xt("clear"),forEach:Hr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(g=>{e[g]=jr(g,!1,!1),i[g]=jr(g,!0,!1),n[g]=jr(g,!1,!0),r[g]=jr(g,!0,!0)}),[e,i,n,r]}const[Wo,Vo,Go,Ho]=Ko();function pi(e,n){const i=n?e?Ho:Go:e?Vo:Wo;return(r,t,g)=>t==="__v_isReactive"?!e:t==="__v_isReadonly"?e:t==="__v_raw"?r:Reflect.get(_e(i,t)&&t in r?i:r,t,g)}const jo={get:pi(!1,!1)},Yo={get:pi(!1,!0)},$o={get:pi(!0,!1)};const Qa=new WeakMap,Za=new WeakMap,Ja=new WeakMap,zo=new WeakMap;function Xo(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qo(e){return e.__v_skip||!Object.isExtensible(e)?0:Xo(yo(e))}function fn(e){return qt(e)?e:mi(e,!1,Fo,jo,Qa)}function Zo(e){return mi(e,!1,Uo,Yo,Za)}function qa(e){return mi(e,!0,Bo,$o,Ja)}function mi(e,n,i,r,t){if(!ke(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const g=t.get(e);if(g)return g;const b=Qo(e);if(b===0)return e;const P=new Proxy(e,b===2?r:i);return t.set(e,P),P}function xr(e){return qt(e)?xr(e.__v_raw):!!(e&&e.__v_isReactive)}function qt(e){return!!(e&&e.__v_isReadonly)}function dr(e){return!!(e&&e.__v_isShallow)}function es(e){return e?!!e.__v_raw:!1}function be(e){const n=e&&e.__v_raw;return n?be(n):e}function Jo(e){return Object.isExtensible(e)&&Ua(e,"__v_skip",!0),e}const Rr=e=>ke(e)?fn(e):e,yi=e=>ke(e)?qa(e):e;class ts{constructor(n,i,r,t){this.getter=n,this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new di(()=>n(this._value),()=>Cr(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!t,this.__v_isReadonly=r}get value(){const n=be(this);return(!n._cacheable||n.effect.dirty)&&mt(n._value,n._value=n.effect.run())&&Cr(n,4),Ei(n),n.effect._dirtyLevel>=2&&Cr(n,2),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function qo(e,n,i=!1){let r,t;const g=ye(e);return g?(r=e,t=rt):(r=e.get,t=e.set),new ts(r,t,g||!t,i)}function Ei(e){var n;Ot&&Zt&&(e=be(e),Ha(Zt,(n=e.dep)!=null?n:e.dep=Ya(()=>e.dep=void 0,e instanceof ts?e:void 0)))}function Cr(e,n=4,i,r){e=be(e);const t=e.dep;t&&ja(t,n)}function $e(e){return!!(e&&e.__v_isRef===!0)}function el(e){return tl(e,!1)}function tl(e,n){return $e(e)?e:new rl(e,n)}class rl{constructor(n,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?n:be(n),this._value=i?n:Rr(n)}get value(){return Ei(this),this._value}set value(n){const i=this.__v_isShallow||dr(n)||qt(n);n=i?n:be(n),mt(n,this._rawValue)&&(this._rawValue,this._rawValue=n,this._value=i?n:Rr(n),Cr(this,4))}}function Gn(e){return $e(e)?e.value:e}const nl={get:(e,n,i)=>Gn(Reflect.get(e,n,i)),set:(e,n,i,r)=>{const t=e[n];return $e(t)&&!$e(i)?(t.value=i,!0):Reflect.set(e,n,i,r)}};function rs(e){return xr(e)?e:new Proxy(e,nl)}class il{constructor(n){this.dep=void 0,this.__v_isRef=!0;const{get:i,set:r}=n(()=>Ei(this),()=>Cr(this));this._get=i,this._set=r}get value(){return this._get()}set value(n){this._set(n)}}function al(e){return new il(e)}/**
* @vue/runtime-core v3.4.33
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function It(e,n,i,r){try{return r?e(...r):e()}catch(t){dn(t,n,i)}}function lt(e,n,i,r){if(ye(e)){const t=It(e,n,i,r);return t&&Fa(t)&&t.catch(g=>{dn(g,n,i)}),t}if(pe(e)){const t=[];for(let g=0;g<e.length;g++)t.push(lt(e[g],n,i,r));return t}}function dn(e,n,i,r=!0){const t=n?n.vnode:null;if(n){let g=n.parent;const b=n.proxy,P=`https://vuejs.org/error-reference/#runtime-${i}`;for(;g;){const N=g.ec;if(N){for(let S=0;S<N.length;S++)if(N[S](e,b,P)===!1)return}g=g.parent}const m=n.appContext.config.errorHandler;if(m){wt(),It(m,null,10,[e,b,P]),Nt();return}}sl(e,i,t,r)}function sl(e,n,i,r=!0){console.error(e)}let kr=!1,Hn=!1;const Ve=[];let vt=0;const lr=[];let Ct=null,$t=0;const ns=Promise.resolve();let Ai=null;function ol(e){const n=Ai||ns;return e?n.then(this?e.bind(this):e):n}function ll(e){let n=vt+1,i=Ve.length;for(;n<i;){const r=n+i>>>1,t=Ve[r],g=Mr(t);g<e||g===e&&t.pre?n=r+1:i=r}return n}function _i(e){(!Ve.length||!Ve.includes(e,kr&&e.allowRecurse?vt+1:vt))&&(e.id==null?Ve.push(e):Ve.splice(ll(e.id),0,e),is())}function is(){!kr&&!Hn&&(Hn=!0,Ai=ns.then(ss))}function ul(e){const n=Ve.indexOf(e);n>vt&&Ve.splice(n,1)}function cl(e){pe(e)?lr.push(...e):(!Ct||!Ct.includes(e,e.allowRecurse?$t+1:$t))&&lr.push(e),is()}function Vi(e,n,i=kr?vt+1:0){for(;i<Ve.length;i++){const r=Ve[i];if(r&&r.pre){if(e&&r.id!==e.uid)continue;Ve.splice(i,1),i--,r()}}}function as(e){if(lr.length){const n=[...new Set(lr)].sort((i,r)=>Mr(i)-Mr(r));if(lr.length=0,Ct){Ct.push(...n);return}for(Ct=n,$t=0;$t<Ct.length;$t++){const i=Ct[$t];i.active!==!1&&i()}Ct=null,$t=0}}const Mr=e=>e.id==null?1/0:e.id,fl=(e,n)=>{const i=Mr(e)-Mr(n);if(i===0){if(e.pre&&!n.pre)return-1;if(n.pre&&!e.pre)return 1}return i};function ss(e){Hn=!1,kr=!0,Ve.sort(fl);try{for(vt=0;vt<Ve.length;vt++){const n=Ve[vt];n&&n.active!==!1&&It(n,n.i,n.i?15:14)}}finally{vt=0,Ve.length=0,as(),kr=!1,Ai=null,(Ve.length||lr.length)&&ss()}}let st=null,hn=null;function tn(e){const n=st;return st=e,hn=e&&e.type.__scopeId||null,n}function os(e){hn=e}function ls(){hn=null}function dl(e,n=st,i){if(!n||e._n)return e;const r=(...t)=>{r._d&&Ji(-1);const g=tn(n);let b;try{b=e(...t)}finally{tn(g),r._d&&Ji(1)}return b};return r._n=!0,r._c=!0,r._d=!0,r}function Ht(e,n,i,r){const t=e.dirs,g=n&&n.dirs;for(let b=0;b<t.length;b++){const P=t[b];g&&(P.oldValue=g[b].value);let m=P.dir[r];m&&(wt(),lt(m,i,8,[e.el,P,e,n]),Nt())}}function us(e,n){e.shapeFlag&6&&e.component?us(e.component.subTree,n):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}/*! #__NO_SIDE_EFFECTS__ */function Ti(e,n){return ye(e)?Ue({name:e.name},n,{setup:e}):e}const Qr=e=>!!e.type.__asyncLoader,cs=e=>e.type.__isKeepAlive;function hl(e,n){fs(e,"a",n)}function vl(e,n){fs(e,"da",n)}function fs(e,n,i=Ge){const r=e.__wdc||(e.__wdc=()=>{let t=i;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(vn(n,r,i),i){let t=i.parent;for(;t&&t.parent;)cs(t.parent.vnode)&&gl(r,n,i,t),t=t.parent}}function gl(e,n,i,r){const t=vn(n,e,r,!0);vs(()=>{ui(r[n],t)},i)}function vn(e,n,i=Ge,r=!1){if(i){const t=i[e]||(i[e]=[]),g=n.__weh||(n.__weh=(...b)=>{wt();const P=Fr(i),m=lt(n,i,e,b);return P(),Nt(),m});return r?t.unshift(g):t.push(g),g}}const St=e=>(n,i=Ge)=>{(!mn||e==="sp")&&vn(e,(...r)=>n(...r),i)},pl=St("bm"),ds=St("m"),ml=St("bu"),yl=St("u"),hs=St("bum"),vs=St("um"),El=St("sp"),Al=St("rtg"),_l=St("rtc");function Tl(e,n=Ge){vn("ec",e,n)}const bl=Symbol.for("v-ndc"),jn=e=>e?ks(e)?Li(e):jn(e.parent):null,Lr=Ue(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jn(e.parent),$root:e=>jn(e.root),$emit:e=>e.emit,$options:e=>bi(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,_i(e.update)}),$nextTick:e=>e.n||(e.n=ol.bind(e.proxy)),$watch:e=>Xl.bind(e)}),Cn=(e,n)=>e!==Ce&&!e.__isScriptSetup&&_e(e,n),Sl={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:i,setupState:r,data:t,props:g,accessCache:b,type:P,appContext:m}=e;let N;if(n[0]!=="$"){const K=b[n];if(K!==void 0)switch(K){case 1:return r[n];case 2:return t[n];case 4:return i[n];case 3:return g[n]}else{if(Cn(r,n))return b[n]=1,r[n];if(t!==Ce&&_e(t,n))return b[n]=2,t[n];if((N=e.propsOptions[0])&&_e(N,n))return b[n]=3,g[n];if(i!==Ce&&_e(i,n))return b[n]=4,i[n];Yn&&(b[n]=0)}}const S=Lr[n];let F,M;if(S)return n==="$attrs"&&Ye(e.attrs,"get",""),S(e);if((F=P.__cssModules)&&(F=F[n]))return F;if(i!==Ce&&_e(i,n))return b[n]=4,i[n];if(M=m.config.globalProperties,_e(M,n))return M[n]},set({_:e},n,i){const{data:r,setupState:t,ctx:g}=e;return Cn(t,n)?(t[n]=i,!0):r!==Ce&&_e(r,n)?(r[n]=i,!0):_e(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(g[n]=i,!0)},has({_:{data:e,setupState:n,accessCache:i,ctx:r,appContext:t,propsOptions:g}},b){let P;return!!i[b]||e!==Ce&&_e(e,b)||Cn(n,b)||(P=g[0])&&_e(P,b)||_e(r,b)||_e(Lr,b)||_e(t.config.globalProperties,b)},defineProperty(e,n,i){return i.get!=null?e._.accessCache[n]=0:_e(i,"value")&&this.set(e,n,i.value,null),Reflect.defineProperty(e,n,i)}};function rn(e){return pe(e)?e.reduce((n,i)=>(n[i]=null,n),{}):e}function xl(e,n){return!e||!n?e||n:pe(e)&&pe(n)?e.concat(n):Ue({},rn(e),rn(n))}let Yn=!0;function Cl(e){const n=bi(e),i=e.proxy,r=e.ctx;Yn=!1,n.beforeCreate&&Gi(n.beforeCreate,e,"bc");const{data:t,computed:g,methods:b,watch:P,provide:m,inject:N,created:S,beforeMount:F,mounted:M,beforeUpdate:K,updated:w,activated:I,deactivated:k,beforeDestroy:x,beforeUnmount:L,destroyed:R,unmounted:O,render:C,renderTracked:y,renderTriggered:u,errorCaptured:l,serverPrefetch:c,expose:f,inheritAttrs:o,components:a,directives:s,filters:d}=n;if(N&&Ll(N,r,null),b)for(const h in b){const A=b[h];ye(A)&&(r[h]=A.bind(i))}if(t){const h=t.call(i,i);ke(h)&&(e.data=fn(h))}if(Yn=!0,g)for(const h in g){const A=g[h],E=ye(A)?A.bind(i,i):ye(A.get)?A.get.bind(i,i):rt,v=!ye(A)&&ye(A.set)?A.set.bind(i):rt,T=Eu({get:E,set:v});Object.defineProperty(r,h,{enumerable:!0,configurable:!0,get:()=>T.value,set:D=>T.value=D})}if(P)for(const h in P)gs(P[h],r,i,h);if(m){const h=ye(m)?m.call(i):m;Reflect.ownKeys(h).forEach(A=>{kl(A,h[A])})}S&&Gi(S,e,"c");function _(h,A){pe(A)?A.forEach(E=>h(E.bind(i))):A&&h(A.bind(i))}if(_(pl,F),_(ds,M),_(ml,K),_(yl,w),_(hl,I),_(vl,k),_(Tl,l),_(_l,y),_(Al,u),_(hs,L),_(vs,O),_(El,c),pe(f))if(f.length){const h=e.exposed||(e.exposed={});f.forEach(A=>{Object.defineProperty(h,A,{get:()=>i[A],set:E=>i[A]=E})})}else e.exposed||(e.exposed={});C&&e.render===rt&&(e.render=C),o!=null&&(e.inheritAttrs=o),a&&(e.components=a),s&&(e.directives=s)}function Ll(e,n,i=rt){pe(e)&&(e=$n(e));for(const r in e){const t=e[r];let g;ke(t)?"default"in t?g=Zr(t.from||r,t.default,!0):g=Zr(t.from||r):g=Zr(t),$e(g)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>g.value,set:b=>g.value=b}):n[r]=g}}function Gi(e,n,i){lt(pe(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,i)}function gs(e,n,i,r){const t=r.includes(".")?Ds(i,r):()=>i[r];if(Ke(e)){const g=n[e];ye(g)&&Jr(t,g)}else if(ye(e))Jr(t,e.bind(i));else if(ke(e))if(pe(e))e.forEach(g=>gs(g,n,i,r));else{const g=ye(e.handler)?e.handler.bind(i):n[e.handler];ye(g)&&Jr(t,g,e)}}function bi(e){const n=e.type,{mixins:i,extends:r}=n,{mixins:t,optionsCache:g,config:{optionMergeStrategies:b}}=e.appContext,P=g.get(n);let m;return P?m=P:!t.length&&!i&&!r?m=n:(m={},t.length&&t.forEach(N=>nn(m,N,b,!0)),nn(m,n,b)),ke(n)&&g.set(n,m),m}function nn(e,n,i,r=!1){const{mixins:t,extends:g}=n;g&&nn(e,g,i,!0),t&&t.forEach(b=>nn(e,b,i,!0));for(const b in n)if(!(r&&b==="expose")){const P=Dl[b]||i&&i[b];e[b]=P?P(e[b],n[b]):n[b]}return e}const Dl={data:Hi,props:ji,emits:ji,methods:_r,computed:_r,beforeCreate:He,created:He,beforeMount:He,mounted:He,beforeUpdate:He,updated:He,beforeDestroy:He,beforeUnmount:He,destroyed:He,unmounted:He,activated:He,deactivated:He,errorCaptured:He,serverPrefetch:He,components:_r,directives:_r,watch:Il,provide:Hi,inject:Ol};function Hi(e,n){return n?e?function(){return Ue(ye(e)?e.call(this,this):e,ye(n)?n.call(this,this):n)}:n:e}function Ol(e,n){return _r($n(e),$n(n))}function $n(e){if(pe(e)){const n={};for(let i=0;i<e.length;i++)n[e[i]]=e[i];return n}return e}function He(e,n){return e?[...new Set([].concat(e,n))]:n}function _r(e,n){return e?Ue(Object.create(null),e,n):n}function ji(e,n){return e?pe(e)&&pe(n)?[...new Set([...e,...n])]:Ue(Object.create(null),rn(e),rn(n??{})):n}function Il(e,n){if(!e)return n;if(!n)return e;const i=Ue(Object.create(null),e);for(const r in n)i[r]=He(e[r],n[r]);return i}function ps(){return{app:null,config:{isNativeTag:vo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Pl=0;function Rl(e,n){return function(r,t=null){ye(r)||(r=Ue({},r)),t!=null&&!ke(t)&&(t=null);const g=ps(),b=new WeakSet;let P=!1;const m=g.app={_uid:Pl++,_component:r,_props:t,_container:null,_context:g,_instance:null,version:Au,get config(){return g.config},set config(N){},use(N,...S){return b.has(N)||(N&&ye(N.install)?(b.add(N),N.install(m,...S)):ye(N)&&(b.add(N),N(m,...S))),m},mixin(N){return g.mixins.includes(N)||g.mixins.push(N),m},component(N,S){return S?(g.components[N]=S,m):g.components[N]},directive(N,S){return S?(g.directives[N]=S,m):g.directives[N]},mount(N,S,F){if(!P){const M=ct(r,t);return M.appContext=g,F===!0?F="svg":F===!1&&(F=void 0),S&&n?n(M,N):e(M,N,F),P=!0,m._container=N,N.__vue_app__=m,Li(M.component)}},unmount(){P&&(e(null,m._container),delete m._container.__vue_app__)},provide(N,S){return g.provides[N]=S,m},runWithContext(N){const S=Dr;Dr=m;try{return N()}finally{Dr=S}}};return m}}let Dr=null;function kl(e,n){if(Ge){let i=Ge.provides;const r=Ge.parent&&Ge.parent.provides;r===i&&(i=Ge.provides=Object.create(r)),i[e]=n}}function Zr(e,n,i=!1){const r=Ge||st;if(r||Dr){const t=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:Dr._context.provides;if(t&&e in t)return t[e];if(arguments.length>1)return i&&ye(n)?n.call(r&&r.proxy):n}}const ms={},ys=()=>Object.create(ms),Es=e=>Object.getPrototypeOf(e)===ms;function Ml(e,n,i,r=!1){const t={},g=ys();e.propsDefaults=Object.create(null),As(e,n,t,g);for(const b in e.propsOptions[0])b in t||(t[b]=void 0);i?e.props=r?t:Zo(t):e.type.props?e.props=t:e.props=g,e.attrs=g}function wl(e,n,i,r){const{props:t,attrs:g,vnode:{patchFlag:b}}=e,P=be(t),[m]=e.propsOptions;let N=!1;if((r||b>0)&&!(b&16)){if(b&8){const S=e.vnode.dynamicProps;for(let F=0;F<S.length;F++){let M=S[F];if(gn(e.emitsOptions,M))continue;const K=n[M];if(m)if(_e(g,M))K!==g[M]&&(g[M]=K,N=!0);else{const w=Pt(M);t[w]=zn(m,P,w,K,e,!1)}else K!==g[M]&&(g[M]=K,N=!0)}}}else{As(e,n,t,g)&&(N=!0);let S;for(const F in P)(!n||!_e(n,F)&&((S=Mt(F))===F||!_e(n,S)))&&(m?i&&(i[F]!==void 0||i[S]!==void 0)&&(t[F]=zn(m,P,F,void 0,e,!0)):delete t[F]);if(g!==P)for(const F in g)(!n||!_e(n,F))&&(delete g[F],N=!0)}N&&bt(e.attrs,"set","")}function As(e,n,i,r){const[t,g]=e.propsOptions;let b=!1,P;if(n)for(let m in n){if(Sr(m))continue;const N=n[m];let S;t&&_e(t,S=Pt(m))?!g||!g.includes(S)?i[S]=N:(P||(P={}))[S]=N:gn(e.emitsOptions,m)||(!(m in r)||N!==r[m])&&(r[m]=N,b=!0)}if(g){const m=be(i),N=P||Ce;for(let S=0;S<g.length;S++){const F=g[S];i[F]=zn(t,m,F,N[F],e,!_e(N,F))}}return b}function zn(e,n,i,r,t,g){const b=e[i];if(b!=null){const P=_e(b,"default");if(P&&r===void 0){const m=b.default;if(b.type!==Function&&!b.skipFactory&&ye(m)){const{propsDefaults:N}=t;if(i in N)r=N[i];else{const S=Fr(t);r=N[i]=m.call(null,n),S()}}else r=m}b[0]&&(g&&!P?r=!1:b[1]&&(r===""||r===Mt(i))&&(r=!0))}return r}const Nl=new WeakMap;function _s(e,n,i=!1){const r=i?Nl:n.propsCache,t=r.get(e);if(t)return t;const g=e.props,b={},P=[];let m=!1;if(!ye(e)){const S=F=>{m=!0;const[M,K]=_s(F,n,!0);Ue(b,M),K&&P.push(...K)};!i&&n.mixins.length&&n.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}if(!g&&!m)return ke(e)&&r.set(e,or),or;if(pe(g))for(let S=0;S<g.length;S++){const F=Pt(g[S]);Yi(F)&&(b[F]=Ce)}else if(g)for(const S in g){const F=Pt(S);if(Yi(F)){const M=g[S],K=b[F]=pe(M)||ye(M)?{type:M}:Ue({},M);if(K){const w=Xi(Boolean,K.type),I=Xi(String,K.type);K[0]=w>-1,K[1]=I<0||w<I,(w>-1||_e(K,"default"))&&P.push(F)}}}const N=[b,P];return ke(e)&&r.set(e,N),N}function Yi(e){return e[0]!=="$"&&!Sr(e)}function $i(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function zi(e,n){return $i(e)===$i(n)}function Xi(e,n){return pe(n)?n.findIndex(i=>zi(i,e)):ye(n)&&zi(n,e)?0:-1}const Ts=e=>e[0]==="_"||e==="$stable",Si=e=>pe(e)?e.map(ht):[ht(e)],Fl=(e,n,i)=>{if(n._n)return n;const r=dl((...t)=>Si(n(...t)),i);return r._c=!1,r},bs=(e,n,i)=>{const r=e._ctx;for(const t in e){if(Ts(t))continue;const g=e[t];if(ye(g))n[t]=Fl(t,g,r);else if(g!=null){const b=Si(g);n[t]=()=>b}}},Ss=(e,n)=>{const i=Si(n);e.slots.default=()=>i},xs=(e,n,i)=>{for(const r in n)(i||r!=="_")&&(e[r]=n[r])},Bl=(e,n,i)=>{const r=e.slots=ys();if(e.vnode.shapeFlag&32){const t=n._;t?(xs(r,n,i),i&&Ua(r,"_",t,!0)):bs(n,r)}else n&&Ss(e,n)},Ul=(e,n,i)=>{const{vnode:r,slots:t}=e;let g=!0,b=Ce;if(r.shapeFlag&32){const P=n._;P?i&&P===1?g=!1:xs(t,n,i):(g=!n.$stable,bs(n,t)),b=n}else n&&(Ss(e,n),b={default:1});if(g)for(const P in t)!Ts(P)&&b[P]==null&&delete t[P]};function Xn(e,n,i,r,t=!1){if(pe(e)){e.forEach((M,K)=>Xn(M,n&&(pe(n)?n[K]:n),i,r,t));return}if(Qr(r)&&!t)return;const g=r.shapeFlag&4?Li(r.component):r.el,b=t?null:g,{i:P,r:m}=e,N=n&&n.r,S=P.refs===Ce?P.refs={}:P.refs,F=P.setupState;if(N!=null&&N!==m&&(Ke(N)?(S[N]=null,_e(F,N)&&(F[N]=null)):$e(N)&&(N.value=null)),ye(m))It(m,P,12,[b,S]);else{const M=Ke(m),K=$e(m);if(M||K){const w=()=>{if(e.f){const I=M?_e(F,m)?F[m]:S[m]:m.value;t?pe(I)&&ui(I,g):pe(I)?I.includes(g)||I.push(g):M?(S[m]=[g],_e(F,m)&&(F[m]=S[m])):(m.value=[g],e.k&&(S[e.k]=m.value))}else M?(S[m]=b,_e(F,m)&&(F[m]=b)):K&&(m.value=b,e.k&&(S[e.k]=b))};b?(w.id=-1,je(w,i)):w()}}}const Kl=Symbol("_vte"),Wl=e=>e.__isTeleport,je=ru;function Vl(e){return Gl(e)}function Gl(e,n){const i=Ka();i.__VUE__=!0;const{insert:r,remove:t,patchProp:g,createElement:b,createText:P,createComment:m,setText:N,setElementText:S,parentNode:F,nextSibling:M,setScopeId:K=rt,insertStaticContent:w}=e,I=(Y,X,q,re=null,ne=null,U=null,H=void 0,z=null,J=!!X.dynamicChildren)=>{if(Y===X)return;Y&&!Ar(Y,X)&&(re=$(Y),D(Y,ne,U,!0),Y=null),X.patchFlag===-2&&(J=!1,X.dynamicChildren=null);const{type:te,ref:ie,shapeFlag:le}=X;switch(te){case pn:k(Y,X,q,re);break;case er:x(Y,X,q,re);break;case In:Y==null&&L(X,q,re,H);break;case _t:a(Y,X,q,re,ne,U,H,z,J);break;default:le&1?C(Y,X,q,re,ne,U,H,z,J):le&6?s(Y,X,q,re,ne,U,H,z,J):(le&64||le&128)&&te.process(Y,X,q,re,ne,U,H,z,J,ee)}ie!=null&&ne&&Xn(ie,Y&&Y.ref,U,X||Y,!X)},k=(Y,X,q,re)=>{if(Y==null)r(X.el=P(X.children),q,re);else{const ne=X.el=Y.el;X.children!==Y.children&&N(ne,X.children)}},x=(Y,X,q,re)=>{Y==null?r(X.el=m(X.children||""),q,re):X.el=Y.el},L=(Y,X,q,re)=>{[Y.el,Y.anchor]=w(Y.children,X,q,re,Y.el,Y.anchor)},R=({el:Y,anchor:X},q,re)=>{let ne;for(;Y&&Y!==X;)ne=M(Y),r(Y,q,re),Y=ne;r(X,q,re)},O=({el:Y,anchor:X})=>{let q;for(;Y&&Y!==X;)q=M(Y),t(Y),Y=q;t(X)},C=(Y,X,q,re,ne,U,H,z,J)=>{X.type==="svg"?H="svg":X.type==="math"&&(H="mathml"),Y==null?y(X,q,re,ne,U,H,z,J):c(Y,X,ne,U,H,z,J)},y=(Y,X,q,re,ne,U,H,z)=>{let J,te;const{props:ie,shapeFlag:le,transition:oe,dirs:ue}=Y;if(J=Y.el=b(Y.type,U,ie&&ie.is,ie),le&8?S(J,Y.children):le&16&&l(Y.children,J,null,re,ne,Ln(Y,U),H,z),ue&&Ht(Y,null,re,"created"),u(J,Y,Y.scopeId,H,re),ie){for(const ge in ie)ge!=="value"&&!Sr(ge)&&g(J,ge,null,ie[ge],U,re);"value"in ie&&g(J,"value",null,ie.value,U),(te=ie.onVnodeBeforeMount)&&dt(te,re,Y)}ue&&Ht(Y,null,re,"beforeMount");const fe=Hl(ne,oe);fe&&oe.beforeEnter(J),r(J,X,q),((te=ie&&ie.onVnodeMounted)||fe||ue)&&je(()=>{te&&dt(te,re,Y),fe&&oe.enter(J),ue&&Ht(Y,null,re,"mounted")},ne)},u=(Y,X,q,re,ne)=>{if(q&&K(Y,q),re)for(let U=0;U<re.length;U++)K(Y,re[U]);if(ne){let U=ne.subTree;if(X===U){const H=ne.vnode;u(Y,H,H.scopeId,H.slotScopeIds,ne.parent)}}},l=(Y,X,q,re,ne,U,H,z,J=0)=>{for(let te=J;te<Y.length;te++){const ie=Y[te]=z?Lt(Y[te]):ht(Y[te]);I(null,ie,X,q,re,ne,U,H,z)}},c=(Y,X,q,re,ne,U,H)=>{const z=X.el=Y.el;let{patchFlag:J,dynamicChildren:te,dirs:ie}=X;J|=Y.patchFlag&16;const le=Y.props||Ce,oe=X.props||Ce;let ue;if(q&&jt(q,!1),(ue=oe.onVnodeBeforeUpdate)&&dt(ue,q,X,Y),ie&&Ht(X,Y,q,"beforeUpdate"),q&&jt(q,!0),(le.innerHTML&&oe.innerHTML==null||le.textContent&&oe.textContent==null)&&S(z,""),te?f(Y.dynamicChildren,te,z,q,re,Ln(X,ne),U):H||A(Y,X,z,null,q,re,Ln(X,ne),U,!1),J>0){if(J&16)o(z,le,oe,q,ne);else if(J&2&&le.class!==oe.class&&g(z,"class",null,oe.class,ne),J&4&&g(z,"style",le.style,oe.style,ne),J&8){const fe=X.dynamicProps;for(let ge=0;ge<fe.length;ge++){const he=fe[ge],Ee=le[he],Le=oe[he];(Le!==Ee||he==="value")&&g(z,he,Ee,Le,ne,q)}}J&1&&Y.children!==X.children&&S(z,X.children)}else!H&&te==null&&o(z,le,oe,q,ne);((ue=oe.onVnodeUpdated)||ie)&&je(()=>{ue&&dt(ue,q,X,Y),ie&&Ht(X,Y,q,"updated")},re)},f=(Y,X,q,re,ne,U,H)=>{for(let z=0;z<X.length;z++){const J=Y[z],te=X[z],ie=J.el&&(J.type===_t||!Ar(J,te)||J.shapeFlag&70)?F(J.el):q;I(J,te,ie,null,re,ne,U,H,!0)}},o=(Y,X,q,re,ne)=>{if(X!==q){if(X!==Ce)for(const U in X)!Sr(U)&&!(U in q)&&g(Y,U,X[U],null,ne,re);for(const U in q){if(Sr(U))continue;const H=q[U],z=X[U];H!==z&&U!=="value"&&g(Y,U,z,H,ne,re)}"value"in q&&g(Y,"value",X.value,q.value,ne)}},a=(Y,X,q,re,ne,U,H,z,J)=>{const te=X.el=Y?Y.el:P(""),ie=X.anchor=Y?Y.anchor:P("");let{patchFlag:le,dynamicChildren:oe,slotScopeIds:ue}=X;ue&&(z=z?z.concat(ue):ue),Y==null?(r(te,q,re),r(ie,q,re),l(X.children||[],q,ie,ne,U,H,z,J)):le>0&&le&64&&oe&&Y.dynamicChildren?(f(Y.dynamicChildren,oe,q,ne,U,H,z),(X.key!=null||ne&&X===ne.subTree)&&Cs(Y,X,!0)):A(Y,X,q,ie,ne,U,H,z,J)},s=(Y,X,q,re,ne,U,H,z,J)=>{X.slotScopeIds=z,Y==null?X.shapeFlag&512?ne.ctx.activate(X,q,re,H,J):d(X,q,re,ne,U,H,J):p(Y,X,J)},d=(Y,X,q,re,ne,U,H)=>{const z=Y.component=du(Y,re,ne);if(cs(Y)&&(z.ctx.renderer=ee),vu(z,!1,H),z.asyncDep){if(ne&&ne.registerDep(z,_,H),!Y.el){const J=z.subTree=ct(er);x(null,J,X,q)}}else _(z,Y,X,q,ne,U,H)},p=(Y,X,q)=>{const re=X.component=Y.component;if(ql(Y,X,q))if(re.asyncDep&&!re.asyncResolved){h(re,X,q);return}else re.next=X,ul(re.update),re.effect.dirty=!0,re.update();else X.el=Y.el,re.vnode=X},_=(Y,X,q,re,ne,U,H)=>{const z=()=>{if(Y.isMounted){let{next:ie,bu:le,u:oe,parent:ue,vnode:fe}=Y;{const Pe=Ls(Y);if(Pe){ie&&(ie.el=fe.el,h(Y,ie,H)),Pe.asyncDep.then(()=>{Y.isUnmounted||z()});return}}let ge=ie,he;jt(Y,!1),ie?(ie.el=fe.el,h(Y,ie,H)):ie=fe,le&&xn(le),(he=ie.props&&ie.props.onVnodeBeforeUpdate)&&dt(he,ue,ie,fe),jt(Y,!0);const Ee=On(Y),Le=Y.subTree;Y.subTree=Ee,I(Le,Ee,F(Le.el),$(Le),Y,ne,U),ie.el=Ee.el,ge===null&&eu(Y,Ee.el),oe&&je(oe,ne),(he=ie.props&&ie.props.onVnodeUpdated)&&je(()=>dt(he,ue,ie,fe),ne)}else{let ie;const{el:le,props:oe}=X,{bm:ue,m:fe,parent:ge}=Y,he=Qr(X);if(jt(Y,!1),ue&&xn(ue),!he&&(ie=oe&&oe.onVnodeBeforeMount)&&dt(ie,ge,X),jt(Y,!0),le&&se){const Ee=()=>{Y.subTree=On(Y),se(le,Y.subTree,Y,ne,null)};he?X.type.__asyncLoader().then(()=>!Y.isUnmounted&&Ee()):Ee()}else{const Ee=Y.subTree=On(Y);I(null,Ee,q,re,Y,ne,U),X.el=Ee.el}if(fe&&je(fe,ne),!he&&(ie=oe&&oe.onVnodeMounted)){const Ee=X;je(()=>dt(ie,ge,Ee),ne)}(X.shapeFlag&256||ge&&Qr(ge.vnode)&&ge.vnode.shapeFlag&256)&&Y.a&&je(Y.a,ne),Y.isMounted=!0,X=q=re=null}},J=Y.effect=new di(z,rt,()=>_i(te),Y.scope),te=Y.update=()=>{J.dirty&&J.run()};te.i=Y,te.id=Y.uid,jt(Y,!0),te()},h=(Y,X,q)=>{X.component=Y;const re=Y.vnode.props;Y.vnode=X,Y.next=null,wl(Y,X.props,re,q),Ul(Y,X.children,q),wt(),Vi(Y),Nt()},A=(Y,X,q,re,ne,U,H,z,J=!1)=>{const te=Y&&Y.children,ie=Y?Y.shapeFlag:0,le=X.children,{patchFlag:oe,shapeFlag:ue}=X;if(oe>0){if(oe&128){v(te,le,q,re,ne,U,H,z,J);return}else if(oe&256){E(te,le,q,re,ne,U,H,z,J);return}}ue&8?(ie&16&&j(te,ne,U),le!==te&&S(q,le)):ie&16?ue&16?v(te,le,q,re,ne,U,H,z,J):j(te,ne,U,!0):(ie&8&&S(q,""),ue&16&&l(le,q,re,ne,U,H,z,J))},E=(Y,X,q,re,ne,U,H,z,J)=>{Y=Y||or,X=X||or;const te=Y.length,ie=X.length,le=Math.min(te,ie);let oe;for(oe=0;oe<le;oe++){const ue=X[oe]=J?Lt(X[oe]):ht(X[oe]);I(Y[oe],ue,q,null,ne,U,H,z,J)}te>ie?j(Y,ne,U,!0,!1,le):l(X,q,re,ne,U,H,z,J,le)},v=(Y,X,q,re,ne,U,H,z,J)=>{let te=0;const ie=X.length;let le=Y.length-1,oe=ie-1;for(;te<=le&&te<=oe;){const ue=Y[te],fe=X[te]=J?Lt(X[te]):ht(X[te]);if(Ar(ue,fe))I(ue,fe,q,null,ne,U,H,z,J);else break;te++}for(;te<=le&&te<=oe;){const ue=Y[le],fe=X[oe]=J?Lt(X[oe]):ht(X[oe]);if(Ar(ue,fe))I(ue,fe,q,null,ne,U,H,z,J);else break;le--,oe--}if(te>le){if(te<=oe){const ue=oe+1,fe=ue<ie?X[ue].el:re;for(;te<=oe;)I(null,X[te]=J?Lt(X[te]):ht(X[te]),q,fe,ne,U,H,z,J),te++}}else if(te>oe)for(;te<=le;)D(Y[te],ne,U,!0),te++;else{const ue=te,fe=te,ge=new Map;for(te=fe;te<=oe;te++){const Oe=X[te]=J?Lt(X[te]):ht(X[te]);Oe.key!=null&&ge.set(Oe.key,te)}let he,Ee=0;const Le=oe-fe+1;let Pe=!1,Fe=0;const Ne=new Array(Le);for(te=0;te<Le;te++)Ne[te]=0;for(te=ue;te<=le;te++){const Oe=Y[te];if(Ee>=Le){D(Oe,ne,U,!0);continue}let Te;if(Oe.key!=null)Te=ge.get(Oe.key);else for(he=fe;he<=oe;he++)if(Ne[he-fe]===0&&Ar(Oe,X[he])){Te=he;break}Te===void 0?D(Oe,ne,U,!0):(Ne[Te-fe]=te+1,Te>=Fe?Fe=Te:Pe=!0,I(Oe,X[Te],q,null,ne,U,H,z,J),Ee++)}const We=Pe?jl(Ne):or;for(he=We.length-1,te=Le-1;te>=0;te--){const Oe=fe+te,Te=X[Oe],Re=Oe+1<ie?X[Oe+1].el:re;Ne[te]===0?I(null,Te,q,Re,ne,U,H,z,J):Pe&&(he<0||te!==We[he]?T(Te,q,Re,2):he--)}}},T=(Y,X,q,re,ne=null)=>{const{el:U,type:H,transition:z,children:J,shapeFlag:te}=Y;if(te&6){T(Y.component.subTree,X,q,re);return}if(te&128){Y.suspense.move(X,q,re);return}if(te&64){H.move(Y,X,q,ee);return}if(H===_t){r(U,X,q);for(let le=0;le<J.length;le++)T(J[le],X,q,re);r(Y.anchor,X,q);return}if(H===In){R(Y,X,q);return}if(re!==2&&te&1&&z)if(re===0)z.beforeEnter(U),r(U,X,q),je(()=>z.enter(U),ne);else{const{leave:le,delayLeave:oe,afterLeave:ue}=z,fe=()=>r(U,X,q),ge=()=>{le(U,()=>{fe(),ue&&ue()})};oe?oe(U,fe,ge):ge()}else r(U,X,q)},D=(Y,X,q,re=!1,ne=!1)=>{const{type:U,props:H,ref:z,children:J,dynamicChildren:te,shapeFlag:ie,patchFlag:le,dirs:oe,cacheIndex:ue}=Y;if(le===-2&&(ne=!1),z!=null&&Xn(z,null,q,Y,!0),ue!=null&&(X.renderCache[ue]=void 0),ie&256){X.ctx.deactivate(Y);return}const fe=ie&1&&oe,ge=!Qr(Y);let he;if(ge&&(he=H&&H.onVnodeBeforeUnmount)&&dt(he,X,Y),ie&6)W(Y.component,q,re);else{if(ie&128){Y.suspense.unmount(q,re);return}fe&&Ht(Y,null,X,"beforeUnmount"),ie&64?Y.type.remove(Y,X,q,ee,re):te&&!te.hasOnce&&(U!==_t||le>0&&le&64)?j(te,X,q,!1,!0):(U===_t&&le&384||!ne&&ie&16)&&j(J,X,q),re&&B(Y)}(ge&&(he=H&&H.onVnodeUnmounted)||fe)&&je(()=>{he&&dt(he,X,Y),fe&&Ht(Y,null,X,"unmounted")},q)},B=Y=>{const{type:X,el:q,anchor:re,transition:ne}=Y;if(X===_t){V(q,re);return}if(X===In){O(Y);return}const U=()=>{t(q),ne&&!ne.persisted&&ne.afterLeave&&ne.afterLeave()};if(Y.shapeFlag&1&&ne&&!ne.persisted){const{leave:H,delayLeave:z}=ne,J=()=>H(q,U);z?z(Y.el,U,J):J()}else U()},V=(Y,X)=>{let q;for(;Y!==X;)q=M(Y),t(Y),Y=q;t(X)},W=(Y,X,q)=>{const{bum:re,scope:ne,update:U,subTree:H,um:z,m:J,a:te}=Y;Qi(J),Qi(te),re&&xn(re),ne.stop(),U&&(U.active=!1,D(H,Y,X,q)),z&&je(z,X),je(()=>{Y.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&Y.asyncDep&&!Y.asyncResolved&&Y.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},j=(Y,X,q,re=!1,ne=!1,U=0)=>{for(let H=U;H<Y.length;H++)D(Y[H],X,q,re,ne)},$=Y=>{if(Y.shapeFlag&6)return $(Y.component.subTree);if(Y.shapeFlag&128)return Y.suspense.next();const X=M(Y.anchor||Y.el),q=X&&X[Kl];return q?M(q):X};let Q=!1;const Z=(Y,X,q)=>{Y==null?X._vnode&&D(X._vnode,null,null,!0):I(X._vnode||null,Y,X,null,null,null,q),Q||(Q=!0,Vi(),as(),Q=!1),X._vnode=Y},ee={p:I,um:D,m:T,r:B,mt:d,mc:l,pc:A,pbc:f,n:$,o:e};let ae,se;return n&&([ae,se]=n(ee)),{render:Z,hydrate:ae,createApp:Rl(Z,ae)}}function Ln({type:e,props:n},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:i}function jt({effect:e,update:n},i){e.allowRecurse=n.allowRecurse=i}function Hl(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function Cs(e,n,i=!1){const r=e.children,t=n.children;if(pe(r)&&pe(t))for(let g=0;g<r.length;g++){const b=r[g];let P=t[g];P.shapeFlag&1&&!P.dynamicChildren&&((P.patchFlag<=0||P.patchFlag===32)&&(P=t[g]=Lt(t[g]),P.el=b.el),!i&&P.patchFlag!==-2&&Cs(b,P)),P.type===pn&&(P.el=b.el)}}function jl(e){const n=e.slice(),i=[0];let r,t,g,b,P;const m=e.length;for(r=0;r<m;r++){const N=e[r];if(N!==0){if(t=i[i.length-1],e[t]<N){n[r]=t,i.push(r);continue}for(g=0,b=i.length-1;g<b;)P=g+b>>1,e[i[P]]<N?g=P+1:b=P;N<e[i[g]]&&(g>0&&(n[r]=i[g-1]),i[g]=r)}}for(g=i.length,b=i[g-1];g-- >0;)i[g]=b,b=n[b];return i}function Ls(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:Ls(n)}function Qi(e){if(e)for(let n=0;n<e.length;n++)e[n].active=!1}const Yl=Symbol.for("v-scx"),$l=()=>Zr(Yl);function zl(e,n){return xi(e,null,{flush:"sync"})}const Yr={};function Jr(e,n,i){return xi(e,n,i)}function xi(e,n,{immediate:i,deep:r,flush:t,once:g,onTrack:b,onTrigger:P}=Ce){if(n&&g){const y=n;n=(...u)=>{y(...u),C()}}const m=Ge,N=y=>r===!0?y:zt(y,r===!1?1:void 0);let S,F=!1,M=!1;if($e(e)?(S=()=>e.value,F=dr(e)):xr(e)?(S=()=>N(e),F=!0):pe(e)?(M=!0,F=e.some(y=>xr(y)||dr(y)),S=()=>e.map(y=>{if($e(y))return y.value;if(xr(y))return N(y);if(ye(y))return It(y,m,2)})):ye(e)?n?S=()=>It(e,m,2):S=()=>(K&&K(),lt(e,m,3,[w])):S=rt,n&&r){const y=S;S=()=>zt(y())}let K,w=y=>{K=R.onStop=()=>{It(y,m,4),K=R.onStop=void 0}},I;if(mn)if(w=rt,n?i&&lt(n,m,3,[S(),M?[]:void 0,w]):S(),t==="sync"){const y=$l();I=y.__watcherHandles||(y.__watcherHandles=[])}else return rt;let k=M?new Array(e.length).fill(Yr):Yr;const x=()=>{if(!(!R.active||!R.dirty))if(n){const y=R.run();(r||F||(M?y.some((u,l)=>mt(u,k[l])):mt(y,k)))&&(K&&K(),lt(n,m,3,[y,k===Yr?void 0:M&&k[0]===Yr?[]:k,w]),k=y)}else R.run()};x.allowRecurse=!!n;let L;t==="sync"?L=x:t==="post"?L=()=>je(x,m&&m.suspense):(x.pre=!0,m&&(x.id=m.uid),L=()=>_i(x));const R=new di(S,rt,L),O=Po(),C=()=>{R.stop(),O&&ui(O.effects,R)};return n?i?x():k=R.run():t==="post"?je(R.run.bind(R),m&&m.suspense):R.run(),I&&I.push(C),C}function Xl(e,n,i){const r=this.proxy,t=Ke(e)?e.includes(".")?Ds(r,e):()=>r[e]:e.bind(r,r);let g;ye(n)?g=n:(g=n.handler,i=n);const b=Fr(this),P=xi(t,g.bind(r),i);return b(),P}function Ds(e,n){const i=n.split(".");return()=>{let r=e;for(let t=0;t<i.length&&r;t++)r=r[i[t]];return r}}function zt(e,n=1/0,i){if(n<=0||!ke(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),n--,$e(e))zt(e.value,n,i);else if(pe(e))for(let r=0;r<e.length;r++)zt(e[r],n,i);else if(po(e)||br(e))e.forEach(r=>{zt(r,n,i)});else if(Eo(e)){for(const r in e)zt(e[r],n,i);for(const r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&zt(e[r],n,i)}return e}function Dn(e,n,i=Ce){const r=hu(),t=Pt(n),g=Mt(n),b=Os(e,n),P=al((m,N)=>{let S,F,M;return zl(()=>{const K=e[n];mt(S,K)&&(S=K,N())}),{get(){return m(),i.get?i.get(S):S},set(K){if(!mt(K,S))return;const w=r.vnode.props;w&&(n in w||t in w||g in w)&&(`onUpdate:${n}`in w||`onUpdate:${t}`in w||`onUpdate:${g}`in w)||(S=K,N());const I=i.set?i.set(K):K;r.emit(`update:${n}`,I),K!==I&&K!==F&&I===M&&N(),F=K,M=I}}});return P[Symbol.iterator]=()=>{let m=0;return{next(){return m<2?{value:m++?b||Ce:P,done:!1}:{done:!0}}}},P}const Os=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Pt(n)}Modifiers`]||e[`${Mt(n)}Modifiers`];function Ql(e,n,...i){if(e.isUnmounted)return;const r=e.vnode.props||Ce;let t=i;const g=n.startsWith("update:"),b=g&&Os(r,n.slice(7));b&&(b.trim&&(t=i.map(S=>Ke(S)?S.trim():S)),b.number&&(t=i.map(To)));let P,m=r[P=Sn(n)]||r[P=Sn(Pt(n))];!m&&g&&(m=r[P=Sn(Mt(n))]),m&&lt(m,e,6,t);const N=r[P+"Once"];if(N){if(!e.emitted)e.emitted={};else if(e.emitted[P])return;e.emitted[P]=!0,lt(N,e,6,t)}}function Is(e,n,i=!1){const r=n.emitsCache,t=r.get(e);if(t!==void 0)return t;const g=e.emits;let b={},P=!1;if(!ye(e)){const m=N=>{const S=Is(N,n,!0);S&&(P=!0,Ue(b,S))};!i&&n.mixins.length&&n.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}return!g&&!P?(ke(e)&&r.set(e,null),null):(pe(g)?g.forEach(m=>b[m]=null):Ue(b,g),ke(e)&&r.set(e,b),b)}function gn(e,n){return!e||!on(n)?!1:(n=n.slice(2).replace(/Once$/,""),_e(e,n[0].toLowerCase()+n.slice(1))||_e(e,Mt(n))||_e(e,n))}function On(e){const{type:n,vnode:i,proxy:r,withProxy:t,propsOptions:[g],slots:b,attrs:P,emit:m,render:N,renderCache:S,props:F,data:M,setupState:K,ctx:w,inheritAttrs:I}=e,k=tn(e);let x,L;try{if(i.shapeFlag&4){const O=t||r,C=O;x=ht(N.call(C,O,S,F,K,M,w)),L=P}else{const O=n;x=ht(O.length>1?O(F,{attrs:P,slots:b,emit:m}):O(F,null)),L=n.props?P:Zl(P)}}catch(O){Or.length=0,dn(O,e,1),x=ct(er)}let R=x;if(L&&I!==!1){const O=Object.keys(L),{shapeFlag:C}=R;O.length&&C&7&&(g&&O.some(li)&&(L=Jl(L,g)),R=hr(R,L,!1,!0))}return i.dirs&&(R=hr(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(i.dirs):i.dirs),i.transition&&(R.transition=i.transition),x=R,tn(k),x}const Zl=e=>{let n;for(const i in e)(i==="class"||i==="style"||on(i))&&((n||(n={}))[i]=e[i]);return n},Jl=(e,n)=>{const i={};for(const r in e)(!li(r)||!(r.slice(9)in n))&&(i[r]=e[r]);return i};function ql(e,n,i){const{props:r,children:t,component:g}=e,{props:b,children:P,patchFlag:m}=n,N=g.emitsOptions;if(n.dirs||n.transition)return!0;if(i&&m>=0){if(m&1024)return!0;if(m&16)return r?Zi(r,b,N):!!b;if(m&8){const S=n.dynamicProps;for(let F=0;F<S.length;F++){const M=S[F];if(b[M]!==r[M]&&!gn(N,M))return!0}}}else return(t||P)&&(!P||!P.$stable)?!0:r===b?!1:r?b?Zi(r,b,N):!0:!!b;return!1}function Zi(e,n,i){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let t=0;t<r.length;t++){const g=r[t];if(n[g]!==e[g]&&!gn(i,g))return!0}return!1}function eu({vnode:e,parent:n},i){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=i,n=n.parent;else break}}const tu=e=>e.__isSuspense;function ru(e,n){n&&n.pendingBranch?pe(e)?n.effects.push(...e):n.effects.push(e):cl(e)}const _t=Symbol.for("v-fgt"),pn=Symbol.for("v-txt"),er=Symbol.for("v-cmt"),In=Symbol.for("v-stc"),Or=[];let Qe=null;function ur(e=!1){Or.push(Qe=e?null:[])}function nu(){Or.pop(),Qe=Or[Or.length-1]||null}let wr=1;function Ji(e){wr+=e,e<0&&Qe&&(Qe.hasOnce=!0)}function Ps(e){return e.dynamicChildren=wr>0?Qe||or:null,nu(),wr>0&&Qe&&Qe.push(e),e}function Ir(e,n,i,r,t,g){return Ps(ut(e,n,i,r,t,g,!0))}function iu(e,n,i,r,t){return Ps(ct(e,n,i,r,t,!0))}function au(e){return e?e.__v_isVNode===!0:!1}function Ar(e,n){return e.type===n.type&&e.key===n.key}const Rs=({key:e})=>e??null,qr=({ref:e,ref_key:n,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Ke(e)||$e(e)||ye(e)?{i:st,r:e,k:n,f:!!i}:e:null);function ut(e,n=null,i=null,r=0,t=null,g=e===_t?0:1,b=!1,P=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&Rs(n),ref:n&&qr(n),scopeId:hn,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:r,dynamicProps:t,dynamicChildren:null,appContext:null,ctx:st};return P?(Ci(m,i),g&128&&e.normalize(m)):i&&(m.shapeFlag|=Ke(i)?8:16),wr>0&&!b&&Qe&&(m.patchFlag>0||g&6)&&m.patchFlag!==32&&Qe.push(m),m}const ct=su;function su(e,n=null,i=null,r=0,t=null,g=!1){if((!e||e===bl)&&(e=er),au(e)){const P=hr(e,n,!0);return i&&Ci(P,i),wr>0&&!g&&Qe&&(P.shapeFlag&6?Qe[Qe.indexOf(e)]=P:Qe.push(P)),P.patchFlag=-2,P}if(yu(e)&&(e=e.__vccOpts),n){n=ou(n);let{class:P,style:m}=n;P&&!Ke(P)&&(n.class=fi(P)),ke(m)&&(es(m)&&!pe(m)&&(m=Ue({},m)),n.style=Pr(m))}const b=Ke(e)?1:tu(e)?128:Wl(e)?64:ke(e)?4:ye(e)?2:0;return ut(e,n,i,r,t,b,g,!0)}function ou(e){return e?es(e)||Es(e)?Ue({},e):e:null}function hr(e,n,i=!1,r=!1){const{props:t,ref:g,patchFlag:b,children:P,transition:m}=e,N=n?uu(t||{},n):t,S={__v_isVNode:!0,__v_skip:!0,type:e.type,props:N,key:N&&Rs(N),ref:n&&n.ref?i&&g?pe(g)?g.concat(qr(n)):[g,qr(n)]:qr(n):g,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:P,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==_t?b===-1?16:b|16:b,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:m,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&hr(e.ssContent),ssFallback:e.ssFallback&&hr(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return m&&r&&us(S,m.clone(S)),S}function lu(e=" ",n=0){return ct(pn,null,e,n)}function qi(e="",n=!1){return n?(ur(),iu(er,null,e)):ct(er,null,e)}function ht(e){return e==null||typeof e=="boolean"?ct(er):pe(e)?ct(_t,null,e.slice()):typeof e=="object"?Lt(e):ct(pn,null,String(e))}function Lt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:hr(e)}function Ci(e,n){let i=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(pe(n))i=16;else if(typeof n=="object")if(r&65){const t=n.default;t&&(t._c&&(t._d=!1),Ci(e,t()),t._c&&(t._d=!0));return}else{i=32;const t=n._;!t&&!Es(n)?n._ctx=st:t===3&&st&&(st.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else ye(n)?(n={default:n,_ctx:st},i=32):(n=String(n),r&64?(i=16,n=[lu(n)]):i=8);e.children=n,e.shapeFlag|=i}function uu(...e){const n={};for(let i=0;i<e.length;i++){const r=e[i];for(const t in r)if(t==="class")n.class!==r.class&&(n.class=fi([n.class,r.class]));else if(t==="style")n.style=Pr([n.style,r.style]);else if(on(t)){const g=n[t],b=r[t];b&&g!==b&&!(pe(g)&&g.includes(b))&&(n[t]=g?[].concat(g,b):b)}else t!==""&&(n[t]=r[t])}return n}function dt(e,n,i,r=null){lt(e,n,7,[i,r])}const cu=ps();let fu=0;function du(e,n,i){const r=e.type,t=(n?n.appContext:e.appContext)||cu,g={uid:fu++,vnode:e,type:r,parent:n,appContext:t,root:null,next:null,subTree:null,effect:null,update:null,scope:new Oo(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(t.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_s(r,t),emitsOptions:Is(r,t),emit:null,emitted:null,propsDefaults:Ce,inheritAttrs:r.inheritAttrs,ctx:Ce,data:Ce,props:Ce,attrs:Ce,slots:Ce,refs:Ce,setupState:Ce,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=n?n.root:g,g.emit=Ql.bind(null,g),e.ce&&e.ce(g),g}let Ge=null;const hu=()=>Ge||st;let an,Qn;{const e=Ka(),n=(i,r)=>{let t;return(t=e[i])||(t=e[i]=[]),t.push(r),g=>{t.length>1?t.forEach(b=>b(g)):t[0](g)}};an=n("__VUE_INSTANCE_SETTERS__",i=>Ge=i),Qn=n("__VUE_SSR_SETTERS__",i=>mn=i)}const Fr=e=>{const n=Ge;return an(e),e.scope.on(),()=>{e.scope.off(),an(n)}},ea=()=>{Ge&&Ge.scope.off(),an(null)};function ks(e){return e.vnode.shapeFlag&4}let mn=!1;function vu(e,n=!1,i=!1){n&&Qn(n);const{props:r,children:t}=e.vnode,g=ks(e);Ml(e,r,g,n),Bl(e,t,i);const b=g?gu(e,n):void 0;return n&&Qn(!1),b}function gu(e,n){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Sl);const{setup:r}=i;if(r){const t=e.setupContext=r.length>1?mu(e):null,g=Fr(e);wt();const b=It(r,e,0,[e.props,t]);if(Nt(),g(),Fa(b)){if(b.then(ea,ea),n)return b.then(P=>{ta(e,P,n)}).catch(P=>{dn(P,e,0)});e.asyncDep=b}else ta(e,b,n)}else Ms(e,n)}function ta(e,n,i){ye(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:ke(n)&&(e.setupState=rs(n)),Ms(e,i)}let ra;function Ms(e,n,i){const r=e.type;if(!e.render){if(!n&&ra&&!r.render){const t=r.template||bi(e).template;if(t){const{isCustomElement:g,compilerOptions:b}=e.appContext.config,{delimiters:P,compilerOptions:m}=r,N=Ue(Ue({isCustomElement:g,delimiters:P},b),m);r.render=ra(t,N)}}e.render=r.render||rt}{const t=Fr(e);wt();try{Cl(e)}finally{Nt(),t()}}}const pu={get(e,n){return Ye(e,"get",""),e[n]}};function mu(e){const n=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,pu),slots:e.slots,emit:e.emit,expose:n}}function Li(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(rs(Jo(e.exposed)),{get(n,i){if(i in n)return n[i];if(i in Lr)return Lr[i](e)},has(n,i){return i in n||i in Lr}})):e.proxy}function yu(e){return ye(e)&&"__vccOpts"in e}const Eu=(e,n)=>qo(e,n,mn),Au="3.4.33";/**
* @vue/runtime-dom v3.4.33
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const _u="http://www.w3.org/2000/svg",Tu="http://www.w3.org/1998/Math/MathML",At=typeof document<"u"?document:null,na=At&&At.createElement("template"),bu={insert:(e,n,i)=>{n.insertBefore(e,i||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,i,r)=>{const t=n==="svg"?At.createElementNS(_u,e):n==="mathml"?At.createElementNS(Tu,e):i?At.createElement(e,{is:i}):At.createElement(e);return e==="select"&&r&&r.multiple!=null&&t.setAttribute("multiple",r.multiple),t},createText:e=>At.createTextNode(e),createComment:e=>At.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>At.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,i,r,t,g){const b=i?i.previousSibling:n.lastChild;if(t&&(t===g||t.nextSibling))for(;n.insertBefore(t.cloneNode(!0),i),!(t===g||!(t=t.nextSibling)););else{na.innerHTML=r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e;const P=na.content;if(r==="svg"||r==="mathml"){const m=P.firstChild;for(;m.firstChild;)P.appendChild(m.firstChild);P.removeChild(m)}n.insertBefore(P,i)}return[b?b.nextSibling:n.firstChild,i?i.previousSibling:n.lastChild]}},Su=Symbol("_vtc");function xu(e,n,i){const r=e[Su];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):i?e.setAttribute("class",n):e.className=n}const ia=Symbol("_vod"),Cu=Symbol("_vsh"),Lu=Symbol(""),Du=/(^|;)\s*display\s*:/;function Ou(e,n,i){const r=e.style,t=Ke(i);let g=!1;if(i&&!t){if(n)if(Ke(n))for(const b of n.split(";")){const P=b.slice(0,b.indexOf(":")).trim();i[P]==null&&en(r,P,"")}else for(const b in n)i[b]==null&&en(r,b,"");for(const b in i)b==="display"&&(g=!0),en(r,b,i[b])}else if(t){if(n!==i){const b=r[Lu];b&&(i+=";"+b),r.cssText=i,g=Du.test(i)}}else n&&e.removeAttribute("style");ia in e&&(e[ia]=g?r.display:"",e[Cu]&&(r.display="none"))}const aa=/\s*!important$/;function en(e,n,i){if(pe(i))i.forEach(r=>en(e,n,r));else if(i==null&&(i=""),n.startsWith("--"))e.setProperty(n,i);else{const r=Iu(e,n);aa.test(i)?e.setProperty(Mt(r),i.replace(aa,""),"important"):e[r]=i}}const sa=["Webkit","Moz","ms"],Pn={};function Iu(e,n){const i=Pn[n];if(i)return i;let r=Pt(n);if(r!=="filter"&&r in e)return Pn[n]=r;r=Ba(r);for(let t=0;t<sa.length;t++){const g=sa[t]+r;if(g in e)return Pn[n]=g}return n}const oa="http://www.w3.org/1999/xlink";function la(e,n,i,r,t,g=Do(n)){r&&n.startsWith("xlink:")?i==null?e.removeAttributeNS(oa,n.slice(6,n.length)):e.setAttributeNS(oa,n,i):i==null||g&&!Wa(i)?e.removeAttribute(n):e.setAttribute(n,g?"":mr(i)?String(i):i)}function Pu(e,n,i,r){if(n==="innerHTML"||n==="textContent"){if(i==null)return;e[n]=i;return}const t=e.tagName;if(n==="value"&&t!=="PROGRESS"&&!t.includes("-")){const b=t==="OPTION"?e.getAttribute("value")||"":e.value,P=i==null?"":String(i);(b!==P||!("_value"in e))&&(e.value=P),i==null&&e.removeAttribute(n),e._value=i;return}let g=!1;if(i===""||i==null){const b=typeof e[n];b==="boolean"?i=Wa(i):i==null&&b==="string"?(i="",g=!0):b==="number"&&(i=0,g=!0)}try{e[n]=i}catch{}g&&e.removeAttribute(n)}function Ru(e,n,i,r){e.addEventListener(n,i,r)}function ku(e,n,i,r){e.removeEventListener(n,i,r)}const ua=Symbol("_vei");function Mu(e,n,i,r,t=null){const g=e[ua]||(e[ua]={}),b=g[n];if(r&&b)b.value=r;else{const[P,m]=wu(n);if(r){const N=g[n]=Bu(r,t);Ru(e,P,N,m)}else b&&(ku(e,P,b,m),g[n]=void 0)}}const ca=/(?:Once|Passive|Capture)$/;function wu(e){let n;if(ca.test(e)){n={};let r;for(;r=e.match(ca);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Mt(e.slice(2)),n]}let Rn=0;const Nu=Promise.resolve(),Fu=()=>Rn||(Nu.then(()=>Rn=0),Rn=Date.now());function Bu(e,n){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;lt(Uu(r,i.value),n,5,[r])};return i.value=e,i.attached=Fu(),i}function Uu(e,n){if(pe(n)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},n.map(r=>t=>!t._stopped&&r&&r(t))}else return n}const fa=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ku=(e,n,i,r,t,g)=>{const b=t==="svg";n==="class"?xu(e,r,b):n==="style"?Ou(e,i,r):on(n)?li(n)||Mu(e,n,i,r,g):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):Wu(e,n,r,b))?(Pu(e,n,r),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&la(e,n,r,b,g,n!=="value")):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),la(e,n,r,b))};function Wu(e,n,i,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&fa(n)&&ye(i));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const t=e.tagName;if(t==="IMG"||t==="VIDEO"||t==="CANVAS"||t==="SOURCE")return!1}return fa(n)&&Ke(i)?!1:n in e}const Vu=Ue({patchProp:Ku},bu);let da;function Gu(){return da||(da=Vl(Vu))}const Hu=(...e)=>{const n=Gu().createApp(...e),{mount:i}=n;return n.mount=r=>{const t=Yu(r);if(!t)return;const g=n._component;!ye(g)&&!g.render&&!g.template&&(g.template=t.innerHTML),t.innerHTML="";const b=i(t,!1,ju(t));return t instanceof Element&&(t.removeAttribute("v-cloak"),t.setAttribute("data-v-app","")),b},n};function ju(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Yu(e){return Ke(e)?document.querySelector(e):e}/*!
* v-github-icon v3.2.2
* (c) 2024 Vinayak Kulkarni
* @license MIT
*/const $u=Ti({name:"VGithubIcon",props:{url:{type:String,required:!0,default:""},position:{type:String,required:!1,default:"top-right"},bgColor:{type:String,required:!1,default:"#FFFFFF"},fillColor:{type:String,required:!1,default:"#151513"}}}),zu=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},yr=e=>(os("data-v-6c7dc248"),e=e(),ls(),e),Xu=["href"],Qu=yr(()=>ut("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),Zu=yr(()=>ut("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),Ju=yr(()=>ut("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),qu=[Qu,Zu,Ju],ec=yr(()=>ut("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),tc=yr(()=>ut("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),rc=yr(()=>ut("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),nc=[ec,tc,rc];function ic(e,n,i,r,t,g){return ur(),Ir("a",{href:e.url,class:"github-corner","aria-label":"View source on GitHub",target:"_blank",rel:"noopener noreferrer"},[e.position==="top-left"?(ur(),Ir("svg",{key:0,width:"80",height:"80",viewBox:"0 0 250 250",style:Pr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",left:"0",transform:"scale(-1, 1)"}]),"aria-hidden":"true"},qu,4)):qi("",!0),e.position==="top-right"?(ur(),Ir("svg",{key:1,width:"80",height:"80",viewBox:"0 0 250 250",style:Pr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",right:"0"}]),"aria-hidden":"true"},nc,4)):qi("",!0)],8,Xu)}const ac=zu($u,[["render",ic],["__scopeId","data-v-6c7dc248"]]);function ha(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function $r(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?ha(Object(i),!0).forEach(function(r){sc(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ha(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function vr(e){"@babel/helpers - typeof";return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},vr(e)}function Se(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function va(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,n,i){return n&&va(e.prototype,n),i&&va(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function sc(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Me(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Zn(e,n)}function Tt(e){return Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Tt(e)}function Zn(e,n){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},Zn(e,n)}function oc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lc(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yn(e)}function we(e){var n=oc();return function(){var r=Tt(e),t;if(n){var g=Tt(this).constructor;t=Reflect.construct(r,arguments,g)}else t=r.apply(this,arguments);return lc(this,t)}}function uc(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=Tt(e),e!==null););return e}function Qt(){return typeof Reflect<"u"&&Reflect.get?Qt=Reflect.get.bind():Qt=function(n,i,r){var t=uc(n,i);if(t){var g=Object.getOwnPropertyDescriptor(t,i);return g.get?g.get.call(arguments.length<3?n:r):g.value}},Qt.apply(this,arguments)}function Jn(e,n){return fc(e)||hc(e,n)||Di(e,n)||gc()}function cr(e){return cc(e)||dc(e)||Di(e)||vc()}function cc(e){if(Array.isArray(e))return qn(e)}function fc(e){if(Array.isArray(e))return e}function dc(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hc(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var r=[],t=!0,g=!1,b,P;try{for(i=i.call(e);!(t=(b=i.next()).done)&&(r.push(b.value),!(n&&r.length===n));t=!0);}catch(m){g=!0,P=m}finally{try{!t&&i.return!=null&&i.return()}finally{if(g)throw P}}return r}}function Di(e,n){if(e){if(typeof e=="string")return qn(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qn(e,n)}}function qn(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function vc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ws(e,n){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Di(e))||n&&e&&typeof e.length=="number"){i&&(e=i);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(m){throw m},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,b=!1,P;return{s:function(){i=i.call(e)},n:function(){var m=i.next();return g=m.done,m},e:function(m){b=!0,P=m},f:function(){try{!g&&i.return!=null&&i.return()}finally{if(b)throw P}}}}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],g=0;g<r;){var b=i[g];if(n.call(t,b,g,i))return b;g++}}});Object.entries||(Object.entries=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=[n[i],e[n[i]]];return r});Object.values||(Object.values=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=e[n[i]];return r});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n,i){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),t=1;t<arguments.length;t++){var g=arguments[t];if(g!=null)for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(r[b]=g[b])}return r},writable:!0,configurable:!0});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],g=0;g<r;){var b=i[g];if(n.call(t,b,g,i))return g;g++}return-1},configurable:!0,writable:!0});var pc="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",Ns={mp4:pc},Ft=function(){var e,n,i,r,t=[],g=t.concat,b=t.filter,P=t.slice,m=window.document,N={},S={},F={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},M=/^\s*<(\w+|!)[^>]*>/,K=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,I=/^(?:body|html)$/i,k=/([A-Z])/g,x=["val","css","html","text","data","width","height","offset"],L=["after","prepend","before","append"],R=m.createElement("table"),O=m.createElement("tr"),C={tr:m.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:O,th:O,"*":m.createElement("div")},y=/complete|loaded|interactive/,u=/^[\w-]*$/,l={},c=l.toString,f={},o,a,s=m.createElement("div"),d={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},p=Array.isArray||function(U){return U instanceof Array};f.matches=function(U,H){if(!H||!U||U.nodeType!==1)return!1;var z=U.matches||U.webkitMatchesSelector||U.mozMatchesSelector||U.oMatchesSelector||U.matchesSelector;if(z)return z.call(U,H);var J,te=U.parentNode,ie=!te;return ie&&(te=s).appendChild(U),J=~f.qsa(te,H).indexOf(U),ie&&s.removeChild(U),J};function _(U){return U==null?String(U):l[c.call(U)]||"object"}function h(U){return _(U)=="function"}function A(U){return U!=null&&U==U.window}function E(U){return U!=null&&U.nodeType==U.DOCUMENT_NODE}function v(U){return _(U)=="object"}function T(U){return v(U)&&!A(U)&&Object.getPrototypeOf(U)==Object.prototype}function D(U){var H=!!U&&"length"in U&&U.length,z=i.type(U);return z!="function"&&!A(U)&&(z=="array"||H===0||typeof H=="number"&&H>0&&H-1 in U)}function B(U){return b.call(U,function(H){return H!=null})}function V(U){return U.length>0?i.fn.concat.apply([],U):U}o=function(U){return U.replace(/-+(.)?/g,function(H,z){return z?z.toUpperCase():""})};function W(U){return U.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}a=function(U){return b.call(U,function(H,z){return U.indexOf(H)==z})};function j(U){return U in S?S[U]:S[U]=new RegExp("(^|\\s)"+U+"(\\s|$)")}function $(U,H){return typeof H=="number"&&!F[W(U)]?H+"px":H}function Q(U){var H,z;return N[U]||(H=m.createElement(U),m.body.appendChild(H),z=getComputedStyle(H,"").getPropertyValue("display"),H.parentNode.removeChild(H),z=="none"&&(z="block"),N[U]=z),N[U]}function Z(U){return"children"in U?P.call(U.children):i.map(U.childNodes,function(H){if(H.nodeType==1)return H})}function ee(U,H){var z,J=U?U.length:0;for(z=0;z<J;z++)this[z]=U[z];this.length=J,this.selector=H||""}f.fragment=function(U,H,z){var J,te,ie;return K.test(U)&&(J=i(m.createElement(RegExp.$1))),J||(U.replace&&(U=U.replace(w,"<$1></$2>")),H===e&&(H=M.test(U)&&RegExp.$1),H in C||(H="*"),ie=C[H],ie.innerHTML=""+U,J=i.each(P.call(ie.childNodes),function(){ie.removeChild(this)})),T(z)&&(te=i(J),i.each(z,function(le,oe){x.indexOf(le)>-1?te[le](oe):te.attr(le,oe)})),J},f.Z=function(U,H){return new ee(U,H)},f.isZ=function(U){return U instanceof f.Z},f.init=function(U,H){var z;if(U)if(typeof U=="string")if(U=U.trim(),U[0]=="<"&&M.test(U))z=f.fragment(U,RegExp.$1,H),U=null;else{if(H!==e)return i(H).find(U);z=f.qsa(m,U)}else{if(h(U))return i(m).ready(U);if(f.isZ(U))return U;if(p(U))z=B(U);else if(v(U))z=[U],U=null;else if(M.test(U))z=f.fragment(U.trim(),RegExp.$1,H),U=null;else{if(H!==e)return i(H).find(U);z=f.qsa(m,U)}}else return f.Z();return f.Z(z,U)},i=function(U,H){return f.init(U,H)};function ae(U,H,z){for(n in H)z&&(T(H[n])||p(H[n]))?(T(H[n])&&!T(U[n])&&(U[n]={}),p(H[n])&&!p(U[n])&&(U[n]=[]),ae(U[n],H[n],z)):H[n]!==e&&(U[n]=H[n])}i.extend=function(U){var H,z=P.call(arguments,1);return typeof U=="boolean"&&(H=U,U=z.shift()),z.forEach(function(J){ae(U,J,H)}),U},f.qsa=function(U,H){var z,J=H[0]=="#",te=!J&&H[0]==".",ie=J||te?H.slice(1):H,le=u.test(ie);return U.getElementById&&le&&J?(z=U.getElementById(ie))?[z]:[]:U.nodeType!==1&&U.nodeType!==9&&U.nodeType!==11?[]:P.call(le&&!J&&U.getElementsByClassName?te?U.getElementsByClassName(ie):U.getElementsByTagName(H):U.querySelectorAll(H))};function se(U,H){return H==null?i(U):i(U).filter(H)}i.contains=m.documentElement.contains?function(U,H){return U!==H&&U.contains(H)}:function(U,H){for(;H&&(H=H.parentNode);)if(H===U)return!0;return!1};function Y(U,H,z,J){return h(H)?H.call(U,z,J):H}function X(U,H,z){z==null?U.removeAttribute(H):U.setAttribute(H,z)}function q(U,H){var z=U.className||"",J=z&&z.baseVal!==e;if(H===e)return J?z.baseVal:z;J?z.baseVal=H:U.className=H}function re(U){try{return U&&(U=="true"||(U=="false"?!1:U=="null"?null:+U+""==U?+U:/^[\[\{]/.test(U)?i.parseJSON(U):U))}catch{return U}}i.type=_,i.isFunction=h,i.isWindow=A,i.isArray=p,i.isPlainObject=T,i.isEmptyObject=function(U){var H;for(H in U)return!1;return!0},i.isNumeric=function(U){var H=Number(U),z=typeof U;return U!=null&&z!="boolean"&&(z!="string"||U.length)&&!isNaN(H)&&isFinite(H)||!1},i.inArray=function(U,H,z){return t.indexOf.call(H,U,z)},i.camelCase=o,i.trim=function(U){return U==null?"":String.prototype.trim.call(U)},i.uuid=0,i.support={},i.expr={},i.noop=function(){},i.map=function(U,H){var z,J=[],te,ie;if(D(U))for(te=0;te<U.length;te++)z=H(U[te],te),z!=null&&J.push(z);else for(ie in U)z=H(U[ie],ie),z!=null&&J.push(z);return V(J)},i.each=function(U,H){var z,J;if(D(U)){for(z=0;z<U.length;z++)if(H.call(U[z],z,U[z])===!1)return U}else for(J in U)if(H.call(U[J],J,U[J])===!1)return U;return U},i.grep=function(U,H){return b.call(U,H)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(U,H){l["[object "+H+"]"]=H.toLowerCase()}),i.fn={constructor:f.Z,length:0,forEach:t.forEach,reduce:t.reduce,push:t.push,sort:t.sort,splice:t.splice,indexOf:t.indexOf,concat:function(){var U,H,z=[];for(U=0;U<arguments.length;U++)H=arguments[U],z[U]=f.isZ(H)?H.toArray():H;return g.apply(f.isZ(this)?this.toArray():this,z)},map:function(U){return i(i.map(this,function(H,z){return U.call(H,z,H)}))},slice:function(){return i(P.apply(this,arguments))},ready:function(U){return y.test(m.readyState)&&m.body?U(i):m.addEventListener("DOMContentLoaded",function(){U(i)},!1),this},get:function(U){return U===e?P.call(this):this[U>=0?U:U+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(U){return t.every.call(this,function(H,z){return U.call(H,z,H)!==!1}),this},filter:function(U){return h(U)?this.not(this.not(U)):i(b.call(this,function(H){return f.matches(H,U)}))},add:function(U,H){return i(a(this.concat(i(U,H))))},is:function(U){return this.length>0&&f.matches(this[0],U)},not:function(U){var H=[];if(h(U)&&U.call!==e)this.each(function(J){U.call(this,J)||H.push(this)});else{var z=typeof U=="string"?this.filter(U):D(U)&&h(U.item)?P.call(U):i(U);this.forEach(function(J){z.indexOf(J)<0&&H.push(J)})}return i(H)},has:function(U){return this.filter(function(){return v(U)?i.contains(this,U):i(this).find(U).size()})},eq:function(U){return U===-1?this.slice(U):this.slice(U,+U+1)},first:function(){var U=this[0];return U&&!v(U)?U:i(U)},last:function(){var U=this[this.length-1];return U&&!v(U)?U:i(U)},find:function(U){var H,z=this;return U?typeof U=="object"?H=i(U).filter(function(){var J=this;return t.some.call(z,function(te){return i.contains(te,J)})}):this.length==1?H=i(f.qsa(this[0],U)):H=this.map(function(){return f.qsa(this,U)}):H=i(),H},closest:function(U,H){var z=[],J=typeof U=="object"&&i(U);return this.each(function(te,ie){for(;ie&&!(J?J.indexOf(ie)>=0:f.matches(ie,U));)ie=ie!==H&&!E(ie)&&ie.parentNode;ie&&z.indexOf(ie)<0&&z.push(ie)}),i(z)},parents:function(U){for(var H=[],z=this;z.length>0;)z=i.map(z,function(J){if((J=J.parentNode)&&!E(J)&&H.indexOf(J)<0)return H.push(J),J});return se(H,U)},parent:function(U){return se(a(this.pluck("parentNode")),U)},children:function(U){return se(this.map(function(){return Z(this)}),U)},contents:function(){return this.map(function(){return this.contentDocument||P.call(this.childNodes)})},siblings:function(U){return se(this.map(function(H,z){return b.call(Z(z.parentNode),function(J){return J!==z})}),U)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(U){return i.map(this,function(H){return H[U]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=Q(this.nodeName))})},replaceWith:function(U){return this.before(U).remove()},wrap:function(U){var H=h(U);if(this[0]&&!H)var z=i(U).get(0),J=z.parentNode||this.length>1;return this.each(function(te){i(this).wrapAll(H?U.call(this,te):J?z.cloneNode(!0):z)})},wrapAll:function(U){if(this[0]){i(this[0]).before(U=i(U));for(var H;(H=U.children()).length;)U=H.first();i(U).append(this)}return this},wrapInner:function(U){var H=h(U);return this.each(function(z){var J=i(this),te=J.contents(),ie=H?U.call(this,z):U;te.length?te.wrapAll(ie):J.append(ie)})},unwrap:function(){return this.parent().each(function(){i(this).replaceWith(i(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(U){return this.each(function(){var H=i(this);(U===e?H.css("display")=="none":U)?H.show():H.hide()})},prev:function(U){return i(this.pluck("previousElementSibling")).filter(U||"*")},next:function(U){return i(this.pluck("nextElementSibling")).filter(U||"*")},html:function(U){return 0 in arguments?this.each(function(H){var z=this.innerHTML;i(this).empty().append(Y(this,U,H,z))}):0 in this?this[0].innerHTML:null},text:function(U){return 0 in arguments?this.each(function(H){var z=Y(this,U,H,this.textContent);this.textContent=z==null?"":""+z}):0 in this?this.pluck("textContent").join(""):null},attr:function(U,H){var z;return typeof U=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&(z=this[0].getAttribute(U))!=null?z:e:this.each(function(J){if(this.nodeType===1)if(v(U))for(n in U)X(this,n,U[n]);else X(this,U,Y(this,H,J,this.getAttribute(U)))})},removeAttr:function(U){return this.each(function(){this.nodeType===1&&U.split(" ").forEach(function(H){X(this,H)},this)})},prop:function(U,H){return U=d[U]||U,1 in arguments?this.each(function(z){this[U]=Y(this,H,z,this[U])}):this[0]&&this[0][U]},removeProp:function(U){return U=d[U]||U,this.each(function(){delete this[U]})},data:function(U,H){var z="data-"+U.replace(k,"-$1").toLowerCase(),J=1 in arguments?this.attr(z,H):this.attr(z);return J!==null?re(J):e},val:function(U){return 0 in arguments?(U==null&&(U=""),this.each(function(H){this.value=Y(this,U,H,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(U){if(U)return this.each(function(z){var J=i(this),te=Y(this,U,z,J.offset()),ie=J.offsetParent().offset(),le={top:te.top-ie.top,left:te.left-ie.left};J.css("position")=="static"&&(le.position="relative"),J.css(le)});if(!this.length)return null;if(m.documentElement!==this[0]&&!i.contains(m.documentElement,this[0]))return{top:0,left:0};var H=this[0].getBoundingClientRect();return{left:H.left+window.pageXOffset,top:H.top+window.pageYOffset,width:Math.round(H.width),height:Math.round(H.height)}},css:function(U,H){if(arguments.length<2){var z=this[0];if(typeof U=="string")return z?z.style[o(U)]||getComputedStyle(z,"").getPropertyValue(U):void 0;if(p(U)){if(!z)return;var J={},te=getComputedStyle(z,"");return i.each(U,function(le,oe){J[oe]=z.style[o(oe)]||te.getPropertyValue(oe)}),J}}var ie="";if(_(U)=="string")!H&&H!==0?this.each(function(){this.style.removeProperty(W(U))}):ie=W(U)+":"+$(U,H);else for(n in U)!U[n]&&U[n]!==0?this.each(function(){this.style.removeProperty(W(n))}):ie+=W(n)+":"+$(n,U[n])+";";return this.each(function(){this.style.cssText+=";"+ie})},index:function(U){return U?this.indexOf(i(U)[0]):this.parent().children().indexOf(this[0])},hasClass:function(U){return U?t.some.call(this,function(H){return this.test(q(H))},j(U)):!1},addClass:function(U){return U?this.each(function(H){if("className"in this){r=[];var z=q(this),J=Y(this,U,H,z);J.split(/\s+/g).forEach(function(te){i(this).hasClass(te)||r.push(te)},this),r.length&&q(this,z+(z?" ":"")+r.join(" "))}}):this},removeClass:function(U){return this.each(function(H){if("className"in this){if(U===e)return q(this,"");r=q(this),Y(this,U,H,r).split(/\s+/g).forEach(function(z){r=r.replace(j(z)," ")}),q(this,r.trim())}})},toggleClass:function(U,H){return U?this.each(function(z){var J=i(this),te=Y(this,U,z,q(this));te.split(/\s+/g).forEach(function(ie){(H===e?!J.hasClass(ie):H)?J.addClass(ie):J.removeClass(ie)})}):this},scrollTop:function(U){if(this.length){var H="scrollTop"in this[0];return U===e?H?this[0].scrollTop:this[0].pageYOffset:this.each(H?function(){this.scrollTop=U}:function(){this.scrollTo(this.scrollX,U)})}},scrollLeft:function(U){if(this.length){var H="scrollLeft"in this[0];return U===e?H?this[0].scrollLeft:this[0].pageXOffset:this.each(H?function(){this.scrollLeft=U}:function(){this.scrollTo(U,this.scrollY)})}},position:function(){if(this.length){var U=this[0],H=this.offsetParent(),z=this.offset(),J=I.test(H[0].nodeName)?{top:0,left:0}:H.offset();return z.top-=parseFloat(i(U).css("margin-top"))||0,z.left-=parseFloat(i(U).css("margin-left"))||0,J.top+=parseFloat(i(H[0]).css("border-top-width"))||0,J.left+=parseFloat(i(H[0]).css("border-left-width"))||0,{top:z.top-J.top,left:z.left-J.left}}},offsetParent:function(){return this.map(function(){for(var U=this.offsetParent||m.body;U&&!I.test(U.nodeName)&&i(U).css("position")=="static";)U=U.offsetParent;return U})}},i.fn.detach=i.fn.remove,["width","height"].forEach(function(U){var H=U.replace(/./,function(z){return z[0].toUpperCase()});i.fn[U]=function(z){var J,te=this[0];return z===e?A(te)?te["inner"+H]:E(te)?te.documentElement["scroll"+H]:(J=this.offset())&&J[U]:this.each(function(ie){te=i(this),te.css(U,Y(this,z,ie,te[U]()))})}});function ne(U,H){H(U);for(var z=0,J=U.childNodes.length;z<J;z++)ne(U.childNodes[z],H)}return L.forEach(function(U,H){var z=H%2;i.fn[U]=function(){var J,te=i.map(arguments,function(oe){var ue=[];return J=_(oe),J=="array"?(oe.forEach(function(fe){if(fe.nodeType!==e)return ue.push(fe);if(i.zepto.isZ(fe))return ue=ue.concat(fe.get());ue=ue.concat(f.fragment(fe))}),ue):J=="object"||oe==null?oe:f.fragment(oe)}),ie,le=this.length>1;return te.length<1?this:this.each(function(oe,ue){ie=z?ue:ue.parentNode,ue=H==0?ue.nextSibling:H==1?ue.firstChild:H==2?ue:null;var fe=i.contains(m.documentElement,ie);te.forEach(function(ge){if(le)ge=ge.cloneNode(!0);else if(!ie)return i(ge).remove();ie.insertBefore(ge,ue),fe&&ne(ge,function(he){if(he.nodeName!=null&&he.nodeName.toUpperCase()==="SCRIPT"&&(!he.type||he.type==="text/javascript")&&!he.src){var Ee=he.ownerDocument?he.ownerDocument.defaultView:window;Ee.eval.call(Ee,he.innerHTML)}})})})},i.fn[z?U+"To":"insert"+(H?"Before":"After")]=function(J){return i(J)[U](this),this}}),f.Z.prototype=ee.prototype=i.fn,f.uniq=a,f.deserializeValue=re,i.zepto=f,i}();window.Zepto=Ft;window.$===void 0&&(window.$=Ft);(function(e){var n=+new Date,i=window.document,r,t,g=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,P=/^(?:text|application)\/xml/i,m="application/json",N="text/html",S=/^\s*$/,F=i.createElement("a");F.href=window.location.href;function M(a,s,d){var p=e.Event(s);return e(a).trigger(p,d),!p.isDefaultPrevented()}function K(a,s,d,p){if(a.global)return M(s||i,d,p)}e.active=0;function w(a){a.global&&e.active++===0&&K(a,null,"ajaxStart")}function I(a){a.global&&!--e.active&&K(a,null,"ajaxStop")}function k(a,s){var d=s.context;if(s.beforeSend.call(d,a,s)===!1||K(s,d,"ajaxBeforeSend",[a,s])===!1)return!1;K(s,d,"ajaxSend",[a,s])}function x(a,s,d,p){var _=d.context,h="success";d.success.call(_,a,h,s),p&&p.resolveWith(_,[a,h,s]),K(d,_,"ajaxSuccess",[s,d,a]),R(h,s,d)}function L(a,s,d,p,_){var h=p.context;p.error.call(h,d,s,a),_&&_.rejectWith(h,[d,s,a]),K(p,h,"ajaxError",[d,p,a||s]),R(s,d,p)}function R(a,s,d){var p=d.context;d.complete.call(p,s,a),K(d,p,"ajaxComplete",[s,d]),I(d)}function O(a,s,d){if(d.dataFilter==C)return a;var p=d.context;return d.dataFilter.call(p,a,s)}function C(){}e.ajaxJSONP=function(a,s){if(!("type"in a))return e.ajax(a);var d=a.jsonpCallback,p=(e.isFunction(d)?d():d)||"Zepto"+n++,_=i.createElement("script"),h=window[p],A,E=function(D){e(_).triggerHandler("error",D||"abort")},v={abort:E},T;return s&&s.promise(v),e(_).on("load error",function(D,B){clearTimeout(T),e(_).off().remove(),D.type=="error"||!A?L(null,B||"error",v,a,s):x(A[0],v,a,s),window[p]=h,A&&e.isFunction(h)&&h(A[0]),h=A=void 0}),k(v,a)===!1?(E("abort"),v):(window[p]=function(){A=arguments},_.src=a.url.replace(/\?(.+)=\?/,"?$1="+p),i.head.appendChild(_),a.timeout>0&&(T=setTimeout(function(){E("timeout")},a.timeout)),v)},e.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:m,xml:"application/xml, text/xml",html:N,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:C};function y(a){return a&&(a=a.split(";",2)[0]),a&&(a==N?"html":a==m?"json":b.test(a)?"script":P.test(a)&&"xml")||"text"}function u(a,s){return s==""?a:(a+"&"+s).replace(/[&?]{1,2}/,"?")}function l(a){a.processData&&a.data&&e.type(a.data)!="string"&&(a.data=e.param(a.data,a.traditional)),a.data&&(!a.type||a.type.toUpperCase()=="GET"||a.dataType=="jsonp")&&(a.url=u(a.url,a.data),a.data=void 0)}e.ajax=function(a){var s=e.extend({},a||{}),d=e.Deferred&&e.Deferred(),p,_;for(r in e.ajaxSettings)s[r]===void 0&&(s[r]=e.ajaxSettings[r]);w(s),s.crossDomain||(p=i.createElement("a"),p.href=s.url,p.href=p.href,s.crossDomain=F.protocol+"//"+F.host!=p.protocol+"//"+p.host),s.url||(s.url=window.location.toString()),(_=s.url.indexOf("#"))>-1&&(s.url=s.url.slice(0,_)),l(s);var h=s.dataType,A=/\?.+=\?/.test(s.url);if(A&&(h="jsonp"),(s.cache===!1||(!a||a.cache!==!0)&&(h=="script"||h=="jsonp"))&&(s.url=u(s.url,"_="+Date.now())),h=="jsonp")return A||(s.url=u(s.url,s.jsonp?s.jsonp+"=?":s.jsonp===!1?"":"callback=?")),e.ajaxJSONP(s,d);var E=s.accepts[h],v={},T=function($,Q){v[$.toLowerCase()]=[$,Q]},D=/^([\w-]+:)\/\//.test(s.url)?RegExp.$1:window.location.protocol,B=s.xhr(),V=B.setRequestHeader,W;if(d&&d.promise(B),s.crossDomain||T("X-Requested-With","XMLHttpRequest"),T("Accept",E||"*/*"),(E=s.mimeType||E)&&(E.indexOf(",")>-1&&(E=E.split(",",2)[0]),B.overrideMimeType&&B.overrideMimeType(E)),(s.contentType||s.contentType!==!1&&s.data&&s.type.toUpperCase()!="GET")&&T("Content-Type",s.contentType||"application/x-www-form-urlencoded"),s.headers)for(t in s.headers)T(t,s.headers[t]);if(B.setRequestHeader=T,B.onreadystatechange=function(){if(B.readyState==4){B.onreadystatechange=C,clearTimeout(W);var $,Q=!1;if(B.status>=200&&B.status<300||B.status==304||B.status==0&&D=="file:"){if(h=h||y(s.mimeType||B.getResponseHeader("content-type")),B.responseType=="arraybuffer"||B.responseType=="blob")$=B.response;else{$=B.responseText;try{$=O($,h,s),h=="script"?(0,eval)($):h=="xml"?$=B.responseXML:h=="json"&&($=S.test($)?null:e.parseJSON($))}catch(Z){Q=Z}if(Q)return L(Q,"parsererror",B,s,d)}x($,B,s,d)}else L(B.statusText||null,B.status?"error":"abort",B,s,d)}},k(B,s)===!1)return B.abort(),L(null,"abort",B,s,d),B;var j="async"in s?s.async:!0;if(B.open(s.type,s.url,j,s.username,s.password),s.xhrFields)for(t in s.xhrFields)B[t]=s.xhrFields[t];for(t in v)V.apply(B,v[t]);return s.timeout>0&&(W=setTimeout(function(){B.onreadystatechange=C,B.abort(),L(null,"timeout",B,s,d)},s.timeout)),B.send(s.data?s.data:null),B};function c(a,s,d,p){return e.isFunction(s)&&(p=d,d=s,s=void 0),e.isFunction(d)||(p=d,d=void 0),{url:a,data:s,success:d,dataType:p}}e.get=function(){return e.ajax(c.apply(null,arguments))},e.post=function(){var a=c.apply(null,arguments);return a.type="POST",e.ajax(a)},e.getJSON=function(){var a=c.apply(null,arguments);return a.dataType="json",e.ajax(a)},e.fn.load=function(a,s,d){if(!this.length)return this;var p=this,_=a.split(/\s/),h,A=c(a,s,d),E=A.success;return _.length>1&&(A.url=_[0],h=_[1]),A.success=function(v){p.html(h?e("<div>").html(v.replace(g,"")).find(h):v),E&&E.apply(p,arguments)},e.ajax(A),this};var f=encodeURIComponent;function o(a,s,d,p){var _,h=e.isArray(s),A=e.isPlainObject(s);e.each(s,function(E,v){_=e.type(v),p&&(E=d?p:p+"["+(A||_=="object"||_=="array"?E:"")+"]"),!p&&h?a.add(v.name,v.value):_=="array"||!d&&_=="object"?o(a,v,d,E):a.add(E,v)})}e.param=function(a,s){var d=[];return d.add=function(p,_){e.isFunction(_)&&(_=_()),_==null&&(_=""),this.push(f(p)+"="+f(_))},o(d,a,s),d.join("&").replace(/%20/g,"+")}})(Ft);(function(e){e.Callbacks=function(n){n=e.extend({},n);var i,r,t,g,b,P,m=[],N=!n.once&&[],S=function(M){for(i=n.memory&&M,r=!0,P=g||0,g=0,b=m.length,t=!0;m&&P<b;++P)if(m[P].apply(M[0],M[1])===!1&&n.stopOnFalse){i=!1;break}t=!1,m&&(N?N.length&&S(N.shift()):i?m.length=0:F.disable())},F={add:function(){if(m){var M=m.length,K=function(w){e.each(w,function(I,k){typeof k=="function"?(!n.unique||!F.has(k))&&m.push(k):k&&k.length&&typeof k!="string"&&K(k)})};K(arguments),t?b=m.length:i&&(g=M,S(i))}return this},remove:function(){return m&&e.each(arguments,function(M,K){for(var w;(w=e.inArray(K,m,w))>-1;)m.splice(w,1),t&&(w<=b&&--b,w<=P&&--P)}),this},has:function(M){return!!(m&&(M?e.inArray(M,m)>-1:m.length))},empty:function(){return b=m.length=0,this},disable:function(){return m=N=i=void 0,this},disabled:function(){return!m},lock:function(){return N=void 0,i||F.disable(),this},locked:function(){return!N},fireWith:function(M,K){return m&&(!r||N)&&(K=K||[],K=[M,K.slice?K.slice():K],t?N.push(K):S(K)),this},fire:function(){return F.fireWith(this,arguments)},fired:function(){return!!r}};return F}})(Ft);(function(e){var n=Array.prototype.slice;function i(r){var t=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],g="pending",b={state:function(){return g},always:function(){return P.done(arguments).fail(arguments),this},then:function(){var m=arguments;return i(function(N){e.each(t,function(S,F){var M=e.isFunction(m[S])&&m[S];P[F[1]](function(){var K=M&&M.apply(this,arguments);if(K&&e.isFunction(K.promise))K.promise().done(N.resolve).fail(N.reject).progress(N.notify);else{var w=this===b?N.promise():this,I=M?[K]:arguments;N[F[0]+"With"](w,I)}})}),m=null}).promise()},promise:function(m){return m!=null?e.extend(m,b):b}},P={};return e.each(t,function(m,N){var S=N[2],F=N[3];b[N[1]]=S.add,F&&S.add(function(){g=F},t[m^1][2].disable,t[2][2].lock),P[N[0]]=function(){return P[N[0]+"With"](this===P?b:this,arguments),this},P[N[0]+"With"]=S.fireWith}),b.promise(P),r&&r.call(P,P),P}e.when=function(r){var t=n.call(arguments),g=t.length,b=0,P=g!==1||r&&e.isFunction(r.promise)?g:0,m=P===1?r:i(),N,S,F,M=function(K,w,I){return function(k){w[K]=this,I[K]=arguments.length>1?n.call(arguments):k,I===N?m.notifyWith(w,I):--P||m.resolveWith(w,I)}};if(g>1)for(N=new Array(g),S=new Array(g),F=new Array(g);b<g;++b)t[b]&&e.isFunction(t[b].promise)?t[b].promise().done(M(b,F,t)).fail(m.reject).progress(M(b,S,N)):--P;return P||m.resolveWith(F,t),m.promise()},e.Deferred=i})(Ft);(function(e){var n=1,i,r=Array.prototype.slice,t=e.isFunction,g=function(c){return typeof c=="string"},b={},P={},m="onfocusin"in window,N={focus:"focusin",blur:"focusout"},S={mouseenter:"mouseover",mouseleave:"mouseout"};P.click=P.mousedown=P.mouseup=P.mousemove="MouseEvents";function F(c){return c._zid||(c._zid=n++)}function M(c,f,o,a){if(f=K(f),f.ns)var s=w(f.ns);return(b[F(c)]||[]).filter(function(d){return d&&(!f.e||d.e==f.e)&&(!f.ns||s.test(d.ns))&&(!o||F(d.fn)===F(o))&&(!a||d.sel==a)})}function K(c){var f=(""+c).split(".");return{e:f[0],ns:f.slice(1).sort().join(" ")}}function w(c){return new RegExp("(?:^| )"+c.replace(" "," .* ?")+"(?: |$)")}function I(c,f){return c.del&&!m&&c.e in N||!!f}function k(c){return S[c]||m&&N[c]||c}function x(c,f,o,a,s,d,p){var _=F(c),h=b[_]||(b[_]=[]);f.split(/\s/).forEach(function(A){if(A=="ready")return e(document).ready(o);var E=K(A);E.fn=o,E.sel=s,E.e in S&&(o=function(T){var D=T.relatedTarget;if(!D||D!==this&&!e.contains(this,D))return E.fn.apply(this,arguments)}),E.del=d;var v=d||o;E.proxy=function(T){if(T=u(T),!T.isImmediatePropagationStopped()){T.data=a;var D=v.apply(c,T._args==i?[T]:[T].concat(T._args));return D===!1&&(T.preventDefault(),T.stopPropagation()),D}},E.i=h.length,h.push(E),"addEventListener"in c&&c.addEventListener(k(E.e),E.proxy,I(E,p))})}function L(c,f,o,a,s){var d=F(c);(f||"").split(/\s/).forEach(function(p){M(c,p,o,a).forEach(function(_){delete b[d][_.i],"removeEventListener"in c&&c.removeEventListener(k(_.e),_.proxy,I(_,s))})})}e.event={add:x,remove:L},e.proxy=function(c,f){var o=2 in arguments&&r.call(arguments,2);if(t(c)){var a=function(){return c.apply(f,o?o.concat(r.call(arguments)):arguments)};return a._zid=F(c),a}else{if(g(f))return o?(o.unshift(c[f],c),e.proxy.apply(null,o)):e.proxy(c[f],c);throw new TypeError("expected function")}},e.fn.bind=function(c,f,o){return this.on(c,f,o)},e.fn.unbind=function(c,f){return this.off(c,f)},e.fn.one=function(c,f,o,a){return this.on(c,f,o,a,1)};var R=function(){return!0},O=function(){return!1},C=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function u(c,f){return(f||!c.isDefaultPrevented)&&(f||(f=c),e.each(y,function(o,a){var s=f[o];c[o]=function(){return this[a]=R,s&&s.apply(f,arguments)},c[a]=O}),c.timeStamp||(c.timeStamp=Date.now()),(f.defaultPrevented!==i?f.defaultPrevented:"returnValue"in f?f.returnValue===!1:f.getPreventDefault&&f.getPreventDefault())&&(c.isDefaultPrevented=R)),c}function l(c){var f,o={originalEvent:c};for(f in c)!C.test(f)&&c[f]!==i&&(o[f]=c[f]);return u(o,c)}e.fn.delegate=function(c,f,o){return this.on(f,c,o)},e.fn.undelegate=function(c,f,o){return this.off(f,c,o)},e.fn.live=function(c,f){return e(document.body).delegate(this.selector,c,f),this},e.fn.die=function(c,f){return e(document.body).undelegate(this.selector,c,f),this},e.fn.on=function(c,f,o,a,s){var d,p,_=this;return c&&!g(c)?(e.each(c,function(h,A){_.on(h,f,o,A,s)}),_):(!g(f)&&!t(a)&&a!==!1&&(a=o,o=f,f=i),(a===i||o===!1)&&(a=o,o=i),a===!1&&(a=O),_.each(function(h,A){s&&(d=function(E){return L(A,E.type,a),a.apply(this,arguments)}),f&&(p=function(E){var v,T=e(E.target).closest(f,A).get(0);if(T&&T!==A)return v=e.extend(l(E),{currentTarget:T,liveFired:A}),(d||a).apply(T,[v].concat(r.call(arguments,1)))}),x(A,c,a,o,f,p||d)}))},e.fn.off=function(c,f,o){var a=this;return c&&!g(c)?(e.each(c,function(s,d){a.off(s,f,d)}),a):(!g(f)&&!t(o)&&o!==!1&&(o=f,f=i),o===!1&&(o=O),a.each(function(){L(this,c,o,f)}))},e.fn.trigger=function(c,f){return c=g(c)||e.isPlainObject(c)?e.Event(c):u(c),c._args=f,this.each(function(){c.type in N&&typeof this[c.type]=="function"?this[c.type]():"dispatchEvent"in this?this.dispatchEvent(c):e(this).triggerHandler(c,f)})},e.fn.triggerHandler=function(c,f){var o,a;return this.each(function(s,d){o=l(g(c)?e.Event(c):c),o._args=f,o.target=d,e.each(M(d,c.type||c),function(p,_){if(a=_.proxy(o),o.isImmediatePropagationStopped())return!1})}),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(c){e.fn[c]=function(f){return 0 in arguments?this.bind(c,f):this.trigger(c)}}),e.Event=function(c,f){g(c)||(f=c,c=f.type);var o=document.createEvent(P[c]||"Events"),a=!0;if(f)for(var s in f)s=="bubbles"?a=!!f[s]:o[s]=f[s];return o.initEvent(c,a,!0),u(o)}})(Ft);(function(){try{getComputedStyle(void 0)}catch{var e=getComputedStyle;window.getComputedStyle=function(i,r){try{return e(i,r)}catch{return null}}}})();(function(e){var n=e.zepto,i=n.qsa,r=n.matches;function t(S){return S=e(S),!!(S.width()||S.height())&&S.css("display")!=="none"}var g=e.expr[":"]={visible:function(){if(t(this))return this},hidden:function(){if(!t(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(S){if(S===0)return this},last:function(S,F){if(S===F.length-1)return this},eq:function(S,F,M){if(S===M)return this},contains:function(S,F,M){if(e(this).text().indexOf(M)>-1)return this},has:function(S,F,M){if(n.qsa(this,M).length)return this}},b=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),P=/^\s*>/,m="Zepto"+ +new Date;function N(S,F){S=S.replace(/=#\]/g,'="#"]');var M,K,w=b.exec(S);if(w&&w[2]in g&&(M=g[w[2]],K=w[3],S=w[1],K)){var I=Number(K);isNaN(I)?K=K.replace(/^["']|["']$/g,""):K=I}return F(S,M,K)}n.qsa=function(S,F){return N(F,function(M,K,w){try{var I;!M&&K?M="*":P.test(M)&&(I=e(S).addClass(m),M="."+m+" "+M);var k=i(S,M)}catch(x){throw console.error("error performing selector: %o",F),x}finally{I&&I.removeClass(m)}return K?n.uniq(e.map(k,function(x,L){return K.call(x,L,k,w)})):k})},n.matches=function(S,F){return N(F,function(M,K,w){return(!M||r(S,M))&&(!K||K.call(S,null,w)===S)})}})(Ft);var ve=Ft,mc=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],yc=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],de={},Ec=function(){try{return localStorage.setItem("clappr","clappr"),localStorage.removeItem("clappr"),!0}catch{return!1}},Ac=function(){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!n}catch{return!!(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==void 0&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}},_c=function(n){var i=n.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],r;if(/trident/i.test(i[1]))return r=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:parseInt(r[1]||"")};if(i[1]==="Chrome"){if(r=n.match(/\bOPR\/(\d+)/),r!=null)return{name:"Opera",version:parseInt(r[1])};if(r=n.match(/\bEdge\/(\d+)/),r!=null)return{name:"Edge",version:parseInt(r[1])}}else/android/i.test(n)&&(r=n.match(/version\/(\d+)/i))&&(i.splice(1,1,"Android WebView"),i.splice(2,1,r[1]));return i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],{name:i[0],version:parseInt(i[1])}},Tc=function(){var n={},i=de.userAgent.toLowerCase(),r=ws(mc),t;try{for(r.s();!(t=r.n()).done;){var g=t.value,b=new RegExp(g.identifier.toLowerCase()),P=b.exec(i);if(P!=null&&P[1]){if(n.name=g.name,n.group=g.group,g.versionIdentifier){var m=new RegExp(g.versionIdentifier.toLowerCase()),N=m.exec(i);N!=null&&N[1]&&ga(N[1],n)}else ga(P[1],n);break}}}catch(S){r.e(S)}finally{r.f()}return n},ga=function(n,i){var r=n.split(".",2);i.fullVersion=n,r[0]&&(i.majorVersion=parseInt(r[0])),r[1]&&(i.minorVersion=parseInt(r[1]))},bc=function(){var n={},i=de.userAgent.toLowerCase(),r=ws(yc),t;try{for(r.s();!(t=r.n()).done;){var g=t.value,b=new RegExp(g.identifier.toLowerCase()),P=b.exec(i);if(P!=null){if(n.name=g.name,n.group=g.group,g.version)kn(g.version,g.versionSeparator?g.versionSeparator:".",n);else if(P[1])kn(P[1],g.versionSeparator?g.versionSeparator:".",n);else if(g.versionIdentifier){var m=new RegExp(g.versionIdentifier.toLowerCase()),N=m.exec(i);N!=null&&N[1]&&kn(N[1],g.versionSeparator?g.versionSeparator:".",n)}break}}}catch(S){r.e(S)}finally{r.f()}return n},kn=function(n,i,r){var t=i.substr(0,1)=="["?new RegExp(i,"g"):i,g=n.split(t,2);i!="."&&(n=n.replace(new RegExp(i,"g"),".")),r.fullVersion=n,g&&g[0]&&(r.majorVersion=parseInt(g[0])),g&&g[1]&&(r.minorVersion=parseInt(g[1]))},Sc=function(){var n={};return n.width=ve(window).width(),n.height=ve(window).height(),n},xc=function(){switch(window.orientation){case-90:case 90:de.viewport.orientation="landscape";break;default:de.viewport.orientation="portrait";break}},Cc=function(n){var i=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/,r=i.exec(n),t=r&&(r[1]||r[2])||"";return t},Fs=_c(navigator.userAgent);de.isEdge=/Edg|EdgiOS|EdgA/i.test(navigator.userAgent);de.isChrome=/Chrome|CriOS/i.test(navigator.userAgent)&&!de.isEdge;de.isSafari=/Safari/i.test(navigator.userAgent)&&!de.isChrome&&!de.isEdge;de.isFirefox=/Firefox/i.test(navigator.userAgent);de.isLegacyIE=!!window.ActiveXObject;de.isIE=de.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent);de.isIE11=/trident.*rv:11/i.test(navigator.userAgent);de.isChromecast=de.isChrome&&/CrKey/i.test(navigator.userAgent);de.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent);de.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);de.isAndroid=/Android/i.test(navigator.userAgent);de.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent);de.isWin8App=/MSAppHost/i.test(navigator.userAgent);de.isWiiU=/WiiU/i.test(navigator.userAgent);de.isPS4=/PlayStation 4/i.test(navigator.userAgent);de.hasLocalstorage=Ec();de.hasFlash=Ac();de.name=Fs.name;de.version=Fs.version;de.userAgent=navigator.userAgent;de.data=Tc();de.os=bc();de.isWindows=/^Windows$/i.test(de.os.group);de.isMacOS=/^Mac OS$/i.test(de.os.group);de.isLinux=/^Linux$/i.test(de.os.group);de.viewport=Sc();de.device=Cc(de.userAgent);typeof window.orientation<"u"&&xc();var Mn={},wn=[],Bs=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window),Us=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Ks(e,n){if(n)for(var i in n){var r=Object.getOwnPropertyDescriptor(n,i);r?Object.defineProperty(e,i,r):e[i]=n[i]}return e}function Er(e,n){var i=function(r){Me(g,r);var t=we(g);function g(){var b;Se(this,g);for(var P=arguments.length,m=new Array(P),N=0;N<P;N++)m[N]=arguments[N];return b=t.call.apply(t,[this].concat(m)),n.initialize&&n.initialize.apply(yn(b),m),b}return xe(g)}(e);return Ks(i.prototype,n),i}function Lc(e,n){if(!isFinite(e))return"--:--";e=e*1e3,e=parseInt(e/1e3);var i=e%60;e=parseInt(e/60);var r=e%60;e=parseInt(e/60);var t=e%24,g=parseInt(e/24),b="";return g&&g>0&&(b+=g+":",t<1&&(b+="00:")),(t&&t>0||n)&&(b+=("0"+t).slice(-2)+":"),b+=("0"+r).slice(-2)+":",b+=("0"+i).slice(-2),b.trim()}var Tr={fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function(n){if(n.requestFullscreen)return n.requestFullscreen();if(n.webkitRequestFullscreen){if(typeof n.then=="function")return n.webkitRequestFullscreen();n.webkitRequestFullscreen()}else{if(n.mozRequestFullScreen)return n.mozRequestFullScreen();if(n.msRequestFullscreen)return n.msRequestFullscreen();n.querySelector&&n.querySelector("video")&&n.querySelector("video").webkitEnterFullScreen?n.querySelector("video").webkitEnterFullScreen():n.webkitEnterFullScreen&&n.webkitEnterFullScreen()}},cancelFullscreen:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;n.exitFullscreen?n.exitFullscreen():n.webkitCancelFullScreen?n.webkitCancelFullScreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen()},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},Dc=function(){function e(){Se(this,e)}return xe(e,null,[{key:"_defaultConfig",value:function(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function(i){try{return this._defaultConfig()[i].parse(this._defaultConfig()[i].value)}catch{return}}},{key:"_createKeyspace",value:function(i){return"clappr.".concat(document.domain,".").concat(i)}},{key:"restore",value:function(i){return de.hasLocalstorage&&localStorage[this._createKeyspace(i)]?this._defaultConfig()[i].parse(localStorage[this._createKeyspace(i)]):this._defaultValueFor(i)}},{key:"persist",value:function(i,r){if(de.hasLocalstorage)try{return localStorage[this._createKeyspace(i)]=r,!0}catch{return!1}}}]),e}(),ei=function(){function e(){Se(this,e)}return xe(e,null,[{key:"params",get:function(){var i=window.location.search.substring(1);return i!==this.query&&(this._urlParams=this.parse(i),this.query=i),this._urlParams}},{key:"hashParams",get:function(){var i=window.location.hash.substring(1);return i!==this.hash&&(this._hashParams=this.parse(i),this.hash=i),this._hashParams}},{key:"parse",value:function(i){for(var r,t=/\+/g,g=/([^&=]+)=?([^&]*)/g,b=function(N){return decodeURIComponent(N.replace(t," "))},P={};r=g.exec(i);)P[b(r[1]).toLowerCase()]=b(r[2]);return P}}]),e}();function Ws(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"t",n=0,i=ei.params[e]||ei.hashParams[e]||"",r=i.match(/[0-9]+[hms]+/g)||[];if(r.length>0){var t={h:3600,m:60,s:1};r.forEach(function(g){if(g){var b=g[g.length-1],P=parseInt(g.slice(0,g.length-1),10);n+=P*t[b]}})}else i&&(n=parseInt(i,10));return n}function Br(e){Mn[e]||(Mn[e]=0);var n=++Mn[e];return e+n}function sn(e){return e-parseFloat(e)+1>=0}function Vs(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function Gs(){return window.navigator&&window.navigator.language}function Oc(){return window.performance&&window.performance.now?performance.now():Date.now()}function Ic(e,n){var i=e.indexOf(n);i>=0&&e.splice(i,1)}function Pc(e,n){return e===void 0||n===void 0?!1:n.find(function(i){return e.toLowerCase()===i.toLowerCase()})!==void 0}function Hs(e,n){n=Object.assign({inline:!1,muted:!1,timeout:250,type:"video",source:Ns.mp4,element:null},n);var i=n.element?n.element:document.createElement(n.type);i.muted=n.muted,n.muted===!0&&i.setAttribute("muted","muted"),n.inline===!0&&i.setAttribute("playsinline","playsinline"),i.src=n.source;var r=i.play(),t=setTimeout(function(){g(!1,new Error("Timeout ".concat(n.timeout," ms has been reached")))},n.timeout),g=function(P){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;clearTimeout(t),e(P,m)};r!==void 0?r.then(function(){return g(!0)}).catch(function(b){return g(!1,b)}):g(!0)}var gr=function(){function e(){Se(this,e)}return xe(e,null,[{key:"configure",value:function(i){this.options=ve.extend(!0,this.options,i)}},{key:"create",value:function(i){return this.options.recycleVideo&&i==="video"&&wn.length>0?wn.shift():document.createElement(i)}},{key:"garbage",value:function(i){!this.options.recycleVideo||i.tagName.toUpperCase()!=="VIDEO"||(ve(i).children().remove(),Object.values(i.attributes).forEach(function(r){return i.removeAttribute(r.name)}),wn.push(i))}}]),e}();gr.options={recycleVideo:!1};var js=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:500;Se(this,e),this.delay=n,this.lastTime=0}return xe(e,[{key:"handle",value:function(i,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,g=new Date().getTime(),b=g-this.lastTime;b<this.delay&&b>0&&(r(),t&&i.preventDefault()),this.lastTime=g}}]),e}(),Bt={Config:Dc,Fullscreen:Tr,QueryString:ei,DomRecycler:gr,assign:Ks,extend:Er,formatTime:Lc,seekStringToSeconds:Ws,uniqueId:Br,currentScriptUrl:Vs,isNumber:sn,requestAnimationFrame:Bs,cancelAnimationFrame:Us,getBrowserLanguage:Gs,now:Oc,removeArrayItem:Ic,listContainsIgnoreCase:Pc,canAutoPlayMedia:Hs,Media:Ns,DoubleEventHandler:js},En="font-weight: bold; font-size: 13px;",Rc="color: #006600;"+En,kc="color: #0000ff;"+En,Ys="color: #ff8000;"+En,pa="color: #ff0000;"+En,$s=0,ti=1,zs=2,Oi=3,Mc=Oi,wc=[kc,Rc,Ys,pa,pa],ma=["debug","info","warn","error","disabled"],Ae=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ti,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mc;Se(this,e),this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"],this.level=n,this.previousLevel=this.level,this.offLevel=i}return xe(e,[{key:"level",get:function(){return this._level},set:function(i){this._level=i}},{key:"debug",value:function(i){this.log(i,$s,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(i){this.log(i,ti,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(i){this.log(i,zs,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(i){this.log(i,Oi,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+ma[this.level],Ys)}},{key:"log",value:function(i,r,t){if(!(this.EXCLUDE_LIST.indexOf(t[0])>=0)&&!(r<this.level)){t||(t=i,i=null);var g=wc[r],b="";i&&(b="["+i+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+ma[r]+"]"+b,g].concat(t))}}}]),e}();Ae.LEVEL_DEBUG=$s;Ae.LEVEL_INFO=ti;Ae.LEVEL_WARN=zs;Ae.LEVEL_ERROR=Oi;Ae.getInstance=function(){return this._instance===void 0&&(this._instance=new this),this._instance};Ae.setLevel=function(e){this.getInstance().level=e};Ae.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)};Ae.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)};Ae.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)};Ae.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var Nc=Array.prototype.slice,ya=/\s+/,zr=function(n,i,r,t){if(!r)return!0;if(vr(r)==="object"){for(var g in r)n[i].apply(n,[g,r[g]].concat(t));return!1}if(ya.test(r)){for(var b=r.split(ya),P=0,m=b.length;P<m;P++)n[i].apply(n,[b[P]].concat(t));return!1}return!0},Ea=function(n,i,r,t){var g,b=-1,P=n.length,m=i[0],N=i[1],S=i[2];F();function F(){try{switch(i.length){case 0:for(;++b<P;)(g=n[b]).callback.call(g.ctx);return;case 1:for(;++b<P;)(g=n[b]).callback.call(g.ctx,m);return;case 2:for(;++b<P;)(g=n[b]).callback.call(g.ctx,m,N);return;case 3:for(;++b<P;)(g=n[b]).callback.call(g.ctx,m,N,S);return;default:for(;++b<P;)(g=n[b]).callback.apply(g.ctx,i);return}}catch(M){Ae.error.apply(Ae,[r,"error on event",t,"trigger","-",M]),F()}}},G=function(){function e(){Se(this,e)}return xe(e,[{key:"on",value:function(i,r,t){if(!zr(this,"on",i,[r,t])||!r)return this;this._events||(this._events={});var g=this._events[i]||(this._events[i]=[]);return g.push({callback:r,context:t,ctx:t||this}),this}},{key:"once",value:function(i,r,t){var g=this,b;if(!zr(this,"once",i,[r,t])||!r)return this;var P=function(){return g.off(i,b)};return b=function(){P(),r.apply(this,arguments)},this.on(i,b,t)}},{key:"off",value:function(i,r,t){var g,b,P,m,N,S,F,M;if(!this._events||!zr(this,"off",i,[r,t]))return this;if(!i&&!r&&!t)return this._events=void 0,this;for(m=i?[i]:Object.keys(this._events),N=0,S=m.length;N<S;N++)if(i=m[N],P=this._events[i],P){if(this._events[i]=g=[],r||t)for(F=0,M=P.length;F<M;F++)b=P[F],(r&&r!==b.callback&&r!==b.callback._callback||t&&t!==b.context)&&g.push(b);g.length||delete this._events[i]}return this}},{key:"trigger",value:function(i){var r=this.name||this.constructor.name;if(Ae.debug.apply(Ae,[r].concat(Array.prototype.slice.call(arguments))),!this._events)return this;var t=Nc.call(arguments,1);if(!zr(this,"trigger",i,t))return this;var g=this._events[i],b=this._events.all;return g&&Ea(g,t,r,i),b&&Ea(b,arguments,r,i),this}},{key:"stopListening",value:function(i,r,t){var g=this._listeningTo;if(!g)return this;var b=!r&&!t;!t&&vr(r)==="object"&&(t=this),i&&((g={})[i._listenId]=i);for(var P in g)i=g[P],i.off(r,t,this),(b||Object.keys(i._events).length===0)&&delete this._listeningTo[P];return this}}],[{key:"register",value:function(i){e.Custom||(e.Custom={});var r=typeof i=="string"&&i.toUpperCase().trim();r&&!e.Custom[r]?e.Custom[r]=r.toLowerCase().split("_").map(function(t,g){return g===0?t:t=t[0].toUpperCase()+t.slice(1)}).join(""):Ae.error("Events","Error when register event: "+i)}},{key:"listAvailableCustomEvents",value:function(){return e.Custom||(e.Custom={}),Object.keys(e.Custom).filter(function(i){return typeof e.Custom[i]=="string"})}}]),e}(),Aa={listenTo:"on",listenToOnce:"once"};Object.keys(Aa).forEach(function(e){G.prototype[e]=function(n,i,r){var t=this._listeningTo||(this._listeningTo={}),g=n._listenId||(n._listenId=Br("l"));return t[g]=n,!r&&vr(i)==="object"&&(r=this),n[Aa[e]](i,r,this),this}});G.PLAYER_READY="ready";G.PLAYER_RESIZE="resize";G.PLAYER_FULLSCREEN="fullscreen";G.PLAYER_PLAY="play";G.PLAYER_PAUSE="pause";G.PLAYER_STOP="stop";G.PLAYER_ENDED="ended";G.PLAYER_SEEK="seek";G.PLAYER_ERROR="playererror";G.ERROR="error";G.PLAYER_TIMEUPDATE="timeupdate";G.PLAYER_VOLUMEUPDATE="volumeupdate";G.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable";G.PLAYBACK_PROGRESS="playback:progress";G.PLAYBACK_TIMEUPDATE="playback:timeupdate";G.PLAYBACK_READY="playback:ready";G.PLAYBACK_BUFFERING="playback:buffering";G.PLAYBACK_BUFFERFULL="playback:bufferfull";G.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate";G.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata";G.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate";G.PLAYBACK_BITRATE="playback:bitrate";G.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available";G.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start";G.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end";G.PLAYBACK_PLAYBACKSTATE="playback:playbackstate";G.PLAYBACK_DVR="playback:dvr";G.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable";G.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable";G.PLAYBACK_ENDED="playback:ended";G.PLAYBACK_PLAY_INTENT="playback:play:intent";G.PLAYBACK_PLAY="playback:play";G.PLAYBACK_PAUSE="playback:pause";G.PLAYBACK_SEEK="playback:seek";G.PLAYBACK_SEEKED="playback:seeked";G.PLAYBACK_STOP="playback:stop";G.PLAYBACK_ERROR="playback:error";G.PLAYBACK_STATS_ADD="playback:stats:add";G.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded";G.PLAYBACK_LEVEL_SWITCH="playback:level:switch";G.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available";G.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed";G.PLAYBACK_AUDIO_AVAILABLE="playback:audio:available";G.PLAYBACK_AUDIO_CHANGED="playback:audio:changed";G.CORE_CONTAINERS_CREATED="core:containers:created";G.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed";G.CORE_OPTIONS_CHANGE="core:options:change";G.CORE_READY="core:ready";G.CORE_FULLSCREEN="core:fullscreen";G.CORE_RESIZE="core:resize";G.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed";G.CORE_MOUSE_MOVE="core:mousemove";G.CORE_MOUSE_LEAVE="core:mouseleave";G.CONTAINER_PLAYBACKSTATE="container:playbackstate";G.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr";G.CONTAINER_BITRATE="container:bitrate";G.CONTAINER_STATS_REPORT="container:stats:report";G.CONTAINER_DESTROYED="container:destroyed";G.CONTAINER_READY="container:ready";G.CONTAINER_RESIZE="container:resize";G.CONTAINER_ERROR="container:error";G.CONTAINER_LOADEDMETADATA="container:loadedmetadata";G.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available";G.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed";G.CONTAINER_AUDIO_AVAILABLE="container:audio:available";G.CONTAINER_AUDIO_CHANGED="container:audio:changed";G.CONTAINER_TIMEUPDATE="container:timeupdate";G.CONTAINER_PROGRESS="container:progress";G.CONTAINER_PLAY="container:play";G.CONTAINER_STOP="container:stop";G.CONTAINER_PAUSE="container:pause";G.CONTAINER_ENDED="container:ended";G.CONTAINER_CLICK="container:click";G.CONTAINER_DBLCLICK="container:dblclick";G.CONTAINER_CONTEXTMENU="container:contextmenu";G.CONTAINER_MOUSE_ENTER="container:mouseenter";G.CONTAINER_MOUSE_LEAVE="container:mouseleave";G.CONTAINER_MOUSE_UP="container:mouseup";G.CONTAINER_MOUSE_DOWN="container:mousedown";G.CONTAINER_SEEK="container:seek";G.CONTAINER_SEEKED="container:seeked";G.CONTAINER_VOLUME="container:volume";G.CONTAINER_FULLSCREEN="container:fullscreen";G.CONTAINER_STATE_BUFFERING="container:state:buffering";G.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull";G.CONTAINER_SETTINGSUPDATE="container:settingsupdate";G.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate";G.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show";G.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide";G.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable";G.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable";G.CONTAINER_STATS_ADD="container:stats:add";G.CONTAINER_OPTIONS_CHANGE="container:options:change";G.MEDIACONTROL_RENDERED="mediacontrol:rendered";G.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen";G.MEDIACONTROL_SHOW="mediacontrol:show";G.MEDIACONTROL_HIDE="mediacontrol:hide";G.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar";G.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar";G.MEDIACONTROL_PLAYING="mediacontrol:playing";G.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying";G.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged";G.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change";var nr=function(e){Me(i,e);var n=we(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Se(this,i),r=n.call(this,t),r._options=t,r.uniqueId=Br("o"),r}return xe(i,[{key:"options",get:function(){return this._options}}]),i}(G),Yt={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Nn=/(.)^/,Fc={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},Bc=/\\|'|\r|\n|\t|\u2028|\u2029/g,Uc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Kc=new RegExp(`[&<>"']`,"g"),_a=function(n){return n===null?"":(""+n).replace(Kc,function(i){return Uc[i]})},Wc=0,nt=function(n,i){var r,t=new RegExp([(Yt.escape||Nn).source,(Yt.interpolate||Nn).source,(Yt.evaluate||Nn).source].join("|")+"|$","g"),g=0,b="__p+='";n.replace(t,function(m,N,S,F,M){return b+=n.slice(g,M).replace(Bc,function(K){return"\\"+Fc[K]}),N&&(b+=`'+
((__t=(`+N+`))==null?'':escapeExpr(__t))+
'`),S&&(b+=`'+
((__t=(`+S+`))==null?'':__t)+
'`),F&&(b+=`';
`+F+`
__p+='`),g=M+m.length,m}),b+=`';
`,Yt.variable||(b=`with(obj||{}){
`+b+`}
`),b=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+b+`return __p;
//# sourceURL=/microtemplates/source[`+Wc+++"]";try{r=new Function(Yt.variable||"obj","escapeExpr",b)}catch(m){throw m.source=b,m}if(i)return r(i,_a);var P=function(N){return r.call(this,N,_a)};return P.source="function("+(Yt.variable||"obj")+`){
`+b+"}",P};nt.settings=Yt;var ze={getStyleFor:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{baseUrl:""};return ve('<style class="clappr-style"></style>').html(nt(n.toString())(i))}},Vc=/^(\S+)\s*(.*)$/,Ur=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.cid=Br("c"),t._ensureElement(),t.delegateEvents(),t}return xe(i,[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}},{key:"$",value:function(t){return this.$el.find(t)}},{key:"render",value:function(){return this}},{key:"destroy",value:function(){return this.$el.remove(),this.stopListening(),this.undelegateEvents(),this}},{key:"setElement",value:function(t,g){return this.$el&&this.undelegateEvents(),this.$el=ve.zepto.isZ(t)?t:ve(t),this.el=this.$el[0],g!==!1&&this.delegateEvents(),this}},{key:"delegateEvents",value:function(t){t||(t=this.events),this.undelegateEvents();for(var g in t){var b=t[g];if(b&&b.constructor!==Function&&(b=this[t[g]]),!!b){var P=g.match(Vc),m=P[1],N=P[2];m+=".delegateEvents"+this.cid,N===""?this.$el.on(m,b.bind(this)):this.$el.on(m,N,b.bind(this))}}return this}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"_ensureElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var t=ve.extend(!0,{},this.attributes);this.id&&(t.id=this.id),this.className&&(t.class=this.className);var g=ve(gr.create(this.tagName)).attr(t);this.setElement(g,!1)}}}]),i}(nr),ot=function(e){Me(i,e);var n=we(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=arguments.length>1?arguments[1]:void 0;return Se(this,i),r=n.call(this,t),r.core=g,r}return xe(i,[{key:"name",get:function(){return"error"}},{key:"createError",value:function(t){if(!this.core){Ae.warn(this.name,"Core is not set. Error: ",t);return}this.core.trigger(G.ERROR,t)}}],[{key:"Levels",get:function(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]),i}(nr),Ut={createError:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{useCodePrefix:!0},r=this.constructor&&this.constructor.type||"",t=this.name||r,g=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n,b="".concat(t,":").concat(n&&n.code||"unknown"),P={description:"",level:ot.Levels.FATAL,origin:t,scope:r,raw:{}},m=Object.assign({},P,n,{code:i.useCodePrefix?b:n.code});if(g&&m.level==ot.Levels.FATAL&&!m.UI){var N={title:g.t("default_error_title"),message:g.t("default_error_message")};m.UI=N}return this.playerError?this.playerError.createError(m):Ae.warn(t,"PlayerError is not defined. Error: ",m),m}},yt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t.render(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"getExternalInterface",value:function(){return{}}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"render",value:function(){return this}}]),i}(Ur);Object.assign(yt.prototype,Ut);yt.extend=function(e){return Er(yt,e)};yt.type="core";var Gc=`.container[data-container] {
  position: absolute;
  background-color: black;
  height: 100%;
  width: 100%;
  max-width: 100%; }
  .container[data-container] .chromeless {
    cursor: default; }

[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {
  cursor: pointer; }
`,Xs=function(e){Me(i,e);var n=we(i);function i(r,t,g){var b;return Se(this,i),b=n.call(this,r),b._i18n=t,b.currentTime=0,b.volume=100,b.playback=r.playback,b.playerError=g,b.settings=ve.extend(!0,{},b.playback.settings),b.isReady=!1,b.mediaControlDisabled=!1,b.plugins=[b.playback],b.dblTapHandler=new js(500),b.clickTimer=null,b.clickDelay=200,b.actionsMetadata={},b.bindEvents(),b}return xe(i,[{key:"name",get:function(){return"Container"}},{key:"attributes",get:function(){return{class:"container","data-container":""}}},{key:"events",get:function(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function(){return this.playback.ended}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"i18n",get:function(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function(){return this.playback.closedCaptionsTrackId},set:function(t){this.playback.closedCaptionsTrackId=t}},{key:"audioTracks",get:function(){return this.playback.audioTracks}},{key:"currentAudioTrack",get:function(){return this.playback.currentAudioTrack}},{key:"bindEvents",value:function(){this.listenTo(this.playback,G.PLAYBACK_PROGRESS,this.onProgress),this.listenTo(this.playback,G.PLAYBACK_TIMEUPDATE,this.timeUpdated),this.listenTo(this.playback,G.PLAYBACK_READY,this.ready),this.listenTo(this.playback,G.PLAYBACK_BUFFERING,this.onBuffering),this.listenTo(this.playback,G.PLAYBACK_BUFFERFULL,this.bufferfull),this.listenTo(this.playback,G.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.playback,G.PLAYBACK_LOADEDMETADATA,this.loadedMetadata),this.listenTo(this.playback,G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.playback,G.PLAYBACK_BITRATE,this.updateBitrate),this.listenTo(this.playback,G.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged),this.listenTo(this.playback,G.PLAYBACK_DVR,this.playbackDvrStateChanged),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl),this.listenTo(this.playback,G.PLAYBACK_SEEK,this.onSeek),this.listenTo(this.playback,G.PLAYBACK_SEEKED,this.onSeeked),this.listenTo(this.playback,G.PLAYBACK_ENDED,this.onEnded),this.listenTo(this.playback,G.PLAYBACK_PLAY,this.playing),this.listenTo(this.playback,G.PLAYBACK_PAUSE,this.paused),this.listenTo(this.playback,G.PLAYBACK_STOP,this.stopped),this.listenTo(this.playback,G.PLAYBACK_ERROR,this.error),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged),this.listenTo(this.playback,G.PLAYBACK_AUDIO_AVAILABLE,this.audioAvailable),this.listenTo(this.playback,G.PLAYBACK_AUDIO_CHANGED,this.audioChanged)}},{key:"subtitleAvailable",value:function(){this.trigger(G.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function(t){this.trigger(G.CONTAINER_SUBTITLE_CHANGED,t)}},{key:"audioAvailable",value:function(t){this.trigger(G.CONTAINER_AUDIO_AVAILABLE,t)}},{key:"audioChanged",value:function(t){this.trigger(G.CONTAINER_AUDIO_CHANGED,t)}},{key:"playbackStateChanged",value:function(t){this.trigger(G.CONTAINER_PLAYBACKSTATE,t)}},{key:"playbackDvrStateChanged",value:function(t){this.settings=this.playback.settings,this.dvrInUse=t,this.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,t)}},{key:"updateBitrate",value:function(t){this.trigger(G.CONTAINER_BITRATE,t)}},{key:"statsReport",value:function(t){this.trigger(G.CONTAINER_STATS_REPORT,t)}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function(){return!!this.dvrInUse}},{key:"destroy",value:function(){this.disableResizeObserver(),this.trigger(G.CONTAINER_DESTROYED,this,this.name),this.stopListening(),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove()}},{key:"setStyle",value:function(t){this.$el.css(t)}},{key:"animate",value:function(t,g){return this.$el.animate(t,g).promise()}},{key:"ready",value:function(){this.isReady=!0,this.trigger(G.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"error",value:function(t){this.isReady||this.ready(),this.trigger(G.CONTAINER_ERROR,t,this.name)}},{key:"loadedMetadata",value:function(t){this.trigger(G.CONTAINER_LOADEDMETADATA,t)}},{key:"timeUpdated",value:function(t){this.currentTime=t.current,this.trigger(G.CONTAINER_TIMEUPDATE,t,this.name)}},{key:"onProgress",value:function(){for(var t=arguments.length,g=new Array(t),b=0;b<t;b++)g[b]=arguments[b];this.trigger.apply(this,[G.CONTAINER_PROGRESS].concat(g,[this.name]))}},{key:"playing",value:function(){this.trigger(G.CONTAINER_PLAY,this.name,this.actionsMetadata.playEvent||{}),this.actionsMetadata.playEvent={}}},{key:"paused",value:function(){this.trigger(G.CONTAINER_PAUSE,this.name,this.actionsMetadata.pauseEvent||{}),this.actionsMetadata.pauseEvent={}}},{key:"stopped",value:function(){this.trigger(G.CONTAINER_STOP,this.actionsMetadata.stopEvent||{}),this.actionsMetadata.stopEvent={}}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.playEvent=t,this.playback.play(t)}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.stopEvent=t,this.playback.stop(t),this.currentTime=0}},{key:"switchAudioTrack",value:function(t){this.playback.switchAudioTrack(t)}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.pauseEvent=t,this.playback.pause(t)}},{key:"onEnded",value:function(){this.trigger(G.CONTAINER_ENDED,this,this.name),this.currentTime=0}},{key:"clicked",value:function(){var t=this;(!this.options.chromeless||this.options.allowUserInteraction)&&(this.clickTimer=setTimeout(function(){t.clickTimer&&t.trigger(G.CONTAINER_CLICK,t,t.name)},this.clickDelay))}},{key:"cancelClicked",value:function(){clearTimeout(this.clickTimer),this.clickTimer=null}},{key:"dblClicked",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&(this.cancelClicked(),this.trigger(G.CONTAINER_DBLCLICK,this,this.name))}},{key:"dblTap",value:function(t){var g=this;(!this.options.chromeless||this.options.allowUserInteraction)&&this.dblTapHandler.handle(t,function(){g.cancelClicked(),g.trigger(G.CONTAINER_DBLCLICK,g,g.name)})}},{key:"onContextMenu",value:function(t){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_CONTEXTMENU,t,this.name)}},{key:"seek",value:function(t){this.playback.seek(t)}},{key:"onSeek",value:function(t){this.trigger(G.CONTAINER_SEEK,t,this.name)}},{key:"onSeeked",value:function(){this.trigger(G.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function(t){var g=this.getDuration();if(t>=0&&t<=100){var b=g*(t/100);this.seek(b)}}},{key:"setVolume",value:function(t){this.volume=parseFloat(t),this.trigger(G.CONTAINER_VOLUME,this.volume,this.name),this.playback.volume(this.volume)}},{key:"fullscreen",value:function(){this.trigger(G.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(g){return g.name===t})[0]}},{key:"mouseEnter",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_DOWN)}},{key:"settingsUpdate",value:function(){this.settings=this.playback.settings,this.trigger(G.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function(t){this.trigger(G.CONTAINER_HIGHDEFINITIONUPDATE,t)}},{key:"isHighDefinitionInUse",value:function(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function(){this.mediaControlDisabled||(this.mediaControlDisabled=!0,this.trigger(G.CONTAINER_MEDIACONTROL_DISABLE))}},{key:"enableMediaControl",value:function(){this.mediaControlDisabled&&(this.mediaControlDisabled=!1,this.trigger(G.CONTAINER_MEDIACONTROL_ENABLE))}},{key:"updateStyle",value:function(){!this.options.chromeless||this.options.allowUserInteraction?this.$el.removeClass("chromeless"):this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver(),this.resizeObserverInterval=setInterval(function(){return t.checkResize()},500)}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function(){var t={width:this.el.clientWidth,height:this.el.clientHeight},g=this.currentSize||{},b=g.width,P=g.height,m=P!==t.height||b!==t.width;m&&(this.currentSize=t,this.trigger(G.CONTAINER_RESIZE,t))}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t),this.updateStyle(),this.playback.configure(this.options),this.trigger(G.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=ze.getStyleFor(Gc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.$el.append(this.playback.render().el),this.updateStyle(),this.checkResize(),this.enableResizeObserver(),this}}]),i}(Ur);Object.assign(Xs.prototype,Ut);var me=function(e){Me(i,e);var n=we(i);function i(r,t,g){var b;return Se(this,i),b=n.call(this,r),b.settings={},b._i18n=t,b.playerError=g,b._consented=!1,b}return xe(i,[{key:"isAudioOnly",get:function(){return!1}},{key:"isAdaptive",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"i18n",get:function(){return this._i18n}},{key:"buffering",get:function(){return!1}},{key:"consent",value:function(t){typeof t=="function"&&t()}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){}},{key:"seek",value:function(t){}},{key:"seekPercentage",value:function(t){}},{key:"getStartTimeOffset",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",get:function(){return!1}},{key:"hasClosedCaptionsTracks",get:function(){return this.closedCaptionsTracks.length>0}},{key:"closedCaptionsTracks",get:function(){return[]}},{key:"closedCaptionsTrackId",get:function(){return-1},set:function(t){}},{key:"audioTracks",get:function(){return[]}},{key:"currentAudioTrack",get:function(){return null}},{key:"switchAudioTrack",value:function(t){}},{key:"getPlaybackType",value:function(){return i.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"volume",value:function(t){}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t)}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(g,b){g&&t.play()})}},{key:"canAutoPlay",value:function(t){t(!0,null)}}]),i}(Ur);Object.assign(me.prototype,Ut);me.extend=function(e){return Er(me,e)};me.canPlay=function(e,n){return!1};me.VOD="vod";me.AOD="aod";me.LIVE="live";me.NO_OP="no_op";me.type="playback";var Hc=function(e){Me(i,e);var n=we(i);function i(r,t,g,b){var P;return Se(this,i),P=n.call(this,r),P._i18n=g,P.loader=t,P.playerError=b,P}return xe(i,[{key:"options",get:function(){return this._options},set:function(t){this._options=t}},{key:"createContainers",value:function(){var t=this;return ve.Deferred(function(g){g.resolve(t.options.sources.map(function(b){return t.createContainer(b)}))})}},{key:"findPlaybackPlugin",value:function(t,g){return this.loader.playbackPlugins.filter(function(b){return b.canPlay(t,g)})[0]}},{key:"createContainer",value:function(t){var g=null,b=this.options.mimeType;vr(t)==="object"?(g=t.source.toString(),t.mimeType&&(b=t.mimeType)):g=t.toString(),g.match(/^\/\//)&&(g=window.location.protocol+g);var P=$r($r({},this.options),{},{src:g,mimeType:b}),m=this.findPlaybackPlugin(g,b),N=m?new m(P,this._i18n,this.playerError):new me;P=$r($r({},P),{},{playback:N});var S=new Xs(P,this._i18n,this.playerError),F=ve.Deferred();return F.promise(S),this.addContainerPlugins(S),this.listenToOnce(S,G.CONTAINER_READY,function(){return F.resolve(S)}),S}},{key:"addContainerPlugins",value:function(t){this.loader.containerPlugins.forEach(function(g){t.addPlugin(new g(t))})}}]),i}(nr),jc=`[data-player] {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -o-user-select: none;
  user-select: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transform: translate3d(0, 0, 0);
  position: relative;
  margin: 0;
  padding: 0;
  border: 0;
  font-style: normal;
  font-weight: normal;
  text-align: center;
  overflow: hidden;
  font-size: 100%;
  font-family: "Roboto", "Open Sans", Arial, sans-serif;
  text-shadow: 0 0 0;
  box-sizing: border-box; }
  [data-player]:focus {
    outline: 0; }
  [data-player] * {
    box-sizing: inherit; }
  [data-player] > * {
    float: none;
    max-width: none; }
  [data-player] > div {
    display: block; }
  [data-player].fullscreen {
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0; }
  [data-player].nocursor {
    cursor: none; }

.clappr-style {
  display: none !important; }
`,Yc=`[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,
[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,
[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,
[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,
[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,
[data-player] b, [data-player] u, [data-player] i, [data-player] center,
[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,
[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,
[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,
[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,
[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,
[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,
[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {
  margin: 0;
  padding: 0;
  border: 0;
  font: inherit;
  font-size: 100%;
  vertical-align: baseline; }

[data-player] table {
  border-collapse: collapse;
  border-spacing: 0; }

[data-player] caption, [data-player] th, [data-player] td {
  text-align: left;
  font-weight: normal;
  vertical-align: middle; }

[data-player] q, [data-player] blockquote {
  quotes: none; }
  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {
    content: "";
    content: none; }

[data-player] a img {
  border: none; }
`,Qs=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.playerError=new ot(r,yn(t)),t.configureDomRecycler(),t.firstResize=!0,t.plugins=[],t.containers=[],t._boundFullscreenHandler=function(){return t.handleFullscreenChange()},ve(document).bind("fullscreenchange",t._boundFullscreenHandler),ve(document).bind("MSFullscreenChange",t._boundFullscreenHandler),ve(document).bind("mozfullscreenchange",t._boundFullscreenHandler),de.isMobile&&ve(window).bind("resize",function(g){t.handleWindowResize(g)}),t}return xe(i,[{key:"events",get:function(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function(){return!!this.ready}},{key:"i18n",get:function(){return this.getPlugin("strings")||{t:function(g){return g}}}},{key:"mediaControl",get:function(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl?this._dummyMediaControl:(this._dummyMediaControl=new yt(this),this._dummyMediaControl)}},{key:"activeContainer",get:function(){return this._activeContainer},set:function(t){this._activeContainer=t,this.trigger(G.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function(){return this.activeContainer&&this.activeContainer.playback}},{key:"activePlaybackEl",get:function(){if(this.activePlayback)return this.activePlayback.$el?this.activePlayback.$el.find("video")[0]:this.activePlayback.el}},{key:"configureDomRecycler",value:function(){var t=this.options&&this.options.playback&&this.options.playback.recycleVideo;gr.configure({recycleVideo:t})}},{key:"createContainers",value:function(t){this.defer=ve.Deferred(),this.defer.promise(this),this.containerFactory=new Hc(t,t.loader,this.i18n,this.playerError),this.prepareContainers()}},{key:"prepareContainers",value:function(){var t=this;this.containerFactory.createContainers().then(function(g){return t.setupContainers(g)}).then(function(g){return t.resolveOnContainersReady(g)})}},{key:"updateSize",value:function(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function(){de.isiOS||(this.$el.addClass("fullscreen"),this.$el.removeAttr("style"),this.previousSize={width:this.options.width,height:this.options.height},this.currentSize={width:ve(window).width(),height:ve(window).height()})}},{key:"setPlayerSize",value:function(){this.$el.removeClass("fullscreen"),this.currentSize=this.previousSize,this.previousSize={width:ve(window).width(),height:ve(window).height()},this.resize(this.currentSize)}},{key:"resize",value:function(t){!sn(t.height)&&!sn(t.width)?(this.el.style.height="".concat(t.height),this.el.style.width="".concat(t.width)):(this.el.style.height="".concat(t.height,"px"),this.el.style.width="".concat(t.width,"px")),this.previousSize={width:this.options.width,height:this.options.height},this.options.width=t.width,this.options.height=t.height,this.currentSize=t,this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver();var g=function(){t.triggerResize({width:t.el.clientWidth,height:t.el.clientHeight})};this.resizeObserverInterval=setInterval(g,500)}},{key:"triggerResize",value:function(t){var g=this.firstResize||this.oldHeight!==t.height||this.oldWidth!==t.width;g&&(this.oldHeight=t.height,this.oldWidth=t.width,this.computedSize=t,this.firstResize=!1,this.trigger(G.CORE_RESIZE,t))}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval),this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function(t){var g=this;ve.when.apply(ve,t).done(function(){g.defer.resolve(g),g.ready=!0,g.trigger(G.CORE_READY)})}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(g){return g.name===t})[0]}},{key:"load",value:function(t,g){this.options.mimeType=g,t=t&&t.constructor===Array?t:[t],this.options.sources=t,this.containers.forEach(function(b){return b.destroy()}),this.containerFactory.options=ve.extend(!0,this.options,{sources:t}),this.prepareContainers()}},{key:"destroy",value:function(){this.disableResizeObserver(),this.containers.forEach(function(t){return t.destroy()}),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove(),ve(document).unbind("fullscreenchange",this._boundFullscreenHandler),ve(document).unbind("MSFullscreenChange",this._boundFullscreenHandler),ve(document).unbind("mozfullscreenchange",this._boundFullscreenHandler),this.stopListening()}},{key:"handleFullscreenChange",value:function(){this.trigger(G.CORE_FULLSCREEN,this.isFullscreen()),this.updateSize()}},{key:"handleWindowResize",value:function(t){var g=window.innerWidth>window.innerHeight?"landscape":"portrait";this._screenOrientation!==g&&(this._screenOrientation=g,this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight}),this.trigger(G.CORE_SCREEN_ORIENTATION_CHANGED,{event:t,orientation:this._screenOrientation}))}},{key:"removeContainer",value:function(t){this.stopListening(t),this.containers=this.containers.filter(function(g){return g!==t})}},{key:"setupContainer",value:function(t){this.listenTo(t,G.CONTAINER_DESTROYED,this.removeContainer),this.containers.push(t)}},{key:"setupContainers",value:function(t){return t.forEach(this.setupContainer.bind(this)),this.trigger(G.CORE_CONTAINERS_CREATED),this.renderContainers(),this.activeContainer=t[0],this.render(),this.appendToParent(),this.containers}},{key:"renderContainers",value:function(){var t=this;this.containers.forEach(function(g){return t.el.appendChild(g.render().el)})}},{key:"createContainer",value:function(t,g){var b=this.containerFactory.createContainer(t,g);return this.setupContainer(b),this.el.appendChild(b.render().el),b}},{key:"getCurrentContainer",value:function(){return this.activeContainer}},{key:"getCurrentPlayback",value:function(){return this.activePlayback}},{key:"getPlaybackType",value:function(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function(){var t=Tr.fullscreenElement();return t&&t===this.el||t&&t===this.activePlaybackEl||this.activePlaybackEl&&this.activePlaybackEl.webkitDisplayingFullscreen||!1}},{key:"toggleFullscreen",value:function(){var t=this;if(this.isFullscreen()){var g=de.isiOS?this.activePlaybackEl:document;Tr.cancelFullscreen(g),!de.isiOS&&this.$el.removeClass("fullscreen nocursor")}else{var b=de.isiOS?this.activePlaybackEl:this.el;if(!b)return;de.isSafari||de.isiOS?Tr.requestFullscreen(b):Tr.requestFullscreen(b).then(function(P){return P},function(P){return setTimeout(function(){if(!t.isFullscreen())throw new ReferenceError(P)},600)}),!de.isiOS&&this.$el.addClass("fullscreen")}}},{key:"onMouseMove",value:function(t){this.trigger(G.CORE_MOUSE_MOVE,t)}},{key:"onMouseLeave",value:function(t){this.trigger(G.CORE_MOUSE_LEAVE,t)}},{key:"configure",value:function(t){var g=this;this._options=ve.extend(!0,this._options,t),this.configureDomRecycler();var b=t.source||t.sources;b&&this.load(b,t.mimeType||this.options.mimeType),this.trigger(G.CORE_OPTIONS_CHANGE,t),this.containers.forEach(function(P){return P.configure(g.options)})}},{key:"appendToParent",value:function(){var t=ze.getStyleFor(jc.toString(),{baseUrl:this.options.baseUrl}),g=ze.getStyleFor(Yc.toString(),{baseUrl:this.options.baseUrl});this.$el.append(t[0]),this.options.includeResetStyle&&this.$el.append(g[0]);var b=this.$el.parent()&&this.$el.parent().length;!b&&this.$el.appendTo(this.options.parentElement)}},{key:"render",value:function(){this.options.width=this.options.width||this.$el.width(),this.options.height=this.options.height||this.$el.height();var t={width:this.options.width,height:this.options.height};return this.previousSize=this.currentSize=this.computedSize=t,this.updateSize(),this.enableResizeObserver(),this}}]),i}(Ur);Object.assign(Qs.prototype,Ut);var $c=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.player=r,t}return xe(i,[{key:"loader",get:function(){return this.player.loader}},{key:"create",value:function(){return this.options.loader=this.loader,this.core=new Qs(this.options),this.addCorePlugins(),this.core.createContainers(this.options),this.core}},{key:"addCorePlugins",value:function(){var t=this;return this.loader.corePlugins.forEach(function(g){var b=new g(t.core);t.core.addPlugin(b),t.setupExternalInterface(b)}),this.core}},{key:"setupExternalInterface",value:function(t){var g=t.getExternalInterface();for(var b in g)this.player[b]=g[b].bind(t)}}]),i}(nr),zc=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,Xr=function(){function e(n,i,r){Se(this,e),this.major=parseInt(n||0,10),this.minor=parseInt(i||0,10),this.patch=parseInt(r||0,10)}return xe(e,[{key:"compare",value:function(i){var r=this.major-i.major;return r=r||this.minor-i.minor,r=r||this.patch-i.patch,r}},{key:"inc",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"patch";return typeof this[i]<"u"&&(this[i]+=1),this}},{key:"satisfies",value:function(i,r){return this.compare(i)>=0&&(!r||this.compare(r)<0)}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}],[{key:"parse",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=i.match(zc)||[],t=Jn(r,4),g=t[1],b=t[2],P=t[3];return typeof g>"u"?null:new e(g,b,P)}}]),e}(),Ta=function(n,i){return!n||!i?{}:Object.entries(n).filter(function(r){var t=Jn(r,2),g=t[1];return g.type===i}).reduce(function(r,t){var g=Jn(t,2),b=g[0],P=g[1];return r[b]=P,r},{})},ir=function(){var e={plugins:{},playbacks:[]},n="0.4.27";return function(){function i(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Se(this,i),this.playerId=t,this.playbackPlugins=cr(e.playbacks);var g=i.registeredPlugins,b=g.core,P=g.container;this.containerPlugins=Object.values(P),this.corePlugins=Object.values(b),Array.isArray(r)||this.validateExternalPluginsType(r),this.addExternalPlugins(r)}return xe(i,[{key:"groupPluginsByType",value:function(t){return Array.isArray(t)&&(t=t.reduce(function(g,b){return g[b.type]||(g[b.type]=[]),g[b.type].push(b),g},{})),t}},{key:"removeDups",value:function(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=function(F,M){return F[M.prototype.name]&&g||(F[M.prototype.name]&&delete F[M.prototype.name],F[M.prototype.name]=M),F},P=t.reduceRight(b,Object.create(null)),m=[];for(var N in P)m.unshift(P[N]);return m}},{key:"addExternalPlugins",value:function(t){var g=typeof t.loadExternalPluginsFirst=="boolean"?t.loadExternalPluginsFirst:!0,b=typeof t.loadExternalPlaybacksFirst=="boolean"?t.loadExternalPlaybacksFirst:!0;if(t=this.groupPluginsByType(t),t.playback){var P=t.playback.filter(function(S){return i.checkVersionSupport(S),!0});this.playbackPlugins=b?this.removeDups(P.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(P),!0)}if(t.container){var m=t.container.filter(function(S){return i.checkVersionSupport(S),!0});this.containerPlugins=g?this.removeDups(m.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(m),!0)}if(t.core){var N=t.core.filter(function(S){return i.checkVersionSupport(S),!0});this.corePlugins=g?this.removeDups(N.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(N),!0)}}},{key:"validateExternalPluginsType",value:function(t){var g=["playback","container","core"];g.forEach(function(b){(t[b]||[]).forEach(function(P){var m="external "+P.type+" plugin on "+b+" array";if(P.type!==b)throw new ReferenceError(m)})})}}],[{key:"registeredPlaybacks",get:function(){return cr(e.playbacks)}},{key:"registeredPlugins",get:function(){var t=e.plugins,g=Ta(t,"core"),b=Ta(t,"container");return{core:g,container:b}}},{key:"checkVersionSupport",value:function(t){var g=t.prototype,b=g.supportedVersion,P=g.name;if(!b||!b.min)return Ae.warn("Loader","missing version information for ".concat(P)),!1;var m=b.max?Xr.parse(b.max):Xr.parse(b.min).inc("minor"),N=Xr.parse(b.min);return Xr.parse(n).satisfies(N,m)?!0:(Ae.warn("Loader","unsupported plugin ".concat(P,": Clappr version ").concat(n," does not match required range [").concat(N,",").concat(m,")")),!1)}},{key:"registerPlugin",value:function(t){if(!t||!t.prototype.name)return Ae.warn("Loader","missing information to register plugin: ".concat(t)),!1;i.checkVersionSupport(t);var g=e.plugins;if(!g)return!1;var b=g[t.prototype.name];return b&&Ae.warn("Loader","overriding plugin entry: ".concat(t.prototype.name," - ").concat(b)),g[t.prototype.name]=t,!0}},{key:"registerPlayback",value:function(t){if(!t||!t.prototype.name)return!1;i.checkVersionSupport(t);var g=e.playbacks,b=g.findIndex(function(m){return m.prototype.name===t.prototype.name});if(b>=0){var P=g[b];g.splice(b,1),Ae.warn("Loader","overriding playback entry: ".concat(P.name," - ").concat(P))}return e.playbacks=[t].concat(cr(g)),!0}},{key:"unregisterPlugin",value:function(t){if(!t)return!1;var g=e.plugins,b=g[t];return b?(delete g[t],!0):!1}},{key:"unregisterPlayback",value:function(t){if(!t)return!1;var g=e.playbacks,b=g.findIndex(function(P){return P.prototype.name===t});return b<0?!1:(g.splice(b,1),e.playbacks=g,!0)}},{key:"clearPlugins",value:function(){e.plugins={}}},{key:"clearPlaybacks",value:function(){e.playbacks=[]}}]),i}()}(),Xc=Vs().replace(/\/[^/]+$/,""),Zs=function(e){Me(i,e);var n=we(i);function i(r){var t;Se(this,i),t=n.call(this,r);var g={recycleVideo:!0},b={playerId:Br(""),persistConfig:!0,width:640,height:360,baseUrl:Xc,allowUserInteraction:de.isMobile,includeResetStyle:!0,playback:g};t._options=ve.extend(!0,b,r),t.options.sources=t._normalizeSources(r),t.options.chromeless||(t.options.allowUserInteraction=!0),t.options.allowUserInteraction||(t.options.disableKeyboardShortcuts=!0),t._registerOptionEventListeners(t.options.events),t._coreFactory=new $c(yn(t));var P=t._getParentElement(t.options);return P&&t.attachTo(P),t}return xe(i,[{key:"loader",get:function(){return this._loader||(this._loader=new ir(this.options.plugins||{},this.options.playerId)),this._loader},set:function(t){this._loader=t}},{key:"ended",get:function(){return this.core.activeContainer.ended}},{key:"buffering",get:function(){return this.core.activeContainer.buffering}},{key:"isReady",get:function(){return!!this._ready}},{key:"eventsMapping",get:function(){return{onReady:G.PLAYER_READY,onResize:G.PLAYER_RESIZE,onPlay:G.PLAYER_PLAY,onPause:G.PLAYER_PAUSE,onStop:G.PLAYER_STOP,onEnded:G.PLAYER_ENDED,onSeek:G.PLAYER_SEEK,onError:G.PLAYER_ERROR,onTimeUpdate:G.PLAYER_TIMEUPDATE,onVolumeUpdate:G.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:G.PLAYER_SUBTITLE_AVAILABLE}}},{key:"_getParentElement",value:function(t){var g=t.parentId,b=t.parent;return g?document.querySelector(g):b}},{key:"attachTo",value:function(t){return this.options.parentElement=t,this.core=this._coreFactory.create(),this._addEventListeners(),this}},{key:"_addEventListeners",value:function(){return this.core.isReady?this._onReady():this.listenToOnce(this.core,G.CORE_READY,this._onReady),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged),this.listenTo(this.core,G.CORE_FULLSCREEN,this._onFullscreenChange),this.listenTo(this.core,G.CORE_RESIZE,this._onResize),this}},{key:"_addContainerEventListeners",value:function(){var t=this.core.activeContainer;return t&&(this.listenTo(t,G.CONTAINER_PLAY,this._onPlay),this.listenTo(t,G.CONTAINER_PAUSE,this._onPause),this.listenTo(t,G.CONTAINER_STOP,this._onStop),this.listenTo(t,G.CONTAINER_ENDED,this._onEnded),this.listenTo(t,G.CONTAINER_SEEK,this._onSeek),this.listenTo(t,G.CONTAINER_ERROR,this._onError),this.listenTo(t,G.CONTAINER_TIMEUPDATE,this._onTimeUpdate),this.listenTo(t,G.CONTAINER_VOLUME,this._onVolumeUpdate),this.listenTo(t,G.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)),this}},{key:"_registerOptionEventListeners",value:function(){var t=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=Object.keys(g).length>0;return P&&Object.keys(b).forEach(function(m){var N=t.eventsMapping[m];N&&t.off(N,b[m])}),Object.keys(g).forEach(function(m){var N=t.eventsMapping[m];if(N){var S=g[m];S=typeof S=="function"&&S,S&&t.on(N,S)}}),this}},{key:"_containerChanged",value:function(){this.stopListening(),this._addEventListeners()}},{key:"_onReady",value:function(){this._ready=!0,this._addContainerEventListeners(),this.trigger(G.PLAYER_READY)}},{key:"_onFullscreenChange",value:function(t){this.trigger(G.PLAYER_FULLSCREEN,t)}},{key:"_onVolumeUpdate",value:function(t){this.trigger(G.PLAYER_VOLUMEUPDATE,t)}},{key:"_onSubtitleAvailable",value:function(){this.trigger(G.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function(t){this.trigger(G.PLAYER_RESIZE,t)}},{key:"_onPlay",value:function(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PLAY,g)}},{key:"_onPause",value:function(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PAUSE,g)}},{key:"_onStop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.trigger(G.PLAYER_STOP,this.getCurrentTime(),t)}},{key:"_onEnded",value:function(){this.trigger(G.PLAYER_ENDED)}},{key:"_onSeek",value:function(t){this.trigger(G.PLAYER_SEEK,t)}},{key:"_onTimeUpdate",value:function(t){this.trigger(G.PLAYER_TIMEUPDATE,t)}},{key:"_onError",value:function(t){this.trigger(G.PLAYER_ERROR,t)}},{key:"_normalizeSources",value:function(t){var g=t.sources||(t.source!==void 0?[t.source]:[]);return g.length===0?[{source:"",mimeType:""}]:g}},{key:"resize",value:function(t){return this.core.resize(t),this}},{key:"load",value:function(t,g,b){return b!==void 0&&this.configure({autoPlay:!!b}),this.core.load(t,g),this}},{key:"destroy",value:function(){return this.stopListening(),this.core.destroy(),this}},{key:"consent",value:function(t){this.core.getCurrentPlayback().consent(t)}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.play(t),this}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.pause(t),this}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.stop(t),this}},{key:"seek",value:function(t){return this.core.activeContainer.seek(t),this}},{key:"seekPercentage",value:function(t){return this.core.activeContainer.seekPercentage(t),this}},{key:"mute",value:function(){return this.core.activePlayback.mute(),this}},{key:"unmute",value:function(){return this.core.activePlayback.unmute(),this}},{key:"isPlaying",value:function(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._registerOptionEventListeners(t.events,this.options.events),this.core.configure(t),this}},{key:"getPlugin",value:function(t){var g=this.core.plugins.concat(this.core.activeContainer.plugins);return g.filter(function(b){return b.name===t})[0]}},{key:"getCurrentTime",value:function(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function(){return this.core.activeContainer.getDuration()}}]),i}(nr);Object.assign(Zs.prototype,Ut);var tr=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"bindEvents",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),i}(nr);Object.assign(tr.prototype,Ut);tr.extend=function(e){return Er(tr,e)};tr.type="container";var Rt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"getExternalInterface",value:function(){return{}}},{key:"destroy",value:function(){this.stopListening()}}]),i}(nr);Object.assign(Rt.prototype,Ut);Rt.extend=function(e){return Er(Rt,e)};Rt.type="core";var rr=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"bindEvents",value:function(){}}]),i}(Ur);Object.assign(rr.prototype,Ut);rr.extend=function(e){return Er(rr,e)};rr.type="container";var Qc=`<% for (var i = 0; i < tracks.length; i++) { %>
  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">
<% }; %>
`,Zc=`[data-html5-video] {
  position: absolute;
  height: 100%;
  width: 100%;
  display: block; }
`,pr={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};pr.ogv=pr.ogg;pr["3gp"]=pr["3gpp"];var Nr={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},Jc=Object.keys(Nr).reduce(function(e,n){return[].concat(cr(e),cr(Nr[n]))},[]),ba={code:"unknown",message:"unknown"},pt=function(e){Me(i,e);var n=we(i);function i(){var r;Se(this,i);for(var t=arguments.length,g=new Array(t),b=0;b<t;b++)g[b]=arguments[b];r=n.call.apply(n,[this].concat(g)),r._destroyed=!1,r._loadStarted=!1,r._isBuffering=!1,r._playheadMoving=!1,r._playheadMovingTimer=null,r._stopped=!1,r._ccTrackId=-1,r._setupSrc(r.options.src),r.options.playback||(r.options.playback=r.options||{}),r.options.playback.disableContextMenu=r.options.playback.disableContextMenu||r.options.disableVideoTagContextMenu,r._minDvrSize=r.isValidMinimumDVRSizeConfig?r.minimumDVRSizeConfig:60;var P=r.options.playback,m=P.preload||(de.isSafari?"auto":r.options.preload),N;return r.options.poster&&(typeof r.options.poster=="string"?N=r.options.poster:typeof r.options.poster.url=="string"&&(N=r.options.poster.url)),ve.extend(!0,r.el,{muted:r.options.mute,defaultMuted:r.options.mute,loop:r.options.loop,poster:N,preload:m||"metadata",crossOrigin:P.crossOrigin,"x-webkit-playsinline":P.playInline}),(P.controls||r.options.useVideoTagDefaultControls)&&r.$el.attr("controls",""),P.playInline&&r.$el.attr({playsinline:"playsinline"}),P.crossOrigin&&r.$el.attr({crossorigin:P.crossOrigin}),r.settings={default:["seekbar"]},r.settings.left=["playpause","position","duration"],r.settings.right=["fullscreen","volume","hd-indicator"],P.externalTracks&&r._setupExternalTracks(P.externalTracks),r.options.autoPlay&&r.attemptAutoPlay(),r}return xe(i,[{key:"name",get:function(){return"html5_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function(){var t=this.options.src,g=i._mimeTypesForUrl(t,Nr,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||Jc.indexOf(g[0])>=0}},{key:"attributes",get:function(){return{"data-html5-video":""}}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}},{key:"isLive",get:function(){return this.getPlaybackType()===me.LIVE}},{key:"dvrEnabled",get:function(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function(){return typeof this.minimumDVRSizeConfig<"u"&&typeof this.minimumDVRSizeConfig=="number"}},{key:"configure",value:function(t){Qt(Tt(i.prototype),"configure",this).call(this,t),this.el.loop=!!t.loop}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(g,b){b&&Ae.warn(t.name,"autoplay error.",{result:g,error:b}),g&&setTimeout(function(){return!t._destroyed&&t.play()},0)})}},{key:"canAutoPlay",value:function(t){if(this.options.disableCanAutoPlay){t(!0,null);return}var g={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||!1,muted:this.options.mute||!1};de.isMobile&&gr.options.recycleVideo&&(g.element=this.el),Hs(t,g)}},{key:"_setupExternalTracks",value:function(t){this._externalTracks=t.map(function(g){return{kind:g.kind||"subtitles",label:g.label,lang:g.lang,src:g.src}})}},{key:"_setupSrc",value:function(t){this.el.src!==t&&(this._ccIsSetup=!1,this.el.src=t,this._src=this.el.src)}},{key:"_onLoadedMetadata",value:function(t){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_LOADEDMETADATA,{duration:t.target.duration,data:t}),this._updateSettings();var g=typeof this._options.autoSeekFromUrl>"u"||this._options.autoSeekFromUrl;this.getPlaybackType()!==me.LIVE&&g&&this._checkInitialSeek()}},{key:"_onDurationChange",value:function(){this._updateSettings(),this._onTimeUpdate(),this._onProgress()}},{key:"_updateSettings",value:function(){this.getPlaybackType()===me.VOD||this.getPlaybackType()===me.AOD?this.settings.left=["playpause","position","duration"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function(){var t=this.tagName==="audio"?me.AOD:me.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?me.LIVE:t}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"consent",value:function(t){var g=this;if(this.isPlaying()||this.el._consented)Qt(Tt(i.prototype),"consent",this).call(this,t);else{var b=function P(){g.el.removeEventListener("loadedmetadata",P,!1),g.el.removeEventListener("error",P,!1),g.el._consented=!0,Qt(Tt(i.prototype),"consent",g).call(g,t)};this.el.addEventListener("loadedmetadata",b,!1),this.el.addEventListener("error",b,!1),this.el.load()}}},{key:"play",value:function(){this.trigger(G.PLAYBACK_PLAY_INTENT),this._stopped=!1,this._setupSrc(this._src),this._handleBufferingEvents();var t=this.el.play();t&&t.catch&&t.catch(function(){})}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this.el.removeAttribute("src"),this.el.load(),this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_STOP)}},{key:"volume",value:function(t){t===0?(this.$el.attr({muted:"true"}),this.el.muted=!0):(this.$el.attr({muted:null}),this.el.muted=!1,this.el.volume=t/100)}},{key:"mute",value:function(){this.el.muted=!0}},{key:"unmute",value:function(){this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted===!0||this.el.volume===0}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startPlayheadMovingChecks",value:function(){this._playheadMovingTimer===null&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){this._playheadMovingTimer!==null&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var t=this._playheadMovingTimeOnCheck,g=this.el.currentTime;this._playheadMoving=t!==g,this._playheadMovingTimeOnCheck=g,this._handleBufferingEvents()}},{key:"_onWaiting",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function(){this._checkForClosedCaptions(),this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PLAY)}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function(){this.trigger(G.PLAYBACK_SEEK,this.getCurrentTime()),this._handleBufferingEvents()}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingEvents",value:function(){var t=!this.el.ended&&!this.el.paused,g=this._loadStarted&&!this.el.ended&&!this._stopped&&(t&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!==g&&(this._isBuffering=g,g?this.trigger(G.PLAYBACK_BUFFERING,this.name):this.trigger(G.PLAYBACK_BUFFERFULL,this.name))}},{key:"_onError",value:function(){var t=this.el.error||ba,g=t.code,b=t.message,P=g===ba.code,m=this.createError({code:g,description:b,raw:this.el.error,level:P?ot.Levels.WARN:ot.Levels.FATAL});P?Ae.warn(this.name,"HTML5 unknown error: ",m):this.trigger(G.PLAYBACK_ERROR,m)}},{key:"destroy",value:function(){this._destroyed=!0,this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange),Qt(Tt(i.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this.el.load(),this._src=null,gr.garbage(this.el)}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function(t){t<0&&(Ae.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this.el.seekable.start(0),this.el.currentTime=t}},{key:"seekPercentage",value:function(t){var g=this.el.duration*(t/100);this.seek(g)}},{key:"_checkInitialSeek",value:function(){var t=Ws();t!==0&&this.seek(t)}},{key:"getCurrentTime",value:function(){return this.el.currentTime}},{key:"getDuration",value:function(){if(this.isLive){if(this.el.seekable.length>0)return this.el.seekable.end(0)-this.el.seekable.start(0);this._scheduleUpdateSettingsCheck()}return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function(){var t=this;this._updateSettingsCheckInFlight||(this._updateSettingsCheckInFlight=setTimeout(function(){t._updateSettings(),t._updateSettingsCheckInFlight=null},1e3))}},{key:"_onTimeUpdate",value:function(){var t=this.isLive?this.getDuration():this.el.duration;this.trigger(G.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:t},this.name)}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],g=0,b=0;b<this.el.buffered.length;b++)t=[].concat(cr(t),[{start:this.el.buffered.start(b),end:this.el.buffered.end(b)}]),this.el.currentTime>=t[b].start&&this.el.currentTime<=t[b].end&&(g=b);var P={start:t[g].start,current:t[g].end,total:this.el.duration};this.trigger(G.PLAYBACK_PROGRESS,P,t)}}},{key:"_typeFor",value:function(t){var g=i._mimeTypesForUrl(t,pr,this.options.mimeType);g.length===0&&(g=i._mimeTypesForUrl(t,Nr,this.options.mimeType));var b=g[0]||"";return b.split(";")[0]}},{key:"_ready",value:function(){this._isReadyState||(this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_checkForClosedCaptions",value:function(){if(this.isHTML5Video&&!this._ccIsSetup){if(this.hasClosedCaptionsTracks){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this.handleTextTrackChange=this._handleTextTrackChange.bind(this),this.el.textTracks.addEventListener("change",this.handleTextTrackChange)}this._ccIsSetup=!0}}},{key:"_handleTextTrackChange",value:function(){var t=this.closedCaptionsTracks,g=t.find(function(b){return b.track.mode==="showing"})||{id:-1};this._ccTrackId!==g.id&&(this._ccTrackId=g.id,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:g.id}))}},{key:"isHTML5Video",get:function(){return this.name===i.prototype.name}},{key:"closedCaptionsTracks",get:function(){var t=0,g=function(){return t++},b=this.el.textTracks?Array.from(this.el.textTracks):[];return b.filter(function(P){return P.kind==="subtitles"||P.kind==="captions"}).map(function(P){return{id:g(),name:P.label,track:P}})}},{key:"closedCaptionsTrackId",get:function(){return this._ccTrackId},set:function(t){if(sn(t)){var g=this.closedCaptionsTracks,b;t!==-1&&(b=g.find(function(P){return P.id===t}),!b||b.track.mode==="showing")||(g.filter(function(P){return P.track.mode!=="hidden"}).forEach(function(P){return P.track.mode="hidden"}),b&&(b.track.mode="showing"),this._ccTrackId=t,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:t}))}}},{key:"template",get:function(){return nt(Qc)}},{key:"render",value:function(){this.options.playback.disableContextMenu&&this.$el.on("contextmenu",function(){return!1}),this._externalTracks&&this._externalTracks.length>0&&this.$el.html(this.template({tracks:this._externalTracks})),this._ready();var t=ze.getStyleFor(Zc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this}}]),i}(me);pt._mimeTypesForUrl=function(e,n,i){var r=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],t=i||r&&n[r.toLowerCase()]||[];return t.constructor===Array?t:[t]};pt._canPlay=function(e,n,i,r){var t=pt._mimeTypesForUrl(i,n,r),g=document.createElement(e);return!!t.filter(function(b){return!!g.canPlayType(b).replace(/no/,"")})[0]};pt.canPlay=function(e,n){return pt._canPlay("audio",Nr,e,n)||pt._canPlay("video",pr,e,n)};var Js=function(e){Me(i,e);var n=we(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"html5_audio"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return"audio"}},{key:"isAudioOnly",get:function(){return!0}},{key:"updateSettings",value:function(){this.settings.left=["playpause","position","duration"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function(){return me.AOD}}]),i}(pt);Js.canPlay=function(e,n){var i={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]};return pt._canPlay("audio",i,e,n)};var qc=`[data-html-img] {
  max-width: 100%;
  max-height: 100%; }
`,qs=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.el.src=r.src,t}return xe(i,[{key:"name",get:function(){return"html_img"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"tagName",get:function(){return"img"}},{key:"attributes",get:function(){return{"data-html-img":""}}},{key:"events",get:function(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}},{key:"getPlaybackType",value:function(){return me.NO_OP}},{key:"render",value:function(){var t=ze.getStyleFor(qc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.trigger(G.PLAYBACK_READY,this.name),this}},{key:"_onLoad",value:function(){this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function(t){var g=t.type==="error"?"load error":"loading aborted";this.trigger(G.PLAYBACK_ERROR,{message:g},this.name)}}]),i}(me);qs.canPlay=function(e){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(e)};var ef=`<canvas data-no-op-canvas></canvas>
<p data-no-op-msg><%=message%></p><p>
</p>`,tf=`[data-no-op] {
  position: absolute;
  height: 100%;
  width: 100%;
  text-align: center; }

[data-no-op] p[data-no-op-msg] {
  position: absolute;
  text-align: center;
  font-size: 25px;
  left: 0;
  right: 0;
  color: white;
  padding: 10px;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%);
  max-height: 100%;
  overflow: auto; }

[data-no-op] canvas[data-no-op-canvas] {
  background-color: #777;
  height: 100%;
  width: 100%; }
`,eo=function(e){Me(i,e);var n=we(i);function i(){var r;Se(this,i);for(var t=arguments.length,g=new Array(t),b=0;b<t;b++)g[b]=arguments[b];return r=n.call.apply(n,[this].concat(g)),r._noiseFrameNum=-1,r}return xe(i,[{key:"name",get:function(){return"no_op"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(ef)}},{key:"attributes",get:function(){return{"data-no-op":""}}},{key:"render",value:function(){var t=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported"),g=ze.getStyleFor(tf.toString(),{baseUrl:this.options.baseUrl});this.$el.append(g[0]),this.$el.html(this.template({message:t})),this.trigger(G.PLAYBACK_READY,this.name);var b=!!(this.options.poster&&this.options.poster.showForNoOp);return(this.options.autoPlay||!b)&&this._animate(),this}},{key:"_noise",value:function(){if(this._noiseFrameNum=(this._noiseFrameNum+1)%5,!this._noiseFrameNum){var t=this.context.createImageData(this.context.canvas.width,this.context.canvas.height),g;try{g=new Uint32Array(t.data.buffer)}catch{g=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4);for(var b=t.data,P=0;P<b.length;P++)g[P]=b[P]}for(var m=g.length,N=Math.random()*6+4,S=0,F=0,M=0;M<m;){if(S<0){S=N*Math.random();var K=Math.pow(Math.random(),.4);F=255*K<<24}S-=1,g[M++]=F}this.context.putImageData(t,0,0)}}},{key:"_loop",value:function(){var t=this;this._stop||(this._noise(),this._animationHandle=Bs(function(){return t._loop()}))}},{key:"destroy",value:function(){this._animationHandle&&(Us(this._animationHandle),this._stop=!0)}},{key:"_animate",value:function(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0],this.context=this.canvas.getContext("2d"),this._loop()}}]),i}(me);eo.canPlay=function(e){return!0};var rf=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t._initializeMessages(),t}return xe(i,[{key:"name",get:function(){return"strings"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"t",value:function(t){var g=this._language(),b=this._messages.en,P=g&&this._messages[g]||b;return P[t]||b[t]||t}},{key:"_language",value:function(){return this.core.options.language||Gs()}},{key:"_initializeMessages",value:function(){var t={en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zurck zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser untersttzt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador no supporta a reproduo deste video. Por favor, tente usar um navegador diferente.",default_error_title:"No foi possvel reproduzir o vdeo.",default_error_message:"Ocorreu um problema ao tentar carregar o vdeo."},es_am:{live:"vivo",back_to_live:"volver en vivo",disabled:"No disponible",playback_not_supported:"Su navegador no soporta la reproduccin de este video. Por favor, utilice un navegador diferente.",default_error_title:"No se puede reproducir el video.",default_error_message:"Se ha producido un error al cargar el video."},es:{live:"en directo",back_to_live:"volver al directo",disabled:"No disponible",playback_not_supported:"Este navegador no es compatible para reproducir este vdeo. Utilice un navegador diferente.",default_error_title:"No se puede reproducir el vdeo.",default_error_message:"Se ha producido un problema al cargar el vdeo."},ru:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"      . ,   ."},bg:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"       . ,    .",default_error_title:"     .",default_error_message:"     ."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"Dsactiv",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vido. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vido.",default_error_message:"Un problme est survenu lors du chargement de la vido."},tr:{live:"canl",back_to_live:"canl yayna dn",disabled:"Engelli",playback_not_supported:"Taraycnz bu videoyu oynatma desteine sahip deil. Ltfen farkl bir tarayc ile deneyin."},et:{live:"Otselekanne",back_to_live:"Tagasi otselekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"",back_to_live:"  ",disabled:"",playback_not_supported:"       .    .",default_error_title:"   .",default_error_message:"    ."},zh:{live:"",back_to_live:"",disabled:"",playback_not_supported:"",default_error_title:"",default_error_message:""}};this._messages=ve.extend(!0,t,this.core.options.strings||{}),this._messages["de-DE"]=this._messages.de,this._messages["pt-BR"]=this._messages.pt,this._messages["en-US"]=this._messages.en,this._messages["bg-BG"]=this._messages.bg,this._messages["es-419"]=this._messages.es_am,this._messages["es-ES"]=this._messages.es,this._messages["fr-FR"]=this._messages.fr,this._messages["tr-TR"]=this._messages.tr,this._messages["et-EE"]=this._messages.et,this._messages["ar-IQ"]=this._messages.ar,this._messages["zh-CN"]=this._messages.zh}}]),i}(Rt),nf=function(e){Me(i,e);var n=we(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"sources"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function(){var t=this.core.containers.filter(function(g){return g.playback.name!=="no_op"})[0]||this.core.containers[0];t&&this.core.containers.forEach(function(g){g!==t&&g.destroy()})}}]),i}(Rt);ir.registerPlugin(rf);ir.registerPlugin(nf);ir.registerPlayback(eo);ir.registerPlayback(qs);ir.registerPlayback(Js);ir.registerPlayback(pt);function Ze(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Sa(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uf(r.key),r)}}function Je(e,n,i){return n&&Sa(e.prototype,n),i&&Sa(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function qe(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ri(e,n)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},kt(e)}function ri(e,n){return ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ri(e,n)}function af(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sf(e)}function et(e){var n=af();return function(){var r=kt(e),t;if(n){var g=kt(this).constructor;t=Reflect.construct(r,arguments,g)}else t=r.apply(this,arguments);return to(this,t)}}function of(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=kt(e),e!==null););return e}function fr(){return typeof Reflect<"u"&&Reflect.get?fr=Reflect.get.bind():fr=function(n,i,r){var t=of(n,i);if(t){var g=Object.getOwnPropertyDescriptor(t,i);return g.get?g.get.call(arguments.length<3?n:r):g.value}},fr.apply(this,arguments)}function lf(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function uf(e){var n=lf(e,"string");return typeof n=="symbol"?n:String(n)}var cf=function(e){qe(i,e);var n=et(i);function i(r){return Ze(this,i),n.call(this,r)}return Je(i,[{key:"name",get:function(){return"click_to_pause"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"config",get:function(){return this.container.options.clickToPauseConfig||{}}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_CLICK,this.click),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate)}},{key:"click",value:function(){var t=this.config.onClickPayload;(this.container.getPlaybackType()!==me.LIVE||this.container.isDvrEnabled())&&(this.container.isPlaying()?this.container.pause(t):this.container.play(t))}},{key:"settingsUpdate",value:function(){var t=this.container.getPlaybackType()!==me.LIVE||this.container.isDvrEnabled();if(t!==this.pointerEnabled){var g=t?"addClass":"removeClass";this.container.$el[g]("pointer-enabled"),this.pointerEnabled=t}}}]),i}(tr),ff=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve">
<path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1
	c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9
	C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"/>
</svg>`,df=`<button type="button" class="cc-button media-control-button media-control-icon" data-cc-button aria-label="<%= ariaLabel %>"></button>
<ul>
  <% if (title) { %>
  <li data-title><%= title %></li>
  <% }; %>
  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>
  <% for (var i = 0; i < tracks.length; i++) { %>
    <li><a href="#" data-cc-select="<%= tracks[i].id %>"><%= tracks[i].label %></a></li>
  <% }; %>
</ul>
`,hf=`.cc-controls[data-cc-controls] {
  float: right;
  position: relative;
  display: none; }
  .cc-controls[data-cc-controls].available {
    display: block; }
  .cc-controls[data-cc-controls] .cc-button {
    padding: 6px !important; }
    .cc-controls[data-cc-controls] .cc-button.enabled {
      display: block;
      opacity: 1.0; }
      .cc-controls[data-cc-controls] .cc-button.enabled:hover {
        opacity: 1.0;
        text-shadow: none; }
  .cc-controls[data-cc-controls] > ul {
    list-style-type: none;
    position: absolute;
    bottom: 25px;
    border: 1px solid black;
    display: none;
    background-color: #e6e6e6; }
  .cc-controls[data-cc-controls] li {
    font-size: 10px; }
    .cc-controls[data-cc-controls] li[data-title] {
      background-color: #c3c2c2;
      padding: 5px; }
    .cc-controls[data-cc-controls] li a {
      color: #444;
      padding: 2px 10px;
      display: block;
      text-decoration: none; }
      .cc-controls[data-cc-controls] li a:hover {
        background-color: #555;
        color: white; }
        .cc-controls[data-cc-controls] li a:hover a {
          color: white;
          text-decoration: none; }
    .cc-controls[data-cc-controls] li.current a {
      color: #f00; }
`,vf=function(e){qe(i,e);var n=et(i);function i(r){var t;Ze(this,i),t=n.call(this,r);var g=r.options.closedCaptionsConfig;return t._title=g&&g.title?g.title:null,t._ariaLabel=g&&g.ariaLabel?g.ariaLabel:"cc-button",t._labelCb=g&&g.labelCallback&&typeof g.labelCallback=="function"?g.labelCallback:function(b){return b.name},t}return Je(i,[{key:"name",get:function(){return"closed_captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(df)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,G.CONTAINER_SUBTITLE_AVAILABLE,this.onSubtitleAvailable),this.listenTo(this.container,G.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,G.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){this.ccAvailable(!1),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(t){this.setCurrentContextMenuElement(t.id)}},{key:"onTrackSelect",value:function(t){var g=parseInt(t.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=g,this.hideContextMenu(),t.stopPropagation(),!1}},{key:"ccAvailable",value:function(t){var g=t?"addClass":"removeClass";this.$el[g]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(t){return this.$el.find("ul a"+(isNaN(t)?"":'[data-cc-select="'+t+'"]')).parent()}},{key:"setCurrentContextMenuElement",value:function(t){if(this._trackId!==t){this.contextMenuElement().removeClass("current"),this.contextMenuElement(t).addClass("current");var g=t>-1?"addClass":"removeClass";this.$ccButton[g]("enabled"),this._trackId=t}}},{key:"renderCcButton",value:function(){for(var t=this.container?this.container.closedCaptionsTracks:[],g=0;g<t.length;g++)t[g].label=this._labelCb(t[g]);var b=ze.getStyleFor(hf,{baseUrl:this.options.baseUrl});this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(ff),this.$el.append(b[0])}},{key:"render",value:function(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");return t[0]?this.$el.insertAfter(t):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),i}(yt),gf=`<div class="live-info"><%= live %></div>
<button type="button" class="live-button" aria-label="<%= backToLive %>"><%= backToLive %></button>
`,pf=`.dvr-controls[data-dvr-controls] {
  display: inline-block;
  float: left;
  color: #fff;
  line-height: 32px;
  font-size: 10px;
  font-weight: bold;
  margin-left: 6px; }
  .dvr-controls[data-dvr-controls] .live-info {
    cursor: default;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase; }
    .dvr-controls[data-dvr-controls] .live-info:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #ff0101; }
    .dvr-controls[data-dvr-controls] .live-info.disabled {
      opacity: 0.3; }
      .dvr-controls[data-dvr-controls] .live-info.disabled:before {
        background-color: #fff; }
  .dvr-controls[data-dvr-controls] .live-button {
    cursor: pointer;
    outline: none;
    display: none;
    border: 0;
    color: #fff;
    background-color: transparent;
    height: 32px;
    padding: 0;
    opacity: 0.7;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase;
    transition: all 0.1s ease; }
    .dvr-controls[data-dvr-controls] .live-button:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #fff; }
    .dvr-controls[data-dvr-controls] .live-button:hover {
      opacity: 1;
      text-shadow: rgba(255, 255, 255, 0.75) 0 0 5px; }

.dvr .dvr-controls[data-dvr-controls] .live-info {
  display: none; }

.dvr .dvr-controls[data-dvr-controls] .live-button {
  display: block; }

.dvr.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #005aff; }

.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #ff0101; }
`,mf=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.settingsUpdate(),t}return Je(i,[{key:"template",get:function(){return nt(gf)}},{key:"name",get:function(){return"dvr_controls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"events",get:function(){return{"click .live-button":"click"}}},{key:"attributes",get:function(){return{class:"dvr-controls","data-dvr-controls":""}}},{key:"bindEvents",value:function(){this.bindCoreEvents(),this.bindContainerEvents()}},{key:"bindCoreEvents",value:function(){var t=this;this.core.mediaControl.settings?(this.listenTo(this.core.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.settingsUpdate),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.render)):setTimeout(function(){return t.bindCoreEvents()},100)}},{key:"bindContainerEvents",value:function(){this.core.activeContainer&&(this.listenToOnce(this.core.activeContainer,G.CONTAINER_TIMEUPDATE,this.render),this.listenTo(this.core.activeContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.dvrChanged))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"dvrChanged",value:function(t){this.core.getPlaybackType()===me.LIVE&&(this.settingsUpdate(),this.core.mediaControl.$el.addClass("live"),t?(this.core.mediaControl.$el.addClass("dvr"),this.core.mediaControl.$el.find(".media-control-indicator[data-position], .media-control-indicator[data-duration]").hide()):this.core.mediaControl.$el.removeClass("dvr"))}},{key:"click",value:function(){var t=this.core.mediaControl,g=t.container;g.isPlaying()||g.play(),t.$el.hasClass("dvr")&&g.seek(g.getDuration())}},{key:"settingsUpdate",value:function(){var t=this;this.stopListening(),this.core.mediaControl.$el.removeClass("live"),this.shouldRender()&&(this.render(),this.$el.click(function(){return t.click()})),this.bindEvents()}},{key:"shouldRender",value:function(){var t=this.core.options.useDvrControls===void 0||!!this.core.options.useDvrControls;return t&&this.core.getPlaybackType()===me.LIVE}},{key:"render",value:function(){var t=ze.getStyleFor(pf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({live:this.core.i18n.t("live"),backToLive:this.core.i18n.t("back_to_live")})),this.$el.append(t[0]),this.shouldRender()&&(this.core.mediaControl.$el.addClass("live"),this.core.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.$el)),this}}]),i}(yt),yf=function(e){qe(i,e);var n=et(i);function i(){return Ze(this,i),n.apply(this,arguments)}return Je(i,[{key:"name",get:function(){return"end_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);var t=this.core.activeContainer;t&&(this.listenTo(t,G.CONTAINER_ENDED,this.ended),this.listenTo(t,G.CONTAINER_STOP,this.ended))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"ended",value:function(){var t=typeof this.core.options.exitFullscreenOnEnd>"u"||this.core.options.exitFullscreenOnEnd;t&&this.core.isFullscreen()&&this.core.toggleFullscreen()}}]),i}(Rt),Ef=`<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`,Af=`<div class="player-error-screen__content" data-error-screen>
  <% if (icon) { %>
  <div class="player-error-screen__icon" data-error-screen><%= icon %></div>
  <% } %>
  <div class="player-error-screen__title" data-error-screen><%= title %></div>
  <div class="player-error-screen__message" data-error-screen><%= message %></div>
  <div class="player-error-screen__code" data-error-screen>Error code: <%= code %></div>
  <div class="player-error-screen__reload" data-error-screen><%= reloadIcon %></div>
</div>
`,_f=`[data-player] .player-error-screen {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #CCCACA;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center; }
  [data-player] .player-error-screen__content[data-error-screen] {
    font-size: 14px;
    color: #CCCACA;
    margin-top: 45px; }
  [data-player] .player-error-screen__title[data-error-screen] {
    font-weight: bold;
    line-height: 30px;
    font-size: 18px; }
  [data-player] .player-error-screen__message[data-error-screen] {
    width: 90%;
    margin: 0 auto; }
  [data-player] .player-error-screen__code[data-error-screen] {
    font-size: 13px;
    margin-top: 15px; }
  [data-player] .player-error-screen__reload {
    cursor: pointer;
    width: 30px;
    margin: 15px auto 0 !important; }
`,Tf=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.options.disableErrorScreen?to(t,t.disable()):t}return Je(i,[{key:"name",get:function(){return"error_screen"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(Af)}},{key:"container",get:function(){return this.core.getCurrentContainer()}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.ERROR,this.onError),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onContainerChanged)}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var t=this;this.listenToOnce(this.core,G.CORE_READY,function(){return t.container.play()}),this.core.load(this.options.sources,this.options.mimeType),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onContainerChanged",value:function(){this.err=null,this.unbindReload(),this.hide()}},{key:"onError",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.level===ot.Levels.FATAL&&(this.err=t,this.container.disableMediaControl(),this.container.stop(),this.show())}},{key:"show",value:function(){this.render(),this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"render",value:function(){if(this.err){var t=ze.getStyleFor(_f,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({title:this.err.UI.title,message:this.err.UI.message,code:this.err.code,icon:this.err.UI.icon||"",reloadIcon:Ef})),this.$el.append(t[0]),this.core.$el.append(this.el),this.bindReload(),this}}}]),i}(yt),Xt=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"/>
</svg>`,ni=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 14.76H6.43V1.24H1.71v13.52zm7.86-13.52v13.52h4.716V1.24H9.573z"/>
</svg>`,bf=ve('link[rel="shortcut icon"]'),Sf=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t._container=null,t.configure(),t}return Je(i,[{key:"name",get:function(){return"favicon"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"oldIcon",get:function(){return bf}},{key:"configure",value:function(){this.core.options.changeFavicon?this.enabled||(this.stopListening(this.core,G.CORE_OPTIONS_CHANGE),this.enable()):this.enabled&&(this.disable(),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure))}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.core.activeContainer&&this.containerChanged()}},{key:"containerChanged",value:function(){this._container&&this.stopListening(this._container),this._container=this.core.activeContainer,this.listenTo(this._container,G.CONTAINER_PLAY,this.setPlayIcon),this.listenTo(this._container,G.CONTAINER_PAUSE,this.setPauseIcon),this.listenTo(this._container,G.CONTAINER_STOP,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ENDED,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ERROR,this.resetIcon),this.resetIcon()}},{key:"disable",value:function(){fr(kt(i.prototype),"disable",this).call(this),this.resetIcon()}},{key:"destroy",value:function(){fr(kt(i.prototype),"destroy",this).call(this),this.resetIcon()}},{key:"createIcon",value:function(t){var g=ve("<canvas/>");g[0].width=16,g[0].height=16;var b=g[0].getContext("2d");b.fillStyle="#000";var P=ve(t).find("path").attr("d"),m=new Path2D(P);b.fill(m);var N=ve('<link rel="shortcut icon" type="image/png"/>');return N.attr("href",g[0].toDataURL("image/png")),N}},{key:"setPlayIcon",value:function(){this.playIcon||(this.playIcon=this.createIcon(Xt)),this.changeIcon(this.playIcon)}},{key:"setPauseIcon",value:function(){this.pauseIcon||(this.pauseIcon=this.createIcon(ni)),this.changeIcon(this.pauseIcon)}},{key:"resetIcon",value:function(){ve('link[rel="shortcut icon"]').remove(),ve("head").append(this.oldIcon)}},{key:"changeIcon",value:function(t){t&&(ve('link[rel="shortcut icon"]').remove(),ve("head").append(t))}}]),i}(Rt),xf=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.container.options.gaAccount&&(t.account=t.container.options.gaAccount,t.trackerName=t.container.options.gaTrackerName?t.container.options.gaTrackerName+".":"Clappr.",t.domainName=t.container.options.gaDomainName,t.currentHDState=void 0,t.embedScript()),t}return Je(i,[{key:"name",get:function(){return"google_analytics"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"embedScript",value:function(){var t=this;if(window._gat)this.addEventListeners();else{var g=document.createElement("script");g.setAttribute("type","text/javascript"),g.setAttribute("async","async"),g.setAttribute("src","//www.google-analytics.com/ga.js"),g.onload=function(){return t.addEventListeners()},document.body.appendChild(g)}}},{key:"addEventListeners",value:function(){var t=this;this.container&&(this.listenTo(this.container,G.CONTAINER_READY,this.onReady),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PAUSE,this.onPause),this.listenTo(this.container,G.CONTAINER_ENDED,this.onEnded),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.listenTo(this.container,G.CONTAINER_PLAYBACKSTATE,this.onPlaybackChanged),this.listenTo(this.container,G.CONTAINER_VOLUME,function(g){return t.onVolumeChanged(g)}),this.listenTo(this.container,G.CONTAINER_SEEK,function(g){return t.onSeek(g)}),this.listenTo(this.container,G.CONTAINER_FULL_SCREEN,this.onFullscreen),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.onHD),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.onDVR)),_gaq.push([this.trackerName+"_setAccount",this.account]),this.domainName&&_gaq.push([this.trackerName+"_setDomainName",this.domainName])}},{key:"onReady",value:function(){this.push(["Video","Playback",this.container.playback.name])}},{key:"onPlay",value:function(){this.push(["Video","Play",this.container.playback.src])}},{key:"onStop",value:function(){this.push(["Video","Stop",this.container.playback.src])}},{key:"onEnded",value:function(){this.push(["Video","Ended",this.container.playback.src])}},{key:"onBuffering",value:function(){this.push(["Video","Buffering",this.container.playback.src])}},{key:"onBufferFull",value:function(){this.push(["Video","Bufferfull",this.container.playback.src])}},{key:"onError",value:function(){this.push(["Video","Error",this.container.playback.src])}},{key:"onHD",value:function(t){var g=t?"ON":"OFF";g!==this.currentHDState&&(this.currentHDState=g,this.push(["Video","HD - "+g,this.container.playback.src]))}},{key:"onPlaybackChanged",value:function(t){t.type!==null&&this.push(["Video","Playback Type - "+t.type,this.container.playback.src])}},{key:"onDVR",value:function(t){var g=t?"ON":"OFF";this.push(["Interaction","DVR - "+g,this.container.playback.src])}},{key:"onPause",value:function(){this.push(["Video","Pause",this.container.playback.src])}},{key:"onSeek",value:function(){this.push(["Video","Seek",this.container.playback.src])}},{key:"onVolumeChanged",value:function(){this.push(["Interaction","Volume",this.container.playback.src])}},{key:"onFullscreen",value:function(){this.push(["Interaction","Fullscreen",this.container.playback.src])}},{key:"push",value:function(t){var g=[this.trackerName+"_trackEvent"].concat(t);_gaq.push(g)}}]),i}(tr),ce=function(n){this.element=n||window.document,this.initialize()};ce.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};ce.KEY_CODES_BY_NAME={};(function(){for(var e in ce.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(ce.KEY_NAMES_BY_CODE,e)&&(ce.KEY_CODES_BY_NAME[ce.KEY_NAMES_BY_CODE[e]]=+e)})();ce.MODIFIERS=["shift","ctrl","alt"];ce.registerEvent=function(){if(document.addEventListener)return function(e,n,i){e.addEventListener(n,i,!1)};if(document.attachEvent)return function(e,n,i){e.attachEvent("on"+n,i)}}();ce.unregisterEvent=function(){if(document.removeEventListener)return function(e,n,i){e.removeEventListener(n,i,!1)};if(document.detachEvent)return function(e,n,i){e.detachEvent("on"+n,i)}}();ce.stringContains=function(e,n){return e.indexOf(n)!==-1};ce.neatString=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")};ce.capitalize=function(e){return e.toLowerCase().replace(/^./,function(n){return n.toUpperCase()})};ce.isString=function(e){return ce.stringContains(Object.prototype.toString.call(e),"String")};ce.arrayIncludes=function(){return Array.prototype.indexOf?function(e,n){return e.indexOf(n)!==-1}:function(e,n){for(var i=0;i<e.length;i++)if(e[i]===n)return!0;return!1}}();ce.extractModifiers=function(e){var n,i;for(n=[],i=0;i<ce.MODIFIERS.length;i++)ce.stringContains(e,ce.MODIFIERS[i])&&n.push(ce.MODIFIERS[i]);return n};ce.extractKey=function(e){var n,i;for(n=ce.neatString(e).split(" "),i=0;i<n.length;i++)if(!ce.arrayIncludes(ce.MODIFIERS,n[i]))return n[i]};ce.modifiersAndKey=function(e){var n,i;return ce.stringContains(e,"any")?ce.neatString(e).split(" ").slice(0,2).join(" "):(n=ce.extractModifiers(e),i=ce.extractKey(e),i&&!ce.arrayIncludes(ce.MODIFIERS,i)&&n.push(i),n.join(" "))};ce.keyName=function(e){return ce.KEY_NAMES_BY_CODE[e+""]};ce.keyCode=function(e){return+ce.KEY_CODES_BY_NAME[e]};ce.prototype.initialize=function(){var e,n=this;for(this.lastKeyCode=-1,this.lastModifiers={},e=0;e<ce.MODIFIERS.length;e++)this.lastModifiers[ce.MODIFIERS[e]]=!1;this.keysDown={any:[]},this.keysUp={any:[]},this.downHandler=this.handler("down"),this.upHandler=this.handler("up"),ce.registerEvent(this.element,"keydown",this.downHandler),ce.registerEvent(this.element,"keyup",this.upHandler),ce.registerEvent(window,"unload",function i(){ce.unregisterEvent(n.element,"keydown",n.downHandler),ce.unregisterEvent(n.element,"keyup",n.upHandler),ce.unregisterEvent(window,"unload",i)})};ce.prototype.handler=function(e){var n=this;return function(i){var r,t,g;for(i=i||window.event,n.lastKeyCode=i.keyCode,r=0;r<ce.MODIFIERS.length;r++)n.lastModifiers[ce.MODIFIERS[r]]=i[ce.MODIFIERS[r]+"Key"];for(ce.arrayIncludes(ce.MODIFIERS,ce.keyName(n.lastKeyCode))&&(n.lastModifiers[ce.keyName(n.lastKeyCode)]=!0),t=n["keys"+ce.capitalize(e)],r=0;r<t.any.length;r++)t.any[r](i)===!1&&i.preventDefault&&i.preventDefault();if(g=n.lastModifiersAndKey(),t[g])for(r=0;r<t[g].length;r++)t[g][r](i)===!1&&i.preventDefault&&i.preventDefault()}};ce.prototype.registerKeys=function(e,n,i){var r,t,g=this["keys"+ce.capitalize(e)];for(ce.isString(n)&&(n=[n]),r=0;r<n.length;r++)t=n[r],t=ce.modifiersAndKey(t+""),g[t]?g[t].push(i):g[t]=[i];return this};ce.prototype.unregisterKeys=function(e,n,i){var r,t,g,b=this["keys"+ce.capitalize(e)];for(ce.isString(n)&&(n=[n]),r=0;r<n.length;r++)if(g=n[r],g=ce.modifiersAndKey(g+""),i===null)delete b[g];else if(b[g]){for(t=0;t<b[g].length;t++)if(String(b[g][t])===String(i)){b[g].splice(t,1);break}}return this};ce.prototype.off=function(e){return this.unregisterKeys("down",e,null)};ce.prototype.delegate=function(e,n,i){return i!==null||i!==void 0?this.registerKeys(e,n,i):this.unregisterKeys(e,n,i)};ce.prototype.down=function(e,n){return this.delegate("down",e,n)};ce.prototype.up=function(e,n){return this.delegate("up",e,n)};ce.prototype.lastKey=function(e){return e?this.lastModifiers[e]:ce.keyName(this.lastKeyCode)};ce.prototype.lastModifiersAndKey=function(){var e,n;for(e=[],n=0;n<ce.MODIFIERS.length;n++)this.lastKey(ce.MODIFIERS[n])&&e.push(ce.MODIFIERS[n]);return ce.arrayIncludes(e,this.lastKey())||e.push(this.lastKey()),e.join(" ")};var Cf=`.media-control-notransition {
  transition: none !important; }

.media-control[data-media-control] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 9999;
  pointer-events: none; }
  .media-control[data-media-control].dragging {
    pointer-events: auto;
    cursor: grabbing !important;
    cursor: url("closed-hand.cur"), move; }
    .media-control[data-media-control].dragging * {
      cursor: grabbing !important;
      cursor: url("closed-hand.cur"), move; }
  .media-control[data-media-control] .media-control-background[data-background] {
    position: absolute;
    height: 40%;
    width: 100%;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
    will-change: transform, opacity;
    transition: opacity 0.6s ease-out; }
  .media-control[data-media-control] .media-control-icon {
    line-height: 0;
    letter-spacing: 0;
    speak: none;
    color: #fff;
    opacity: 0.5;
    vertical-align: middle;
    text-align: left;
    transition: all 0.1s ease; }
  .media-control[data-media-control] .media-control-icon:hover {
    color: white;
    opacity: 0.75;
    text-shadow: rgba(255, 255, 255, 0.8) 0 0 5px; }
  .media-control[data-media-control].media-control-hide .media-control-background[data-background] {
    opacity: 0; }
  .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] {
    transform: translateY(50px); }
    .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
      opacity: 0; }
  .media-control[data-media-control] .media-control-layer[data-controls] {
    position: absolute;
    transform: translateY(-7px);
    bottom: 0;
    width: 100%;
    height: 32px;
    font-size: 0;
    vertical-align: middle;
    pointer-events: auto;
    transition: bottom 0.4s ease-out; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-left-panel[data-media-control] {
      position: absolute;
      top: 0;
      left: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-center-panel[data-media-control] {
      height: 100%;
      text-align: center;
      line-height: 32px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-right-panel[data-media-control] {
      position: absolute;
      top: 0;
      right: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button {
      background-color: transparent;
      border: 0;
      margin: 0 6px;
      padding: 0;
      cursor: pointer;
      display: inline-block;
      width: 32px;
      height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg {
        width: 100%;
        height: 22px; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg path {
          fill: white; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button:focus {
        outline: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-play] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-pause] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-stop] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-fullscreen] {
        float: right;
        background-color: transparent;
        border: 0;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator] {
        background-color: transparent;
        border: 0;
        cursor: default;
        display: none;
        float: right;
        height: 100%; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled {
          display: block;
          opacity: 1.0; }
          .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled:hover {
            opacity: 1.0;
            text-shadow: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playpause] {
        float: left; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playstop] {
        float: left; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position], .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      display: inline-block;
      font-size: 10px;
      color: white;
      cursor: default;
      line-height: 32px;
      position: relative; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position] {
      margin: 0 6px 0 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      color: rgba(255, 255, 255, 0.5);
      margin-right: 6px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration]:before {
        content: "|";
        margin-right: 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] {
      position: absolute;
      top: -20px;
      left: 0;
      display: inline-block;
      vertical-align: middle;
      width: 100%;
      height: 25px;
      cursor: pointer; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] {
        width: 100%;
        height: 1px;
        position: relative;
        top: 12px;
        background-color: #666666; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-1[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #c2c2c2;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #005aff;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0;
          position: absolute;
          top: -3px;
          width: 5px;
          height: 7px;
          background-color: rgba(255, 255, 255, 0.5);
          transition: opacity 0.1s ease; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar]:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
        opacity: 1; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled {
        cursor: default; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
        position: absolute;
        transform: translateX(-50%);
        top: 2px;
        left: 0;
        width: 20px;
        height: 20px;
        opacity: 1;
        transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] .bar-scrubber-icon[data-seekbar] {
          position: absolute;
          left: 6px;
          top: 6px;
          width: 8px;
          height: 8px;
          border-radius: 10px;
          box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
          background-color: white; }
    .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] {
      float: right;
      display: inline-block;
      height: 32px;
      cursor: pointer;
      margin: 0 6px;
      box-sizing: border-box; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] {
        float: left;
        bottom: 0; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] {
          background-color: transparent;
          border: 0;
          box-sizing: content-box;
          width: 32px;
          height: 32px;
          opacity: 0.5; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume]:hover {
            opacity: 0.75; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg {
            height: 24px;
            position: relative;
            top: 3px; }
            .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg path {
              fill: white; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume].muted svg {
            margin-left: 2px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] {
        float: left;
        position: relative;
        overflow: hidden;
        top: 6px;
        width: 42px;
        height: 18px;
        padding: 3px 0;
        transition: width .2s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] {
          height: 1px;
          position: relative;
          top: 7px;
          margin: 0 3px;
          background-color: #666666; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-1[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #c2c2c2;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-2[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #005aff;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-hover[data-volume] {
            opacity: 0;
            position: absolute;
            top: -3px;
            width: 5px;
            height: 7px;
            background-color: rgba(255, 255, 255, 0.5);
            transition: opacity 0.1s ease; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] {
          position: absolute;
          transform: translateX(-50%);
          top: 0px;
          left: 0;
          width: 20px;
          height: 20px;
          opacity: 1;
          transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] .bar-scrubber-icon[data-volume] {
            position: absolute;
            left: 6px;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 10px;
            box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
            background-color: white; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume] {
          float: left;
          width: 4px;
          padding-left: 2px;
          height: 12px;
          opacity: 0.5;
          box-shadow: inset 2px 0 0 white;
          transition: transform .2s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume].fill {
            box-shadow: inset 2px 0 0 #fff;
            opacity: 1; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:nth-of-type(1) {
            padding-left: 0; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:hover {
            transform: scaleY(1.5); }
  .media-control[data-media-control].w320 .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume].volume-bar-hide {
    width: 0;
    height: 12px;
    top: 9px;
    padding: 0; }
`,Lf=`<div class="media-control-background" data-background></div>
<div class="media-control-layer" data-controls>
  <%  var renderBar = function(name) { %>
      <div class="bar-container" data-<%= name %>>
        <div class="bar-background" data-<%= name %>>
          <div class="bar-fill-1" data-<%= name %>></div>
          <div class="bar-fill-2" data-<%= name %>></div>
          <div class="bar-hover" data-<%= name %>></div>
        </div>
        <div class="bar-scrubber" data-<%= name %>>
          <div class="bar-scrubber-icon" data-<%= name %>></div>
        </div>
      </div>
  <%  }; %>
  <%  var renderSegmentedBar = function(name, segments) {
      segments = segments || 10; %>
    <div class="bar-container" data-<%= name %>>
    <% for (var i = 0; i < segments; i++) { %>
      <div class="segmented-bar-element" data-<%= name %>></div>
    <% } %>
    </div>
  <% }; %>
  <% var renderDrawer = function(name, renderContent) { %>
      <div class="drawer-container" data-<%= name %>>
        <div class="drawer-icon-container" data-<%= name %>>
          <div class="drawer-icon media-control-icon" data-<%= name %>></div>
          <span class="drawer-text" data-<%= name %>></span>
        </div>
        <% renderContent(name); %>
      </div>
  <% }; %>
  <% var renderIndicator = function(name) { %>
      <div class="media-control-indicator" data-<%= name %>></div>
  <% }; %>
  <% var renderButton = function(name) { %>
    <button type="button" class="media-control-button media-control-icon" data-<%= name %> aria-label="<%= name %>"></button>
  <% }; %>
  <%  var templates = {
        bar: renderBar,
        segmentedBar: renderSegmentedBar,
      };
      var render = function(settingsList) {
        settingsList.forEach(function(setting) {
          if(setting === "seekbar") {
            renderBar(setting);
          } else if (setting === "volume") {
            renderDrawer(setting, settings.volumeBarTemplate ? templates[settings.volumeBarTemplate] : function(name) { return renderSegmentedBar(name); });
          } else if (setting === "duration" || setting === "position") {
            renderIndicator(setting);
          } else {
            renderButton(setting);
          }
        });
      }; %>
  <% if (settings.default && settings.default.length) { %>
  <div class="media-control-center-panel" data-media-control>
    <% render(settings.default); %>
  </div>
  <% } %>
  <% if (settings.left && settings.left.length) { %>
  <div class="media-control-left-panel" data-media-control>
    <% render(settings.left); %>
  </div>
  <% } %>
  <% if (settings.right && settings.right.length) { %>
  <div class="media-control-right-panel" data-media-control>
    <% render(settings.right); %>
  </div>
  <% } %>
</div>
`,xa=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 1.24h12.6v13.52h-12.6z"/>
</svg>`,Ca=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M11.5 11h-.002v1.502L7.798 10H4.5V6h3.297l3.7-2.502V4.5h.003V11zM11 4.49L7.953 6.5H5v3h2.953L11 11.51V4.49z"/>
</svg>`,Df=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M9.75 11.51L6.7 9.5H3.75v-3H6.7L9.75 4.49v.664l.497.498V3.498L6.547 6H3.248v4h3.296l3.7 2.502v-2.154l-.497.5v.662zm3-5.165L12.404 6l-1.655 1.653L9.093 6l-.346.345L10.402 8 8.747 9.654l.346.347 1.655-1.653L12.403 10l.348-.346L11.097 8l1.655-1.655z"/>
</svg>`,La=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M7.156 8L4 11.156V8.5H3V13h4.5v-1H4.844L8 8.844 7.156 8zM8.5 3v1h2.657L8 7.157 8.846 8 12 4.844V7.5h1V3H8.5z"/>
</svg>`,Of=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M13.5 3.344l-.844-.844L9.5 5.656V3h-1v4.5H13v-1h-2.656L13.5 3.344zM3 9.5h2.656L2.5 12.656l.844.844L6.5 10.344V13h1V8.5H3v1z"/>
</svg>`,If=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M5.375 7.062H2.637V4.26H.502v7.488h2.135V8.9h2.738v2.848h2.133V4.26H5.375v2.802zm5.97-2.81h-2.84v7.496h2.798c2.65 0 4.195-1.607 4.195-3.77v-.022c0-2.162-1.523-3.704-4.154-3.704zm2.06 3.758c0 1.21-.81 1.896-2.03 1.896h-.83V6.093h.83c1.22 0 2.03.696 2.03 1.896v.02z"/>
</svg>`,Da=Bt.Config,Oa=Bt.Fullscreen,Ia=Bt.formatTime,Pf=Bt.extend,Fn=Bt.removeArrayItem,ii=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.persistConfig=t.options.persistConfig,t.currentPositionValue=null,t.currentDurationValue=null,t.keepVisible=!1,t.fullScreenOnVideoTagSupported=null,t.setInitialVolume(),t.settings={left:["play","stop","pause"],right:["volume"],default:["position","seekbar","duration"]},t.kibo=new ce(t.options.focusElement),t.bindKeyEvents(),t.container?ve.isEmptyObject(t.container.settings)||(t.settings=ve.extend({},t.container.settings)):t.settings={},t.userDisabled=!1,(t.container&&t.container.mediaControlDisabled||t.options.chromeless)&&t.disable(),t.stopDragHandler=function(g){return t.stopDrag(g)},t.updateDragHandler=function(g){return t.updateDrag(g)},ve(document).bind("mouseup",t.stopDragHandler),ve(document).bind("mousemove",t.updateDragHandler),t}return Je(i,[{key:"name",get:function(){return"media_control"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"disabled",get:function(){var t=this.container&&this.container.getPlaybackType()===me.NO_OP;return this.userDisabled||t}},{key:"container",get:function(){return this.core&&this.core.activeContainer}},{key:"playback",get:function(){return this.core&&this.core.activePlayback}},{key:"attributes",get:function(){return{class:"media-control","data-media-control":""}}},{key:"events",get:function(){return{"click [data-play]":"play","click [data-pause]":"pause","click [data-playpause]":"togglePlayPause","click [data-stop]":"stop","click [data-playstop]":"togglePlayStop","click [data-fullscreen]":"toggleFullscreen","click .bar-container[data-seekbar]":"seek","click .bar-container[data-volume]":"onVolumeClick","click .drawer-icon[data-volume]":"toggleMute","mouseenter .drawer-container[data-volume]":"showVolumeBar","mouseleave .drawer-container[data-volume]":"hideVolumeBar","mousedown .bar-container[data-volume]":"startVolumeDrag","mousemove .bar-container[data-volume]":"mousemoveOnVolumeBar","mousedown .bar-scrubber[data-seekbar]":"startSeekDrag","mousemove .bar-container[data-seekbar]":"mousemoveOnSeekBar","mouseleave .bar-container[data-seekbar]":"mouseleaveOnSeekBar","mouseenter .media-control-layer[data-controls]":"setUserKeepVisible","mouseleave .media-control-layer[data-controls]":"resetUserKeepVisible"}}},{key:"template",get:function(){return nt(Lf)}},{key:"volume",get:function(){return this.container&&this.container.isReady?this.container.volume:this.intendedVolume}},{key:"muted",get:function(){return this.volume===0}},{key:"getExternalInterface",value:function(){var t=this;return{setVolume:this.setVolume,getVolume:function(){return t.volume}}}},{key:"bindEvents",value:function(){var t=this;this.stopListening(),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onActiveContainerChanged),this.listenTo(this.core,G.CORE_MOUSE_MOVE,this.show),this.listenTo(this.core,G.CORE_MOUSE_LEAVE,function(){return t.hide(t.options.hideMediaControlDelay)}),this.listenTo(this.core,G.CORE_FULLSCREEN,this.show),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_RESIZE,this.playerResize),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container&&(this.listenTo(this.container,G.CONTAINER_PLAY,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_PAUSE,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_STOP,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_DBLCLICK,this.toggleFullscreen),this.listenTo(this.container,G.CONTAINER_TIMEUPDATE,this.onTimeUpdate),this.listenTo(this.container,G.CONTAINER_PROGRESS,this.updateProgressBar),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_DISABLE,this.disable),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_ENABLE,this.enable),this.listenTo(this.container,G.CONTAINER_ENDED,this.ended),this.listenTo(this.container,G.CONTAINER_VOLUME,this.onVolumeChanged),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.setInitialVolume),this.container.playback.el.nodeName.toLowerCase()==="video"&&this.listenToOnce(this.container,G.CONTAINER_LOADEDMETADATA,this.onLoadedMetadataOnVideoTag))}},{key:"disable",value:function(){this.userDisabled=!0,this.hide(),this.unbindKeyEvents(),this.$el.hide()}},{key:"enable",value:function(){this.options.chromeless||(this.userDisabled=!1,this.bindKeyEvents(),this.show())}},{key:"play",value:function(){this.container&&this.container.play()}},{key:"pause",value:function(){this.container&&this.container.pause()}},{key:"stop",value:function(){this.container&&this.container.stop()}},{key:"setInitialVolume",value:function(){var t=this.persistConfig?Da.restore("volume"):100,g=this.container&&this.container.options||this.options;this.setVolume(g.mute?0:t,!0)}},{key:"onVolumeChanged",value:function(){this.updateVolumeUI()}},{key:"onLoadedMetadataOnVideoTag",value:function(){var t=this.playback&&this.playback.el;!Oa.fullscreenEnabled()&&t.webkitSupportsFullscreen&&(this.fullScreenOnVideoTagSupported=!0,this.settingsUpdate())}},{key:"updateVolumeUI",value:function(){if(this.rendered){this.$volumeBarContainer.find(".bar-fill-2").css({});var t=this.$volumeBarContainer.width(),g=this.$volumeBarBackground.width(),b=(t-g)/2,P=g*this.volume/100+b;this.$volumeBarFill.css({width:"".concat(this.volume,"%")}),this.$volumeBarScrubber.css({left:P}),this.$volumeBarContainer.find(".segmented-bar-element").removeClass("fill");var m=Math.ceil(this.volume/10);this.$volumeBarContainer.find(".segmented-bar-element").slice(0,m).addClass("fill"),this.$volumeIcon.html(""),this.$volumeIcon.removeClass("muted"),this.muted?(this.$volumeIcon.append(Df),this.$volumeIcon.addClass("muted")):this.$volumeIcon.append(Ca),this.applyButtonStyle(this.$volumeIcon)}}},{key:"changeTogglePlay",value:function(){this.$playPauseToggle.html(""),this.$playStopToggle.html(""),this.container&&this.container.isPlaying()?(this.$playPauseToggle.append(ni),this.$playStopToggle.append(xa),this.trigger(G.MEDIACONTROL_PLAYING)):(this.$playPauseToggle.append(Xt),this.$playStopToggle.append(Xt),this.trigger(G.MEDIACONTROL_NOTPLAYING),de.isMobile&&this.show()),this.applyButtonStyle(this.$playPauseToggle),this.applyButtonStyle(this.$playStopToggle)}},{key:"mousemoveOnSeekBar",value:function(t){if(this.settings.seekEnabled){var g=t.pageX-this.$seekBarContainer.offset().left-this.$seekBarHover.width()/2;this.$seekBarHover.css({left:g})}this.trigger(G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,t)}},{key:"mouseleaveOnSeekBar",value:function(t){this.trigger(G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,t)}},{key:"onVolumeClick",value:function(t){this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"mousemoveOnVolumeBar",value:function(t){this.draggingVolumeBar&&this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"playerResize",value:function(t){this.$fullscreenToggle.html("");var g=this.core.isFullscreen()?Of:La;this.$fullscreenToggle.append(g),this.applyButtonStyle(this.$fullscreenToggle),this.$el.find(".media-control").length!==0&&this.$el.removeClass("w320"),(t.width<=320||this.options.hideVolumeBar)&&this.$el.addClass("w320")}},{key:"togglePlayPause",value:function(){return this.container.isPlaying()?this.container.pause():this.container.play(),!1}},{key:"togglePlayStop",value:function(){this.container.isPlaying()?this.container.stop():this.container.play()}},{key:"startSeekDrag",value:function(t){this.settings.seekEnabled&&(this.draggingSeekBar=!0,this.$el.addClass("dragging"),this.$seekBarLoaded.addClass("media-control-notransition"),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition"),t&&t.preventDefault())}},{key:"startVolumeDrag",value:function(t){this.draggingVolumeBar=!0,this.$el.addClass("dragging"),t&&t.preventDefault()}},{key:"stopDrag",value:function(t){this.draggingSeekBar&&this.seek(t),this.$el.removeClass("dragging"),this.$seekBarLoaded.removeClass("media-control-notransition"),this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition dragging"),this.draggingSeekBar=!1,this.draggingVolumeBar=!1}},{key:"updateDrag",value:function(t){if(this.draggingSeekBar){t.preventDefault();var g=t.pageX-this.$seekBarContainer.offset().left,b=g/this.$seekBarContainer.width()*100;b=Math.min(100,Math.max(b,0)),this.setSeekPercentage(b)}else this.draggingVolumeBar&&(t.preventDefault(),this.setVolume(this.getVolumeFromUIEvent(t)))}},{key:"getVolumeFromUIEvent",value:function(t){var g=t.pageX-this.$volumeBarContainer.offset().left,b=g/this.$volumeBarContainer.width()*100;return b}},{key:"toggleMute",value:function(){this.setVolume(this.muted?100:0)}},{key:"setVolume",value:function(t){var g=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t=Math.min(100,Math.max(t,0)),this.intendedVolume=t,this.persistConfig&&!b&&Da.persist("volume",t);var P=function(){g.container&&g.container.isReady?g.container.setVolume(t):g.listenToOnce(g.container,G.CONTAINER_READY,function(){g.container.setVolume(t)})};this.container?P():this.listenToOnce(this,G.MEDIACONTROL_CONTAINERCHANGED,function(){return P()})}},{key:"toggleFullscreen",value:function(){this.trigger(G.MEDIACONTROL_FULLSCREEN,this.name),this.container.fullscreen(),this.core.toggleFullscreen(),this.resetUserKeepVisible()}},{key:"onActiveContainerChanged",value:function(){this.fullScreenOnVideoTagSupported=null,this.bindEvents(),this.setInitialVolume(),this.changeTogglePlay(),this.bindContainerEvents(),this.settingsUpdate(),this.container&&this.container.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.container.isDvrInUse()),this.container&&this.container.mediaControlDisabled&&this.disable(),this.trigger(G.MEDIACONTROL_CONTAINERCHANGED)}},{key:"showVolumeBar",value:function(){this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.$volumeBarContainer.removeClass("volume-bar-hide")}},{key:"hideVolumeBar",value:function(){var t=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:400;this.$volumeBarContainer&&(this.draggingVolumeBar?this.hideVolumeId=setTimeout(function(){return t.hideVolumeBar()},g):(this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.hideVolumeId=setTimeout(function(){return t.$volumeBarContainer.addClass("volume-bar-hide")},g)))}},{key:"ended",value:function(){this.changeTogglePlay()}},{key:"updateProgressBar",value:function(t){var g=t.start/t.total*100,b=t.current/t.total*100;this.$seekBarLoaded.css({left:"".concat(g,"%"),width:"".concat(b-g,"%")})}},{key:"onTimeUpdate",value:function(t){if(!this.draggingSeekBar){var g=t.current<0?t.total:t.current;this.currentPositionValue=g,this.currentDurationValue=t.total,this.renderSeekBar()}}},{key:"renderSeekBar",value:function(){if(!(this.currentPositionValue===null||this.currentDurationValue===null)){this.currentSeekBarPercentage=100,this.container&&(this.container.getPlaybackType()!==me.LIVE||this.container.isDvrInUse())&&(this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100),this.setSeekPercentage(this.currentSeekBarPercentage);var t=Ia(this.currentPositionValue),g=Ia(this.currentDurationValue);t!==this.displayedPosition&&(this.$position.text(t),this.displayedPosition=t),g!==this.displayedDuration&&(this.$duration.text(g),this.displayedDuration=g)}}},{key:"seek",value:function(t){if(this.settings.seekEnabled){var g=t.pageX-this.$seekBarContainer.offset().left,b=g/this.$seekBarContainer.width()*100;return b=Math.min(100,Math.max(b,0)),this.container&&this.container.seekPercentage(b),this.setSeekPercentage(b),!1}}},{key:"setKeepVisible",value:function(){this.keepVisible=!0}},{key:"resetKeepVisible",value:function(){this.keepVisible=!1}},{key:"setUserKeepVisible",value:function(){this.userKeepVisible=!0}},{key:"resetUserKeepVisible",value:function(){this.userKeepVisible=!1}},{key:"isVisible",value:function(){return!this.$el.hasClass("media-control-hide")}},{key:"show",value:function(t){var g=this;if(!this.disabled){var b=2e3,P=t&&t.clientX!==this.lastMouseX&&t.clientY!==this.lastMouseY;(!t||P||navigator.userAgent.match(/firefox/i))&&(clearTimeout(this.hideId),this.$el.show(),this.trigger(G.MEDIACONTROL_SHOW,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_SHOW,this.name),this.$el.removeClass("media-control-hide"),this.hideId=setTimeout(function(){return g.hide()},b),t&&(this.lastMouseX=t.clientX,this.lastMouseY=t.clientY));var m=!0;this.updateCursorStyle(m)}}},{key:"hide",value:function(){var t=this,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this.isVisible()){var b=g||2e3;if(clearTimeout(this.hideId),!(!this.disabled&&this.options.hideMediaControl===!1)){var P=this.userKeepVisible||this.keepVisible,m=this.draggingSeekBar||this.draggingVolumeBar;if(!this.disabled&&(g||P||m))this.hideId=setTimeout(function(){return t.hide()},b);else{this.trigger(G.MEDIACONTROL_HIDE,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_HIDE,this.name),this.$el.addClass("media-control-hide"),this.hideVolumeBar(0);var N=!1;this.updateCursorStyle(N)}}}}},{key:"updateCursorStyle",value:function(t){t?this.core.$el.removeClass("nocursor"):this.core.isFullscreen()&&this.core.$el.addClass("nocursor")}},{key:"settingsUpdate",value:function(){var t=this.getSettings();t&&!this.fullScreenOnVideoTagSupported&&!Oa.fullscreenEnabled()&&(t.default&&Fn(t.default,"fullscreen"),t.left&&Fn(t.left,"fullscreen"),t.right&&Fn(t.right,"fullscreen"));var g=JSON.stringify(this.settings)!==JSON.stringify(t);g&&(this.settings=t,this.render())}},{key:"getSettings",value:function(){return ve.extend(!0,{},this.container&&this.container.settings)}},{key:"highDefinitionUpdate",value:function(t){this.isHD=t;var g=t?"addClass":"removeClass";this.$hdIndicator[g]("enabled")}},{key:"createCachedElements",value:function(){var t=this.$el.find(".media-control-layer");this.$duration=t.find(".media-control-indicator[data-duration]"),this.$fullscreenToggle=t.find("button.media-control-button[data-fullscreen]"),this.$playPauseToggle=t.find("button.media-control-button[data-playpause]"),this.$playStopToggle=t.find("button.media-control-button[data-playstop]"),this.$position=t.find(".media-control-indicator[data-position]"),this.$seekBarContainer=t.find(".bar-container[data-seekbar]"),this.$seekBarHover=t.find(".bar-hover[data-seekbar]"),this.$seekBarLoaded=t.find(".bar-fill-1[data-seekbar]"),this.$seekBarPosition=t.find(".bar-fill-2[data-seekbar]"),this.$seekBarScrubber=t.find(".bar-scrubber[data-seekbar]"),this.$volumeBarContainer=t.find(".bar-container[data-volume]"),this.$volumeContainer=t.find(".drawer-container[data-volume]"),this.$volumeIcon=t.find(".drawer-icon[data-volume]"),this.$volumeBarBackground=this.$el.find(".bar-background[data-volume]"),this.$volumeBarFill=this.$el.find(".bar-fill-1[data-volume]"),this.$volumeBarScrubber=this.$el.find(".bar-scrubber[data-volume]"),this.$hdIndicator=this.$el.find("button.media-control-button[data-hd-indicator]"),this.resetIndicators(),this.initializeIcons()}},{key:"resetIndicators",value:function(){this.displayedPosition=this.$position.text(),this.displayedDuration=this.$duration.text()}},{key:"initializeIcons",value:function(){var t=this.$el.find(".media-control-layer");t.find("button.media-control-button[data-play]").append(Xt),t.find("button.media-control-button[data-pause]").append(ni),t.find("button.media-control-button[data-stop]").append(xa),this.$playPauseToggle.append(Xt),this.$playStopToggle.append(Xt),this.$volumeIcon.append(Ca),this.$fullscreenToggle.append(La),this.$hdIndicator.append(If)}},{key:"setSeekPercentage",value:function(t){t=Math.max(Math.min(t,100),0),this.displayedSeekBarPercentage!==t&&(this.displayedSeekBarPercentage=t,this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition"),this.$seekBarPosition.css({width:"".concat(t,"%")}),this.$seekBarScrubber.css({left:"".concat(t,"%")}))}},{key:"seekRelative",value:function(t){if(this.settings.seekEnabled){var g=this.container.getCurrentTime(),b=this.container.getDuration(),P=Math.min(Math.max(g+t,0),b);P=Math.min(P*100/b,100),this.container.seekPercentage(P)}}},{key:"bindKeyAndShow",value:function(t,g){var b=this;this.kibo.down(t,function(){return b.show(),g()})}},{key:"bindKeyEvents",value:function(){var t=this;if(!(de.isMobile||this.options.disableKeyboardShortcuts)){this.unbindKeyEvents(),this.kibo=new ce(this.options.focusElement||this.options.parentElement),this.bindKeyAndShow("space",function(){return t.togglePlayPause()}),this.bindKeyAndShow("left",function(){return t.seekRelative(-5)}),this.bindKeyAndShow("right",function(){return t.seekRelative(5)}),this.bindKeyAndShow("shift left",function(){return t.seekRelative(-10)}),this.bindKeyAndShow("shift right",function(){return t.seekRelative(10)}),this.bindKeyAndShow("shift ctrl left",function(){return t.seekRelative(-15)}),this.bindKeyAndShow("shift ctrl right",function(){return t.seekRelative(15)});var g=["1","2","3","4","5","6","7","8","9","0"];g.forEach(function(b){t.bindKeyAndShow(b,function(){t.settings.seekEnabled&&t.container&&t.container.seekPercentage(b*10)})})}}},{key:"unbindKeyEvents",value:function(){this.kibo&&(this.kibo.off("space"),this.kibo.off("left"),this.kibo.off("right"),this.kibo.off("shift left"),this.kibo.off("shift right"),this.kibo.off("shift ctrl left"),this.kibo.off("shift ctrl right"),this.kibo.off(["1","2","3","4","5","6","7","8","9","0"]))}},{key:"parseColors",value:function(){if(this.options.mediacontrol){this.buttonsColor=this.options.mediacontrol.buttons;var t=this.options.mediacontrol.seekbar;this.$el.find(".bar-fill-2[data-seekbar]").css("background-color",t),this.$el.find(".media-control-icon svg path").css("fill",this.buttonsColor),this.$el.find(".segmented-bar-element[data-volume]").css("boxShadow","inset 2px 0 0 "+this.buttonsColor)}}},{key:"applyButtonStyle",value:function(t){this.buttonsColor&&t&&ve(t).find("svg path").css("fill",this.buttonsColor)}},{key:"destroy",value:function(){ve(document).unbind("mouseup",this.stopDragHandler),ve(document).unbind("mousemove",this.updateDragHandler),this.unbindKeyEvents(),this.stopListening(),fr(kt(i.prototype),"destroy",this).call(this)}},{key:"configure",value:function(t){this.options.chromeless||t.source||t.sources?this.disable():this.enable(),this.trigger(G.MEDIACONTROL_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=this,g=this.options.hideMediaControlDelay||2e3;this.settings&&this.$el.html(this.template({settings:this.settings}));var b=ze.getStyleFor(Cf,{baseUrl:this.options.baseUrl});this.$el.append(b[0]),this.createCachedElements(),this.$playPauseToggle.addClass("paused"),this.$playStopToggle.addClass("stopped"),this.changeTogglePlay(),this.container&&(this.hideId=setTimeout(function(){return t.hide()},g),this.disabled&&this.hide()),de.isSafari&&de.isMobile&&(de.version<10?this.$volumeContainer.css("display","none"):this.$volumeBarContainer.css("display","none")),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition");var P=0;return this.displayedSeekBarPercentage&&(P=this.displayedSeekBarPercentage),this.displayedSeekBarPercentage=null,this.setSeekPercentage(P),setTimeout(function(){!t.settings.seekEnabled&&t.$seekBarContainer.addClass("seek-disabled"),!de.isMobile&&!t.options.disableKeyboardShortcuts&&t.bindKeyEvents(),t.playerResize({width:t.options.width,height:t.options.height}),t.hideVolumeBar(0)},0),this.parseColors(),this.highDefinitionUpdate(this.isHD),this.core.$el.append(this.el),this.rendered=!0,this.updateVolumeUI(),this.trigger(G.MEDIACONTROL_RENDERED),this}}]),i}(yt);ii.extend=function(e){return Pf(ii,e)};var Rf=`<div class="play-wrapper" data-poster></div>
`,kf=`.player-poster[data-poster] {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  height: 100%;
  width: 100%;
  z-index: 998;
  top: 0;
  left: 0;
  background-color: transparent;
  background-size: cover;
  background-repeat: no-repeat;
  background-position: 50% 50%; }
  .player-poster[data-poster].clickable {
    cursor: pointer; }
  .player-poster[data-poster]:hover .play-wrapper[data-poster] {
    opacity: 1; }
  .player-poster[data-poster] .play-wrapper[data-poster] {
    width: 100%;
    height: 25%;
    margin: 0 auto;
    opacity: 0.75;
    transition: opacity 0.1s ease; }
    .player-poster[data-poster] .play-wrapper[data-poster] svg {
      height: 100%; }
      .player-poster[data-poster] .play-wrapper[data-poster] svg path {
        fill: #fff; }
`,Mf=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.hasStartedPlaying=!1,t.playRequested=!1,t.render(),setTimeout(function(){return t.update()},0),t}return Je(i,[{key:"name",get:function(){return"poster"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(Rf)}},{key:"shouldRender",get:function(){var t=!!(this.options.poster&&this.options.poster.showForNoOp);return this.container.playback.name!=="html_img"&&(this.container.playback.getPlaybackType()!==me.NO_OP||t)}},{key:"attributes",get:function(){return{class:"player-poster","data-poster":""}}},{key:"events",get:function(){return{click:"clicked"}}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||this.options.poster.showOnVideoEnd===void 0}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.update),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.update),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.render),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.showOnVideoEnd&&this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop)}},{key:"onError",value:function(t){this.hasFatalError=t.level===ot.Levels.FATAL,this.hasFatalError&&(this.hasStartedPlaying=!1,this.playRequested=!1,this.showPlayButton())}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"updatePlayButton",value:function(t){t&&(!this.options.chromeless||this.options.allowUserInteraction)?this.showPlayButton():this.hidePlayButton()}},{key:"showPlayButton",value:function(){this.hasFatalError&&!this.options.disableErrorScreen||(this.$playButton.show(),this.$el.addClass("clickable"))}},{key:"hidePlayButton",value:function(){this.$playButton.hide(),this.$el.removeClass("clickable")}},{key:"clicked",value:function(){if(!this.hasStartedPlaying)return(!this.options.chromeless||this.options.allowUserInteraction)&&(this.playRequested=!0,this.update(),this.container.playback&&(this.container.playback._consented=!0),this.container.play()),!1}},{key:"shouldHideOnPlay",value:function(){return!this.container.playback.isAudioOnly}},{key:"update",value:function(){if(this.shouldRender){var t=!this.playRequested&&!this.hasStartedPlaying&&!this.container.buffering;this.updatePlayButton(t),this.updatePoster()}}},{key:"updatePoster",value:function(){this.hasStartedPlaying?this.hidePoster():this.showPoster()}},{key:"showPoster",value:function(){this.container.disableMediaControl(),this.$el.show()}},{key:"hidePoster",value:function(){this.container.enableMediaControl(),this.shouldHideOnPlay()&&this.$el.hide()}},{key:"render",value:function(){if(this.shouldRender){var t=ze.getStyleFor(kf,{baseUrl:this.options.baseUrl});this.$el.html(this.template()),this.$el.append(t[0]);var g=this.options.poster&&this.options.poster.custom===void 0;if(g){var b=this.options.poster.url||this.options.poster;this.$el.css({"background-image":"url("+b+")"}),this.removeVideoElementPoster()}else this.options.poster&&(this.$el.css({background:this.options.poster.custom}),this.removeVideoElementPoster());this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(Xt),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var P=this.options.mediacontrol&&this.options.mediacontrol.buttons;return P&&this.$el.find("svg path").css("fill",P),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(P=this.options.mediacontrol.buttons,this.$playButton.css("color",P)),this.update(),this}}},{key:"removeVideoElementPoster",value:function(){this.container.playback&&this.container.playback.$el&&this.container.playback.$el[0]&&this.container.playback.$el[0].removeAttribute&&this.container.playback.$el[0].removeAttribute("poster")}}]),i}(rr),wf=`<span data-seek-time></span>
<span data-duration></span>
`,Nf=`.seek-time[data-seek-time] {
  position: absolute;
  white-space: nowrap;
  height: 20px;
  line-height: 20px;
  font-size: 0;
  left: -100%;
  bottom: 55px;
  background-color: rgba(2, 2, 2, 0.5);
  z-index: 9999;
  transition: opacity 0.1s ease; }
  .seek-time[data-seek-time].hidden[data-seek-time] {
    opacity: 0; }
  .seek-time[data-seek-time] [data-seek-time] {
    display: inline-block;
    color: white;
    font-size: 10px;
    padding-left: 7px;
    padding-right: 7px;
    vertical-align: top; }
  .seek-time[data-seek-time] [data-duration] {
    display: inline-block;
    color: rgba(255, 255, 255, 0.5);
    font-size: 10px;
    padding-right: 7px;
    vertical-align: top; }
    .seek-time[data-seek-time] [data-duration]:before {
      content: "|";
      margin-right: 7px; }
`,Pa=Bt.formatTime,Ff=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.hoveringOverSeekBar=!1,t.hoverPosition=null,t.duration=null,t.firstFragDateTime=null,t.actualLiveTime=!!t.mediaControl.options.actualLiveTime,t.actualLiveTime&&(t.mediaControl.options.actualLiveServerTime?t.actualLiveServerTimeDiff=new Date().getTime()-new Date(t.mediaControl.options.actualLiveServerTime).getTime():t.actualLiveServerTimeDiff=0),t}return Je(i,[{key:"name",get:function(){return"seek_time"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(wf)}},{key:"attributes",get:function(){return{class:"seek-time","data-seek-time":""}}},{key:"mediaControl",get:function(){return this.core.mediaControl}},{key:"mediaControlContainer",get:function(){return this.mediaControl.container}},{key:"isLiveStreamWithDvr",get:function(){return this.mediaControlContainer&&this.mediaControlContainer.getPlaybackType()===me.LIVE&&this.mediaControlContainer.isDvrEnabled()}},{key:"durationShown",get:function(){return this.isLiveStreamWithDvr&&!this.actualLiveTime}},{key:"useActualLiveTime",get:function(){return this.actualLiveTime&&this.isLiveStreamWithDvr}},{key:"bindEvents",value:function(){this.listenTo(this.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.showTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.hideTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged),this.mediaControlContainer&&(this.listenTo(this.mediaControlContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.update),this.listenTo(this.mediaControlContainer,G.CONTAINER_TIMEUPDATE,this.updateDuration))}},{key:"onContainerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"updateDuration",value:function(t){this.duration=t.total,this.firstFragDateTime=t.firstFragDateTime,this.update()}},{key:"showTime",value:function(t){this.hoveringOverSeekBar=!0,this.calculateHoverPosition(t),this.update()}},{key:"hideTime",value:function(){this.hoveringOverSeekBar=!1,this.update()}},{key:"calculateHoverPosition",value:function(t){var g=t.pageX-this.mediaControl.$seekBarContainer.offset().left;this.hoverPosition=Math.min(1,Math.max(g/this.mediaControl.$seekBarContainer.width(),0))}},{key:"getSeekTime",value:function(){var t,g,b,P;return this.useActualLiveTime?(this.firstFragDateTime?(P=new Date(this.firstFragDateTime),b=new Date(this.firstFragDateTime),b.setHours(0,0,0,0),g=(P.getTime()-b.getTime())/1e3+this.duration):(b=new Date(new Date().getTime()-this.actualLiveServerTimeDiff),P=new Date(b),g=(P-b.setHours(0,0,0,0))/1e3),t=g-this.duration+this.hoverPosition*this.duration,t<0&&(t+=86400)):t=this.hoverPosition*this.duration,{seekTime:t,secondsSinceMidnight:g}}},{key:"update",value:function(){if(this.rendered)if(!this.shouldBeVisible())this.$el.hide(),this.$el.css("left","-100%");else{var t=this.getSeekTime(),g=Pa(t.seekTime,this.useActualLiveTime);if(g!==this.displayedSeekTime&&(this.$seekTimeEl.text(g),this.displayedSeekTime=g),this.durationShown){this.$durationEl.show();var b=Pa(this.actualLiveTime?t.secondsSinceMidnight:this.duration,this.actualLiveTime);b!==this.displayedDuration&&(this.$durationEl.text(b),this.displayedDuration=b)}else this.$durationEl.hide();this.$el.show();var P=this.mediaControl.$seekBarContainer.width(),m=this.$el.width(),N=this.hoverPosition*P;N-=m/2,N=Math.max(0,Math.min(N,P-m)),this.$el.css("left",N)}}},{key:"shouldBeVisible",value:function(){return this.mediaControlContainer&&this.mediaControlContainer.settings.seekEnabled&&this.hoveringOverSeekBar&&this.hoverPosition!==null&&this.duration!==null}},{key:"render",value:function(){var t=ze.getStyleFor(Nf,{baseUrl:this.options.baseUrl});this.rendered=!0,this.displayedDuration=null,this.displayedSeekTime=null,this.$el.html(this.template()),this.$el.append(t[0]),this.$el.hide(),this.mediaControl.$el.append(this.el),this.$seekTimeEl=this.$el.find("[data-seek-time]"),this.$durationEl=this.$el.find("[data-duration]"),this.$durationEl.hide(),this.update()}}]),i}(yt),Bf=`<div data-bounce1></div><div data-bounce2></div><div data-bounce3></div>
`,Uf=`.spinner-three-bounce[data-spinner] {
  position: absolute;
  margin: 0 auto;
  width: 70px;
  text-align: center;
  z-index: 999;
  left: 0;
  right: 0;
  margin-left: auto;
  margin-right: auto;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%); }
  .spinner-three-bounce[data-spinner] > div {
    width: 18px;
    height: 18px;
    background-color: #FFFFFF;
    border-radius: 100%;
    display: inline-block;
    animation: bouncedelay 1.4s infinite ease-in-out;
    /* Prevent first frame from flickering when animation starts */
    animation-fill-mode: both; }
  .spinner-three-bounce[data-spinner] [data-bounce1] {
    animation-delay: -0.32s; }
  .spinner-three-bounce[data-spinner] [data-bounce2] {
    animation-delay: -0.16s; }

@keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0); }
  40% {
    transform: scale(1); } }
`,Ra=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.template=nt(Bf),t.showTimeout=null,t.listenTo(t.container,G.CONTAINER_STATE_BUFFERING,t.onBuffering),t.listenTo(t.container,G.CONTAINER_STATE_BUFFERFULL,t.onBufferFull),t.listenTo(t.container,G.CONTAINER_STOP,t.onStop),t.listenTo(t.container,G.CONTAINER_ENDED,t.onStop),t.listenTo(t.container,G.CONTAINER_ERROR,t.onStop),t.render(),t}return Je(i,[{key:"name",get:function(){return"spinner"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"attributes",get:function(){return{"data-spinner":"",class:"spinner-three-bounce"}}},{key:"onBuffering",value:function(){this.show()}},{key:"onBufferFull",value:function(){this.hide()}},{key:"onStop",value:function(){this.hide()}},{key:"show",value:function(){var t=this;this.showTimeout===null&&(this.showTimeout=setTimeout(function(){return t.$el.show()},300))}},{key:"hide",value:function(){this.showTimeout!==null&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.$el.hide()}},{key:"render",value:function(){var t=ze.getStyleFor(Uf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template()),this.$el.append(t[0]),this.container.$el.append(this.$el),this.$el.hide(),this.container.buffering&&this.onBuffering(),this}}]),i}(rr),ka=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.setInitialAttrs(),t.reportInterval=t.options.reportInterval||5e3,t.state="IDLE",t}return Je(i,[{key:"name",get:function(){return"stats"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.container.playback,G.PLAYBACK_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop),this.listenTo(this.container,G.CONTAINER_DESTROYED,this.onStop),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_STATS_ADD,this.onStatsAdd),this.listenTo(this.container,G.CONTAINER_BITRATE,this.onStatsAdd),this.listenTo(this.container.playback,G.PLAYBACK_STATS_ADD,this.onStatsAdd)}},{key:"setInitialAttrs",value:function(){this.firstPlay=!0,this.startupTime=0,this.rebufferingTime=0,this.watchingTime=0,this.rebuffers=0,this.externalMetrics={}}},{key:"onPlay",value:function(){this.state="PLAYING",this.watchingTimeInit=Date.now(),this.intervalId||(this.intervalId=setInterval(this.report.bind(this),this.reportInterval))}},{key:"onStop",value:function(){clearInterval(this.intervalId),this.report(),this.intervalId=void 0,this.state="STOPPED"}},{key:"onBuffering",value:function(){this.firstPlay?this.startupTimeInit=Date.now():this.rebufferingTimeInit=Date.now(),this.state="BUFFERING",this.rebuffers++}},{key:"onBufferFull",value:function(){this.firstPlay&&this.startupTimeInit?(this.firstPlay=!1,this.startupTime=Date.now()-this.startupTimeInit,this.watchingTimeInit=Date.now()):this.rebufferingTimeInit&&(this.rebufferingTime+=this.getRebufferingTime()),this.rebufferingTimeInit=void 0,this.state="PLAYING"}},{key:"getRebufferingTime",value:function(){return Date.now()-this.rebufferingTimeInit}},{key:"getWatchingTime",value:function(){var t=Date.now()-this.watchingTimeInit;return t-this.rebufferingTime}},{key:"isRebuffering",value:function(){return!!this.rebufferingTimeInit}},{key:"onStatsAdd",value:function(t){ve.extend(this.externalMetrics,t)}},{key:"getStats",value:function(){var t={startupTime:this.startupTime,rebuffers:this.rebuffers,rebufferingTime:this.isRebuffering()?this.rebufferingTime+this.getRebufferingTime():this.rebufferingTime,watchingTime:this.isRebuffering()?this.getWatchingTime()-this.getRebufferingTime():this.getWatchingTime()};return ve.extend(t,this.externalMetrics),t}},{key:"report",value:function(){this.container.statsReport(this.getStats())}}]),i}(tr),Kf=`<div class="clappr-watermark" data-watermark data-watermark-<%=position %>>
<% if(typeof imageLink !== 'undefined') { %>
<a target="_blank" href="<%= imageLink %>">
<% } %>
<img src="<%= imageUrl %>">
<% if(typeof imageLink !== 'undefined') { %>
</a>
<% } %>
</div>
`,Wf=`.clappr-watermark[data-watermark] {
  position: absolute;
  min-width: 70px;
  max-width: 200px;
  width: 12%;
  text-align: center;
  z-index: 10; }

.clappr-watermark[data-watermark] a {
  outline: none;
  cursor: pointer; }

.clappr-watermark[data-watermark] img {
  max-width: 100%; }

.clappr-watermark[data-watermark-bottom-left] {
  bottom: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-bottom-right] {
  bottom: 10px;
  right: 42px; }

.clappr-watermark[data-watermark-top-left] {
  top: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-top-right] {
  top: 10px;
  right: 37px; }
`,Ma=function(e){qe(i,e);var n=et(i);function i(r){var t;return Ze(this,i),t=n.call(this,r),t.configure(),t}return Je(i,[{key:"name",get:function(){return"watermark"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return nt(Kf)}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.configure)}},{key:"configure",value:function(){this.position=this.options.position||"bottom-right",this.options.watermark?(this.imageUrl=this.options.watermark,this.imageLink=this.options.watermarkLink,this.render()):this.$el.remove()}},{key:"onPlay",value:function(){this.hidden||this.$el.show()}},{key:"onStop",value:function(){this.$el.hide()}},{key:"render",value:function(){this.$el.hide();var t=ze.getStyleFor(Wf,{baseUrl:this.options.baseUrl}),g={position:this.position,imageUrl:this.imageUrl,imageLink:this.imageLink};return this.$el.html(this.template(g)),this.$el.append(t[0]),this.container.$el.append(this.$el),this}}]),i}(rr);function wa(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function Bn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?wa(Object(i),!0).forEach(function(r){Hf(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wa(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Vf(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Na(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ro(r.key),r)}}function Gf(e,n,i){return n&&Na(e.prototype,n),i&&Na(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hf(e,n,i){return n=ro(n),n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function jf(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ai(e,n)}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},gt(e)}function ai(e,n){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ai(e,n)}function Yf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $f(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zf(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $f(e)}function Xf(e){var n=Yf();return function(){var r=gt(e),t;if(n){var g=gt(this).constructor;t=Reflect.construct(r,arguments,g)}else t=r.apply(this,arguments);return zf(this,t)}}function Qf(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=gt(e),e!==null););return e}function Dt(){return typeof Reflect<"u"&&Reflect.get?Dt=Reflect.get.bind():Dt=function(n,i,r){var t=Qf(n,i);if(t){var g=Object.getOwnPropertyDescriptor(t,i);return g.get?g.get.call(arguments.length<3?n:r):g.value}},Dt.apply(this,arguments)}function Zf(e){return Jf(e)||qf(e)||ed(e)||td()}function Jf(e){if(Array.isArray(e))return si(e)}function qf(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ed(e,n){if(e){if(typeof e=="string")return si(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return si(e,n)}}function si(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function td(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rd(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function ro(e){var n=rd(e,"string");return typeof n=="symbol"?n:String(n)}var nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function id(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var no={exports:{}};(function(e,n){typeof window<"u"&&function(r,t){e.exports=t()}(nd,()=>(()=>{var i={"./src/config.ts":(b,P,m)=>{m.r(P),m.d(P,{enableStreamingMode:()=>_,hlsDefaultConfig:()=>s,mergeConfig:()=>p});var N=m("./src/controller/abr-controller.ts"),S=m("./src/controller/audio-stream-controller.ts"),F=m("./src/controller/audio-track-controller.ts"),M=m("./src/controller/subtitle-stream-controller.ts"),K=m("./src/controller/subtitle-track-controller.ts"),w=m("./src/controller/buffer-controller.ts"),I=m("./src/controller/timeline-controller.ts"),k=m("./src/controller/cap-level-controller.ts"),x=m("./src/controller/fps-controller.ts"),L=m("./src/controller/eme-controller.ts"),R=m("./src/controller/cmcd-controller.ts"),O=m("./src/utils/xhr-loader.ts"),C=m("./src/utils/fetch-loader.ts"),y=m("./src/utils/cues.ts"),u=m("./src/utils/mediakeys-helper.ts"),l=m("./src/utils/logger.ts");function c(){return c=Object.assign?Object.assign.bind():function(h){for(var A=1;A<arguments.length;A++){var E=arguments[A];for(var v in E)Object.prototype.hasOwnProperty.call(E,v)&&(h[v]=E[v])}return h},c.apply(this,arguments)}function f(h,A){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(h);A&&(v=v.filter(function(T){return Object.getOwnPropertyDescriptor(h,T).enumerable})),E.push.apply(E,v)}return E}function o(h){for(var A=1;A<arguments.length;A++){var E=arguments[A]!=null?arguments[A]:{};A%2?f(Object(E),!0).forEach(function(v){a(h,v,E[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):f(Object(E)).forEach(function(v){Object.defineProperty(h,v,Object.getOwnPropertyDescriptor(E,v))})}return h}function a(h,A,E){return A in h?Object.defineProperty(h,A,{value:E,enumerable:!0,configurable:!0,writable:!0}):h[A]=E,h}var s=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:O.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:N.default,bufferController:w.default,capLevelController:k.default,fpsController:x.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:u.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},d()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:K.default,timelineController:I.TimelineController,audioStreamController:S.default,audioTrackController:F.default,emeController:L.default,cmcdController:R.default});function d(){return{cueHandler:y.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function p(h,A){if((A.liveSyncDurationCount||A.liveMaxLatencyDurationCount)&&(A.liveSyncDuration||A.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(A.liveMaxLatencyDurationCount!==void 0&&(A.liveSyncDurationCount===void 0||A.liveMaxLatencyDurationCount<=A.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(A.liveMaxLatencyDuration!==void 0&&(A.liveSyncDuration===void 0||A.liveMaxLatencyDuration<=A.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return c({},h,A)}function _(h){var A=h.loader;if(A!==C.default&&A!==O.default)l.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),h.progressive=!1;else{var E=(0,C.fetchSupported)();E&&(h.loader=C.default,h.progressive=!0,h.enableSoftwareAES=!0,l.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>L});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/ewma-bandwidth-estimator.ts"),F=m("./src/events.ts"),M=m("./src/errors.ts"),K=m("./src/types/loader.ts"),w=m("./src/utils/logger.ts");function I(R,O){for(var C=0;C<O.length;C++){var y=O[C];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}function k(R,O,C){return O&&I(R.prototype,O),C&&I(R,C),Object.defineProperty(R,"prototype",{writable:!1}),R}var x=function(){function R(C){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=C;var y=C.config;this.bwEstimator=new S.default(y.abrEwmaSlowVoD,y.abrEwmaFastVoD,y.abrEwmaDefaultEstimate),this.registerListeners()}var O=R.prototype;return O.registerListeners=function(){var y=this.hls;y.on(F.Events.FRAG_LOADING,this.onFragLoading,this),y.on(F.Events.FRAG_LOADED,this.onFragLoaded,this),y.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.on(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.on(F.Events.ERROR,this.onError,this)},O.unregisterListeners=function(){var y=this.hls;y.off(F.Events.FRAG_LOADING,this.onFragLoading,this),y.off(F.Events.FRAG_LOADED,this.onFragLoaded,this),y.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.off(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.off(F.Events.ERROR,this.onError,this)},O.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},O.onFragLoading=function(y,u){var l=u.frag;if(l.type===K.PlaylistLevelType.MAIN&&!this.timer){var c;this.fragCurrent=l,this.partCurrent=(c=u.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)}},O.onLevelLoaded=function(y,u){var l=this.hls.config;u.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},O._abandonRulesCheck=function(){var y=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.autoLevelEnabled;l.config;var f=l.media;if(!(!y||!f)){var o=u?u.stats:y.stats,a=u?u.duration:y.duration;if(o.aborted||o.loaded&&o.loaded===o.total||y.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!c||f.paused||!f.playbackRate||!f.readyState)){var s=l.mainForwardBufferInfo;if(s!==null){var d=performance.now()-o.loading.start,p=Math.abs(f.playbackRate);if(!(d<=500*a/p)){var _=o.loaded&&o.loading.first,h=this.bwEstimator.getEstimate(),A=l.levels,E=l.minAutoLevel,v=A[y.level],T=o.total||Math.max(o.loaded,Math.round(a*v.maxBitrate/8)),D=_?o.loaded*1e3/d:0,B=D?(T-o.loaded)/D:T*8/h,V=s.len/p;if(!(B<=V)){var W=Number.POSITIVE_INFINITY,j;for(j=y.level-1;j>E;j--){var $=A[j].maxBitrate;if(W=D?a*$/(8*.8*D):a*$/h,W<V)break}W>=B||(w.logger.warn("Fragment "+y.sn+(u?" part "+u.index:"")+" of level "+y.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+j+`
      Current BW estimate: `+((0,N.isFiniteNumber)(h)?(h/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+B.toFixed(3)+` s
      Estimated load time for the next fragment: `+W.toFixed(3)+` s
      Time to underbuffer: `+V.toFixed(3)+" s"),l.nextLoadLevel=j,_&&this.bwEstimator.sample(d,o.loaded),this.clearTimer(),y.loader&&(this.fragCurrent=this.partCurrent=null,y.loader.abort()),l.trigger(F.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:y,part:u,stats:o}))}}}}}},O.onFragLoaded=function(y,u){var l=u.frag,c=u.part;if(l.type===K.PlaylistLevelType.MAIN&&(0,N.isFiniteNumber)(l.sn)){var f=c?c.stats:l.stats,o=c?c.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[l.level],s=(a.loaded?a.loaded.bytes:0)+f.loaded,d=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:s,duration:d},a.realBitrate=Math.round(8*s/d)}if(l.bitrateTest){var p={stats:f,frag:l,part:c,id:l.type};this.onFragBuffered(F.Events.FRAG_BUFFERED,p)}}},O.onFragBuffered=function(y,u){var l=u.frag,c=u.part,f=c?c.stats:l.stats;if(!f.aborted&&!(l.type!==K.PlaylistLevelType.MAIN||l.sn==="initSegment")){var o=f.parsing.end-f.loading.start;this.bwEstimator.sample(o,f.loaded),f.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},O.onError=function(y,u){switch(u.details){case M.ErrorDetails.FRAG_LOAD_ERROR:case M.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},O.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},O.getNextABRAutoLevel=function(){var y=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.maxAutoLevel,f=l.config,o=l.minAutoLevel,a=l.media,s=u?u.duration:y?y.duration:0;a&&a.currentTime;var d=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,p=this.bwEstimator?this.bwEstimator.getEstimate():f.abrEwmaDefaultEstimate,_=l.mainForwardBufferInfo,h=(_?_.len:0)/d,A=this.findBestLevel(p,o,c,h,f.abrBandWidthFactor,f.abrBandWidthUpFactor);if(A>=0)return A;w.logger.trace((h?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var E=s?Math.min(s,f.maxStarvationDelay):f.maxStarvationDelay,v=f.abrBandWidthFactor,T=f.abrBandWidthUpFactor;if(!h){var D=this.bitrateTestDelay;if(D){var B=s?Math.min(s,f.maxLoadingDelay):f.maxLoadingDelay;E=B-D,w.logger.trace("bitrate test took "+Math.round(1e3*D)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*E)+" ms"),v=T=1}}return A=this.findBestLevel(p,o,c,h+E,v,T),Math.max(A,0)},O.findBestLevel=function(y,u,l,c,f,o){for(var a,s=this.fragCurrent,d=this.partCurrent,p=this.lastLoadedFragLevel,_=this.hls.levels,h=_[p],A=!!(h!=null&&(a=h.details)!==null&&a!==void 0&&a.live),E=h==null?void 0:h.codecSet,v=d?d.duration:s?s.duration:0,T=l;T>=u;T--){var D=_[T];if(!(!D||E&&D.codecSet!==E)){var B=D.details,V=(d?B==null?void 0:B.partTarget:B==null?void 0:B.averagetargetduration)||v,W=void 0;T<=p?W=f*y:W=o*y;var j=_[T].maxBitrate,$=j*V/W;if(w.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+T+"/"+Math.round(W)+"/"+j+"/"+V+"/"+c+"/"+$),W>j&&($===0||!(0,N.isFiniteNumber)($)||A&&!this.bitrateTestDelay||$<c))return T}}return-1},k(R,[{key:"nextAutoLevel",get:function(){var y=this._nextAutoLevel,u=this.bwEstimator;if(y!==-1&&!u.canEstimate())return y;var l=this.getNextABRAutoLevel();return y!==-1&&this.hls.levels[l].loadError?y:(y!==-1&&(l=Math.min(y,l)),l)},set:function(y){this._nextAutoLevel=y}}]),R}();const L=x},"./src/controller/audio-stream-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>a});var N=m("./src/polyfills/number.ts"),S=m("./src/controller/base-stream-controller.ts"),F=m("./src/events.ts"),M=m("./src/utils/buffer-helper.ts"),K=m("./src/controller/fragment-tracker.ts"),w=m("./src/types/level.ts"),I=m("./src/types/loader.ts"),k=m("./src/loader/fragment.ts"),x=m("./src/demux/chunk-cache.ts"),L=m("./src/demux/transmuxer-interface.ts"),R=m("./src/types/transmuxer.ts"),O=m("./src/controller/fragment-finders.ts"),C=m("./src/utils/discontinuities.ts"),y=m("./src/errors.ts");function u(){return u=Object.assign?Object.assign.bind():function(s){for(var d=1;d<arguments.length;d++){var p=arguments[d];for(var _ in p)Object.prototype.hasOwnProperty.call(p,_)&&(s[_]=p[_])}return s},u.apply(this,arguments)}function l(s,d){s.prototype=Object.create(d.prototype),s.prototype.constructor=s,c(s,d)}function c(s,d){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,h){return _.__proto__=h,_},c(s,d)}var f=100,o=function(s){l(d,s);function d(_,h){var A;return A=s.call(this,_,h,"[audio-stream-controller]")||this,A.videoBuffer=null,A.videoTrackCC=-1,A.waitingVideoCC=-1,A.audioSwitch=!1,A.trackId=-1,A.waitingData=null,A.mainDetails=null,A.bufferFlushed=!1,A.cachedTrackLoadedData=null,A._registerListeners(),A}var p=d.prototype;return p.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},p._registerListeners=function(){var h=this.hls;h.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.on(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.on(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.on(F.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),h.on(F.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.on(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.on(F.Events.ERROR,this.onError,this),h.on(F.Events.BUFFER_RESET,this.onBufferReset,this),h.on(F.Events.BUFFER_CREATED,this.onBufferCreated,this),h.on(F.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.on(F.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),h.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},p._unregisterListeners=function(){var h=this.hls;h.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.off(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.off(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.off(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),h.off(F.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),h.off(F.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),h.off(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.off(F.Events.ERROR,this.onError,this),h.off(F.Events.BUFFER_RESET,this.onBufferReset,this),h.off(F.Events.BUFFER_CREATED,this.onBufferCreated,this),h.off(F.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),h.off(F.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),h.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},p.onInitPtsFound=function(h,A){var E=A.frag,v=A.id,T=A.initPTS;if(v==="main"){var D=E.cc;this.initPTS[E.cc]=T,this.log("InitPTS for cc: "+D+" found from main: "+T),this.videoTrackCC=D,this.state===S.State.WAITING_INIT_PTS&&this.tick()}},p.startLoad=function(h){if(!this.levels){this.startPosition=h,this.state=S.State.STOPPED;return}var A=this.lastCurrentTime;this.stopLoad(),this.setInterval(f),this.fragLoadError=0,A>0&&h===-1?(this.log("Override startPosition with lastCurrentTime @"+A.toFixed(3)),h=A,this.state=S.State.IDLE):(this.loadedmetadata=!1,this.state=S.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=h,this.tick()},p.doTick=function(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_TRACK:{var h,A=this.levels,E=this.trackId,v=A==null||(h=A[E])===null||h===void 0?void 0:h.details;if(v){if(this.waitForCdnTuneIn(v))break;this.state=S.State.WAITING_INIT_PTS}break}case S.State.FRAG_LOADING_WAITING_RETRY:{var T,D=performance.now(),B=this.retryDate;(!B||D>=B||(T=this.media)!==null&&T!==void 0&&T.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=S.State.IDLE);break}case S.State.WAITING_INIT_PTS:{var V=this.waitingData;if(V){var W=V.frag,j=V.part,$=V.cache,Q=V.complete;if(this.initPTS[W.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.FRAG_LOADING;var Z=$.flush(),ee={frag:W,part:j,payload:Z,networkDetails:null};this._handleFragmentLoadProgress(ee),Q&&s.prototype._handleFragmentLoadComplete.call(this,ee)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+W.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var ae=this.getLoadPosition(),se=M.BufferHelper.bufferInfo(this.mediaBuffer,ae,this.config.maxBufferHole),Y=(0,O.fragmentWithinToleranceTest)(se.end,this.config.maxFragLookUpTolerance,W);Y<0&&(this.log("Waiting fragment cc ("+W.cc+") @ "+W.start+" cancelled because another fragment at "+se.end+" is needed"),this.clearWaitingFragment())}}else this.state=S.State.IDLE}}this.onTickEnd()},p.clearWaitingFragment=function(){var h=this.waitingData;h&&(this.fragmentTracker.removeFragment(h.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.IDLE)},p.resetLoadingState=function(){this.clearWaitingFragment(),s.prototype.resetLoadingState.call(this)},p.onTickEnd=function(){var h=this.media;!h||!h.readyState||(this.lastCurrentTime=h.currentTime)},p.doTickIdle=function(){var h,A,E=this.hls,v=this.levels,T=this.media,D=this.trackId,B=E.config;if(!(!v||!v[D])&&!(!T&&(this.startFragRequested||!B.startFragPrefetch))){var V=v[D],W=V.details;if(!W||W.live&&this.levelLastLoaded!==D||this.waitForCdnTuneIn(W)){this.state=S.State.WAITING_TRACK;return}var j=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&j&&(this.bufferFlushed=!1,this.afterBufferFlushed(j,k.ElementaryStreamTypes.AUDIO,I.PlaylistLevelType.AUDIO));var $=this.getFwdBufferInfo(j,I.PlaylistLevelType.AUDIO);if($!==null){var Q=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,I.PlaylistLevelType.MAIN),Z=$.len,ee=this.getMaxBufferLength(Q==null?void 0:Q.len),ae=this.audioSwitch;if(!(Z>=ee&&!ae)){if(!ae&&this._streamEnded($,W)){E.trigger(F.Events.BUFFER_EOS,{type:"audio"}),this.state=S.State.ENDED;return}var se=W.fragments,Y=se[0].start,X=$.end;if(ae&&T){var q=this.getLoadPosition();X=q,W.PTSKnown&&q<Y&&($.end>Y||$.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),T.currentTime=Y+.05)}if(!(Q&&X>Q.end+W.targetduration)&&!((!Q||!Q.len)&&$.len)){var re=this.getNextFragment(X,W);if(!re){this.bufferFlushed=!0;return}((h=re.decryptdata)===null||h===void 0?void 0:h.keyFormat)==="identity"&&!((A=re.decryptdata)!==null&&A!==void 0&&A.key)?this.loadKey(re,W):this.loadFragment(re,W,X)}}}}},p.getMaxBufferLength=function(h){var A=s.prototype.getMaxBufferLength.call(this);return h?Math.max(A,h):A},p.onMediaDetaching=function(){this.videoBuffer=null,s.prototype.onMediaDetaching.call(this)},p.onAudioTracksUpdated=function(h,A){var E=A.audioTracks;this.resetTransmuxer(),this.levels=E.map(function(v){return new w.Level(v)})},p.onAudioTrackSwitching=function(h,A){var E=!!A.url;this.trackId=A.id;var v=this.fragCurrent;v!=null&&v.loader&&v.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),E?this.setInterval(f):this.resetTransmuxer(),E?(this.audioSwitch=!0,this.state=S.State.IDLE):this.state=S.State.STOPPED,this.tick()},p.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},p.onLevelLoaded=function(h,A){this.mainDetails=A.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(F.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},p.onAudioTrackLoaded=function(h,A){var E;if(this.mainDetails==null){this.cachedTrackLoadedData=A;return}var v=this.levels,T=A.details,D=A.id;if(!v){this.warn("Audio tracks were reset while loading level "+D);return}this.log("Track "+D+" loaded ["+T.startSN+","+T.endSN+"],duration:"+T.totalduration);var B=v[D],V=0;if(T.live||(E=B.details)!==null&&E!==void 0&&E.live){var W=this.mainDetails;if(T.fragments[0]||(T.deltaUpdateFailed=!0),T.deltaUpdateFailed||!W)return;!B.details&&T.hasProgramDateTime&&W.hasProgramDateTime?((0,C.alignMediaPlaylistByPDT)(T,W),V=T.fragments[0].start):V=this.alignPlaylists(T,B.details)}B.details=T,this.levelLastLoaded=D,!this.startFragRequested&&(this.mainDetails||!T.live)&&this.setStartPosition(B.details,V),this.state===S.State.WAITING_TRACK&&!this.waitForCdnTuneIn(T)&&(this.state=S.State.IDLE),this.tick()},p._handleFragmentLoadProgress=function(h){var A,E=h.frag,v=h.part,T=h.payload,D=this.config,B=this.trackId,V=this.levels;if(!V){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+E.sn+" of level "+E.level+" will not be buffered");return}var W=V[B];console.assert(W,"Audio track is defined on fragment load progress");var j=W.details;console.assert(j,"Audio track details are defined on fragment load progress");var $=D.defaultAudioCodec||W.audioCodec||"mp4a.40.2",Q=this.transmuxer;Q||(Q=this.transmuxer=new L.default(this.hls,I.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var Z=this.initPTS[E.cc],ee=(A=E.initSegment)===null||A===void 0?void 0:A.data;if(Z!==void 0){var ae=!1,se=v?v.index:-1,Y=se!==-1,X=new R.ChunkMetadata(E.level,E.sn,E.stats.chunkCount,T.byteLength,se,Y);Q.push(T,ee,$,"",E,v,j.totalduration,ae,X,Z)}else{this.log("Unknown video PTS for cc "+E.cc+", waiting for video PTS before demuxing audio frag "+E.sn+" of ["+j.startSN+" ,"+j.endSN+"],track "+B);var q=this.waitingData=this.waitingData||{frag:E,part:v,cache:new x.default,complete:!1},re=q.cache;re.push(new Uint8Array(T)),this.waitingVideoCC=this.videoTrackCC,this.state=S.State.WAITING_INIT_PTS}},p._handleFragmentLoadComplete=function(h){if(this.waitingData){this.waitingData.complete=!0;return}s.prototype._handleFragmentLoadComplete.call(this,h)},p.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},p.onBufferCreated=function(h,A){var E=A.tracks.audio;E&&(this.mediaBuffer=E.buffer||null),A.tracks.video&&(this.videoBuffer=A.tracks.video.buffer||null)},p.onFragBuffered=function(h,A){var E=A.frag,v=A.part;if(E.type!==I.PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&E.type===I.PlaylistLevelType.MAIN){var T;(T=this.videoBuffer||this.media)!==null&&T!==void 0&&T.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(E)){this.warn("Fragment "+E.sn+(v?" p: "+v.index:"")+" of level "+E.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}E.sn!=="initSegment"&&(this.fragPrevious=E,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(F.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(E,v)},p.onError=function(h,A){switch(A.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.AUDIO,A);break;case y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case y.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==S.State.ERROR&&this.state!==S.State.STOPPED&&(this.state=A.fatal?S.State.ERROR:S.State.IDLE,this.warn(A.details+" while loading frag, switching to "+this.state+" state"));break;case y.ErrorDetails.BUFFER_FULL_ERROR:if(A.parent==="audio"&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var E=!0,v=this.getFwdBufferInfo(this.mediaBuffer,I.PlaylistLevelType.AUDIO);v&&v.len>.5&&(E=!this.reduceMaxBufferLength(v.len)),E&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},p.onBufferFlushed=function(h,A){var E=A.type;E===k.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},p._handleTransmuxComplete=function(h){var A,E="audio",v=this.hls,T=h.remuxResult,D=h.chunkMeta,B=this.getCurrentContext(D);if(!B){this.warn("The loading context changed while buffering fragment "+D.sn+" of level "+D.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(D.level);return}var V=B.frag,W=B.part,j=B.level.details,$=T.audio,Q=T.text,Z=T.id3,ee=T.initSegment;if(!(this.fragContextChanged(V)||!j)){if(this.state=S.State.PARSING,this.audioSwitch&&$&&this.completeAudioSwitch(),ee!=null&&ee.tracks&&(this._bufferInitSegment(ee.tracks,V,D),v.trigger(F.Events.FRAG_PARSING_INIT_SEGMENT,{frag:V,id:E,tracks:ee.tracks})),$){var ae=$.startPTS,se=$.endPTS,Y=$.startDTS,X=$.endDTS;W&&(W.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:ae,endPTS:se,startDTS:Y,endDTS:X}),V.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,ae,se,Y,X),this.bufferFragmentData($,V,W,D)}if(Z!=null&&(A=Z.samples)!==null&&A!==void 0&&A.length){var q=u({id:E,frag:V,details:j},Z);v.trigger(F.Events.FRAG_PARSING_METADATA,q)}if(Q){var re=u({id:E,frag:V,details:j},Q);v.trigger(F.Events.FRAG_PARSING_USERDATA,re)}}},p._bufferInitSegment=function(h,A,E){if(this.state===S.State.PARSING){h.video&&delete h.video;var v=h.audio;if(v){v.levelCodec=v.codec,v.id="audio",this.log("Init audio buffer, container:"+v.container+", codecs[parsed]=["+v.codec+"]"),this.hls.trigger(F.Events.BUFFER_CODECS,h);var T=v.initSegment;if(T!=null&&T.byteLength){var D={type:"audio",frag:A,part:null,chunkMeta:E,parent:A.type,data:T};this.hls.trigger(F.Events.BUFFER_APPENDING,D)}this.tick()}}},p.loadFragment=function(h,A,E){var v=this.fragmentTracker.getState(h);this.fragCurrent=h,(this.audioSwitch||v===K.FragmentState.NOT_LOADED||v===K.FragmentState.PARTIAL)&&(h.sn==="initSegment"?this._loadInitSegment(h):A.live&&!(0,N.isFiniteNumber)(this.initPTS[h.cc])?(this.log("Waiting for video PTS in continuity counter "+h.cc+" of live stream before loading audio fragment "+h.sn+" of level "+this.trackId),this.state=S.State.WAITING_INIT_PTS):(this.startFragRequested=!0,s.prototype.loadFragment.call(this,h,A,E)))},p.completeAudioSwitch=function(){var h=this.hls,A=this.media,E=this.trackId;A&&(this.log("Switching audio track : flushing all audio"),s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,h.trigger(F.Events.AUDIO_TRACK_SWITCHED,{id:E})},d}(S.default);const a=o},"./src/controller/audio-track-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>L});var N=m("./src/events.ts"),S=m("./src/errors.ts"),F=m("./src/controller/base-playlist-controller.ts"),M=m("./src/types/loader.ts");function K(R,O){for(var C=0;C<O.length;C++){var y=O[C];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}function w(R,O,C){return O&&K(R.prototype,O),C&&K(R,C),Object.defineProperty(R,"prototype",{writable:!1}),R}function I(R,O){R.prototype=Object.create(O.prototype),R.prototype.constructor=R,k(R,O)}function k(R,O){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,u){return y.__proto__=u,y},k(R,O)}var x=function(R){I(O,R);function O(y){var u;return u=R.call(this,y,"[audio-track-controller]")||this,u.tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.trackName="",u.selectDefaultTrack=!0,u.registerListeners(),u}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(N.Events.LEVEL_LOADING,this.onLevelLoading,this),u.on(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.on(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.on(N.Events.ERROR,this.onError,this)},C.unregisterListeners=function(){var u=this.hls;u.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(N.Events.LEVEL_LOADING,this.onLevelLoading,this),u.off(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.off(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.off(N.Events.ERROR,this.onError,this)},C.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,R.prototype.destroy.call(this)},C.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},C.onManifestParsed=function(u,l){this.tracks=l.audioTracks||[]},C.onAudioTrackLoaded=function(u,l){var c=l.id,f=l.details,o=this.tracksInGroup[c];if(!o){this.warn("Invalid audio track id "+c);return}var a=o.details;o.details=l.details,this.log("audioTrack "+c+" loaded ["+f.startSN+"-"+f.endSN+"]"),c===this.trackId&&(this.retryCount=0,this.playlistLoaded(c,l,a))},C.onLevelLoading=function(u,l){this.switchLevel(l.level)},C.onLevelSwitching=function(u,l){this.switchLevel(l.level)},C.switchLevel=function(u){var l=this.hls.levels[u];if(l!=null&&l.audioGroupIds){var c=l.audioGroupIds[l.urlId];if(this.groupId!==c){this.groupId=c;var f=this.tracks.filter(function(a){return!c||a.groupId===c});this.selectDefaultTrack&&!f.some(function(a){return a.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=f;var o={audioTracks:f};this.log("Updating audio tracks, "+f.length+' track(s) found in "'+c+'" group-id'),this.hls.trigger(N.Events.AUDIO_TRACKS_UPDATED,o),this.selectInitialTrack()}}},C.onError=function(u,l){R.prototype.onError.call(this,u,l),!(l.fatal||!l.context)&&l.context.type===M.PlaylistContextType.AUDIO_TRACK&&l.context.id===this.trackId&&l.context.groupId===this.groupId&&this.retryLoadingOrFail(l)},C.setAudioTrack=function(u){var l=this.tracksInGroup;if(u<0||u>=l.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var c=l[this.trackId];this.log("Now switching to audio-track index "+u);var f=l[u],o=f.id,a=f.groupId,s=a===void 0?"":a,d=f.name,p=f.type,_=f.url;if(this.trackId=u,this.trackName=d,this.selectDefaultTrack=!1,this.hls.trigger(N.Events.AUDIO_TRACK_SWITCHING,{id:o,groupId:s,name:d,type:p,url:_}),!(f.details&&!f.details.live)){var h=this.switchParams(f.url,c==null?void 0:c.details);this.loadPlaylist(h)}},C.selectInitialTrack=function(){var u=this.tracksInGroup;console.assert(u.length,"Initial audio track should be selected when tracks are known");var l=this.trackName,c=this.findTrackId(l)||this.findTrackId();c!==-1?this.setAudioTrack(c):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},C.findTrackId=function(u){for(var l=this.tracksInGroup,c=0;c<l.length;c++){var f=l[c];if((!this.selectDefaultTrack||f.default)&&(!u||u===f.name))return f.id}return-1},C.loadPlaylist=function(u){var l=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(l)){var c=l.id,f=l.groupId,o=l.url;if(u)try{o=u.addDirectives(o)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("loading audio-track playlist for id: "+c),this.clearTimer(),this.hls.trigger(N.Events.AUDIO_TRACK_LOADING,{url:o,id:c,groupId:f,deliveryDirectives:u||null})}},w(O,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(u){this.selectDefaultTrack=!1,this.setAudioTrack(u)}}]),O}(F.default);const L=x},"./src/controller/base-playlist-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>w});var N=m("./src/polyfills/number.ts"),S=m("./src/types/level.ts"),F=m("./src/controller/level-helper.ts"),M=m("./src/utils/logger.ts"),K=m("./src/errors.ts"),w=function(){function I(x,L){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,L+":"),this.warn=M.logger.warn.bind(M.logger,L+":"),this.hls=x}var k=I.prototype;return k.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},k.onError=function(L,R){R.fatal&&R.type===K.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},k.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},k.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},k.stopLoad=function(){this.canLoad=!1,this.clearTimer()},k.switchParams=function(L,R){var O=R==null?void 0:R.renditionReports;if(O)for(var C=0;C<O.length;C++){var y=O[C],u=""+y.URI;if(u===L.slice(-u.length)){var l=parseInt(y["LAST-MSN"]),c=parseInt(y["LAST-PART"]);if(R&&this.hls.config.lowLatencyMode){var f=Math.min(R.age-R.partTarget,R.targetduration);c!==void 0&&f>R.partTarget&&(c+=1)}if((0,N.isFiniteNumber)(l))return new S.HlsUrlParameters(l,(0,N.isFiniteNumber)(c)?c:void 0,S.HlsSkip.No)}}},k.loadPlaylist=function(L){},k.shouldLoadTrack=function(L){return this.canLoad&&L&&!!L.url&&(!L.details||L.details.live)},k.playlistLoaded=function(L,R,O){var C=this,y=R.details,u=R.stats,l=u.loading.end?Math.max(0,self.performance.now()-u.loading.end):0;if(y.advancedDateTime=Date.now()-l,y.live||O!=null&&O.live){if(y.reloaded(O),O&&this.log("live playlist "+L+" "+(y.advanced?"REFRESHED "+y.lastPartSn+"-"+y.lastPartIndex:"MISSED")),O&&y.fragments.length>0&&(0,F.mergeDetails)(O,y),!this.canLoad||!y.live)return;var c,f=void 0,o=void 0;if(y.canBlockReload&&y.endSN&&y.advanced){var a=this.hls.config.lowLatencyMode,s=y.lastPartSn,d=y.endSN,p=y.lastPartIndex,_=p!==-1,h=s===d,A=a?0:p;_?(f=h?d+1:s,o=h?A:p+1):f=d+1;var E=y.age,v=E+y.ageHeader,T=Math.min(v-y.partTarget,y.targetduration*1.5);if(T>0){if(O&&T>O.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+O.tuneInGoal+" to: "+T+" with playlist age: "+y.age),T=0;else{var D=Math.floor(T/y.targetduration);if(f+=D,o!==void 0){var B=Math.round(T%y.targetduration/y.partTarget);o+=B}this.log("CDN Tune-in age: "+y.ageHeader+"s last advanced "+E.toFixed(2)+"s goal: "+T+" skip sn "+D+" to part "+o)}y.tuneInGoal=T}if(c=this.getDeliveryDirectives(y,R.deliveryDirectives,f,o),a||!h){this.loadPlaylist(c);return}}else c=this.getDeliveryDirectives(y,R.deliveryDirectives,f,o);var V=(0,F.computeReloadInterval)(y,u);f!==void 0&&y.canBlockReload&&(V-=y.partTarget||1),this.log("reload live playlist "+L+" in "+Math.round(V)+" ms"),this.timer=self.setTimeout(function(){return C.loadPlaylist(c)},V)}else this.clearTimer()},k.getDeliveryDirectives=function(L,R,O,C){var y=(0,S.getSkipValue)(L,O);return R!=null&&R.skip&&L.deltaUpdateFailed&&(O=R.msn,C=R.part,y=S.HlsSkip.No),new S.HlsUrlParameters(O,C,y)},k.retryLoadingOrFail=function(L){var R=this,O=this.hls.config,C=this.retryCount<O.levelLoadingMaxRetry;if(C){var y;if(this.retryCount++,L.details.indexOf("LoadTimeOut")>-1&&(y=L.context)!==null&&y!==void 0&&y.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+L.details+'"'),this.loadPlaylist();else{var u=Math.min(Math.pow(2,this.retryCount)*O.levelLoadingRetryDelay,O.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return R.loadPlaylist()},u),this.warn("retry playlist loading #"+this.retryCount+" in "+u+' ms after "'+L.details+'"')}}else this.warn('cannot recover from error "'+L.details+'"'),this.clearTimer(),L.fatal=!0;return C},I}()},"./src/controller/base-stream-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{State:()=>d,default:()=>p});var N=m("./src/polyfills/number.ts"),S=m("./src/task-loop.ts"),F=m("./src/controller/fragment-tracker.ts"),M=m("./src/utils/buffer-helper.ts"),K=m("./src/utils/logger.ts"),w=m("./src/events.ts"),I=m("./src/errors.ts"),k=m("./src/types/transmuxer.ts"),x=m("./src/utils/mp4-tools.ts"),L=m("./src/utils/discontinuities.ts"),R=m("./src/controller/fragment-finders.ts"),O=m("./src/controller/level-helper.ts"),C=m("./src/loader/fragment-loader.ts"),y=m("./src/crypt/decrypter.ts"),u=m("./src/utils/time-ranges.ts"),l=m("./src/types/loader.ts");function c(_,h){for(var A=0;A<h.length;A++){var E=h[A];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(_,E.key,E)}}function f(_,h,A){return h&&c(_.prototype,h),A&&c(_,A),Object.defineProperty(_,"prototype",{writable:!1}),_}function o(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function a(_,h){_.prototype=Object.create(h.prototype),_.prototype.constructor=_,s(_,h)}function s(_,h){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,v){return E.__proto__=v,E},s(_,h)}var d={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},p=function(_){a(h,_);function h(E,v,T){var D;return D=_.call(this)||this,D.hls=void 0,D.fragPrevious=null,D.fragCurrent=null,D.fragmentTracker=void 0,D.transmuxer=null,D._state=d.STOPPED,D.media=null,D.mediaBuffer=null,D.config=void 0,D.bitrateTest=!1,D.lastCurrentTime=0,D.nextLoadPosition=0,D.startPosition=0,D.loadedmetadata=!1,D.fragLoadError=0,D.retryDate=0,D.levels=null,D.fragmentLoader=void 0,D.levelLastLoaded=null,D.startFragRequested=!1,D.decrypter=void 0,D.initPTS=[],D.onvseeking=null,D.onvended=null,D.logPrefix="",D.log=void 0,D.warn=void 0,D.logPrefix=T,D.log=K.logger.log.bind(K.logger,T+":"),D.warn=K.logger.warn.bind(K.logger,T+":"),D.hls=E,D.fragmentLoader=new C.default(E.config),D.fragmentTracker=v,D.config=E.config,D.decrypter=new y.default(E,E.config),E.on(w.Events.KEY_LOADED,D.onKeyLoaded,o(D)),E.on(w.Events.LEVEL_SWITCHING,D.onLevelSwitching,o(D)),D}var A=h.prototype;return A.doTick=function(){this.onTickEnd()},A.onTickEnd=function(){},A.startLoad=function(v){},A.stopLoad=function(){this.fragmentLoader.abort();var v=this.fragCurrent;v&&this.fragmentTracker.removeFragment(v),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=d.STOPPED},A._streamEnded=function(v,T){var D=this.fragCurrent,B=this.fragmentTracker;if(!T.live&&D&&this.media&&D.sn>=T.endSN&&!v.nextStart){var V=T.partList;if(V!=null&&V.length){var W=V[V.length-1],j=M.BufferHelper.isBuffered(this.media,W.start+W.duration/2);return j}var $=B.getState(D);return $===F.FragmentState.PARTIAL||$===F.FragmentState.OK}return!1},A.onMediaAttached=function(v,T){var D=this.media=this.mediaBuffer=T.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),D.addEventListener("seeking",this.onvseeking),D.addEventListener("ended",this.onvended);var B=this.config;this.levels&&B.autoStartLoad&&this.state===d.STOPPED&&this.startLoad(B.startPosition)},A.onMediaDetaching=function(){var v=this.media;v!=null&&v.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),v&&this.onvseeking&&this.onvended&&(v.removeEventListener("seeking",this.onvseeking),v.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},A.onMediaSeeking=function(){var v=this.config,T=this.fragCurrent,D=this.media,B=this.mediaBuffer,V=this.state,W=D?D.currentTime:0,j=M.BufferHelper.bufferInfo(B||D,W,v.maxBufferHole);if(this.log("media seeking to "+((0,N.isFiniteNumber)(W)?W.toFixed(3):W)+", state: "+V),V===d.ENDED)this.resetLoadingState();else if(T){var $=v.maxFragLookUpTolerance,Q=T.start-$,Z=T.start+T.duration+$;if(!j.len||Z<j.start||Q>j.end){var ee=W>Z;(W<Q||ee)&&(ee&&T.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),T.loader.abort()),this.resetLoadingState())}}D&&(this.lastCurrentTime=W),!this.loadedmetadata&&!j.len&&(this.nextLoadPosition=this.startPosition=W),this.tickImmediate()},A.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},A.onKeyLoaded=function(v,T){if(!(this.state!==d.KEY_LOADING||T.frag!==this.fragCurrent||!this.levels)){this.state=d.IDLE;var D=this.levels[T.frag.level].details;D&&this.loadFragment(T.frag,D,T.frag.start)}},A.onLevelSwitching=function(v,T){this.fragLoadError=0},A.onHandlerDestroying=function(){this.stopLoad(),_.prototype.onHandlerDestroying.call(this)},A.onHandlerDestroyed=function(){this.state=d.STOPPED,this.hls.off(w.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,_.prototype.onHandlerDestroyed.call(this)},A.loadKey=function(v,T){this.log("Loading key for "+v.sn+" of ["+T.startSN+"-"+T.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+v.level),this.state=d.KEY_LOADING,this.fragCurrent=v,this.hls.trigger(w.Events.KEY_LOADING,{frag:v})},A.loadFragment=function(v,T,D){this._loadFragForPlayback(v,T,D)},A._loadFragForPlayback=function(v,T,D){var B=this,V=function(j){if(B.fragContextChanged(v)){B.warn("Fragment "+v.sn+(j.part?" p: "+j.part.index:"")+" of level "+v.level+" was dropped during download."),B.fragmentTracker.removeFragment(v);return}v.stats.chunkCount++,B._handleFragmentLoadProgress(j)};this._doFragLoad(v,T,D,V).then(function(W){if(W){B.fragLoadError=0;var j=B.state;if(B.fragContextChanged(v)){(j===d.FRAG_LOADING||!B.fragCurrent&&j===d.PARSING)&&(B.fragmentTracker.removeFragment(v),B.state=d.IDLE);return}"payload"in W&&(B.log("Loaded fragment "+v.sn+" of level "+v.level),B.hls.trigger(w.Events.FRAG_LOADED,W)),B._handleFragmentLoadComplete(W)}}).catch(function(W){B.state===d.STOPPED||B.state===d.ERROR||(B.warn(W),B.resetFragmentLoading(v))})},A.flushMainBuffer=function(v,T,D){if(D===void 0&&(D=null),!!(v-T)){var B={startOffset:v,endOffset:T,type:D};this.fragLoadError=0,this.hls.trigger(w.Events.BUFFER_FLUSHING,B)}},A._loadInitSegment=function(v){var T=this;this._doFragLoad(v).then(function(D){if(!D||T.fragContextChanged(v)||!T.levels)throw new Error("init load aborted");return D}).then(function(D){var B=T.hls,V=D.payload,W=v.decryptdata;if(V&&V.byteLength>0&&W&&W.key&&W.iv&&W.method==="AES-128"){var j=self.performance.now();return T.decrypter.webCryptoDecrypt(new Uint8Array(V),W.key.buffer,W.iv.buffer).then(function($){var Q=self.performance.now();return B.trigger(w.Events.FRAG_DECRYPTED,{frag:v,payload:$,stats:{tstart:j,tdecrypt:Q}}),D.payload=$,D})}return D}).then(function(D){var B=T.fragCurrent,V=T.hls,W=T.levels;if(!W)throw new Error("init load aborted, missing levels");var j=W[v.level].details;console.assert(j,"Level details are defined when init segment is loaded");var $=v.stats;T.state=d.IDLE,T.fragLoadError=0,v.data=new Uint8Array(D.payload),$.parsing.start=$.buffering.start=self.performance.now(),$.parsing.end=$.buffering.end=self.performance.now(),D.frag===B&&V.trigger(w.Events.FRAG_BUFFERED,{stats:$,frag:B,part:null,id:v.type}),T.tick()}).catch(function(D){T.state===d.STOPPED||T.state===d.ERROR||(T.warn(D),T.resetFragmentLoading(v))})},A.fragContextChanged=function(v){var T=this.fragCurrent;return!v||!T||v.level!==T.level||v.sn!==T.sn||v.urlId!==T.urlId},A.fragBufferedComplete=function(v,T){var D,B,V=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+v.type+" sn: "+v.sn+(T?" part: "+T.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+v.level+" "+(V?u.default.toString(M.BufferHelper.getBuffered(V)):"(detached)")),this.state=d.IDLE,V&&(!this.loadedmetadata&&v.type==l.PlaylistLevelType.MAIN&&V.buffered.length&&((D=this.fragCurrent)===null||D===void 0?void 0:D.sn)===((B=this.fragPrevious)===null||B===void 0?void 0:B.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},A.seekToStartPos=function(){},A._handleFragmentLoadComplete=function(v){var T=this.transmuxer;if(T){var D=v.frag,B=v.part,V=v.partsLoaded,W=!V||V.length===0||V.some(function($){return!$}),j=new k.ChunkMetadata(D.level,D.sn,D.stats.chunkCount+1,0,B?B.index:-1,!W);T.flush(j)}},A._handleFragmentLoadProgress=function(v){},A._doFragLoad=function(v,T,D,B){var V=this;if(D===void 0&&(D=null),!this.levels)throw new Error("frag load aborted, missing levels");if(D=Math.max(v.start,D||0),this.config.lowLatencyMode&&T){var W=T.partList;if(W&&B){D>v.end&&T.fragmentHint&&(v=T.fragmentHint);var j=this.getNextPart(W,v,D);if(j>-1){var $=W[j];return this.log("Loading part sn: "+v.sn+" p: "+$.index+" cc: "+v.cc+" of playlist ["+T.startSN+"-"+T.endSN+"] parts [0-"+j+"-"+(W.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+v.level+", target: "+parseFloat(D.toFixed(3))),this.nextLoadPosition=$.start+$.duration,this.state=d.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:v,part:W[j],targetBufferTime:D}),this.doFragPartsLoad(v,W,j,B).catch(function(Q){return V.handleFragLoadError(Q)})}else if(!v.url||this.loadedEndOfParts(W,D))return Promise.resolve(null)}}return this.log("Loading fragment "+v.sn+" cc: "+v.cc+" "+(T?"of ["+T.startSN+"-"+T.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+v.level+", target: "+parseFloat(D.toFixed(3))),(0,N.isFiniteNumber)(v.sn)&&!this.bitrateTest&&(this.nextLoadPosition=v.start+v.duration),this.state=d.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:v,targetBufferTime:D}),this.fragmentLoader.load(v,B).catch(function(Q){return V.handleFragLoadError(Q)})},A.doFragPartsLoad=function(v,T,D,B){var V=this;return new Promise(function(W,j){var $=[],Q=function Z(ee){var ae=T[ee];V.fragmentLoader.loadPart(v,ae,B).then(function(se){$[ae.index]=se;var Y=se.part;V.hls.trigger(w.Events.FRAG_LOADED,se);var X=T[ee+1];if(X&&X.fragment===v)Z(ee+1);else return W({frag:v,part:Y,partsLoaded:$})}).catch(j)};Q(D)})},A.handleFragLoadError=function(v){var T=v.data;return T&&T.details===I.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(T.frag,T.part):this.hls.trigger(w.Events.ERROR,T),null},A._handleTransmuxerFlush=function(v){var T=this.getCurrentContext(v);if(!T||this.state!==d.PARSING){this.fragCurrent||(this.state=d.IDLE);return}var D=T.frag,B=T.part,V=T.level,W=self.performance.now();D.stats.parsing.end=W,B&&(B.stats.parsing.end=W),this.updateLevelTiming(D,B,V,v.partial)},A.getCurrentContext=function(v){var T=this.levels,D=v.level,B=v.sn,V=v.part;if(!T||!T[D])return this.warn("Levels object was unset while buffering fragment "+B+" of level "+D+". The current chunk will not be buffered."),null;var W=T[D],j=V>-1?(0,O.getPartWith)(W,B,V):null,$=j?j.fragment:(0,O.getFragmentWithSN)(W,B,this.fragCurrent);return $?{frag:$,part:j,level:W}:null},A.bufferFragmentData=function(v,T,D,B){if(!(!v||this.state!==d.PARSING)){var V=v.data1,W=v.data2,j=V;if(V&&W&&(j=(0,x.appendUint8Array)(V,W)),!(!j||!j.length)){var $={type:v.type,frag:T,part:D,chunkMeta:B,parent:T.type,data:j};this.hls.trigger(w.Events.BUFFER_APPENDING,$),v.dropped&&v.independent&&!D&&this.flushBufferGap(T)}}},A.flushBufferGap=function(v){var T=this.media;if(T){if(!M.BufferHelper.isBuffered(T,T.currentTime)){this.flushMainBuffer(0,v.start);return}var D=T.currentTime,B=M.BufferHelper.bufferInfo(T,D,0),V=v.duration,W=Math.min(this.config.maxFragLookUpTolerance*2,V*.25),j=Math.max(Math.min(v.start-W,B.end-W),D+W);v.start-j>W&&this.flushMainBuffer(j,v.start)}},A.getFwdBufferInfo=function(v,T){var D=this.config,B=this.getLoadPosition();if(!(0,N.isFiniteNumber)(B))return null;var V=M.BufferHelper.bufferInfo(v,B,D.maxBufferHole);if(V.len===0&&V.nextStart!==void 0){var W=this.fragmentTracker.getBufferedFrag(B,T);if(W&&V.nextStart<W.end)return M.BufferHelper.bufferInfo(v,B,Math.max(V.nextStart,D.maxBufferHole))}return V},A.getMaxBufferLength=function(v){var T=this.config,D;return v?D=Math.max(8*T.maxBufferSize/v,T.maxBufferLength):D=T.maxBufferLength,Math.min(D,T.maxMaxBufferLength)},A.reduceMaxBufferLength=function(v){var T=this.config,D=v||T.maxBufferLength;return T.maxMaxBufferLength>=D?(T.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+T.maxMaxBufferLength+"s"),!0):!1},A.getNextFragment=function(v,T){var D=T.fragments,B=D.length;if(!B)return null;var V=this.config,W=D[0].start,j;if(T.live){var $=V.initialLiveManifestSize;if(B<$)return this.warn("Not enough fragments to start playback (have: "+B+", need: "+$+")"),null;!T.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(j=this.getInitialLiveFragment(T,D),this.startPosition=j?this.hls.liveSyncPosition||j.start:v)}else v<=W&&(j=D[0]);if(!j){var Q=V.lowLatencyMode?T.partEnd:T.fragmentEnd;j=this.getFragmentAtPosition(v,Q,T)}return this.mapToInitFragWhenRequired(j)},A.mapToInitFragWhenRequired=function(v){return v!=null&&v.initSegment&&!(v!=null&&v.initSegment.data)&&!this.bitrateTest?v.initSegment:v},A.getNextPart=function(v,T,D){for(var B=-1,V=!1,W=!0,j=0,$=v.length;j<$;j++){var Q=v[j];if(W=W&&!Q.independent,B>-1&&D<Q.start)break;var Z=Q.loaded;!Z&&(V||Q.independent||W)&&Q.fragment===T&&(B=j),V=Z}return B},A.loadedEndOfParts=function(v,T){var D=v[v.length-1];return D&&T>D.start&&D.loaded},A.getInitialLiveFragment=function(v,T){var D=this.fragPrevious,B=null;if(D){if(v.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+D.programDateTime),B=(0,R.findFragmentByPDT)(T,D.endProgramDateTime,this.config.maxFragLookUpTolerance)),!B){var V=D.sn+1;if(V>=v.startSN&&V<=v.endSN){var W=T[V-v.startSN];D.cc===W.cc&&(B=W,this.log("Live playlist, switching playlist, load frag with next SN: "+B.sn))}B||(B=(0,R.findFragWithCC)(T,D.cc),B&&this.log("Live playlist, switching playlist, load frag with same CC: "+B.sn))}}else{var j=this.hls.liveSyncPosition;j!==null&&(B=this.getFragmentAtPosition(j,this.bitrateTest?v.fragmentEnd:v.edge,v))}return B},A.getFragmentAtPosition=function(v,T,D){var B=this.config,V=this.fragPrevious,W=D.fragments,j=D.endSN,$=D.fragmentHint,Q=B.maxFragLookUpTolerance,Z=!!(B.lowLatencyMode&&D.partList&&$);Z&&$&&!this.bitrateTest&&(W=W.concat($),j=$.sn);var ee;if(v<T){var ae=v>T-Q?0:Q;ee=(0,R.findFragmentByPTS)(V,W,v,ae)}else ee=W[W.length-1];if(ee){var se=ee.sn-D.startSN;if(this.fragmentTracker.getState(ee)===F.FragmentState.OK&&(V=ee),V&&ee.sn===V.sn&&!Z){var Y=V&&ee.level===V.level;if(Y){var X=W[se+1];ee.sn<j&&this.fragmentTracker.getState(X)!==F.FragmentState.OK?(this.log("SN "+ee.sn+" just loaded, load next one: "+X.sn),ee=X):ee=null}}}return ee},A.synchronizeToLiveEdge=function(v){var T=this.config,D=this.media;if(D){var B=this.hls.liveSyncPosition,V=D.currentTime,W=v.fragments[0].start,j=v.edge,$=V>=W-T.maxFragLookUpTolerance&&V<=j;if(B!==null&&D.duration>B&&(V<B||!$)){var Q=T.liveMaxLatencyDuration!==void 0?T.liveMaxLatencyDuration:T.liveMaxLatencyDurationCount*v.targetduration;(!$&&D.readyState<4||V<j-Q)&&(this.loadedmetadata||(this.nextLoadPosition=B),D.readyState&&(this.warn("Playback: "+V.toFixed(3)+" is located too far from the end of live sliding playlist: "+j+", reset currentTime to : "+B.toFixed(3)),D.currentTime=B))}}},A.alignPlaylists=function(v,T){var D=this.levels,B=this.levelLastLoaded,V=this.fragPrevious,W=B!==null?D[B]:null,j=v.fragments.length;if(!j)return this.warn("No fragments in live playlist"),0;var $=v.fragments[0].start,Q=!T,Z=v.alignedSliding&&(0,N.isFiniteNumber)($);if(Q||!Z&&!$){(0,L.alignStream)(V,W,v);var ee=v.fragments[0].start;return this.log("Live playlist sliding: "+ee.toFixed(2)+" start-sn: "+(T?T.startSN:"na")+"->"+v.startSN+" prev-sn: "+(V?V.sn:"na")+" fragments: "+j),ee}return $},A.waitForCdnTuneIn=function(v){var T=3;return v.live&&v.canBlockReload&&v.partTarget&&v.tuneInGoal>Math.max(v.partHoldBack,v.partTarget*T)},A.setStartPosition=function(v,T){var D=this.startPosition;if(D<T&&(D=-1),D===-1||this.lastCurrentTime===-1){var B=v.startTimeOffset;(0,N.isFiniteNumber)(B)?(D=T+B,B<0&&(D+=v.totalduration),D=Math.min(Math.max(T,D),T+v.totalduration),this.log("Start time offset "+B+" found in playlist, adjust startPosition to "+D),this.startPosition=D):v.live?D=this.hls.liveSyncPosition||T:this.startPosition=D=0,this.lastCurrentTime=D}this.nextLoadPosition=D},A.getLoadPosition=function(){var v=this.media,T=0;return this.loadedmetadata&&v?T=v.currentTime:this.nextLoadPosition&&(T=this.nextLoadPosition),T},A.handleFragLoadAborted=function(v,T){this.transmuxer&&v.sn!=="initSegment"&&v.stats.aborted&&(this.warn("Fragment "+v.sn+(T?" part"+T.index:"")+" of level "+v.level+" was aborted"),this.resetFragmentLoading(v))},A.resetFragmentLoading=function(v){(!this.fragCurrent||!this.fragContextChanged(v)&&this.state!==d.FRAG_LOADING_WAITING_RETRY)&&(this.state=d.IDLE)},A.onFragmentOrKeyLoadError=function(v,T){if(!T.fatal){var D=T.frag;if(!(!D||D.type!==v)){var B=this.fragCurrent;console.assert(B&&D.sn===B.sn&&D.level===B.level&&D.urlId===B.urlId,"Frag load error must match current frag to retry");var V=this.config;if(this.fragLoadError+1<=V.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var W=Math.min(Math.pow(2,this.fragLoadError)*V.fragLoadingRetryDelay,V.fragLoadingMaxRetryTimeout);this.warn("Fragment "+D.sn+" of "+v+" "+D.level+" failed to load, retrying in "+W+"ms"),this.retryDate=self.performance.now()+W,this.fragLoadError++,this.state=d.FRAG_LOADING_WAITING_RETRY}else T.levelRetry?(v===l.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=d.IDLE):(K.logger.error(T.details+" reaches max retry, redispatch as fatal ..."),T.fatal=!0,this.hls.stopLoad(),this.state=d.ERROR)}}},A.afterBufferFlushed=function(v,T,D){if(v){var B=M.BufferHelper.getBuffered(v);this.fragmentTracker.detectEvictedFragments(T,B,D),this.state===d.ENDED&&this.resetLoadingState()}},A.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=d.IDLE},A.resetStartWhenNotLoaded=function(v){if(!this.loadedmetadata){this.startFragRequested=!1;var T=this.levels?this.levels[v].details:null;T!=null&&T.live?(this.startPosition=-1,this.setStartPosition(T,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},A.updateLevelTiming=function(v,T,D,B){var V=this,W=D.details;console.assert(!!W,"level.details must be defined");var j=Object.keys(v.elementaryStreams).reduce(function($,Q){var Z=v.elementaryStreams[Q];if(Z){var ee=Z.endPTS-Z.startPTS;if(ee<=0)return V.warn("Could not parse fragment "+v.sn+" "+Q+" duration reliably ("+ee+")"),$||!1;var ae=B?0:(0,O.updateFragPTSDTS)(W,v,Z.startPTS,Z.endPTS,Z.startDTS,Z.endDTS);return V.hls.trigger(w.Events.LEVEL_PTS_UPDATED,{details:W,level:D,drift:ae,type:Q,frag:v,start:Z.startPTS,end:Z.endPTS}),!0}return $},!1);j||(this.warn("Found no media in fragment "+v.sn+" of level "+D.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=d.PARSED,this.hls.trigger(w.Events.FRAG_PARSED,{frag:v,part:T})},A.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},f(h,[{key:"state",get:function(){return this._state},set:function(v){var T=this._state;T!==v&&(this._state=v,this.log(T+"->"+v))}}]),h}(S.default)},"./src/controller/buffer-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>R});var N=m("./src/polyfills/number.ts"),S=m("./src/events.ts"),F=m("./src/utils/logger.ts"),M=m("./src/errors.ts"),K=m("./src/utils/buffer-helper.ts"),w=m("./src/utils/mediasource-helper.ts"),I=m("./src/loader/fragment.ts"),k=m("./src/controller/buffer-operation-queue.ts"),x=(0,w.getMediaSource)(),L=/([ha]vc.)(?:\.[^.,]+)+/,R=function(){function O(y){var u=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var l=u.hls,c=u.media,f=u.mediaSource;F.logger.log("[buffer-controller]: Media source opened"),c&&(u.updateMediaElementDuration(),l.trigger(S.Events.MEDIA_ATTACHED,{media:c})),f&&f.removeEventListener("sourceopen",u._onMediaSourceOpen),u.checkPendingTracks()},this._onMediaSourceClose=function(){F.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){F.logger.log("[buffer-controller]: Media source ended")},this.hls=y,this._initSourceBuffer(),this.registerListeners()}var C=O.prototype;return C.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},C.destroy=function(){this.unregisterListeners(),this.details=null},C.registerListeners=function(){var u=this.hls;u.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(S.Events.BUFFER_RESET,this.onBufferReset,this),u.on(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.on(S.Events.BUFFER_EOS,this.onBufferEos,this),u.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.on(S.Events.FRAG_PARSED,this.onFragParsed,this),u.on(S.Events.FRAG_CHANGED,this.onFragChanged,this)},C.unregisterListeners=function(){var u=this.hls;u.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(S.Events.BUFFER_RESET,this.onBufferReset,this),u.off(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.off(S.Events.BUFFER_EOS,this.onBufferEos,this),u.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.off(S.Events.FRAG_PARSED,this.onFragParsed,this),u.off(S.Events.FRAG_CHANGED,this.onFragChanged,this)},C._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new k.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},C.onManifestParsed=function(u,l){var c=2;(l.audio&&!l.video||!l.altAudio)&&(c=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=c,this.details=null,F.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},C.onMediaAttaching=function(u,l){var c=this.media=l.media;if(c&&x){var f=this.mediaSource=new x;f.addEventListener("sourceopen",this._onMediaSourceOpen),f.addEventListener("sourceended",this._onMediaSourceEnded),f.addEventListener("sourceclose",this._onMediaSourceClose),c.src=self.URL.createObjectURL(f),this._objectUrl=c.src}},C.onMediaDetaching=function(){var u=this.media,l=this.mediaSource,c=this._objectUrl;if(l){if(F.logger.log("[buffer-controller]: media source detaching"),l.readyState==="open")try{l.endOfStream()}catch(f){F.logger.warn("[buffer-controller]: onMediaDetaching: "+f.message+" while calling endOfStream")}this.onBufferReset(),l.removeEventListener("sourceopen",this._onMediaSourceOpen),l.removeEventListener("sourceended",this._onMediaSourceEnded),l.removeEventListener("sourceclose",this._onMediaSourceClose),u&&(c&&self.URL.revokeObjectURL(c),u.src===c?(u.removeAttribute("src"),u.load()):F.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(S.Events.MEDIA_DETACHED,void 0)},C.onBufferReset=function(){var u=this;this.getSourceBufferTypes().forEach(function(l){var c=u.sourceBuffer[l];try{c&&(u.removeBufferListeners(l),u.mediaSource&&u.mediaSource.removeSourceBuffer(c),u.sourceBuffer[l]=void 0)}catch(f){F.logger.warn("[buffer-controller]: Failed to reset the "+l+" buffer",f)}}),this._initSourceBuffer()},C.onBufferCodecs=function(u,l){var c=this,f=this.getSourceBufferTypes().length;Object.keys(l).forEach(function(o){if(f){var a=c.tracks[o];if(a&&typeof a.buffer.changeType=="function"){var s=l[o],d=s.id,p=s.codec,_=s.levelCodec,h=s.container,A=s.metadata,E=(a.levelCodec||a.codec).replace(L,"$1"),v=(_||p).replace(L,"$1");if(E!==v){var T=h+";codecs="+(_||p);c.appendChangeType(o,T),F.logger.log("[buffer-controller]: switching codec "+E+" to "+v),c.tracks[o]={buffer:a.buffer,codec:p,container:h,levelCodec:_,metadata:A,id:d}}}}else c.pendingTracks[o]=l[o]}),!f&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},C.appendChangeType=function(u,l){var c=this,f=this.operationQueue,o={execute:function(){var s=c.sourceBuffer[u];s&&(F.logger.log("[buffer-controller]: changing "+u+" sourceBuffer type to "+l),s.changeType(l)),f.shiftAndExecuteNext(u)},onStart:function(){},onComplete:function(){},onError:function(s){F.logger.warn("[buffer-controller]: Failed to change "+u+" SourceBuffer type",s)}};f.append(o,u)},C.onBufferAppending=function(u,l){var c=this,f=this.hls,o=this.operationQueue,a=this.tracks,s=l.data,d=l.type,p=l.frag,_=l.part,h=l.chunkMeta,A=h.buffering[d],E=self.performance.now();A.start=E;var v=p.stats.buffering,T=_?_.stats.buffering:null;v.start===0&&(v.start=E),T&&T.start===0&&(T.start=E);var D=a.audio,B=d==="audio"&&h.id===1&&(D==null?void 0:D.container)==="audio/mpeg",V={execute:function(){if(A.executeStart=self.performance.now(),B){var j=c.sourceBuffer[d];if(j){var $=p.start-j.timestampOffset;Math.abs($)>=.1&&(F.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+p.start+" (delta: "+$+") sn: "+p.sn+")"),j.timestampOffset=p.start)}}c.appendExecutor(s,d)},onStart:function(){},onComplete:function(){var j=self.performance.now();A.executeEnd=A.end=j,v.first===0&&(v.first=j),T&&T.first===0&&(T.first=j);var $=c.sourceBuffer,Q={};for(var Z in $)Q[Z]=K.BufferHelper.getBuffered($[Z]);c.appendError=0,c.hls.trigger(S.Events.BUFFER_APPENDED,{type:d,frag:p,part:_,chunkMeta:h,parent:p.type,timeRanges:Q})},onError:function(j){F.logger.error("[buffer-controller]: Error encountered while trying to append to the "+d+" SourceBuffer",j);var $={type:M.ErrorTypes.MEDIA_ERROR,parent:p.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:j,fatal:!1};j.code===DOMException.QUOTA_EXCEEDED_ERR?$.details=M.ErrorDetails.BUFFER_FULL_ERROR:(c.appendError++,$.details=M.ErrorDetails.BUFFER_APPEND_ERROR,c.appendError>f.config.appendErrorMaxRetry&&(F.logger.error("[buffer-controller]: Failed "+f.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),$.fatal=!0,f.stopLoad())),f.trigger(S.Events.ERROR,$)}};o.append(V,d)},C.onBufferFlushing=function(u,l){var c=this,f=this.operationQueue,o=function(s){return{execute:c.removeExecutor.bind(c,s,l.startOffset,l.endOffset),onStart:function(){},onComplete:function(){c.hls.trigger(S.Events.BUFFER_FLUSHED,{type:s})},onError:function(p){F.logger.warn("[buffer-controller]: Failed to remove from "+s+" SourceBuffer",p)}}};l.type?f.append(o(l.type),l.type):this.getSourceBufferTypes().forEach(function(a){f.append(o(a),a)})},C.onFragParsed=function(u,l){var c=this,f=l.frag,o=l.part,a=[],s=o?o.elementaryStreams:f.elementaryStreams;s[I.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(s[I.ElementaryStreamTypes.AUDIO]&&a.push("audio"),s[I.ElementaryStreamTypes.VIDEO]&&a.push("video"));var d=function(){var _=self.performance.now();f.stats.buffering.end=_,o&&(o.stats.buffering.end=_);var h=o?o.stats:f.stats;c.hls.trigger(S.Events.FRAG_BUFFERED,{frag:f,part:o,stats:h,id:f.type})};a.length===0&&F.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+f.type+" level: "+f.level+" sn: "+f.sn),this.blockBuffers(d,a)},C.onFragChanged=function(u,l){this.flushBackBuffer()},C.onBufferEos=function(u,l){var c=this,f=this.getSourceBufferTypes().reduce(function(o,a){var s=c.sourceBuffer[a];return(!l.type||l.type===a)&&s&&!s.ended&&(s.ended=!0,F.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),o&&!!(!s||s.ended)},!0);f&&this.blockBuffers(function(){var o=c.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},C.onLevelUpdated=function(u,l){var c=l.details;c.fragments.length&&(this.details=c,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},C.flushBackBuffer=function(){var u=this.hls,l=this.details,c=this.media,f=this.sourceBuffer;if(!(!c||l===null)){var o=this.getSourceBufferTypes();if(o.length){var a=l.live&&u.config.liveBackBufferLength!==null?u.config.liveBackBufferLength:u.config.backBufferLength;if(!(!(0,N.isFiniteNumber)(a)||a<0)){var s=c.currentTime,d=l.levelTargetDuration,p=Math.max(a,d),_=Math.floor(s/d)*d-p;o.forEach(function(h){var A=f[h];if(A){var E=K.BufferHelper.getBuffered(A);E.length>0&&_>E.start(0)&&(u.trigger(S.Events.BACK_BUFFER_REACHED,{bufferEnd:_}),l.live&&u.trigger(S.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:_}),u.trigger(S.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:_,type:h}))}})}}}},C.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var u=this.details,l=this.hls,c=this.media,f=this.mediaSource,o=u.fragments[0].start+u.totalduration,a=c.duration,s=(0,N.isFiniteNumber)(f.duration)?f.duration:0;u.live&&l.config.liveDurationInfinity?(F.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),f.duration=1/0,this.updateSeekableRange(u)):(o>s&&o>a||!(0,N.isFiniteNumber)(a))&&(F.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),f.duration=o)}},C.updateSeekableRange=function(u){var l=this.mediaSource,c=u.fragments,f=c.length;if(f&&u.live&&l!==null&&l!==void 0&&l.setLiveSeekableRange){var o=Math.max(0,c[0].start),a=Math.max(o,o+u.totalduration);l.setLiveSeekableRange(o,a)}},C.checkPendingTracks=function(){var u=this.bufferCodecEventsExpected,l=this.operationQueue,c=this.pendingTracks,f=Object.keys(c).length;if(f&&!u||f===2){this.createSourceBuffers(c),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(S.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(a){l.executeNext(a)})}},C.createSourceBuffers=function(u){var l=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");var f=0;for(var o in u)if(!l[o]){var a=u[o];if(!a)throw Error("source buffer exists for track "+o+", however track does not");var s=a.levelCodec||a.codec,d=a.container+";codecs="+s;F.logger.log("[buffer-controller]: creating sourceBuffer("+d+")");try{var p=l[o]=c.addSourceBuffer(d),_=o;this.addBufferListener(_,"updatestart",this._onSBUpdateStart),this.addBufferListener(_,"updateend",this._onSBUpdateEnd),this.addBufferListener(_,"error",this._onSBUpdateError),this.tracks[o]={buffer:p,codec:s,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id},f++}catch(h){F.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+h.message),this.hls.trigger(S.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,mimeType:d})}}f&&this.hls.trigger(S.Events.BUFFER_CREATED,{tracks:this.tracks})},C._onSBUpdateStart=function(u){var l=this.operationQueue,c=l.current(u);c.onStart()},C._onSBUpdateEnd=function(u){var l=this.operationQueue,c=l.current(u);c.onComplete(),l.shiftAndExecuteNext(u)},C._onSBUpdateError=function(u,l){F.logger.error("[buffer-controller]: "+u+" SourceBuffer error",l),this.hls.trigger(S.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var c=this.operationQueue.current(u);c&&c.onError(l)},C.removeExecutor=function(u,l,c){var f=this.media,o=this.mediaSource,a=this.operationQueue,s=this.sourceBuffer,d=s[u];if(!f||!o||!d){F.logger.warn("[buffer-controller]: Attempting to remove from the "+u+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(u);return}var p=(0,N.isFiniteNumber)(f.duration)?f.duration:1/0,_=(0,N.isFiniteNumber)(o.duration)?o.duration:1/0,h=Math.max(0,l),A=Math.min(c,p,_);A>h?(F.logger.log("[buffer-controller]: Removing ["+h+","+A+"] from the "+u+" SourceBuffer"),console.assert(!d.updating,u+" sourceBuffer must not be updating"),d.remove(h,A)):a.shiftAndExecuteNext(u)},C.appendExecutor=function(u,l){var c=this.operationQueue,f=this.sourceBuffer,o=f[l];if(!o){F.logger.warn("[buffer-controller]: Attempting to append to the "+l+" SourceBuffer, but it does not exist"),c.shiftAndExecuteNext(l);return}o.ended=!1,console.assert(!o.updating,l+" sourceBuffer must not be updating"),o.appendBuffer(u)},C.blockBuffers=function(u,l){var c=this;if(l===void 0&&(l=this.getSourceBufferTypes()),!l.length){F.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(u);return}var f=this.operationQueue,o=l.map(function(a){return f.appendBlocker(a)});Promise.all(o).then(function(){u(),l.forEach(function(a){var s=c.sourceBuffer[a];(!s||!s.updating)&&f.shiftAndExecuteNext(a)})})},C.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},C.addBufferListener=function(u,l,c){var f=this.sourceBuffer[u];if(f){var o=c.bind(this,u);this.listeners[u].push({event:l,listener:o}),f.addEventListener(l,o)}},C.removeBufferListeners=function(u){var l=this.sourceBuffer[u];l&&this.listeners[u].forEach(function(c){l.removeEventListener(c.event,c.listener)})},O}()},"./src/controller/buffer-operation-queue.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>S});var N=m("./src/utils/logger.ts"),S=function(){function F(K){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=K}var M=F.prototype;return M.append=function(w,I){var k=this.queues[I];k.push(w),k.length===1&&this.buffers[I]&&this.executeNext(I)},M.insertAbort=function(w,I){var k=this.queues[I];k.unshift(w),this.executeNext(I)},M.appendBlocker=function(w){var I,k=new Promise(function(L){I=L}),x={execute:I,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(x,w),k},M.executeNext=function(w){var I=this.buffers,k=this.queues,x=I[w],L=k[w];if(L.length){var R=L[0];try{R.execute()}catch(O){N.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),R.onError(O),(!x||!x.updating)&&(L.shift(),this.executeNext(w))}}},M.shiftAndExecuteNext=function(w){this.queues[w].shift(),this.executeNext(w)},M.current=function(w){return this.queues[w][0]},F}()},"./src/controller/cap-level-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>K});var N=m("./src/events.ts");function S(w,I){for(var k=0;k<I.length;k++){var x=I[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(w,x.key,x)}}function F(w,I,k){return I&&S(w.prototype,I),k&&S(w,k),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=function(){function w(k){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=k,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var I=w.prototype;return I.setStreamController=function(x){this.streamController=x},I.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},I.registerListeners=function(){var x=this.hls;x.on(N.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),x.on(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),x.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),x.on(N.Events.BUFFER_CODECS,this.onBufferCodecs,this),x.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.unregisterListener=function(){var x=this.hls;x.off(N.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),x.off(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),x.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),x.off(N.Events.BUFFER_CODECS,this.onBufferCodecs,this),x.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.onFpsDropLevelCapping=function(x,L){w.isLevelAllowed(L.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(L.droppedLevel)},I.onMediaAttaching=function(x,L){this.media=L.media instanceof HTMLVideoElement?L.media:null},I.onManifestParsed=function(x,L){var R=this.hls;this.restrictedLevels=[],this.firstLevel=L.firstLevel,R.config.capLevelToPlayerSize&&L.video&&this.startCapping()},I.onBufferCodecs=function(x,L){var R=this.hls;R.config.capLevelToPlayerSize&&L.video&&this.startCapping()},I.onMediaDetaching=function(){this.stopCapping()},I.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var x=this.hls.levels;if(x.length){var L=this.hls;L.autoLevelCapping=this.getMaxLevel(x.length-1),L.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=L.autoLevelCapping}}},I.getMaxLevel=function(x){var L=this,R=this.hls.levels;if(!R.length)return-1;var O=R.filter(function(C,y){return w.isLevelAllowed(y,L.restrictedLevels)&&y<=x});return this.clientRect=null,w.getMaxLevelByMediaSize(O,this.mediaWidth,this.mediaHeight)},I.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},I.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},I.getDimensions=function(){if(this.clientRect)return this.clientRect;var x=this.media,L={width:0,height:0};if(x){var R=x.getBoundingClientRect();L.width=R.width,L.height=R.height,!L.width&&!L.height&&(L.width=R.right-R.left||x.width||0,L.height=R.bottom-R.top||x.height||0)}return this.clientRect=L,L},w.isLevelAllowed=function(x,L){return L===void 0&&(L=[]),L.indexOf(x)===-1},w.getMaxLevelByMediaSize=function(x,L,R){if(!x||!x.length)return-1;for(var O=function(c,f){return f?c.width!==f.width||c.height!==f.height:!0},C=x.length-1,y=0;y<x.length;y+=1){var u=x[y];if((u.width>=L||u.height>=R)&&O(u,x[y+1])){C=y;break}}return C},F(w,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var x=1;if(!this.hls.config.ignoreDevicePixelRatio)try{x=self.devicePixelRatio}catch{}return x}}]),w}();const K=M},"./src/controller/cmcd-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>R});var N=m("./src/events.ts"),S=m("./src/types/cmcd.ts"),F=m("./src/utils/buffer-helper.ts"),M=m("./src/utils/logger.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){var y=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(y)return(y=y.call(O)).next.bind(y);if(Array.isArray(O)||(y=k(O))||C&&O&&typeof O.length=="number"){y&&(O=y);var u=0;return function(){return u>=O.length?{done:!0}:{done:!1,value:O[u++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(O,C){if(O){if(typeof O=="string")return x(O,C);var y=Object.prototype.toString.call(O).slice(8,-1);if(y==="Object"&&O.constructor&&(y=O.constructor.name),y==="Map"||y==="Set")return Array.from(O);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return x(O,C)}}function x(O,C){(C==null||C>O.length)&&(C=O.length);for(var y=0,u=new Array(C);y<C;y++)u[y]=O[y];return u}function L(){return L=Object.assign?Object.assign.bind():function(O){for(var C=1;C<arguments.length;C++){var y=arguments[C];for(var u in y)Object.prototype.hasOwnProperty.call(y,u)&&(O[u]=y[u])}return O},L.apply(this,arguments)}var R=function(){function O(y){var u=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){u.initialized&&(u.starved=!0),u.buffering=!0},this.onPlaying=function(){u.initialized||(u.initialized=!0),u.buffering=!1},this.applyPlaylistData=function(f){try{u.apply(f,{ot:S.CMCDObjectType.MANIFEST,su:!u.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(f){try{var o=f.frag,a=u.hls.levels[o.level],s=u.getObjectType(o),d={d:o.duration*1e3,ot:s};(s===S.CMCDObjectType.VIDEO||s===S.CMCDObjectType.AUDIO||s==S.CMCDObjectType.MUXED)&&(d.br=a.bitrate/1e3,d.tb=u.getTopBandwidth(s)/1e3,d.bl=u.getBufferLength(s)),u.apply(f,d)}catch(p){M.logger.warn("Could not generate segment CMCD data.",p)}},this.hls=y;var l=this.config=y.config,c=l.cmcd;c!=null&&(l.pLoader=this.createPlaylistLoader(),l.fLoader=this.createFragmentLoader(),this.sid=c.sessionId||O.uuid(),this.cid=c.contentId,this.useHeaders=c.useHeaders===!0,this.registerListeners())}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.on(N.Events.BUFFER_CREATED,this.onBufferCreated,this)},C.unregisterListeners=function(){var u=this.hls;u.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.off(N.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},C.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},C.onMediaAttached=function(u,l){this.media=l.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},C.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},C.onBufferCreated=function(u,l){var c,f;this.audioBuffer=(c=l.tracks.audio)===null||c===void 0?void 0:c.buffer,this.videoBuffer=(f=l.tracks.video)===null||f===void 0?void 0:f.buffer},C.createData=function(){var u;return{v:S.CMCDVersion,sf:S.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(u=this.media)===null||u===void 0?void 0:u.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},C.apply=function(u,l){l===void 0&&(l={}),L(l,this.createData());var c=l.ot===S.CMCDObjectType.INIT||l.ot===S.CMCDObjectType.VIDEO||l.ot===S.CMCDObjectType.MUXED;if(this.starved&&c&&(l.bs=!0,l.su=!0,this.starved=!1),l.su==null&&(l.su=this.buffering),this.useHeaders){var f=O.toHeaders(l);if(!Object.keys(f).length)return;u.headers||(u.headers={}),L(u.headers,f)}else{var o=O.toQuery(l);if(!o)return;u.url=O.appendQueryToUri(u.url,o)}},C.getObjectType=function(u){var l=u.type;if(l==="subtitle")return S.CMCDObjectType.TIMED_TEXT;if(u.sn==="initSegment")return S.CMCDObjectType.INIT;if(l==="audio")return S.CMCDObjectType.AUDIO;if(l==="main")return this.hls.audioTracks.length?S.CMCDObjectType.VIDEO:S.CMCDObjectType.MUXED},C.getTopBandwidth=function(u){var l=0,c,f=this.hls;if(u===S.CMCDObjectType.AUDIO)c=f.audioTracks;else{var o=f.maxAutoLevel,a=o>-1?o+1:f.levels.length;c=f.levels.slice(0,a)}for(var s=I(c),d;!(d=s()).done;){var p=d.value;p.bitrate>l&&(l=p.bitrate)}return l>0?l:NaN},C.getBufferLength=function(u){var l=this.hls.media,c=u===S.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!c||!l)return NaN;var f=F.BufferHelper.bufferInfo(c,l.currentTime,this.config.maxBufferHole);return f.len*1e3},C.createPlaylistLoader=function(){var u=this.config.pLoader,l=this.applyPlaylistData,c=u||this.config.loader;return function(){function f(a){this.loader=void 0,this.loader=new c(a)}var o=f.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,d,p){l(s),this.loader.load(s,d,p)},w(f,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),f}()},C.createFragmentLoader=function(){var u=this.config.fLoader,l=this.applyFragmentData,c=u||this.config.loader;return function(){function f(a){this.loader=void 0,this.loader=new c(a)}var o=f.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,d,p){l(s),this.loader.load(s,d,p)},w(f,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),f}()},O.uuid=function(){var u=URL.createObjectURL(new Blob),l=u.toString();return URL.revokeObjectURL(u),l.slice(l.lastIndexOf("/")+1)},O.serialize=function(u){for(var l=[],c=function(B){return!Number.isNaN(B)&&B!=null&&B!==""&&B!==!1},f=function(B){return Math.round(B)},o=function(B){return f(B/100)*100},a=function(B){return encodeURIComponent(B)},s={br:f,d:f,bl:o,dl:o,mtp:o,nor:a,rtp:o,tb:f},d=Object.keys(u||{}).sort(),p=I(d),_;!(_=p()).done;){var h=_.value,A=u[h];if(c(A)&&!(h==="v"&&A===1)&&!(h=="pr"&&A===1)){var E=s[h];E&&(A=E(A));var v=typeof A,T=void 0;h==="ot"||h==="sf"||h==="st"?T=h+"="+A:v==="boolean"?T=h:v==="number"?T=h+"="+A:T=h+"="+JSON.stringify(A),l.push(T)}}return l.join(",")},O.toHeaders=function(u){for(var l=Object.keys(u),c={},f=["Object","Request","Session","Status"],o=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},s=0,d=l;s<d.length;s++){var p=d[s],_=a[p]!=null?a[p]:1;o[_][p]=u[p]}for(var h=0;h<o.length;h++){var A=O.serialize(o[h]);A&&(c["CMCD-"+f[h]]=A)}return c},O.toQuery=function(u){return"CMCD="+encodeURIComponent(O.serialize(u))},O.appendQueryToUri=function(u,l){if(!l)return u;var c=u.includes("?")?"&":"?";return""+u+c+l},O}()},"./src/controller/eme-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>R});var N=m("./src/events.ts"),S=m("./src/errors.ts"),F=m("./src/utils/logger.ts"),M=m("./src/utils/mediakeys-helper.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}var I=3,k=function(C,y,u){var l={audioCapabilities:[],videoCapabilities:[]};return C.forEach(function(c){l.audioCapabilities.push({contentType:'audio/mp4; codecs="'+c+'"',robustness:u.audioRobustness||""})}),y.forEach(function(c){l.videoCapabilities.push({contentType:'video/mp4; codecs="'+c+'"',robustness:u.videoRobustness||""})}),[l]},x=function(C,y,u,l){switch(C){case M.KeySystems.WIDEVINE:return k(y,u,l);default:throw new Error("Unknown key-system: "+C)}},L=function(){function O(y){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=y,this._config=y.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var C=O.prototype;return C.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},C._registerListeners=function(){this.hls.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C._unregisterListeners=function(){this.hls.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C.getLicenseServerUrl=function(u){switch(u){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+u+'"')},C._attemptKeySystemAccess=function(u,l,c){var f=this,o=x(u,l,c,this._drmSystemOptions);F.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(u,o);this.mediaKeysPromise=a.then(function(s){return f._onMediaKeySystemAccessObtained(u,s)}),a.catch(function(s){F.logger.error('Failed to obtain key-system "'+u+'" access:',s)})},C._onMediaKeySystemAccessObtained=function(u,l){var c=this;F.logger.log('Access for key-system "'+u+'" obtained');var f={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:l,mediaKeySystemDomain:u};this._mediaKeysList.push(f);var o=Promise.resolve().then(function(){return l.createMediaKeys()}).then(function(a){return f.mediaKeys=a,F.logger.log('Media-keys created for key-system "'+u+'"'),c._onMediaKeysCreated(),a});return o.catch(function(a){F.logger.error("Failed to create media-keys:",a)}),o},C._onMediaKeysCreated=function(){var u=this;this._mediaKeysList.forEach(function(l){l.mediaKeysSession||(l.mediaKeysSession=l.mediaKeys.createSession(),u._onNewMediaKeySession(l.mediaKeysSession))})},C._onNewMediaKeySession=function(u){var l=this;F.logger.log("New key-system session "+u.sessionId),u.addEventListener("message",function(c){l._onKeySessionMessage(u,c.message)},!1)},C._onKeySessionMessage=function(u,l){F.logger.log("Got EME message event, creating license request"),this._requestLicense(l,function(c){F.logger.log("Received license data (length: "+(c&&c.byteLength)+"), updating key-session"),u.update(c).catch(function(f){F.logger.warn("Updating key-session failed: "+f)})})},C.onMediaEncrypted=function(u){var l=this;if(F.logger.log('Media is encrypted using "'+u.initDataType+'" init data type'),!this.mediaKeysPromise){F.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var c=function(o){l._media&&(l._attemptSetMediaKeys(o),l._generateRequestWithPreferredKeySession(u.initDataType,u.initData))};this.mediaKeysPromise.then(c).catch(c)},C._attemptSetMediaKeys=function(u){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var l=this._mediaKeysList[0];if(!l||!l.mediaKeys){F.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}F.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(l.mediaKeys),this._hasSetMediaKeys=!0}},C._generateRequestWithPreferredKeySession=function(u,l){var c=this,f=this._mediaKeysList[0];if(!f){F.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(f.mediaKeysSessionInitialized){F.logger.warn("Key-Session already initialized but requested again");return}var o=f.mediaKeysSession;if(!o){F.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!l){F.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}F.logger.log('Generating key-session request for "'+u+'" init data type'),f.mediaKeysSessionInitialized=!0,o.generateRequest(u,l).then(function(){F.logger.debug("Key-session generation succeeded")}).catch(function(a){F.logger.error("Error generating key-session request:",a),c.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},C._createLicenseXhr=function(u,l,c){var f=new XMLHttpRequest;f.responseType="arraybuffer",f.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,f,u,l,c);var o=this._licenseXhrSetup;if(o)try{o.call(this.hls,f,u),o=void 0}catch(a){F.logger.error(a)}try{f.readyState||f.open("POST",u,!0),o&&o.call(this.hls,f,u)}catch(a){throw new Error("issue setting up KeySystem license XHR "+a)}return f},C._onLicenseRequestReadyStageChange=function(u,l,c,f){switch(u.readyState){case 4:if(u.status===200){this._requestLicenseFailureCount=0,F.logger.log("License request succeeded");var o=u.response,a=this._licenseResponseCallback;if(a)try{o=a.call(this.hls,u,l)}catch(d){F.logger.error(d)}f(o)}else{if(F.logger.error("License Request XHR failed ("+l+"). Status: "+u.status+" ("+u.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>I){this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var s=I-this._requestLicenseFailureCount+1;F.logger.warn("Retrying license request, "+s+" attempts left"),this._requestLicense(c,f)}break}},C._generateLicenseRequestChallenge=function(u,l){switch(u.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return l}throw new Error("unsupported key-system: "+u.mediaKeySystemDomain)},C._requestLicense=function(u,l){F.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c){F.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var f=this.getLicenseServerUrl(c.mediaKeySystemDomain),o=this._createLicenseXhr(f,u,l);F.logger.log("Sending license request to URL: "+f);var a=this._generateLicenseRequestChallenge(c,u);o.send(a)}catch(s){F.logger.error("Failure requesting DRM license: "+s),this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},C.onMediaAttached=function(u,l){if(this._emeEnabled){var c=l.media;this._media=c,c.addEventListener("encrypted",this._onMediaEncrypted)}},C.onMediaDetached=function(){var u=this._media,l=this._mediaKeysList;u&&(u.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(l.map(function(c){if(c.mediaKeysSession)return c.mediaKeysSession.close().catch(function(){})})).then(function(){return u.setMediaKeys(null)}).catch(function(){}))},C.onManifestParsed=function(u,l){if(this._emeEnabled){var c=l.levels.map(function(o){return o.audioCodec}).filter(function(o){return!!o}),f=l.levels.map(function(o){return o.videoCodec}).filter(function(o){return!!o});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,c,f)}},w(O,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),O}();const R=L},"./src/controller/fps-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>M});var N=m("./src/events.ts"),S=m("./src/utils/logger.ts"),F=function(){function K(I){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=I,this.registerListeners()}var w=K.prototype;return w.setStreamController=function(k){this.streamController=k},w.registerListeners=function(){this.hls.on(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},w.unregisterListeners=function(){this.hls.off(N.Events.MEDIA_ATTACHING,this.onMediaAttaching)},w.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},w.onMediaAttaching=function(k,x){var L=this.hls.config;if(L.capLevelOnFPSDrop){var R=x.media instanceof self.HTMLVideoElement?x.media:null;this.media=R,R&&typeof R.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),L.fpsDroppedMonitoringPeriod)}},w.checkFPS=function(k,x,L){var R=performance.now();if(x){if(this.lastTime){var O=R-this.lastTime,C=L-this.lastDroppedFrames,y=x-this.lastDecodedFrames,u=1e3*C/O,l=this.hls;if(l.trigger(N.Events.FPS_DROP,{currentDropped:C,currentDecoded:y,totalDroppedFrames:L}),u>0&&C>l.config.fpsDroppedMonitoringThreshold*y){var c=l.currentLevel;S.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=c)&&(c=c-1,l.trigger(N.Events.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=R,this.lastDroppedFrames=L,this.lastDecodedFrames=x}},w.checkFPSInterval=function(){var k=this.media;if(k)if(this.isVideoPlaybackQualityAvailable){var x=k.getVideoPlaybackQuality();this.checkFPS(k,x.totalVideoFrames,x.droppedVideoFrames)}else this.checkFPS(k,k.webkitDecodedFrameCount,k.webkitDroppedFrameCount)},K}();const M=F},"./src/controller/fragment-finders.ts":(b,P,m)=>{m.r(P),m.d(P,{findFragWithCC:()=>I,findFragmentByPDT:()=>F,findFragmentByPTS:()=>M,fragmentWithinToleranceTest:()=>K,pdtWithinToleranceTest:()=>w});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/binary-search.ts");function F(k,x,L){if(x===null||!Array.isArray(k)||!k.length||!(0,N.isFiniteNumber)(x))return null;var R=k[0].programDateTime;if(x<(R||0))return null;var O=k[k.length-1].endProgramDateTime;if(x>=(O||0))return null;L=L||0;for(var C=0;C<k.length;++C){var y=k[C];if(w(x,L,y))return y}return null}function M(k,x,L,R){L===void 0&&(L=0),R===void 0&&(R=0);var O=null;if(k?O=x[k.sn-x[0].sn+1]||null:L===0&&x[0].start===0&&(O=x[0]),O&&K(L,R,O)===0)return O;var C=S.default.search(x,K.bind(null,L,R));return C||O}function K(k,x,L){k===void 0&&(k=0),x===void 0&&(x=0);var R=Math.min(x,L.duration+(L.deltaPTS?L.deltaPTS:0));return L.start+L.duration-R<=k?1:L.start-R>k&&L.start?-1:0}function w(k,x,L){var R=Math.min(x,L.duration+(L.deltaPTS?L.deltaPTS:0))*1e3,O=L.endProgramDateTime||0;return O-R>k}function I(k,x){return S.default.search(k,function(L){return L.cc<x?1:L.cc>x?-1:0})}},"./src/controller/fragment-tracker.ts":(b,P,m)=>{m.r(P),m.d(P,{FragmentState:()=>F,FragmentTracker:()=>M});var N=m("./src/events.ts"),S=m("./src/types/loader.ts"),F;(function(I){I.NOT_LOADED="NOT_LOADED",I.APPENDING="APPENDING",I.PARTIAL="PARTIAL",I.OK="OK"})(F||(F={}));var M=function(){function I(x){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=x,this._registerListeners()}var k=I.prototype;return k._registerListeners=function(){var L=this.hls;L.on(N.Events.BUFFER_APPENDED,this.onBufferAppended,this),L.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),L.on(N.Events.FRAG_LOADED,this.onFragLoaded,this)},k._unregisterListeners=function(){var L=this.hls;L.off(N.Events.BUFFER_APPENDED,this.onBufferAppended,this),L.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),L.off(N.Events.FRAG_LOADED,this.onFragLoaded,this)},k.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},k.getAppendedFrag=function(L,R){if(R===S.PlaylistLevelType.MAIN){var O=this.activeFragment,C=this.activeParts;if(!O)return null;if(C)for(var y=C.length;y--;){var u=C[y],l=u?u.end:O.appendedPTS;if(u.start<=L&&l!==void 0&&L<=l)return y>9&&(this.activeParts=C.slice(y-9)),u}else if(O.start<=L&&O.appendedPTS!==void 0&&L<=O.appendedPTS)return O}return this.getBufferedFrag(L,R)},k.getBufferedFrag=function(L,R){for(var O=this.fragments,C=Object.keys(O),y=C.length;y--;){var u=O[C[y]];if((u==null?void 0:u.body.type)===R&&u.buffered){var l=u.body;if(l.start<=L&&L<=l.end)return l}}return null},k.detectEvictedFragments=function(L,R,O){var C=this;Object.keys(this.fragments).forEach(function(y){var u=C.fragments[y];if(u){if(!u.buffered){u.body.type===O&&C.removeFragment(u.body);return}var l=u.range[L];l&&l.time.some(function(c){var f=!C.isTimeBuffered(c.startPTS,c.endPTS,R);return f&&C.removeFragment(u.body),f})}})},k.detectPartialFragments=function(L){var R=this,O=this.timeRanges,C=L.frag,y=L.part;if(!(!O||C.sn==="initSegment")){var u=w(C),l=this.fragments[u];l&&(Object.keys(O).forEach(function(c){var f=C.elementaryStreams[c];if(f){var o=O[c],a=y!==null||f.partial===!0;l.range[c]=R.getBufferedTimes(C,y,a,o)}}),l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},k.fragBuffered=function(L){var R=w(L),O=this.fragments[R];O&&(O.loaded=null,O.buffered=!0)},k.getBufferedTimes=function(L,R,O,C){for(var y={time:[],partial:O},u=R?R.start:L.start,l=R?R.end:L.end,c=L.minEndPTS||l,f=L.maxStartPTS||u,o=0;o<C.length;o++){var a=C.start(o)-this.bufferPadding,s=C.end(o)+this.bufferPadding;if(f>=a&&c<=s){y.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});break}else if(u<s&&l>a)y.partial=!0,y.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});else if(l<=a)break}return y},k.getPartialFragment=function(L){var R=null,O,C,y,u=0,l=this.bufferPadding,c=this.fragments;return Object.keys(c).forEach(function(f){var o=c[f];o&&K(o)&&(C=o.body.start-l,y=o.body.end+l,L>=C&&L<=y&&(O=Math.min(L-C,y-L),u<=O&&(R=o.body,u=O)))}),R},k.getState=function(L){var R=w(L),O=this.fragments[R];return O?O.buffered?K(O)?F.PARTIAL:F.OK:F.APPENDING:F.NOT_LOADED},k.isTimeBuffered=function(L,R,O){for(var C,y,u=0;u<O.length;u++){if(C=O.start(u)-this.bufferPadding,y=O.end(u)+this.bufferPadding,L>=C&&R<=y)return!0;if(R<=C)return!1}return!1},k.onFragLoaded=function(L,R){var O=R.frag,C=R.part;if(!(O.sn==="initSegment"||O.bitrateTest||C)){var y=w(O);this.fragments[y]={body:O,loaded:R,buffered:!1,range:Object.create(null)}}},k.onBufferAppended=function(L,R){var O=this,C=R.frag,y=R.part,u=R.timeRanges;if(C.type===S.PlaylistLevelType.MAIN)if(this.activeFragment=C,y){var l=this.activeParts;l||(this.activeParts=l=[]),l.push(y)}else this.activeParts=null;this.timeRanges=u,Object.keys(u).forEach(function(c){var f=u[c];if(O.detectEvictedFragments(c,f),!y)for(var o=0;o<f.length;o++)C.appendedPTS=Math.max(f.end(o),C.appendedPTS||0)})},k.onFragBuffered=function(L,R){this.detectPartialFragments(R)},k.hasFragment=function(L){var R=w(L);return!!this.fragments[R]},k.removeFragmentsInRange=function(L,R,O){var C=this;Object.keys(this.fragments).forEach(function(y){var u=C.fragments[y];if(u&&u.buffered){var l=u.body;l.type===O&&l.start<R&&l.end>L&&C.removeFragment(l)}})},k.removeFragment=function(L){var R=w(L);L.stats.loaded=0,L.clearElementaryStreamInfo(),delete this.fragments[R]},k.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},I}();function K(I){var k,x;return I.buffered&&(((k=I.range.video)===null||k===void 0?void 0:k.partial)||((x=I.range.audio)===null||x===void 0?void 0:x.partial))}function w(I){return I.type+"_"+I.level+"_"+I.urlId+"_"+I.sn}},"./src/controller/gap-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{MAX_START_GAP_JUMP:()=>w,SKIP_BUFFER_HOLE_STEP_SECONDS:()=>I,SKIP_BUFFER_RANGE_START:()=>k,STALL_MINIMUM_DURATION_MS:()=>K,default:()=>x});var N=m("./src/utils/buffer-helper.ts"),S=m("./src/errors.ts"),F=m("./src/events.ts"),M=m("./src/utils/logger.ts"),K=250,w=2,I=.1,k=.05,x=function(){function L(O,C,y,u){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=O,this.media=C,this.fragmentTracker=y,this.hls=u}var R=L.prototype;return R.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},R.poll=function(C,y){var u=this.config,l=this.media,c=this.stalled;if(l!==null){var f=l.currentTime,o=l.seeking,a=this.seeking&&!o,s=!this.seeking&&o;if(this.seeking=o,f!==C){if(this.moved=!0,c!==null){if(this.stallReported){var d=self.performance.now()-c;M.logger.warn("playback not stuck anymore @"+f+", after "+Math.round(d)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((s||a)&&(this.stalled=null),!(l.paused&&!o||l.ended||l.playbackRate===0||!N.BufferHelper.getBuffered(l).length)){var p=N.BufferHelper.bufferInfo(l,f,0),_=p.len>0,h=p.nextStart||0;if(!(!_&&!h)){if(o){var A=p.len>w,E=!h||y&&y.start<=f||h-f>w&&!this.fragmentTracker.getPartialFragment(f);if(A||E)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var v,T=Math.max(h,p.start||0)-f,D=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,B=D==null||(v=D.details)===null||v===void 0?void 0:v.live,V=B?D.details.targetduration*2:w;if(T>0&&T<=V){this._trySkipBufferHole(null);return}}var W=self.performance.now();if(c===null){this.stalled=W;return}var j=W-c;if(!(!o&&j>=K&&(this._reportStall(p),!this.media))){var $=N.BufferHelper.bufferInfo(l,f,u.maxBufferHole);this._tryFixBufferStall($,j)}}}}},R._tryFixBufferStall=function(C,y){var u=this.config,l=this.fragmentTracker,c=this.media;if(c!==null){var f=c.currentTime,o=l.getPartialFragment(f);if(o){var a=this._trySkipBufferHole(o);if(a||!this.media)return}C.len>u.maxBufferHole&&y>u.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},R._reportStall=function(C){var y=this.hls,u=this.media,l=this.stallReported;!l&&u&&(this.stallReported=!0,M.logger.warn("Playback stalling at @"+u.currentTime+" due to low buffer ("+JSON.stringify(C)+")"),y.trigger(F.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:C.len}))},R._trySkipBufferHole=function(C){var y=this.config,u=this.hls,l=this.media;if(l===null)return 0;for(var c=l.currentTime,f=0,o=N.BufferHelper.getBuffered(l),a=0;a<o.length;a++){var s=o.start(a);if(c+y.maxBufferHole>=f&&c<s){var d=Math.max(s+k,l.currentTime+I);return M.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+d),this.moved=!0,this.stalled=null,l.currentTime=d,C&&u.trigger(F.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+d,frag:C}),d}f=o.end(a)}return 0},R._tryNudgeBuffer=function(){var C=this.config,y=this.hls,u=this.media,l=this.nudgeRetry;if(u!==null){var c=u.currentTime;if(this.nudgeRetry++,l<C.nudgeMaxRetry){var f=c+(l+1)*C.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+c+" to "+f),u.currentTime=f,y.trigger(F.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+C.nudgeMaxRetry+" nudges"),y.trigger(F.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},L}()},"./src/controller/id3-track-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>C});var N=m("./src/polyfills/number.ts"),S=m("./src/events.ts"),F=m("./src/utils/texttrack-utils.ts"),M=m("./src/demux/id3.ts"),K=m("./src/loader/date-range.ts"),w=m("./src/types/demuxer.ts"),I=.25;function k(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var x=function(){var y=k();try{new y(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function L(y,u){return y.getTime()/1e3-u}function R(y){return Uint8Array.from(y.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var O=function(){function y(l){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=l,this._registerListeners()}var u=y.prototype;return u.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},u._registerListeners=function(){var c=this.hls;c.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u._unregisterListeners=function(){var c=this.hls;c.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u.onMediaAttached=function(c,f){this.media=f.media},u.onMediaDetaching=function(){this.id3Track&&((0,F.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},u.onManifestLoading=function(){this.dateRangeCuesAppended={}},u.createTrack=function(c){var f=this.getID3Track(c.textTracks);return f.mode="hidden",f},u.getID3Track=function(c){if(this.media){for(var f=0;f<c.length;f++){var o=c[f];if(o.kind==="metadata"&&o.label==="id3")return(0,F.sendAddTrackEvent)(o,this.media),o}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(c,f){if(this.media){var o=this.hls.config,a=o.enableEmsgMetadataCues,s=o.enableID3MetadataCues;if(!(!a&&!s)){f.frag;var d=f.samples;f.details,this.id3Track||(this.id3Track=this.createTrack(this.media));for(var p=k(),_=0;_<d.length;_++){var h=d[_].type;if(!(h===w.MetadataSchema.emsg&&!a||!s)){var A=M.getID3Frames(d[_].data);if(A){var E=d[_].pts,v=E+d[_].duration;v>x&&(v=x);var T=v-E;T<=0&&(v=E+I);for(var D=0;D<A.length;D++){var B=A[D];if(!M.isTimeStampFrame(B)){this.updateId3CueEnds(E);var V=new p(E,v,"");V.value=B,h&&(V.type=h),this.id3Track.addCue(V)}}}}}}}},u.updateId3CueEnds=function(c){var f,o=(f=this.id3Track)===null||f===void 0?void 0:f.cues;if(o)for(var a=o.length;a--;){var s=o[a];s.startTime<c&&s.endTime===x&&(s.endTime=c)}},u.onBufferFlushing=function(c,f){var o=f.startOffset,a=f.endOffset,s=f.type,d=this.id3Track,p=this.hls;if(p){var _=p.config,h=_.enableEmsgMetadataCues,A=_.enableID3MetadataCues;if(d&&(h||A)){var E;s==="audio"?E=function(T){return T.type===w.MetadataSchema.audioId3&&A}:s==="video"?E=function(T){return T.type===w.MetadataSchema.emsg&&h}:E=function(T){return T.type===w.MetadataSchema.audioId3&&A||T.type===w.MetadataSchema.emsg&&h},(0,F.removeCuesInRange)(d,o,a,E)}}},u.onLevelUpdated=function(c,f){var o=this,a=f.details;if(!(!this.media||!a.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var s=this.dateRangeCuesAppended,d=this.id3Track,p=a.dateRanges,_=Object.keys(p);if(d)for(var h=Object.keys(s).filter(function(W){return!_.includes(W)}),A=function(j){var $=h[j];Object.keys(s[$].cues).forEach(function(Q){d.removeCue(s[$].cues[Q])}),delete s[$]},E=h.length;E--;)A(E);var v=a.fragments[a.fragments.length-1];if(!(_.length===0||!(0,N.isFiniteNumber)(v==null?void 0:v.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var T=v.programDateTime/1e3-v.start,D=k(),B=function(j){var $=_[j],Q=p[$],Z=s[$],ee=(Z==null?void 0:Z.cues)||{},ae=(Z==null?void 0:Z.durationKnown)||!1,se=L(Q.startDate,T),Y=x,X=Q.endDate;if(X)Y=L(X,T),ae=!0;else if(Q.endOnNext&&!ae){var q=_.reduce(function(J,te){var ie=p[te];return ie.class===Q.class&&ie.id!==te&&ie.startDate>Q.startDate&&J.push(ie),J},[]).sort(function(J,te){return J.startDate.getTime()-te.startDate.getTime()})[0];q&&(Y=L(q.startDate,T),ae=!0)}for(var re=Object.keys(Q.attr),ne=0;ne<re.length;ne++){var U=re[ne];if(!(U===K.DateRangeAttribute.ID||U===K.DateRangeAttribute.CLASS||U===K.DateRangeAttribute.START_DATE||U===K.DateRangeAttribute.DURATION||U===K.DateRangeAttribute.END_DATE||U===K.DateRangeAttribute.END_ON_NEXT)){var H=ee[U];if(H)ae&&!Z.durationKnown&&(H.endTime=Y);else{var z=Q.attr[U];H=new D(se,Y,""),(U===K.DateRangeAttribute.SCTE35_OUT||U===K.DateRangeAttribute.SCTE35_IN)&&(z=R(z)),H.value={key:U,data:z},H.type=w.MetadataSchema.dateRange,o.id3Track.addCue(H),ee[U]=H}}}s[$]={cues:ee,dateRange:Q,durationKnown:ae}},V=0;V<_.length;V++)B(V)}}},y}();const C=O},"./src/controller/latency-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>w});var N=m("./src/errors.ts"),S=m("./src/events.ts"),F=m("./src/utils/logger.ts");function M(I,k){for(var x=0;x<k.length;x++){var L=k[x];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(I,L.key,L)}}function K(I,k,x){return k&&M(I.prototype,k),x&&M(I,x),Object.defineProperty(I,"prototype",{writable:!1}),I}var w=function(){function I(x){var L=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return L.timeupdate()},this.hls=x,this.config=x.config,this.registerListeners()}var k=I.prototype;return k.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},k.registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(S.Events.ERROR,this.onError,this)},k.unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(S.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(S.Events.ERROR,this.onError)},k.onMediaAttached=function(L,R){this.media=R.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},k.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},k.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},k.onLevelUpdated=function(L,R){var O=R.details;this.levelDetails=O,O.advanced&&this.timeupdate(),!O.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},k.onError=function(L,R){R.details===N.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,F.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},k.timeupdate=function(){var L=this.media,R=this.levelDetails;if(!(!L||!R)){this.currentTime=L.currentTime;var O=this.computeLatency();if(O!==null){this._latency=O;var C=this.config,y=C.lowLatencyMode,u=C.maxLiveSyncPlaybackRate;if(!(!y||u===1)){var l=this.targetLatency;if(l!==null){var c=O-l,f=Math.min(this.maxLatency,l+R.targetduration),o=c<f;if(R.live&&o&&c>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,u)),s=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;L.playbackRate=Math.min(a,Math.max(1,s))}else L.playbackRate!==1&&L.playbackRate!==0&&(L.playbackRate=1)}}}}},k.estimateLiveEdge=function(){var L=this.levelDetails;return L===null?null:L.edge+L.age},k.computeLatency=function(){var L=this.estimateLiveEdge();return L===null?null:L-this.currentTime},K(I,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var L=this.config,R=this.levelDetails;return L.liveMaxLatencyDuration!==void 0?L.liveMaxLatencyDuration:R?L.liveMaxLatencyDurationCount*R.targetduration:0}},{key:"targetLatency",get:function(){var L=this.levelDetails;if(L===null)return null;var R=L.holdBack,O=L.partHoldBack,C=L.targetduration,y=this.config,u=y.liveSyncDuration,l=y.liveSyncDurationCount,c=y.lowLatencyMode,f=this.hls.userConfig,o=c&&O||R;(f.liveSyncDuration||f.liveSyncDurationCount||o===0)&&(o=u!==void 0?u:l*C);var a=C,s=1;return o+Math.min(this.stallCount*s,a)}},{key:"liveSyncPosition",get:function(){var L=this.estimateLiveEdge(),R=this.targetLatency,O=this.levelDetails;if(L===null||R===null||O===null)return null;var C=O.edge,y=L-R-this.edgeStalled,u=C-O.totalduration,l=C-(this.config.lowLatencyMode&&O.partTarget||O.targetduration);return Math.min(Math.max(u,y),l)}},{key:"drift",get:function(){var L=this.levelDetails;return L===null?1:L.drift}},{key:"edgeStalled",get:function(){var L=this.levelDetails;if(L===null)return 0;var R=(this.config.lowLatencyMode&&L.partTarget||L.targetduration)*3;return Math.max(L.age-R,0)}},{key:"forwardBufferLength",get:function(){var L=this.media,R=this.levelDetails;if(!L||!R)return 0;var O=L.buffered.length;return(O?L.buffered.end(O-1):R.edge)-this.currentTime}}]),I}()},"./src/controller/level-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>y});var N=m("./src/types/level.ts"),S=m("./src/events.ts"),F=m("./src/errors.ts"),M=m("./src/utils/codecs.ts"),K=m("./src/controller/level-helper.ts"),w=m("./src/controller/base-playlist-controller.ts"),I=m("./src/types/loader.ts");function k(){return k=Object.assign?Object.assign.bind():function(u){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(u[f]=c[f])}return u},k.apply(this,arguments)}function x(u,l){for(var c=0;c<l.length;c++){var f=l[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}function L(u,l,c){return l&&x(u.prototype,l),c&&x(u,c),Object.defineProperty(u,"prototype",{writable:!1}),u}function R(u,l){u.prototype=Object.create(l.prototype),u.prototype.constructor=u,O(u,l)}function O(u,l){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,o){return f.__proto__=o,f},O(u,l)}var C=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),y=function(u){R(l,u);function l(f){var o;return o=u.call(this,f,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var c=l.prototype;return c._registerListeners=function(){var o=this.hls;o.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(S.Events.ERROR,this.onError,this)},c._unregisterListeners=function(){var o=this.hls;o.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(S.Events.ERROR,this.onError,this)},c.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,u.prototype.destroy.call(this)},c.startLoad=function(){var o=this._levels;o.forEach(function(a){a.loadError=0}),u.prototype.startLoad.call(this)},c.onManifestLoaded=function(o,a){var s=[],d=[],p=[],_,h={},A,E=!1,v=!1,T=!1;if(a.levels.forEach(function(W){var j=W.attrs;E=E||!!(W.width&&W.height),v=v||!!W.videoCodec,T=T||!!W.audioCodec,C&&W.audioCodec&&W.audioCodec.indexOf("mp4a.40.34")!==-1&&(W.audioCodec=void 0);var $=W.bitrate+"-"+W.attrs.RESOLUTION+"-"+W.attrs.CODECS;A=h[$],A?A.url.push(W.url):(A=new N.Level(W),h[$]=A,s.push(A)),j&&(j.AUDIO&&(0,K.addGroupId)(A,"audio",j.AUDIO),j.SUBTITLES&&(0,K.addGroupId)(A,"text",j.SUBTITLES))}),(E||v)&&T&&(s=s.filter(function(W){var j=W.videoCodec,$=W.width,Q=W.height;return!!j||!!($&&Q)})),s=s.filter(function(W){var j=W.audioCodec,$=W.videoCodec;return(!j||(0,M.isCodecSupportedInMp4)(j,"audio"))&&(!$||(0,M.isCodecSupportedInMp4)($,"video"))}),a.audioTracks&&(d=a.audioTracks.filter(function(W){return!W.audioCodec||(0,M.isCodecSupportedInMp4)(W.audioCodec,"audio")}),(0,K.assignTrackIdsByGroup)(d)),a.subtitles&&(p=a.subtitles,(0,K.assignTrackIdsByGroup)(p)),s.length>0){_=s[0].bitrate,s.sort(function(W,j){return W.bitrate-j.bitrate}),this._levels=s;for(var D=0;D<s.length;D++)if(s[D].bitrate===_){this._firstLevel=D,this.log("manifest loaded, "+s.length+" level(s) found, first bitrate: "+_);break}var B=T&&!v,V={levels:s,audioTracks:d,subtitleTracks:p,firstLevel:this._firstLevel,stats:a.stats,audio:T,video:v,altAudio:!B&&d.some(function(W){return!!W.url})};this.hls.trigger(S.Events.MANIFEST_PARSED,V),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(S.Events.ERROR,{type:F.ErrorTypes.MEDIA_ERROR,details:F.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},c.onError=function(o,a){var s;if(u.prototype.onError.call(this,o,a),!a.fatal){var d=a.context,p=this._levels[this.currentLevelIndex];if(d&&(d.type===I.PlaylistContextType.AUDIO_TRACK&&p.audioGroupIds&&d.groupId===p.audioGroupIds[p.urlId]||d.type===I.PlaylistContextType.SUBTITLE_TRACK&&p.textGroupIds&&d.groupId===p.textGroupIds[p.urlId])){this.redundantFailover(this.currentLevelIndex);return}var _=!1,h=!0,A;switch(a.details){case F.ErrorDetails.FRAG_LOAD_ERROR:case F.ErrorDetails.FRAG_LOAD_TIMEOUT:case F.ErrorDetails.KEY_LOAD_ERROR:case F.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var E=a.frag.type===I.PlaylistLevelType.MAIN?a.frag.level:this.currentLevelIndex,v=this._levels[E];v?(v.fragmentError++,v.fragmentError>this.hls.config.fragLoadingMaxRetry&&(A=E)):A=E}break;case F.ErrorDetails.LEVEL_LOAD_ERROR:case F.ErrorDetails.LEVEL_LOAD_TIMEOUT:d&&(d.deliveryDirectives&&(h=!1),A=d.level),_=!0;break;case F.ErrorDetails.REMUX_ALLOC_ERROR:A=(s=a.level)!=null?s:this.currentLevelIndex,_=!0;break}A!==void 0&&this.recoverLevel(a,A,_,h)}},c.recoverLevel=function(o,a,s,d){var p=o.details,_=this._levels[a];if(_.loadError++,s){var h=this.retryLoadingOrFail(o);if(h)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(d){var A=_.url.length;if(A>1&&_.loadError<A)o.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){for(var E=-1,v=this._levels,T=v.length;T--;){var D=(T+this.currentLevelIndex)%v.length;if(D!==this.currentLevelIndex&&v[D].loadError===0){E=D;break}}E>-1&&this.currentLevelIndex!==E&&(this.warn(p+": switch to "+E),o.levelRetry=!0,this.hls.nextAutoLevel=E)}}},c.redundantFailover=function(o){var a=this._levels[o],s=a.url.length;if(s>1){var d=(a.urlId+1)%s;this.warn("Switching to redundant URL-id "+d),this._levels.forEach(function(p){p.urlId=d}),this.level=o}},c.onFragLoaded=function(o,a){var s=a.frag;if(s!==void 0&&s.type===I.PlaylistLevelType.MAIN){var d=this._levels[s.level];d!==void 0&&(d.fragmentError=0,d.loadError=0)}},c.onLevelLoaded=function(o,a){var s,d=a.level,p=a.details,_=this._levels[d];if(!_){var h;this.warn("Invalid level index "+d),(h=a.deliveryDirectives)!==null&&h!==void 0&&h.skip&&(p.deltaUpdateFailed=!0);return}d===this.currentLevelIndex?(_.fragmentError===0&&(_.loadError=0,this.retryCount=0),this.playlistLoaded(d,a,_.details)):(s=a.deliveryDirectives)!==null&&s!==void 0&&s.skip&&(p.deltaUpdateFailed=!0)},c.onAudioTrackSwitched=function(o,a){var s=this.hls.levels[this.currentLevelIndex];if(s&&s.audioGroupIds){for(var d=-1,p=this.hls.audioTracks[a.id].groupId,_=0;_<s.audioGroupIds.length;_++)if(s.audioGroupIds[_]===p){d=_;break}d!==s.urlId&&(s.urlId=d,this.startLoad())}},c.loadPlaylist=function(o){var a=this.currentLevelIndex,s=this._levels[a];if(this.canLoad&&s&&s.url.length>0){var d=s.urlId,p=s.url[d];if(o)try{p=o.addDirectives(p)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("Attempt loading level index "+a+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+d+" "+p),this.clearTimer(),this.hls.trigger(S.Events.LEVEL_LOADING,{url:p,level:a,id:d,deliveryDirectives:o||null})}},c.removeLevel=function(o,a){var s=function(_,h){return h!==a},d=this._levels.filter(function(p,_){return _!==o?!0:p.url.length>1&&a!==void 0?(p.url=p.url.filter(s),p.audioGroupIds&&(p.audioGroupIds=p.audioGroupIds.filter(s)),p.textGroupIds&&(p.textGroupIds=p.textGroupIds.filter(s)),p.urlId=0,!0):!1}).map(function(p,_){var h=p.details;return h!=null&&h.fragments&&h.fragments.forEach(function(A){A.level=_}),p});this._levels=d,this.hls.trigger(S.Events.LEVELS_UPDATED,{levels:d})},L(l,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var a,s=this._levels;if(s.length!==0&&!(this.currentLevelIndex===o&&(a=s[o])!==null&&a!==void 0&&a.details)){if(o<0||o>=s.length){var d=o<0;if(this.hls.trigger(S.Events.ERROR,{type:F.ErrorTypes.OTHER_ERROR,details:F.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:d,reason:"invalid level idx"}),d)return;o=Math.min(o,s.length-1)}this.clearTimer();var p=this.currentLevelIndex,_=s[p],h=s[o];this.log("switching to level "+o+" from "+p),this.currentLevelIndex=o;var A=k({},h,{level:o,maxBitrate:h.maxBitrate,uri:h.uri,urlId:h.urlId});delete A._urlId,this.hls.trigger(S.Events.LEVEL_SWITCHING,A);var E=h.details;if(!E||E.live){var v=this.switchParams(h.uri,_==null?void 0:_.details);this.loadPlaylist(v)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),l}(w.default)},"./src/controller/level-helper.ts":(b,P,m)=>{m.r(P),m.d(P,{addGroupId:()=>K,addSliding:()=>u,adjustSliding:()=>y,assignTrackIdsByGroup:()=>w,computeReloadInterval:()=>l,getFragmentWithSN:()=>c,getPartWith:()=>f,mapFragmentIntersection:()=>C,mapPartIntersection:()=>O,mergeDetails:()=>L,updateFragPTSDTS:()=>x,updatePTS:()=>I});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/logger.ts"),F=m("./src/loader/date-range.ts");function M(){return M=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(o[d]=s[d])}return o},M.apply(this,arguments)}function K(o,a,s){switch(a){case"audio":o.audioGroupIds||(o.audioGroupIds=[]),o.audioGroupIds.push(s);break;case"text":o.textGroupIds||(o.textGroupIds=[]),o.textGroupIds.push(s);break}}function w(o){var a={};o.forEach(function(s){var d=s.groupId||"";s.id=a[d]=a[d]||0,a[d]++})}function I(o,a,s){var d=o[a],p=o[s];k(d,p)}function k(o,a){var s=a.startPTS;if((0,N.isFiniteNumber)(s)){var d=0,p;a.sn>o.sn?(d=s-o.start,p=o):(d=o.start-s,p=a),p.duration!==d&&(p.duration=d)}else if(a.sn>o.sn){var _=o.cc===a.cc;_&&o.minEndPTS?a.start=o.start+(o.minEndPTS-o.start):a.start=o.start+o.duration}else a.start=Math.max(o.start-a.duration,0)}function x(o,a,s,d,p,_){var h=d-s;h<=0&&(S.logger.warn("Fragment should have a positive duration",a),d=s+a.duration,_=p+a.duration);var A=s,E=d,v=a.startPTS,T=a.endPTS;if((0,N.isFiniteNumber)(v)){var D=Math.abs(v-s);(0,N.isFiniteNumber)(a.deltaPTS)?a.deltaPTS=Math.max(D,a.deltaPTS):a.deltaPTS=D,A=Math.max(s,v),s=Math.min(s,v),p=Math.min(p,a.startDTS),E=Math.min(d,T),d=Math.max(d,T),_=Math.max(_,a.endDTS)}a.duration=d-s;var B=s-a.start;a.appendedPTS=d,a.start=a.startPTS=s,a.maxStartPTS=A,a.startDTS=p,a.endPTS=d,a.minEndPTS=E,a.endDTS=_;var V=a.sn;if(!o||V<o.startSN||V>o.endSN)return 0;var W,j=V-o.startSN,$=o.fragments;for($[j]=a,W=j;W>0;W--)k($[W],$[W-1]);for(W=j;W<$.length-1;W++)k($[W],$[W+1]);return o.fragmentHint&&k($[$.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,B}function L(o,a){for(var s=null,d=o.fragments,p=d.length-1;p>=0;p--){var _=d[p].initSegment;if(_){s=_;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;var h=0,A;if(C(o,a,function(W,j){W.relurl&&(h=W.cc-j.cc),(0,N.isFiniteNumber)(W.startPTS)&&(0,N.isFiniteNumber)(W.endPTS)&&(j.start=j.startPTS=W.startPTS,j.startDTS=W.startDTS,j.appendedPTS=W.appendedPTS,j.maxStartPTS=W.maxStartPTS,j.endPTS=W.endPTS,j.endDTS=W.endDTS,j.minEndPTS=W.minEndPTS,j.duration=W.endPTS-W.startPTS,j.duration&&(A=j),a.PTSKnown=a.alignedSliding=!0),j.elementaryStreams=W.elementaryStreams,j.loader=W.loader,j.stats=W.stats,j.urlId=W.urlId,W.initSegment&&(j.initSegment=W.initSegment,s=W.initSegment)}),s){var E=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;E.forEach(function(W){var j;(!W.initSegment||W.initSegment.relurl===((j=s)===null||j===void 0?void 0:j.relurl))&&(W.initSegment=s)})}if(a.skippedSegments)if(a.deltaUpdateFailed=a.fragments.some(function(W){return!W}),a.deltaUpdateFailed){S.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var v=a.skippedSegments;v--;)a.fragments.shift();a.startSN=a.fragments[0].sn,a.startCC=a.fragments[0].cc}else a.canSkipDateRanges&&(a.dateRanges=R(o.dateRanges,a.dateRanges,a.recentlyRemovedDateranges));var T=a.fragments;if(h){S.logger.warn("discontinuity sliding from playlist, take drift into account");for(var D=0;D<T.length;D++)T[D].cc+=h}a.skippedSegments&&(a.startCC=a.fragments[0].cc),O(o.partList,a.partList,function(W,j){j.elementaryStreams=W.elementaryStreams,j.stats=W.stats}),A?x(a,A,A.startPTS,A.endPTS,A.startDTS,A.endDTS):y(o,a),T.length&&(a.totalduration=a.edge-T[0].start),a.driftStartTime=o.driftStartTime,a.driftStart=o.driftStart;var B=a.advancedDateTime;if(a.advanced&&B){var V=a.edge;a.driftStart||(a.driftStartTime=B,a.driftStart=V),a.driftEndTime=B,a.driftEnd=V}else a.driftEndTime=o.driftEndTime,a.driftEnd=o.driftEnd,a.advancedDateTime=o.advancedDateTime}function R(o,a,s){var d=M({},o);return s&&s.forEach(function(p){delete d[p]}),Object.keys(a).forEach(function(p){var _=new F.DateRange(a[p].attr,d[p]);_.isValid?d[p]=_:S.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(a[p].attr)+'"')}),d}function O(o,a,s){if(o&&a)for(var d=0,p=0,_=o.length;p<=_;p++){var h=o[p],A=a[p+d];h&&A&&h.index===A.index&&h.fragment.sn===A.fragment.sn?s(h,A):d--}}function C(o,a,s){for(var d=a.skippedSegments,p=Math.max(o.startSN,a.startSN)-a.startSN,_=(o.fragmentHint?1:0)+(d?a.endSN:Math.min(o.endSN,a.endSN))-a.startSN,h=a.startSN-o.startSN,A=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments,E=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments,v=p;v<=_;v++){var T=E[h+v],D=A[v];d&&!D&&v<d&&(D=a.fragments[v]=T),T&&D&&s(T,D)}}function y(o,a){var s=a.startSN+a.skippedSegments-o.startSN,d=o.fragments;s<0||s>=d.length||u(a,d[s].start)}function u(o,a){if(a){for(var s=o.fragments,d=o.skippedSegments;d<s.length;d++)s[d].start+=a;o.fragmentHint&&(o.fragmentHint.start+=a)}}function l(o,a){var s=1e3*o.levelTargetDuration,d=s/2,p=o.age,_=p>0&&p<s*3,h=a.loading.end-a.loading.start,A,E=o.availabilityDelay;if(o.updated===!1)if(_){var v=333*o.misses;A=Math.max(Math.min(d,h*2),v),o.availabilityDelay=(o.availabilityDelay||0)+A}else A=d;else _?(E=Math.min(E||s/2,p),o.availabilityDelay=E,A=E+s-p):A=s-h;return Math.round(A)}function c(o,a,s){if(!o||!o.details)return null;var d=o.details,p=d.fragments[a-d.startSN];return p||(p=d.fragmentHint,p&&p.sn===a)?p:a<d.startSN&&s&&s.sn===a?s:null}function f(o,a,s){if(!o||!o.details)return null;var d=o.details.partList;if(d)for(var p=d.length;p--;){var _=d[p];if(_.index===s&&_.fragment.sn===a)return _}return null}},"./src/controller/stream-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>f});var N=m("./src/polyfills/number.ts"),S=m("./src/controller/base-stream-controller.ts"),F=m("./src/is-supported.ts"),M=m("./src/events.ts"),K=m("./src/utils/buffer-helper.ts"),w=m("./src/controller/fragment-tracker.ts"),I=m("./src/types/loader.ts"),k=m("./src/loader/fragment.ts"),x=m("./src/demux/transmuxer-interface.ts"),L=m("./src/types/transmuxer.ts"),R=m("./src/controller/gap-controller.ts"),O=m("./src/errors.ts");function C(o,a){for(var s=0;s<a.length;s++){var d=a[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(o,d.key,d)}}function y(o,a,s){return a&&C(o.prototype,a),s&&C(o,s),Object.defineProperty(o,"prototype",{writable:!1}),o}function u(o,a){o.prototype=Object.create(a.prototype),o.prototype.constructor=o,l(o,a)}function l(o,a){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,p){return d.__proto__=p,d},l(o,a)}var c=100,f=function(o){u(a,o);function a(d,p){var _;return _=o.call(this,d,p,"[stream-controller]")||this,_.audioCodecSwap=!1,_.gapController=null,_.level=-1,_._forceStartLoad=!1,_.altAudio=!1,_.audioOnly=!1,_.fragPlaying=null,_.onvplaying=null,_.onvseeked=null,_.fragLastKbps=0,_.couldBacktrack=!1,_.backtrackFragment=null,_.audioCodecSwitch=!1,_.videoBuffer=null,_._registerListeners(),_}var s=a.prototype;return s._registerListeners=function(){var p=this.hls;p.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),p.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),p.on(M.Events.ERROR,this.onError,this),p.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),p.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),p.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var p=this.hls;p.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),p.off(M.Events.ERROR,this.onError,this),p.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),p.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),p.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},s.startLoad=function(p){if(this.levels){var _=this.lastCurrentTime,h=this.hls;if(this.stopLoad(),this.setInterval(c),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var A=h.startLevel;A===-1&&(h.config.testBandwidth&&this.levels.length>1?(A=0,this.bitrateTest=!0):A=h.nextAutoLevel),this.level=h.nextLoadLevel=A,this.loadedmetadata=!1}_>0&&p===-1&&(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),p=_),this.state=S.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=p,this.tick()}else this._forceStartLoad=!0,this.state=S.State.STOPPED},s.stopLoad=function(){this._forceStartLoad=!1,o.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_LEVEL:{var p,_=this.levels,h=this.level,A=_==null||(p=_[h])===null||p===void 0?void 0:p.details;if(A&&(!A.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(A))break;this.state=S.State.IDLE;break}break}case S.State.FRAG_LOADING_WAITING_RETRY:{var E,v=self.performance.now(),T=this.retryDate;(!T||v>=T||(E=this.media)!==null&&E!==void 0&&E.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=S.State.IDLE)}break}this.onTickEnd()},s.onTickEnd=function(){o.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},s.doTickIdle=function(){var p,_,h=this.hls,A=this.levelLastLoaded,E=this.levels,v=this.media,T=h.config,D=h.nextLoadLevel;if(!(A===null||!v&&(this.startFragRequested||!T.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!E||!E[D])){var B=E[D];this.level=h.nextLoadLevel=D;var V=B.details;if(!V||this.state===S.State.WAITING_LEVEL||V.live&&this.levelLastLoaded!==D){this.state=S.State.WAITING_LEVEL;return}var W=this.getMainFwdBufferInfo();if(W!==null){var j=W.len,$=this.getMaxBufferLength(B.maxBitrate);if(!(j>=$)){if(this._streamEnded(W,V)){var Q={};this.altAudio&&(Q.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,Q),this.state=S.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>W.end&&(this.backtrackFragment=null);var Z=this.backtrackFragment?this.backtrackFragment.start:W.end,ee=this.getNextFragment(Z,V);if(this.couldBacktrack&&!this.fragPrevious&&ee&&ee.sn!=="initSegment"&&this.fragmentTracker.getState(ee)!==w.FragmentState.OK){var ae,se=((ae=this.backtrackFragment)!=null?ae:ee).sn,Y=se-V.startSN,X=V.fragments[Y-1];X&&ee.cc===X.cc&&(ee=X,this.fragmentTracker.removeFragment(X))}else this.backtrackFragment&&W.len&&(this.backtrackFragment=null);if(ee&&this.fragmentTracker.getState(ee)===w.FragmentState.OK&&this.nextLoadPosition>Z){var q=this.audioOnly&&!this.altAudio?k.ElementaryStreamTypes.AUDIO:k.ElementaryStreamTypes.VIDEO;v&&this.afterBufferFlushed(v,q,I.PlaylistLevelType.MAIN),ee=this.getNextFragment(this.nextLoadPosition,V)}ee&&(ee.initSegment&&!ee.initSegment.data&&!this.bitrateTest&&(ee=ee.initSegment),((p=ee.decryptdata)===null||p===void 0?void 0:p.keyFormat)==="identity"&&!((_=ee.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(ee,V):this.loadFragment(ee,V,Z))}}}},s.loadFragment=function(p,_,h){var A,E=this.fragmentTracker.getState(p);this.fragCurrent=p,E===w.FragmentState.NOT_LOADED?p.sn==="initSegment"?this._loadInitSegment(p):this.bitrateTest?(this.log("Fragment "+p.sn+" of level "+p.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(p)):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,p,_,h)):E===w.FragmentState.APPENDING?this.reduceMaxBufferLength(p.duration)&&this.fragmentTracker.removeFragment(p):((A=this.media)===null||A===void 0?void 0:A.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},s.getAppendedFrag=function(p){var _=this.fragmentTracker.getAppendedFrag(p,I.PlaylistLevelType.MAIN);return _&&"fragment"in _?_.fragment:_},s.getBufferedFrag=function(p){return this.fragmentTracker.getBufferedFrag(p,I.PlaylistLevelType.MAIN)},s.followingBufferedFrag=function(p){return p?this.getBufferedFrag(p.end+.5):null},s.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.nextLevelSwitch=function(){var p=this.levels,_=this.media;if(_!=null&&_.readyState){var h,A=this.getAppendedFrag(_.currentTime);if(A&&A.start>1&&this.flushMainBuffer(0,A.start-1),!_.paused&&p){var E=this.hls.nextLoadLevel,v=p[E],T=this.fragLastKbps;T&&this.fragCurrent?h=this.fragCurrent.duration*v.maxBitrate/(1e3*T)+1:h=0}else h=0;var D=this.getBufferedFrag(_.currentTime+h);if(D){var B=this.followingBufferedFrag(D);if(B){this.abortCurrentFrag();var V=B.maxStartPTS?B.maxStartPTS:B.start,W=B.duration,j=Math.max(D.end,V+Math.min(Math.max(W-this.config.maxFragLookUpTolerance,W*.5),W*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},s.abortCurrentFrag=function(){var p=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,p!=null&&p.loader&&p.loader.abort(),this.state){case S.State.KEY_LOADING:case S.State.FRAG_LOADING:case S.State.FRAG_LOADING_WAITING_RETRY:case S.State.PARSING:case S.State.PARSED:this.state=S.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},s.flushMainBuffer=function(p,_){o.prototype.flushMainBuffer.call(this,p,_,this.altAudio?"video":null)},s.onMediaAttached=function(p,_){o.prototype.onMediaAttached.call(this,p,_);var h=_.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),h.addEventListener("playing",this.onvplaying),h.addEventListener("seeked",this.onvseeked),this.gapController=new R.default(this.config,h,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var p=this.media;p&&this.onvplaying&&this.onvseeked&&(p.removeEventListener("playing",this.onvplaying),p.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),o.prototype.onMediaDetaching.call(this)},s.onMediaPlaying=function(){this.tick()},s.onMediaSeeked=function(){var p=this.media,_=p?p.currentTime:null;(0,N.isFiniteNumber)(_)&&this.log("Media seeked to "+_.toFixed(3)),this.tick()},s.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},s.onManifestParsed=function(p,_){var h=!1,A=!1,E;_.levels.forEach(function(v){E=v.audioCodec,E&&(E.indexOf("mp4a.40.2")!==-1&&(h=!0),E.indexOf("mp4a.40.5")!==-1&&(A=!0))}),this.audioCodecSwitch=h&&A&&!(0,F.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=_.levels,this.startFragRequested=!1},s.onLevelLoading=function(p,_){var h=this.levels;if(!(!h||this.state!==S.State.IDLE)){var A=h[_.level];(!A.details||A.details.live&&this.levelLastLoaded!==_.level||this.waitForCdnTuneIn(A.details))&&(this.state=S.State.WAITING_LEVEL)}},s.onLevelLoaded=function(p,_){var h,A=this.levels,E=_.level,v=_.details,T=v.totalduration;if(!A){this.warn("Levels were reset while loading level "+E);return}this.log("Level "+E+" loaded ["+v.startSN+","+v.endSN+"], cc ["+v.startCC+", "+v.endCC+"] duration:"+T);var D=this.fragCurrent;D&&(this.state===S.State.FRAG_LOADING||this.state===S.State.FRAG_LOADING_WAITING_RETRY)&&D.level!==_.level&&D.loader&&(this.state=S.State.IDLE,this.backtrackFragment=null,D.loader.abort());var B=A[E],V=0;if(v.live||(h=B.details)!==null&&h!==void 0&&h.live){if(v.fragments[0]||(v.deltaUpdateFailed=!0),v.deltaUpdateFailed)return;V=this.alignPlaylists(v,B.details)}if(B.details=v,this.levelLastLoaded=E,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:v,level:E}),this.state===S.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(v))return;this.state=S.State.IDLE}this.startFragRequested?v.live&&this.synchronizeToLiveEdge(v):this.setStartPosition(v,V),this.tick()},s._handleFragmentLoadProgress=function(p){var _,h=p.frag,A=p.part,E=p.payload,v=this.levels;if(!v){this.warn("Levels were reset while fragment load was in progress. Fragment "+h.sn+" of level "+h.level+" will not be buffered");return}var T=v[h.level],D=T.details;if(!D){this.warn("Dropping fragment "+h.sn+" of level "+h.level+" after level details were reset");return}var B=T.videoCodec,V=D.PTSKnown||!D.live,W=(_=h.initSegment)===null||_===void 0?void 0:_.data,j=this._getAudioCodec(T),$=this.transmuxer=this.transmuxer||new x.default(this.hls,I.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),Q=A?A.index:-1,Z=Q!==-1,ee=new L.ChunkMetadata(h.level,h.sn,h.stats.chunkCount,E.byteLength,Q,Z),ae=this.initPTS[h.cc];$.push(E,W,j,B,h,A,D.totalduration,V,ee,ae)},s.onAudioTrackSwitching=function(p,_){var h=this.altAudio,A=!!_.url,E=_.id;if(!A){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var v=this.fragCurrent;v!=null&&v.loader&&(this.log("Switching to main audio track, cancel main fragment load"),v.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var T=this.hls;h&&T.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),T.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:E})}},s.onAudioTrackSwitched=function(p,_){var h=_.id,A=!!this.hls.audioTracks[h].url;if(A){var E=this.videoBuffer;E&&this.mediaBuffer!==E&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=E)}this.altAudio=A,this.tick()},s.onBufferCreated=function(p,_){var h=_.tracks,A,E,v=!1;for(var T in h){var D=h[T];if(D.id==="main"){if(E=T,A=D,T==="video"){var B=h[T];B&&(this.videoBuffer=B.buffer)}}else v=!0}v&&A?(this.log("Alternate track found, use "+E+".buffered to schedule main fragment loading"),this.mediaBuffer=A.buffer):this.mediaBuffer=this.media},s.onFragBuffered=function(p,_){var h=_.frag,A=_.part;if(!(h&&h.type!==I.PlaylistLevelType.MAIN)){if(this.fragContextChanged(h)){this.warn("Fragment "+h.sn+(A?" p: "+A.index:"")+" of level "+h.level+" finished buffering, but was aborted. state: "+this.state),this.state===S.State.PARSED&&(this.state=S.State.IDLE);return}var E=A?A.stats:h.stats;this.fragLastKbps=Math.round(8*E.total/(E.buffering.end-E.loading.first)),h.sn!=="initSegment"&&(this.fragPrevious=h),this.fragBufferedComplete(h,A)}},s.onError=function(p,_){switch(_.details){case O.ErrorDetails.FRAG_LOAD_ERROR:case O.ErrorDetails.FRAG_LOAD_TIMEOUT:case O.ErrorDetails.KEY_LOAD_ERROR:case O.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.MAIN,_);break;case O.ErrorDetails.LEVEL_LOAD_ERROR:case O.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==S.State.ERROR&&(_.fatal?(this.warn(""+_.details),this.state=S.State.ERROR):!_.levelRetry&&this.state===S.State.WAITING_LEVEL&&(this.state=S.State.IDLE));break;case O.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="main"&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var h=!0,A=this.getFwdBufferInfo(this.media,I.PlaylistLevelType.MAIN);A&&A.len>.5&&(h=!this.reduceMaxBufferLength(A.len)),h&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},s.checkBuffer=function(){var p=this.media,_=this.gapController;if(!(!p||!_||!p.readyState)){if(this.loadedmetadata||!K.BufferHelper.getBuffered(p).length){var h=this.state!==S.State.IDLE?this.fragCurrent:null;_.poll(this.lastCurrentTime,h)}this.lastCurrentTime=p.currentTime}},s.onFragLoadEmergencyAborted=function(){this.state=S.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},s.onBufferFlushed=function(p,_){var h=_.type;if(h!==k.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var A=(h===k.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(A,h,I.PlaylistLevelType.MAIN)}},s.onLevelsUpdated=function(p,_){this.levels=_.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s.seekToStartPos=function(){var p=this.media;if(p){var _=p.currentTime,h=this.startPosition;if(h>=0&&_<h){if(p.seeking){this.log("could not seek to "+h+", already seeking at "+_);return}var A=K.BufferHelper.getBuffered(p),E=A.length?A.start(0):0,v=E-h;v>0&&(v<this.config.maxBufferHole||v<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+v+" to match buffer start"),h+=v,this.startPosition=h),this.log("seek to target start position "+h+" from current time "+_),p.currentTime=h}}},s._getAudioCodec=function(p){var _=this.config.defaultAudioCodec||p.audioCodec;return this.audioCodecSwap&&_&&(this.log("Swapping audio codec"),_.indexOf("mp4a.40.5")!==-1?_="mp4a.40.2":_="mp4a.40.5"),_},s._loadBitrateTestFrag=function(p){var _=this;p.bitrateTest=!0,this._doFragLoad(p).then(function(h){var A=_.hls;if(!(!h||A.nextLoadLevel||_.fragContextChanged(p))){_.fragLoadError=0,_.state=S.State.IDLE,_.startFragRequested=!1,_.bitrateTest=!1;var E=p.stats;E.parsing.start=E.parsing.end=E.buffering.start=E.buffering.end=self.performance.now(),A.trigger(M.Events.FRAG_LOADED,h),p.bitrateTest=!1}})},s._handleTransmuxComplete=function(p){var _,h="main",A=this.hls,E=p.remuxResult,v=p.chunkMeta,T=this.getCurrentContext(v);if(!T){this.warn("The loading context changed while buffering fragment "+v.sn+" of level "+v.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(v.level);return}var D=T.frag,B=T.part,V=T.level,W=E.video,j=E.text,$=E.id3,Q=E.initSegment,Z=V.details,ee=this.altAudio?void 0:E.audio;if(!this.fragContextChanged(D)){if(this.state=S.State.PARSING,Q){Q.tracks&&(this._bufferInitSegment(V,Q.tracks,D,v),A.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:D,id:h,tracks:Q.tracks}));var ae=Q.initPTS,se=Q.timescale;(0,N.isFiniteNumber)(ae)&&(this.initPTS[D.cc]=ae,A.trigger(M.Events.INIT_PTS_FOUND,{frag:D,id:h,initPTS:ae,timescale:se}))}if(W&&E.independent!==!1){if(Z){var Y=W.startPTS,X=W.endPTS,q=W.startDTS,re=W.endDTS;if(B)B.elementaryStreams[W.type]={startPTS:Y,endPTS:X,startDTS:q,endDTS:re};else if(W.firstKeyFrame&&W.independent&&(this.couldBacktrack=!0),W.dropped&&W.independent){var ne=this.getMainFwdBufferInfo(),U=(ne?ne.end:this.getLoadPosition())+this.config.maxBufferHole,H=W.firstKeyFramePTS?W.firstKeyFramePTS:Y;if(U<H-this.config.maxBufferHole){this.backtrack(D);return}D.setElementaryStreamInfo(W.type,D.start,X,D.start,re,!0)}D.setElementaryStreamInfo(W.type,Y,X,q,re),this.backtrackFragment&&(this.backtrackFragment=D),this.bufferFragmentData(W,D,B,v)}}else if(E.independent===!1){this.backtrack(D);return}if(ee){var z=ee.startPTS,J=ee.endPTS,te=ee.startDTS,ie=ee.endDTS;B&&(B.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:z,endPTS:J,startDTS:te,endDTS:ie}),D.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,z,J,te,ie),this.bufferFragmentData(ee,D,B,v)}if(Z&&$!==null&&$!==void 0&&(_=$.samples)!==null&&_!==void 0&&_.length){var le={id:h,frag:D,details:Z,samples:$.samples};A.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(Z&&j){var oe={id:h,frag:D,details:Z,samples:j.samples};A.trigger(M.Events.FRAG_PARSING_USERDATA,oe)}}},s._bufferInitSegment=function(p,_,h,A){var E=this;if(this.state===S.State.PARSING){this.audioOnly=!!_.audio&&!_.video,this.altAudio&&!this.audioOnly&&delete _.audio;var v=_.audio,T=_.video,D=_.audiovideo;if(v){var B=p.audioCodec,V=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),v.metadata.channelCount!==1&&V.indexOf("firefox")===-1&&(B="mp4a.40.5")),V.indexOf("android")!==-1&&v.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),p.audioCodec&&p.audioCodec!==B&&this.log('Swapping manifest audio codec "'+p.audioCodec+'" for "'+B+'"'),v.levelCodec=B,v.id="main",this.log("Init audio buffer, container:"+v.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(p.audioCodec||"")+"/"+v.codec+"]")}T&&(T.levelCodec=p.videoCodec,T.id="main",this.log("Init video buffer, container:"+T.container+", codecs[level/parsed]=["+(p.videoCodec||"")+"/"+T.codec+"]")),D&&this.log("Init audiovideo buffer, container:"+D.container+", codecs[level/parsed]=["+(p.attrs.CODECS||"")+"/"+D.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,_),Object.keys(_).forEach(function(W){var j=_[W],$=j.initSegment;$!=null&&$.byteLength&&E.hls.trigger(M.Events.BUFFER_APPENDING,{type:W,data:$,frag:h,part:null,chunkMeta:A,parent:h.type})}),this.tick()}},s.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,I.PlaylistLevelType.MAIN)},s.backtrack=function(p){this.couldBacktrack=!0,this.backtrackFragment=p,this.resetTransmuxer(),this.flushBufferGap(p),this.fragmentTracker.removeFragment(p),this.fragPrevious=null,this.nextLoadPosition=p.start,this.state=S.State.IDLE},s.checkFragmentChanged=function(){var p=this.media,_=null;if(p&&p.readyState>1&&p.seeking===!1){var h=p.currentTime;if(K.BufferHelper.isBuffered(p,h)?_=this.getAppendedFrag(h):K.BufferHelper.isBuffered(p,h+.1)&&(_=this.getAppendedFrag(h+.1)),_){this.backtrackFragment=null;var A=this.fragPlaying,E=_.level;(!A||_.sn!==A.sn||A.level!==E||_.urlId!==A.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:_}),(!A||A.level!==E)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:E}),this.fragPlaying=_)}}},y(a,[{key:"nextLevel",get:function(){var p=this.nextBufferedFrag;return p?p.level:-1}},{key:"currentFrag",get:function(){var p=this.media;return p?this.fragPlaying||this.getAppendedFrag(p.currentTime):null}},{key:"currentProgramDateTime",get:function(){var p=this.media;if(p){var _=p.currentTime,h=this.currentFrag;if(h&&(0,N.isFiniteNumber)(_)&&(0,N.isFiniteNumber)(h.programDateTime)){var A=h.programDateTime+(_-h.start)*1e3;return new Date(A)}}return null}},{key:"currentLevel",get:function(){var p=this.currentFrag;return p?p.level:-1}},{key:"nextBufferedFrag",get:function(){var p=this.currentFrag;return p?this.followingBufferedFrag(p):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),a}(S.default)},"./src/controller/subtitle-stream-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{SubtitleStreamController:()=>u});var N=m("./src/events.ts"),S=m("./src/utils/buffer-helper.ts"),F=m("./src/controller/fragment-finders.ts"),M=m("./src/utils/discontinuities.ts"),K=m("./src/controller/level-helper.ts"),w=m("./src/controller/fragment-tracker.ts"),I=m("./src/controller/base-stream-controller.ts"),k=m("./src/types/loader.ts"),x=m("./src/types/level.ts");function L(c,f){for(var o=0;o<f.length;o++){var a=f[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(c,a.key,a)}}function R(c,f,o){return f&&L(c.prototype,f),o&&L(c,o),Object.defineProperty(c,"prototype",{writable:!1}),c}function O(c,f){c.prototype=Object.create(f.prototype),c.prototype.constructor=c,C(c,f)}function C(c,f){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},C(c,f)}var y=500,u=function(c){O(f,c);function f(a,s){var d;return d=c.call(this,a,s,"[subtitle-stream-controller]")||this,d.levels=[],d.currentTrackId=-1,d.tracksBuffered=[],d.mainDetails=null,d._registerListeners(),d}var o=f.prototype;return o.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},o._registerListeners=function(){var s=this.hls;s.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(N.Events.ERROR,this.onError,this),s.on(N.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.on(N.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.on(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.on(N.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.on(N.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o._unregisterListeners=function(){var s=this.hls;s.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(N.Events.ERROR,this.onError,this),s.off(N.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.off(N.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.off(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.off(N.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.off(N.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o.startLoad=function(s){this.stopLoad(),this.state=I.State.IDLE,this.setInterval(y),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=s,this.tick()},o.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},o.onLevelLoaded=function(s,d){this.mainDetails=d.details},o.onSubtitleFragProcessed=function(s,d){var p=d.frag,_=d.success;if(this.fragPrevious=p,this.state=I.State.IDLE,!!_){var h=this.tracksBuffered[this.currentTrackId];if(h){for(var A,E=p.start,v=0;v<h.length;v++)if(E>=h[v].start&&E<=h[v].end){A=h[v];break}var T=p.start+p.duration;A?A.end=T:(A={start:E,end:T},h.push(A)),this.fragmentTracker.fragBuffered(p)}}},o.onBufferFlushing=function(s,d){var p=d.startOffset,_=d.endOffset;if(p===0&&_!==Number.POSITIVE_INFINITY){var h=this.currentTrackId,A=this.levels;if(!A.length||!A[h]||!A[h].details)return;var E=A[h].details,v=E.targetduration,T=_-v;if(T<=0)return;d.endOffsetSubtitles=Math.max(0,T),this.tracksBuffered.forEach(function(D){for(var B=0;B<D.length;){if(D[B].end<=T){D.shift();continue}else if(D[B].start<T)D[B].start=T;else break;B++}}),this.fragmentTracker.removeFragmentsInRange(p,T,k.PlaylistLevelType.SUBTITLE)}},o.onFragBuffered=function(s,d){if(!this.loadedmetadata&&d.frag.type===k.PlaylistLevelType.MAIN){var p;(p=this.media)!==null&&p!==void 0&&p.buffered.length&&(this.loadedmetadata=!0)}},o.onError=function(s,d){var p,_=d.frag;!_||_.type!==k.PlaylistLevelType.SUBTITLE||((p=this.fragCurrent)!==null&&p!==void 0&&p.loader&&this.fragCurrent.loader.abort(),this.state=I.State.IDLE)},o.onSubtitleTracksUpdated=function(s,d){var p=this,_=d.subtitleTracks;this.tracksBuffered=[],this.levels=_.map(function(h){return new x.Level(h)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(h){p.tracksBuffered[h.id]=[]}),this.mediaBuffer=null},o.onSubtitleTrackSwitch=function(s,d){if(this.currentTrackId=d.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var p=this.levels[this.currentTrackId];p!=null&&p.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,p&&this.setInterval(y)},o.onSubtitleTrackLoaded=function(s,d){var p,_=d.details,h=d.id,A=this.currentTrackId,E=this.levels;if(E.length){var v=E[A];if(!(h>=E.length||h!==A||!v)){this.mediaBuffer=this.mediaBufferTimeRanges;var T=0;if(_.live||(p=v.details)!==null&&p!==void 0&&p.live){var D=this.mainDetails;if(_.deltaUpdateFailed||!D)return;var B=D.fragments[0];v.details?(T=this.alignPlaylists(_,v.details),T===0&&B&&(T=B.start,(0,K.addSliding)(_,T))):_.hasProgramDateTime&&D.hasProgramDateTime?((0,M.alignMediaPlaylistByPDT)(_,D),T=_.fragments[0].start):B&&(T=B.start,(0,K.addSliding)(_,T))}if(v.details=_,this.levelLastLoaded=h,!this.startFragRequested&&(this.mainDetails||!_.live)&&this.setStartPosition(v.details,T),this.tick(),_.live&&!this.fragCurrent&&this.media&&this.state===I.State.IDLE){var V=(0,F.findFragmentByPTS)(null,_.fragments,this.media.currentTime,0);V||(this.warn("Subtitle playlist not aligned with playback"),v.details=void 0)}}}},o._handleFragmentLoadComplete=function(s){var d=s.frag,p=s.payload,_=d.decryptdata,h=this.hls;if(!this.fragContextChanged(d)&&p&&p.byteLength>0&&_&&_.key&&_.iv&&_.method==="AES-128"){var A=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(p),_.key.buffer,_.iv.buffer).then(function(E){var v=performance.now();h.trigger(N.Events.FRAG_DECRYPTED,{frag:d,payload:E,stats:{tstart:A,tdecrypt:v}})})}},o.doTick=function(){if(!this.media){this.state=I.State.IDLE;return}if(this.state===I.State.IDLE){var s=this.currentTrackId,d=this.levels;if(!d.length||!d[s]||!d[s].details)return;var p=d[s].details,_=p.targetduration,h=this.config,A=this.getLoadPosition(),E=S.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],A-_,h.maxBufferHole),v=E.end,T=E.len,D=this.getFwdBufferInfo(this.media,k.PlaylistLevelType.MAIN),B=this.getMaxBufferLength(D==null?void 0:D.len)+_;if(T>B)return;console.assert(p,"Subtitle track details are defined on idle subtitle stream controller tick");var V=p.fragments,W=V.length,j=p.edge,$,Q=this.fragPrevious;if(v<j){var Z=h.maxFragLookUpTolerance;$=(0,F.findFragmentByPTS)(Q,V,Math.max(V[0].start,v),Z),!$&&Q&&Q.start<V[0].start&&($=V[0])}else $=V[W-1];if($=this.mapToInitFragWhenRequired($),!$||this.fragmentTracker.getState($)!==w.FragmentState.NOT_LOADED)return;$.encrypted?this.loadKey($,p):this.loadFragment($,p,v)}},o.getMaxBufferLength=function(s){var d=c.prototype.getMaxBufferLength.call(this);return s?Math.max(d,s):d},o.loadFragment=function(s,d,p){this.fragCurrent=s,s.sn==="initSegment"?this._loadInitSegment(s):(this.startFragRequested=!0,c.prototype.loadFragment.call(this,s,d,p))},R(f,[{key:"mediaBufferTimeRanges",get:function(){return new l(this.tracksBuffered[this.currentTrackId]||[])}}]),f}(I.default),l=function(f){this.buffered=void 0;var o=function(s,d,p){if(d=d>>>0,d>p-1)throw new DOMException("Failed to execute '"+s+"' on 'TimeRanges': The index provided ("+d+") is greater than the maximum bound ("+p+")");return f[d][s]};this.buffered={get length(){return f.length},end:function(s){return o("end",s,f.length)},start:function(s){return o("start",s,f.length)}}}},"./src/controller/subtitle-track-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>R});var N=m("./src/events.ts"),S=m("./src/utils/texttrack-utils.ts"),F=m("./src/controller/base-playlist-controller.ts"),M=m("./src/types/loader.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){O.prototype=Object.create(C.prototype),O.prototype.constructor=O,k(O,C)}function k(O,C){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,l){return u.__proto__=l,u},k(O,C)}var x=function(O){I(C,O);function C(u){var l;return l=O.call(this,u,"[subtitle-track-controller]")||this,l.media=null,l.tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.selectDefaultTrack=!0,l.queuedDefaultTrack=-1,l.trackChangeListener=function(){return l.onTextTracksChanged()},l.asyncPollTrackChange=function(){return l.pollTrackChange(0)},l.useTextTrackPolling=!1,l.subtitlePollingInterval=-1,l._subtitleDisplay=!0,l.registerListeners(),l}var y=C.prototype;return y.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,O.prototype.destroy.call(this)},y.registerListeners=function(){var l=this.hls;l.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(N.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.on(N.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){var l=this.hls;l.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(N.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.off(N.Events.ERROR,this.onError,this)},y.onMediaAttached=function(l,c){this.media=c.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},y.pollTrackChange=function(l){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,l)},y.onMediaDetaching=function(){if(this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var l=L(this.media.textTracks);l.forEach(function(c){(0,S.clearCurrentCues)(c)}),this.subtitleTrack=-1,this.media=null}},y.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},y.onManifestParsed=function(l,c){this.tracks=c.subtitleTracks},y.onSubtitleTrackLoaded=function(l,c){var f=c.id,o=c.details,a=this.trackId,s=this.tracksInGroup[a];if(!s){this.warn("Invalid subtitle track id "+f);return}var d=s.details;s.details=c.details,this.log("subtitle track "+f+" loaded ["+o.startSN+"-"+o.endSN+"]"),f===this.trackId&&(this.retryCount=0,this.playlistLoaded(f,c,d))},y.onLevelLoading=function(l,c){this.switchLevel(c.level)},y.onLevelSwitching=function(l,c){this.switchLevel(c.level)},y.switchLevel=function(l){var c=this.hls.levels[l];if(c!=null&&c.textGroupIds){var f=c.textGroupIds[c.urlId];if(this.groupId!==f){var o=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,a=this.tracks.filter(function(p){return!f||p.groupId===f});this.tracksInGroup=a;var s=this.findTrackId(o==null?void 0:o.name)||this.findTrackId();this.groupId=f;var d={subtitleTracks:a};this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+f+'" group-id'),this.hls.trigger(N.Events.SUBTITLE_TRACKS_UPDATED,d),s!==-1&&this.setSubtitleTrack(s,o)}}},y.findTrackId=function(l){for(var c=this.tracksInGroup,f=0;f<c.length;f++){var o=c[f];if((!this.selectDefaultTrack||o.default)&&(!l||l===o.name))return o.id}return-1},y.onError=function(l,c){O.prototype.onError.call(this,l,c),!(c.fatal||!c.context)&&c.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&c.context.id===this.trackId&&c.context.groupId===this.groupId&&this.retryLoadingOrFail(c)},y.loadPlaylist=function(l){var c=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(c)){var f=c.id,o=c.groupId,a=c.url;if(l)try{a=l.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+f),this.hls.trigger(N.Events.SUBTITLE_TRACK_LOADING,{url:a,id:f,groupId:o,deliveryDirectives:l||null})}},y.toggleTrackModes=function(l){var c=this,f=this.media,o=this.trackId;if(f){var a=L(f.textTracks),s=a.filter(function(_){return _.groupId===c.groupId});if(l===-1)[].slice.call(a).forEach(function(_){_.mode="disabled"});else{var d=s[o];d&&(d.mode="disabled")}var p=s[l];p&&(p.mode=this.subtitleDisplay?"showing":"hidden")}},y.setSubtitleTrack=function(l,c){var f,o=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=l;return}if(this.trackId!==l&&this.toggleTrackModes(l),!(this.trackId===l&&(l===-1||(f=o[l])!==null&&f!==void 0&&f.details)||l<-1||l>=o.length)){this.clearTimer();var a=o[l];if(this.log("Switching to subtitle track "+l),this.trackId=l,a){var s=a.id,d=a.groupId,p=d===void 0?"":d,_=a.name,h=a.type,A=a.url;this.hls.trigger(N.Events.SUBTITLE_TRACK_SWITCH,{id:s,groupId:p,name:_,type:h,url:A});var E=this.switchParams(a.url,c==null?void 0:c.details);this.loadPlaylist(E)}else this.hls.trigger(N.Events.SUBTITLE_TRACK_SWITCH,{id:l})}},y.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var l=-1,c=L(this.media.textTracks),f=0;f<c.length;f++)if(c[f].mode==="hidden")l=f;else if(c[f].mode==="showing"){l=f;break}this.subtitleTrack!==l&&(this.subtitleTrack=l)}},w(C,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(l){this._subtitleDisplay=l,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1;var c=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(l,c)}}]),C}(F.default);function L(O){for(var C=[],y=0;y<O.length;y++){var u=O[y];u.kind==="subtitles"&&u.label&&C.push(O[y])}return C}const R=x},"./src/controller/timeline-controller.ts":(b,P,m)=>{m.r(P),m.d(P,{TimelineController:()=>R});var N=m("./src/polyfills/number.ts"),S=m("./src/events.ts"),F=m("./src/utils/cea-608-parser.ts"),M=m("./src/utils/output-filter.ts"),K=m("./src/utils/webvtt-parser.ts"),w=m("./src/utils/texttrack-utils.ts"),I=m("./src/utils/imsc1-ttml-parser.ts"),k=m("./src/utils/mp4-tools.ts"),x=m("./src/types/loader.ts"),L=m("./src/utils/logger.ts"),R=function(){function u(c){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=y(),this.captionsProperties=void 0,this.hls=c,this.config=c.config,this.Cues=c.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var f=new M.default(this,"textTrack1"),o=new M.default(this,"textTrack2"),a=new M.default(this,"textTrack3"),s=new M.default(this,"textTrack4");this.cea608Parser1=new F.default(1,f,o),this.cea608Parser2=new F.default(3,a,s)}c.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),c.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),c.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),c.on(S.Events.FRAG_LOADING,this.onFragLoading,this),c.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),c.on(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),c.on(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.on(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),c.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var l=u.prototype;return l.destroy=function(){var f=this.hls;f.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),f.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),f.off(S.Events.FRAG_LOADING,this.onFragLoading,this),f.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),f.off(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),f.off(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),f.off(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),f.off(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),f.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},l.addCues=function(f,o,a,s,d){for(var p=!1,_=d.length;_--;){var h=d[_],A=C(h[0],h[1],o,a);if(A>=0&&(h[0]=Math.min(h[0],o),h[1]=Math.max(h[1],a),p=!0,A/(a-o)>.5))return}if(p||d.push([o,a]),this.config.renderTextTracksNatively){var E=this.captionsTracks[f];this.Cues.newCue(E,o,a,s)}else{var v=this.Cues.newCue(null,o,a,s);this.hls.trigger(S.Events.CUES_PARSED,{type:"captions",cues:v,track:f})}},l.onInitPtsFound=function(f,o){var a=this,s=o.frag,d=o.id,p=o.initPTS,_=o.timescale,h=this.unparsedVttFrags;d==="main"&&(this.initPTS[s.cc]=p,this.timescale[s.cc]=_),h.length&&(this.unparsedVttFrags=[],h.forEach(function(A){a.onFragLoaded(S.Events.FRAG_LOADED,A)}))},l.getExistingTrack=function(f){var o=this.media;if(o)for(var a=0;a<o.textTracks.length;a++){var s=o.textTracks[a];if(s[f])return s}return null},l.createCaptionsTrack=function(f){this.config.renderTextTracksNatively?this.createNativeTrack(f):this.createNonNativeTrack(f)},l.createNativeTrack=function(f){if(!this.captionsTracks[f]){var o=this.captionsProperties,a=this.captionsTracks,s=this.media,d=o[f],p=d.label,_=d.languageCode,h=this.getExistingTrack(f);if(h)a[f]=h,(0,w.clearCurrentCues)(a[f]),(0,w.sendAddTrackEvent)(a[f],s);else{var A=this.createTextTrack("captions",p,_);A&&(A[f]=!0,a[f]=A)}}},l.createNonNativeTrack=function(f){if(!this.nonNativeCaptionsTracks[f]){var o=this.captionsProperties[f];if(o){var a=o.label,s={_id:f,label:a,kind:"captions",default:o.media?!!o.media.default:!1,closedCaptions:o.media};this.nonNativeCaptionsTracks[f]=s,this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},l.createTextTrack=function(f,o,a){var s=this.media;if(s)return s.addTextTrack(f,o,a)},l.onMediaAttaching=function(f,o){this.media=o.media,this._cleanTracks()},l.onMediaDetaching=function(){var f=this.captionsTracks;Object.keys(f).forEach(function(o){(0,w.clearCurrentCues)(f[o]),delete f[o]}),this.nonNativeCaptionsTracks={}},l.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=y(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},l._cleanTracks=function(){var f=this.media;if(f){var o=f.textTracks;if(o)for(var a=0;a<o.length;a++)(0,w.clearCurrentCues)(o[a])}},l.onSubtitleTracksUpdated=function(f,o){var a=this;this.textTracks=[];var s=o.subtitleTracks||[],d=s.some(function(A){return A.textCodec===I.IMSC1_CODEC});if(this.config.enableWebVTT||d&&this.config.enableIMSC1){var p=this.tracks&&s&&this.tracks.length===s.length;if(this.tracks=s||[],this.config.renderTextTracksNatively){var _=this.media?this.media.textTracks:[];this.tracks.forEach(function(A,E){var v;if(E<_.length){for(var T=null,D=0;D<_.length;D++)if(O(_[D],A)){T=_[D];break}T&&(v=T)}if(v)(0,w.clearCurrentCues)(v);else{var B=a._captionsOrSubtitlesFromCharacteristics(A);v=a.createTextTrack(B,A.name,A.lang),v&&(v.mode="disabled")}v&&(v.groupId=A.groupId,a.textTracks.push(v))})}else if(!p&&this.tracks&&this.tracks.length){var h=this.tracks.map(function(A){return{label:A.name,kind:A.type.toLowerCase(),default:A.default,subtitleTrack:A}});this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:h})}}},l._captionsOrSubtitlesFromCharacteristics=function(f){var o;if((o=f.attrs)!==null&&o!==void 0&&o.CHARACTERISTICS){var a=/transcribes-spoken-dialog/gi.test(f.attrs.CHARACTERISTICS),s=/describes-music-and-sound/gi.test(f.attrs.CHARACTERISTICS);if(a&&s)return"captions"}return"subtitles"},l.onManifestLoaded=function(f,o){var a=this;this.config.enableCEA708Captions&&o.captions&&o.captions.forEach(function(s){var d=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(d){var p="textTrack"+d[1],_=a.captionsProperties[p];_&&(_.label=s.name,s.lang&&(_.languageCode=s.lang),_.media=s)}})},l.closedCaptionsForLevel=function(f){var o=this.hls.levels[f.level];return o==null?void 0:o.attrs["CLOSED-CAPTIONS"]},l.onFragLoading=function(f,o){var a=this.cea608Parser1,s=this.cea608Parser2,d=this.lastSn,p=this.lastPartIndex;if(!(!this.enabled||!(a&&s))&&o.frag.type===x.PlaylistLevelType.MAIN){var _,h,A=o.frag.sn,E=(_=o==null||(h=o.part)===null||h===void 0?void 0:h.index)!=null?_:-1;A===d+1||A===d&&E===p+1||(a.reset(),s.reset()),this.lastSn=A,this.lastPartIndex=E}},l.onFragLoaded=function(f,o){var a=o.frag,s=o.payload,d=this.initPTS,p=this.unparsedVttFrags;if(a.type===x.PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!(0,N.isFiniteNumber)(d[a.cc])){p.push(o),d.length&&this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Missing initial subtitle PTS")});return}var _=a.decryptdata,h="stats"in o;if(_==null||_.key==null||_.method!=="AES-128"||h){var A=this.tracks[a.level],E=this.vttCCs;E[a.cc]||(E[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),A&&A.textCodec===I.IMSC1_CODEC?this._parseIMSC1(a,s):this._parseVTTs(a,s,E)}}else this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})},l._parseIMSC1=function(f,o){var a=this,s=this.hls;(0,I.parseIMSC1)(o,this.initPTS[f.cc],this.timescale[f.cc],function(d){a._appendCues(d,f.level),s.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:f})},function(d){L.logger.log("Failed to parse IMSC1: "+d),s.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:d})})},l._parseVTTs=function(f,o,a){var s,d=this,p=this.hls,_=(s=f.initSegment)!==null&&s!==void 0&&s.data?(0,k.appendUint8Array)(f.initSegment.data,new Uint8Array(o)):o;(0,K.parseWebVTT)(_,this.initPTS[f.cc],this.timescale[f.cc],a,f.cc,f.start,function(h){d._appendCues(h,f.level),p.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:f})},function(h){d._fallbackToIMSC1(f,o),L.logger.log("Failed to parse VTT cue: "+h),p.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:h})})},l._fallbackToIMSC1=function(f,o){var a=this,s=this.tracks[f.level];s.textCodec||(0,I.parseIMSC1)(o,this.initPTS[f.cc],this.timescale[f.cc],function(){s.textCodec=I.IMSC1_CODEC,a._parseIMSC1(f,o)},function(){s.textCodec="wvtt"})},l._appendCues=function(f,o){var a=this.hls;if(this.config.renderTextTracksNatively){var s=this.textTracks[o];if(!s||s.mode==="disabled")return;f.forEach(function(_){return(0,w.addCueToTrack)(s,_)})}else{var d=this.tracks[o];if(!d)return;var p=d.default?"default":"subtitles"+o;a.trigger(S.Events.CUES_PARSED,{type:"subtitles",cues:f,track:p})}},l.onFragDecrypted=function(f,o){var a=o.frag;if(a.type===x.PlaylistLevelType.SUBTITLE){if(!(0,N.isFiniteNumber)(this.initPTS[a.cc])){this.unparsedVttFrags.push(o);return}this.onFragLoaded(S.Events.FRAG_LOADED,o)}},l.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},l.onFragParsingUserdata=function(f,o){var a=this.cea608Parser1,s=this.cea608Parser2;if(!(!this.enabled||!(a&&s))){var d=o.frag,p=o.samples;if(!(d.type===x.PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(d)==="NONE"))for(var _=0;_<p.length;_++){var h=p[_].bytes;if(h){var A=this.extractCea608Data(h);a.addData(p[_].pts,A[0]),s.addData(p[_].pts,A[1])}}}},l.onBufferFlushing=function(f,o){var a=o.startOffset,s=o.endOffset,d=o.endOffsetSubtitles,p=o.type,_=this.media;if(!(!_||_.currentTime<s)){if(!p||p==="video"){var h=this.captionsTracks;Object.keys(h).forEach(function(E){return(0,w.removeCuesInRange)(h[E],a,s)})}if(this.config.renderTextTracksNatively&&a===0&&d!==void 0){var A=this.textTracks;Object.keys(A).forEach(function(E){return(0,w.removeCuesInRange)(A[E],a,d)})}}},l.extractCea608Data=function(f){for(var o=[[],[]],a=f[0]&31,s=2,d=0;d<a;d++){var p=f[s++],_=127&f[s++],h=127&f[s++];if(!(_===0&&h===0)){var A=(4&p)!==0;if(A){var E=3&p;(E===0||E===1)&&(o[E].push(_),o[E].push(h))}}}return o},u}();function O(u,l){return u&&u.label===l.name&&!(u.textTrack1||u.textTrack2)}function C(u,l,c,f){return Math.min(l,f)-Math.max(u,c)}function y(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});var N=function(){function S(M,K){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=K}var F=S.prototype;return F.decrypt=function(K,w){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},w,K)},S}()},"./src/crypt/aes-decryptor.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>F,removePadding:()=>S});var N=m("./src/utils/typed-array.ts");function S(M){var K=M.byteLength,w=K&&new DataView(M.buffer).getUint8(K-1);return w?(0,N.sliceUint8)(M,0,K-w):M}var F=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var K=M.prototype;return K.uint8ArrayToUint32Array_=function(I){for(var k=new DataView(I),x=new Uint32Array(4),L=0;L<4;L++)x[L]=k.getUint32(L*4);return x},K.initTable=function(){var I=this.sBox,k=this.invSBox,x=this.subMix,L=x[0],R=x[1],O=x[2],C=x[3],y=this.invSubMix,u=y[0],l=y[1],c=y[2],f=y[3],o=new Uint32Array(256),a=0,s=0,d=0;for(d=0;d<256;d++)d<128?o[d]=d<<1:o[d]=d<<1^283;for(d=0;d<256;d++){var p=s^s<<1^s<<2^s<<3^s<<4;p=p>>>8^p&255^99,I[a]=p,k[p]=a;var _=o[a],h=o[_],A=o[h],E=o[p]*257^p*16843008;L[a]=E<<24|E>>>8,R[a]=E<<16|E>>>16,O[a]=E<<8|E>>>24,C[a]=E,E=A*16843009^h*65537^_*257^a*16843008,u[p]=E<<24|E>>>8,l[p]=E<<16|E>>>16,c[p]=E<<8|E>>>24,f[p]=E,a?(a=_^o[o[o[A^_]]],s^=o[o[s]]):a=s=1}},K.expandKey=function(I){for(var k=this.uint8ArrayToUint32Array_(I),x=!0,L=0;L<k.length&&x;)x=k[L]===this.key[L],L++;if(!x){this.key=k;var R=this.keySize=k.length;if(R!==4&&R!==6&&R!==8)throw new Error("Invalid aes key size="+R);var O=this.ksRows=(R+6+1)*4,C,y,u=this.keySchedule=new Uint32Array(O),l=this.invKeySchedule=new Uint32Array(O),c=this.sBox,f=this.rcon,o=this.invSubMix,a=o[0],s=o[1],d=o[2],p=o[3],_,h;for(C=0;C<O;C++){if(C<R){_=u[C]=k[C];continue}h=_,C%R===0?(h=h<<8|h>>>24,h=c[h>>>24]<<24|c[h>>>16&255]<<16|c[h>>>8&255]<<8|c[h&255],h^=f[C/R|0]<<24):R>6&&C%R===4&&(h=c[h>>>24]<<24|c[h>>>16&255]<<16|c[h>>>8&255]<<8|c[h&255]),u[C]=_=(u[C-R]^h)>>>0}for(y=0;y<O;y++)C=O-y,y&3?h=u[C]:h=u[C-4],y<4||C<=4?l[y]=h:l[y]=a[c[h>>>24]]^s[c[h>>>16&255]]^d[c[h>>>8&255]]^p[c[h&255]],l[y]=l[y]>>>0}},K.networkToHostOrderSwap=function(I){return I<<24|(I&65280)<<8|(I&16711680)>>8|I>>>24},K.decrypt=function(I,k,x){for(var L=this.keySize+6,R=this.invKeySchedule,O=this.invSBox,C=this.invSubMix,y=C[0],u=C[1],l=C[2],c=C[3],f=this.uint8ArrayToUint32Array_(x),o=f[0],a=f[1],s=f[2],d=f[3],p=new Int32Array(I),_=new Int32Array(p.length),h,A,E,v,T,D,B,V,W,j,$,Q,Z,ee,ae=this.networkToHostOrderSwap;k<p.length;){for(W=ae(p[k]),j=ae(p[k+1]),$=ae(p[k+2]),Q=ae(p[k+3]),T=W^R[0],D=Q^R[1],B=$^R[2],V=j^R[3],Z=4,ee=1;ee<L;ee++)h=y[T>>>24]^u[D>>16&255]^l[B>>8&255]^c[V&255]^R[Z],A=y[D>>>24]^u[B>>16&255]^l[V>>8&255]^c[T&255]^R[Z+1],E=y[B>>>24]^u[V>>16&255]^l[T>>8&255]^c[D&255]^R[Z+2],v=y[V>>>24]^u[T>>16&255]^l[D>>8&255]^c[B&255]^R[Z+3],T=h,D=A,B=E,V=v,Z=Z+4;h=O[T>>>24]<<24^O[D>>16&255]<<16^O[B>>8&255]<<8^O[V&255]^R[Z],A=O[D>>>24]<<24^O[B>>16&255]<<16^O[V>>8&255]<<8^O[T&255]^R[Z+1],E=O[B>>>24]<<24^O[V>>16&255]<<16^O[T>>8&255]<<8^O[D&255]^R[Z+2],v=O[V>>>24]<<24^O[T>>16&255]<<16^O[D>>8&255]<<8^O[B&255]^R[Z+3],_[k]=ae(h^o),_[k+1]=ae(v^a),_[k+2]=ae(E^s),_[k+3]=ae(A^d),o=W,a=j,s=$,d=Q,k=k+4}return _.buffer},M}()},"./src/crypt/decrypter.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>k});var N=m("./src/crypt/aes-crypto.ts"),S=m("./src/crypt/fast-aes-key.ts"),F=m("./src/crypt/aes-decryptor.ts"),M=m("./src/utils/logger.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/utils/typed-array.ts"),I=16,k=function(){function x(R,O,C){var y=C===void 0?{}:C,u=y.removePKCS7Padding,l=u===void 0?!0:u;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=R,this.config=O,this.removePKCS7Padding=l,l)try{var c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var L=x.prototype;return L.destroy=function(){this.observer=null},L.isSync=function(){return this.config.enableSoftwareAES},L.flush=function(){var O=this.currentResult;if(!O){this.reset();return}var C=new Uint8Array(O);return this.reset(),this.removePKCS7Padding?(0,F.removePadding)(C):C},L.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},L.decrypt=function(O,C,y,u){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(O),C,y);var l=this.flush();l&&u(l.buffer)}else this.webCryptoDecrypt(new Uint8Array(O),C,y).then(u)},L.softwareDecrypt=function(O,C,y){var u=this.currentIV,l=this.currentResult,c=this.remainderData;this.logOnce("JS AES decrypt"),c&&(O=(0,K.appendUint8Array)(c,O),this.remainderData=null);var f=this.getValidChunk(O);if(!f.length)return null;u&&(y=u);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new F.default),o.expandKey(C);var a=l;return this.currentResult=o.decrypt(f.buffer,0,y),this.currentIV=(0,w.sliceUint8)(f,-16).buffer,a||null},L.webCryptoDecrypt=function(O,C,y){var u=this,l=this.subtle;return(this.key!==C||!this.fastAesKey)&&(this.key=C,this.fastAesKey=new S.default(l,C)),this.fastAesKey.expandKey().then(function(c){if(!l)return Promise.reject(new Error("web crypto not initialized"));var f=new N.default(l,y);return f.decrypt(O.buffer,c)}).catch(function(c){return u.onWebCryptoError(c,O,C,y)})},L.onWebCryptoError=function(O,C,y,u){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",O),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(C,y,u)},L.getValidChunk=function(O){var C=O,y=O.length-O.length%I;return y!==O.length&&(C=(0,w.sliceUint8)(O,0,y),this.remainderData=(0,w.sliceUint8)(O,y)),C},L.logOnce=function(O){this.logEnabled&&(M.logger.log("[decrypter.ts]: "+O),this.logEnabled=!1)},x}()},"./src/crypt/fast-aes-key.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});var N=function(){function S(M,K){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=K}var F=S.prototype;return F.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},S}()},"./src/demux/aacdemuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>k});var N=m("./src/demux/base-audio-demuxer.ts"),S=m("./src/demux/adts.ts"),F=m("./src/utils/logger.ts"),M=m("./src/demux/id3.ts");function K(x,L){x.prototype=Object.create(L.prototype),x.prototype.constructor=x,w(x,L)}function w(x,L){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(x,L)}var I=function(x){K(L,x);function L(O,C){var y;return y=x.call(this)||this,y.observer=void 0,y.config=void 0,y.observer=O,y.config=C,y}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){x.prototype.resetInitSegment.call(this,C,y,u,l),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:y,duration:l,inputTimeScale:9e4,dropped:0}},L.probe=function(C){if(!C)return!1;for(var y=M.getID3Data(C,0)||[],u=y.length,l=C.length;u<l;u++)if(S.probe(C,u))return F.logger.log("ADTS sync word found !"),!0;return!1},R.canParse=function(C,y){return S.canParse(C,y)},R.appendFrame=function(C,y,u){S.initTrackConfig(C,this.observer,y,u,C.manifestCodec);var l=S.appendFrame(C,y,u,this.basePTS,this.frameIndex);if(l&&l.missing===0)return l},L}(N.default);const k=I},"./src/demux/adts.ts":(b,P,m)=>{m.r(P),m.d(P,{appendFrame:()=>u,canGetFrameLength:()=>k,canParse:()=>L,getAudioConfig:()=>M,getFrameDuration:()=>C,getFullFrameLength:()=>I,getHeaderLength:()=>w,initTrackConfig:()=>O,isHeader:()=>x,isHeaderPattern:()=>K,parseFrameHeader:()=>y,probe:()=>R});var N=m("./src/utils/logger.ts"),S=m("./src/errors.ts"),F=m("./src/events.ts");function M(l,c,f,o){var a,s,d,p,_=navigator.userAgent.toLowerCase(),h=o,A=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((c[f+2]&192)>>>6)+1;var E=(c[f+2]&60)>>>2;if(E>A.length-1){l.trigger(F.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+E});return}return d=(c[f+2]&1)<<2,d|=(c[f+3]&192)>>>6,N.logger.log("manifest codec:"+o+", ADTS type:"+a+", samplingIndex:"+E),/firefox/i.test(_)?E>=6?(a=5,p=new Array(4),s=E-3):(a=2,p=new Array(2),s=E):_.indexOf("android")!==-1?(a=2,p=new Array(2),s=E):(a=5,p=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&E>=6?s=E-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(E>=6&&d===1||/vivaldi/i.test(_))||!o&&d===1)&&(a=2,p=new Array(2)),s=E)),p[0]=a<<3,p[0]|=(E&14)>>1,p[1]|=(E&1)<<7,p[1]|=d<<3,a===5&&(p[1]|=(s&14)>>1,p[2]=(s&1)<<7,p[2]|=8,p[3]=0),{config:p,samplerate:A[E],channelCount:d,codec:"mp4a.40."+a,manifestCodec:h}}function K(l,c){return l[c]===255&&(l[c+1]&246)===240}function w(l,c){return l[c+1]&1?7:9}function I(l,c){return(l[c+3]&3)<<11|l[c+4]<<3|(l[c+5]&224)>>>5}function k(l,c){return c+5<l.length}function x(l,c){return c+1<l.length&&K(l,c)}function L(l,c){return k(l,c)&&K(l,c)&&I(l,c)<=l.length-c}function R(l,c){if(x(l,c)){var f=w(l,c);if(c+f>=l.length)return!1;var o=I(l,c);if(o<=f)return!1;var a=c+o;return a===l.length||x(l,a)}return!1}function O(l,c,f,o,a){if(!l.samplerate){var s=M(c,f,o,a);if(!s)return;l.config=s.config,l.samplerate=s.samplerate,l.channelCount=s.channelCount,l.codec=s.codec,l.manifestCodec=s.manifestCodec,N.logger.log("parsed codec:"+l.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function C(l){return 9216e4/l}function y(l,c){var f=w(l,c);if(c+f<=l.length){var o=I(l,c)-f;if(o>0)return{headerLength:f,frameLength:o}}}function u(l,c,f,o,a){var s=C(l.samplerate),d=o+a*s,p=y(c,f),_;if(p){var h=p.frameLength,A=p.headerLength,E=A+h,v=Math.max(0,f+E-c.length);v?(_=new Uint8Array(E-A),_.set(c.subarray(f+A,c.length),0)):_=c.subarray(f+A,f+E);var T={unit:_,pts:d};return v||l.samples.push(T),{sample:T,length:E,missing:v}}var D=c.length-f;_=new Uint8Array(D),_.set(c.subarray(f,c.length),0);var B={unit:_,pts:d};return{sample:B,length:D,missing:-1}}},"./src/demux/base-audio-demuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>x,initPTSFn:()=>k});var N=m("./src/polyfills/number.ts"),S=m("./src/demux/id3.ts"),F=m("./src/types/demuxer.ts"),M=m("./src/demux/dummy-demuxed-track.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/utils/typed-array.ts"),I=function(){function L(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},R.resetTimeStamp=function(C){this.initPTS=C,this.resetContiguity()},R.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},R.canParse=function(C,y){return!1},R.appendFrame=function(C,y,u){},R.demux=function(C,y){this.cachedData&&(C=(0,K.appendUint8Array)(this.cachedData,C),this.cachedData=null);var u=S.getID3Data(C,0),l=u?u.length:0,c,f=this._audioTrack,o=this._id3Track,a=u?S.getTimeStamp(u):void 0,s=C.length;for((this.basePTS===null||this.frameIndex===0&&(0,N.isFiniteNumber)(a))&&(this.basePTS=k(a,y,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),u&&u.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:F.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});l<s;){if(this.canParse(C,l)){var d=this.appendFrame(f,C,l);d?(this.frameIndex++,this.lastPTS=d.sample.pts,l+=d.length,c=l):l=s}else S.canParse(C,l)?(u=S.getID3Data(C,l),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:F.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),l+=u.length,c=l):l++;if(l===s&&c!==s){var p=(0,w.sliceUint8)(C,c);this.cachedData?this.cachedData=(0,K.appendUint8Array)(this.cachedData,p):this.cachedData=p}}return{audioTrack:f,videoTrack:(0,M.dummyTrack)(),id3Track:o,textTrack:(0,M.dummyTrack)()}},R.demuxSampleAes=function(C,y,u){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},R.flush=function(C){var y=this.cachedData;return y&&(this.cachedData=null,this.demux(y,0)),{audioTrack:this._audioTrack,videoTrack:(0,M.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,M.dummyTrack)()}},R.destroy=function(){},L}(),k=function(R,O,C){return(0,N.isFiniteNumber)(R)?R*90:O*9e4+(C||0)};const x=I},"./src/demux/chunk-cache.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});var N=function(){function F(){this.chunks=[],this.dataLength=0}var M=F.prototype;return M.push=function(w){this.chunks.push(w),this.dataLength+=w.length},M.flush=function(){var w=this.chunks,I=this.dataLength,k;if(w.length)w.length===1?k=w[0]:k=S(w,I);else return new Uint8Array(0);return this.reset(),k},M.reset=function(){this.chunks.length=0,this.dataLength=0},F}();function S(F,M){for(var K=new Uint8Array(M),w=0,I=0;I<F.length;I++){var k=F[I];K.set(k,w),w+=k.length}return K}},"./src/demux/dummy-demuxed-track.ts":(b,P,m)=>{m.r(P),m.d(P,{dummyTrack:()=>N});function N(S,F){return S===void 0&&(S=""),F===void 0&&(F=9e4),{type:S,id:-1,pid:-1,inputTimeScale:F,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>F});var N=m("./src/utils/logger.ts"),S=function(){function M(w){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=w,this.bytesAvailable=w.byteLength,this.word=0,this.bitsAvailable=0}var K=M.prototype;return K.loadWord=function(){var I=this.data,k=this.bytesAvailable,x=I.byteLength-k,L=new Uint8Array(4),R=Math.min(4,k);if(R===0)throw new Error("no bytes available");L.set(I.subarray(x,x+R)),this.word=new DataView(L.buffer).getUint32(0),this.bitsAvailable=R*8,this.bytesAvailable-=R},K.skipBits=function(I){var k;this.bitsAvailable>I?(this.word<<=I,this.bitsAvailable-=I):(I-=this.bitsAvailable,k=I>>3,I-=k>>3,this.bytesAvailable-=k,this.loadWord(),this.word<<=I,this.bitsAvailable-=I)},K.readBits=function(I){var k=Math.min(this.bitsAvailable,I),x=this.word>>>32-k;return I>32&&N.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=k,this.bitsAvailable>0?this.word<<=k:this.bytesAvailable>0&&this.loadWord(),k=I-k,k>0&&this.bitsAvailable?x<<k|this.readBits(k):x},K.skipLZ=function(){var I;for(I=0;I<this.bitsAvailable;++I)if(this.word&2147483648>>>I)return this.word<<=I,this.bitsAvailable-=I,I;return this.loadWord(),I+this.skipLZ()},K.skipUEG=function(){this.skipBits(1+this.skipLZ())},K.skipEG=function(){this.skipBits(1+this.skipLZ())},K.readUEG=function(){var I=this.skipLZ();return this.readBits(I+1)-1},K.readEG=function(){var I=this.readUEG();return 1&I?1+I>>>1:-1*(I>>>1)},K.readBoolean=function(){return this.readBits(1)===1},K.readUByte=function(){return this.readBits(8)},K.readUShort=function(){return this.readBits(16)},K.readUInt=function(){return this.readBits(32)},K.skipScalingList=function(I){for(var k=8,x=8,L,R=0;R<I;R++)x!==0&&(L=this.readEG(),x=(k+L+256)%256),k=x===0?k:x},K.readSPS=function(){var I=0,k=0,x=0,L=0,R,O,C,y=this.readUByte.bind(this),u=this.readBits.bind(this),l=this.readUEG.bind(this),c=this.readBoolean.bind(this),f=this.skipBits.bind(this),o=this.skipEG.bind(this),a=this.skipUEG.bind(this),s=this.skipScalingList.bind(this);y();var d=y();if(u(5),f(3),y(),a(),d===100||d===110||d===122||d===244||d===44||d===83||d===86||d===118||d===128){var p=l();if(p===3&&f(1),a(),a(),f(1),c())for(O=p!==3?8:12,C=0;C<O;C++)c()&&(C<6?s(16):s(64))}a();var _=l();if(_===0)l();else if(_===1)for(f(1),o(),o(),R=l(),C=0;C<R;C++)o();a(),f(1);var h=l(),A=l(),E=u(1);E===0&&f(1),f(1),c()&&(I=l(),k=l(),x=l(),L=l());var v=[1,1];if(c()&&c()){var T=y();switch(T){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:{v=[y()<<8|y(),y()<<8|y()];break}}}return{width:Math.ceil((h+1)*16-I*2-k*2),height:(2-E)*(A+1)*16-(E?2:4)*(x+L),pixelRatio:v}},K.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},M}();const F=S},"./src/demux/id3.ts":(b,P,m)=>{m.r(P),m.d(P,{canParse:()=>K,decodeFrame:()=>L,getID3Data:()=>F,getID3Frames:()=>x,getTimeStamp:()=>w,isFooter:()=>S,isHeader:()=>N,isTimeStampFrame:()=>I,testables:()=>l,utf8ArrayToStr:()=>u});var N=function(a,s){return s+10<=a.length&&a[s]===73&&a[s+1]===68&&a[s+2]===51&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},S=function(a,s){return s+10<=a.length&&a[s]===51&&a[s+1]===68&&a[s+2]===73&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},F=function(a,s){for(var d=s,p=0;N(a,s);){p+=10;var _=M(a,s+6);p+=_,S(a,s+10)&&(p+=10),s+=p}if(p>0)return a.subarray(d,d+p)},M=function(a,s){var d=0;return d=(a[s]&127)<<21,d|=(a[s+1]&127)<<14,d|=(a[s+2]&127)<<7,d|=a[s+3]&127,d},K=function(a,s){return N(a,s)&&M(a,s+6)+10<=a.length-s},w=function(a){for(var s=x(a),d=0;d<s.length;d++){var p=s[d];if(I(p))return y(p)}},I=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},k=function(a){var s=String.fromCharCode(a[0],a[1],a[2],a[3]),d=M(a,4),p=10;return{type:s,size:d,data:a.subarray(p,p+d)}},x=function(a){for(var s=0,d=[];N(a,s);){var p=M(a,s+6);s+=10;for(var _=s+p;s+8<_;){var h=k(a.subarray(s)),A=L(h);A&&d.push(A),s+=h.size+10}S(a,s)&&(s+=10)}return d},L=function(a){return a.type==="PRIV"?R(a):a.type[0]==="W"?C(a):O(a)},R=function(a){if(!(a.size<2)){var s=u(a.data,!0),d=new Uint8Array(a.data.subarray(s.length+1));return{key:a.type,info:s,data:d.buffer}}},O=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var s=1,d=u(a.data.subarray(s),!0);s+=d.length+1;var p=u(a.data.subarray(s));return{key:a.type,info:d,data:p}}var _=u(a.data.subarray(1));return{key:a.type,data:_}}},C=function(a){if(a.type==="WXXX"){if(a.size<2)return;var s=1,d=u(a.data.subarray(s),!0);s+=d.length+1;var p=u(a.data.subarray(s));return{key:a.type,info:d,data:p}}var _=u(a.data);return{key:a.type,data:_}},y=function(a){if(a.data.byteLength===8){var s=new Uint8Array(a.data),d=s[3]&1,p=(s[4]<<23)+(s[5]<<15)+(s[6]<<7)+s[7];return p/=45,d&&(p+=4772185884e-2),Math.round(p)}},u=function(a,s){s===void 0&&(s=!1);var d=f();if(d){var p=d.decode(a);if(s){var _=p.indexOf("\0");return _!==-1?p.substring(0,_):p}return p.replace(/\0/g,"")}for(var h=a.length,A,E,v,T="",D=0;D<h;){if(A=a[D++],A===0&&s)return T;if(A===0||A===3)continue;switch(A>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:T+=String.fromCharCode(A);break;case 12:case 13:E=a[D++],T+=String.fromCharCode((A&31)<<6|E&63);break;case 14:E=a[D++],v=a[D++],T+=String.fromCharCode((A&15)<<12|(E&63)<<6|(v&63)<<0);break}}return T},l={decodeTextFrame:O},c;function f(){return!c&&typeof self.TextDecoder<"u"&&(c=new self.TextDecoder("utf-8")),c}},"./src/demux/mp3demuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>k});var N=m("./src/demux/base-audio-demuxer.ts"),S=m("./src/demux/id3.ts"),F=m("./src/utils/logger.ts"),M=m("./src/demux/mpegaudio.ts");function K(x,L){x.prototype=Object.create(L.prototype),x.prototype.constructor=x,w(x,L)}function w(x,L){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(x,L)}var I=function(x){K(L,x);function L(){return x.apply(this,arguments)||this}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){x.prototype.resetInitSegment.call(this,C,y,u,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:y,duration:l,inputTimeScale:9e4,dropped:0}},L.probe=function(C){if(!C)return!1;for(var y=S.getID3Data(C,0)||[],u=y.length,l=C.length;u<l;u++)if(M.probe(C,u))return F.logger.log("MPEG Audio sync word found !"),!0;return!1},R.canParse=function(C,y){return M.canParse(C,y)},R.appendFrame=function(C,y,u){if(this.basePTS!==null)return M.appendFrame(C,y,u,this.basePTS,this.frameIndex)},L}(N.default);const k=I},"./src/demux/mp4demuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>I});var N=m("./src/polyfills/number.ts"),S=m("./src/types/demuxer.ts"),F=m("./src/utils/mp4-tools.ts"),M=m("./src/demux/dummy-demuxed-track.ts"),K=/\/emsg[-/]ID3/i,w=function(){function k(L,R){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=R}var x=k.prototype;return x.resetTimeStamp=function(){},x.resetInitSegment=function(R,O,C,y){var u=(0,F.parseInitSegment)(R),l=this.videoTrack=(0,M.dummyTrack)("video",1),c=this.audioTrack=(0,M.dummyTrack)("audio",1),f=this.txtTrack=(0,M.dummyTrack)("text",1);if(this.id3Track=(0,M.dummyTrack)("id3",1),this.timeOffset=0,u.video){var o=u.video,a=o.id,s=o.timescale,d=o.codec;l.id=a,l.timescale=f.timescale=s,l.codec=d}if(u.audio){var p=u.audio,_=p.id,h=p.timescale,A=p.codec;c.id=_,c.timescale=h,c.codec=A}f.id=F.RemuxerTrackIdConfig.text,l.sampleDuration=0,l.duration=c.duration=y},x.resetContiguity=function(){},k.probe=function(R){return R=R.length>16384?R.subarray(0,16384):R,(0,F.findBox)(R,["moof"]).length>0},x.demux=function(R,O){this.timeOffset=O;var C=R,y=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(C=(0,F.appendUint8Array)(this.remainderData,R));var l=(0,F.segmentValidRange)(C);this.remainderData=l.remainder,y.samples=l.valid||new Uint8Array}else y.samples=C;var c=this.extractID3Track(y,O);return u.samples=(0,F.parseSamples)(O,y),{videoTrack:y,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}},x.flush=function(){var R=this.timeOffset,O=this.videoTrack,C=this.txtTrack;O.samples=this.remainderData||new Uint8Array,this.remainderData=null;var y=this.extractID3Track(O,this.timeOffset);return C.samples=(0,F.parseSamples)(R,O),{videoTrack:O,audioTrack:(0,M.dummyTrack)(),id3Track:y,textTrack:(0,M.dummyTrack)()}},x.extractID3Track=function(R,O){var C=this.id3Track;if(R.samples.length){var y=(0,F.findBox)(R.samples,["emsg"]);y&&y.forEach(function(u){var l=(0,F.parseEmsg)(u);if(K.test(l.schemeIdUri)){var c=(0,N.isFiniteNumber)(l.presentationTime)?l.presentationTime/l.timeScale:O+l.presentationTimeDelta/l.timeScale,f=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);var o=l.payload;C.samples.push({data:o,len:o.byteLength,dts:c,pts:c,type:S.MetadataSchema.emsg,duration:f})}})}return C},x.demuxSampleAes=function(R,O,C){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},x.destroy=function(){},k}();const I=w},"./src/demux/mpegaudio.ts":(b,P,m)=>{m.r(P),m.d(P,{appendFrame:()=>w,canParse:()=>L,isHeader:()=>x,isHeaderPattern:()=>k,parseHeader:()=>I,probe:()=>R});var N=null,S=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],F=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],K=[0,1,1,4];function w(O,C,y,u,l){if(!(y+24>C.length)){var c=I(C,y);if(c&&y+c.frameLength<=C.length){var f=c.samplesPerFrame*9e4/c.sampleRate,o=u+l*f,a={unit:C.subarray(y,y+c.frameLength),pts:o,dts:o};return O.config=[],O.channelCount=c.channelCount,O.samplerate=c.sampleRate,O.samples.push(a),{sample:a,length:c.frameLength,missing:0}}}}function I(O,C){var y=O[C+1]>>3&3,u=O[C+1]>>1&3,l=O[C+2]>>4&15,c=O[C+2]>>2&3;if(y!==1&&l!==0&&l!==15&&c!==3){var f=O[C+2]>>1&1,o=O[C+3]>>6,a=y===3?3-u:u===3?3:4,s=S[a*14+l-1]*1e3,d=y===3?0:y===2?1:2,p=F[d*3+c],_=o===3?1:2,h=M[y][u],A=K[u],E=h*8*A,v=Math.floor(h*s/p+f)*A;if(N===null){var T=navigator.userAgent||"",D=T.match(/Chrome\/(\d+)/i);N=D?parseInt(D[1]):0}var B=!!N&&N<=87;return B&&u===2&&s>=224e3&&o===0&&(O[C+3]=O[C+3]|128),{sampleRate:p,channelCount:_,frameLength:v,samplesPerFrame:E}}}function k(O,C){return O[C]===255&&(O[C+1]&224)===224&&(O[C+1]&6)!==0}function x(O,C){return C+1<O.length&&k(O,C)}function L(O,C){var y=4;return k(O,C)&&y<=O.length-C}function R(O,C){if(C+1<O.length&&k(O,C)){var y=4,u=I(O,C),l=y;u!=null&&u.frameLength&&(l=u.frameLength);var c=C+l;return c===O.length||x(O,c)}return!1}},"./src/demux/sample-aes.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>M});var N=m("./src/crypt/decrypter.ts"),S=m("./src/utils/mp4-tools.ts"),F=function(){function K(I,k,x){this.keyData=void 0,this.decrypter=void 0,this.keyData=x,this.decrypter=new N.default(I,k,{removePKCS7Padding:!1})}var w=K.prototype;return w.decryptBuffer=function(k,x){this.decrypter.decrypt(k,this.keyData.key.buffer,this.keyData.iv.buffer,x)},w.decryptAacSample=function(k,x,L,R){var O=k[x].unit;if(!(O.length<=16)){var C=O.subarray(16,O.length-O.length%16),y=C.buffer.slice(C.byteOffset,C.byteOffset+C.length),u=this;this.decryptBuffer(y,function(l){var c=new Uint8Array(l);O.set(c,16),R||u.decryptAacSamples(k,x+1,L)})}},w.decryptAacSamples=function(k,x,L){for(;;x++){if(x>=k.length){L();return}if(!(k[x].unit.length<32)){var R=this.decrypter.isSync();if(this.decryptAacSample(k,x,L,R),!R)return}}},w.getAvcEncryptedData=function(k){for(var x=Math.floor((k.length-48)/160)*16+16,L=new Int8Array(x),R=0,O=32;O<k.length-16;O+=160,R+=16)L.set(k.subarray(O,O+16),R);return L},w.getAvcDecryptedUnit=function(k,x){for(var L=new Uint8Array(x),R=0,O=32;O<k.length-16;O+=160,R+=16)k.set(L.subarray(R,R+16),O);return k},w.decryptAvcSample=function(k,x,L,R,O,C){var y=(0,S.discardEPB)(O.data),u=this.getAvcEncryptedData(y),l=this;this.decryptBuffer(u.buffer,function(c){O.data=l.getAvcDecryptedUnit(y,c),C||l.decryptAvcSamples(k,x,L+1,R)})},w.decryptAvcSamples=function(k,x,L,R){if(k instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;x++,L=0){if(x>=k.length){R();return}for(var O=k[x].units;!(L>=O.length);L++){var C=O[L];if(!(C.data.length<=48||C.type!==1&&C.type!==5)){var y=this.decrypter.isSync();if(this.decryptAvcSample(k,x,L,R,C,y),!y)return}}}},K}();const M=F},"./src/demux/transmuxer-interface.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>x});var N=m("./src/demux/webworkify-webpack.js"),S=m("./src/events.ts"),F=m("./src/demux/transmuxer.ts"),M=m("./src/utils/logger.ts"),K=m("./src/errors.ts"),w=m("./src/utils/mediasource-helper.ts"),I=m("./node_modules/eventemitter3/index.js"),k=(0,w.getMediaSource)()||{isTypeSupported:function(){return!1}},x=function(){function L(O,C,y,u){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var c=O.config;this.hls=O,this.id=C,this.useWorker=!!c.enableWorker,this.onTransmuxComplete=y,this.onFlush=u;var f=function(p,_){_=_||{},_.frag=l.frag,_.id=l.id,l.hls.trigger(p,_)};this.observer=new I.EventEmitter,this.observer.on(S.Events.FRAG_DECRYPTED,f),this.observer.on(S.Events.ERROR,f);var o={mp4:k.isTypeSupported("video/mp4"),mpeg:k.isTypeSupported("audio/mpeg"),mp3:k.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){M.logger.log("demuxing in webworker");var s;try{s=this.worker=(0,N.default)("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),s.addEventListener("message",this.onwmsg),s.onerror=function(d){l.useWorker=!1,M.logger.warn("Exception in webworker, fallback to inline"),l.hls.trigger(S.Events.ERROR,{type:K.ErrorTypes.OTHER_ERROR,details:K.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(d.message+"  ("+d.filename+":"+d.lineno+")")})},s.postMessage({cmd:"init",typeSupported:o,vendor:a,id:C,config:JSON.stringify(c)})}catch(d){M.logger.warn("Error in worker:",d),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),s&&self.URL.revokeObjectURL(s.objectURL),this.transmuxer=new F.default(this.observer,o,c,a,C),this.worker=null}}else this.transmuxer=new F.default(this.observer,o,c,a,C)}var R=L.prototype;return R.destroy=function(){var C=this.worker;if(C)C.removeEventListener("message",this.onwmsg),C.terminate(),this.worker=null,this.onwmsg=void 0;else{var y=this.transmuxer;y&&(y.destroy(),this.transmuxer=null)}var u=this.observer;u&&u.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},R.push=function(C,y,u,l,c,f,o,a,s,d){var p,_,h=this;s.transmuxing.start=self.performance.now();var A=this.transmuxer,E=this.worker,v=f?f.start:c.start,T=c.decryptdata,D=this.frag,B=!(D&&c.cc===D.cc),V=!(D&&s.level===D.level),W=D?s.sn-D.sn:-1,j=this.part?s.part-this.part.index:-1,$=W===0&&s.id>1&&s.id===(D==null?void 0:D.stats.chunkCount),Q=!V&&(W===1||W===0&&(j===1||$&&j<=0)),Z=self.performance.now();(V||W||c.stats.parsing.start===0)&&(c.stats.parsing.start=Z),f&&(j||!Q)&&(f.stats.parsing.start=Z);var ee=!(D&&((p=c.initSegment)===null||p===void 0?void 0:p.url)===((_=D.initSegment)===null||_===void 0?void 0:_.url)),ae=new F.TransmuxState(B,Q,a,V,v,ee);if(!Q||B||ee){M.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+s.sn+" p: "+s.part+" level: "+s.level+" id: "+s.id+`
        discontinuity: `+B+`
        trackSwitch: `+V+`
        contiguous: `+Q+`
        accurateTimeOffset: `+a+`
        timeOffset: `+v+`
        initSegmentChange: `+ee);var se=new F.TransmuxConfig(u,l,y,o,d);this.configureTransmuxer(se)}if(this.frag=c,this.part=f,E)E.postMessage({cmd:"demux",data:C,decryptdata:T,chunkMeta:s,state:ae},C instanceof ArrayBuffer?[C]:[]);else if(A){var Y=A.push(C,T,s,ae);(0,F.isPromise)(Y)?Y.then(function(X){h.handleTransmuxComplete(X)}):this.handleTransmuxComplete(Y)}},R.flush=function(C){var y=this;C.transmuxing.start=self.performance.now();var u=this.transmuxer,l=this.worker;if(l)l.postMessage({cmd:"flush",chunkMeta:C});else if(u){var c=u.flush(C);(0,F.isPromise)(c)?c.then(function(f){y.handleFlushResult(f,C)}):this.handleFlushResult(c,C)}},R.handleFlushResult=function(C,y){var u=this;C.forEach(function(l){u.handleTransmuxComplete(l)}),this.onFlush(y)},R.onWorkerMessage=function(C){var y=C.data,u=this.hls;switch(y.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(y.data);break}case"flush":{this.onFlush(y.data);break}case"workerLog":M.logger[y.data.logType]&&M.logger[y.data.logType](y.data.message);break;default:{y.data=y.data||{},y.data.frag=this.frag,y.data.id=this.id,u.trigger(y.event,y.data);break}}},R.configureTransmuxer=function(C){var y=this.worker,u=this.transmuxer;y?y.postMessage({cmd:"configure",config:C}):u&&u.configure(C)},R.handleTransmuxComplete=function(C){C.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(C)},L}()},"./src/demux/transmuxer-worker.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>K});var N=m("./src/demux/transmuxer.ts"),S=m("./src/events.ts"),F=m("./src/utils/logger.ts"),M=m("./node_modules/eventemitter3/index.js");function K(L){var R=new M.EventEmitter,O=function(u,l){L.postMessage({event:u,data:l})};R.on(S.Events.FRAG_DECRYPTED,O),R.on(S.Events.ERROR,O);var C=function(){var u=function(f){var o=function(s){O("workerLog",{logType:f,message:s})};F.logger[f]=o};for(var l in F.logger)u(l)};L.addEventListener("message",function(y){var u=y.data;switch(u.cmd){case"init":{var l=JSON.parse(u.config);L.transmuxer=new N.default(R,u.typeSupported,l,u.vendor,u.id),(0,F.enableLogs)(l.debug,u.id),C(),O("init",null);break}case"configure":{L.transmuxer.configure(u.config);break}case"demux":{var c=L.transmuxer.push(u.data,u.decryptdata,u.chunkMeta,u.state);(0,N.isPromise)(c)?c.then(function(a){w(L,a)}):w(L,c);break}case"flush":{var f=u.chunkMeta,o=L.transmuxer.flush(f);(0,N.isPromise)(o)?o.then(function(a){k(L,a,f)}):k(L,o,f);break}}})}function w(L,R){if(x(R.remuxResult))return!1;var O=[],C=R.remuxResult,y=C.audio,u=C.video;return y&&I(O,y),u&&I(O,u),L.postMessage({event:"transmuxComplete",data:R},O),!0}function I(L,R){R.data1&&L.push(R.data1.buffer),R.data2&&L.push(R.data2.buffer)}function k(L,R,O){var C=R.reduce(function(y,u){return w(L,u)||y},!1);C||L.postMessage({event:"transmuxComplete",data:R[0]}),L.postMessage({event:"flush",data:O})}function x(L){return!L.audio&&!L.video&&!L.text&&!L.id3&&!L.initSegment}},"./src/demux/transmuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{TransmuxConfig:()=>c,TransmuxState:()=>f,default:()=>C,isPromise:()=>l});var N=m("./src/events.ts"),S=m("./src/errors.ts"),F=m("./src/crypt/decrypter.ts"),M=m("./src/demux/aacdemuxer.ts"),K=m("./src/demux/mp4demuxer.ts"),w=m("./src/demux/tsdemuxer.ts"),I=m("./src/demux/mp3demuxer.ts"),k=m("./src/remux/mp4-remuxer.ts"),x=m("./src/remux/passthrough-remuxer.ts"),L=m("./src/utils/logger.ts"),R;try{R=self.performance.now.bind(self.performance)}catch{L.logger.debug("Unable to use Performance API on this environment"),R=self.Date.now}var O=[{demux:w.default,remux:k.default},{demux:K.default,remux:x.default},{demux:M.default,remux:k.default},{demux:I.default,remux:k.default}],C=function(){function o(s,d,p,_,h){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=s,this.typeSupported=d,this.config=p,this.vendor=_,this.id=h}var a=o.prototype;return a.configure=function(d){this.transmuxConfig=d,this.decrypter&&this.decrypter.reset()},a.push=function(d,p,_,h){var A=this,E=_.transmuxing;E.executeStart=R();var v=new Uint8Array(d),T=this.config,D=this.currentTransmuxState,B=this.transmuxConfig;h&&(this.currentTransmuxState=h);var V=h||D,W=V.contiguous,j=V.discontinuity,$=V.trackSwitch,Q=V.accurateTimeOffset,Z=V.timeOffset,ee=V.initSegmentChange,ae=B.audioCodec,se=B.videoCodec,Y=B.defaultInitPts,X=B.duration,q=B.initSegmentData;(j||$||ee)&&this.resetInitSegment(q,ae,se,X),(j||ee)&&this.resetInitialTimestamp(Y),W||this.resetContiguity();var re=y(v,p);if(re&&re.method==="AES-128"){var ne=this.getDecrypter();if(T.enableSoftwareAES){var U=ne.softwareDecrypt(v,re.key.buffer,re.iv.buffer);if(!U)return E.executeEnd=R(),u(_);v=new Uint8Array(U)}else return this.decryptionPromise=ne.webCryptoDecrypt(v,re.key.buffer,re.iv.buffer).then(function(J){var te=A.push(J,null,_);return A.decryptionPromise=null,te}),this.decryptionPromise}this.needsProbing(v,j,$)&&this.configureTransmuxer(v,B);var H=this.transmux(v,re,Z,Q,_),z=this.currentTransmuxState;return z.contiguous=!0,z.discontinuity=!1,z.trackSwitch=!1,E.executeEnd=R(),H},a.flush=function(d){var p=this,_=d.transmuxing;_.executeStart=R();var h=this.decrypter,A=this.currentTransmuxState,E=this.decryptionPromise;if(E)return E.then(function(){return p.flush(d)});var v=[],T=A.timeOffset;if(h){var D=h.flush();D&&v.push(this.push(D,null,d))}var B=this.demuxer,V=this.remuxer;if(!B||!V)return this.observer.emit(N.Events.ERROR,N.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),_.executeEnd=R(),[u(d)];var W=B.flush(T);return l(W)?W.then(function(j){return p.flushRemux(v,j,d),v}):(this.flushRemux(v,W,d),v)},a.flushRemux=function(d,p,_){var h=p.audioTrack,A=p.videoTrack,E=p.id3Track,v=p.textTrack,T=this.currentTransmuxState,D=T.accurateTimeOffset,B=T.timeOffset;L.logger.log("[transmuxer.ts]: Flushed fragment "+_.sn+(_.part>-1?" p: "+_.part:"")+" of level "+_.level);var V=this.remuxer.remux(h,A,E,v,B,D,!0,this.id);d.push({remuxResult:V,chunkMeta:_}),_.transmuxing.executeEnd=R()},a.resetInitialTimestamp=function(d){var p=this.demuxer,_=this.remuxer;!p||!_||(p.resetTimeStamp(d),_.resetTimeStamp(d))},a.resetContiguity=function(){var d=this.demuxer,p=this.remuxer;!d||!p||(d.resetContiguity(),p.resetNextTimestamp())},a.resetInitSegment=function(d,p,_,h){var A=this.demuxer,E=this.remuxer;!A||!E||(A.resetInitSegment(d,p,_,h),E.resetInitSegment(d,p,_))},a.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},a.transmux=function(d,p,_,h,A){var E;return p&&p.method==="SAMPLE-AES"?E=this.transmuxSampleAes(d,p,_,h,A):E=this.transmuxUnencrypted(d,_,h,A),E},a.transmuxUnencrypted=function(d,p,_,h){var A=this.demuxer.demux(d,p,!1,!this.config.progressive),E=A.audioTrack,v=A.videoTrack,T=A.id3Track,D=A.textTrack,B=this.remuxer.remux(E,v,T,D,p,_,!1,this.id);return{remuxResult:B,chunkMeta:h}},a.transmuxSampleAes=function(d,p,_,h,A){var E=this;return this.demuxer.demuxSampleAes(d,p,_).then(function(v){var T=E.remuxer.remux(v.audioTrack,v.videoTrack,v.id3Track,v.textTrack,_,h,!1,E.id);return{remuxResult:T,chunkMeta:A}})},a.configureTransmuxer=function(d,p){for(var _=this.config,h=this.observer,A=this.typeSupported,E=this.vendor,v=p.audioCodec,T=p.defaultInitPts,D=p.duration,B=p.initSegmentData,V=p.videoCodec,W,j=0,$=O.length;j<$;j++)if(O[j].demux.probe(d)){W=O[j];break}W||(L.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),W={demux:K.default,remux:x.default});var Q=this.demuxer,Z=this.remuxer,ee=W.remux,ae=W.demux;(!Z||!(Z instanceof ee))&&(this.remuxer=new ee(h,_,A,E)),(!Q||!(Q instanceof ae))&&(this.demuxer=new ae(h,_,A),this.probe=ae.probe),this.resetInitSegment(B,v,V,D),this.resetInitialTimestamp(T)},a.needsProbing=function(d,p,_){return!this.demuxer||!this.remuxer||p||_},a.getDecrypter=function(){var d=this.decrypter;return d||(d=this.decrypter=new F.default(this.observer,this.config)),d},o}();function y(o,a){var s=null;return o.byteLength>0&&a!=null&&a.key!=null&&a.iv!==null&&a.method!=null&&(s=a),s}var u=function(a){return{remuxResult:{},chunkMeta:a}};function l(o){return"then"in o&&o.then instanceof Function}var c=function(a,s,d,p,_){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=a,this.videoCodec=s,this.initSegmentData=d,this.duration=p,this.defaultInitPts=_},f=function(a,s,d,p,_,h){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=a,this.contiguous=s,this.accurateTimeOffset=d,this.trackSwitch=p,this.timeOffset=_,this.initSegmentChange=h}},"./src/demux/tsdemuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>f});var N=m("./src/demux/adts.ts"),S=m("./src/demux/mpegaudio.ts"),F=m("./src/demux/exp-golomb.ts"),M=m("./src/demux/sample-aes.ts"),K=m("./src/events.ts"),w=m("./src/utils/mp4-tools.ts"),I=m("./src/utils/logger.ts"),k=m("./src/errors.ts"),x=m("./src/types/demuxer.ts");function L(){return L=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(o[d]=s[d])}return o},L.apply(this,arguments)}var R=188,O=function(){function o(s,d,p){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=s,this.config=d,this.typeSupported=p}o.probe=function(d){var p=o.syncOffset(d);return p>0&&I.logger.warn("MPEG2-TS detected but first sync word found @ offset "+p),p!==-1},o.syncOffset=function(d){for(var p=Math.min(R*5,d.length-R*2)+1,_=0;_<p;){if(d[_]===71&&d[_+R]===71)return _;_++}return-1},o.createTrack=function(d,p){return{container:d==="video"||d==="audio"?"video/mp2t":void 0,type:d,id:w.RemuxerTrackIdConfig[d],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:d==="audio"?p:void 0}};var a=o.prototype;return a.resetInitSegment=function(d,p,_,h){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video"),this._audioTrack=o.createTrack("audio",h),this._id3Track=o.createTrack("id3"),this._txtTrack=o.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=p,this.videoCodec=_,this._duration=h},a.resetTimeStamp=function(){},a.resetContiguity=function(){var d=this._audioTrack,p=this._avcTrack,_=this._id3Track;d&&(d.pesData=null),p&&(p.pesData=null),_&&(_.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},a.demux=function(d,p,_,h){_===void 0&&(_=!1),h===void 0&&(h=!1),_||(this.sampleAes=null);var A,E=this._avcTrack,v=this._audioTrack,T=this._id3Track,D=this._txtTrack,B=E.pid,V=E.pesData,W=v.pid,j=T.pid,$=v.pesData,Q=T.pesData,Z=null,ee=this.pmtParsed,ae=this._pmtId,se=d.length;if(this.remainderData&&(d=(0,w.appendUint8Array)(this.remainderData,d),se=d.length,this.remainderData=null),se<R&&!h)return this.remainderData=d,{audioTrack:v,videoTrack:E,id3Track:T,textTrack:D};var Y=Math.max(0,o.syncOffset(d));se-=(se-Y)%R,se<d.byteLength&&!h&&(this.remainderData=new Uint8Array(d.buffer,se,d.buffer.byteLength-se));for(var X=0,q=Y;q<se;q+=R)if(d[q]===71){var re=!!(d[q+1]&64),ne=((d[q+1]&31)<<8)+d[q+2],U=(d[q+3]&48)>>4,H=void 0;if(U>1){if(H=q+5+d[q+4],H===q+R)continue}else H=q+4;switch(ne){case B:re&&(V&&(A=l(V))&&this.parseAVCPES(E,D,A,!1),V={data:[],size:0}),V&&(V.data.push(d.subarray(H,q+R)),V.size+=q+R-H);break;case W:if(re){if($&&(A=l($)))switch(v.segmentCodec){case"aac":this.parseAACPES(v,A);break;case"mp3":this.parseMPEGPES(v,A);break}$={data:[],size:0}}$&&($.data.push(d.subarray(H,q+R)),$.size+=q+R-H);break;case j:re&&(Q&&(A=l(Q))&&this.parseID3PES(T,A),Q={data:[],size:0}),Q&&(Q.data.push(d.subarray(H,q+R)),Q.size+=q+R-H);break;case 0:re&&(H+=d[H]+1),ae=this._pmtId=y(d,H);break;case ae:{re&&(H+=d[H]+1);var z=u(d,H,this.typeSupported,_);B=z.avc,B>0&&(E.pid=B),W=z.audio,W>0&&(v.pid=W,v.segmentCodec=z.segmentCodec),j=z.id3,j>0&&(T.pid=j),Z!==null&&!ee&&(I.logger.log("unknown PID '"+Z+"' in TS found"),Z=null,q=Y-188),ee=this.pmtParsed=!0;break}case 17:case 8191:break;default:Z=ne;break}}else X++;X>0&&this.observer.emit(K.Events.ERROR,K.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+X+" TS packet/s that do not start with 0x47"}),E.pesData=V,v.pesData=$,T.pesData=Q;var J={audioTrack:v,videoTrack:E,id3Track:T,textTrack:D};return h&&this.extractRemainingSamples(J),J},a.flush=function(){var d=this.remainderData;this.remainderData=null;var p;return d?p=this.demux(d,-1,!1,!0):p={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(p),this.sampleAes?this.decrypt(p,this.sampleAes):p},a.extractRemainingSamples=function(d){var p=d.audioTrack,_=d.videoTrack,h=d.id3Track,A=d.textTrack,E=_.pesData,v=p.pesData,T=h.pesData,D;if(E&&(D=l(E))?(this.parseAVCPES(_,A,D,!0),_.pesData=null):_.pesData=E,v&&(D=l(v))){switch(p.segmentCodec){case"aac":this.parseAACPES(p,D);break;case"mp3":this.parseMPEGPES(p,D);break}p.pesData=null}else v!=null&&v.size&&I.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=v;T&&(D=l(T))?(this.parseID3PES(h,D),h.pesData=null):h.pesData=T},a.demuxSampleAes=function(d,p,_){var h=this.demux(d,_,!0,!this.config.progressive),A=this.sampleAes=new M.default(this.observer,this.config,p);return this.decrypt(h,A)},a.decrypt=function(d,p){return new Promise(function(_){var h=d.audioTrack,A=d.videoTrack;h.samples&&h.segmentCodec==="aac"?p.decryptAacSamples(h.samples,0,function(){A.samples?p.decryptAvcSamples(A.samples,0,0,function(){_(d)}):_(d)}):A.samples&&p.decryptAvcSamples(A.samples,0,0,function(){_(d)})})},a.destroy=function(){this._duration=0},a.parseAVCPES=function(d,p,_,h){var A=this,E=this.parseAVCNALu(d,_.data),v=this.avcSample,T,D=!1;_.data=null,v&&E.length&&!d.audFound&&(c(v,d),v=this.avcSample=C(!1,_.pts,_.dts,"")),E.forEach(function(B){switch(B.type){case 1:{T=!0,v||(v=A.avcSample=C(!0,_.pts,_.dts,"")),v.frame=!0;var V=B.data;if(D&&V.length>4){var W=new F.default(V).readSliceType();(W===2||W===4||W===7||W===9)&&(v.key=!0)}break}case 5:T=!0,v||(v=A.avcSample=C(!0,_.pts,_.dts,"")),v.key=!0,v.frame=!0;break;case 6:{T=!0,(0,w.parseSEIMessageFromNALu)(B.data,1,_.pts,p.samples);break}case 7:if(T=!0,D=!0,!d.sps){var j=new F.default(B.data),$=j.readSPS();d.width=$.width,d.height=$.height,d.pixelRatio=$.pixelRatio,d.sps=[B.data],d.duration=A._duration;for(var Q=B.data.subarray(1,4),Z="avc1.",ee=0;ee<3;ee++){var ae=Q[ee].toString(16);ae.length<2&&(ae="0"+ae),Z+=ae}d.codec=Z}break;case 8:T=!0,d.pps||(d.pps=[B.data]);break;case 9:T=!1,d.audFound=!0,v&&c(v,d),v=A.avcSample=C(!1,_.pts,_.dts,"");break;case 12:T=!0;break;default:T=!1,v&&(v.debug+="unknown NAL "+B.type+" ");break}if(v&&T){var se=v.units;se.push(B)}}),h&&v&&(c(v,d),this.avcSample=null)},a.getLastNalUnit=function(d){var p,_=this.avcSample,h;if((!_||_.units.length===0)&&(_=d[d.length-1]),(p=_)!==null&&p!==void 0&&p.units){var A=_.units;h=A[A.length-1]}return h},a.parseAVCNALu=function(d,p){var _=p.byteLength,h=d.naluState||0,A=h,E=[],v=0,T,D,B,V=-1,W=0;for(h===-1&&(V=0,W=p[0]&31,h=0,v=1);v<_;){if(T=p[v++],!h){h=T?0:1;continue}if(h===1){h=T?0:2;continue}if(!T)h=3;else if(T===1){if(V>=0){var j={data:p.subarray(V,v-h-1),type:W};E.push(j)}else{var $=this.getLastNalUnit(d.samples);if($&&(A&&v<=4-A&&$.state&&($.data=$.data.subarray(0,$.data.byteLength-A)),D=v-h-1,D>0)){var Q=new Uint8Array($.data.byteLength+D);Q.set($.data,0),Q.set(p.subarray(0,D),$.data.byteLength),$.data=Q,$.state=0}}v<_?(B=p[v]&31,V=v,W=B,h=0):h=-1}else h=0}if(V>=0&&h>=0){var Z={data:p.subarray(V,_),type:W,state:h};E.push(Z)}if(E.length===0){var ee=this.getLastNalUnit(d.samples);if(ee){var ae=new Uint8Array(ee.data.byteLength+p.byteLength);ae.set(ee.data,0),ae.set(p,ee.data.byteLength),ee.data=ae}}return d.naluState=h,E},a.parseAACPES=function(d,p){var _=0,h=this.aacOverFlow,A=p.data;if(h){this.aacOverFlow=null;var E=h.missing,v=h.sample.unit.byteLength;if(E===-1){var T=new Uint8Array(v+A.byteLength);T.set(h.sample.unit,0),T.set(A,v),A=T}else{var D=v-E;h.sample.unit.set(A.subarray(0,E),D),d.samples.push(h.sample),_=h.missing}}var B,V;for(B=_,V=A.length;B<V-1&&!N.isHeader(A,B);B++);if(B!==_){var W,j;if(B<V-1?(W="AAC PES did not start with ADTS header,offset:"+B,j=!1):(W="no ADTS header found in AAC PES",j=!0),I.logger.warn("parsing error:"+W),this.observer.emit(K.Events.ERROR,K.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:W}),j)return}N.initTrackConfig(d,this.observer,A,B,this.audioCodec);var $;if(p.pts!==void 0)$=p.pts;else if(h){var Q=N.getFrameDuration(d.samplerate);$=h.sample.pts+Q}else{I.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var Z=0,ee;B<V;)if(ee=N.appendFrame(d,A,B,$,Z),B+=ee.length,ee.missing){this.aacOverFlow=ee;break}else for(Z++;B<V-1&&!N.isHeader(A,B);B++);},a.parseMPEGPES=function(d,p){var _=p.data,h=_.length,A=0,E=0,v=p.pts;if(v===void 0){I.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;E<h;)if(S.isHeader(_,E)){var T=S.appendFrame(d,_,E,v,A);if(T)E+=T.length,A++;else break}else E++},a.parseID3PES=function(d,p){if(p.pts===void 0){I.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var _=L({},p,{type:this._avcTrack?x.MetadataSchema.emsg:x.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});d.samples.push(_)},o}();function C(o,a,s,d){return{key:o,frame:!1,pts:a,dts:s,units:[],debug:d,length:0}}function y(o,a){return(o[a+10]&31)<<8|o[a+11]}function u(o,a,s,d){var p={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},_=(o[a+1]&15)<<8|o[a+2],h=a+3+_-4,A=(o[a+10]&15)<<8|o[a+11];for(a+=12+A;a<h;){var E=(o[a+1]&31)<<8|o[a+2];switch(o[a]){case 207:if(!d){I.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:p.audio===-1&&(p.audio=E);break;case 21:p.id3===-1&&(p.id3=E);break;case 219:if(!d){I.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:p.avc===-1&&(p.avc=E);break;case 3:case 4:s.mpeg!==!0&&s.mp3!==!0?I.logger.log("MPEG audio found, not supported in this browser"):p.audio===-1&&(p.audio=E,p.segmentCodec="mp3");break;case 36:I.logger.warn("Unsupported HEVC stream type found");break}a+=((o[a+3]&15)<<8|o[a+4])+5}return p}function l(o){var a=0,s,d,p,_,h,A=o.data;if(!o||o.size===0)return null;for(;A[0].length<19&&A.length>1;){var E=new Uint8Array(A[0].length+A[1].length);E.set(A[0]),E.set(A[1],A[0].length),A[0]=E,A.splice(1,1)}s=A[0];var v=(s[0]<<16)+(s[1]<<8)+s[2];if(v===1){if(d=(s[4]<<8)+s[5],d&&d>o.size-6)return null;var T=s[7];T&192&&(_=(s[9]&14)*536870912+(s[10]&255)*4194304+(s[11]&254)*16384+(s[12]&255)*128+(s[13]&254)/2,T&64?(h=(s[14]&14)*536870912+(s[15]&255)*4194304+(s[16]&254)*16384+(s[17]&255)*128+(s[18]&254)/2,_-h>54e5&&(I.logger.warn(Math.round((_-h)/9e4)+"s delta between PTS and DTS, align them"),_=h)):h=_),p=s[8];var D=p+9;if(o.size<=D)return null;o.size-=D;for(var B=new Uint8Array(o.size),V=0,W=A.length;V<W;V++){s=A[V];var j=s.byteLength;if(D)if(D>j){D-=j;continue}else s=s.subarray(D),j-=D,D=0;B.set(s,a),a+=j}return d&&(d-=p+3),{data:B,pts:_,dts:h,len:d}}return null}function c(o,a){if(o.units.length&&o.frame){if(o.pts===void 0){var s=a.samples,d=s.length;if(d){var p=s[d-1];o.pts=p.pts,o.dts=p.dts}else{a.dropped++;return}}a.samples.push(o)}o.debug.length&&I.logger.log(o.pts+"/"+o.dts+":"+o.debug)}const f=O},"./src/demux/webworkify-webpack.js":(b,P,m)=>{m.r(P),m.d(P,{default:()=>R});var N=function(){var C=ENTRY_MODULE,y={},u=function c(f){var o=y[f];if(o!==void 0)return o.exports;var a=y[f]={exports:{}};return C[f].call(a.exports,a,a.exports,c),a.exports};u.m=C,function(){u.n=function(c){var f=c&&c.__esModule?function(){return c.default}:function(){return c};return u.d(f,{a:f}),f}}(),function(){u.d=function(c,f){for(var o in f)u.o(f,o)&&!u.o(c,o)&&Object.defineProperty(c,o,{enumerable:!0,get:f[o]})}}(),function(){u.o=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)}}(),function(){u.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}();var l=u(ENTRY_MODULE);return l.default||l},S=N.toString().split("ENTRY_MODULE"),F="[\\.|\\-|\\+|\\w|/|@]+",M="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+F+").*?\\)";function K(O){return(O+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function w(O){return!isNaN(1*O)}function I(O,C,y){var u={};u[y]=[];var l=C.toString().replace(/^"[^"]+"/,"function"),c=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||l.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!c)return u;for(var f=c[1],o=new RegExp("(\\\\n|\\W)"+K(f)+M,"g"),a;a=o.exec(l);)a[3]!=="dll-reference"&&u[y].push(a[3]);for(o=new RegExp("\\("+K(f)+'\\("(dll-reference\\s('+F+'))"\\)\\)'+M,"g");a=o.exec(l);)O[a[2]]||(u[y].push(a[1]),O[a[2]]=m(a[1]).m),u[a[2]]=u[a[2]]||[],u[a[2]].push(a[4]);for(var s=Object.keys(u),d=0;d<s.length;d++)for(var p=0;p<u[s[d]].length;p++)w(u[s[d]][p])&&(u[s[d]][p]=1*u[s[d]][p]);return u}function k(O){var C=Object.keys(O);return C.reduce(function(y,u){return y||O[u].length>0},!1)}function x(O,C){for(var y={main:[C]},u={main:[]},l={main:{}};k(y);)for(var c=Object.keys(y),f=0;f<c.length;f++){var o=c[f],a=y[o],s=a.pop();if(l[o]=l[o]||{},!(l[o][s]||!O[o][s])){l[o][s]=!0,u[o]=u[o]||[],u[o].push(s);for(var d=I(O,O[o][s],o),p=Object.keys(d),_=0;_<p.length;_++)y[p[_]]=y[p[_]]||[],y[p[_]]=y[p[_]].concat(d[p[_]])}}return u}function L(O,C,y,u){var l=O[u].map(function(c){return'"'+c+'": '+C[u][c].toString().replace(/^"[^"]+"/,"function")}).join(",");return S[0]+"{"+l+"}"+S[1]+'"'+y+'"'+S[2]}function R(O,C){C=C||{};var y={main:m.m},u=C.all?{main:Object.keys(y.main)}:x(y,O),l="";Object.keys(u).filter(function(s){return s!=="main"}).forEach(function(s){for(var d=0;u[s][d];)d++;u[s].push(d),y[s][d]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+("var "+s+" = ("+L(u,y,d,modules)+`)();
`)}),l=l+("new (("+L(u,y,O,"main")+")())(self);");var c=new window.Blob([l],{type:"text/javascript"}),f=window.URL||window.webkitURL||window.mozURL||window.msURL,o=f.createObjectURL(c),a=new window.Worker(o);return a.objectURL=o,a}},"./src/errors.ts":(b,P,m)=>{m.r(P),m.d(P,{ErrorDetails:()=>S,ErrorTypes:()=>N});var N;(function(F){F.NETWORK_ERROR="networkError",F.MEDIA_ERROR="mediaError",F.KEY_SYSTEM_ERROR="keySystemError",F.MUX_ERROR="muxError",F.OTHER_ERROR="otherError"})(N||(N={}));var S;(function(F){F.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",F.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",F.KEY_SYSTEM_NO_SESSION="keySystemNoSession",F.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",F.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",F.MANIFEST_LOAD_ERROR="manifestLoadError",F.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",F.MANIFEST_PARSING_ERROR="manifestParsingError",F.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",F.LEVEL_EMPTY_ERROR="levelEmptyError",F.LEVEL_LOAD_ERROR="levelLoadError",F.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",F.LEVEL_SWITCH_ERROR="levelSwitchError",F.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",F.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",F.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",F.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",F.FRAG_LOAD_ERROR="fragLoadError",F.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",F.FRAG_DECRYPT_ERROR="fragDecryptError",F.FRAG_PARSING_ERROR="fragParsingError",F.REMUX_ALLOC_ERROR="remuxAllocError",F.KEY_LOAD_ERROR="keyLoadError",F.KEY_LOAD_TIMEOUT="keyLoadTimeOut",F.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",F.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",F.BUFFER_APPEND_ERROR="bufferAppendError",F.BUFFER_APPENDING_ERROR="bufferAppendingError",F.BUFFER_STALLED_ERROR="bufferStalledError",F.BUFFER_FULL_ERROR="bufferFullError",F.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",F.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",F.INTERNAL_EXCEPTION="internalException",F.INTERNAL_ABORTED="aborted",F.UNKNOWN="unknown"})(S||(S={}))},"./src/events.ts":(b,P,m)=>{m.r(P),m.d(P,{Events:()=>N});var N;(function(S){S.MEDIA_ATTACHING="hlsMediaAttaching",S.MEDIA_ATTACHED="hlsMediaAttached",S.MEDIA_DETACHING="hlsMediaDetaching",S.MEDIA_DETACHED="hlsMediaDetached",S.BUFFER_RESET="hlsBufferReset",S.BUFFER_CODECS="hlsBufferCodecs",S.BUFFER_CREATED="hlsBufferCreated",S.BUFFER_APPENDING="hlsBufferAppending",S.BUFFER_APPENDED="hlsBufferAppended",S.BUFFER_EOS="hlsBufferEos",S.BUFFER_FLUSHING="hlsBufferFlushing",S.BUFFER_FLUSHED="hlsBufferFlushed",S.MANIFEST_LOADING="hlsManifestLoading",S.MANIFEST_LOADED="hlsManifestLoaded",S.MANIFEST_PARSED="hlsManifestParsed",S.LEVEL_SWITCHING="hlsLevelSwitching",S.LEVEL_SWITCHED="hlsLevelSwitched",S.LEVEL_LOADING="hlsLevelLoading",S.LEVEL_LOADED="hlsLevelLoaded",S.LEVEL_UPDATED="hlsLevelUpdated",S.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",S.LEVELS_UPDATED="hlsLevelsUpdated",S.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",S.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",S.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",S.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",S.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",S.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",S.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",S.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",S.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",S.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",S.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",S.CUES_PARSED="hlsCuesParsed",S.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",S.INIT_PTS_FOUND="hlsInitPtsFound",S.FRAG_LOADING="hlsFragLoading",S.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",S.FRAG_LOADED="hlsFragLoaded",S.FRAG_DECRYPTED="hlsFragDecrypted",S.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",S.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",S.FRAG_PARSING_METADATA="hlsFragParsingMetadata",S.FRAG_PARSED="hlsFragParsed",S.FRAG_BUFFERED="hlsFragBuffered",S.FRAG_CHANGED="hlsFragChanged",S.FPS_DROP="hlsFpsDrop",S.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",S.ERROR="hlsError",S.DESTROYING="hlsDestroying",S.KEY_LOADING="hlsKeyLoading",S.KEY_LOADED="hlsKeyLoaded",S.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",S.BACK_BUFFER_REACHED="hlsBackBufferReached"})(N||(N={}))},"./src/hls.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>c});var N=m("./node_modules/url-toolkit/src/url-toolkit.js"),S=m("./src/loader/playlist-loader.ts"),F=m("./src/loader/key-loader.ts"),M=m("./src/controller/id3-track-controller.ts"),K=m("./src/controller/latency-controller.ts"),w=m("./src/controller/level-controller.ts"),I=m("./src/controller/fragment-tracker.ts"),k=m("./src/controller/stream-controller.ts"),x=m("./src/is-supported.ts"),L=m("./src/utils/logger.ts"),R=m("./src/config.ts"),O=m("./node_modules/eventemitter3/index.js"),C=m("./src/events.ts"),y=m("./src/errors.ts");function u(f,o){for(var a=0;a<o.length;a++){var s=o[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(f,s.key,s)}}function l(f,o,a){return o&&u(f.prototype,o),a&&u(f,a),Object.defineProperty(f,"prototype",{writable:!1}),f}var c=function(){f.isSupported=function(){return(0,x.isSupported)()};function f(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new O.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var s=this.config=(0,R.mergeConfig)(f.DefaultConfig,a);this.userConfig=a,(0,L.enableLogs)(s.debug,"Hls instance"),this._autoLevelCapping=-1,s.progressive&&(0,R.enableStreamingMode)(s);var d=s.abrController,p=s.bufferController,_=s.capLevelController,h=s.fpsController,A=this.abrController=new d(this),E=this.bufferController=new p(this),v=this.capLevelController=new _(this),T=new h(this),D=new S.default(this),B=new F.default(this),V=new M.default(this),W=this.levelController=new w.default(this),j=new I.FragmentTracker(this),$=this.streamController=new k.default(this,j);v.setStreamController($),T.setStreamController($);var Q=[D,B,W,$];this.networkControllers=Q;var Z=[A,E,v,T,V,j];this.audioTrackController=this.createController(s.audioTrackController,null,Q),this.createController(s.audioStreamController,j,Q),this.subtitleTrackController=this.createController(s.subtitleTrackController,null,Q),this.createController(s.subtitleStreamController,j,Q),this.createController(s.timelineController,null,Z),this.emeController=this.createController(s.emeController,null,Z),this.cmcdController=this.createController(s.cmcdController,null,Z),this.latencyController=this.createController(K.default,null,Z),this.coreComponents=Z}var o=f.prototype;return o.createController=function(s,d,p){if(s){var _=d?new s(this,d):new s(this);return p&&p.push(_),_}return null},o.on=function(s,d,p){p===void 0&&(p=this),this._emitter.on(s,d,p)},o.once=function(s,d,p){p===void 0&&(p=this),this._emitter.once(s,d,p)},o.removeAllListeners=function(s){this._emitter.removeAllListeners(s)},o.off=function(s,d,p,_){p===void 0&&(p=this),this._emitter.off(s,d,p,_)},o.listeners=function(s){return this._emitter.listeners(s)},o.emit=function(s,d,p){return this._emitter.emit(s,d,p)},o.trigger=function(s,d){if(this.config.debug)return this.emit(s,s,d);try{return this.emit(s,s,d)}catch(p){L.logger.error("An internal error happened while handling event "+s+'. Error message: "'+p.message+'". Here is a stacktrace:',p),this.trigger(C.Events.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:s,error:p})}return!1},o.listenerCount=function(s){return this._emitter.listenerCount(s)},o.destroy=function(){L.logger.log("destroy"),this.trigger(C.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(s){return s.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(s){return s.destroy()}),this.coreComponents.length=0},o.attachMedia=function(s){L.logger.log("attachMedia"),this._media=s,this.trigger(C.Events.MEDIA_ATTACHING,{media:s})},o.detachMedia=function(){L.logger.log("detachMedia"),this.trigger(C.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(s){this.stopLoad();var d=this.media,p=this.url,_=this.url=N.buildAbsoluteURL(self.location.href,s,{alwaysNormalize:!0});L.logger.log("loadSource:"+_),d&&p&&p!==_&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(d)),this.trigger(C.Events.MANIFEST_LOADING,{url:s})},o.startLoad=function(s){s===void 0&&(s=-1),L.logger.log("startLoad("+s+")"),this.networkControllers.forEach(function(d){d.startLoad(s)})},o.stopLoad=function(){L.logger.log("stopLoad"),this.networkControllers.forEach(function(s){s.stopLoad()})},o.swapAudioCodec=function(){L.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){L.logger.log("recoverMediaError");var s=this._media;this.detachMedia(),s&&this.attachMedia(s)},o.removeLevel=function(s,d){d===void 0&&(d=0),this.levelController.removeLevel(s,d)},l(f,[{key:"levels",get:function(){var s=this.levelController.levels;return s||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(s){L.logger.log("set currentLevel:"+s),this.loadLevel=s,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(s){L.logger.log("set nextLevel:"+s),this.levelController.manualLevel=s,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(s){L.logger.log("set loadLevel:"+s),this.levelController.manualLevel=s}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(s){this.levelController.nextLoadLevel=s}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(s){L.logger.log("set firstLevel:"+s),this.levelController.firstLevel=s}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(s){L.logger.log("set startLevel:"+s),s!==-1&&(s=Math.max(s,this.minAutoLevel)),this.levelController.startLevel=s}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(s){var d=!!s;d!==this.config.capLevelToPlayerSize&&(d?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=d)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(s){this._autoLevelCapping!==s&&(L.logger.log("set autoLevelCapping:"+s),this._autoLevelCapping=s)}},{key:"bandwidthEstimate",get:function(){var s=this.abrController.bwEstimator;return s?s.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var s=this.levels,d=this.config.minAutoBitrate;if(!s)return 0;for(var p=s.length,_=0;_<p;_++)if(s[_].maxBitrate>=d)return _;return 0}},{key:"maxAutoLevel",get:function(){var s=this.levels,d=this.autoLevelCapping,p;return d===-1&&s&&s.length?p=s.length-1:p=d,p}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(s){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,s)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var s=this.audioTrackController;return s?s.audioTracks:[]}},{key:"audioTrack",get:function(){var s=this.audioTrackController;return s?s.audioTrack:-1},set:function(s){var d=this.audioTrackController;d&&(d.audioTrack=s)}},{key:"subtitleTracks",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTrack:-1},set:function(s){var d=this.subtitleTrackController;d&&(d.subtitleTrack=s)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var s=this.subtitleTrackController;return s?s.subtitleDisplay:!1},set:function(s){var d=this.subtitleTrackController;d&&(d.subtitleDisplay=s)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(s){this.config.lowLatencyMode=s}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.9"}},{key:"Events",get:function(){return C.Events}},{key:"ErrorTypes",get:function(){return y.ErrorTypes}},{key:"ErrorDetails",get:function(){return y.ErrorDetails}},{key:"DefaultConfig",get:function(){return f.defaultConfig?f.defaultConfig:R.hlsDefaultConfig},set:function(s){f.defaultConfig=s}}]),f}();c.defaultConfig=void 0},"./src/is-supported.ts":(b,P,m)=>{m.r(P),m.d(P,{changeTypeSupported:()=>M,isSupported:()=>F});var N=m("./src/utils/mediasource-helper.ts");function S(){return self.SourceBuffer||self.WebKitSourceBuffer}function F(){var K=(0,N.getMediaSource)();if(!K)return!1;var w=S(),I=K&&typeof K.isTypeSupported=="function"&&K.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),k=!w||w.prototype&&typeof w.prototype.appendBuffer=="function"&&typeof w.prototype.remove=="function";return!!I&&!!k}function M(){var K,w=S();return typeof(w==null||(K=w.prototype)===null||K===void 0?void 0:K.changeType)=="function"}},"./src/loader/date-range.ts":(b,P,m)=>{m.r(P),m.d(P,{DateRange:()=>k,DateRangeAttribute:()=>I});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/attr-list.ts"),F=m("./src/utils/logger.ts");function M(){return M=Object.assign?Object.assign.bind():function(x){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var O in R)Object.prototype.hasOwnProperty.call(R,O)&&(x[O]=R[O])}return x},M.apply(this,arguments)}function K(x,L){for(var R=0;R<L.length;R++){var O=L[R];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(x,O.key,O)}}function w(x,L,R){return L&&K(x.prototype,L),R&&K(x,R),Object.defineProperty(x,"prototype",{writable:!1}),x}var I;(function(x){x.ID="ID",x.CLASS="CLASS",x.START_DATE="START-DATE",x.DURATION="DURATION",x.END_DATE="END-DATE",x.END_ON_NEXT="END-ON-NEXT",x.PLANNED_DURATION="PLANNED-DURATION",x.SCTE35_OUT="SCTE35-OUT",x.SCTE35_IN="SCTE35-IN"})(I||(I={}));var k=function(){function x(L,R){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,R){var O=R.attr;for(var C in O)if(Object.prototype.hasOwnProperty.call(L,C)&&L[C]!==O[C]){F.logger.warn('DATERANGE tag attribute: "'+C+'" does not match for tags with ID: "'+L.ID+'"'),this._badValueForSameId=C;break}L=M(new S.AttrList({}),O,L)}if(this.attr=L,this._startDate=new Date(L[I.START_DATE]),I.END_DATE in this.attr){var y=new Date(this.attr[I.END_DATE]);(0,N.isFiniteNumber)(y.getTime())&&(this._endDate=y)}}return w(x,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var R=this.duration;return R!==null?new Date(this._startDate.getTime()+R*1e3):null}},{key:"duration",get:function(){if(I.DURATION in this.attr){var R=this.attr.decimalFloatingPoint(I.DURATION);if((0,N.isFiniteNumber)(R))return R}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return I.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(I.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(I.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,N.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),x}()},"./src/loader/fragment-loader.ts":(b,P,m)=>{m.r(P),m.d(P,{LoadError:()=>C,default:()=>R});var N=m("./src/polyfills/number.ts"),S=m("./src/errors.ts");function F(y,u){y.prototype=Object.create(u.prototype),y.prototype.constructor=y,k(y,u)}function M(y){var u=typeof Map=="function"?new Map:void 0;return M=function(c){if(c===null||!I(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,f)}function f(){return K(c,arguments,x(this).constructor)}return f.prototype=Object.create(c.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),k(f,c)},M(y)}function K(y,u,l){return w()?K=Reflect.construct.bind():K=function(f,o,a){var s=[null];s.push.apply(s,o);var d=Function.bind.apply(f,s),p=new d;return a&&k(p,a.prototype),p},K.apply(null,arguments)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I(y){return Function.toString.call(y).indexOf("[native code]")!==-1}function k(y,u){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,f){return c.__proto__=f,c},k(y,u)}function x(y){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},x(y)}var L=Math.pow(2,17),R=function(){function y(l){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=l}var u=y.prototype;return u.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},u.abort=function(){this.loader&&this.loader.abort()},u.load=function(c,f){var o=this,a=c.url;if(!a)return Promise.reject(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var s=this.config,d=s.fLoader,p=s.loader;return new Promise(function(_,h){o.loader&&o.loader.destroy();var A=o.loader=c.loader=d?new d(s):new p(s),E=O(c),v={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:c.sn==="initSegment"?1/0:L};c.stats=A.stats,A.load(E,v,{onSuccess:function(D,B,V,W){o.resetLoader(c,A),_({frag:c,part:null,payload:D.data,networkDetails:W})},onError:function(D,B,V){o.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,response:D,networkDetails:V}))},onAbort:function(D,B,V){o.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,networkDetails:V}))},onTimeout:function(D,B,V){o.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,networkDetails:V}))},onProgress:function(D,B,V,W){f&&f({frag:c,part:null,payload:V,networkDetails:W})}})})},u.loadPart=function(c,f,o){var a=this;this.abort();var s=this.config,d=s.fLoader,p=s.loader;return new Promise(function(_,h){a.loader&&a.loader.destroy();var A=a.loader=c.loader=d?new d(s):new p(s),E=O(c,f),v={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:L};f.stats=A.stats,A.load(E,v,{onSuccess:function(D,B,V,W){a.resetLoader(c,A),a.updateStatsFromPart(c,f);var j={frag:c,part:f,payload:D.data,networkDetails:W};o(j),_(j)},onError:function(D,B,V){a.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,part:f,response:D,networkDetails:V}))},onAbort:function(D,B,V){c.stats.aborted=f.stats.aborted,a.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,part:f,networkDetails:V}))},onTimeout:function(D,B,V){a.resetLoader(c,A),h(new C({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,part:f,networkDetails:V}))}})})},u.updateStatsFromPart=function(c,f){var o=c.stats,a=f.stats,s=a.total;if(o.loaded+=a.loaded,s){var d=Math.round(c.duration/f.duration),p=Math.min(Math.round(o.loaded/s),d),_=d-p,h=_*Math.round(o.loaded/p);o.total=o.loaded+h}else o.total=Math.max(o.loaded,o.total);var A=o.loading,E=a.loading;A.start?A.first+=E.first-E.start:(A.start=E.start,A.first=E.first),A.end=E.end},u.resetLoader=function(c,f){c.loader=null,this.loader===f&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),f.destroy()},y}();function O(y,u){u===void 0&&(u=null);var l=u||y,c={frag:y,part:u,responseType:"arraybuffer",url:l.url,headers:{},rangeStart:0,rangeEnd:0},f=l.byteRangeStartOffset,o=l.byteRangeEndOffset;return(0,N.isFiniteNumber)(f)&&(0,N.isFiniteNumber)(o)&&(c.rangeStart=f,c.rangeEnd=o),c}var C=function(y){F(u,y);function u(l){for(var c,f=arguments.length,o=new Array(f>1?f-1:0),a=1;a<f;a++)o[a-1]=arguments[a];return c=y.call.apply(y,[this].concat(o))||this,c.data=void 0,c.data=l,c}return u}(M(Error))},"./src/loader/fragment.ts":(b,P,m)=>{m.r(P),m.d(P,{BaseSegment:()=>R,ElementaryStreamTypes:()=>L,Fragment:()=>O,Part:()=>C});var N=m("./src/polyfills/number.ts"),S=m("./node_modules/url-toolkit/src/url-toolkit.js"),F=m("./src/utils/logger.ts"),M=m("./src/loader/level-key.ts"),K=m("./src/loader/load-stats.ts");function w(y,u){y.prototype=Object.create(u.prototype),y.prototype.constructor=y,I(y,u)}function I(y,u){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,f){return c.__proto__=f,c},I(y,u)}function k(y,u){for(var l=0;l<u.length;l++){var c=u[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(y,c.key,c)}}function x(y,u,l){return u&&k(y.prototype,u),l&&k(y,l),Object.defineProperty(y,"prototype",{writable:!1}),y}var L;(function(y){y.AUDIO="audio",y.VIDEO="video",y.AUDIOVIDEO="audiovideo"})(L||(L={}));var R=function(){function y(l){var c;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(c={},c[L.AUDIO]=null,c[L.VIDEO]=null,c[L.AUDIOVIDEO]=null,c),this.baseurl=l}var u=y.prototype;return u.setByteRange=function(c,f){var o=c.split("@",2),a=[];o.length===1?a[0]=f?f.byteRangeEndOffset:0:a[0]=parseInt(o[1]),a[1]=parseInt(o[0])+a[0],this._byteRange=a},x(y,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,S.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(c){this._url=c}}]),y}(),O=function(y){w(u,y);function u(c,f){var o;return o=y.call(this,f)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new K.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=c,o}var l=u.prototype;return l.createInitializationVector=function(f){for(var o=new Uint8Array(16),a=12;a<16;a++)o[a]=f>>8*(15-a)&255;return o},l.setDecryptDataFromLevelKey=function(f,o){var a=f;return(f==null?void 0:f.method)==="AES-128"&&f.uri&&!f.iv&&(a=M.LevelKey.fromURI(f.uri),a.method=f.method,a.iv=this.createInitializationVector(o),a.keyFormat="identity"),a},l.setElementaryStreamInfo=function(f,o,a,s,d,p){p===void 0&&(p=!1);var _=this.elementaryStreams,h=_[f];if(!h){_[f]={startPTS:o,endPTS:a,startDTS:s,endDTS:d,partial:p};return}h.startPTS=Math.min(h.startPTS,o),h.endPTS=Math.max(h.endPTS,a),h.startDTS=Math.min(h.startDTS,s),h.endDTS=Math.max(h.endDTS,d)},l.clearElementaryStreamInfo=function(){var f=this.elementaryStreams;f[L.AUDIO]=null,f[L.VIDEO]=null,f[L.AUDIOVIDEO]=null},x(u,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var f=this.sn;typeof f!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&F.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),f=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,f)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,N.isFiniteNumber)(this.programDateTime))return null;var f=(0,N.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+f*1e3}},{key:"encrypted",get:function(){var f;return!!((f=this.decryptdata)!==null&&f!==void 0&&f.keyFormat&&this.decryptdata.uri)}}]),u}(R),C=function(y){w(u,y);function u(l,c,f,o,a){var s;s=y.call(this,f)||this,s.fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new K.LoadStats,s.duration=l.decimalFloatingPoint("DURATION"),s.gap=l.bool("GAP"),s.independent=l.bool("INDEPENDENT"),s.relurl=l.enumeratedString("URI"),s.fragment=c,s.index=o;var d=l.enumeratedString("BYTERANGE");return d&&s.setByteRange(d,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return x(u,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var c=this.elementaryStreams;return!!(c.audio||c.video||c.audiovideo)}}]),u}(R)},"./src/loader/key-loader.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>M});var N=m("./src/events.ts"),S=m("./src/errors.ts"),F=m("./src/utils/logger.ts"),M=function(){function K(I){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=I,this.registerListeners()}var w=K.prototype;return w.startLoad=function(k){},w.stopLoad=function(){this.destroyInternalLoaders()},w.registerListeners=function(){this.hls.on(N.Events.KEY_LOADING,this.onKeyLoading,this)},w.unregisterListeners=function(){this.hls.off(N.Events.KEY_LOADING,this.onKeyLoading)},w.destroyInternalLoaders=function(){for(var k in this.loaders){var x=this.loaders[k];x&&x.destroy()}this.loaders={}},w.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},w.onKeyLoading=function(k,x){var L=x.frag,R=L.type,O=this.loaders[R];if(!L.decryptdata){F.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var C=L.decryptdata.uri;if(C!==this.decrypturl||this.decryptkey===null){var y=this.hls.config;if(O&&(F.logger.warn("abort previous key loader for type:"+R),O.abort()),!C){F.logger.warn("key uri is falsy");return}var u=y.loader,l=L.loader=this.loaders[R]=new u(y);this.decrypturl=C,this.decryptkey=null;var c={url:C,frag:L,responseType:"arraybuffer"},f={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:y.fragLoadingRetryDelay,maxRetryDelay:y.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};l.load(c,f,o)}else this.decryptkey&&(L.decryptdata.key=this.decryptkey,this.hls.trigger(N.Events.KEY_LOADED,{frag:L}))},w.loadsuccess=function(k,x,L){var R=L.frag;if(!R.decryptdata){F.logger.error("after key load, decryptdata unset");return}this.decryptkey=R.decryptdata.key=new Uint8Array(k.data),R.loader=null,delete this.loaders[R.type],this.hls.trigger(N.Events.KEY_LOADED,{frag:R})},w.loaderror=function(k,x){var L=x.frag,R=L.loader;R&&R.abort(),delete this.loaders[L.type],this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:L,response:k})},w.loadtimeout=function(k,x){var L=x.frag,R=L.loader;R&&R.abort(),delete this.loaders[L.type],this.hls.trigger(N.Events.ERROR,{type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:L})},K}()},"./src/loader/level-details.ts":(b,P,m)=>{m.r(P),m.d(P,{LevelDetails:()=>K});var N=m("./src/polyfills/number.ts");function S(w,I){for(var k=0;k<I.length;k++){var x=I[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(w,x.key,x)}}function F(w,I,k){return I&&S(w.prototype,I),k&&S(w,k),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=10,K=function(){function w(k){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=k}var I=w.prototype;return I.reloaded=function(x){if(!x){this.advanced=!0,this.updated=!0;return}var L=this.lastPartSn-x.lastPartSn,R=this.lastPartIndex-x.lastPartIndex;this.updated=this.endSN!==x.endSN||!!R||!!L,this.advanced=this.endSN>x.endSN||L>0||L===0&&R>0,this.updated||this.advanced?this.misses=Math.floor(x.misses*.6):this.misses=x.misses+1,this.availabilityDelay=x.availabilityDelay},F(w,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?(0,N.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var x=this.driftEndTime-this.driftStartTime;if(x>0){var L=this.driftEnd-this.driftStart;return L*1e3/x}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var x;return(x=this.fragments)!==null&&x!==void 0&&x.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var x;return(x=this.partList)!==null&&x!==void 0&&x.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),w}()},"./src/loader/level-key.ts":(b,P,m)=>{m.r(P),m.d(P,{LevelKey:()=>M});var N=m("./node_modules/url-toolkit/src/url-toolkit.js");function S(K,w){for(var I=0;I<w.length;I++){var k=w[I];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(K,k.key,k)}}function F(K,w,I){return w&&S(K.prototype,w),I&&S(K,I),Object.defineProperty(K,"prototype",{writable:!1}),K}var M=function(){K.fromURL=function(I,k){return new K(I,k)},K.fromURI=function(I){return new K(I)};function K(w,I){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,I?this._uri=(0,N.buildAbsoluteURL)(w,I,{alwaysNormalize:!0}):this._uri=w}return F(K,[{key:"uri",get:function(){return this._uri}}]),K}()},"./src/loader/load-stats.ts":(b,P,m)=>{m.r(P),m.d(P,{LoadStats:()=>N});var N=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>l});var N=m("./src/polyfills/number.ts"),S=m("./node_modules/url-toolkit/src/url-toolkit.js"),F=m("./src/loader/date-range.ts"),M=m("./src/loader/fragment.ts"),K=m("./src/loader/level-details.ts"),w=m("./src/loader/level-key.ts"),I=m("./src/utils/attr-list.ts"),k=m("./src/utils/logger.ts"),x=m("./src/utils/codecs.ts"),L=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,R=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),C=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),y=/\.(mp4|m4s|m4v|m4a)$/i;function u(d){var p,_;return y.test((p=(_=S.parseURL(d))===null||_===void 0?void 0:_.path)!=null?p:"")}var l=function(){function d(){}return d.findGroup=function(_,h){for(var A=0;A<_.length;A++){var E=_[A];if(E.id===h)return E}},d.convertAVC1ToAVCOTI=function(_){var h=_.split(".");if(h.length>2){var A=h.shift()+".";return A+=parseInt(h.shift()).toString(16),A+=("000"+parseInt(h.shift()).toString(16)).slice(-4),A}return _},d.resolve=function(_,h){return S.buildAbsoluteURL(h,_,{alwaysNormalize:!0})},d.parseMasterPlaylist=function(_,h){var A=[],E=[],v={},T=!1;L.lastIndex=0;for(var D;(D=L.exec(_))!=null;)if(D[1]){var B,V=new I.AttrList(D[1]),W={attrs:V,bitrate:V.decimalInteger("AVERAGE-BANDWIDTH")||V.decimalInteger("BANDWIDTH"),name:V.NAME,url:d.resolve(D[2],h)},j=V.decimalResolution("RESOLUTION");j&&(W.width=j.width,W.height=j.height),c((V.CODECS||"").split(/[ ,]+/).filter(function(Z){return Z}),W),W.videoCodec&&W.videoCodec.indexOf("avc1")!==-1&&(W.videoCodec=d.convertAVC1ToAVCOTI(W.videoCodec)),(B=W.unknownCodecs)!==null&&B!==void 0&&B.length||E.push(W),A.push(W)}else if(D[3]){var $=new I.AttrList(D[3]);$["DATA-ID"]&&(T=!0,v[$["DATA-ID"]]=$)}var Q=E.length>0&&E.length<A.length;return{levels:Q?E:A,sessionData:T?v:null}},d.parseMasterPlaylistMedia=function(_,h,A,E){E===void 0&&(E=[]);var v,T=[],D=0;for(R.lastIndex=0;(v=R.exec(_))!==null;){var B=new I.AttrList(v[1]);if(B.TYPE===A){var V={attrs:B,bitrate:0,id:D++,groupId:B["GROUP-ID"],instreamId:B["INSTREAM-ID"],name:B.NAME||B.LANGUAGE||"",type:A,default:B.bool("DEFAULT"),autoselect:B.bool("AUTOSELECT"),forced:B.bool("FORCED"),lang:B.LANGUAGE,url:B.URI?d.resolve(B.URI,h):""};if(E.length){var W=d.findGroup(E,V.groupId)||E[0];f(V,W,"audioCodec"),f(V,W,"textCodec")}T.push(V)}}return T},d.parseLevelPlaylist=function(_,h,A,E,v){var T=new K.LevelDetails(h),D=T.fragments,B=null,V=0,W=0,j=0,$=0,Q=null,Z=new M.Fragment(E,h),ee,ae,se,Y=-1,X=!1;for(O.lastIndex=0,T.m3u8=_;(ee=O.exec(_))!==null;){X&&(X=!1,Z=new M.Fragment(E,h),Z.start=j,Z.sn=V,Z.cc=$,Z.level=A,B&&(Z.initSegment=B,Z.rawProgramDateTime=B.rawProgramDateTime,B.rawProgramDateTime=null));var q=ee[1];if(q){Z.duration=parseFloat(q);var re=(" "+ee[2]).slice(1);Z.title=re||null,Z.tagList.push(re?["INF",q,re]:["INF",q])}else if(ee[3])(0,N.isFiniteNumber)(Z.duration)&&(Z.start=j,se&&(Z.levelkey=se),Z.sn=V,Z.level=A,Z.cc=$,Z.urlId=v,D.push(Z),Z.relurl=(" "+ee[3]).slice(1),a(Z,Q),Q=Z,j+=Z.duration,V++,W=0,X=!0);else if(ee[4]){var ne=(" "+ee[4]).slice(1);Q?Z.setByteRange(ne,Q):Z.setByteRange(ne)}else if(ee[5])Z.rawProgramDateTime=(" "+ee[5]).slice(1),Z.tagList.push(["PROGRAM-DATE-TIME",Z.rawProgramDateTime]),Y===-1&&(Y=D.length);else{if(ee=ee[0].match(C),!ee){k.logger.warn("No matches on slow regex match for level playlist!");continue}for(ae=1;ae<ee.length&&!(typeof ee[ae]<"u");ae++);var U=(" "+ee[ae]).slice(1),H=(" "+ee[ae+1]).slice(1),z=ee[ae+2]?(" "+ee[ae+2]).slice(1):"";switch(U){case"PLAYLIST-TYPE":T.type=H.toUpperCase();break;case"MEDIA-SEQUENCE":V=T.startSN=parseInt(H);break;case"SKIP":{var J=new I.AttrList(H),te=J.decimalInteger("SKIPPED-SEGMENTS");if((0,N.isFiniteNumber)(te)){T.skippedSegments=te;for(var ie=te;ie--;)D.unshift(null);V+=te}var le=J.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(T.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":T.targetduration=parseFloat(H);break;case"VERSION":T.version=parseInt(H);break;case"EXTM3U":break;case"ENDLIST":T.live=!1;break;case"#":(H||z)&&Z.tagList.push(z?[H,z]:[H]);break;case"DISCONTINUITY":$++,Z.tagList.push(["DIS"]);break;case"GAP":Z.tagList.push([U]);break;case"BITRATE":Z.tagList.push([U,H]);break;case"DATERANGE":{var oe=new I.AttrList(H),ue=new F.DateRange(oe,T.dateRanges[oe.ID]);ue.isValid||T.skippedSegments?T.dateRanges[ue.id]=ue:k.logger.warn('Ignoring invalid DATERANGE tag: "'+H+'"'),Z.tagList.push(["EXT-X-DATERANGE",H]);break}case"DISCONTINUITY-SEQUENCE":$=parseInt(H);break;case"KEY":{var fe,ge=new I.AttrList(H),he=ge.enumeratedString("METHOD"),Ee=ge.URI,Le=ge.hexadecimalInteger("IV"),Pe=ge.enumeratedString("KEYFORMATVERSIONS"),Fe=ge.enumeratedString("KEYID"),Ne=(fe=ge.enumeratedString("KEYFORMAT"))!=null?fe:"identity",We=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(We.indexOf(Ne)>-1){k.logger.warn("Keyformat "+Ne+" is not supported from the manifest");continue}else if(Ne!=="identity")continue;he&&(se=w.LevelKey.fromURL(h,Ee),Ee&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(he)>=0&&(se.method=he,se.keyFormat=Ne,Fe&&(se.keyID=Fe),Pe&&(se.keyFormatVersions=Pe),se.iv=Le));break}case"START":{var Oe=new I.AttrList(H),Te=Oe.decimalFloatingPoint("TIME-OFFSET");(0,N.isFiniteNumber)(Te)&&(T.startTimeOffset=Te);break}case"MAP":{var Re=new I.AttrList(H);if(Z.duration){var tt=new M.Fragment(E,h);s(tt,Re,A,se),B=tt,Z.initSegment=B,B.rawProgramDateTime&&!Z.rawProgramDateTime&&(Z.rawProgramDateTime=B.rawProgramDateTime)}else s(Z,Re,A,se),B=Z,X=!0;break}case"SERVER-CONTROL":{var Ie=new I.AttrList(H);T.canBlockReload=Ie.bool("CAN-BLOCK-RELOAD"),T.canSkipUntil=Ie.optionalFloat("CAN-SKIP-UNTIL",0),T.canSkipDateRanges=T.canSkipUntil>0&&Ie.bool("CAN-SKIP-DATERANGES"),T.partHoldBack=Ie.optionalFloat("PART-HOLD-BACK",0),T.holdBack=Ie.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Be=new I.AttrList(H);T.partTarget=Be.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Xe=T.partList;Xe||(Xe=T.partList=[]);var Kt=W>0?Xe[Xe.length-1]:void 0,Wt=W++,ar=new M.Part(new I.AttrList(H),Z,h,Wt,Kt);Xe.push(ar),Z.duration+=ar.duration;break}case"PRELOAD-HINT":{var ft=new I.AttrList(H);T.preloadHint=ft;break}case"RENDITION-REPORT":{var An=new I.AttrList(H);T.renditionReports=T.renditionReports||[],T.renditionReports.push(An);break}default:k.logger.warn("line parsed but not handled: "+ee);break}}}Q&&!Q.relurl?(D.pop(),j-=Q.duration,T.partList&&(T.fragmentHint=Q)):T.partList&&(a(Z,Q),Z.cc=$,T.fragmentHint=Z);var Vt=D.length,Et=D[0],sr=D[Vt-1];if(j+=T.skippedSegments*T.targetduration,j>0&&Vt&&sr){T.averagetargetduration=j/Vt;var Gt=sr.sn;T.endSN=Gt!=="initSegment"?Gt:0,Et&&(T.startCC=Et.cc,Et.initSegment||T.fragments.every(function(Kr){return Kr.relurl&&u(Kr.relurl)})&&(k.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),Z=new M.Fragment(E,h),Z.relurl=sr.relurl,Z.level=A,Z.sn="initSegment",Et.initSegment=Z,T.needSidxRanges=!0))}else T.endSN=0,T.startCC=0;return T.fragmentHint&&(j+=T.fragmentHint.duration),T.totalduration=j,T.endCC=$,Y>0&&o(D,Y),T},d}();function c(d,p){["video","audio","text"].forEach(function(_){var h=d.filter(function(E){return(0,x.isCodecType)(E,_)});if(h.length){var A=h.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});p[_+"Codec"]=A.length>0?A[0]:h[0],d=d.filter(function(E){return h.indexOf(E)===-1})}}),p.unknownCodecs=d}function f(d,p,_){var h=p[_];h&&(d[_]=h)}function o(d,p){for(var _=d[p],h=p;h--;){var A=d[h];if(!A)return;A.programDateTime=_.programDateTime-A.duration*1e3,_=A}}function a(d,p){d.rawProgramDateTime?d.programDateTime=Date.parse(d.rawProgramDateTime):p!=null&&p.programDateTime&&(d.programDateTime=p.endProgramDateTime),(0,N.isFiniteNumber)(d.programDateTime)||(d.programDateTime=null,d.rawProgramDateTime=null)}function s(d,p,_,h){d.relurl=p.URI,p.BYTERANGE&&d.setByteRange(p.BYTERANGE),d.level=_,d.sn="initSegment",h&&(d.levelkey=h),d.initSegment=null}},"./src/loader/playlist-loader.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>O});var N=m("./src/polyfills/number.ts"),S=m("./src/events.ts"),F=m("./src/errors.ts"),M=m("./src/utils/logger.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/loader/m3u8-parser.ts"),I=m("./src/types/loader.ts"),k=m("./src/utils/attr-list.ts");function x(C){var y=C.type;switch(y){case I.PlaylistContextType.AUDIO_TRACK:return I.PlaylistLevelType.AUDIO;case I.PlaylistContextType.SUBTITLE_TRACK:return I.PlaylistLevelType.SUBTITLE;default:return I.PlaylistLevelType.MAIN}}function L(C,y){var u=C.url;return(u===void 0||u.indexOf("data:")===0)&&(u=y.url),u}var R=function(){function C(u){this.hls=void 0,this.loaders=Object.create(null),this.hls=u,this.registerListeners()}var y=C.prototype;return y.startLoad=function(l){},y.stopLoad=function(){this.destroyInternalLoaders()},y.registerListeners=function(){var l=this.hls;l.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.on(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},y.unregisterListeners=function(){var l=this.hls;l.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.off(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},y.createInternalLoader=function(l){var c=this.hls.config,f=c.pLoader,o=c.loader,a=f||o,s=new a(c);return l.loader=s,this.loaders[l.type]=s,s},y.getInternalLoader=function(l){return this.loaders[l.type]},y.resetInternalLoader=function(l){this.loaders[l]&&delete this.loaders[l]},y.destroyInternalLoaders=function(){for(var l in this.loaders){var c=this.loaders[l];c&&c.destroy(),this.resetInternalLoader(l)}},y.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},y.onManifestLoading=function(l,c){var f=c.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:I.PlaylistContextType.MANIFEST,url:f,deliveryDirectives:null})},y.onLevelLoading=function(l,c){var f=c.id,o=c.level,a=c.url,s=c.deliveryDirectives;this.load({id:f,groupId:null,level:o,responseType:"text",type:I.PlaylistContextType.LEVEL,url:a,deliveryDirectives:s})},y.onAudioTrackLoading=function(l,c){var f=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:f,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.AUDIO_TRACK,url:a,deliveryDirectives:s})},y.onSubtitleTrackLoading=function(l,c){var f=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:f,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.SUBTITLE_TRACK,url:a,deliveryDirectives:s})},y.load=function(l){var c,f=this.hls.config,o=this.getInternalLoader(l);if(o){var a=o.context;if(a&&a.url===l.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+l.type),o.abort()}var s,d,p,_;switch(l.type){case I.PlaylistContextType.MANIFEST:s=f.manifestLoadingMaxRetry,d=f.manifestLoadingTimeOut,p=f.manifestLoadingRetryDelay,_=f.manifestLoadingMaxRetryTimeout;break;case I.PlaylistContextType.LEVEL:case I.PlaylistContextType.AUDIO_TRACK:case I.PlaylistContextType.SUBTITLE_TRACK:s=0,d=f.levelLoadingTimeOut;break;default:s=f.levelLoadingMaxRetry,d=f.levelLoadingTimeOut,p=f.levelLoadingRetryDelay,_=f.levelLoadingMaxRetryTimeout;break}if(o=this.createInternalLoader(l),(c=l.deliveryDirectives)!==null&&c!==void 0&&c.part){var h;if(l.type===I.PlaylistContextType.LEVEL&&l.level!==null?h=this.hls.levels[l.level].details:l.type===I.PlaylistContextType.AUDIO_TRACK&&l.id!==null?h=this.hls.audioTracks[l.id].details:l.type===I.PlaylistContextType.SUBTITLE_TRACK&&l.id!==null&&(h=this.hls.subtitleTracks[l.id].details),h){var A=h.partTarget,E=h.targetduration;A&&E&&(d=Math.min(Math.max(A*3,E*.8)*1e3,d))}}var v={timeout:d,maxRetry:s,retryDelay:p,maxRetryDelay:_,highWaterMark:0},T={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o.load(l,v,T)},y.loadsuccess=function(l,c,f,o){if(o===void 0&&(o=null),f.isSidxRequest){this.handleSidxRequest(l,f),this.handlePlaylistLoaded(l,c,f,o);return}this.resetInternalLoader(f.type);var a=l.data;if(a.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(l,f,"no EXTM3U delimiter",o);return}c.parsing.start=performance.now(),a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(l,c,f,o):this.handleMasterPlaylist(l,c,f,o)},y.loaderror=function(l,c,f){f===void 0&&(f=null),this.handleNetworkError(c,f,!1,l)},y.loadtimeout=function(l,c,f){f===void 0&&(f=null),this.handleNetworkError(c,f,!0)},y.handleMasterPlaylist=function(l,c,f,o){var a=this.hls,s=l.data,d=L(l,f),p=w.default.parseMasterPlaylist(s,d),_=p.levels,h=p.sessionData;if(!_.length){this.handleManifestParsingError(l,f,"no level found in manifest",o);return}var A=_.map(function(V){return{id:V.attrs.AUDIO,audioCodec:V.audioCodec}}),E=_.map(function(V){return{id:V.attrs.SUBTITLES,textCodec:V.textCodec}}),v=w.default.parseMasterPlaylistMedia(s,d,"AUDIO",A),T=w.default.parseMasterPlaylistMedia(s,d,"SUBTITLES",E),D=w.default.parseMasterPlaylistMedia(s,d,"CLOSED-CAPTIONS");if(v.length){var B=v.some(function(V){return!V.url});!B&&_[0].audioCodec&&!_[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new k.AttrList({}),bitrate:0,url:""}))}a.trigger(S.Events.MANIFEST_LOADED,{levels:_,audioTracks:v,subtitles:T,captions:D,url:d,stats:c,networkDetails:o,sessionData:h})},y.handleTrackOrLevelPlaylist=function(l,c,f,o){var a=this.hls,s=f.id,d=f.level,p=f.type,_=L(l,f),h=(0,N.isFiniteNumber)(s)?s:0,A=(0,N.isFiniteNumber)(d)?d:h,E=x(f),v=w.default.parseLevelPlaylist(l.data,_,A,E,h);if(!v.fragments.length){a.trigger(S.Events.ERROR,{type:F.ErrorTypes.NETWORK_ERROR,details:F.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:_,reason:"no fragments found in level",level:typeof f.level=="number"?f.level:void 0});return}if(p===I.PlaylistContextType.MANIFEST){var T={attrs:new k.AttrList({}),bitrate:0,details:v,name:"",url:_};a.trigger(S.Events.MANIFEST_LOADED,{levels:[T],audioTracks:[],url:_,stats:c,networkDetails:o,sessionData:null})}if(c.parsing.end=performance.now(),v.needSidxRanges){var D,B=(D=v.fragments[0].initSegment)===null||D===void 0?void 0:D.url;this.load({url:B,isSidxRequest:!0,type:p,level:d,levelDetails:v,id:s,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}f.levelDetails=v,this.handlePlaylistLoaded(l,c,f,o)},y.handleSidxRequest=function(l,c){var f=new Uint8Array(l.data),o=(0,K.findBox)(f,["sidx"])[0];if(o){var a=(0,K.parseSegmentIndex)(o);if(a){var s=a.references,d=c.levelDetails;s.forEach(function(p,_){var h=p.info,A=d.fragments[_];if(A.byteRange.length===0&&A.setByteRange(String(1+h.end-h.start)+"@"+String(h.start)),A.initSegment){var E=(0,K.findBox)(f,["moov"])[0],v=E?E.length:null;A.initSegment.setByteRange(String(v)+"@0")}})}}},y.handleManifestParsingError=function(l,c,f,o){this.hls.trigger(S.Events.ERROR,{type:F.ErrorTypes.NETWORK_ERROR,details:F.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:c.type===I.PlaylistContextType.MANIFEST,url:l.url,reason:f,response:l,context:c,networkDetails:o})},y.handleNetworkError=function(l,c,f,o){f===void 0&&(f=!1),M.logger.warn("[playlist-loader]: A network "+(f?"timeout":"error")+" occurred while loading "+l.type+" level: "+l.level+" id: "+l.id+' group-id: "'+l.groupId+'"');var a=F.ErrorDetails.UNKNOWN,s=!1,d=this.getInternalLoader(l);switch(l.type){case I.PlaylistContextType.MANIFEST:a=f?F.ErrorDetails.MANIFEST_LOAD_TIMEOUT:F.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case I.PlaylistContextType.LEVEL:a=f?F.ErrorDetails.LEVEL_LOAD_TIMEOUT:F.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.AUDIO_TRACK:a=f?F.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:F.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.SUBTITLE_TRACK:a=f?F.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:F.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}d&&this.resetInternalLoader(l.type);var p={type:F.ErrorTypes.NETWORK_ERROR,details:a,fatal:s,url:l.url,loader:d,context:l,networkDetails:c};o&&(p.response=o),this.hls.trigger(S.Events.ERROR,p)},y.handlePlaylistLoaded=function(l,c,f,o){var a=f.type,s=f.level,d=f.id,p=f.groupId,_=f.loader,h=f.levelDetails,A=f.deliveryDirectives;if(!(h!=null&&h.targetduration)){this.handleManifestParsingError(l,f,"invalid target duration",o);return}if(_)switch(h.live&&(_.getCacheAge&&(h.ageHeader=_.getCacheAge()||0),(!_.getCacheAge||isNaN(h.ageHeader))&&(h.ageHeader=0)),a){case I.PlaylistContextType.MANIFEST:case I.PlaylistContextType.LEVEL:this.hls.trigger(S.Events.LEVEL_LOADED,{details:h,level:s||0,id:d||0,stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(S.Events.AUDIO_TRACK_LOADED,{details:h,id:d||0,groupId:p||"",stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADED,{details:h,id:d||0,groupId:p||"",stats:c,networkDetails:o,deliveryDirectives:A});break}},C}();const O=R},"./src/polyfills/number.ts":(b,P,m)=>{m.r(P),m.d(P,{MAX_SAFE_INTEGER:()=>S,isFiniteNumber:()=>N});var N=Number.isFinite||function(F){return typeof F=="number"&&isFinite(F)},S=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>S});var N=function(){function F(){}return F.getSilentFrame=function(K,w){switch(K){case"mp4a.40.2":if(w===1)return new Uint8Array([0,200,0,128,35,128]);if(w===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(w===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(w===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(w===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(w===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(w===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},F}();const S=N},"./src/remux/mp4-generator.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>F});var N=Math.pow(2,32)-1,S=function(){function M(){}return M.init=function(){M.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var w;for(w in M.types)M.types.hasOwnProperty(w)&&(M.types[w]=[w.charCodeAt(0),w.charCodeAt(1),w.charCodeAt(2),w.charCodeAt(3)]);var I=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),k=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);M.HDLR_TYPES={video:I,audio:k};var x=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),L=new Uint8Array([0,0,0,0,0,0,0,0]);M.STTS=M.STSC=M.STCO=L,M.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),M.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),M.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),M.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var R=new Uint8Array([105,115,111,109]),O=new Uint8Array([97,118,99,49]),C=new Uint8Array([0,0,0,1]);M.FTYP=M.box(M.types.ftyp,R,C,R,O),M.DINF=M.box(M.types.dinf,M.box(M.types.dref,x))},M.box=function(w){for(var I=8,k=arguments.length,x=new Array(k>1?k-1:0),L=1;L<k;L++)x[L-1]=arguments[L];for(var R=x.length,O=R;R--;)I+=x[R].byteLength;var C=new Uint8Array(I);for(C[0]=I>>24&255,C[1]=I>>16&255,C[2]=I>>8&255,C[3]=I&255,C.set(w,4),R=0,I=8;R<O;R++)C.set(x[R],I),I+=x[R].byteLength;return C},M.hdlr=function(w){return M.box(M.types.hdlr,M.HDLR_TYPES[w])},M.mdat=function(w){return M.box(M.types.mdat,w)},M.mdhd=function(w,I){I*=w;var k=Math.floor(I/(N+1)),x=Math.floor(I%(N+1));return M.box(M.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,x>>24,x>>16&255,x>>8&255,x&255,85,196,0,0]))},M.mdia=function(w){return M.box(M.types.mdia,M.mdhd(w.timescale,w.duration),M.hdlr(w.type),M.minf(w))},M.mfhd=function(w){return M.box(M.types.mfhd,new Uint8Array([0,0,0,0,w>>24,w>>16&255,w>>8&255,w&255]))},M.minf=function(w){return w.type==="audio"?M.box(M.types.minf,M.box(M.types.smhd,M.SMHD),M.DINF,M.stbl(w)):M.box(M.types.minf,M.box(M.types.vmhd,M.VMHD),M.DINF,M.stbl(w))},M.moof=function(w,I,k){return M.box(M.types.moof,M.mfhd(w),M.traf(k,I))},M.moov=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trak(w[I]);return M.box.apply(null,[M.types.moov,M.mvhd(w[0].timescale,w[0].duration)].concat(k).concat(M.mvex(w)))},M.mvex=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trex(w[I]);return M.box.apply(null,[M.types.mvex].concat(k))},M.mvhd=function(w,I){I*=w;var k=Math.floor(I/(N+1)),x=Math.floor(I%(N+1)),L=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,x>>24,x>>16&255,x>>8&255,x&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return M.box(M.types.mvhd,L)},M.sdtp=function(w){var I=w.samples||[],k=new Uint8Array(4+I.length),x,L;for(x=0;x<I.length;x++)L=I[x].flags,k[x+4]=L.dependsOn<<4|L.isDependedOn<<2|L.hasRedundancy;return M.box(M.types.sdtp,k)},M.stbl=function(w){return M.box(M.types.stbl,M.stsd(w),M.box(M.types.stts,M.STTS),M.box(M.types.stsc,M.STSC),M.box(M.types.stsz,M.STSZ),M.box(M.types.stco,M.STCO))},M.avc1=function(w){var I=[],k=[],x,L,R;for(x=0;x<w.sps.length;x++)L=w.sps[x],R=L.byteLength,I.push(R>>>8&255),I.push(R&255),I=I.concat(Array.prototype.slice.call(L));for(x=0;x<w.pps.length;x++)L=w.pps[x],R=L.byteLength,k.push(R>>>8&255),k.push(R&255),k=k.concat(Array.prototype.slice.call(L));var O=M.box(M.types.avcC,new Uint8Array([1,I[3],I[4],I[5],255,224|w.sps.length].concat(I).concat([w.pps.length]).concat(k))),C=w.width,y=w.height,u=w.pixelRatio[0],l=w.pixelRatio[1];return M.box(M.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,C>>8&255,C&255,y>>8&255,y&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),O,M.box(M.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),M.box(M.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,l>>24,l>>16&255,l>>8&255,l&255])))},M.esds=function(w){var I=w.config.length;return new Uint8Array([0,0,0,0,3,23+I,0,1,0,4,15+I,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([I]).concat(w.config).concat([6,1,2]))},M.mp4a=function(w){var I=w.samplerate;return M.box(M.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]),M.box(M.types.esds,M.esds(w)))},M.mp3=function(w){var I=w.samplerate;return M.box(M.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]))},M.stsd=function(w){return w.type==="audio"?w.segmentCodec==="mp3"&&w.codec==="mp3"?M.box(M.types.stsd,M.STSD,M.mp3(w)):M.box(M.types.stsd,M.STSD,M.mp4a(w)):M.box(M.types.stsd,M.STSD,M.avc1(w))},M.tkhd=function(w){var I=w.id,k=w.duration*w.timescale,x=w.width,L=w.height,R=Math.floor(k/(N+1)),O=Math.floor(k%(N+1));return M.box(M.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,I>>24&255,I>>16&255,I>>8&255,I&255,0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255,O>>24,O>>16&255,O>>8&255,O&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,x>>8&255,x&255,0,0,L>>8&255,L&255,0,0]))},M.traf=function(w,I){var k=M.sdtp(w),x=w.id,L=Math.floor(I/(N+1)),R=Math.floor(I%(N+1));return M.box(M.types.traf,M.box(M.types.tfhd,new Uint8Array([0,0,0,0,x>>24,x>>16&255,x>>8&255,x&255])),M.box(M.types.tfdt,new Uint8Array([1,0,0,0,L>>24,L>>16&255,L>>8&255,L&255,R>>24,R>>16&255,R>>8&255,R&255])),M.trun(w,k.length+16+20+8+16+8+8),k)},M.trak=function(w){return w.duration=w.duration||4294967295,M.box(M.types.trak,M.tkhd(w),M.mdia(w))},M.trex=function(w){var I=w.id;return M.box(M.types.trex,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,I&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},M.trun=function(w,I){var k=w.samples||[],x=k.length,L=12+16*x,R=new Uint8Array(L),O,C,y,u,l,c;for(I+=8+L,R.set([w.type==="video"?1:0,0,15,1,x>>>24&255,x>>>16&255,x>>>8&255,x&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255],0),O=0;O<x;O++)C=k[O],y=C.duration,u=C.size,l=C.flags,c=C.cts,R.set([y>>>24&255,y>>>16&255,y>>>8&255,y&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.paddingValue<<1|l.isNonSync,l.degradPrio&61440,l.degradPrio&15,c>>>24&255,c>>>16&255,c>>>8&255,c&255],12+16*O);return M.box(M.types.trun,R)},M.initSegment=function(w){M.types||M.init();var I=M.moov(w),k=new Uint8Array(M.FTYP.byteLength+I.byteLength);return k.set(M.FTYP),k.set(I,M.FTYP.byteLength),k},M}();S.types=void 0,S.HDLR_TYPES=void 0,S.STTS=void 0,S.STSC=void 0,S.STCO=void 0,S.STSZ=void 0,S.VMHD=void 0,S.SMHD=void 0,S.STSD=void 0,S.FTYP=void 0,S.DINF=void 0;const F=S},"./src/remux/mp4-remuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>u,flushTextTrackMetadataCueSamples:()=>f,flushTextTrackUserdataCueSamples:()=>o,normalizePts:()=>l});var N=m("./src/polyfills/number.ts"),S=m("./src/remux/aac-helper.ts"),F=m("./src/remux/mp4-generator.ts"),M=m("./src/events.ts"),K=m("./src/errors.ts"),w=m("./src/utils/logger.ts"),I=m("./src/types/loader.ts"),k=m("./src/utils/timescale-conversion.ts");function x(){return x=Object.assign?Object.assign.bind():function(d){for(var p=1;p<arguments.length;p++){var _=arguments[p];for(var h in _)Object.prototype.hasOwnProperty.call(_,h)&&(d[h]=_[h])}return d},x.apply(this,arguments)}var L=10*1e3,R=1024,O=1152,C=null,y=null,u=function(){function d(_,h,A,E){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=_,this.config=h,this.typeSupported=A,this.ISGenerated=!1,C===null){var v=navigator.userAgent||"",T=v.match(/Chrome\/(\d+)/i);C=T?parseInt(T[1]):0}if(y===null){var D=navigator.userAgent.match(/Safari\/(\d+)/i);y=D?parseInt(D[1]):0}}var p=d.prototype;return p.destroy=function(){},p.resetTimeStamp=function(h){w.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=h},p.resetNextTimestamp=function(){w.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},p.resetInitSegment=function(){w.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},p.getVideoStartPts=function(h){var A=!1,E=h.reduce(function(v,T){var D=T.pts-v;return D<-4294967296?(A=!0,l(v,T.pts)):D>0?v:T.pts},h[0].pts);return A&&w.logger.debug("PTS rollover detected"),E},p.remux=function(h,A,E,v,T,D,B,V){var W,j,$,Q,Z,ee,ae=T,se=T,Y=h.pid>-1,X=A.pid>-1,q=A.samples.length,re=h.samples.length>0,ne=B&&q>0||q>1,U=(!Y||re)&&(!X||ne)||this.ISGenerated||B;if(U){this.ISGenerated||($=this.generateIS(h,A,T));var H=this.isVideoContiguous,z=-1,J;if(ne&&(z=c(A.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(ee=!0,z>0){w.logger.warn("[mp4-remuxer]: Dropped "+z+" out of "+q+" video samples due to a missing keyframe");var te=this.getVideoStartPts(A.samples);A.samples=A.samples.slice(z),A.dropped+=z,se+=(A.samples[0].pts-te)/A.inputTimeScale,J=se}else z===-1&&(w.logger.warn("[mp4-remuxer]: No keyframe found out of "+q+" video samples"),ee=!1);if(this.ISGenerated){if(re&&ne){var ie=this.getVideoStartPts(A.samples),le=l(h.samples[0].pts,ie)-ie,oe=le/A.inputTimeScale;ae+=Math.max(0,oe),se+=Math.max(0,-oe)}if(re){if(h.samplerate||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),$=this.generateIS(h,A,T)),j=this.remuxAudio(h,ae,this.isAudioContiguous,D,X||ne||V===I.PlaylistLevelType.AUDIO?se:void 0),ne){var ue=j?j.endPTS-j.startPTS:0;A.inputTimeScale||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),$=this.generateIS(h,A,T)),W=this.remuxVideo(A,se,H,ue)}}else ne&&(W=this.remuxVideo(A,se,H,0));W&&(W.firstKeyFrame=z,W.independent=z!==-1,W.firstKeyFramePTS=J)}}return this.ISGenerated&&(E.samples.length&&(Z=f(E,T,this._initPTS,this._initDTS)),v.samples.length&&(Q=o(v,T,this._initPTS))),{audio:j,video:W,initSegment:$,independent:ee,text:Q,id3:Z}},p.generateIS=function(h,A,E){var v=h.samples,T=A.samples,D=this.typeSupported,B={},V=!(0,N.isFiniteNumber)(this._initPTS),W="audio/mp4",j,$,Q;if(V&&(j=$=1/0),h.config&&v.length){switch(h.timescale=h.samplerate,h.segmentCodec){case"mp3":D.mpeg?(W="audio/mpeg",h.codec=""):D.mp3&&(h.codec="mp3");break}B.audio={id:"audio",container:W,codec:h.codec,initSegment:h.segmentCodec==="mp3"&&D.mpeg?new Uint8Array(0):F.default.initSegment([h]),metadata:{channelCount:h.channelCount}},V&&(Q=h.inputTimeScale,j=$=v[0].pts-Math.round(Q*E))}if(A.sps&&A.pps&&T.length&&(A.timescale=A.inputTimeScale,B.video={id:"main",container:"video/mp4",codec:A.codec,initSegment:F.default.initSegment([A]),metadata:{width:A.width,height:A.height}},V)){Q=A.inputTimeScale;var Z=this.getVideoStartPts(T),ee=Math.round(Q*E);$=Math.min($,l(T[0].dts,Z)-ee),j=Math.min(j,Z-ee)}if(Object.keys(B).length)return this.ISGenerated=!0,V&&(this._initPTS=j,this._initDTS=$),{tracks:B,initPTS:j,timescale:Q}},p.remuxVideo=function(h,A,E,v){var T=h.inputTimeScale,D=h.samples,B=[],V=D.length,W=this._initPTS,j=this.nextAvcDts,$=8,Q=this.videoSampleDuration,Z,ee,ae=Number.POSITIVE_INFINITY,se=Number.NEGATIVE_INFINITY,Y=!1;if(!E||j===null){var X=A*T,q=D[0].pts-l(D[0].dts,D[0].pts);j=X-q}for(var re=0;re<V;re++){var ne=D[re];ne.pts=l(ne.pts-W,j),ne.dts=l(ne.dts-W,j),ne.dts<D[re>0?re-1:re].dts&&(Y=!0)}Y&&D.sort(function(bn,ki){var fo=bn.dts-ki.dts,ho=bn.pts-ki.pts;return fo||ho}),Z=D[0].dts,ee=D[D.length-1].dts;var U=ee-Z,H=U?Math.round(U/(V-1)):Q||h.inputTimeScale/30;if(E){var z=Z-j,J=z>H,te=z<-1;if((J||te)&&(J?w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)(z,!0)+" ms ("+z+"dts) hole between fragments detected, filling it"):w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)(-z,!0)+" ms ("+z+"dts) overlapping between fragments detected"),!te||j>D[0].pts)){Z=j;var ie=D[0].pts-z;D[0].dts=Z,D[0].pts=ie,w.logger.log("Video: First PTS/DTS adjusted: "+(0,k.toMsFromMpegTsClock)(ie,!0)+"/"+(0,k.toMsFromMpegTsClock)(Z,!0)+", delta: "+(0,k.toMsFromMpegTsClock)(z,!0)+" ms")}}Z=Math.max(0,Z);for(var le=0,oe=0,ue=0;ue<V;ue++){for(var fe=D[ue],ge=fe.units,he=ge.length,Ee=0,Le=0;Le<he;Le++)Ee+=ge[Le].data.length;oe+=Ee,le+=he,fe.length=Ee,fe.dts=Math.max(fe.dts,Z),ae=Math.min(fe.pts,ae),se=Math.max(fe.pts,se)}ee=D[V-1].dts;var Pe=oe+4*le+8,Fe;try{Fe=new Uint8Array(Pe)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:K.ErrorTypes.MUX_ERROR,details:K.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Pe,reason:"fail allocating video mdat "+Pe});return}var Ne=new DataView(Fe.buffer);Ne.setUint32(0,Pe),Fe.set(F.default.types.mdat,4);for(var We=!1,Oe=Number.POSITIVE_INFINITY,Te=Number.POSITIVE_INFINITY,Re=Number.NEGATIVE_INFINITY,tt=Number.NEGATIVE_INFINITY,Ie=0;Ie<V;Ie++){for(var Be=D[Ie],Xe=Be.units,Kt=0,Wt=0,ar=Xe.length;Wt<ar;Wt++){var ft=Xe[Wt],An=ft.data,Vt=ft.data.byteLength;Ne.setUint32($,Vt),$+=4,Fe.set(An,$),$+=Vt,Kt+=4+Vt}var Et=void 0;if(Ie<V-1)Q=D[Ie+1].dts-Be.dts,Et=D[Ie+1].pts-Be.pts;else{var sr=this.config,Gt=Ie>0?Be.dts-D[Ie-1].dts:H;if(Et=Ie>0?Be.pts-D[Ie-1].pts:H,sr.stretchShortVideoTrack&&this.nextAudioPts!==null){var Kr=Math.floor(sr.maxBufferHole*T),_n=(v?ae+v*T:this.nextAudioPts)-Be.pts;_n>Kr?(Q=_n-Gt,Q<0?Q=Gt:We=!0,w.logger.log("[mp4-remuxer]: It is approximately "+_n/90+" ms to the next segment; using duration "+Q/90+" ms for the last video frame.")):Q=Gt}else Q=Gt}var ao=Math.round(Be.pts-Be.dts);Oe=Math.min(Oe,Q),Re=Math.max(Re,Q),Te=Math.min(Te,Et),tt=Math.max(tt,Et),B.push(new a(Be.key,Q,Kt,ao))}if(B.length){if(C){if(C<70){var Ii=B[0].flags;Ii.dependsOn=2,Ii.isNonSync=0}}else if(y&&tt-Te<Re-Oe&&H/Re<.025&&B[0].cts===0){w.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Tn=Z,it=0,Pi=B.length;it<Pi;it++){var Ri=Tn+B[it].duration,so=Tn+B[it].cts;if(it<Pi-1){var oo=Ri+B[it+1].cts;B[it].duration=oo-so}else B[it].duration=it?B[it-1].duration:H;B[it].cts=0,Tn=Ri}}}console.assert(Q!==null,"mp4SampleDuration must be computed"),Q=We||!Q?H:Q,this.nextAvcDts=j=ee+Q,this.videoSampleDuration=Q,this.isVideoContiguous=!0;var lo=F.default.moof(h.sequenceNumber++,Z,x({},h,{samples:B})),uo="video",co={data1:lo,data2:Fe,startPTS:ae/T,endPTS:(se+Q)/T,startDTS:Z/T,endDTS:j/T,type:uo,hasAudio:!1,hasVideo:!0,nb:B.length,dropped:h.dropped};return h.samples=[],h.dropped=0,console.assert(Fe.length,"MDAT length must not be zero"),co},p.remuxAudio=function(h,A,E,v,T){var D=h.inputTimeScale,B=h.samplerate?h.samplerate:D,V=D/B,W=h.segmentCodec==="aac"?R:O,j=W*V,$=this._initPTS,Q=h.segmentCodec==="mp3"&&this.typeSupported.mpeg,Z=[],ee=T!==void 0,ae=h.samples,se=Q?0:8,Y=this.nextAudioPts||-1,X=A*D;if(this.isAudioContiguous=E=E||ae.length&&Y>0&&(v&&Math.abs(X-Y)<9e3||Math.abs(l(ae[0].pts-$,X)-Y)<20*j),ae.forEach(function(ft){ft.pts=l(ft.pts-$,X)}),!E||Y<0){if(ae=ae.filter(function(ft){return ft.pts>=0}),!ae.length)return;T===0?Y=0:v&&!ee?Y=Math.max(0,X):Y=ae[0].pts}if(h.segmentCodec==="aac")for(var q=this.config.maxAudioFramesDrift,re=0,ne=Y;re<ae.length;re++){var U=ae[re],H=U.pts,z=H-ne,J=Math.abs(1e3*z/D);if(z<=-q*j&&ee)re===0&&(w.logger.warn("Audio frame @ "+(H/D).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*z/D)+" ms."),this.nextAudioPts=Y=ne=H);else if(z>=q*j&&J<L&&ee){var te=Math.round(z/j);ne=H-te*j,ne<0&&(te--,ne+=j),re===0&&(this.nextAudioPts=Y=ne),w.logger.warn("[mp4-remuxer]: Injecting "+te+" audio frame @ "+(ne/D).toFixed(3)+"s due to "+Math.round(1e3*z/D)+" ms gap.");for(var ie=0;ie<te;ie++){var le=Math.max(ne,0),oe=S.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);oe||(w.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=U.unit.subarray()),ae.splice(re,0,{unit:oe,pts:le}),ne+=j,re++}}U.pts=ne,ne+=j}for(var ue=null,fe=null,ge,he=0,Ee=ae.length;Ee--;)he+=ae[Ee].unit.byteLength;for(var Le=0,Pe=ae.length;Le<Pe;Le++){var Fe=ae[Le],Ne=Fe.unit,We=Fe.pts;if(fe!==null){var Oe=Z[Le-1];Oe.duration=Math.round((We-fe)/V)}else if(E&&h.segmentCodec==="aac"&&(We=Y),ue=We,he>0){he+=se;try{ge=new Uint8Array(he)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:K.ErrorTypes.MUX_ERROR,details:K.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:he,reason:"fail allocating audio mdat "+he});return}if(!Q){var Te=new DataView(ge.buffer);Te.setUint32(0,he),ge.set(F.default.types.mdat,4)}}else return;ge.set(Ne,se);var Re=Ne.byteLength;se+=Re,Z.push(new a(!0,W,Re,0)),fe=We}var tt=Z.length;if(tt){var Ie=Z[Z.length-1];this.nextAudioPts=Y=fe+V*Ie.duration;var Be=Q?new Uint8Array(0):F.default.moof(h.sequenceNumber++,ue/V,x({},h,{samples:Z}));h.samples=[];var Xe=ue/D,Kt=Y/D,Wt="audio",ar={data1:Be,data2:ge,startPTS:Xe,endPTS:Kt,startDTS:Xe,endDTS:Kt,type:Wt,hasAudio:!0,hasVideo:!1,nb:tt};return this.isAudioContiguous=!0,console.assert(ge.length,"MDAT length must not be zero"),ar}},p.remuxEmptyAudio=function(h,A,E,v){var T=h.inputTimeScale,D=h.samplerate?h.samplerate:T,B=T/D,V=this.nextAudioPts,W=(V!==null?V:v.startDTS*T)+this._initDTS,j=v.endDTS*T+this._initDTS,$=B*R,Q=Math.ceil((j-W)/$),Z=S.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);if(w.logger.warn("[mp4-remuxer]: remux empty Audio"),!Z){w.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var ee=[],ae=0;ae<Q;ae++){var se=W+ae*$;ee.push({unit:Z,pts:se,dts:se})}return h.samples=ee,this.remuxAudio(h,A,E,!1)},d}();function l(d,p){var _;if(p===null)return d;for(p<d?_=-8589934592:_=8589934592;Math.abs(d-p)>4294967296;)d+=_;return d}function c(d){for(var p=0;p<d.length;p++)if(d[p].key)return p;return-1}function f(d,p,_,h){var A=d.samples.length;if(A){for(var E=d.inputTimeScale,v=0;v<A;v++){var T=d.samples[v];T.pts=l(T.pts-_,p*E)/E,T.dts=l(T.dts-h,p*E)/E}var D=d.samples;return d.samples=[],{samples:D}}}function o(d,p,_){var h=d.samples.length;if(h){for(var A=d.inputTimeScale,E=0;E<h;E++){var v=d.samples[E];v.pts=l(v.pts-_,p*A)/A}d.samples.sort(function(D,B){return D.pts-B.pts});var T=d.samples;return d.samples=[],{samples:T}}}var a=function(p,_,h,A){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=_,this.size=h,this.cts=A,this.flags=new s(p)},s=function(p){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=p?2:1,this.isNonSync=p?0:1}},"./src/remux/passthrough-remuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>k});var N=m("./src/polyfills/number.ts"),S=m("./src/remux/mp4-remuxer.ts"),F=m("./src/utils/mp4-tools.ts"),M=m("./src/loader/fragment.ts"),K=m("./src/utils/logger.ts"),w=function(){function x(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var L=x.prototype;return L.destroy=function(){},L.resetTimeStamp=function(O){this.initPTS=O,this.lastEndTime=null},L.resetNextTimestamp=function(){this.lastEndTime=null},L.resetInitSegment=function(O,C,y){this.audioCodec=C,this.videoCodec=y,this.generateInitSegment(O),this.emitInitSegment=!0},L.generateInitSegment=function(O){var C=this.audioCodec,y=this.videoCodec;if(!O||!O.byteLength){this.initTracks=void 0,this.initData=void 0;return}var u=this.initData=(0,F.parseInitSegment)(O);C||(C=I(u.audio,M.ElementaryStreamTypes.AUDIO)),y||(y=I(u.video,M.ElementaryStreamTypes.VIDEO));var l={};u.audio&&u.video?l.audiovideo={container:"video/mp4",codec:C+","+y,initSegment:O,id:"main"}:u.audio?l.audio={container:"audio/mp4",codec:C,initSegment:O,id:"audio"}:u.video?l.video={container:"video/mp4",codec:y,initSegment:O,id:"main"}:K.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=l},L.remux=function(O,C,y,u,l){var c,f=this.initPTS,o=this.lastEndTime,a={audio:void 0,video:void 0,text:u,id3:y,initSegment:void 0};(0,N.isFiniteNumber)(o)||(o=this.lastEndTime=l||0);var s=C.samples;if(!s||!s.length)return a;var d={initPTS:void 0,timescale:1},p=this.initData;if((!p||!p.length)&&(this.generateInitSegment(s),p=this.initData),!p||!p.length)return K.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),a;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);var _=(0,F.getStartDTS)(p,s);(0,N.isFiniteNumber)(f)||(this.initPTS=d.initPTS=f=_-l);var h=(0,F.getDuration)(s,p),A=O?_-f:o,E=A+h;(0,F.offsetStartDTS)(p,s,f),h>0?this.lastEndTime=E:(K.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var v=!!p.audio,T=!!p.video,D="";v&&(D+="audio"),T&&(D+="video");var B={data1:s,startPTS:A,startDTS:A,endPTS:E,endDTS:E,type:D,hasAudio:v,hasVideo:T,nb:1,dropped:0};a.audio=B.type==="audio"?B:void 0,a.video=B.type!=="audio"?B:void 0,a.initSegment=d;var V=(c=this.initPTS)!=null?c:0;return a.id3=(0,S.flushTextTrackMetadataCueSamples)(y,l,V,V),u.samples.length&&(a.text=(0,S.flushTextTrackUserdataCueSamples)(u,l,V)),a},x}();function I(x,L){var R=x==null?void 0:x.codec;return R&&R.length>4?R:R==="hvc1"||R==="hev1"?"hvc1.1.c.L120.90":R==="av01"?"av01.0.04M.08":R==="avc1"||L===M.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const k=w},"./src/task-loop.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});var N=function(){function S(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var F=S.prototype;return F.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},F.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},F.onHandlerDestroyed=function(){},F.hasInterval=function(){return!!this._tickInterval},F.hasNextTick=function(){return!!this._tickTimer},F.setInterval=function(K){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,K),!0)},F.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},F.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},F.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},F.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},F.doTick=function(){},S}()},"./src/types/cmcd.ts":(b,P,m)=>{m.r(P),m.d(P,{CMCDObjectType:()=>S,CMCDStreamType:()=>M,CMCDStreamingFormat:()=>F,CMCDVersion:()=>N});var N=1,S;(function(K){K.MANIFEST="m",K.AUDIO="a",K.VIDEO="v",K.MUXED="av",K.INIT="i",K.CAPTION="c",K.TIMED_TEXT="tt",K.KEY="k",K.OTHER="o"})(S||(S={}));var F;(function(K){K.DASH="d",K.HLS="h",K.SMOOTH="s",K.OTHER="o"})(F||(F={}));var M;(function(K){K.VOD="v",K.LIVE="l"})(M||(M={}))},"./src/types/demuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{MetadataSchema:()=>N});var N;(function(S){S.audioId3="org.id3",S.dateRange="com.apple.quicktime.HLS",S.emsg="https://aomedia.org/emsg/ID3"})(N||(N={}))},"./src/types/level.ts":(b,P,m)=>{m.r(P),m.d(P,{HlsSkip:()=>F,HlsUrlParameters:()=>K,Level:()=>w,getSkipValue:()=>M});function N(I,k){for(var x=0;x<k.length;x++){var L=k[x];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(I,L.key,L)}}function S(I,k,x){return k&&N(I.prototype,k),x&&N(I,x),Object.defineProperty(I,"prototype",{writable:!1}),I}var F;(function(I){I.No="",I.Yes="YES",I.v2="v2"})(F||(F={}));function M(I,k){var x=I.canSkipUntil,L=I.canSkipDateRanges,R=I.endSN,O=k!==void 0?k-R:0;return x&&O<x?L?F.v2:F.Yes:F.No}var K=function(){function I(x,L,R){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=x,this.part=L,this.skip=R}var k=I.prototype;return k.addDirectives=function(L){var R=new self.URL(L);return this.msn!==void 0&&R.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&R.searchParams.set("_HLS_part",this.part.toString()),this.skip&&R.searchParams.set("_HLS_skip",this.skip),R.toString()},I}(),w=function(){function I(k){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[k.url],this.attrs=k.attrs,this.bitrate=k.bitrate,k.details&&(this.details=k.details),this.id=k.id||0,this.name=k.name,this.width=k.width||0,this.height=k.height||0,this.audioCodec=k.audioCodec,this.videoCodec=k.videoCodec,this.unknownCodecs=k.unknownCodecs,this.codecSet=[k.videoCodec,k.audioCodec].filter(function(x){return x}).join(",").replace(/\.[^.,]+/g,"")}return S(I,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(x){var L=x%this.url.length;this._urlId!==L&&(this.details=void 0,this._urlId=L)}}]),I}()},"./src/types/loader.ts":(b,P,m)=>{m.r(P),m.d(P,{PlaylistContextType:()=>N,PlaylistLevelType:()=>S});var N;(function(F){F.MANIFEST="manifest",F.LEVEL="level",F.AUDIO_TRACK="audioTrack",F.SUBTITLE_TRACK="subtitleTrack"})(N||(N={}));var S;(function(F){F.MAIN="main",F.AUDIO="audio",F.SUBTITLE="subtitle"})(S||(S={}))},"./src/types/transmuxer.ts":(b,P,m)=>{m.r(P),m.d(P,{ChunkMetadata:()=>N});var N=function(M,K,w,I,k,x){I===void 0&&(I=0),k===void 0&&(k=-1),x===void 0&&(x=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=S(),this.buffering={audio:S(),video:S(),audiovideo:S()},this.level=M,this.sn=K,this.id=w,this.size=I,this.part=k,this.partial=x};function S(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":(b,P,m)=>{m.r(P),m.d(P,{AttrList:()=>F});var N=/^(\d+)x(\d+)$/,S=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,F=function(){function M(w){typeof w=="string"&&(w=M.parseAttrList(w));for(var I in w)w.hasOwnProperty(I)&&(this[I]=w[I])}var K=M.prototype;return K.decimalInteger=function(I){var k=parseInt(this[I],10);return k>Number.MAX_SAFE_INTEGER?1/0:k},K.hexadecimalInteger=function(I){if(this[I]){var k=(this[I]||"0x").slice(2);k=(k.length&1?"0":"")+k;for(var x=new Uint8Array(k.length/2),L=0;L<k.length/2;L++)x[L]=parseInt(k.slice(L*2,L*2+2),16);return x}else return null},K.hexadecimalIntegerAsNumber=function(I){var k=parseInt(this[I],16);return k>Number.MAX_SAFE_INTEGER?1/0:k},K.decimalFloatingPoint=function(I){return parseFloat(this[I])},K.optionalFloat=function(I,k){var x=this[I];return x?parseFloat(x):k},K.enumeratedString=function(I){return this[I]},K.bool=function(I){return this[I]==="YES"},K.decimalResolution=function(I){var k=N.exec(this[I]);if(k!==null)return{width:parseInt(k[1],10),height:parseInt(k[2],10)}},M.parseAttrList=function(I){var k,x={},L='"';for(S.lastIndex=0;(k=S.exec(I))!==null;){var R=k[2];R.indexOf(L)===0&&R.lastIndexOf(L)===R.length-1&&(R=R.slice(1,-1)),x[k[1]]=R}return x},M}()},"./src/utils/binary-search.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>S});var N={search:function(M,K){for(var w=0,I=M.length-1,k=null,x=null;w<=I;){k=(w+I)/2|0,x=M[k];var L=K(x);if(L>0)w=k+1;else if(L<0)I=k-1;else return x}return null}};const S=N},"./src/utils/buffer-helper.ts":(b,P,m)=>{m.r(P),m.d(P,{BufferHelper:()=>F});var N=m("./src/utils/logger.ts"),S={length:0,start:function(){return 0},end:function(){return 0}},F=function(){function M(){}return M.isBuffered=function(w,I){try{if(w){for(var k=M.getBuffered(w),x=0;x<k.length;x++)if(I>=k.start(x)&&I<=k.end(x))return!0}}catch{}return!1},M.bufferInfo=function(w,I,k){try{if(w){var x=M.getBuffered(w),L=[],R;for(R=0;R<x.length;R++)L.push({start:x.start(R),end:x.end(R)});return this.bufferedInfo(L,I,k)}}catch{}return{len:0,start:I,end:I,nextStart:void 0}},M.bufferedInfo=function(w,I,k){I=Math.max(0,I),w.sort(function(a,s){var d=a.start-s.start;return d||s.end-a.end});var x=[];if(k)for(var L=0;L<w.length;L++){var R=x.length;if(R){var O=x[R-1].end;w[L].start-O<k?w[L].end>O&&(x[R-1].end=w[L].end):x.push(w[L])}else x.push(w[L])}else x=w;for(var C=0,y,u=I,l=I,c=0;c<x.length;c++){var f=x[c].start,o=x[c].end;if(I+k>=f&&I<o)u=f,l=o,C=l-I;else if(I+k<f){y=f;break}}return{len:C,start:u||0,end:l||0,nextStart:y}},M.getBuffered=function(w){try{return w.buffered}catch(I){return N.logger.log("failed to get media.buffered",I),S}},M}()},"./src/utils/cea-608-parser.ts":(b,P,m)=>{m.r(P),m.d(P,{CaptionScreen:()=>c,Row:()=>l,default:()=>p});var N=m("./src/utils/logger.ts"),S={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},F=function(h){var A=h;return S.hasOwnProperty(h)&&(A=S[h]),String.fromCharCode(A)},M=15,K=100,w={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},I={17:2,18:4,21:6,22:8,23:10,19:13,20:15},k={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},x={25:2,26:4,29:6,30:8,31:10,27:13,28:15},L=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],R;(function(_){_[_.ERROR=0]="ERROR",_[_.TEXT=1]="TEXT",_[_.WARNING=2]="WARNING",_[_.INFO=2]="INFO",_[_.DEBUG=3]="DEBUG",_[_.DATA=3]="DATA"})(R||(R={}));var O=function(){function _(){this.time=null,this.verboseLevel=R.ERROR}var h=_.prototype;return h.log=function(E,v){this.verboseLevel>=E&&N.logger.log(this.time+" ["+E+"] "+v)},_}(),C=function(h){for(var A=[],E=0;E<h.length;E++)A.push(h[E].toString(16));return A},y=function(){function _(A,E,v,T,D){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=A||"white",this.underline=E||!1,this.italics=v||!1,this.background=T||"black",this.flash=D||!1}var h=_.prototype;return h.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},h.setStyles=function(E){for(var v=["foreground","underline","italics","background","flash"],T=0;T<v.length;T++){var D=v[T];E.hasOwnProperty(D)&&(this[D]=E[D])}},h.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},h.equals=function(E){return this.foreground===E.foreground&&this.underline===E.underline&&this.italics===E.italics&&this.background===E.background&&this.flash===E.flash},h.copy=function(E){this.foreground=E.foreground,this.underline=E.underline,this.italics=E.italics,this.background=E.background,this.flash=E.flash},h.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},_}(),u=function(){function _(A,E,v,T,D,B){this.uchar=void 0,this.penState=void 0,this.uchar=A||" ",this.penState=new y(E,v,T,D,B)}var h=_.prototype;return h.reset=function(){this.uchar=" ",this.penState.reset()},h.setChar=function(E,v){this.uchar=E,this.penState.copy(v)},h.setPenState=function(E){this.penState.copy(E)},h.equals=function(E){return this.uchar===E.uchar&&this.penState.equals(E.penState)},h.copy=function(E){this.uchar=E.uchar,this.penState.copy(E.penState)},h.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},_}(),l=function(){function _(A){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var E=0;E<K;E++)this.chars.push(new u);this.logger=A,this.pos=0,this.currPenState=new y}var h=_.prototype;return h.equals=function(E){for(var v=!0,T=0;T<K;T++)if(!this.chars[T].equals(E.chars[T])){v=!1;break}return v},h.copy=function(E){for(var v=0;v<K;v++)this.chars[v].copy(E.chars[v])},h.isEmpty=function(){for(var E=!0,v=0;v<K;v++)if(!this.chars[v].isEmpty()){E=!1;break}return E},h.setCursor=function(E){this.pos!==E&&(this.pos=E),this.pos<0?(this.logger.log(R.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>K&&(this.logger.log(R.DEBUG,"Too large cursor position "+this.pos),this.pos=K)},h.moveCursor=function(E){var v=this.pos+E;if(E>1)for(var T=this.pos+1;T<v+1;T++)this.chars[T].setPenState(this.currPenState);this.setCursor(v)},h.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},h.insertChar=function(E){E>=144&&this.backSpace();var v=F(E);if(this.pos>=K){this.logger.log(R.ERROR,"Cannot insert "+E.toString(16)+" ("+v+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(v,this.currPenState),this.moveCursor(1)},h.clearFromPos=function(E){var v;for(v=E;v<K;v++)this.chars[v].reset()},h.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},h.clearToEndOfRow=function(){this.clearFromPos(this.pos)},h.getTextString=function(){for(var E=[],v=!0,T=0;T<K;T++){var D=this.chars[T].uchar;D!==" "&&(v=!1),E.push(D)}return v?"":E.join("")},h.setPenStyles=function(E){this.currPenState.setStyles(E);var v=this.chars[this.pos];v.setPenState(this.currPenState)},_}(),c=function(){function _(A){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var E=0;E<M;E++)this.rows.push(new l(A));this.logger=A,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var h=_.prototype;return h.reset=function(){for(var E=0;E<M;E++)this.rows[E].clear();this.currRow=M-1},h.equals=function(E){for(var v=!0,T=0;T<M;T++)if(!this.rows[T].equals(E.rows[T])){v=!1;break}return v},h.copy=function(E){for(var v=0;v<M;v++)this.rows[v].copy(E.rows[v])},h.isEmpty=function(){for(var E=!0,v=0;v<M;v++)if(!this.rows[v].isEmpty()){E=!1;break}return E},h.backSpace=function(){var E=this.rows[this.currRow];E.backSpace()},h.clearToEndOfRow=function(){var E=this.rows[this.currRow];E.clearToEndOfRow()},h.insertChar=function(E){var v=this.rows[this.currRow];v.insertChar(E)},h.setPen=function(E){var v=this.rows[this.currRow];v.setPenStyles(E)},h.moveCursor=function(E){var v=this.rows[this.currRow];v.moveCursor(E)},h.setCursor=function(E){this.logger.log(R.INFO,"setCursor: "+E);var v=this.rows[this.currRow];v.setCursor(E)},h.setPAC=function(E){this.logger.log(R.INFO,"pacData = "+JSON.stringify(E));var v=E.row-1;if(this.nrRollUpRows&&v<this.nrRollUpRows-1&&(v=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==v){for(var T=0;T<M;T++)this.rows[T].clear();var D=this.currRow+1-this.nrRollUpRows,B=this.lastOutputScreen;if(B){var V=B.rows[D].cueStartTime,W=this.logger.time;if(V&&W!==null&&V<W)for(var j=0;j<this.nrRollUpRows;j++)this.rows[v-this.nrRollUpRows+j+1].copy(B.rows[D+j])}}this.currRow=v;var $=this.rows[this.currRow];if(E.indent!==null){var Q=E.indent,Z=Math.max(Q-1,0);$.setCursor(E.indent),E.color=$.chars[Z].penState.foreground}var ee={foreground:E.color,underline:E.underline,italics:E.italics,background:"black",flash:!1};this.setPen(ee)},h.setBkgData=function(E){this.logger.log(R.INFO,"bkgData = "+JSON.stringify(E)),this.backSpace(),this.setPen(E),this.insertChar(32)},h.setRollUpRows=function(E){this.nrRollUpRows=E},h.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(R.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(R.TEXT,this.getDisplayText());var E=this.currRow+1-this.nrRollUpRows,v=this.rows.splice(E,1)[0];v.clear(),this.rows.splice(this.currRow,0,v),this.logger.log(R.INFO,"Rolling up")},h.getDisplayText=function(E){E=E||!1;for(var v=[],T="",D=-1,B=0;B<M;B++){var V=this.rows[B].getTextString();V&&(D=B+1,E?v.push("Row "+D+": '"+V+"'"):v.push(V.trim()))}return v.length>0&&(E?T="["+v.join(" | ")+"]":T=v.join(`
`)),T},h.getTextAndFormat=function(){return this.rows},_}(),f=function(){function _(A,E,v){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=A,this.outputFilter=E,this.mode=null,this.verbose=0,this.displayedMemory=new c(v),this.nonDisplayedMemory=new c(v),this.lastOutputScreen=new c(v),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=v}var h=_.prototype;return h.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},h.getHandler=function(){return this.outputFilter},h.setHandler=function(E){this.outputFilter=E},h.setPAC=function(E){this.writeScreen.setPAC(E)},h.setBkgData=function(E){this.writeScreen.setBkgData(E)},h.setMode=function(E){E!==this.mode&&(this.mode=E,this.logger.log(R.INFO,"MODE="+E),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=E)},h.insertChars=function(E){for(var v=0;v<E.length;v++)this.writeScreen.insertChar(E[v]);var T=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(R.INFO,T+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(R.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},h.ccRCL=function(){this.logger.log(R.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},h.ccBS=function(){this.logger.log(R.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},h.ccAOF=function(){},h.ccAON=function(){},h.ccDER=function(){this.logger.log(R.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},h.ccRU=function(E){this.logger.log(R.INFO,"RU("+E+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(E)},h.ccFON=function(){this.logger.log(R.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},h.ccRDC=function(){this.logger.log(R.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},h.ccTR=function(){this.logger.log(R.INFO,"TR"),this.setMode("MODE_TEXT")},h.ccRTD=function(){this.logger.log(R.INFO,"RTD"),this.setMode("MODE_TEXT")},h.ccEDM=function(){this.logger.log(R.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},h.ccCR=function(){this.logger.log(R.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},h.ccENM=function(){this.logger.log(R.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},h.ccEOC=function(){if(this.logger.log(R.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var E=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=E,this.writeScreen=this.nonDisplayedMemory,this.logger.log(R.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},h.ccTO=function(E){this.logger.log(R.INFO,"TO("+E+") - Tab Offset"),this.writeScreen.moveCursor(E)},h.ccMIDROW=function(E){var v={flash:!1};if(v.underline=E%2===1,v.italics=E>=46,v.italics)v.foreground="white";else{var T=Math.floor(E/2)-16,D=["white","green","blue","cyan","red","yellow","magenta"];v.foreground=D[T]}this.logger.log(R.INFO,"MIDROW: "+JSON.stringify(v)),this.writeScreen.setPen(v)},h.outputDataUpdate=function(E){E===void 0&&(E=!1);var v=this.logger.time;v!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=v:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,v,this.lastOutputScreen),E&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:v),this.lastOutputScreen.copy(this.displayedMemory))},h.cueSplitAtTime=function(E){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,E,this.displayedMemory),this.cueStartTime=E))},_}(),o=function(){function _(A,E,v){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var T=new O;this.channels=[null,new f(A,E,T),new f(A+1,v,T)],this.cmdHistory=d(),this.logger=T}var h=_.prototype;return h.getHandler=function(E){return this.channels[E].getHandler()},h.setHandler=function(E,v){this.channels[E].setHandler(v)},h.addData=function(E,v){var T,D,B,V=!1;this.logger.time=E;for(var W=0;W<v.length;W+=2)if(D=v[W]&127,B=v[W+1]&127,!(D===0&&B===0)){if(this.logger.log(R.DATA,"["+C([v[W],v[W+1]])+"] -> ("+C([D,B])+")"),T=this.parseCmd(D,B),T||(T=this.parseMidrow(D,B)),T||(T=this.parsePAC(D,B)),T||(T=this.parseBackgroundAttributes(D,B)),!T&&(V=this.parseChars(D,B),V)){var j=this.currentChannel;if(j&&j>0){var $=this.channels[j];$.insertChars(V)}else this.logger.log(R.WARNING,"No channel found yet. TEXT-MODE?")}!T&&!V&&this.logger.log(R.WARNING,"Couldn't parse cleaned data "+C([D,B])+" orig: "+C([v[W],v[W+1]]))}},h.parseCmd=function(E,v){var T=this.cmdHistory,D=(E===20||E===28||E===21||E===29)&&v>=32&&v<=47,B=(E===23||E===31)&&v>=33&&v<=35;if(!(D||B))return!1;if(s(E,v,T))return a(null,null,T),this.logger.log(R.DEBUG,"Repeated command ("+C([E,v])+") is dropped"),!0;var V=E===20||E===21||E===23?1:2,W=this.channels[V];return E===20||E===21||E===28||E===29?v===32?W.ccRCL():v===33?W.ccBS():v===34?W.ccAOF():v===35?W.ccAON():v===36?W.ccDER():v===37?W.ccRU(2):v===38?W.ccRU(3):v===39?W.ccRU(4):v===40?W.ccFON():v===41?W.ccRDC():v===42?W.ccTR():v===43?W.ccRTD():v===44?W.ccEDM():v===45?W.ccCR():v===46?W.ccENM():v===47&&W.ccEOC():W.ccTO(v-32),a(E,v,T),this.currentChannel=V,!0},h.parseMidrow=function(E,v){var T=0;if((E===17||E===25)&&v>=32&&v<=47){if(E===17?T=1:T=2,T!==this.currentChannel)return this.logger.log(R.ERROR,"Mismatch channel in midrow parsing"),!1;var D=this.channels[T];return D?(D.ccMIDROW(v),this.logger.log(R.DEBUG,"MIDROW ("+C([E,v])+")"),!0):!1}return!1},h.parsePAC=function(E,v){var T,D=this.cmdHistory,B=(E>=17&&E<=23||E>=25&&E<=31)&&v>=64&&v<=127,V=(E===16||E===24)&&v>=64&&v<=95;if(!(B||V))return!1;if(s(E,v,D))return a(null,null,D),!0;var W=E<=23?1:2;v>=64&&v<=95?T=W===1?w[E]:k[E]:T=W===1?I[E]:x[E];var j=this.channels[W];return j?(j.setPAC(this.interpretPAC(T,v)),a(E,v,D),this.currentChannel=W,!0):!1},h.interpretPAC=function(E,v){var T,D={color:null,italics:!1,indent:null,underline:!1,row:E};return v>95?T=v-96:T=v-64,D.underline=(T&1)===1,T<=13?D.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(T/2)]:T<=15?(D.italics=!0,D.color="white"):D.indent=Math.floor((T-16)/2)*4,D},h.parseChars=function(E,v){var T,D=null,B=null;if(E>=25?(T=2,B=E-8):(T=1,B=E),B>=17&&B<=19){var V;B===17?V=v+80:B===18?V=v+112:V=v+144,this.logger.log(R.INFO,"Special char '"+F(V)+"' in channel "+T),D=[V]}else E>=32&&E<=127&&(D=v===0?[E]:[E,v]);if(D){var W=C(D);this.logger.log(R.DEBUG,"Char codes =  "+W.join(",")),a(E,v,this.cmdHistory)}return D},h.parseBackgroundAttributes=function(E,v){var T=(E===16||E===24)&&v>=32&&v<=47,D=(E===23||E===31)&&v>=45&&v<=47;if(!(T||D))return!1;var B,V={};E===16||E===24?(B=Math.floor((v-32)/2),V.background=L[B],v%2===1&&(V.background=V.background+"_semi")):v===45?V.background="transparent":(V.foreground="black",v===47&&(V.underline=!0));var W=E<=23?1:2,j=this.channels[W];return j.setBkgData(V),a(E,v,this.cmdHistory),!0},h.reset=function(){for(var E=0;E<Object.keys(this.channels).length;E++){var v=this.channels[E];v&&v.reset()}this.cmdHistory=d()},h.cueSplitAtTime=function(E){for(var v=0;v<this.channels.length;v++){var T=this.channels[v];T&&T.cueSplitAtTime(E)}},_}();function a(_,h,A){A.a=_,A.b=h}function s(_,h,A){return A.a===_&&A.b===h}function d(){return{a:null,b:null}}const p=o},"./src/utils/codecs.ts":(b,P,m)=>{m.r(P),m.d(P,{isCodecSupportedInMp4:()=>F,isCodecType:()=>S});var N={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function S(M,K){var w=N[K];return!!w&&w[M.slice(0,4)]===!0}function F(M,K){return MediaSource.isTypeSupported((K||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>w});var N=m("./src/utils/vttparser.ts"),S=m("./src/utils/webvtt-parser.ts"),F=m("./src/utils/texttrack-utils.ts"),M=/\s/,K={newCue:function(k,x,L,R){for(var O=[],C,y,u,l,c,f=self.VTTCue||self.TextTrackCue,o=0;o<R.rows.length;o++)if(C=R.rows[o],u=!0,l=0,c="",!C.isEmpty()){for(var a=0;a<C.chars.length;a++)M.test(C.chars[a].uchar)&&u?l++:(c+=C.chars[a].uchar,u=!1);C.cueStartTime=x,x===L&&(L+=1e-4),l>=16?l--:l++;var s=(0,N.fixLineBreaks)(c.trim()),d=(0,S.generateCueId)(x,L,s);(!k||!k.cues||!k.cues.getCueById(d))&&(y=new f(x,L,s),y.id=d,y.line=o+1,y.align="left",y.position=10+Math.min(80,Math.floor(l*8/32)*10),O.push(y))}return k&&O.length&&(O.sort(function(p,_){return p.line==="auto"||_.line==="auto"?0:p.line>8&&_.line>8?_.line-p.line:p.line-_.line}),O.forEach(function(p){return(0,F.addCueToTrack)(k,p)})),O}};const w=K},"./src/utils/discontinuities.ts":(b,P,m)=>{m.r(P),m.d(P,{adjustSlidingStart:()=>k,alignMediaPlaylistByPDT:()=>O,alignPDT:()=>R,alignStream:()=>x,findDiscontinuousReferenceFrag:()=>w,findFirstFragWithCC:()=>M,shouldAlignOnDiscontinuities:()=>K});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/logger.ts"),F=m("./src/controller/level-helper.ts");function M(C,y){for(var u=null,l=0,c=C.length;l<c;l++){var f=C[l];if(f&&f.cc===y){u=f;break}}return u}function K(C,y,u){return!!(y.details&&(u.endCC>u.startCC||C&&C.cc<u.startCC))}function w(C,y,u){var l=C.fragments,c=y.fragments;if(!c.length||!l.length){S.logger.log("No fragments to align");return}var f=M(l,c[0].cc);if(!f||f&&!f.startPTS){S.logger.log("No frag in previous level to align on");return}return f}function I(C,y){if(C){var u=C.start+y;C.start=C.startPTS=u,C.endPTS=u+C.duration}}function k(C,y){for(var u=y.fragments,l=0,c=u.length;l<c;l++)I(u[l],C);y.fragmentHint&&I(y.fragmentHint,C),y.alignedSliding=!0}function x(C,y,u){y&&(L(C,u,y),!u.alignedSliding&&y.details&&R(u,y.details),!u.alignedSliding&&y.details&&!u.skippedSegments&&(0,F.adjustSliding)(y.details,u))}function L(C,y,u){if(K(C,u,y)){var l=w(u.details,y);l&&(0,N.isFiniteNumber)(l.start)&&(S.logger.log("Adjusting PTS using last level due to CC increase within current level "+y.url),k(l.start,y))}}function R(C,y){if(!(!y.fragments.length||!C.hasProgramDateTime||!y.hasProgramDateTime)){var u=y.fragments[0].programDateTime,l=C.fragments[0].programDateTime,c=(l-u)/1e3+y.fragments[0].start;c&&(0,N.isFiniteNumber)(c)&&(S.logger.log("Adjusting PTS using programDateTime delta "+(l-u)+"ms, sliding:"+c.toFixed(3)+" "+C.url+" "),k(c,C))}}function O(C,y){if(!(!C.hasProgramDateTime||!y.hasProgramDateTime)){var u=C.fragments,l=y.fragments;if(!(!u.length||!l.length)){var c=Math.round(l.length/2)-1,f=l[c],o=M(u,f.cc)||u[Math.round(u.length/2)-1],a=f.programDateTime,s=o.programDateTime;if(!(a===null||s===null)){var d=(s-a)/1e3-(o.start-f.start);k(d,C)}}}}},"./src/utils/ewma-bandwidth-estimator.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>F});var N=m("./src/utils/ewma.ts"),S=function(){function M(w,I,k){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=k,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new N.default(w),this.fast_=new N.default(I)}var K=M.prototype;return K.update=function(I,k){var x=this.slow_,L=this.fast_;this.slow_.halfLife!==I&&(this.slow_=new N.default(I,x.getEstimate(),x.getTotalWeight())),this.fast_.halfLife!==k&&(this.fast_=new N.default(k,L.getEstimate(),L.getTotalWeight()))},K.sample=function(I,k){I=Math.max(I,this.minDelayMs_);var x=8*k,L=I/1e3,R=x/L;this.fast_.sample(L,R),this.slow_.sample(L,R)},K.canEstimate=function(){var I=this.fast_;return I&&I.getTotalWeight()>=this.minWeight_},K.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},K.destroy=function(){},M}();const F=S},"./src/utils/ewma.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>S});var N=function(){function F(K,w,I){w===void 0&&(w=0),I===void 0&&(I=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=K,this.alpha_=K?Math.exp(Math.log(.5)/K):0,this.estimate_=w,this.totalWeight_=I}var M=F.prototype;return M.sample=function(w,I){var k=Math.pow(this.alpha_,w);this.estimate_=I*(1-k)+k*this.estimate_,this.totalWeight_+=w},M.getTotalWeight=function(){return this.totalWeight_},M.getEstimate=function(){if(this.alpha_){var w=1-Math.pow(this.alpha_,this.totalWeight_);if(w)return this.estimate_/w}return this.estimate_},F}();const S=N},"./src/utils/fetch-loader.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>c,fetchSupported:()=>O});var N=m("./src/polyfills/number.ts"),S=m("./src/loader/load-stats.ts"),F=m("./src/demux/chunk-cache.ts");function M(f,o){f.prototype=Object.create(o.prototype),f.prototype.constructor=f,x(f,o)}function K(f){var o=typeof Map=="function"?new Map:void 0;return K=function(s){if(s===null||!k(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(s))return o.get(s);o.set(s,d)}function d(){return w(s,arguments,L(this).constructor)}return d.prototype=Object.create(s.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),x(d,s)},K(f)}function w(f,o,a){return I()?w=Reflect.construct.bind():w=function(d,p,_){var h=[null];h.push.apply(h,p);var A=Function.bind.apply(d,h),E=new A;return _&&x(E,_.prototype),E},w.apply(null,arguments)}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k(f){return Function.toString.call(f).indexOf("[native code]")!==-1}function x(f,o){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,d){return s.__proto__=d,s},x(f,o)}function L(f){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},L(f)}function R(){return R=Object.assign?Object.assign.bind():function(f){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(f[s]=a[s])}return f},R.apply(this,arguments)}function O(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var C=function(){function f(a){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=a.fetchSetup||u,this.controller=new self.AbortController,this.stats=new S.LoadStats}var o=f.prototype;return o.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function(){var s=this.response;(!s||!s.ok)&&(this.stats.aborted=!0,this.controller.abort())},o.abort=function(){var s;this.abortInternal(),(s=this.callbacks)!==null&&s!==void 0&&s.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function(s,d,p){var _=this,h=this.stats;if(h.loading.start)throw new Error("Loader can only be used once.");h.loading.start=self.performance.now();var A=y(s,this.controller.signal),E=p.onProgress,v=s.responseType==="arraybuffer",T=v?"byteLength":"length";this.context=s,this.config=d,this.callbacks=p,this.request=this.fetchSetup(s,A),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){_.abortInternal(),p.onTimeout(h,s,_.response)},d.timeout),self.fetch(this.request).then(function(D){if(_.response=_.loader=D,!D.ok){var B=D.status,V=D.statusText;throw new l(V||"fetch, bad network response",B,D)}return h.loading.first=Math.max(self.performance.now(),h.loading.start),h.total=parseInt(D.headers.get("Content-Length")||"0"),E&&(0,N.isFiniteNumber)(d.highWaterMark)?_.loadProgressively(D,h,s,d.highWaterMark,E):v?D.arrayBuffer():D.text()}).then(function(D){var B=_.response;self.clearTimeout(_.requestTimeout),h.loading.end=Math.max(self.performance.now(),h.loading.first);var V=D[T];V&&(h.loaded=h.total=V);var W={url:B.url,data:D};E&&!(0,N.isFiniteNumber)(d.highWaterMark)&&E(h,s,D,B),p.onSuccess(W,h,s,B)}).catch(function(D){if(self.clearTimeout(_.requestTimeout),!h.aborted){var B=D&&D.code||0,V=D?D.message:null;p.onError({code:B,text:V},s,D?D.details:null)}})},o.getCacheAge=function(){var s=null;if(this.response){var d=this.response.headers.get("age");s=d?parseFloat(d):null}return s},o.loadProgressively=function(s,d,p,_,h){_===void 0&&(_=0);var A=new F.default,E=s.body.getReader(),v=function T(){return E.read().then(function(D){if(D.done)return A.dataLength&&h(d,p,A.flush(),s),Promise.resolve(new ArrayBuffer(0));var B=D.value,V=B.length;return d.loaded+=V,V<_||A.dataLength?(A.push(B),A.dataLength>=_&&h(d,p,A.flush(),s)):h(d,p,B,s),T()}).catch(function(){return Promise.reject()})};return v()},f}();function y(f,o){var a={method:"GET",mode:"cors",credentials:"same-origin",signal:o,headers:new self.Headers(R({},f.headers))};return f.rangeEnd&&a.headers.set("Range","bytes="+f.rangeStart+"-"+String(f.rangeEnd-1)),a}function u(f,o){return new self.Request(f.url,o)}var l=function(f){M(o,f);function o(a,s,d){var p;return p=f.call(this,a)||this,p.code=void 0,p.details=void 0,p.code=s,p.details=d,p}return o}(K(Error));const c=C},"./src/utils/imsc1-ttml-parser.ts":(b,P,m)=>{m.r(P),m.d(P,{IMSC1_CODEC:()=>k,parseIMSC1:()=>O});var N=m("./src/utils/mp4-tools.ts"),S=m("./src/utils/vttparser.ts"),F=m("./src/utils/vttcue.ts"),M=m("./src/demux/id3.ts"),K=m("./src/utils/timescale-conversion.ts"),w=m("./src/utils/webvtt-parser.ts");function I(){return I=Object.assign?Object.assign.bind():function(p){for(var _=1;_<arguments.length;_++){var h=arguments[_];for(var A in h)Object.prototype.hasOwnProperty.call(h,A)&&(p[A]=h[A])}return p},I.apply(this,arguments)}var k="stpp.ttml.im1t",x=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,L=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,R={left:"start",center:"center",right:"end",start:"start",end:"end"};function O(p,_,h,A,E){var v=(0,N.findBox)(new Uint8Array(p),["mdat"]);if(v.length===0){E(new Error("Could not parse IMSC1 mdat"));return}var T=v.map(function(B){return(0,M.utf8ArrayToStr)(B)}),D=(0,K.toTimescaleFromScale)(_,1,h);try{T.forEach(function(B){return A(C(B,D))})}catch(B){E(B)}}function C(p,_){var h=new DOMParser,A=h.parseFromString(p,"text/xml"),E=A.getElementsByTagName("tt")[0];if(!E)throw new Error("Invalid ttml");var v={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},T=Object.keys(v).reduce(function(j,$){return j[$]=E.getAttribute("ttp:"+$)||v[$],j},{}),D=E.getAttribute("xml:space")!=="preserve",B=u(y(E,"styling","style")),V=u(y(E,"layout","region")),W=y(E,"body","[begin]");return[].map.call(W,function(j){var $=l(j,D);if(!$||!j.hasAttribute("begin"))return null;var Q=a(j.getAttribute("begin"),T),Z=a(j.getAttribute("dur"),T),ee=a(j.getAttribute("end"),T);if(Q===null)throw o(j);if(ee===null){if(Z===null)throw o(j);ee=Q+Z}var ae=new F.default(Q-_,ee-_,$);ae.id=(0,w.generateCueId)(ae.startTime,ae.endTime,ae.text);var se=V[j.getAttribute("region")],Y=B[j.getAttribute("style")];ae.position=10,ae.size=80;var X=c(se,Y,B),q=X.textAlign;if(q){var re=R[q];re&&(ae.lineAlign=re),ae.align=q}return I(ae,X),ae}).filter(function(j){return j!==null})}function y(p,_,h){var A=p.getElementsByTagName(_)[0];return A?[].slice.call(A.querySelectorAll(h)):[]}function u(p){return p.reduce(function(_,h){var A=h.getAttribute("xml:id");return A&&(_[A]=h),_},{})}function l(p,_){return[].slice.call(p.childNodes).reduce(function(h,A,E){var v;return A.nodeName==="br"&&E?h+`
`:(v=A.childNodes)!==null&&v!==void 0&&v.length?l(A,_):_?h+A.textContent.trim().replace(/\s+/g," "):h+A.textContent},"")}function c(p,_,h){var A="http://www.w3.org/ns/ttml#styling",E=null,v=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],T=p!=null&&p.hasAttribute("style")?p.getAttribute("style"):null;return T&&h.hasOwnProperty(T)&&(E=h[T]),v.reduce(function(D,B){var V=f(_,A,B)||f(p,A,B)||f(E,A,B);return V&&(D[B]=V),D},{})}function f(p,_,h){return p&&p.hasAttributeNS(_,h)?p.getAttributeNS(_,h):null}function o(p){return new Error("Could not parse ttml timestamp "+p)}function a(p,_){if(!p)return null;var h=(0,S.parseTimeStamp)(p);return h===null&&(x.test(p)?h=s(p,_):L.test(p)&&(h=d(p,_))),h}function s(p,_){var h=x.exec(p),A=(h[4]|0)+(h[5]|0)/_.subFrameRate;return(h[1]|0)*3600+(h[2]|0)*60+(h[3]|0)+A/_.frameRate}function d(p,_){var h=L.exec(p),A=Number(h[1]),E=h[2];switch(E){case"h":return A*3600;case"m":return A*60;case"ms":return A*1e3;case"f":return A/_.frameRate;case"t":return A/_.tickRate}return A}},"./src/utils/logger.ts":(b,P,m)=>{m.r(P),m.d(P,{enableLogs:()=>w,logger:()=>I});var N=function(){},S={trace:N,debug:N,log:N,warn:N,info:N,error:N},F=S;function M(k){var x=self.console[k];return x?x.bind(self.console,"["+k+"] >"):N}function K(k){for(var x=arguments.length,L=new Array(x>1?x-1:0),R=1;R<x;R++)L[R-1]=arguments[R];L.forEach(function(O){F[O]=k[O]?k[O].bind(k):M(O)})}function w(k,x){if(self.console&&k===!0||typeof k=="object"){K(k,"debug","log","info","warn","error");try{F.log('Debug logs enabled for "'+x+'"')}catch{F=S}}else F=S}var I=F},"./src/utils/mediakeys-helper.ts":(b,P,m)=>{m.r(P),m.d(P,{KeySystems:()=>N,requestMediaKeySystemAccess:()=>S});var N;(function(F){F.WIDEVINE="com.widevine.alpha",F.PLAYREADY="com.microsoft.playready"})(N||(N={}));var S=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":(b,P,m)=>{m.r(P),m.d(P,{getMediaSource:()=>N});function N(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":(b,P,m)=>{m.r(P),m.d(P,{RemuxerTrackIdConfig:()=>w,appendUint8Array:()=>a,bin2str:()=>I,computeRawDurationFromSamples:()=>c,discardEPB:()=>h,findBox:()=>O,getDuration:()=>l,getStartDTS:()=>u,offsetStartDTS:()=>f,parseEmsg:()=>A,parseInitSegment:()=>y,parseSEIMessageFromNALu:()=>_,parseSamples:()=>s,parseSegmentIndex:()=>C,readSint32:()=>L,readUint16:()=>k,readUint32:()=>x,segmentValidRange:()=>o,writeUint32:()=>R});var N=m("./src/utils/typed-array.ts"),S=m("./src/loader/fragment.ts"),F=m("./src/demux/id3.ts"),M=Math.pow(2,32)-1,K=[].push,w={video:1,audio:2,id3:3,text:4};function I(E){return String.fromCharCode.apply(null,E)}function k(E,v){var T=E[v]<<8|E[v+1];return T<0?65536+T:T}function x(E,v){var T=L(E,v);return T<0?4294967296+T:T}function L(E,v){return E[v]<<24|E[v+1]<<16|E[v+2]<<8|E[v+3]}function R(E,v,T){E[v]=T>>24,E[v+1]=T>>16&255,E[v+2]=T>>8&255,E[v+3]=T&255}function O(E,v){var T=[];if(!v.length)return T;for(var D=E.byteLength,B=0;B<D;){var V=x(E,B),W=I(E.subarray(B+4,B+8)),j=V>1?B+V:D;if(W===v[0])if(v.length===1)T.push(E.subarray(B+8,j));else{var $=O(E.subarray(B+8,j),v.slice(1));$.length&&K.apply(T,$)}B=j}return T}function C(E){var v=[],T=E[0],D=8,B=x(E,D);D+=4;var V=0,W=0;T===0?D+=8:D+=16,D+=2;var j=E.length+W,$=k(E,D);D+=2;for(var Q=0;Q<$;Q++){var Z=D,ee=x(E,Z);Z+=4;var ae=ee&2147483647,se=(ee&2147483648)>>>31;if(se===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var Y=x(E,Z);Z+=4,v.push({referenceSize:ae,subsegmentDuration:Y,info:{duration:Y/B,start:j,end:j+ae-1}}),j+=ae,Z+=4,D=Z}return{earliestPresentationTime:V,timescale:B,version:T,referencesCount:$,references:v}}function y(E){for(var v=[],T=O(E,["moov","trak"]),D=0;D<T.length;D++){var B=T[D],V=O(B,["tkhd"])[0];if(V){var W=V[0],j=W===0?12:20,$=x(V,j),Q=O(B,["mdia","mdhd"])[0];if(Q){W=Q[0],j=W===0?12:20;var Z=x(Q,j),ee=O(B,["mdia","hdlr"])[0];if(ee){var ae=I(ee.subarray(8,12)),se={soun:S.ElementaryStreamTypes.AUDIO,vide:S.ElementaryStreamTypes.VIDEO}[ae];if(se){var Y=O(B,["mdia","minf","stbl","stsd"])[0],X=void 0;Y&&(X=I(Y.subarray(12,16))),v[$]={timescale:Z,type:se},v[se]={timescale:Z,id:$,codec:X}}}}}}var q=O(E,["moov","mvex","trex"]);return q.forEach(function(re){var ne=x(re,4),U=v[ne];U&&(U.default={duration:x(re,12),flags:x(re,20)})}),v}function u(E,v){return O(v,["moof","traf"]).reduce(function(T,D){var B=O(D,["tfdt"])[0],V=B[0],W=O(D,["tfhd"]).reduce(function(j,$){var Q=x($,4),Z=E[Q];if(Z){var ee=x(B,4);V===1&&(ee*=Math.pow(2,32),ee+=x(B,8));var ae=Z.timescale||9e4,se=ee/ae;if(isFinite(se)&&(j===null||se<j))return se}return j},null);return W!==null&&isFinite(W)&&(T===null||W<T)?W:T},null)||0}function l(E,v){for(var T=0,D=0,B=0,V=O(E,["moof","traf"]),W=0;W<V.length;W++){var j=V[W],$=O(j,["tfhd"])[0],Q=x($,4),Z=v[Q];if(Z){var ee=Z.default,ae=x($,0)|(ee==null?void 0:ee.flags),se=ee==null?void 0:ee.duration;ae&8&&(ae&2?se=x($,12):se=x($,8));for(var Y=Z.timescale||9e4,X=O(j,["trun"]),q=0;q<X.length;q++){if(T=c(X[q]),!T&&se){var re=x(X[q],4);T=se*re}Z.type===S.ElementaryStreamTypes.VIDEO?D+=T/Y:Z.type===S.ElementaryStreamTypes.AUDIO&&(B+=T/Y)}}}if(D===0&&B===0){for(var ne=0,U=O(E,["sidx"]),H=0;H<U.length;H++){var z=C(U[H]);z!=null&&z.references&&(ne+=z.references.reduce(function(J,te){return J+te.info.duration||0},0))}return ne}return D||B}function c(E){var v=x(E,0),T=8;v&1&&(T+=4),v&4&&(T+=4);for(var D=0,B=x(E,4),V=0;V<B;V++){if(v&256){var W=x(E,T);D+=W,T+=4}v&512&&(T+=4),v&1024&&(T+=4),v&2048&&(T+=4)}return D}function f(E,v,T){O(v,["moof","traf"]).forEach(function(D){O(D,["tfhd"]).forEach(function(B){var V=x(B,4),W=E[V];if(W){var j=W.timescale||9e4;O(D,["tfdt"]).forEach(function($){var Q=$[0],Z=x($,4);if(Q===0)Z-=T*j,Z=Math.max(Z,0),R($,4,Z);else{Z*=Math.pow(2,32),Z+=x($,8),Z-=T*j,Z=Math.max(Z,0);var ee=Math.floor(Z/(M+1)),ae=Math.floor(Z%(M+1));R($,4,ee),R($,8,ae)}})}})})}function o(E){var v={valid:null,remainder:null},T=O(E,["moof"]);if(T){if(T.length<2)return v.remainder=E,v}else return v;var D=T[T.length-1];return v.valid=(0,N.sliceUint8)(E,0,D.byteOffset-8),v.remainder=(0,N.sliceUint8)(E,D.byteOffset-8),v}function a(E,v){var T=new Uint8Array(E.length+v.length);return T.set(E),T.set(v,E.length),T}function s(E,v){var T=[],D=v.samples,B=v.timescale,V=v.id,W=!1,j=O(D,["moof"]);return j.map(function($){var Q=$.byteOffset-8,Z=O($,["traf"]);Z.map(function(ee){var ae=O(ee,["tfdt"]).map(function(se){var Y=se[0],X=x(se,4);return Y===1&&(X*=Math.pow(2,32),X+=x(se,8)),X/B})[0];return ae!==void 0&&(E=ae),O(ee,["tfhd"]).map(function(se){var Y=x(se,4),X=x(se,0)&16777215,q=(X&1)!==0,re=(X&2)!==0,ne=(X&8)!==0,U=0,H=(X&16)!==0,z=0,J=(X&32)!==0,te=8;Y===V&&(q&&(te+=8),re&&(te+=4),ne&&(U=x(se,te),te+=4),H&&(z=x(se,te),te+=4),J&&(te+=4),v.type==="video"&&(W=d(v.codec)),O(ee,["trun"]).map(function(ie){var le=ie[0],oe=x(ie,0)&16777215,ue=(oe&1)!==0,fe=0,ge=(oe&4)!==0,he=(oe&256)!==0,Ee=0,Le=(oe&512)!==0,Pe=0,Fe=(oe&1024)!==0,Ne=(oe&2048)!==0,We=0,Oe=x(ie,4),Te=8;ue&&(fe=x(ie,Te),Te+=4),ge&&(Te+=4);for(var Re=fe+Q,tt=0;tt<Oe;tt++){if(he?(Ee=x(ie,Te),Te+=4):Ee=U,Le?(Pe=x(ie,Te),Te+=4):Pe=z,Fe&&(Te+=4),Ne&&(le===0?We=x(ie,Te):We=L(ie,Te),Te+=4),v.type===S.ElementaryStreamTypes.VIDEO)for(var Ie=0;Ie<Pe;){var Be=x(D,Re);if(Re+=4,p(W,D[Re])){var Xe=D.subarray(Re,Re+Be);_(Xe,W?2:1,E+We/B,T)}Re+=Be,Ie+=Be+4}E+=Ee/B}}))})})}),T}function d(E){if(!E)return!1;var v=E.indexOf("."),T=v<0?E:E.substring(0,v);return T==="hvc1"||T==="hev1"||T==="dvh1"||T==="dvhe"}function p(E,v){if(E){var T=v>>1&63;return T===39||T===40}else{var D=v&31;return D===6}}function _(E,v,T,D){var B=h(E),V=0;V+=v;for(var W=0,j=0,$=!1,Q=0;V<B.length;){W=0;do{if(V>=B.length)break;Q=B[V++],W+=Q}while(Q===255);j=0;do{if(V>=B.length)break;Q=B[V++],j+=Q}while(Q===255);var Z=B.length-V;if(!$&&W===4&&V<B.length){$=!0;var ee=B[V++];if(ee===181){var ae=k(B,V);if(V+=2,ae===49){var se=x(B,V);if(V+=4,se===1195456820){var Y=B[V++];if(Y===3){var X=B[V++],q=31&X,re=64&X,ne=re?2+q*3:0,U=new Uint8Array(ne);if(re){U[0]=X;for(var H=1;H<ne;H++)U[H]=B[V++]}D.push({type:Y,payloadType:W,pts:T,bytes:U})}}}}}else if(W===5&&j<Z){if($=!0,j>16){for(var z=[],J=0;J<16;J++){var te=B[V++].toString(16);z.push(te.length==1?"0"+te:te),(J===3||J===5||J===7||J===9)&&z.push("-")}for(var ie=j-16,le=new Uint8Array(ie),oe=0;oe<ie;oe++)le[oe]=B[V++];D.push({payloadType:W,pts:T,uuid:z.join(""),userData:(0,F.utf8ArrayToStr)(le),userDataBytes:le})}}else if(j<Z)V+=j;else if(j>Z)break}}function h(E){for(var v=E.byteLength,T=[],D=1;D<v-2;)E[D]===0&&E[D+1]===0&&E[D+2]===3?(T.push(D+2),D+=2):D++;if(T.length===0)return E;var B=v-T.length,V=new Uint8Array(B),W=0;for(D=0;D<B;W++,D++)W===T[0]&&(W++,T.shift()),V[D]=E[W];return V}function A(E){var v=E[0],T="",D="",B=0,V=0,W=0,j=0,$=0,Q=0;if(v===0){for(;I(E.subarray(Q,Q+1))!=="\0";)T+=I(E.subarray(Q,Q+1)),Q+=1;for(T+=I(E.subarray(Q,Q+1)),Q+=1;I(E.subarray(Q,Q+1))!=="\0";)D+=I(E.subarray(Q,Q+1)),Q+=1;D+=I(E.subarray(Q,Q+1)),Q+=1,B=x(E,12),V=x(E,16),j=x(E,20),$=x(E,24),Q=28}else if(v===1){Q+=4,B=x(E,Q),Q+=4;var Z=x(E,Q);Q+=4;var ee=x(E,Q);for(Q+=4,W=Math.pow(2,32)*Z+ee,Number.isSafeInteger(W)||(W=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),j=x(E,Q),Q+=4,$=x(E,Q),Q+=4;I(E.subarray(Q,Q+1))!=="\0";)T+=I(E.subarray(Q,Q+1)),Q+=1;for(T+=I(E.subarray(Q,Q+1)),Q+=1;I(E.subarray(Q,Q+1))!=="\0";)D+=I(E.subarray(Q,Q+1)),Q+=1;D+=I(E.subarray(Q,Q+1)),Q+=1}var ae=E.subarray(Q,E.byteLength);return{schemeIdUri:T,value:D,timeScale:B,presentationTime:W,presentationTimeDelta:V,eventDuration:j,id:$,payload:ae}}},"./src/utils/output-filter.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});var N=function(){function S(M,K){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=K}var F=S.prototype;return F.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},F.newCue=function(K,w,I){(this.startTime===null||this.startTime>K)&&(this.startTime=K),this.endTime=w,this.screen=I,this.timelineController.createCaptionsTrack(this.trackName)},F.reset=function(){this.cueRanges=[],this.startTime=null},S}()},"./src/utils/texttrack-utils.ts":(b,P,m)=>{m.r(P),m.d(P,{addCueToTrack:()=>F,clearCurrentCues:()=>M,getCuesInRange:()=>I,removeCuesInRange:()=>K,sendAddTrackEvent:()=>S});var N=m("./src/utils/logger.ts");function S(k,x){var L;try{L=new Event("addtrack")}catch{L=document.createEvent("Event"),L.initEvent("addtrack",!1,!1)}L.track=k,x.dispatchEvent(L)}function F(k,x){var L=k.mode;if(L==="disabled"&&(k.mode="hidden"),k.cues&&!k.cues.getCueById(x.id))try{if(k.addCue(x),!k.cues.getCueById(x.id))throw new Error("addCue is failed for: "+x)}catch(O){N.logger.debug("[texttrack-utils]: "+O);var R=new self.TextTrackCue(x.startTime,x.endTime,x.text);R.id=x.id,k.addCue(R)}L==="disabled"&&(k.mode=L)}function M(k){var x=k.mode;if(x==="disabled"&&(k.mode="hidden"),k.cues)for(var L=k.cues.length;L--;)k.removeCue(k.cues[L]);x==="disabled"&&(k.mode=x)}function K(k,x,L,R){var O=k.mode;if(O==="disabled"&&(k.mode="hidden"),k.cues&&k.cues.length>0)for(var C=I(k.cues,x,L),y=0;y<C.length;y++)(!R||R(C[y]))&&k.removeCue(C[y]);O==="disabled"&&(k.mode=O)}function w(k,x){if(x<k[0].startTime)return 0;var L=k.length-1;if(x>k[L].endTime)return-1;for(var R=0,O=L;R<=O;){var C=Math.floor((O+R)/2);if(x<k[C].startTime)O=C-1;else if(x>k[C].startTime&&R<L)R=C+1;else return C}return k[R].startTime-x<x-k[O].startTime?R:O}function I(k,x,L){var R=[],O=w(k,x);if(O>-1)for(var C=O,y=k.length;C<y;C++){var u=k[C];if(u.startTime>=x&&u.endTime<=L)R.push(u);else if(u.startTime>L)return R}return R}},"./src/utils/time-ranges.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>S});var N={toString:function(M){for(var K="",w=M.length,I=0;I<w;I++)K+="["+M.start(I).toFixed(3)+","+M.end(I).toFixed(3)+"]";return K}};const S=N},"./src/utils/timescale-conversion.ts":(b,P,m)=>{m.r(P),m.d(P,{toMpegTsClockFromTimescale:()=>K,toMsFromMpegTsClock:()=>M,toTimescaleFromBase:()=>S,toTimescaleFromScale:()=>F});var N=9e4;function S(w,I,k,x){k===void 0&&(k=1),x===void 0&&(x=!1);var L=w*I*k;return x?Math.round(L):L}function F(w,I,k,x){return k===void 0&&(k=1),x===void 0&&(x=!1),S(w,I,1/k,x)}function M(w,I){return I===void 0&&(I=!1),S(w,1e3,1/N,I)}function K(w,I){return I===void 0&&(I=1),S(w,N,1/I)}},"./src/utils/typed-array.ts":(b,P,m)=>{m.r(P),m.d(P,{sliceUint8:()=>N});function N(S,F,M){return Uint8Array.prototype.slice?S.slice(F,M):new Uint8Array(Array.prototype.slice.call(S,F,M))}},"./src/utils/vttcue.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>N});const N=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var S=["","lr","rl"],F=["start","middle","end","left","right"];function M(x,L){if(typeof L!="string"||!Array.isArray(x))return!1;var R=L.toLowerCase();return~x.indexOf(R)?R:!1}function K(x){return M(S,x)}function w(x){return M(F,x)}function I(x){for(var L=arguments.length,R=new Array(L>1?L-1:0),O=1;O<L;O++)R[O-1]=arguments[O];for(var C=1;C<arguments.length;C++){var y=arguments[C];for(var u in y)x[u]=y[u]}return x}function k(x,L,R){var O=this,C={enumerable:!0};O.hasBeenReset=!1;var y="",u=!1,l=x,c=L,f=R,o=null,a="",s=!0,d="auto",p="start",_=50,h="middle",A=50,E="middle";Object.defineProperty(O,"id",I({},C,{get:function(){return y},set:function(T){y=""+T}})),Object.defineProperty(O,"pauseOnExit",I({},C,{get:function(){return u},set:function(T){u=!!T}})),Object.defineProperty(O,"startTime",I({},C,{get:function(){return l},set:function(T){if(typeof T!="number")throw new TypeError("Start time must be set to a number.");l=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"endTime",I({},C,{get:function(){return c},set:function(T){if(typeof T!="number")throw new TypeError("End time must be set to a number.");c=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"text",I({},C,{get:function(){return f},set:function(T){f=""+T,this.hasBeenReset=!0}})),Object.defineProperty(O,"region",I({},C,{get:function(){return o},set:function(T){o=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"vertical",I({},C,{get:function(){return a},set:function(T){var D=K(T);if(D===!1)throw new SyntaxError("An invalid or illegal string was specified.");a=D,this.hasBeenReset=!0}})),Object.defineProperty(O,"snapToLines",I({},C,{get:function(){return s},set:function(T){s=!!T,this.hasBeenReset=!0}})),Object.defineProperty(O,"line",I({},C,{get:function(){return d},set:function(T){if(typeof T!="number"&&T!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");d=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"lineAlign",I({},C,{get:function(){return p},set:function(T){var D=w(T);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");p=D,this.hasBeenReset=!0}})),Object.defineProperty(O,"position",I({},C,{get:function(){return _},set:function(T){if(T<0||T>100)throw new Error("Position must be between 0 and 100.");_=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"positionAlign",I({},C,{get:function(){return h},set:function(T){var D=w(T);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");h=D,this.hasBeenReset=!0}})),Object.defineProperty(O,"size",I({},C,{get:function(){return A},set:function(T){if(T<0||T>100)throw new Error("Size must be between 0 and 100.");A=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"align",I({},C,{get:function(){return E},set:function(T){var D=w(T);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");E=D,this.hasBeenReset=!0}})),O.displayState=void 0}return k.prototype.getCueAsHTML=function(){var x=self.WebVTT;return x.convertCueToDOMTree(self,this.text)},k}()},"./src/utils/vttparser.ts":(b,P,m)=>{m.r(P),m.d(P,{VTTParser:()=>L,fixLineBreaks:()=>x,parseTimeStamp:()=>F});var N=m("./src/utils/vttcue.ts"),S=function(){function R(){}var O=R.prototype;return O.decode=function(y,u){if(!y)return"";if(typeof y!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(y))},R}();function F(R){function O(y,u,l,c){return(y|0)*3600+(u|0)*60+(l|0)+parseFloat(c||0)}var C=R.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return C?parseFloat(C[2])>59?O(C[2],C[3],0,C[4]):O(C[1],C[2],C[3],C[4]):null}var M=function(){function R(){this.values=Object.create(null)}var O=R.prototype;return O.set=function(y,u){!this.get(y)&&u!==""&&(this.values[y]=u)},O.get=function(y,u,l){return l?this.has(y)?this.values[y]:u[l]:this.has(y)?this.values[y]:u},O.has=function(y){return y in this.values},O.alt=function(y,u,l){for(var c=0;c<l.length;++c)if(u===l[c]){this.set(y,u);break}},O.integer=function(y,u){/^-?\d+$/.test(u)&&this.set(y,parseInt(u,10))},O.percent=function(y,u){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(u)){var l=parseFloat(u);if(l>=0&&l<=100)return this.set(y,l),!0}return!1},R}();function K(R,O,C,y){var u=y?R.split(y):[R];for(var l in u)if(typeof u[l]=="string"){var c=u[l].split(C);if(c.length===2){var f=c[0],o=c[1];O(f,o)}}}var w=new N.default(0,0,""),I=w.align==="middle"?"middle":"center";function k(R,O,C){var y=R;function u(){var f=F(R);if(f===null)throw new Error("Malformed timestamp: "+y);return R=R.replace(/^[^\sa-zA-Z-]+/,""),f}function l(f,o){var a=new M;K(f,function(p,_){var h;switch(p){case"region":for(var A=C.length-1;A>=0;A--)if(C[A].id===_){a.set(p,C[A].region);break}break;case"vertical":a.alt(p,_,["rl","lr"]);break;case"line":h=_.split(","),a.integer(p,h[0]),a.percent(p,h[0])&&a.set("snapToLines",!1),a.alt(p,h[0],["auto"]),h.length===2&&a.alt("lineAlign",h[1],["start",I,"end"]);break;case"position":h=_.split(","),a.percent(p,h[0]),h.length===2&&a.alt("positionAlign",h[1],["start",I,"end","line-left","line-right","auto"]);break;case"size":a.percent(p,_);break;case"align":a.alt(p,_,["start",I,"end","left","right"]);break}},/:/,/\s/),o.region=a.get("region",null),o.vertical=a.get("vertical","");var s=a.get("line","auto");s==="auto"&&w.line===-1&&(s=-1),o.line=s,o.lineAlign=a.get("lineAlign","start"),o.snapToLines=a.get("snapToLines",!0),o.size=a.get("size",100),o.align=a.get("align",I);var d=a.get("position","auto");d==="auto"&&w.position===50&&(d=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=d}function c(){R=R.replace(/^\s+/,"")}if(c(),O.startTime=u(),c(),R.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+y);R=R.slice(3),c(),O.endTime=u(),c(),l(R,O)}function x(R){return R.replace(/<br(?: \/)?>/gi,`
`)}var L=function(){function R(){this.state="INITIAL",this.buffer="",this.decoder=new S,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var O=R.prototype;return O.parse=function(y){var u=this;y&&(u.buffer+=u.decoder.decode(y,{stream:!0}));function l(){var d=u.buffer,p=0;for(d=x(d);p<d.length&&d[p]!=="\r"&&d[p]!==`
`;)++p;var _=d.slice(0,p);return d[p]==="\r"&&++p,d[p]===`
`&&++p,u.buffer=d.slice(p),_}function c(d){K(d,function(p,_){},/:/)}try{var f="";if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;f=l();var o=f.match(/^()?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var a=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(a?a=!1:f=l(),u.state){case"HEADER":/:/.test(f)?c(f):f||(u.state="ID");continue;case"NOTE":f||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(f)){u.state="NOTE";break}if(!f)continue;if(u.cue=new N.default(0,0,""),u.state="CUE",f.indexOf("-->")===-1){u.cue.id=f;continue}case"CUE":if(!u.cue){u.state="BADCUE";continue}try{k(f,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":{var s=f.indexOf("-->")!==-1;if(!f||s&&(a=!0)){u.oncue&&u.cue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}if(u.cue===null)continue;u.cue.text&&(u.cue.text+=`
`),u.cue.text+=f}continue;case"BADCUE":f||(u.state="ID")}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},O.flush=function(){var y=this;try{if((y.cue||y.state==="HEADER")&&(y.buffer+=`

`,y.parse()),y.state==="INITIAL"||y.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(u){y.onparsingerror&&y.onparsingerror(u)}return y.onflush&&y.onflush(),this},R}()},"./src/utils/webvtt-parser.ts":(b,P,m)=>{m.r(P),m.d(P,{generateCueId:()=>L,parseWebVTT:()=>O});var N=m("./src/polyfills/number.ts"),S=m("./src/utils/vttparser.ts"),F=m("./src/demux/id3.ts"),M=m("./src/utils/timescale-conversion.ts"),K=m("./src/remux/mp4-remuxer.ts"),w=/\r\n|\n\r|\n|\r/g,I=function(y,u,l){return l===void 0&&(l=0),y.slice(l,l+u.length)===u},k=function(y){var u=parseInt(y.slice(-3)),l=parseInt(y.slice(-6,-4)),c=parseInt(y.slice(-9,-7)),f=y.length>9?parseInt(y.substring(0,y.indexOf(":"))):0;if(!(0,N.isFiniteNumber)(u)||!(0,N.isFiniteNumber)(l)||!(0,N.isFiniteNumber)(c)||!(0,N.isFiniteNumber)(f))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+y);return u+=1e3*l,u+=60*1e3*c,u+=60*60*1e3*f,u},x=function(y){for(var u=5381,l=y.length;l;)u=u*33^y.charCodeAt(--l);return(u>>>0).toString()};function L(C,y,u){return x(C.toString())+x(y.toString())+x(u)}var R=function(y,u,l){var c=y[u],f=y[c.prevCC];if(!f||!f.new&&c.new){y.ccOffset=y.presentationOffset=c.start,c.new=!1;return}for(;(o=f)!==null&&o!==void 0&&o.new;){var o;y.ccOffset+=c.start-f.start,c.new=!1,c=f,f=y[c.prevCC]}y.presentationOffset=l};function O(C,y,u,l,c,f,o,a){var s=new S.VTTParser,d=(0,F.utf8ArrayToStr)(new Uint8Array(C)).trim().replace(w,`
`).split(`
`),p=[],_=(0,M.toMpegTsClockFromTimescale)(y,u),h="00:00.000",A=0,E=0,v,T=!0;s.oncue=function(D){var B=l[c],V=l.ccOffset,W=(A-_)/9e4;B!=null&&B.new&&(E!==void 0?V=l.ccOffset=B.start:R(l,c,W)),W&&(V=W-l.presentationOffset);var j=D.endTime-D.startTime,$=(0,K.normalizePts)((D.startTime+V-E)*9e4,f*9e4)/9e4;D.startTime=Math.max($,0),D.endTime=Math.max($+j,0);var Q=D.text.trim();D.text=decodeURIComponent(encodeURIComponent(Q)),D.id||(D.id=L(D.startTime,D.endTime,Q)),D.endTime>0&&p.push(D)},s.onparsingerror=function(D){v=D},s.onflush=function(){if(v){a(v);return}o(p)},d.forEach(function(D){if(T)if(I(D,"X-TIMESTAMP-MAP=")){T=!1,D.slice(16).split(",").forEach(function(B){I(B,"LOCAL:")?h=B.slice(6):I(B,"MPEGTS:")&&(A=parseInt(B.slice(7)))});try{E=k(h)/1e3}catch(B){v=B}return}else D===""&&(T=!1);s.parse(D+`
`)}),s.flush()}},"./src/utils/xhr-loader.ts":(b,P,m)=>{m.r(P),m.d(P,{default:()=>K});var N=m("./src/utils/logger.ts"),S=m("./src/loader/load-stats.ts"),F=/^age:\s*[\d.]+\s*$/m,M=function(){function w(k){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=k?k.xhrSetup:null,this.stats=new S.LoadStats,this.retryDelay=0}var I=w.prototype;return I.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},I.abortInternal=function(){var x=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),x&&(x.onreadystatechange=null,x.onprogress=null,x.readyState!==4&&(this.stats.aborted=!0,x.abort()))},I.abort=function(){var x;this.abortInternal(),(x=this.callbacks)!==null&&x!==void 0&&x.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},I.load=function(x,L,R){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=x,this.config=L,this.callbacks=R,this.retryDelay=L.retryDelay,this.loadInternal()},I.loadInternal=function(){var x=this.config,L=this.context;if(x){var R=this.loader=new self.XMLHttpRequest,O=this.stats;O.loading.first=0,O.loaded=0;var C=this.xhrSetup;try{if(C)try{C(R,L.url)}catch{R.open("GET",L.url,!0),C(R,L.url)}R.readyState||R.open("GET",L.url,!0);var y=this.context.headers;if(y)for(var u in y)R.setRequestHeader(u,y[u])}catch(l){this.callbacks.onError({code:R.status,text:l.message},L,R);return}L.rangeEnd&&R.setRequestHeader("Range","bytes="+L.rangeStart+"-"+(L.rangeEnd-1)),R.onreadystatechange=this.readystatechange.bind(this),R.onprogress=this.loadprogress.bind(this),R.responseType=L.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),x.timeout),R.send()}},I.readystatechange=function(){var x=this.context,L=this.loader,R=this.stats;if(!(!x||!L)){var O=L.readyState,C=this.config;if(!R.aborted&&O>=2)if(self.clearTimeout(this.requestTimeout),R.loading.first===0&&(R.loading.first=Math.max(self.performance.now(),R.loading.start)),O===4){L.onreadystatechange=null,L.onprogress=null;var y=L.status,u=L.responseType==="arraybuffer";if(y>=200&&y<300&&(u&&L.response||L.responseText!==null)){R.loading.end=Math.max(self.performance.now(),R.loading.first);var l,c;if(u?(l=L.response,c=l.byteLength):(l=L.responseText,c=l.length),R.loaded=R.total=c,!this.callbacks)return;var f=this.callbacks.onProgress;if(f&&f(R,x,l,L),!this.callbacks)return;var o={url:L.responseURL,data:l};this.callbacks.onSuccess(o,R,x,L)}else R.retry>=C.maxRetry||y>=400&&y<499?(N.logger.error(y+" while loading "+x.url),this.callbacks.onError({code:y,text:L.statusText},x,L)):(N.logger.warn(y+" while loading "+x.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,C.maxRetryDelay),R.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),C.timeout)}},I.loadtimeout=function(){N.logger.warn("timeout while loading "+this.context.url);var x=this.callbacks;x&&(this.abortInternal(),x.onTimeout(this.stats,this.context,this.loader))},I.loadprogress=function(x){var L=this.stats;L.loaded=x.loaded,x.lengthComputable&&(L.total=x.total)},I.getCacheAge=function(){var x=null;if(this.loader&&F.test(this.loader.getAllResponseHeaders())){var L=this.loader.getResponseHeader("age");x=L?parseFloat(L):null}return x},w}();const K=M},"./node_modules/eventemitter3/index.js":b=>{var P=Object.prototype.hasOwnProperty,m="~";function N(){}Object.create&&(N.prototype=Object.create(null),new N().__proto__||(m=!1));function S(w,I,k){this.fn=w,this.context=I,this.once=k||!1}function F(w,I,k,x,L){if(typeof k!="function")throw new TypeError("The listener must be a function");var R=new S(k,x||w,L),O=m?m+I:I;return w._events[O]?w._events[O].fn?w._events[O]=[w._events[O],R]:w._events[O].push(R):(w._events[O]=R,w._eventsCount++),w}function M(w,I){--w._eventsCount===0?w._events=new N:delete w._events[I]}function K(){this._events=new N,this._eventsCount=0}K.prototype.eventNames=function(){var I=[],k,x;if(this._eventsCount===0)return I;for(x in k=this._events)P.call(k,x)&&I.push(m?x.slice(1):x);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(k)):I},K.prototype.listeners=function(I){var k=m?m+I:I,x=this._events[k];if(!x)return[];if(x.fn)return[x.fn];for(var L=0,R=x.length,O=new Array(R);L<R;L++)O[L]=x[L].fn;return O},K.prototype.listenerCount=function(I){var k=m?m+I:I,x=this._events[k];return x?x.fn?1:x.length:0},K.prototype.emit=function(I,k,x,L,R,O){var C=m?m+I:I;if(!this._events[C])return!1;var y=this._events[C],u=arguments.length,l,c;if(y.fn){switch(y.once&&this.removeListener(I,y.fn,void 0,!0),u){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,k),!0;case 3:return y.fn.call(y.context,k,x),!0;case 4:return y.fn.call(y.context,k,x,L),!0;case 5:return y.fn.call(y.context,k,x,L,R),!0;case 6:return y.fn.call(y.context,k,x,L,R,O),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];y.fn.apply(y.context,l)}else{var f=y.length,o;for(c=0;c<f;c++)switch(y[c].once&&this.removeListener(I,y[c].fn,void 0,!0),u){case 1:y[c].fn.call(y[c].context);break;case 2:y[c].fn.call(y[c].context,k);break;case 3:y[c].fn.call(y[c].context,k,x);break;case 4:y[c].fn.call(y[c].context,k,x,L);break;default:if(!l)for(o=1,l=new Array(u-1);o<u;o++)l[o-1]=arguments[o];y[c].fn.apply(y[c].context,l)}}return!0},K.prototype.on=function(I,k,x){return F(this,I,k,x,!1)},K.prototype.once=function(I,k,x){return F(this,I,k,x,!0)},K.prototype.removeListener=function(I,k,x,L){var R=m?m+I:I;if(!this._events[R])return this;if(!k)return M(this,R),this;var O=this._events[R];if(O.fn)O.fn===k&&(!L||O.once)&&(!x||O.context===x)&&M(this,R);else{for(var C=0,y=[],u=O.length;C<u;C++)(O[C].fn!==k||L&&!O[C].once||x&&O[C].context!==x)&&y.push(O[C]);y.length?this._events[R]=y.length===1?y[0]:y:M(this,R)}return this},K.prototype.removeAllListeners=function(I){var k;return I?(k=m?m+I:I,this._events[k]&&M(this,k)):(this._events=new N,this._eventsCount=0),this},K.prototype.off=K.prototype.removeListener,K.prototype.addListener=K.prototype.on,K.prefixed=m,K.EventEmitter=K,b.exports=K},"./node_modules/url-toolkit/src/url-toolkit.js":function(b){(function(P){var m=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,N=/^(?=([^\/?#]*))\1([^]*)$/,S=/(?:\/|^)\.(?=\/)/g,F=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,M={buildAbsoluteURL:function(K,w,I){if(I=I||{},K=K.trim(),w=w.trim(),!w){if(!I.alwaysNormalize)return K;var k=M.parseURL(K);if(!k)throw new Error("Error trying to parse base URL.");return k.path=M.normalizePath(k.path),M.buildURLFromParts(k)}var x=M.parseURL(w);if(!x)throw new Error("Error trying to parse relative URL.");if(x.scheme)return I.alwaysNormalize?(x.path=M.normalizePath(x.path),M.buildURLFromParts(x)):w;var L=M.parseURL(K);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var R=N.exec(L.path);L.netLoc=R[1],L.path=R[2]}L.netLoc&&!L.path&&(L.path="/");var O={scheme:L.scheme,netLoc:x.netLoc,path:null,params:x.params,query:x.query,fragment:x.fragment};if(!x.netLoc&&(O.netLoc=L.netLoc,x.path[0]!=="/"))if(!x.path)O.path=L.path,x.params||(O.params=L.params,x.query||(O.query=L.query));else{var C=L.path,y=C.substring(0,C.lastIndexOf("/")+1)+x.path;O.path=M.normalizePath(y)}return O.path===null&&(O.path=I.alwaysNormalize?M.normalizePath(x.path):x.path),M.buildURLFromParts(O)},parseURL:function(K){var w=m.exec(K);return w?{scheme:w[1]||"",netLoc:w[2]||"",path:w[3]||"",params:w[4]||"",query:w[5]||"",fragment:w[6]||""}:null},normalizePath:function(K){for(K=K.split("").reverse().join("").replace(S,"");K.length!==(K=K.replace(F,"")).length;);return K.split("").reverse().join("")},buildURLFromParts:function(K){return K.scheme+K.netLoc+K.path+K.params+K.query+K.fragment}};b.exports=M})()}},r={};function t(b){var P=r[b];if(P!==void 0)return P.exports;var m=r[b]={exports:{}};return i[b].call(m.exports,m,m.exports,t),m.exports}t.m=i,t.n=b=>{var P=b&&b.__esModule?()=>b.default:()=>b;return t.d(P,{a:P}),P},t.d=(b,P)=>{for(var m in P)t.o(P,m)&&!t.o(b,m)&&Object.defineProperty(b,m,{enumerable:!0,get:P[m]})},t.o=(b,P)=>Object.prototype.hasOwnProperty.call(b,P),t.r=b=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})};var g=t("./src/hls.ts");return g=g.default,g})())})(no);var De=id(no.exports),ad=Bt.now,sd=Bt.listContainsIgnoreCase,od=-1,ld=16;G.register("PLAYBACK_FRAGMENT_CHANGED");G.register("PLAYBACK_FRAGMENT_PARSING_METADATA");var io=function(e){jf(i,e);var n=Xf(i);function i(){var r;Vf(this,i);for(var t=arguments.length,g=new Array(t),b=0;b<t;b++)g[b]=arguments[b];return r=n.call.apply(n,[this].concat(g)),r.options.hlsPlayback=Bn(Bn({},r.defaultOptions),r.options.hlsPlayback),r._setInitialState(),r}return Gf(i,[{key:"name",get:function(){return"hls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return this._currentLevel===null||this._currentLevel===void 0?od:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(G.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"latency",get:function(){return this._hls.latency}},{key:"currentProgramDateTime",get:function(){return this._hls.playingDate}},{key:"_startTime",get:function(){return this._playbackType===me.LIVE&&this._playlistType!=="EVENT"?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return ad()}},{key:"_extrapolatedStartTime",get:function(){if(!this._localStartTimeCorrelation)return this._playableRegionStartTime;var t=this._localStartTimeCorrelation,g=this._now-t.local,b=(t.remote+g)/1e3;return Math.min(b,this._playableRegionStartTime+this._extrapolatedWindowDuration)}},{key:"_extrapolatedEndTime",get:function(){var t=this._playableRegionStartTime+this._playableRegionDuration;if(!this._localEndTimeCorrelation)return t;var g=this._localEndTimeCorrelation,b=this._now-g.local,P=(g.remote+b)/1e3;return Math.max(t-this._extrapolatedWindowDuration,Math.min(P,t))}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return this._segmentTargetDuration===null?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!0}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"sourceMedia",get:function(){return this.options.src}},{key:"currentTimestamp",get:function(){if(!this._currentFragment)return null;var t=this._currentFragment.programDateTime,g=this.el.currentTime,b=g-this._currentFragment.start,P=t+b*1e3;return P/1e3}},{key:"_setInitialState",value:function(){this._minDvrSize=typeof this.options.hlsMinimumDvrSize>"u"?60:this.options.hlsMinimumDvrSize,this._extrapolatedWindowNumSegments=!this.options.playback||typeof this.options.playback.extrapolatedWindowNumSegments>"u"?2:this.options.playback.extrapolatedWindowNumSegments,this._playbackType=me.VOD,this._lastTimeUpdate={current:0,total:0},this._lastDuration=null,this._playableRegionStartTime=0,this._localStartTimeCorrelation=null,this._localEndTimeCorrelation=null,this._playableRegionDuration=0,this._programDateTime=0,this._durationExcludesAfterLiveSyncPoint=!1,this._segmentTargetDuration=null,this._playlistType=null,this._recoverAttemptsRemaining=this.options.hlsRecoverAttempts||ld}},{key:"_setup",value:function(){this._destroyHLSInstance(),this._createHLSInstance(),this._listenHLSEvents(),this._attachHLSMedia()}},{key:"_destroyHLSInstance",value:function(){this._hls&&(this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._setInitialState(),this._hls.destroy(),this._hls=null)}},{key:"_createHLSInstance",value:function(){var t=Bn({},this.options.playback.hlsjsConfig);this._hls=new De(t)}},{key:"_attachHLSMedia",value:function(){this._hls&&this._hls.attachMedia(this.el)}},{key:"_listenHLSEvents",value:function(){var t=this;this._hls&&(this._hls.once(De.Events.MEDIA_ATTACHED,function(){t.options.hlsPlayback.preload&&t._hls.loadSource(t.options.src)}),this._hls.on(De.Events.MANIFEST_PARSED,function(){return t._manifestParsed=!0}),this._hls.on(De.Events.LEVEL_LOADED,function(g,b){return t._updatePlaybackType(g,b)}),this._hls.on(De.Events.LEVEL_UPDATED,function(g,b){return t._onLevelUpdated(g,b)}),this._hls.on(De.Events.LEVEL_SWITCHING,function(g,b){return t._onLevelSwitch(g,b)}),this._hls.on(De.Events.FRAG_CHANGED,function(g,b){return t._onFragmentChanged(g,b)}),this._hls.on(De.Events.FRAG_LOADED,function(g,b){return t._onFragmentLoaded(g,b)}),this._hls.on(De.Events.FRAG_PARSING_METADATA,function(g,b){return t._onFragmentParsingMetadata(g,b)}),this._hls.on(De.Events.ERROR,function(g,b){return t._onHLSJSError(g,b)}),this._hls.on(De.Events.SUBTITLE_TRACK_LOADED,function(g,b){return t._onSubtitleLoaded(g,b)}),this._hls.on(De.Events.SUBTITLE_TRACKS_UPDATED,function(){return t._ccTracksUpdated=!0}),this.bindCustomListeners())}},{key:"bindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(g){var b=g.eventName,P=g.once?"once":"on";b&&t._hls["".concat(P)](b,g.callback)})}},{key:"unbindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(g){var b=g.eventName;b&&t._hls.off(b,g.callback)})}},{key:"_onFragmentParsingMetadata",value:function(t,g){this.trigger(G.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:g})}},{key:"render",value:function(){return this._ready(),Dt(gt(i.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(!this._hls&&this._setup(),this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(t,g,b){if(!this._recoveredDecodingError)this._recoveredDecodingError=!0,this._hls.recoverMediaError();else if(!this._recoveredAudioCodecError)this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError();else{Ae.error("hlsjs: failed to recover",{evt:t,data:g}),b.level=ot.Levels.FATAL;var P=this.createError(b);this.trigger(G.PLAYBACK_ERROR,P),this.stop()}}},{key:"_setupSrc",value:function(t){}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval(function(){t._onDurationChange(),t._onTimeUpdate()},100))}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(t){var g=t>0?this._duration*(t/100):this._duration;this.seek(g)}},{key:"seek",value:function(t){t<0&&(Ae.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this._startTime,this.el.currentTime=t}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function(){this._playbackType===me.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(t,g){var b={code:"".concat(g.type,"_").concat(g.details),description:"".concat(this.name," error: type: ").concat(g.type,", details: ").concat(g.details),raw:g},P;if(g.response&&(b.description+=", response: ".concat(JSON.stringify(g.response))),g.fatal)if(this._recoverAttemptsRemaining>0)switch(this._recoverAttemptsRemaining-=1,g.type){case De.ErrorTypes.NETWORK_ERROR:switch(g.details){case De.ErrorDetails.MANIFEST_LOAD_ERROR:case De.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case De.ErrorDetails.MANIFEST_PARSING_ERROR:case De.ErrorDetails.LEVEL_LOAD_ERROR:case De.ErrorDetails.LEVEL_LOAD_TIMEOUT:Ae.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:g}),P=this.createError(b),this.trigger(G.PLAYBACK_ERROR,P),this.stop();break;default:Ae.warn("hlsjs: trying to recover from network error.",{evt:t,data:g}),b.level=ot.Levels.WARN,this._hls.startLoad();break}break;case De.ErrorTypes.MEDIA_ERROR:Ae.warn("hlsjs: trying to recover from media error.",{evt:t,data:g}),b.level=ot.Levels.WARN,this._recover(t,g,b);break;default:Ae.error("hlsjs: could not recover from error.",{evt:t,data:g}),P=this.createError(b),this.trigger(G.PLAYBACK_ERROR,P),this.stop();break}else Ae.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:g}),P=this.createError(b),this.trigger(G.PLAYBACK_ERROR,P),this.stop();else{if(this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(g)){Ae.error("hlsjs: could not load decrypt key.",{evt:t,data:g}),P=this.createError(b),this.trigger(G.PLAYBACK_ERROR,P),this.stop();return}b.level=ot.Levels.WARN,Ae.warn("hlsjs: non-fatal error occurred",{evt:t,data:g})}}},{key:"_keyIsDenied",value:function(t){return t.type===De.ErrorTypes.NETWORK_ERROR&&t.details===De.ErrorDetails.KEY_LOAD_ERROR&&t.response&&t.response.code>=400}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},g=this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total;g||(this._lastTimeUpdate=t,this.trigger(G.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,Dt(gt(i.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],g=0,b=0;b<this.el.buffered.length;b++)t=[].concat(Zf(t),[{start:Math.max(0,this.el.buffered.start(b)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(b)-this._playableRegionStartTime)}]),this.el.currentTime>=t[b].start&&this.el.currentTime<=t[b].end&&(g=b);var P={start:t[g].start,current:t[g].end,total:this.getDuration()};this.trigger(G.PLAYBACK_PROGRESS,P,t)}}},{key:"load",value:function(t){this._stopTimeUpdateTimer(),this.options.src=t,this._setup()}},{key:"play",value:function(){!this._hls&&this._setup(),!this._manifestParsed&&!this.options.hlsPlayback.preload&&this._hls.loadSource(this.options.src),Dt(gt(i.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){this._hls&&(this.el.pause(),this.dvrEnabled&&this._updateDvr(!0))}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&Dt(gt(i.prototype),"stop",this).call(this),this._destroyHLSInstance()}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._destroyHLSInstance(),Dt(gt(i.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(t,g){this._playbackType=g.details.live?me.LIVE:me.VOD,this._onLevelUpdated(t,g),this._ccTracksUpdated&&this._playbackType===me.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map(function(t,g){return{id:g,level:t,label:"".concat(t.bitrate/1e3,"Kbps")}}),this.trigger(G.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(t,g){this._segmentTargetDuration=g.details.targetduration,this._playlistType=g.details.type||null;var b=!1,P=!1,m=g.details.fragments,N=this._playableRegionStartTime,S=this._playableRegionDuration;if(m.length!==0){if(m[0].rawProgramDateTime&&(this._programDateTime=m[0].rawProgramDateTime),this._playableRegionStartTime!==m[0].start&&(b=!0,this._playableRegionStartTime=m[0].start),b)if(!this._localStartTimeCorrelation)this._localStartTimeCorrelation={local:this._now,remote:(m[0].start+this._extrapolatedWindowDuration/2)*1e3};else{var F=this._localStartTimeCorrelation,M=this._now-F.local,K=(F.remote+M)/1e3;K<m[0].start?this._localStartTimeCorrelation={local:this._now,remote:m[0].start*1e3}:K>N+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:Math.max(m[0].start,N+this._extrapolatedWindowDuration)*1e3})}var w=g.details.totalduration;if(this._playbackType===me.LIVE){var I=g.details.targetduration,k=this.options.playback.hlsjsConfig||{},x=k.liveSyncDurationCount||De.DefaultConfig.liveSyncDurationCount,L=I*x;L<=w?(w-=L,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1}w!==this._playableRegionDuration&&(P=!0,this._playableRegionDuration=w);var R=m[0].start+w,O=N+S,C=R!==O;if(C)if(!this._localEndTimeCorrelation)this._localEndTimeCorrelation={local:this._now,remote:R*1e3};else{var y=this._localEndTimeCorrelation,u=this._now-y.local,l=(y.remote+u)/1e3;l>R?this._localEndTimeCorrelation={local:this._now,remote:R*1e3}:l<R-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:(R-this._extrapolatedWindowDuration)*1e3}:l>O&&(this._localEndTimeCorrelation={local:this._now,remote:O*1e3})}P&&this._onDurationChange(),b&&this._onProgress()}}},{key:"_onFragmentChanged",value:function(t,g){this._currentFragment=g.frag,this.trigger(G.Custom.PLAYBACK_FRAGMENT_CHANGED,g)}},{key:"_onFragmentLoaded",value:function(t,g){this.trigger(G.PLAYBACK_FRAGMENT_LOADED,g)}},{key:"_onSubtitleLoaded",value:function(){if(!this._ccIsSetup){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this._playbackType===me.LIVE?-1:this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this._ccIsSetup=!0}}},{key:"_onLevelSwitch",value:function(t,g){this.levels.length||this._fillLevels(),this.trigger(G.PLAYBACK_LEVEL_SWITCH_END),this.trigger(G.PLAYBACK_LEVEL_SWITCH,g);var b=this._hls.levels[g.level];b&&(this.highDefinition=b.height>=720||b.bitrate/1e3>=2e3,this.trigger(G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(G.PLAYBACK_BITRATE,{height:b.height,width:b.width,bandwidth:b.bitrate,bitrate:b.bitrate,level:g.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===me.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===me.VOD||this.dvrEnabled}}],[{key:"HLSJS",get:function(){return De}}]),i}(pt);io.canPlay=function(e,n){var i=e.split("?")[0].match(/.*\.(.*)$/)||[],r=i.length>1&&i[1].toLowerCase()==="m3u8"||sd(n,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!!(De.isSupported()&&r)};/*!
 * v-clappr v3.4.0
 * Vue.js wrapper for Clappr
 * (c) 2024 Vinayak Kulkarni<inbox.vinayak@gmail.com>
 * Released under the MIT License
 */const ud=["id"],cd=Ti({__name:"VClappr",props:{el:{type:String,required:!0,default:"player"},elModifiers:{},source:{type:String,required:!0},sourceModifiers:{},options:{type:Object,required:!1,default:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},dashShakaConfig:{}},poster:"https://picsum.photos/3840/2160"}},optionsModifiers:{}},emits:xl(["init","ready","resize","play","pause","stop","ended","seek","error","time-updated","volume-updated","subtitle-available"],["update:el","update:source","update:options"]),setup(e,{emit:n}){const i=n,r=Dn(e,"el"),t=Dn(e,"source"),g=Dn(e,"options"),b=el(null);ds(async()=>{await P()}),hs(()=>{var m;(m=b.value)==null||m.destroy(),b.value=null}),Jr(b,()=>{b.value&&i("init",b.value)});const P=async()=>new Promise((m,N)=>{r.value?(b.value=new Zs({parentId:`#${r.value}`,source:t.value,plugins:[ii,vf,yf,Ra,Ma,ka,cf,mf,Tf,Sf,xf,Mf,Ff,Ra,ka,Ma,io],events:{onReady:S=>{i("ready",S)},onResize:S=>{i("resize",S)},onPlay:()=>{i("play",!0)},onPause:()=>{i("pause",!0)},onStop:S=>{i("stop",S)},onEnded:()=>{i("ended",!0)},onSeek:S=>{i("seek",S)},onError:S=>{i("error",S)},onTimeUpdate:S=>{i("time-updated",S)},onVolumeUpdate:S=>{i("volume-updated",S)},onSubtitleAvailable:S=>{i("subtitle-available",S)}},...g.value}),m("Player created!")):N(new Error("Root element not found"))});return(m,N)=>(ur(),Ir("div",{id:r.value},null,8,ud))}}),fd=e=>(os("data-v-df96a186"),e=e(),ls(),e),dd={class:"w-screen h-screen bg-gradient-49"},hd=fd(()=>ut("div",{class:"absolute bottom-4 right-4"},[ut("a",{href:"https://app.netlify.com/sites/v-clappr/deploys","aria-label":"View deploys on Netlify",target:"_blank",rel:"noopener noreferrer",class:"gray-400"},[ut("img",{src:"https://www.netlify.com/img/global/badges/netlify-color-accent.svg",alt:"Deploys by Netlify"})])],-1)),vd=Ti({__name:"App",setup(e){const n=fn({clappr:null,source:"https://download.samplelib.com/mp4/sample-30s.mp4",poster:"http://clappr.io/poster.png",options:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}}}}),i=K=>{console.log("onInit Event: ",K),n.clappr=K},r=K=>{console.log("onResize Event: ",K)},t=K=>{console.log("onPlay Event: ",K)},g=K=>{console.log("onPause Event: ",K)},b=K=>{console.log("onStop Event: ",K)},P=K=>{console.log("onEnded Event: ",K)},m=K=>{console.log("onSeek Event: ",K)},N=K=>{console.log("onError Event: ",K)},S=K=>{console.log("onTimeUpdate Event: ",K)},F=K=>{console.log("onVolumeUpdate Event: ",K)},M=K=>{console.log("onSubtitleAvailable Event: ",K)};return(K,w)=>(ur(),Ir("main",dd,[ct(Gn(ac),{url:"https://github.com/vinayakkulkarni/v-clappr"}),ct(Gn(cd),{el:"player",source:n.source,options:n.options,class:"mx-auto w-1/2 h-full",onInit:i,onResize:r,onPlay:t,onPause:g,onStop:b,onEnded:P,onSeek:m,onError:N,onTimeUpdated:S,onVolumeUpdated:F,onSubtitleAvailable:M},null,8,["source","options"]),hd]))}}),gd=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},pd=gd(vd,[["__scopeId","data-v-df96a186"]]);Hu(pd).mount("#app");
