(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const f of t)if(f.type==="childList")for(const b of f.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function i(t){const f={};return t.integrity&&(f.integrity=t.integrity),t.referrerPolicy&&(f.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?f.credentials="include":t.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(t){if(t.ep)return;t.ep=!0;const f=i(t);fetch(t.href,f)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function oi(e,n){const i=new Set(e.split(","));return n?r=>i.has(r.toLowerCase()):r=>i.has(r)}const Pe={},ar=[],tt=()=>{},oo=()=>!1,an=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),li=e=>e.startsWith("onUpdate:"),Ue=Object.assign,ui=(e,n)=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)},lo=Object.prototype.hasOwnProperty,_e=(e,n)=>lo.call(e,n),ye=Array.isArray,Tr=e=>on(e)==="[object Map]",uo=e=>on(e)==="[object Set]",me=e=>typeof e=="function",Ke=e=>typeof e=="string",sn=e=>typeof e=="symbol",ke=e=>e!==null&&typeof e=="object",Na=e=>(ke(e)||me(e))&&me(e.then)&&me(e.catch),co=Object.prototype.toString,on=e=>co.call(e),fo=e=>on(e).slice(8,-1),ho=e=>on(e)==="[object Object]",ci=e=>Ke(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,br=oi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ln=e=>{const n=Object.create(null);return i=>n[i]||(n[i]=e(i))},vo=/-(\w)/g,mt=ln(e=>e.replace(vo,(n,i)=>i?i.toUpperCase():"")),go=/\B([A-Z])/g,pr=ln(e=>e.replace(go,"-$1").toLowerCase()),un=ln(e=>e.charAt(0).toUpperCase()+e.slice(1)),xn=ln(e=>e?`on${un(e)}`:""),It=(e,n)=>!Object.is(e,n),Cn=(e,n)=>{for(let i=0;i<e.length;i++)e[i](n)},Jr=(e,n,i)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value:i})},po=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let Ri;const Fa=()=>Ri||(Ri=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Pr(e){if(ye(e)){const n={};for(let i=0;i<e.length;i++){const r=e[i],t=Ke(r)?Ao(r):Pr(r);if(t)for(const f in t)n[f]=t[f]}return n}else if(Ke(e)||ke(e))return e}const mo=/;(?![^(]*\))/g,yo=/:([^]+)/,Eo=/\/\*[^]*?\*\//g;function Ao(e){const n={};return e.replace(Eo,"").split(mo).forEach(i=>{if(i){const r=i.split(yo);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function fi(e){let n="";if(Ke(e))n=e;else if(ye(e))for(let i=0;i<e.length;i++){const r=fi(e[i]);r&&(n+=r+" ")}else if(ke(e))for(const i in e)e[i]&&(n+=i+" ");return n.trim()}const _o="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",To=oi(_o);function Ba(e){return!!e||e===""}/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let it;class bo{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=it,!n&&it&&(this.index=(it.scopes||(it.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const i=it;try{return it=this,n()}finally{it=i}}}on(){it=this}off(){it=this.parent}stop(n){if(this._active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!n){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}function So(e,n=it){n&&n.active&&n.effects.push(e)}function xo(){return it}let $t;class di{constructor(n,i,r,t){this.fn=n,this.trigger=i,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,So(this,t)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Jt();for(let n=0;n<this._depsLength;n++){const i=this.deps[n];if(i.computed&&(Co(i.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),qt()}return this._dirtyLevel>=4}set dirty(n){this._dirtyLevel=n?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=Dt,i=$t;try{return Dt=!0,$t=this,this._runnings++,ki(this),this.fn()}finally{Mi(this),this._runnings--,$t=i,Dt=n}}stop(){var n;this.active&&(ki(this),Mi(this),(n=this.onStop)==null||n.call(this),this.active=!1)}}function Co(e){return e.value}function ki(e){e._trackId++,e._depsLength=0}function Mi(e){if(e.deps.length>e._depsLength){for(let n=e._depsLength;n<e.deps.length;n++)Ua(e.deps[n],e);e.deps.length=e._depsLength}}function Ua(e,n){const i=e.get(n);i!==void 0&&n._trackId!==i&&(e.delete(n),e.size===0&&e.cleanup())}let Dt=!0,Kn=0;const Ka=[];function Jt(){Ka.push(Dt),Dt=!1}function qt(){const e=Ka.pop();Dt=e===void 0?!0:e}function hi(){Kn++}function vi(){for(Kn--;!Kn&&Wn.length;)Wn.shift()()}function Wa(e,n,i){if(n.get(e)!==e._trackId){n.set(e,e._trackId);const r=e.deps[e._depsLength];r!==n?(r&&Ua(r,e),e.deps[e._depsLength++]=n):e._depsLength++}}const Wn=[];function Va(e,n,i){hi();for(const r of e.keys()){let t;r._dirtyLevel<n&&(t??(t=e.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=n),r._shouldSchedule&&(t??(t=e.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Wn.push(r.scheduler)))}vi()}const Ga=(e,n)=>{const i=new Map;return i.cleanup=e,i.computed=n,i},Vn=new WeakMap,zt=Symbol(""),Gn=Symbol("");function Ye(e,n,i){if(Dt&&$t){let r=Vn.get(e);r||Vn.set(e,r=new Map);let t=r.get(i);t||r.set(i,t=Ga(()=>r.delete(i))),Wa($t,t)}}function Tt(e,n,i,r,t,f){const b=Vn.get(e);if(!b)return;let D=[];if(n==="clear")D=[...b.values()];else if(i==="length"&&ye(e)){const m=Number(r);b.forEach((N,x)=>{(x==="length"||!sn(x)&&x>=m)&&D.push(N)})}else switch(i!==void 0&&D.push(b.get(i)),n){case"add":ye(e)?ci(i)&&D.push(b.get("length")):(D.push(b.get(zt)),Tr(e)&&D.push(b.get(Gn)));break;case"delete":ye(e)||(D.push(b.get(zt)),Tr(e)&&D.push(b.get(Gn)));break;case"set":Tr(e)&&D.push(b.get(zt));break}hi();for(const m of D)m&&Va(m,4);vi()}const Lo=oi("__proto__,__v_isRef,__isVue"),Ha=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(sn)),wi=Po();function Po(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...i){const r=be(this);for(let f=0,b=this.length;f<b;f++)Ye(r,"get",f+"");const t=r[n](...i);return t===-1||t===!1?r[n](...i.map(be)):t}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...i){Jt(),hi();const r=be(this)[n].apply(this,i);return vi(),qt(),r}}),e}function Do(e){const n=be(this);return Ye(n,"has",e),n.hasOwnProperty(e)}class ja{constructor(n=!1,i=!1){this._isReadonly=n,this._isShallow=i}get(n,i,r){const t=this._isReadonly,f=this._isShallow;if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return f;if(i==="__v_raw")return r===(t?f?Vo:Xa:f?za:$a).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const b=ye(n);if(!t){if(b&&_e(wi,i))return Reflect.get(wi,i,r);if(i==="hasOwnProperty")return Do}const D=Reflect.get(n,i,r);return(sn(i)?Ha.has(i):Lo(i))||(t||Ye(n,"get",i),f)?D:$e(D)?b&&ci(i)?D:D.value:ke(D)?t?Qa(D):fn(D):D}}class Ya extends ja{constructor(n=!1){super(!1,n)}set(n,i,r,t){let f=n[i];if(!this._isShallow){const m=fr(f);if(!qr(r)&&!fr(r)&&(f=be(f),r=be(r)),!ye(n)&&$e(f)&&!$e(r))return m?!1:(f.value=r,!0)}const b=ye(n)&&ci(i)?Number(i)<n.length:_e(n,i),D=Reflect.set(n,i,r,t);return n===be(t)&&(b?It(r,f)&&Tt(n,"set",i,r):Tt(n,"add",i,r)),D}deleteProperty(n,i){const r=_e(n,i);n[i];const t=Reflect.deleteProperty(n,i);return t&&r&&Tt(n,"delete",i,void 0),t}has(n,i){const r=Reflect.has(n,i);return(!sn(i)||!Ha.has(i))&&Ye(n,"has",i),r}ownKeys(n){return Ye(n,"iterate",ye(n)?"length":zt),Reflect.ownKeys(n)}}class Oo extends ja{constructor(n=!1){super(!0,n)}set(n,i){return!0}deleteProperty(n,i){return!0}}const Io=new Ya,Ro=new Oo,ko=new Ya(!0),gi=e=>e,cn=e=>Reflect.getPrototypeOf(e);function Br(e,n,i=!1,r=!1){e=e.__v_raw;const t=be(e),f=be(n);i||(It(n,f)&&Ye(t,"get",n),Ye(t,"get",f));const{has:b}=cn(t),D=r?gi:i?yi:Dr;if(b.call(t,n))return D(e.get(n));if(b.call(t,f))return D(e.get(f));e!==t&&e.get(n)}function Ur(e,n=!1){const i=this.__v_raw,r=be(i),t=be(e);return n||(It(e,t)&&Ye(r,"has",e),Ye(r,"has",t)),e===t?i.has(e):i.has(e)||i.has(t)}function Kr(e,n=!1){return e=e.__v_raw,!n&&Ye(be(e),"iterate",zt),Reflect.get(e,"size",e)}function Ni(e){e=be(e);const n=be(this);return cn(n).has.call(n,e)||(n.add(e),Tt(n,"add",e,e)),this}function Fi(e,n){n=be(n);const i=be(this),{has:r,get:t}=cn(i);let f=r.call(i,e);f||(e=be(e),f=r.call(i,e));const b=t.call(i,e);return i.set(e,n),f?It(n,b)&&Tt(i,"set",e,n):Tt(i,"add",e,n),this}function Bi(e){const n=be(this),{has:i,get:r}=cn(n);let t=i.call(n,e);t||(e=be(e),t=i.call(n,e)),r&&r.call(n,e);const f=n.delete(e);return t&&Tt(n,"delete",e,void 0),f}function Ui(){const e=be(this),n=e.size!==0,i=e.clear();return n&&Tt(e,"clear",void 0,void 0),i}function Wr(e,n){return function(r,t){const f=this,b=f.__v_raw,D=be(b),m=n?gi:e?yi:Dr;return!e&&Ye(D,"iterate",zt),b.forEach((N,x)=>r.call(t,m(N),m(x),f))}}function Vr(e,n,i){return function(...r){const t=this.__v_raw,f=be(t),b=Tr(f),D=e==="entries"||e===Symbol.iterator&&b,m=e==="keys"&&b,N=t[e](...r),x=i?gi:n?yi:Dr;return!n&&Ye(f,"iterate",m?Gn:zt),{next(){const{value:F,done:M}=N.next();return M?{value:F,done:M}:{value:D?[x(F[0]),x(F[1])]:x(F),done:M}},[Symbol.iterator](){return this}}}}function St(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function Mo(){const e={get(f){return Br(this,f)},get size(){return Kr(this)},has:Ur,add:Ni,set:Fi,delete:Bi,clear:Ui,forEach:Wr(!1,!1)},n={get(f){return Br(this,f,!1,!0)},get size(){return Kr(this)},has:Ur,add:Ni,set:Fi,delete:Bi,clear:Ui,forEach:Wr(!1,!0)},i={get(f){return Br(this,f,!0)},get size(){return Kr(this,!0)},has(f){return Ur.call(this,f,!0)},add:St("add"),set:St("set"),delete:St("delete"),clear:St("clear"),forEach:Wr(!0,!1)},r={get(f){return Br(this,f,!0,!0)},get size(){return Kr(this,!0)},has(f){return Ur.call(this,f,!0)},add:St("add"),set:St("set"),delete:St("delete"),clear:St("clear"),forEach:Wr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{e[f]=Vr(f,!1,!1),i[f]=Vr(f,!0,!1),n[f]=Vr(f,!1,!0),r[f]=Vr(f,!0,!0)}),[e,i,n,r]}const[wo,No,Fo,Bo]=Mo();function pi(e,n){const i=n?e?Bo:Fo:e?No:wo;return(r,t,f)=>t==="__v_isReactive"?!e:t==="__v_isReadonly"?e:t==="__v_raw"?r:Reflect.get(_e(i,t)&&t in r?i:r,t,f)}const Uo={get:pi(!1,!1)},Ko={get:pi(!1,!0)},Wo={get:pi(!0,!1)},$a=new WeakMap,za=new WeakMap,Xa=new WeakMap,Vo=new WeakMap;function Go(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ho(e){return e.__v_skip||!Object.isExtensible(e)?0:Go(fo(e))}function fn(e){return fr(e)?e:mi(e,!1,Io,Uo,$a)}function jo(e){return mi(e,!1,ko,Ko,za)}function Qa(e){return mi(e,!0,Ro,Wo,Xa)}function mi(e,n,i,r,t){if(!ke(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const f=t.get(e);if(f)return f;const b=Ho(e);if(b===0)return e;const D=new Proxy(e,b===2?r:i);return t.set(e,D),D}function sr(e){return fr(e)?sr(e.__v_raw):!!(e&&e.__v_isReactive)}function fr(e){return!!(e&&e.__v_isReadonly)}function qr(e){return!!(e&&e.__v_isShallow)}function Za(e){return sr(e)||fr(e)}function be(e){const n=e&&e.__v_raw;return n?be(n):e}function Ja(e){return Object.isExtensible(e)&&Jr(e,"__v_skip",!0),e}const Dr=e=>ke(e)?fn(e):e,yi=e=>ke(e)?Qa(e):e;class qa{constructor(n,i,r,t){this.getter=n,this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new di(()=>n(this._value),()=>$r(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!t,this.__v_isReadonly=r}get value(){const n=be(this);return(!n._cacheable||n.effect.dirty)&&It(n._value,n._value=n.effect.run())&&$r(n,4),es(n),n.effect._dirtyLevel>=2&&$r(n,2),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function Yo(e,n,i=!1){let r,t;const f=me(e);return f?(r=e,t=tt):(r=e.get,t=e.set),new qa(r,t,f||!t,i)}function es(e){var n;Dt&&$t&&(e=be(e),Wa($t,(n=e.dep)!=null?n:e.dep=Ga(()=>e.dep=void 0,e instanceof qa?e:void 0)))}function $r(e,n=4,i){e=be(e);const r=e.dep;r&&Va(r,n)}function $e(e){return!!(e&&e.__v_isRef===!0)}function $o(e){return zo(e,!1)}function zo(e,n){return $e(e)?e:new Xo(e,n)}class Xo{constructor(n,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?n:be(n),this._value=i?n:Dr(n)}get value(){return es(this),this._value}set value(n){const i=this.__v_isShallow||qr(n)||fr(n);n=i?n:be(n),It(n,this._rawValue)&&(this._rawValue=n,this._value=i?n:Dr(n),$r(this,4))}}function Qo(e){return $e(e)?e.value:e}const Zo={get:(e,n,i)=>Qo(Reflect.get(e,n,i)),set:(e,n,i,r)=>{const t=e[n];return $e(t)&&!$e(i)?(t.value=i,!0):Reflect.set(e,n,i,r)}};function ts(e){return sr(e)?e:new Proxy(e,Zo)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ot(e,n,i,r){try{return r?e(...r):e()}catch(t){dn(t,n,i)}}function lt(e,n,i,r){if(me(e)){const f=Ot(e,n,i,r);return f&&Na(f)&&f.catch(b=>{dn(b,n,i)}),f}const t=[];for(let f=0;f<e.length;f++)t.push(lt(e[f],n,i,r));return t}function dn(e,n,i,r=!0){const t=n?n.vnode:null;if(n){let f=n.parent;const b=n.proxy,D=`https://vuejs.org/error-reference/#runtime-${i}`;for(;f;){const N=f.ec;if(N){for(let x=0;x<N.length;x++)if(N[x](e,b,D)===!1)return}f=f.parent}const m=n.appContext.config.errorHandler;if(m){Ot(m,null,10,[e,b,D]);return}}Jo(e,i,t,r)}function Jo(e,n,i,r=!0){console.error(e)}let Or=!1,Hn=!1;const Ve=[];let vt=0;const or=[];let xt=null,Ht=0;const rs=Promise.resolve();let Ei=null;function qo(e){const n=Ei||rs;return e?n.then(this?e.bind(this):e):n}function el(e){let n=vt+1,i=Ve.length;for(;n<i;){const r=n+i>>>1,t=Ve[r],f=Ir(t);f<e||f===e&&t.pre?n=r+1:i=r}return n}function Ai(e){(!Ve.length||!Ve.includes(e,Or&&e.allowRecurse?vt+1:vt))&&(e.id==null?Ve.push(e):Ve.splice(el(e.id),0,e),ns())}function ns(){!Or&&!Hn&&(Hn=!0,Ei=rs.then(as))}function tl(e){const n=Ve.indexOf(e);n>vt&&Ve.splice(n,1)}function rl(e){ye(e)?or.push(...e):(!xt||!xt.includes(e,e.allowRecurse?Ht+1:Ht))&&or.push(e),ns()}function Ki(e,n,i=Or?vt+1:0){for(;i<Ve.length;i++){const r=Ve[i];if(r&&r.pre){if(e&&r.id!==e.uid)continue;Ve.splice(i,1),i--,r()}}}function is(e){if(or.length){const n=[...new Set(or)].sort((i,r)=>Ir(i)-Ir(r));if(or.length=0,xt){xt.push(...n);return}for(xt=n,Ht=0;Ht<xt.length;Ht++)xt[Ht]();xt=null,Ht=0}}const Ir=e=>e.id==null?1/0:e.id,nl=(e,n)=>{const i=Ir(e)-Ir(n);if(i===0){if(e.pre&&!n.pre)return-1;if(n.pre&&!e.pre)return 1}return i};function as(e){Hn=!1,Or=!0,Ve.sort(nl);try{for(vt=0;vt<Ve.length;vt++){const n=Ve[vt];n&&n.active!==!1&&Ot(n,null,14)}}finally{vt=0,Ve.length=0,is(),Or=!1,Ei=null,(Ve.length||or.length)&&as()}}function il(e,n,...i){if(e.isUnmounted)return;const r=e.vnode.props||Pe;let t=i;const f=n.startsWith("update:"),b=f&&n.slice(7);if(b&&b in r){const x=`${b==="modelValue"?"model":b}Modifiers`,{number:F,trim:M}=r[x]||Pe;M&&(t=i.map(K=>Ke(K)?K.trim():K)),F&&(t=i.map(po))}let D,m=r[D=xn(n)]||r[D=xn(mt(n))];!m&&f&&(m=r[D=xn(pr(n))]),m&&lt(m,e,6,t);const N=r[D+"Once"];if(N){if(!e.emitted)e.emitted={};else if(e.emitted[D])return;e.emitted[D]=!0,lt(N,e,6,t)}}function ss(e,n,i=!1){const r=n.emitsCache,t=r.get(e);if(t!==void 0)return t;const f=e.emits;let b={},D=!1;if(!me(e)){const m=N=>{const x=ss(N,n,!0);x&&(D=!0,Ue(b,x))};!i&&n.mixins.length&&n.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}return!f&&!D?(ke(e)&&r.set(e,null),null):(ye(f)?f.forEach(m=>b[m]=null):Ue(b,f),ke(e)&&r.set(e,b),b)}function hn(e,n){return!e||!an(n)?!1:(n=n.slice(2).replace(/Once$/,""),_e(e,n[0].toLowerCase()+n.slice(1))||_e(e,pr(n))||_e(e,n))}let at=null,vn=null;function en(e){const n=at;return at=e,vn=e&&e.type.__scopeId||null,n}function al(e){vn=e}function sl(){vn=null}function ol(e,n=at,i){if(!n||e._n)return e;const r=(...t)=>{r._d&&Ji(-1);const f=en(n);let b;try{b=e(...t)}finally{en(f),r._d&&Ji(1)}return b};return r._n=!0,r._c=!0,r._d=!0,r}function Ln(e){const{type:n,vnode:i,proxy:r,withProxy:t,props:f,propsOptions:[b],slots:D,attrs:m,emit:N,render:x,renderCache:F,data:M,setupState:K,ctx:w,inheritAttrs:I}=e;let k,S;const L=en(e);try{if(i.shapeFlag&4){const O=t||r,C=O;k=ht(x.call(C,O,F,f,K,M,w)),S=m}else{const O=n;k=ht(O.length>1?O(f,{attrs:m,slots:D,emit:N}):O(f,null)),S=n.props?m:ll(m)}}catch(O){Cr.length=0,dn(O,e,1),k=ct(Xt)}let R=k;if(S&&I!==!1){const O=Object.keys(S),{shapeFlag:C}=R;O.length&&C&7&&(b&&O.some(li)&&(S=ul(S,b)),R=dr(R,S))}return i.dirs&&(R=dr(R),R.dirs=R.dirs?R.dirs.concat(i.dirs):i.dirs),i.transition&&(R.transition=i.transition),k=R,en(L),k}const ll=e=>{let n;for(const i in e)(i==="class"||i==="style"||an(i))&&((n||(n={}))[i]=e[i]);return n},ul=(e,n)=>{const i={};for(const r in e)(!li(r)||!(r.slice(9)in n))&&(i[r]=e[r]);return i};function cl(e,n,i){const{props:r,children:t,component:f}=e,{props:b,children:D,patchFlag:m}=n,N=f.emitsOptions;if(n.dirs||n.transition)return!0;if(i&&m>=0){if(m&1024)return!0;if(m&16)return r?Wi(r,b,N):!!b;if(m&8){const x=n.dynamicProps;for(let F=0;F<x.length;F++){const M=x[F];if(b[M]!==r[M]&&!hn(N,M))return!0}}}else return(t||D)&&(!D||!D.$stable)?!0:r===b?!1:r?b?Wi(r,b,N):!0:!!b;return!1}function Wi(e,n,i){const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!0;for(let t=0;t<r.length;t++){const f=r[t];if(n[f]!==e[f]&&!hn(i,f))return!0}return!1}function fl({vnode:e,parent:n},i){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===e&&(r.el=e.el),r===e)(e=n.vnode).el=i,n=n.parent;else break}}const os="components";function Vi(e,n){return hl(os,e,!0,n)||e}const dl=Symbol.for("v-ndc");function hl(e,n,i=!0,r=!1){const t=at||Ge;if(t){const f=t.type;if(e===os){const D=lu(f,!1);if(D&&(D===n||D===mt(n)||D===un(mt(n))))return f}const b=Gi(t[e]||f[e],n)||Gi(t.appContext[e],n);return!b&&r?f:b}}function Gi(e,n){return e&&(e[n]||e[mt(n)]||e[un(mt(n))])}const vl=e=>e.__isSuspense;function gl(e,n){n&&n.pendingBranch?ye(e)?n.effects.push(...e):n.effects.push(e):rl(e)}const pl=Symbol.for("v-scx"),ml=()=>Xr(pl),Gr={};function Pn(e,n,i){return ls(e,n,i)}function ls(e,n,{immediate:i,deep:r,flush:t,once:f,onTrack:b,onTrigger:D}=Pe){if(n&&f){const y=n;n=(...u)=>{y(...u),C()}}const m=Ge,N=y=>r===!0?y:ir(y,r===!1?1:void 0);let x,F=!1,M=!1;if($e(e)?(x=()=>e.value,F=qr(e)):sr(e)?(x=()=>N(e),F=!0):ye(e)?(M=!0,F=e.some(y=>sr(y)||qr(y)),x=()=>e.map(y=>{if($e(y))return y.value;if(sr(y))return N(y);if(me(y))return Ot(y,m,2)})):me(e)?n?x=()=>Ot(e,m,2):x=()=>(K&&K(),lt(e,m,3,[w])):x=tt,n&&r){const y=x;x=()=>ir(y())}let K,w=y=>{K=R.onStop=()=>{Ot(y,m,4),K=R.onStop=void 0}},I;if(yn)if(w=tt,n?i&&lt(n,m,3,[x(),M?[]:void 0,w]):x(),t==="sync"){const y=ml();I=y.__watcherHandles||(y.__watcherHandles=[])}else return tt;let k=M?new Array(e.length).fill(Gr):Gr;const S=()=>{if(!(!R.active||!R.dirty))if(n){const y=R.run();(r||F||(M?y.some((u,l)=>It(u,k[l])):It(y,k)))&&(K&&K(),lt(n,m,3,[y,k===Gr?void 0:M&&k[0]===Gr?[]:k,w]),k=y)}else R.run()};S.allowRecurse=!!n;let L;t==="sync"?L=S:t==="post"?L=()=>je(S,m&&m.suspense):(S.pre=!0,m&&(S.id=m.uid),L=()=>Ai(S));const R=new di(x,tt,L),O=xo(),C=()=>{R.stop(),O&&ui(O.effects,R)};return n?i?S():k=R.run():t==="post"?je(R.run.bind(R),m&&m.suspense):R.run(),I&&I.push(C),C}function yl(e,n,i){const r=this.proxy,t=Ke(e)?e.includes(".")?us(r,e):()=>r[e]:e.bind(r,r);let f;me(n)?f=n:(f=n.handler,i=n);const b=Mr(this),D=ls(t,f.bind(r),i);return b(),D}function us(e,n){const i=n.split(".");return()=>{let r=e;for(let t=0;t<i.length&&r;t++)r=r[i[t]];return r}}function ir(e,n,i=0,r){if(!ke(e)||e.__v_skip)return e;if(n&&n>0){if(i>=n)return e;i++}if(r=r||new Set,r.has(e))return e;if(r.add(e),$e(e))ir(e.value,n,i,r);else if(ye(e))for(let t=0;t<e.length;t++)ir(e[t],n,i,r);else if(uo(e)||Tr(e))e.forEach(t=>{ir(t,n,i,r)});else if(ho(e))for(const t in e)ir(e[t],n,i,r);return e}function Wt(e,n,i,r){const t=e.dirs,f=n&&n.dirs;for(let b=0;b<t.length;b++){const D=t[b];f&&(D.oldValue=f[b].value);let m=D.dir[r];m&&(Jt(),lt(m,i,8,[e.el,D,e,n]),qt())}}/*! #__NO_SIDE_EFFECTS__ */function _i(e,n){return me(e)?Ue({name:e.name},n,{setup:e}):e}const zr=e=>!!e.type.__asyncLoader,cs=e=>e.type.__isKeepAlive;function El(e,n){fs(e,"a",n)}function Al(e,n){fs(e,"da",n)}function fs(e,n,i=Ge){const r=e.__wdc||(e.__wdc=()=>{let t=i;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(gn(n,r,i),i){let t=i.parent;for(;t&&t.parent;)cs(t.parent.vnode)&&_l(r,n,i,t),t=t.parent}}function _l(e,n,i,r){const t=gn(n,e,r,!0);vs(()=>{ui(r[n],t)},i)}function gn(e,n,i=Ge,r=!1){if(i){const t=i[e]||(i[e]=[]),f=n.__weh||(n.__weh=(...b)=>{if(i.isUnmounted)return;Jt();const D=Mr(i),m=lt(n,i,e,b);return D(),qt(),m});return r?t.unshift(f):t.push(f),f}}const bt=e=>(n,i=Ge)=>(!yn||e==="sp")&&gn(e,(...r)=>n(...r),i),Tl=bt("bm"),ds=bt("m"),bl=bt("bu"),Sl=bt("u"),hs=bt("bum"),vs=bt("um"),xl=bt("sp"),Cl=bt("rtg"),Ll=bt("rtc");function Pl(e,n=Ge){gn("ec",e,n)}const jn=e=>e?Cs(e)?xi(e)||e.proxy:jn(e.parent):null,Sr=Ue(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>jn(e.parent),$root:e=>jn(e.root),$emit:e=>e.emit,$options:e=>Ti(e),$forceUpdate:e=>e.f||(e.f=()=>{e.effect.dirty=!0,Ai(e.update)}),$nextTick:e=>e.n||(e.n=qo.bind(e.proxy)),$watch:e=>yl.bind(e)}),Dn=(e,n)=>e!==Pe&&!e.__isScriptSetup&&_e(e,n),Dl={get({_:e},n){const{ctx:i,setupState:r,data:t,props:f,accessCache:b,type:D,appContext:m}=e;let N;if(n[0]!=="$"){const K=b[n];if(K!==void 0)switch(K){case 1:return r[n];case 2:return t[n];case 4:return i[n];case 3:return f[n]}else{if(Dn(r,n))return b[n]=1,r[n];if(t!==Pe&&_e(t,n))return b[n]=2,t[n];if((N=e.propsOptions[0])&&_e(N,n))return b[n]=3,f[n];if(i!==Pe&&_e(i,n))return b[n]=4,i[n];Yn&&(b[n]=0)}}const x=Sr[n];let F,M;if(x)return n==="$attrs"&&Ye(e,"get",n),x(e);if((F=D.__cssModules)&&(F=F[n]))return F;if(i!==Pe&&_e(i,n))return b[n]=4,i[n];if(M=m.config.globalProperties,_e(M,n))return M[n]},set({_:e},n,i){const{data:r,setupState:t,ctx:f}=e;return Dn(t,n)?(t[n]=i,!0):r!==Pe&&_e(r,n)?(r[n]=i,!0):_e(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(f[n]=i,!0)},has({_:{data:e,setupState:n,accessCache:i,ctx:r,appContext:t,propsOptions:f}},b){let D;return!!i[b]||e!==Pe&&_e(e,b)||Dn(n,b)||(D=f[0])&&_e(D,b)||_e(r,b)||_e(Sr,b)||_e(t.config.globalProperties,b)},defineProperty(e,n,i){return i.get!=null?e._.accessCache[n]=0:_e(i,"value")&&this.set(e,n,i.value,null),Reflect.defineProperty(e,n,i)}};function Hi(e){return ye(e)?e.reduce((n,i)=>(n[i]=null,n),{}):e}let Yn=!0;function Ol(e){const n=Ti(e),i=e.proxy,r=e.ctx;Yn=!1,n.beforeCreate&&ji(n.beforeCreate,e,"bc");const{data:t,computed:f,methods:b,watch:D,provide:m,inject:N,created:x,beforeMount:F,mounted:M,beforeUpdate:K,updated:w,activated:I,deactivated:k,beforeDestroy:S,beforeUnmount:L,destroyed:R,unmounted:O,render:C,renderTracked:y,renderTriggered:u,errorCaptured:l,serverPrefetch:c,expose:d,inheritAttrs:o,components:a,directives:s,filters:h}=n;if(N&&Il(N,r,null),b)for(const v in b){const A=b[v];me(A)&&(r[v]=A.bind(i))}if(t){const v=t.call(i,i);ke(v)&&(e.data=fn(v))}if(Yn=!0,f)for(const v in f){const A=f[v],E=me(A)?A.bind(i,i):me(A.get)?A.get.bind(i,i):tt,g=!me(A)&&me(A.set)?A.set.bind(i):tt,T=cu({get:E,set:g});Object.defineProperty(r,v,{enumerable:!0,configurable:!0,get:()=>T.value,set:P=>T.value=P})}if(D)for(const v in D)gs(D[v],r,i,v);if(m){const v=me(m)?m.call(i):m;Reflect.ownKeys(v).forEach(A=>{Fl(A,v[A])})}x&&ji(x,e,"c");function _(v,A){ye(A)?A.forEach(E=>v(E.bind(i))):A&&v(A.bind(i))}if(_(Tl,F),_(ds,M),_(bl,K),_(Sl,w),_(El,I),_(Al,k),_(Pl,l),_(Ll,y),_(Cl,u),_(hs,L),_(vs,O),_(xl,c),ye(d))if(d.length){const v=e.exposed||(e.exposed={});d.forEach(A=>{Object.defineProperty(v,A,{get:()=>i[A],set:E=>i[A]=E})})}else e.exposed||(e.exposed={});C&&e.render===tt&&(e.render=C),o!=null&&(e.inheritAttrs=o),a&&(e.components=a),s&&(e.directives=s)}function Il(e,n,i=tt){ye(e)&&(e=$n(e));for(const r in e){const t=e[r];let f;ke(t)?"default"in t?f=Xr(t.from||r,t.default,!0):f=Xr(t.from||r):f=Xr(t),$e(f)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>f.value,set:b=>f.value=b}):n[r]=f}}function ji(e,n,i){lt(ye(e)?e.map(r=>r.bind(n.proxy)):e.bind(n.proxy),n,i)}function gs(e,n,i,r){const t=r.includes(".")?us(i,r):()=>i[r];if(Ke(e)){const f=n[e];me(f)&&Pn(t,f)}else if(me(e))Pn(t,e.bind(i));else if(ke(e))if(ye(e))e.forEach(f=>gs(f,n,i,r));else{const f=me(e.handler)?e.handler.bind(i):n[e.handler];me(f)&&Pn(t,f,e)}}function Ti(e){const n=e.type,{mixins:i,extends:r}=n,{mixins:t,optionsCache:f,config:{optionMergeStrategies:b}}=e.appContext,D=f.get(n);let m;return D?m=D:!t.length&&!i&&!r?m=n:(m={},t.length&&t.forEach(N=>tn(m,N,b,!0)),tn(m,n,b)),ke(n)&&f.set(n,m),m}function tn(e,n,i,r=!1){const{mixins:t,extends:f}=n;f&&tn(e,f,i,!0),t&&t.forEach(b=>tn(e,b,i,!0));for(const b in n)if(!(r&&b==="expose")){const D=Rl[b]||i&&i[b];e[b]=D?D(e[b],n[b]):n[b]}return e}const Rl={data:Yi,props:$i,emits:$i,methods:Ar,computed:Ar,beforeCreate:He,created:He,beforeMount:He,mounted:He,beforeUpdate:He,updated:He,beforeDestroy:He,beforeUnmount:He,destroyed:He,unmounted:He,activated:He,deactivated:He,errorCaptured:He,serverPrefetch:He,components:Ar,directives:Ar,watch:Ml,provide:Yi,inject:kl};function Yi(e,n){return n?e?function(){return Ue(me(e)?e.call(this,this):e,me(n)?n.call(this,this):n)}:n:e}function kl(e,n){return Ar($n(e),$n(n))}function $n(e){if(ye(e)){const n={};for(let i=0;i<e.length;i++)n[e[i]]=e[i];return n}return e}function He(e,n){return e?[...new Set([].concat(e,n))]:n}function Ar(e,n){return e?Ue(Object.create(null),e,n):n}function $i(e,n){return e?ye(e)&&ye(n)?[...new Set([...e,...n])]:Ue(Object.create(null),Hi(e),Hi(n??{})):n}function Ml(e,n){if(!e)return n;if(!n)return e;const i=Ue(Object.create(null),e);for(const r in n)i[r]=He(e[r],n[r]);return i}function ps(){return{app:null,config:{isNativeTag:oo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wl=0;function Nl(e,n){return function(r,t=null){me(r)||(r=Ue({},r)),t!=null&&!ke(t)&&(t=null);const f=ps(),b=new WeakSet;let D=!1;const m=f.app={_uid:wl++,_component:r,_props:t,_container:null,_context:f,_instance:null,version:fu,get config(){return f.config},set config(N){},use(N,...x){return b.has(N)||(N&&me(N.install)?(b.add(N),N.install(m,...x)):me(N)&&(b.add(N),N(m,...x))),m},mixin(N){return f.mixins.includes(N)||f.mixins.push(N),m},component(N,x){return x?(f.components[N]=x,m):f.components[N]},directive(N,x){return x?(f.directives[N]=x,m):f.directives[N]},mount(N,x,F){if(!D){const M=ct(r,t);return M.appContext=f,F===!0?F="svg":F===!1&&(F=void 0),x&&n?n(M,N):e(M,N,F),D=!0,m._container=N,N.__vue_app__=m,xi(M.component)||M.component.proxy}},unmount(){D&&(e(null,m._container),delete m._container.__vue_app__)},provide(N,x){return f.provides[N]=x,m},runWithContext(N){const x=xr;xr=m;try{return N()}finally{xr=x}}};return m}}let xr=null;function Fl(e,n){if(Ge){let i=Ge.provides;const r=Ge.parent&&Ge.parent.provides;r===i&&(i=Ge.provides=Object.create(r)),i[e]=n}}function Xr(e,n,i=!1){const r=Ge||at;if(r||xr){const t=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:xr._context.provides;if(t&&e in t)return t[e];if(arguments.length>1)return i&&me(n)?n.call(r&&r.proxy):n}}function Bl(e,n,i,r=!1){const t={},f={};Jr(f,mn,1),e.propsDefaults=Object.create(null),ms(e,n,t,f);for(const b in e.propsOptions[0])b in t||(t[b]=void 0);i?e.props=r?t:jo(t):e.type.props?e.props=t:e.props=f,e.attrs=f}function Ul(e,n,i,r){const{props:t,attrs:f,vnode:{patchFlag:b}}=e,D=be(t),[m]=e.propsOptions;let N=!1;if((r||b>0)&&!(b&16)){if(b&8){const x=e.vnode.dynamicProps;for(let F=0;F<x.length;F++){let M=x[F];if(hn(e.emitsOptions,M))continue;const K=n[M];if(m)if(_e(f,M))K!==f[M]&&(f[M]=K,N=!0);else{const w=mt(M);t[w]=zn(m,D,w,K,e,!1)}else K!==f[M]&&(f[M]=K,N=!0)}}}else{ms(e,n,t,f)&&(N=!0);let x;for(const F in D)(!n||!_e(n,F)&&((x=pr(F))===F||!_e(n,x)))&&(m?i&&(i[F]!==void 0||i[x]!==void 0)&&(t[F]=zn(m,D,F,void 0,e,!0)):delete t[F]);if(f!==D)for(const F in f)(!n||!_e(n,F))&&(delete f[F],N=!0)}N&&Tt(e,"set","$attrs")}function ms(e,n,i,r){const[t,f]=e.propsOptions;let b=!1,D;if(n)for(let m in n){if(br(m))continue;const N=n[m];let x;t&&_e(t,x=mt(m))?!f||!f.includes(x)?i[x]=N:(D||(D={}))[x]=N:hn(e.emitsOptions,m)||(!(m in r)||N!==r[m])&&(r[m]=N,b=!0)}if(f){const m=be(i),N=D||Pe;for(let x=0;x<f.length;x++){const F=f[x];i[F]=zn(t,m,F,N[F],e,!_e(N,F))}}return b}function zn(e,n,i,r,t,f){const b=e[i];if(b!=null){const D=_e(b,"default");if(D&&r===void 0){const m=b.default;if(b.type!==Function&&!b.skipFactory&&me(m)){const{propsDefaults:N}=t;if(i in N)r=N[i];else{const x=Mr(t);r=N[i]=m.call(null,n),x()}}else r=m}b[0]&&(f&&!D?r=!1:b[1]&&(r===""||r===pr(i))&&(r=!0))}return r}function ys(e,n,i=!1){const r=n.propsCache,t=r.get(e);if(t)return t;const f=e.props,b={},D=[];let m=!1;if(!me(e)){const x=F=>{m=!0;const[M,K]=ys(F,n,!0);Ue(b,M),K&&D.push(...K)};!i&&n.mixins.length&&n.mixins.forEach(x),e.extends&&x(e.extends),e.mixins&&e.mixins.forEach(x)}if(!f&&!m)return ke(e)&&r.set(e,ar),ar;if(ye(f))for(let x=0;x<f.length;x++){const F=mt(f[x]);zi(F)&&(b[F]=Pe)}else if(f)for(const x in f){const F=mt(x);if(zi(F)){const M=f[x],K=b[F]=ye(M)||me(M)?{type:M}:Ue({},M);if(K){const w=Zi(Boolean,K.type),I=Zi(String,K.type);K[0]=w>-1,K[1]=I<0||w<I,(w>-1||_e(K,"default"))&&D.push(F)}}}const N=[b,D];return ke(e)&&r.set(e,N),N}function zi(e){return e[0]!=="$"&&!br(e)}function Xi(e){return e===null?"null":typeof e=="function"?e.name||"":typeof e=="object"&&e.constructor&&e.constructor.name||""}function Qi(e,n){return Xi(e)===Xi(n)}function Zi(e,n){return ye(n)?n.findIndex(i=>Qi(i,e)):me(n)&&Qi(n,e)?0:-1}const Es=e=>e[0]==="_"||e==="$stable",bi=e=>ye(e)?e.map(ht):[ht(e)],Kl=(e,n,i)=>{if(n._n)return n;const r=ol((...t)=>bi(n(...t)),i);return r._c=!1,r},As=(e,n,i)=>{const r=e._ctx;for(const t in e){if(Es(t))continue;const f=e[t];if(me(f))n[t]=Kl(t,f,r);else if(f!=null){const b=bi(f);n[t]=()=>b}}},_s=(e,n)=>{const i=bi(n);e.slots.default=()=>i},Wl=(e,n)=>{if(e.vnode.shapeFlag&32){const i=n._;i?(e.slots=be(n),Jr(n,"_",i)):As(n,e.slots={})}else e.slots={},n&&_s(e,n);Jr(e.slots,mn,1)},Vl=(e,n,i)=>{const{vnode:r,slots:t}=e;let f=!0,b=Pe;if(r.shapeFlag&32){const D=n._;D?i&&D===1?f=!1:(Ue(t,n),!i&&D===1&&delete t._):(f=!n.$stable,As(n,t)),b=n}else n&&(_s(e,n),b={default:1});if(f)for(const D in t)!Es(D)&&b[D]==null&&delete t[D]};function Xn(e,n,i,r,t=!1){if(ye(e)){e.forEach((M,K)=>Xn(M,n&&(ye(n)?n[K]:n),i,r,t));return}if(zr(r)&&!t)return;const f=r.shapeFlag&4?xi(r.component)||r.component.proxy:r.el,b=t?null:f,{i:D,r:m}=e,N=n&&n.r,x=D.refs===Pe?D.refs={}:D.refs,F=D.setupState;if(N!=null&&N!==m&&(Ke(N)?(x[N]=null,_e(F,N)&&(F[N]=null)):$e(N)&&(N.value=null)),me(m))Ot(m,D,12,[b,x]);else{const M=Ke(m),K=$e(m);if(M||K){const w=()=>{if(e.f){const I=M?_e(F,m)?F[m]:x[m]:m.value;t?ye(I)&&ui(I,f):ye(I)?I.includes(f)||I.push(f):M?(x[m]=[f],_e(F,m)&&(F[m]=x[m])):(m.value=[f],e.k&&(x[e.k]=m.value))}else M?(x[m]=b,_e(F,m)&&(F[m]=b)):K&&(m.value=b,e.k&&(x[e.k]=b))};b?(w.id=-1,je(w,i)):w()}}}const je=gl;function Gl(e){return Hl(e)}function Hl(e,n){const i=Fa();i.__VUE__=!0;const{insert:r,remove:t,patchProp:f,createElement:b,createText:D,createComment:m,setText:N,setElementText:x,parentNode:F,nextSibling:M,setScopeId:K=tt,insertStaticContent:w}=e,I=(Y,X,q,re=null,ne=null,U=null,H=void 0,$=null,J=!!X.dynamicChildren)=>{if(Y===X)return;Y&&!Er(Y,X)&&(re=z(Y),P(Y,ne,U,!0),Y=null),X.patchFlag===-2&&(J=!1,X.dynamicChildren=null);const{type:te,ref:ie,shapeFlag:le}=X;switch(te){case pn:k(Y,X,q,re);break;case Xt:S(Y,X,q,re);break;case In:Y==null&&L(X,q,re,H);break;case At:a(Y,X,q,re,ne,U,H,$,J);break;default:le&1?C(Y,X,q,re,ne,U,H,$,J):le&6?s(Y,X,q,re,ne,U,H,$,J):(le&64||le&128)&&te.process(Y,X,q,re,ne,U,H,$,J,ee)}ie!=null&&ne&&Xn(ie,Y&&Y.ref,U,X||Y,!X)},k=(Y,X,q,re)=>{if(Y==null)r(X.el=D(X.children),q,re);else{const ne=X.el=Y.el;X.children!==Y.children&&N(ne,X.children)}},S=(Y,X,q,re)=>{Y==null?r(X.el=m(X.children||""),q,re):X.el=Y.el},L=(Y,X,q,re)=>{[Y.el,Y.anchor]=w(Y.children,X,q,re,Y.el,Y.anchor)},R=({el:Y,anchor:X},q,re)=>{let ne;for(;Y&&Y!==X;)ne=M(Y),r(Y,q,re),Y=ne;r(X,q,re)},O=({el:Y,anchor:X})=>{let q;for(;Y&&Y!==X;)q=M(Y),t(Y),Y=q;t(X)},C=(Y,X,q,re,ne,U,H,$,J)=>{X.type==="svg"?H="svg":X.type==="math"&&(H="mathml"),Y==null?y(X,q,re,ne,U,H,$,J):c(Y,X,ne,U,H,$,J)},y=(Y,X,q,re,ne,U,H,$)=>{let J,te;const{props:ie,shapeFlag:le,transition:oe,dirs:ue}=Y;if(J=Y.el=b(Y.type,U,ie&&ie.is,ie),le&8?x(J,Y.children):le&16&&l(Y.children,J,null,re,ne,On(Y,U),H,$),ue&&Wt(Y,null,re,"created"),u(J,Y,Y.scopeId,H,re),ie){for(const he in ie)he!=="value"&&!br(he)&&f(J,he,null,ie[he],U,Y.children,re,ne,j);"value"in ie&&f(J,"value",null,ie.value,U),(te=ie.onVnodeBeforeMount)&&dt(te,re,Y)}ue&&Wt(Y,null,re,"beforeMount");const fe=jl(ne,oe);fe&&oe.beforeEnter(J),r(J,X,q),((te=ie&&ie.onVnodeMounted)||fe||ue)&&je(()=>{te&&dt(te,re,Y),fe&&oe.enter(J),ue&&Wt(Y,null,re,"mounted")},ne)},u=(Y,X,q,re,ne)=>{if(q&&K(Y,q),re)for(let U=0;U<re.length;U++)K(Y,re[U]);if(ne){let U=ne.subTree;if(X===U){const H=ne.vnode;u(Y,H,H.scopeId,H.slotScopeIds,ne.parent)}}},l=(Y,X,q,re,ne,U,H,$,J=0)=>{for(let te=J;te<Y.length;te++){const ie=Y[te]=$?Ct(Y[te]):ht(Y[te]);I(null,ie,X,q,re,ne,U,H,$)}},c=(Y,X,q,re,ne,U,H)=>{const $=X.el=Y.el;let{patchFlag:J,dynamicChildren:te,dirs:ie}=X;J|=Y.patchFlag&16;const le=Y.props||Pe,oe=X.props||Pe;let ue;if(q&&Vt(q,!1),(ue=oe.onVnodeBeforeUpdate)&&dt(ue,q,X,Y),ie&&Wt(X,Y,q,"beforeUpdate"),q&&Vt(q,!0),te?d(Y.dynamicChildren,te,$,q,re,On(X,ne),U):H||A(Y,X,$,null,q,re,On(X,ne),U,!1),J>0){if(J&16)o($,X,le,oe,q,re,ne);else if(J&2&&le.class!==oe.class&&f($,"class",null,oe.class,ne),J&4&&f($,"style",le.style,oe.style,ne),J&8){const fe=X.dynamicProps;for(let he=0;he<fe.length;he++){const ge=fe[he],Ae=le[ge],Ce=oe[ge];(Ce!==Ae||ge==="value")&&f($,ge,Ae,Ce,ne,Y.children,q,re,j)}}J&1&&Y.children!==X.children&&x($,X.children)}else!H&&te==null&&o($,X,le,oe,q,re,ne);((ue=oe.onVnodeUpdated)||ie)&&je(()=>{ue&&dt(ue,q,X,Y),ie&&Wt(X,Y,q,"updated")},re)},d=(Y,X,q,re,ne,U,H)=>{for(let $=0;$<X.length;$++){const J=Y[$],te=X[$],ie=J.el&&(J.type===At||!Er(J,te)||J.shapeFlag&70)?F(J.el):q;I(J,te,ie,null,re,ne,U,H,!0)}},o=(Y,X,q,re,ne,U,H)=>{if(q!==re){if(q!==Pe)for(const $ in q)!br($)&&!($ in re)&&f(Y,$,q[$],null,H,X.children,ne,U,j);for(const $ in re){if(br($))continue;const J=re[$],te=q[$];J!==te&&$!=="value"&&f(Y,$,te,J,H,X.children,ne,U,j)}"value"in re&&f(Y,"value",q.value,re.value,H)}},a=(Y,X,q,re,ne,U,H,$,J)=>{const te=X.el=Y?Y.el:D(""),ie=X.anchor=Y?Y.anchor:D("");let{patchFlag:le,dynamicChildren:oe,slotScopeIds:ue}=X;ue&&($=$?$.concat(ue):ue),Y==null?(r(te,q,re),r(ie,q,re),l(X.children||[],q,ie,ne,U,H,$,J)):le>0&&le&64&&oe&&Y.dynamicChildren?(d(Y.dynamicChildren,oe,q,ne,U,H,$),(X.key!=null||ne&&X===ne.subTree)&&Ts(Y,X,!0)):A(Y,X,q,ie,ne,U,H,$,J)},s=(Y,X,q,re,ne,U,H,$,J)=>{X.slotScopeIds=$,Y==null?X.shapeFlag&512?ne.ctx.activate(X,q,re,H,J):h(X,q,re,ne,U,H,J):p(Y,X,J)},h=(Y,X,q,re,ne,U,H)=>{const $=Y.component=nu(Y,re,ne);if(cs(Y)&&($.ctx.renderer=ee),iu($),$.asyncDep){if(ne&&ne.registerDep($,_),!Y.el){const J=$.subTree=ct(Xt);S(null,J,X,q)}}else _($,Y,X,q,ne,U,H)},p=(Y,X,q)=>{const re=X.component=Y.component;if(cl(Y,X,q))if(re.asyncDep&&!re.asyncResolved){v(re,X,q);return}else re.next=X,tl(re.update),re.effect.dirty=!0,re.update();else X.el=Y.el,re.vnode=X},_=(Y,X,q,re,ne,U,H)=>{const $=()=>{if(Y.isMounted){let{next:ie,bu:le,u:oe,parent:ue,vnode:fe}=Y;{const Ie=bs(Y);if(Ie){ie&&(ie.el=fe.el,v(Y,ie,H)),Ie.asyncDep.then(()=>{Y.isUnmounted||$()});return}}let he=ie,ge;Vt(Y,!1),ie?(ie.el=fe.el,v(Y,ie,H)):ie=fe,le&&Cn(le),(ge=ie.props&&ie.props.onVnodeBeforeUpdate)&&dt(ge,ue,ie,fe),Vt(Y,!0);const Ae=Ln(Y),Ce=Y.subTree;Y.subTree=Ae,I(Ce,Ae,F(Ce.el),z(Ce),Y,ne,U),ie.el=Ae.el,he===null&&fl(Y,Ae.el),oe&&je(oe,ne),(ge=ie.props&&ie.props.onVnodeUpdated)&&je(()=>dt(ge,ue,ie,fe),ne)}else{let ie;const{el:le,props:oe}=X,{bm:ue,m:fe,parent:he}=Y,ge=zr(X);if(Vt(Y,!1),ue&&Cn(ue),!ge&&(ie=oe&&oe.onVnodeBeforeMount)&&dt(ie,he,X),Vt(Y,!0),le&&se){const Ae=()=>{Y.subTree=Ln(Y),se(le,Y.subTree,Y,ne,null)};ge?X.type.__asyncLoader().then(()=>!Y.isUnmounted&&Ae()):Ae()}else{const Ae=Y.subTree=Ln(Y);I(null,Ae,q,re,Y,ne,U),X.el=Ae.el}if(fe&&je(fe,ne),!ge&&(ie=oe&&oe.onVnodeMounted)){const Ae=X;je(()=>dt(ie,he,Ae),ne)}(X.shapeFlag&256||he&&zr(he.vnode)&&he.vnode.shapeFlag&256)&&Y.a&&je(Y.a,ne),Y.isMounted=!0,X=q=re=null}},J=Y.effect=new di($,tt,()=>Ai(te),Y.scope),te=Y.update=()=>{J.dirty&&J.run()};te.id=Y.uid,Vt(Y,!0),te()},v=(Y,X,q)=>{X.component=Y;const re=Y.vnode.props;Y.vnode=X,Y.next=null,Ul(Y,X.props,re,q),Vl(Y,X.children,q),Jt(),Ki(Y),qt()},A=(Y,X,q,re,ne,U,H,$,J=!1)=>{const te=Y&&Y.children,ie=Y?Y.shapeFlag:0,le=X.children,{patchFlag:oe,shapeFlag:ue}=X;if(oe>0){if(oe&128){g(te,le,q,re,ne,U,H,$,J);return}else if(oe&256){E(te,le,q,re,ne,U,H,$,J);return}}ue&8?(ie&16&&j(te,ne,U),le!==te&&x(q,le)):ie&16?ue&16?g(te,le,q,re,ne,U,H,$,J):j(te,ne,U,!0):(ie&8&&x(q,""),ue&16&&l(le,q,re,ne,U,H,$,J))},E=(Y,X,q,re,ne,U,H,$,J)=>{Y=Y||ar,X=X||ar;const te=Y.length,ie=X.length,le=Math.min(te,ie);let oe;for(oe=0;oe<le;oe++){const ue=X[oe]=J?Ct(X[oe]):ht(X[oe]);I(Y[oe],ue,q,null,ne,U,H,$,J)}te>ie?j(Y,ne,U,!0,!1,le):l(X,q,re,ne,U,H,$,J,le)},g=(Y,X,q,re,ne,U,H,$,J)=>{let te=0;const ie=X.length;let le=Y.length-1,oe=ie-1;for(;te<=le&&te<=oe;){const ue=Y[te],fe=X[te]=J?Ct(X[te]):ht(X[te]);if(Er(ue,fe))I(ue,fe,q,null,ne,U,H,$,J);else break;te++}for(;te<=le&&te<=oe;){const ue=Y[le],fe=X[oe]=J?Ct(X[oe]):ht(X[oe]);if(Er(ue,fe))I(ue,fe,q,null,ne,U,H,$,J);else break;le--,oe--}if(te>le){if(te<=oe){const ue=oe+1,fe=ue<ie?X[ue].el:re;for(;te<=oe;)I(null,X[te]=J?Ct(X[te]):ht(X[te]),q,fe,ne,U,H,$,J),te++}}else if(te>oe)for(;te<=le;)P(Y[te],ne,U,!0),te++;else{const ue=te,fe=te,he=new Map;for(te=fe;te<=oe;te++){const De=X[te]=J?Ct(X[te]):ht(X[te]);De.key!=null&&he.set(De.key,te)}let ge,Ae=0;const Ce=oe-fe+1;let Ie=!1,Fe=0;const Ne=new Array(Ce);for(te=0;te<Ce;te++)Ne[te]=0;for(te=ue;te<=le;te++){const De=Y[te];if(Ae>=Ce){P(De,ne,U,!0);continue}let Te;if(De.key!=null)Te=he.get(De.key);else for(ge=fe;ge<=oe;ge++)if(Ne[ge-fe]===0&&Er(De,X[ge])){Te=ge;break}Te===void 0?P(De,ne,U,!0):(Ne[Te-fe]=te+1,Te>=Fe?Fe=Te:Ie=!0,I(De,X[Te],q,null,ne,U,H,$,J),Ae++)}const We=Ie?Yl(Ne):ar;for(ge=We.length-1,te=Ce-1;te>=0;te--){const De=fe+te,Te=X[De],Re=De+1<ie?X[De+1].el:re;Ne[te]===0?I(null,Te,q,Re,ne,U,H,$,J):Ie&&(ge<0||te!==We[ge]?T(Te,q,Re,2):ge--)}}},T=(Y,X,q,re,ne=null)=>{const{el:U,type:H,transition:$,children:J,shapeFlag:te}=Y;if(te&6){T(Y.component.subTree,X,q,re);return}if(te&128){Y.suspense.move(X,q,re);return}if(te&64){H.move(Y,X,q,ee);return}if(H===At){r(U,X,q);for(let le=0;le<J.length;le++)T(J[le],X,q,re);r(Y.anchor,X,q);return}if(H===In){R(Y,X,q);return}if(re!==2&&te&1&&$)if(re===0)$.beforeEnter(U),r(U,X,q),je(()=>$.enter(U),ne);else{const{leave:le,delayLeave:oe,afterLeave:ue}=$,fe=()=>r(U,X,q),he=()=>{le(U,()=>{fe(),ue&&ue()})};oe?oe(U,fe,he):he()}else r(U,X,q)},P=(Y,X,q,re=!1,ne=!1)=>{const{type:U,props:H,ref:$,children:J,dynamicChildren:te,shapeFlag:ie,patchFlag:le,dirs:oe}=Y;if($!=null&&Xn($,null,q,Y,!0),ie&256){X.ctx.deactivate(Y);return}const ue=ie&1&&oe,fe=!zr(Y);let he;if(fe&&(he=H&&H.onVnodeBeforeUnmount)&&dt(he,X,Y),ie&6)W(Y.component,q,re);else{if(ie&128){Y.suspense.unmount(q,re);return}ue&&Wt(Y,null,X,"beforeUnmount"),ie&64?Y.type.remove(Y,X,q,ne,ee,re):te&&(U!==At||le>0&&le&64)?j(te,X,q,!1,!0):(U===At&&le&384||!ne&&ie&16)&&j(J,X,q),re&&B(Y)}(fe&&(he=H&&H.onVnodeUnmounted)||ue)&&je(()=>{he&&dt(he,X,Y),ue&&Wt(Y,null,X,"unmounted")},q)},B=Y=>{const{type:X,el:q,anchor:re,transition:ne}=Y;if(X===At){V(q,re);return}if(X===In){O(Y);return}const U=()=>{t(q),ne&&!ne.persisted&&ne.afterLeave&&ne.afterLeave()};if(Y.shapeFlag&1&&ne&&!ne.persisted){const{leave:H,delayLeave:$}=ne,J=()=>H(q,U);$?$(Y.el,U,J):J()}else U()},V=(Y,X)=>{let q;for(;Y!==X;)q=M(Y),t(Y),Y=q;t(X)},W=(Y,X,q)=>{const{bum:re,scope:ne,update:U,subTree:H,um:$}=Y;re&&Cn(re),ne.stop(),U&&(U.active=!1,P(H,Y,X,q)),$&&je($,X),je(()=>{Y.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&Y.asyncDep&&!Y.asyncResolved&&Y.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},j=(Y,X,q,re=!1,ne=!1,U=0)=>{for(let H=U;H<Y.length;H++)P(Y[H],X,q,re,ne)},z=Y=>Y.shapeFlag&6?z(Y.component.subTree):Y.shapeFlag&128?Y.suspense.next():M(Y.anchor||Y.el);let Q=!1;const Z=(Y,X,q)=>{Y==null?X._vnode&&P(X._vnode,null,null,!0):I(X._vnode||null,Y,X,null,null,null,q),Q||(Q=!0,Ki(),is(),Q=!1),X._vnode=Y},ee={p:I,um:P,m:T,r:B,mt:h,mc:l,pc:A,pbc:d,n:z,o:e};let ae,se;return n&&([ae,se]=n(ee)),{render:Z,hydrate:ae,createApp:Nl(Z,ae)}}function On({type:e,props:n},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:i}function Vt({effect:e,update:n},i){e.allowRecurse=n.allowRecurse=i}function jl(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function Ts(e,n,i=!1){const r=e.children,t=n.children;if(ye(r)&&ye(t))for(let f=0;f<r.length;f++){const b=r[f];let D=t[f];D.shapeFlag&1&&!D.dynamicChildren&&((D.patchFlag<=0||D.patchFlag===32)&&(D=t[f]=Ct(t[f]),D.el=b.el),i||Ts(b,D)),D.type===pn&&(D.el=b.el)}}function Yl(e){const n=e.slice(),i=[0];let r,t,f,b,D;const m=e.length;for(r=0;r<m;r++){const N=e[r];if(N!==0){if(t=i[i.length-1],e[t]<N){n[r]=t,i.push(r);continue}for(f=0,b=i.length-1;f<b;)D=f+b>>1,e[i[D]]<N?f=D+1:b=D;N<e[i[f]]&&(f>0&&(n[r]=i[f-1]),i[f]=r)}}for(f=i.length,b=i[f-1];f-- >0;)i[f]=b,b=n[b];return i}function bs(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:bs(n)}const $l=e=>e.__isTeleport,At=Symbol.for("v-fgt"),pn=Symbol.for("v-txt"),Xt=Symbol.for("v-cmt"),In=Symbol.for("v-stc"),Cr=[];let st=null;function lr(e=!1){Cr.push(st=e?null:[])}function zl(){Cr.pop(),st=Cr[Cr.length-1]||null}let Rr=1;function Ji(e){Rr+=e}function Ss(e){return e.dynamicChildren=Rr>0?st||ar:null,zl(),Rr>0&&st&&st.push(e),e}function Lr(e,n,i,r,t,f){return Ss(ut(e,n,i,r,t,f,!0))}function Xl(e,n,i,r,t){return Ss(ct(e,n,i,r,t,!0))}function Ql(e){return e?e.__v_isVNode===!0:!1}function Er(e,n){return e.type===n.type&&e.key===n.key}const mn="__vInternal",xs=({key:e})=>e??null,Qr=({ref:e,ref_key:n,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Ke(e)||$e(e)||me(e)?{i:at,r:e,k:n,f:!!i}:e:null);function ut(e,n=null,i=null,r=0,t=null,f=e===At?0:1,b=!1,D=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&xs(n),ref:n&&Qr(n),scopeId:vn,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:r,dynamicProps:t,dynamicChildren:null,appContext:null,ctx:at};return D?(Si(m,i),f&128&&e.normalize(m)):i&&(m.shapeFlag|=Ke(i)?8:16),Rr>0&&!b&&st&&(m.patchFlag>0||f&6)&&m.patchFlag!==32&&st.push(m),m}const ct=Zl;function Zl(e,n=null,i=null,r=0,t=null,f=!1){if((!e||e===dl)&&(e=Xt),Ql(e)){const D=dr(e,n,!0);return i&&Si(D,i),Rr>0&&!f&&st&&(D.shapeFlag&6?st[st.indexOf(e)]=D:st.push(D)),D.patchFlag|=-2,D}if(uu(e)&&(e=e.__vccOpts),n){n=Jl(n);let{class:D,style:m}=n;D&&!Ke(D)&&(n.class=fi(D)),ke(m)&&(Za(m)&&!ye(m)&&(m=Ue({},m)),n.style=Pr(m))}const b=Ke(e)?1:vl(e)?128:$l(e)?64:ke(e)?4:me(e)?2:0;return ut(e,n,i,r,t,b,f,!0)}function Jl(e){return e?Za(e)||mn in e?Ue({},e):e:null}function dr(e,n,i=!1){const{props:r,ref:t,patchFlag:f,children:b}=e,D=n?eu(r||{},n):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:D,key:D&&xs(D),ref:n&&n.ref?i&&t?ye(t)?t.concat(Qr(n)):[t,Qr(n)]:Qr(n):t,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:b,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==At?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&dr(e.ssContent),ssFallback:e.ssFallback&&dr(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function ql(e=" ",n=0){return ct(pn,null,e,n)}function qi(e="",n=!1){return n?(lr(),Xl(Xt,null,e)):ct(Xt,null,e)}function ht(e){return e==null||typeof e=="boolean"?ct(Xt):ye(e)?ct(At,null,e.slice()):typeof e=="object"?Ct(e):ct(pn,null,String(e))}function Ct(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:dr(e)}function Si(e,n){let i=0;const{shapeFlag:r}=e;if(n==null)n=null;else if(ye(n))i=16;else if(typeof n=="object")if(r&65){const t=n.default;t&&(t._c&&(t._d=!1),Si(e,t()),t._c&&(t._d=!0));return}else{i=32;const t=n._;!t&&!(mn in n)?n._ctx=at:t===3&&at&&(at.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else me(n)?(n={default:n,_ctx:at},i=32):(n=String(n),r&64?(i=16,n=[ql(n)]):i=8);e.children=n,e.shapeFlag|=i}function eu(...e){const n={};for(let i=0;i<e.length;i++){const r=e[i];for(const t in r)if(t==="class")n.class!==r.class&&(n.class=fi([n.class,r.class]));else if(t==="style")n.style=Pr([n.style,r.style]);else if(an(t)){const f=n[t],b=r[t];b&&f!==b&&!(ye(f)&&f.includes(b))&&(n[t]=f?[].concat(f,b):b)}else t!==""&&(n[t]=r[t])}return n}function dt(e,n,i,r=null){lt(e,n,7,[i,r])}const tu=ps();let ru=0;function nu(e,n,i){const r=e.type,t=(n?n.appContext:e.appContext)||tu,f={uid:ru++,vnode:e,type:r,parent:n,appContext:t,root:null,next:null,subTree:null,effect:null,update:null,scope:new bo(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(t.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ys(r,t),emitsOptions:ss(r,t),emit:null,emitted:null,propsDefaults:Pe,inheritAttrs:r.inheritAttrs,ctx:Pe,data:Pe,props:Pe,attrs:Pe,slots:Pe,refs:Pe,setupState:Pe,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=n?n.root:f,f.emit=il.bind(null,f),e.ce&&e.ce(f),f}let Ge=null,rn,Qn;{const e=Fa(),n=(i,r)=>{let t;return(t=e[i])||(t=e[i]=[]),t.push(r),f=>{t.length>1?t.forEach(b=>b(f)):t[0](f)}};rn=n("__VUE_INSTANCE_SETTERS__",i=>Ge=i),Qn=n("__VUE_SSR_SETTERS__",i=>yn=i)}const Mr=e=>{const n=Ge;return rn(e),e.scope.on(),()=>{e.scope.off(),rn(n)}},ea=()=>{Ge&&Ge.scope.off(),rn(null)};function Cs(e){return e.vnode.shapeFlag&4}let yn=!1;function iu(e,n=!1){n&&Qn(n);const{props:i,children:r}=e.vnode,t=Cs(e);Bl(e,i,t,n),Wl(e,r);const f=t?au(e,n):void 0;return n&&Qn(!1),f}function au(e,n){const i=e.type;e.accessCache=Object.create(null),e.proxy=Ja(new Proxy(e.ctx,Dl));const{setup:r}=i;if(r){const t=e.setupContext=r.length>1?ou(e):null,f=Mr(e);Jt();const b=Ot(r,e,0,[e.props,t]);if(qt(),f(),Na(b)){if(b.then(ea,ea),n)return b.then(D=>{ta(e,D,n)}).catch(D=>{dn(D,e,0)});e.asyncDep=b}else ta(e,b,n)}else Ls(e,n)}function ta(e,n,i){me(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:ke(n)&&(e.setupState=ts(n)),Ls(e,i)}let ra;function Ls(e,n,i){const r=e.type;if(!e.render){if(!n&&ra&&!r.render){const t=r.template||Ti(e).template;if(t){const{isCustomElement:f,compilerOptions:b}=e.appContext.config,{delimiters:D,compilerOptions:m}=r,N=Ue(Ue({isCustomElement:f,delimiters:D},b),m);r.render=ra(t,N)}}e.render=r.render||tt}{const t=Mr(e);Jt();try{Ol(e)}finally{qt(),t()}}}function su(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(n,i){return Ye(e,"get","$attrs"),n[i]}}))}function ou(e){const n=i=>{e.exposed=i||{}};return{get attrs(){return su(e)},slots:e.slots,emit:e.emit,expose:n}}function xi(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(ts(Ja(e.exposed)),{get(n,i){if(i in n)return n[i];if(i in Sr)return Sr[i](e)},has(n,i){return i in n||i in Sr}}))}function lu(e,n=!0){return me(e)?e.displayName||e.name:e.name||n&&e.__name}function uu(e){return me(e)&&"__vccOpts"in e}const cu=(e,n)=>Yo(e,n,yn),fu="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const du="http://www.w3.org/2000/svg",hu="http://www.w3.org/1998/Math/MathML",Lt=typeof document<"u"?document:null,na=Lt&&Lt.createElement("template"),vu={insert:(e,n,i)=>{n.insertBefore(e,i||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,i,r)=>{const t=n==="svg"?Lt.createElementNS(du,e):n==="mathml"?Lt.createElementNS(hu,e):Lt.createElement(e,i?{is:i}:void 0);return e==="select"&&r&&r.multiple!=null&&t.setAttribute("multiple",r.multiple),t},createText:e=>Lt.createTextNode(e),createComment:e=>Lt.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Lt.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,i,r,t,f){const b=i?i.previousSibling:n.lastChild;if(t&&(t===f||t.nextSibling))for(;n.insertBefore(t.cloneNode(!0),i),!(t===f||!(t=t.nextSibling)););else{na.innerHTML=r==="svg"?`<svg>${e}</svg>`:r==="mathml"?`<math>${e}</math>`:e;const D=na.content;if(r==="svg"||r==="mathml"){const m=D.firstChild;for(;m.firstChild;)D.appendChild(m.firstChild);D.removeChild(m)}n.insertBefore(D,i)}return[b?b.nextSibling:n.firstChild,i?i.previousSibling:n.lastChild]}},gu=Symbol("_vtc");function pu(e,n,i){const r=e[gu];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?e.removeAttribute("class"):i?e.setAttribute("class",n):e.className=n}const ia=Symbol("_vod"),mu=Symbol("_vsh"),yu=Symbol(""),Eu=/(^|;)\s*display\s*:/;function Au(e,n,i){const r=e.style,t=Ke(i);let f=!1;if(i&&!t){if(n)if(Ke(n))for(const b of n.split(";")){const D=b.slice(0,b.indexOf(":")).trim();i[D]==null&&Zr(r,D,"")}else for(const b in n)i[b]==null&&Zr(r,b,"");for(const b in i)b==="display"&&(f=!0),Zr(r,b,i[b])}else if(t){if(n!==i){const b=r[yu];b&&(i+=";"+b),r.cssText=i,f=Eu.test(i)}}else n&&e.removeAttribute("style");ia in e&&(e[ia]=f?r.display:"",e[mu]&&(r.display="none"))}const aa=/\s*!important$/;function Zr(e,n,i){if(ye(i))i.forEach(r=>Zr(e,n,r));else if(i==null&&(i=""),n.startsWith("--"))e.setProperty(n,i);else{const r=_u(e,n);aa.test(i)?e.setProperty(pr(r),i.replace(aa,""),"important"):e[r]=i}}const sa=["Webkit","Moz","ms"],Rn={};function _u(e,n){const i=Rn[n];if(i)return i;let r=mt(n);if(r!=="filter"&&r in e)return Rn[n]=r;r=un(r);for(let t=0;t<sa.length;t++){const f=sa[t]+r;if(f in e)return Rn[n]=f}return n}const oa="http://www.w3.org/1999/xlink";function Tu(e,n,i,r,t){if(r&&n.startsWith("xlink:"))i==null?e.removeAttributeNS(oa,n.slice(6,n.length)):e.setAttributeNS(oa,n,i);else{const f=To(n);i==null||f&&!Ba(i)?e.removeAttribute(n):e.setAttribute(n,f?"":i)}}function bu(e,n,i,r,t,f,b){if(n==="innerHTML"||n==="textContent"){r&&b(r,t,f),e[n]=i??"";return}const D=e.tagName;if(n==="value"&&D!=="PROGRESS"&&!D.includes("-")){const N=D==="OPTION"?e.getAttribute("value")||"":e.value,x=i??"";(N!==x||!("_value"in e))&&(e.value=x),i==null&&e.removeAttribute(n),e._value=i;return}let m=!1;if(i===""||i==null){const N=typeof e[n];N==="boolean"?i=Ba(i):i==null&&N==="string"?(i="",m=!0):N==="number"&&(i=0,m=!0)}try{e[n]=i}catch{}m&&e.removeAttribute(n)}function Su(e,n,i,r){e.addEventListener(n,i,r)}function xu(e,n,i,r){e.removeEventListener(n,i,r)}const la=Symbol("_vei");function Cu(e,n,i,r,t=null){const f=e[la]||(e[la]={}),b=f[n];if(r&&b)b.value=r;else{const[D,m]=Lu(n);if(r){const N=f[n]=Ou(r,t);Su(e,D,N,m)}else b&&(xu(e,D,b,m),f[n]=void 0)}}const ua=/(?:Once|Passive|Capture)$/;function Lu(e){let n;if(ua.test(e)){n={};let r;for(;r=e.match(ua);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):pr(e.slice(2)),n]}let kn=0;const Pu=Promise.resolve(),Du=()=>kn||(Pu.then(()=>kn=0),kn=Date.now());function Ou(e,n){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;lt(Iu(r,i.value),n,5,[r])};return i.value=e,i.attached=Du(),i}function Iu(e,n){if(ye(n)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},n.map(r=>t=>!t._stopped&&r&&r(t))}else return n}const ca=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ru=(e,n,i,r,t,f,b,D,m)=>{const N=t==="svg";n==="class"?pu(e,r,N):n==="style"?Au(e,i,r):an(n)?li(n)||Cu(e,n,i,r,b):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):ku(e,n,r,N))?bu(e,n,r,f,b,D,m):(n==="true-value"?e._trueValue=r:n==="false-value"&&(e._falseValue=r),Tu(e,n,r,N))};function ku(e,n,i,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in e&&ca(n)&&me(i));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const t=e.tagName;if(t==="IMG"||t==="VIDEO"||t==="CANVAS"||t==="SOURCE")return!1}return ca(n)&&Ke(i)?!1:n in e}const Mu=Ue({patchProp:Ru},vu);let fa;function wu(){return fa||(fa=Gl(Mu))}const Nu=(...e)=>{const n=wu().createApp(...e),{mount:i}=n;return n.mount=r=>{const t=Bu(r);if(!t)return;const f=n._component;!me(f)&&!f.render&&!f.template&&(f.template=t.innerHTML),t.innerHTML="";const b=i(t,!1,Fu(t));return t instanceof Element&&(t.removeAttribute("v-cloak"),t.setAttribute("data-v-app","")),b},n};function Fu(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Bu(e){return Ke(e)?document.querySelector(e):e}/*!
* v-github-icon v3.2.1
* (c) 2024 Vinayak Kulkarni
* @license MIT
*/const Uu=_i({name:"VGithubIcon",props:{url:{type:String,required:!0,default:""},position:{type:String,required:!1,default:"top-right"},bgColor:{type:String,required:!1,default:"#FFFFFF"},fillColor:{type:String,required:!1,default:"#151513"}}}),Ku=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},mr=e=>(al("data-v-6c7dc248"),e=e(),sl(),e),Wu=["href"],Vu=mr(()=>ut("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),Gu=mr(()=>ut("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),Hu=mr(()=>ut("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),ju=[Vu,Gu,Hu],Yu=mr(()=>ut("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"},null,-1)),$u=mr(()=>ut("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"},class:"octo-arm"},null,-1)),zu=mr(()=>ut("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",class:"octo-body"},null,-1)),Xu=[Yu,$u,zu];function Qu(e,n,i,r,t,f){return lr(),Lr("a",{href:e.url,class:"github-corner","aria-label":"View source on GitHub",target:"_blank",rel:"noopener noreferrer"},[e.position==="top-left"?(lr(),Lr("svg",{key:0,width:"80",height:"80",viewBox:"0 0 250 250",style:Pr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",left:"0",transform:"scale(-1, 1)"}]),"aria-hidden":"true"},ju,4)):qi("",!0),e.position==="top-right"?(lr(),Lr("svg",{key:1,width:"80",height:"80",viewBox:"0 0 250 250",style:Pr([{fill:e.fillColor,color:e.bgColor},{position:"absolute",top:"0",border:"0",right:"0"}]),"aria-hidden":"true"},Xu,4)):qi("",!0)],8,Wu)}const Zu=Ku(Uu,[["render",Qu],["__scopeId","data-v-6c7dc248"]]);function Ju(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var r,t,f,b,D=[],m=!0,N=!1;try{if(f=(i=i.call(e)).next,n===0){if(Object(i)!==i)return;m=!1}else for(;!(m=(r=f.call(i)).done)&&(D.push(r.value),D.length!==n);m=!0);}catch(x){N=!0,t=x}finally{try{if(!m&&i.return!=null&&(b=i.return(),Object(b)!==b))return}finally{if(N)throw t}}return D}}function da(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function Hr(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?da(Object(i),!0).forEach(function(r){qu(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):da(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function hr(e){"@babel/helpers - typeof";return hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},hr(e)}function Se(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ha(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ds(r.key),r)}}function xe(e,n,i){return n&&ha(e.prototype,n),i&&ha(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function qu(e,n,i){return n=Ds(n),n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Me(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Zn(e,n)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},_t(e)}function Zn(e,n){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},Zn(e,n)}function ec(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function En(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tc(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return En(e)}function we(e){var n=ec();return function(){var r=_t(e),t;if(n){var f=_t(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return tc(this,t)}}function rc(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=_t(e),e!==null););return e}function Yt(){return typeof Reflect<"u"&&Reflect.get?Yt=Reflect.get.bind():Yt=function(n,i,r){var t=rc(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},Yt.apply(this,arguments)}function Jn(e,n){return ic(e)||Ju(e,n)||Ci(e,n)||oc()}function ur(e){return nc(e)||ac(e)||Ci(e)||sc()}function nc(e){if(Array.isArray(e))return qn(e)}function ic(e){if(Array.isArray(e))return e}function ac(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ci(e,n){if(e){if(typeof e=="string")return qn(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qn(e,n)}}function qn(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function sc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ps(e,n){var i=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=Ci(e))||n&&e&&typeof e.length=="number"){i&&(e=i);var r=0,t=function(){};return{s:t,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(m){throw m},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f=!0,b=!1,D;return{s:function(){i=i.call(e)},n:function(){var m=i.next();return f=m.done,m},e:function(m){b=!0,D=m},f:function(){try{!f&&i.return!=null&&i.return()}finally{if(b)throw D}}}}function lc(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Ds(e){var n=lc(e,"string");return typeof n=="symbol"?n:String(n)}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],f=0;f<r;){var b=i[f];if(n.call(t,b,f,i))return b;f++}}});Object.entries||(Object.entries=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=[n[i],e[n[i]]];return r});Object.values||(Object.values=function(e){for(var n=Object.keys(e),i=n.length,r=new Array(i);i--;)r[i]=e[n[i]];return r});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(n,i){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(n),t=1;t<arguments.length;t++){var f=arguments[t];if(f!=null)for(var b in f)Object.prototype.hasOwnProperty.call(f,b)&&(r[b]=f[b])}return r},writable:!0,configurable:!0});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(n){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(typeof n!="function")throw new TypeError("predicate must be a function");for(var t=arguments[1],f=0;f<r;){var b=i[f];if(n.call(t,b,f,i))return f;f++}return-1},configurable:!0,writable:!0});var uc="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",Os={mp4:uc},Mt=function(){var e,n,i,r,t=[],f=t.concat,b=t.filter,D=t.slice,m=window.document,N={},x={},F={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},M=/^\s*<(\w+|!)[^>]*>/,K=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,I=/^(?:body|html)$/i,k=/([A-Z])/g,S=["val","css","html","text","data","width","height","offset"],L=["after","prepend","before","append"],R=m.createElement("table"),O=m.createElement("tr"),C={tr:m.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:O,th:O,"*":m.createElement("div")},y=/complete|loaded|interactive/,u=/^[\w-]*$/,l={},c=l.toString,d={},o,a,s=m.createElement("div"),h={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},p=Array.isArray||function(U){return U instanceof Array};d.matches=function(U,H){if(!H||!U||U.nodeType!==1)return!1;var $=U.matches||U.webkitMatchesSelector||U.mozMatchesSelector||U.oMatchesSelector||U.matchesSelector;if($)return $.call(U,H);var J,te=U.parentNode,ie=!te;return ie&&(te=s).appendChild(U),J=~d.qsa(te,H).indexOf(U),ie&&s.removeChild(U),J};function _(U){return U==null?String(U):l[c.call(U)]||"object"}function v(U){return _(U)=="function"}function A(U){return U!=null&&U==U.window}function E(U){return U!=null&&U.nodeType==U.DOCUMENT_NODE}function g(U){return _(U)=="object"}function T(U){return g(U)&&!A(U)&&Object.getPrototypeOf(U)==Object.prototype}function P(U){var H=!!U&&"length"in U&&U.length,$=i.type(U);return $!="function"&&!A(U)&&($=="array"||H===0||typeof H=="number"&&H>0&&H-1 in U)}function B(U){return b.call(U,function(H){return H!=null})}function V(U){return U.length>0?i.fn.concat.apply([],U):U}o=function(U){return U.replace(/-+(.)?/g,function(H,$){return $?$.toUpperCase():""})};function W(U){return U.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}a=function(U){return b.call(U,function(H,$){return U.indexOf(H)==$})};function j(U){return U in x?x[U]:x[U]=new RegExp("(^|\\s)"+U+"(\\s|$)")}function z(U,H){return typeof H=="number"&&!F[W(U)]?H+"px":H}function Q(U){var H,$;return N[U]||(H=m.createElement(U),m.body.appendChild(H),$=getComputedStyle(H,"").getPropertyValue("display"),H.parentNode.removeChild(H),$=="none"&&($="block"),N[U]=$),N[U]}function Z(U){return"children"in U?D.call(U.children):i.map(U.childNodes,function(H){if(H.nodeType==1)return H})}function ee(U,H){var $,J=U?U.length:0;for($=0;$<J;$++)this[$]=U[$];this.length=J,this.selector=H||""}d.fragment=function(U,H,$){var J,te,ie;return K.test(U)&&(J=i(m.createElement(RegExp.$1))),J||(U.replace&&(U=U.replace(w,"<$1></$2>")),H===e&&(H=M.test(U)&&RegExp.$1),H in C||(H="*"),ie=C[H],ie.innerHTML=""+U,J=i.each(D.call(ie.childNodes),function(){ie.removeChild(this)})),T($)&&(te=i(J),i.each($,function(le,oe){S.indexOf(le)>-1?te[le](oe):te.attr(le,oe)})),J},d.Z=function(U,H){return new ee(U,H)},d.isZ=function(U){return U instanceof d.Z},d.init=function(U,H){var $;if(U)if(typeof U=="string")if(U=U.trim(),U[0]=="<"&&M.test(U))$=d.fragment(U,RegExp.$1,H),U=null;else{if(H!==e)return i(H).find(U);$=d.qsa(m,U)}else{if(v(U))return i(m).ready(U);if(d.isZ(U))return U;if(p(U))$=B(U);else if(g(U))$=[U],U=null;else if(M.test(U))$=d.fragment(U.trim(),RegExp.$1,H),U=null;else{if(H!==e)return i(H).find(U);$=d.qsa(m,U)}}else return d.Z();return d.Z($,U)},i=function(U,H){return d.init(U,H)};function ae(U,H,$){for(n in H)$&&(T(H[n])||p(H[n]))?(T(H[n])&&!T(U[n])&&(U[n]={}),p(H[n])&&!p(U[n])&&(U[n]=[]),ae(U[n],H[n],$)):H[n]!==e&&(U[n]=H[n])}i.extend=function(U){var H,$=D.call(arguments,1);return typeof U=="boolean"&&(H=U,U=$.shift()),$.forEach(function(J){ae(U,J,H)}),U},d.qsa=function(U,H){var $,J=H[0]=="#",te=!J&&H[0]==".",ie=J||te?H.slice(1):H,le=u.test(ie);return U.getElementById&&le&&J?($=U.getElementById(ie))?[$]:[]:U.nodeType!==1&&U.nodeType!==9&&U.nodeType!==11?[]:D.call(le&&!J&&U.getElementsByClassName?te?U.getElementsByClassName(ie):U.getElementsByTagName(H):U.querySelectorAll(H))};function se(U,H){return H==null?i(U):i(U).filter(H)}i.contains=m.documentElement.contains?function(U,H){return U!==H&&U.contains(H)}:function(U,H){for(;H&&(H=H.parentNode);)if(H===U)return!0;return!1};function Y(U,H,$,J){return v(H)?H.call(U,$,J):H}function X(U,H,$){$==null?U.removeAttribute(H):U.setAttribute(H,$)}function q(U,H){var $=U.className||"",J=$&&$.baseVal!==e;if(H===e)return J?$.baseVal:$;J?$.baseVal=H:U.className=H}function re(U){try{return U&&(U=="true"||(U=="false"?!1:U=="null"?null:+U+""==U?+U:/^[\[\{]/.test(U)?i.parseJSON(U):U))}catch{return U}}i.type=_,i.isFunction=v,i.isWindow=A,i.isArray=p,i.isPlainObject=T,i.isEmptyObject=function(U){var H;for(H in U)return!1;return!0},i.isNumeric=function(U){var H=Number(U),$=typeof U;return U!=null&&$!="boolean"&&($!="string"||U.length)&&!isNaN(H)&&isFinite(H)||!1},i.inArray=function(U,H,$){return t.indexOf.call(H,U,$)},i.camelCase=o,i.trim=function(U){return U==null?"":String.prototype.trim.call(U)},i.uuid=0,i.support={},i.expr={},i.noop=function(){},i.map=function(U,H){var $,J=[],te,ie;if(P(U))for(te=0;te<U.length;te++)$=H(U[te],te),$!=null&&J.push($);else for(ie in U)$=H(U[ie],ie),$!=null&&J.push($);return V(J)},i.each=function(U,H){var $,J;if(P(U)){for($=0;$<U.length;$++)if(H.call(U[$],$,U[$])===!1)return U}else for(J in U)if(H.call(U[J],J,U[J])===!1)return U;return U},i.grep=function(U,H){return b.call(U,H)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(U,H){l["[object "+H+"]"]=H.toLowerCase()}),i.fn={constructor:d.Z,length:0,forEach:t.forEach,reduce:t.reduce,push:t.push,sort:t.sort,splice:t.splice,indexOf:t.indexOf,concat:function(){var U,H,$=[];for(U=0;U<arguments.length;U++)H=arguments[U],$[U]=d.isZ(H)?H.toArray():H;return f.apply(d.isZ(this)?this.toArray():this,$)},map:function(U){return i(i.map(this,function(H,$){return U.call(H,$,H)}))},slice:function(){return i(D.apply(this,arguments))},ready:function(U){return y.test(m.readyState)&&m.body?U(i):m.addEventListener("DOMContentLoaded",function(){U(i)},!1),this},get:function(U){return U===e?D.call(this):this[U>=0?U:U+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(U){return t.every.call(this,function(H,$){return U.call(H,$,H)!==!1}),this},filter:function(U){return v(U)?this.not(this.not(U)):i(b.call(this,function(H){return d.matches(H,U)}))},add:function(U,H){return i(a(this.concat(i(U,H))))},is:function(U){return this.length>0&&d.matches(this[0],U)},not:function(U){var H=[];if(v(U)&&U.call!==e)this.each(function(J){U.call(this,J)||H.push(this)});else{var $=typeof U=="string"?this.filter(U):P(U)&&v(U.item)?D.call(U):i(U);this.forEach(function(J){$.indexOf(J)<0&&H.push(J)})}return i(H)},has:function(U){return this.filter(function(){return g(U)?i.contains(this,U):i(this).find(U).size()})},eq:function(U){return U===-1?this.slice(U):this.slice(U,+U+1)},first:function(){var U=this[0];return U&&!g(U)?U:i(U)},last:function(){var U=this[this.length-1];return U&&!g(U)?U:i(U)},find:function(U){var H,$=this;return U?typeof U=="object"?H=i(U).filter(function(){var J=this;return t.some.call($,function(te){return i.contains(te,J)})}):this.length==1?H=i(d.qsa(this[0],U)):H=this.map(function(){return d.qsa(this,U)}):H=i(),H},closest:function(U,H){var $=[],J=typeof U=="object"&&i(U);return this.each(function(te,ie){for(;ie&&!(J?J.indexOf(ie)>=0:d.matches(ie,U));)ie=ie!==H&&!E(ie)&&ie.parentNode;ie&&$.indexOf(ie)<0&&$.push(ie)}),i($)},parents:function(U){for(var H=[],$=this;$.length>0;)$=i.map($,function(J){if((J=J.parentNode)&&!E(J)&&H.indexOf(J)<0)return H.push(J),J});return se(H,U)},parent:function(U){return se(a(this.pluck("parentNode")),U)},children:function(U){return se(this.map(function(){return Z(this)}),U)},contents:function(){return this.map(function(){return this.contentDocument||D.call(this.childNodes)})},siblings:function(U){return se(this.map(function(H,$){return b.call(Z($.parentNode),function(J){return J!==$})}),U)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(U){return i.map(this,function(H){return H[U]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=Q(this.nodeName))})},replaceWith:function(U){return this.before(U).remove()},wrap:function(U){var H=v(U);if(this[0]&&!H)var $=i(U).get(0),J=$.parentNode||this.length>1;return this.each(function(te){i(this).wrapAll(H?U.call(this,te):J?$.cloneNode(!0):$)})},wrapAll:function(U){if(this[0]){i(this[0]).before(U=i(U));for(var H;(H=U.children()).length;)U=H.first();i(U).append(this)}return this},wrapInner:function(U){var H=v(U);return this.each(function($){var J=i(this),te=J.contents(),ie=H?U.call(this,$):U;te.length?te.wrapAll(ie):J.append(ie)})},unwrap:function(){return this.parent().each(function(){i(this).replaceWith(i(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(U){return this.each(function(){var H=i(this);(U===e?H.css("display")=="none":U)?H.show():H.hide()})},prev:function(U){return i(this.pluck("previousElementSibling")).filter(U||"*")},next:function(U){return i(this.pluck("nextElementSibling")).filter(U||"*")},html:function(U){return 0 in arguments?this.each(function(H){var $=this.innerHTML;i(this).empty().append(Y(this,U,H,$))}):0 in this?this[0].innerHTML:null},text:function(U){return 0 in arguments?this.each(function(H){var $=Y(this,U,H,this.textContent);this.textContent=$==null?"":""+$}):0 in this?this.pluck("textContent").join(""):null},attr:function(U,H){var $;return typeof U=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&($=this[0].getAttribute(U))!=null?$:e:this.each(function(J){if(this.nodeType===1)if(g(U))for(n in U)X(this,n,U[n]);else X(this,U,Y(this,H,J,this.getAttribute(U)))})},removeAttr:function(U){return this.each(function(){this.nodeType===1&&U.split(" ").forEach(function(H){X(this,H)},this)})},prop:function(U,H){return U=h[U]||U,1 in arguments?this.each(function($){this[U]=Y(this,H,$,this[U])}):this[0]&&this[0][U]},removeProp:function(U){return U=h[U]||U,this.each(function(){delete this[U]})},data:function(U,H){var $="data-"+U.replace(k,"-$1").toLowerCase(),J=1 in arguments?this.attr($,H):this.attr($);return J!==null?re(J):e},val:function(U){return 0 in arguments?(U==null&&(U=""),this.each(function(H){this.value=Y(this,U,H,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(U){if(U)return this.each(function($){var J=i(this),te=Y(this,U,$,J.offset()),ie=J.offsetParent().offset(),le={top:te.top-ie.top,left:te.left-ie.left};J.css("position")=="static"&&(le.position="relative"),J.css(le)});if(!this.length)return null;if(m.documentElement!==this[0]&&!i.contains(m.documentElement,this[0]))return{top:0,left:0};var H=this[0].getBoundingClientRect();return{left:H.left+window.pageXOffset,top:H.top+window.pageYOffset,width:Math.round(H.width),height:Math.round(H.height)}},css:function(U,H){if(arguments.length<2){var $=this[0];if(typeof U=="string")return $?$.style[o(U)]||getComputedStyle($,"").getPropertyValue(U):void 0;if(p(U)){if(!$)return;var J={},te=getComputedStyle($,"");return i.each(U,function(le,oe){J[oe]=$.style[o(oe)]||te.getPropertyValue(oe)}),J}}var ie="";if(_(U)=="string")!H&&H!==0?this.each(function(){this.style.removeProperty(W(U))}):ie=W(U)+":"+z(U,H);else for(n in U)!U[n]&&U[n]!==0?this.each(function(){this.style.removeProperty(W(n))}):ie+=W(n)+":"+z(n,U[n])+";";return this.each(function(){this.style.cssText+=";"+ie})},index:function(U){return U?this.indexOf(i(U)[0]):this.parent().children().indexOf(this[0])},hasClass:function(U){return U?t.some.call(this,function(H){return this.test(q(H))},j(U)):!1},addClass:function(U){return U?this.each(function(H){if("className"in this){r=[];var $=q(this),J=Y(this,U,H,$);J.split(/\s+/g).forEach(function(te){i(this).hasClass(te)||r.push(te)},this),r.length&&q(this,$+($?" ":"")+r.join(" "))}}):this},removeClass:function(U){return this.each(function(H){if("className"in this){if(U===e)return q(this,"");r=q(this),Y(this,U,H,r).split(/\s+/g).forEach(function($){r=r.replace(j($)," ")}),q(this,r.trim())}})},toggleClass:function(U,H){return U?this.each(function($){var J=i(this),te=Y(this,U,$,q(this));te.split(/\s+/g).forEach(function(ie){(H===e?!J.hasClass(ie):H)?J.addClass(ie):J.removeClass(ie)})}):this},scrollTop:function(U){if(this.length){var H="scrollTop"in this[0];return U===e?H?this[0].scrollTop:this[0].pageYOffset:this.each(H?function(){this.scrollTop=U}:function(){this.scrollTo(this.scrollX,U)})}},scrollLeft:function(U){if(this.length){var H="scrollLeft"in this[0];return U===e?H?this[0].scrollLeft:this[0].pageXOffset:this.each(H?function(){this.scrollLeft=U}:function(){this.scrollTo(U,this.scrollY)})}},position:function(){if(this.length){var U=this[0],H=this.offsetParent(),$=this.offset(),J=I.test(H[0].nodeName)?{top:0,left:0}:H.offset();return $.top-=parseFloat(i(U).css("margin-top"))||0,$.left-=parseFloat(i(U).css("margin-left"))||0,J.top+=parseFloat(i(H[0]).css("border-top-width"))||0,J.left+=parseFloat(i(H[0]).css("border-left-width"))||0,{top:$.top-J.top,left:$.left-J.left}}},offsetParent:function(){return this.map(function(){for(var U=this.offsetParent||m.body;U&&!I.test(U.nodeName)&&i(U).css("position")=="static";)U=U.offsetParent;return U})}},i.fn.detach=i.fn.remove,["width","height"].forEach(function(U){var H=U.replace(/./,function($){return $[0].toUpperCase()});i.fn[U]=function($){var J,te=this[0];return $===e?A(te)?te["inner"+H]:E(te)?te.documentElement["scroll"+H]:(J=this.offset())&&J[U]:this.each(function(ie){te=i(this),te.css(U,Y(this,$,ie,te[U]()))})}});function ne(U,H){H(U);for(var $=0,J=U.childNodes.length;$<J;$++)ne(U.childNodes[$],H)}return L.forEach(function(U,H){var $=H%2;i.fn[U]=function(){var J,te=i.map(arguments,function(oe){var ue=[];return J=_(oe),J=="array"?(oe.forEach(function(fe){if(fe.nodeType!==e)return ue.push(fe);if(i.zepto.isZ(fe))return ue=ue.concat(fe.get());ue=ue.concat(d.fragment(fe))}),ue):J=="object"||oe==null?oe:d.fragment(oe)}),ie,le=this.length>1;return te.length<1?this:this.each(function(oe,ue){ie=$?ue:ue.parentNode,ue=H==0?ue.nextSibling:H==1?ue.firstChild:H==2?ue:null;var fe=i.contains(m.documentElement,ie);te.forEach(function(he){if(le)he=he.cloneNode(!0);else if(!ie)return i(he).remove();ie.insertBefore(he,ue),fe&&ne(he,function(ge){if(ge.nodeName!=null&&ge.nodeName.toUpperCase()==="SCRIPT"&&(!ge.type||ge.type==="text/javascript")&&!ge.src){var Ae=ge.ownerDocument?ge.ownerDocument.defaultView:window;Ae.eval.call(Ae,ge.innerHTML)}})})})},i.fn[$?U+"To":"insert"+(H?"Before":"After")]=function(J){return i(J)[U](this),this}}),d.Z.prototype=ee.prototype=i.fn,d.uniq=a,d.deserializeValue=re,i.zepto=d,i}();window.Zepto=Mt;window.$===void 0&&(window.$=Mt);(function(e){var n=+new Date,i=window.document,r,t,f=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,D=/^(?:text|application)\/xml/i,m="application/json",N="text/html",x=/^\s*$/,F=i.createElement("a");F.href=window.location.href;function M(a,s,h){var p=e.Event(s);return e(a).trigger(p,h),!p.isDefaultPrevented()}function K(a,s,h,p){if(a.global)return M(s||i,h,p)}e.active=0;function w(a){a.global&&e.active++===0&&K(a,null,"ajaxStart")}function I(a){a.global&&!--e.active&&K(a,null,"ajaxStop")}function k(a,s){var h=s.context;if(s.beforeSend.call(h,a,s)===!1||K(s,h,"ajaxBeforeSend",[a,s])===!1)return!1;K(s,h,"ajaxSend",[a,s])}function S(a,s,h,p){var _=h.context,v="success";h.success.call(_,a,v,s),p&&p.resolveWith(_,[a,v,s]),K(h,_,"ajaxSuccess",[s,h,a]),R(v,s,h)}function L(a,s,h,p,_){var v=p.context;p.error.call(v,h,s,a),_&&_.rejectWith(v,[h,s,a]),K(p,v,"ajaxError",[h,p,a||s]),R(s,h,p)}function R(a,s,h){var p=h.context;h.complete.call(p,s,a),K(h,p,"ajaxComplete",[s,h]),I(h)}function O(a,s,h){if(h.dataFilter==C)return a;var p=h.context;return h.dataFilter.call(p,a,s)}function C(){}e.ajaxJSONP=function(a,s){if(!("type"in a))return e.ajax(a);var h=a.jsonpCallback,p=(e.isFunction(h)?h():h)||"Zepto"+n++,_=i.createElement("script"),v=window[p],A,E=function(P){e(_).triggerHandler("error",P||"abort")},g={abort:E},T;return s&&s.promise(g),e(_).on("load error",function(P,B){clearTimeout(T),e(_).off().remove(),P.type=="error"||!A?L(null,B||"error",g,a,s):S(A[0],g,a,s),window[p]=v,A&&e.isFunction(v)&&v(A[0]),v=A=void 0}),k(g,a)===!1?(E("abort"),g):(window[p]=function(){A=arguments},_.src=a.url.replace(/\?(.+)=\?/,"?$1="+p),i.head.appendChild(_),a.timeout>0&&(T=setTimeout(function(){E("timeout")},a.timeout)),g)},e.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:m,xml:"application/xml, text/xml",html:N,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:C};function y(a){return a&&(a=a.split(";",2)[0]),a&&(a==N?"html":a==m?"json":b.test(a)?"script":D.test(a)&&"xml")||"text"}function u(a,s){return s==""?a:(a+"&"+s).replace(/[&?]{1,2}/,"?")}function l(a){a.processData&&a.data&&e.type(a.data)!="string"&&(a.data=e.param(a.data,a.traditional)),a.data&&(!a.type||a.type.toUpperCase()=="GET"||a.dataType=="jsonp")&&(a.url=u(a.url,a.data),a.data=void 0)}e.ajax=function(a){var s=e.extend({},a||{}),h=e.Deferred&&e.Deferred(),p,_;for(r in e.ajaxSettings)s[r]===void 0&&(s[r]=e.ajaxSettings[r]);w(s),s.crossDomain||(p=i.createElement("a"),p.href=s.url,p.href=p.href,s.crossDomain=F.protocol+"//"+F.host!=p.protocol+"//"+p.host),s.url||(s.url=window.location.toString()),(_=s.url.indexOf("#"))>-1&&(s.url=s.url.slice(0,_)),l(s);var v=s.dataType,A=/\?.+=\?/.test(s.url);if(A&&(v="jsonp"),(s.cache===!1||(!a||a.cache!==!0)&&(v=="script"||v=="jsonp"))&&(s.url=u(s.url,"_="+Date.now())),v=="jsonp")return A||(s.url=u(s.url,s.jsonp?s.jsonp+"=?":s.jsonp===!1?"":"callback=?")),e.ajaxJSONP(s,h);var E=s.accepts[v],g={},T=function(z,Q){g[z.toLowerCase()]=[z,Q]},P=/^([\w-]+:)\/\//.test(s.url)?RegExp.$1:window.location.protocol,B=s.xhr(),V=B.setRequestHeader,W;if(h&&h.promise(B),s.crossDomain||T("X-Requested-With","XMLHttpRequest"),T("Accept",E||"*/*"),(E=s.mimeType||E)&&(E.indexOf(",")>-1&&(E=E.split(",",2)[0]),B.overrideMimeType&&B.overrideMimeType(E)),(s.contentType||s.contentType!==!1&&s.data&&s.type.toUpperCase()!="GET")&&T("Content-Type",s.contentType||"application/x-www-form-urlencoded"),s.headers)for(t in s.headers)T(t,s.headers[t]);if(B.setRequestHeader=T,B.onreadystatechange=function(){if(B.readyState==4){B.onreadystatechange=C,clearTimeout(W);var z,Q=!1;if(B.status>=200&&B.status<300||B.status==304||B.status==0&&P=="file:"){if(v=v||y(s.mimeType||B.getResponseHeader("content-type")),B.responseType=="arraybuffer"||B.responseType=="blob")z=B.response;else{z=B.responseText;try{z=O(z,v,s),v=="script"?(0,eval)(z):v=="xml"?z=B.responseXML:v=="json"&&(z=x.test(z)?null:e.parseJSON(z))}catch(Z){Q=Z}if(Q)return L(Q,"parsererror",B,s,h)}S(z,B,s,h)}else L(B.statusText||null,B.status?"error":"abort",B,s,h)}},k(B,s)===!1)return B.abort(),L(null,"abort",B,s,h),B;var j="async"in s?s.async:!0;if(B.open(s.type,s.url,j,s.username,s.password),s.xhrFields)for(t in s.xhrFields)B[t]=s.xhrFields[t];for(t in g)V.apply(B,g[t]);return s.timeout>0&&(W=setTimeout(function(){B.onreadystatechange=C,B.abort(),L(null,"timeout",B,s,h)},s.timeout)),B.send(s.data?s.data:null),B};function c(a,s,h,p){return e.isFunction(s)&&(p=h,h=s,s=void 0),e.isFunction(h)||(p=h,h=void 0),{url:a,data:s,success:h,dataType:p}}e.get=function(){return e.ajax(c.apply(null,arguments))},e.post=function(){var a=c.apply(null,arguments);return a.type="POST",e.ajax(a)},e.getJSON=function(){var a=c.apply(null,arguments);return a.dataType="json",e.ajax(a)},e.fn.load=function(a,s,h){if(!this.length)return this;var p=this,_=a.split(/\s/),v,A=c(a,s,h),E=A.success;return _.length>1&&(A.url=_[0],v=_[1]),A.success=function(g){p.html(v?e("<div>").html(g.replace(f,"")).find(v):g),E&&E.apply(p,arguments)},e.ajax(A),this};var d=encodeURIComponent;function o(a,s,h,p){var _,v=e.isArray(s),A=e.isPlainObject(s);e.each(s,function(E,g){_=e.type(g),p&&(E=h?p:p+"["+(A||_=="object"||_=="array"?E:"")+"]"),!p&&v?a.add(g.name,g.value):_=="array"||!h&&_=="object"?o(a,g,h,E):a.add(E,g)})}e.param=function(a,s){var h=[];return h.add=function(p,_){e.isFunction(_)&&(_=_()),_==null&&(_=""),this.push(d(p)+"="+d(_))},o(h,a,s),h.join("&").replace(/%20/g,"+")}})(Mt);(function(e){e.Callbacks=function(n){n=e.extend({},n);var i,r,t,f,b,D,m=[],N=!n.once&&[],x=function(M){for(i=n.memory&&M,r=!0,D=f||0,f=0,b=m.length,t=!0;m&&D<b;++D)if(m[D].apply(M[0],M[1])===!1&&n.stopOnFalse){i=!1;break}t=!1,m&&(N?N.length&&x(N.shift()):i?m.length=0:F.disable())},F={add:function(){if(m){var M=m.length,K=function(w){e.each(w,function(I,k){typeof k=="function"?(!n.unique||!F.has(k))&&m.push(k):k&&k.length&&typeof k!="string"&&K(k)})};K(arguments),t?b=m.length:i&&(f=M,x(i))}return this},remove:function(){return m&&e.each(arguments,function(M,K){for(var w;(w=e.inArray(K,m,w))>-1;)m.splice(w,1),t&&(w<=b&&--b,w<=D&&--D)}),this},has:function(M){return!!(m&&(M?e.inArray(M,m)>-1:m.length))},empty:function(){return b=m.length=0,this},disable:function(){return m=N=i=void 0,this},disabled:function(){return!m},lock:function(){return N=void 0,i||F.disable(),this},locked:function(){return!N},fireWith:function(M,K){return m&&(!r||N)&&(K=K||[],K=[M,K.slice?K.slice():K],t?N.push(K):x(K)),this},fire:function(){return F.fireWith(this,arguments)},fired:function(){return!!r}};return F}})(Mt);(function(e){var n=Array.prototype.slice;function i(r){var t=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],f="pending",b={state:function(){return f},always:function(){return D.done(arguments).fail(arguments),this},then:function(){var m=arguments;return i(function(N){e.each(t,function(x,F){var M=e.isFunction(m[x])&&m[x];D[F[1]](function(){var K=M&&M.apply(this,arguments);if(K&&e.isFunction(K.promise))K.promise().done(N.resolve).fail(N.reject).progress(N.notify);else{var w=this===b?N.promise():this,I=M?[K]:arguments;N[F[0]+"With"](w,I)}})}),m=null}).promise()},promise:function(m){return m!=null?e.extend(m,b):b}},D={};return e.each(t,function(m,N){var x=N[2],F=N[3];b[N[1]]=x.add,F&&x.add(function(){f=F},t[m^1][2].disable,t[2][2].lock),D[N[0]]=function(){return D[N[0]+"With"](this===D?b:this,arguments),this},D[N[0]+"With"]=x.fireWith}),b.promise(D),r&&r.call(D,D),D}e.when=function(r){var t=n.call(arguments),f=t.length,b=0,D=f!==1||r&&e.isFunction(r.promise)?f:0,m=D===1?r:i(),N,x,F,M=function(K,w,I){return function(k){w[K]=this,I[K]=arguments.length>1?n.call(arguments):k,I===N?m.notifyWith(w,I):--D||m.resolveWith(w,I)}};if(f>1)for(N=new Array(f),x=new Array(f),F=new Array(f);b<f;++b)t[b]&&e.isFunction(t[b].promise)?t[b].promise().done(M(b,F,t)).fail(m.reject).progress(M(b,x,N)):--D;return D||m.resolveWith(F,t),m.promise()},e.Deferred=i})(Mt);(function(e){var n=1,i,r=Array.prototype.slice,t=e.isFunction,f=function(c){return typeof c=="string"},b={},D={},m="onfocusin"in window,N={focus:"focusin",blur:"focusout"},x={mouseenter:"mouseover",mouseleave:"mouseout"};D.click=D.mousedown=D.mouseup=D.mousemove="MouseEvents";function F(c){return c._zid||(c._zid=n++)}function M(c,d,o,a){if(d=K(d),d.ns)var s=w(d.ns);return(b[F(c)]||[]).filter(function(h){return h&&(!d.e||h.e==d.e)&&(!d.ns||s.test(h.ns))&&(!o||F(h.fn)===F(o))&&(!a||h.sel==a)})}function K(c){var d=(""+c).split(".");return{e:d[0],ns:d.slice(1).sort().join(" ")}}function w(c){return new RegExp("(?:^| )"+c.replace(" "," .* ?")+"(?: |$)")}function I(c,d){return c.del&&!m&&c.e in N||!!d}function k(c){return x[c]||m&&N[c]||c}function S(c,d,o,a,s,h,p){var _=F(c),v=b[_]||(b[_]=[]);d.split(/\s/).forEach(function(A){if(A=="ready")return e(document).ready(o);var E=K(A);E.fn=o,E.sel=s,E.e in x&&(o=function(T){var P=T.relatedTarget;if(!P||P!==this&&!e.contains(this,P))return E.fn.apply(this,arguments)}),E.del=h;var g=h||o;E.proxy=function(T){if(T=u(T),!T.isImmediatePropagationStopped()){T.data=a;var P=g.apply(c,T._args==i?[T]:[T].concat(T._args));return P===!1&&(T.preventDefault(),T.stopPropagation()),P}},E.i=v.length,v.push(E),"addEventListener"in c&&c.addEventListener(k(E.e),E.proxy,I(E,p))})}function L(c,d,o,a,s){var h=F(c);(d||"").split(/\s/).forEach(function(p){M(c,p,o,a).forEach(function(_){delete b[h][_.i],"removeEventListener"in c&&c.removeEventListener(k(_.e),_.proxy,I(_,s))})})}e.event={add:S,remove:L},e.proxy=function(c,d){var o=2 in arguments&&r.call(arguments,2);if(t(c)){var a=function(){return c.apply(d,o?o.concat(r.call(arguments)):arguments)};return a._zid=F(c),a}else{if(f(d))return o?(o.unshift(c[d],c),e.proxy.apply(null,o)):e.proxy(c[d],c);throw new TypeError("expected function")}},e.fn.bind=function(c,d,o){return this.on(c,d,o)},e.fn.unbind=function(c,d){return this.off(c,d)},e.fn.one=function(c,d,o,a){return this.on(c,d,o,a,1)};var R=function(){return!0},O=function(){return!1},C=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function u(c,d){return(d||!c.isDefaultPrevented)&&(d||(d=c),e.each(y,function(o,a){var s=d[o];c[o]=function(){return this[a]=R,s&&s.apply(d,arguments)},c[a]=O}),c.timeStamp||(c.timeStamp=Date.now()),(d.defaultPrevented!==i?d.defaultPrevented:"returnValue"in d?d.returnValue===!1:d.getPreventDefault&&d.getPreventDefault())&&(c.isDefaultPrevented=R)),c}function l(c){var d,o={originalEvent:c};for(d in c)!C.test(d)&&c[d]!==i&&(o[d]=c[d]);return u(o,c)}e.fn.delegate=function(c,d,o){return this.on(d,c,o)},e.fn.undelegate=function(c,d,o){return this.off(d,c,o)},e.fn.live=function(c,d){return e(document.body).delegate(this.selector,c,d),this},e.fn.die=function(c,d){return e(document.body).undelegate(this.selector,c,d),this},e.fn.on=function(c,d,o,a,s){var h,p,_=this;return c&&!f(c)?(e.each(c,function(v,A){_.on(v,d,o,A,s)}),_):(!f(d)&&!t(a)&&a!==!1&&(a=o,o=d,d=i),(a===i||o===!1)&&(a=o,o=i),a===!1&&(a=O),_.each(function(v,A){s&&(h=function(E){return L(A,E.type,a),a.apply(this,arguments)}),d&&(p=function(E){var g,T=e(E.target).closest(d,A).get(0);if(T&&T!==A)return g=e.extend(l(E),{currentTarget:T,liveFired:A}),(h||a).apply(T,[g].concat(r.call(arguments,1)))}),S(A,c,a,o,d,p||h)}))},e.fn.off=function(c,d,o){var a=this;return c&&!f(c)?(e.each(c,function(s,h){a.off(s,d,h)}),a):(!f(d)&&!t(o)&&o!==!1&&(o=d,d=i),o===!1&&(o=O),a.each(function(){L(this,c,o,d)}))},e.fn.trigger=function(c,d){return c=f(c)||e.isPlainObject(c)?e.Event(c):u(c),c._args=d,this.each(function(){c.type in N&&typeof this[c.type]=="function"?this[c.type]():"dispatchEvent"in this?this.dispatchEvent(c):e(this).triggerHandler(c,d)})},e.fn.triggerHandler=function(c,d){var o,a;return this.each(function(s,h){o=l(f(c)?e.Event(c):c),o._args=d,o.target=h,e.each(M(h,c.type||c),function(p,_){if(a=_.proxy(o),o.isImmediatePropagationStopped())return!1})}),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(c){e.fn[c]=function(d){return 0 in arguments?this.bind(c,d):this.trigger(c)}}),e.Event=function(c,d){f(c)||(d=c,c=d.type);var o=document.createEvent(D[c]||"Events"),a=!0;if(d)for(var s in d)s=="bubbles"?a=!!d[s]:o[s]=d[s];return o.initEvent(c,a,!0),u(o)}})(Mt);(function(){try{getComputedStyle(void 0)}catch{var e=getComputedStyle;window.getComputedStyle=function(i,r){try{return e(i,r)}catch{return null}}}})();(function(e){var n=e.zepto,i=n.qsa,r=n.matches;function t(x){return x=e(x),!!(x.width()||x.height())&&x.css("display")!=="none"}var f=e.expr[":"]={visible:function(){if(t(this))return this},hidden:function(){if(!t(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(x){if(x===0)return this},last:function(x,F){if(x===F.length-1)return this},eq:function(x,F,M){if(x===M)return this},contains:function(x,F,M){if(e(this).text().indexOf(M)>-1)return this},has:function(x,F,M){if(n.qsa(this,M).length)return this}},b=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),D=/^\s*>/,m="Zepto"+ +new Date;function N(x,F){x=x.replace(/=#\]/g,'="#"]');var M,K,w=b.exec(x);if(w&&w[2]in f&&(M=f[w[2]],K=w[3],x=w[1],K)){var I=Number(K);isNaN(I)?K=K.replace(/^["']|["']$/g,""):K=I}return F(x,M,K)}n.qsa=function(x,F){return N(F,function(M,K,w){try{var I;!M&&K?M="*":D.test(M)&&(I=e(x).addClass(m),M="."+m+" "+M);var k=i(x,M)}catch(S){throw console.error("error performing selector: %o",F),S}finally{I&&I.removeClass(m)}return K?n.uniq(e.map(k,function(S,L){return K.call(S,L,k,w)})):k})},n.matches=function(x,F){return N(F,function(M,K,w){return(!M||r(x,M))&&(!K||K.call(x,null,w)===x)})}})(Mt);var ve=Mt,cc=[{name:"Chromium",group:"Chrome",identifier:"Chromium/([0-9.]*)"},{name:"Chrome Mobile",group:"Chrome",identifier:"Chrome/([0-9.]*) Mobile",versionIdentifier:"Chrome/([0-9.]*)"},{name:"Chrome",group:"Chrome",identifier:"Chrome/([0-9.]*)"},{name:"Chrome for iOS",group:"Chrome",identifier:"CriOS/([0-9.]*)"},{name:"Android Browser",group:"Chrome",identifier:"CrMo/([0-9.]*)"},{name:"Firefox",group:"Firefox",identifier:"Firefox/([0-9.]*)"},{name:"Opera Mini",group:"Opera",identifier:"Opera Mini/([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera ([0-9.]*)"},{name:"Opera",group:"Opera",identifier:"Opera/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"},{name:"IEMobile",group:"Explorer",identifier:"IEMobile/([0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"MSIE ([a-zA-Z0-9.]*)"},{name:"Internet Explorer",group:"Explorer",identifier:"Trident/([0-9.]*)",versionIdentifier:"rv:([0-9.]*)"},{name:"Spartan",group:"Spartan",identifier:"Edge/([0-9.]*)",versionIdentifier:"Edge/([0-9.]*)"},{name:"Safari",group:"Safari",identifier:"Safari/([0-9.]*)",versionIdentifier:"Version/([0-9.]*)"}],fc=[{name:"Windows 2000",group:"Windows",identifier:"Windows NT 5.0",version:"5.0"},{name:"Windows XP",group:"Windows",identifier:"Windows NT 5.1",version:"5.1"},{name:"Windows Vista",group:"Windows",identifier:"Windows NT 6.0",version:"6.0"},{name:"Windows 7",group:"Windows",identifier:"Windows NT 6.1",version:"7.0"},{name:"Windows 8",group:"Windows",identifier:"Windows NT 6.2",version:"8.0"},{name:"Windows 8.1",group:"Windows",identifier:"Windows NT 6.3",version:"8.1"},{name:"Windows 10",group:"Windows",identifier:"Windows NT 10.0",version:"10.0"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone ([0-9.]*)"},{name:"Windows Phone",group:"Windows Phone",identifier:"Windows Phone OS ([0-9.]*)"},{name:"Windows",group:"Windows",identifier:"Windows"},{name:"Chrome OS",group:"Chrome OS",identifier:"CrOS"},{name:"Android",group:"Android",identifier:"Android",versionIdentifier:"Android ([a-zA-Z0-9.-]*)"},{name:"iPad",group:"iOS",identifier:"iPad",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPod",group:"iOS",identifier:"iPod",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"iPhone",group:"iOS",identifier:"iPhone OS",versionIdentifier:"OS ([0-9_]*)",versionSeparator:"[_|.]"},{name:"Mac OS X High Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])13([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Sierra",group:"Mac OS",identifier:"Mac OS X (10([_|.])12([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X El Capitan",group:"Mac OS",identifier:"Mac OS X (10([_|.])11([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Yosemite",group:"Mac OS",identifier:"Mac OS X (10([_|.])10([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mavericks",group:"Mac OS",identifier:"Mac OS X (10([_|.])9([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Mountain Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])8([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Lion",group:"Mac OS",identifier:"Mac OS X (10([_|.])7([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Snow Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])6([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Leopard",group:"Mac OS",identifier:"Mac OS X (10([_|.])5([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Tiger",group:"Mac OS",identifier:"Mac OS X (10([_|.])4([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Panther",group:"Mac OS",identifier:"Mac OS X (10([_|.])3([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Jaguar",group:"Mac OS",identifier:"Mac OS X (10([_|.])2([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Puma",group:"Mac OS",identifier:"Mac OS X (10([_|.])1([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS X Cheetah",group:"Mac OS",identifier:"Mac OS X (10([_|.])0([0-9_.]*))",versionSeparator:"[_|.]"},{name:"Mac OS",group:"Mac OS",identifier:"Mac OS"},{name:"Ubuntu",group:"Linux",identifier:"Ubuntu",versionIdentifier:"Ubuntu/([0-9.]*)"},{name:"Debian",group:"Linux",identifier:"Debian"},{name:"Gentoo",group:"Linux",identifier:"Gentoo"},{name:"Linux",group:"Linux",identifier:"Linux"},{name:"BlackBerry",group:"BlackBerry",identifier:"BlackBerry"}],de={},dc=function(){try{return localStorage.setItem("clappr","clappr"),localStorage.removeItem("clappr"),!0}catch{return!1}},hc=function(){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!n}catch{return!!(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==void 0&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)}},vc=function(n){var i=n.match(/\b(playstation 4|nx|opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],r;if(/trident/i.test(i[1]))return r=/\brv[ :]+(\d+)/g.exec(n)||[],{name:"IE",version:parseInt(r[1]||"")};if(i[1]==="Chrome"){if(r=n.match(/\bOPR\/(\d+)/),r!=null)return{name:"Opera",version:parseInt(r[1])};if(r=n.match(/\bEdge\/(\d+)/),r!=null)return{name:"Edge",version:parseInt(r[1])}}else/android/i.test(n)&&(r=n.match(/version\/(\d+)/i))&&(i.splice(1,1,"Android WebView"),i.splice(2,1,r[1]));return i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],{name:i[0],version:parseInt(i[1])}},gc=function(){var n={},i=de.userAgent.toLowerCase(),r=Ps(cc),t;try{for(r.s();!(t=r.n()).done;){var f=t.value,b=new RegExp(f.identifier.toLowerCase()),D=b.exec(i);if(D!=null&&D[1]){if(n.name=f.name,n.group=f.group,f.versionIdentifier){var m=new RegExp(f.versionIdentifier.toLowerCase()),N=m.exec(i);N!=null&&N[1]&&va(N[1],n)}else va(D[1],n);break}}}catch(x){r.e(x)}finally{r.f()}return n},va=function(n,i){var r=n.split(".",2);i.fullVersion=n,r[0]&&(i.majorVersion=parseInt(r[0])),r[1]&&(i.minorVersion=parseInt(r[1]))},pc=function(){var n={},i=de.userAgent.toLowerCase(),r=Ps(fc),t;try{for(r.s();!(t=r.n()).done;){var f=t.value,b=new RegExp(f.identifier.toLowerCase()),D=b.exec(i);if(D!=null){if(n.name=f.name,n.group=f.group,f.version)Mn(f.version,f.versionSeparator?f.versionSeparator:".",n);else if(D[1])Mn(D[1],f.versionSeparator?f.versionSeparator:".",n);else if(f.versionIdentifier){var m=new RegExp(f.versionIdentifier.toLowerCase()),N=m.exec(i);N!=null&&N[1]&&Mn(N[1],f.versionSeparator?f.versionSeparator:".",n)}break}}}catch(x){r.e(x)}finally{r.f()}return n},Mn=function(n,i,r){var t=i.substr(0,1)=="["?new RegExp(i,"g"):i,f=n.split(t,2);i!="."&&(n=n.replace(new RegExp(i,"g"),".")),r.fullVersion=n,f&&f[0]&&(r.majorVersion=parseInt(f[0])),f&&f[1]&&(r.minorVersion=parseInt(f[1]))},mc=function(){var n={};return n.width=ve(window).width(),n.height=ve(window).height(),n},yc=function(){switch(window.orientation){case-90:case 90:de.viewport.orientation="landscape";break;default:de.viewport.orientation="portrait";break}},Ec=function(n){var i=/\((iP(?:hone|ad|od))?(?:[^;]*; ){0,2}([^)]+(?=\)))/,r=i.exec(n),t=r&&(r[1]||r[2])||"";return t},Is=vc(navigator.userAgent);de.isEdge=/Edg|EdgiOS|EdgA/i.test(navigator.userAgent);de.isChrome=/Chrome|CriOS/i.test(navigator.userAgent)&&!de.isEdge;de.isSafari=/Safari/i.test(navigator.userAgent)&&!de.isChrome&&!de.isEdge;de.isFirefox=/Firefox/i.test(navigator.userAgent);de.isLegacyIE=!!window.ActiveXObject;de.isIE=de.isLegacyIE||/trident.*rv:1\d/i.test(navigator.userAgent);de.isIE11=/trident.*rv:11/i.test(navigator.userAgent);de.isChromecast=de.isChrome&&/CrKey/i.test(navigator.userAgent);de.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(navigator.userAgent);de.isiOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);de.isAndroid=/Android/i.test(navigator.userAgent);de.isWindowsPhone=/Windows Phone/i.test(navigator.userAgent);de.isWin8App=/MSAppHost/i.test(navigator.userAgent);de.isWiiU=/WiiU/i.test(navigator.userAgent);de.isPS4=/PlayStation 4/i.test(navigator.userAgent);de.hasLocalstorage=dc();de.hasFlash=hc();de.name=Is.name;de.version=Is.version;de.userAgent=navigator.userAgent;de.data=gc();de.os=pc();de.isWindows=/^Windows$/i.test(de.os.group);de.isMacOS=/^Mac OS$/i.test(de.os.group);de.isLinux=/^Linux$/i.test(de.os.group);de.viewport=mc();de.device=Ec(de.userAgent);typeof window.orientation<"u"&&yc();var wn={},Nn=[],Rs=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window),ks=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);function Ms(e,n){if(n)for(var i in n){var r=Object.getOwnPropertyDescriptor(n,i);r?Object.defineProperty(e,i,r):e[i]=n[i]}return e}function yr(e,n){var i=function(r){Me(f,r);var t=we(f);function f(){var b;Se(this,f);for(var D=arguments.length,m=new Array(D),N=0;N<D;N++)m[N]=arguments[N];return b=t.call.apply(t,[this].concat(m)),n.initialize&&n.initialize.apply(En(b),m),b}return xe(f)}(e);return Ms(i.prototype,n),i}function Ac(e,n){if(!isFinite(e))return"--:--";e=e*1e3,e=parseInt(e/1e3);var i=e%60;e=parseInt(e/60);var r=e%60;e=parseInt(e/60);var t=e%24,f=parseInt(e/24),b="";return f&&f>0&&(b+=f+":",t<1&&(b+="00:")),(t&&t>0||n)&&(b+=("0"+t).slice(-2)+":"),b+=("0"+r).slice(-2)+":",b+=("0"+i).slice(-2),b.trim()}var _r={fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullscreen:function(n){if(n.requestFullscreen)return n.requestFullscreen();if(n.webkitRequestFullscreen){if(typeof n.then=="function")return n.webkitRequestFullscreen();n.webkitRequestFullscreen()}else{if(n.mozRequestFullScreen)return n.mozRequestFullScreen();if(n.msRequestFullscreen)return n.msRequestFullscreen();n.querySelector&&n.querySelector("video")&&n.querySelector("video").webkitEnterFullScreen?n.querySelector("video").webkitEnterFullScreen():n.webkitEnterFullScreen&&n.webkitEnterFullScreen()}},cancelFullscreen:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;n.exitFullscreen?n.exitFullscreen():n.webkitCancelFullScreen?n.webkitCancelFullScreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen()},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},_c=function(){function e(){Se(this,e)}return xe(e,null,[{key:"_defaultConfig",value:function(){return{volume:{value:100,parse:parseInt}}}},{key:"_defaultValueFor",value:function(i){try{return this._defaultConfig()[i].parse(this._defaultConfig()[i].value)}catch{return}}},{key:"_createKeyspace",value:function(i){return"clappr.".concat(document.domain,".").concat(i)}},{key:"restore",value:function(i){return de.hasLocalstorage&&localStorage[this._createKeyspace(i)]?this._defaultConfig()[i].parse(localStorage[this._createKeyspace(i)]):this._defaultValueFor(i)}},{key:"persist",value:function(i,r){if(de.hasLocalstorage)try{return localStorage[this._createKeyspace(i)]=r,!0}catch{return!1}}}]),e}(),ei=function(){function e(){Se(this,e)}return xe(e,null,[{key:"params",get:function(){var i=window.location.search.substring(1);return i!==this.query&&(this._urlParams=this.parse(i),this.query=i),this._urlParams}},{key:"hashParams",get:function(){var i=window.location.hash.substring(1);return i!==this.hash&&(this._hashParams=this.parse(i),this.hash=i),this._hashParams}},{key:"parse",value:function(i){for(var r,t=/\+/g,f=/([^&=]+)=?([^&]*)/g,b=function(N){return decodeURIComponent(N.replace(t," "))},D={};r=f.exec(i);)D[b(r[1]).toLowerCase()]=b(r[2]);return D}}]),e}();function ws(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"t",n=0,i=ei.params[e]||ei.hashParams[e]||"",r=i.match(/[0-9]+[hms]+/g)||[];if(r.length>0){var t={h:3600,m:60,s:1};r.forEach(function(f){if(f){var b=f[f.length-1],D=parseInt(f.slice(0,f.length-1),10);n+=D*t[b]}})}else i&&(n=parseInt(i,10));return n}function wr(e){wn[e]||(wn[e]=0);var n=++wn[e];return e+n}function nn(e){return e-parseFloat(e)+1>=0}function Ns(){var e=document.getElementsByTagName("script");return e.length?e[e.length-1].src:""}function Fs(){return window.navigator&&window.navigator.language}function Tc(){return window.performance&&window.performance.now?performance.now():Date.now()}function bc(e,n){var i=e.indexOf(n);i>=0&&e.splice(i,1)}function Sc(e,n){return e===void 0||n===void 0?!1:n.find(function(i){return e.toLowerCase()===i.toLowerCase()})!==void 0}function Bs(e,n){n=Object.assign({inline:!1,muted:!1,timeout:250,type:"video",source:Os.mp4,element:null},n);var i=n.element?n.element:document.createElement(n.type);i.muted=n.muted,n.muted===!0&&i.setAttribute("muted","muted"),n.inline===!0&&i.setAttribute("playsinline","playsinline"),i.src=n.source;var r=i.play(),t=setTimeout(function(){f(!1,new Error("Timeout ".concat(n.timeout," ms has been reached")))},n.timeout),f=function(D){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;clearTimeout(t),e(D,m)};r!==void 0?r.then(function(){return f(!0)}).catch(function(b){return f(!1,b)}):f(!0)}var vr=function(){function e(){Se(this,e)}return xe(e,null,[{key:"configure",value:function(i){this.options=ve.extend(!0,this.options,i)}},{key:"create",value:function(i){return this.options.recycleVideo&&i==="video"&&Nn.length>0?Nn.shift():document.createElement(i)}},{key:"garbage",value:function(i){!this.options.recycleVideo||i.tagName.toUpperCase()!=="VIDEO"||(ve(i).children().remove(),Object.values(i.attributes).forEach(function(r){return i.removeAttribute(r.name)}),Nn.push(i))}}]),e}();vr.options={recycleVideo:!1};var Us=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:500;Se(this,e),this.delay=n,this.lastTime=0}return xe(e,[{key:"handle",value:function(i,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=new Date().getTime(),b=f-this.lastTime;b<this.delay&&b>0&&(r(),t&&i.preventDefault()),this.lastTime=f}}]),e}(),wt={Config:_c,Fullscreen:_r,QueryString:ei,DomRecycler:vr,assign:Ms,extend:yr,formatTime:Ac,seekStringToSeconds:ws,uniqueId:wr,currentScriptUrl:Ns,isNumber:nn,requestAnimationFrame:Rs,cancelAnimationFrame:ks,getBrowserLanguage:Fs,now:Tc,removeArrayItem:bc,listContainsIgnoreCase:Sc,canAutoPlayMedia:Bs,Media:Os,DoubleEventHandler:Us},An="font-weight: bold; font-size: 13px;",xc="color: #006600;"+An,Cc="color: #0000ff;"+An,Ks="color: #ff8000;"+An,ga="color: #ff0000;"+An,Ws=0,ti=1,Vs=2,Li=3,Lc=Li,Pc=[Cc,xc,Ks,ga,ga],pa=["debug","info","warn","error","disabled"],Ee=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ti,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lc;Se(this,e),this.EXCLUDE_LIST=["timeupdate","playback:timeupdate","playback:progress","container:hover","container:timeupdate","container:progress"],this.level=n,this.previousLevel=this.level,this.offLevel=i}return xe(e,[{key:"level",get:function(){return this._level},set:function(i){this._level=i}},{key:"debug",value:function(i){this.log(i,Ws,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(i){this.log(i,ti,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(i){this.log(i,Vs,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(i){this.log(i,Li,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Clappr.Log] set log level to "+pa[this.level],Ks)}},{key:"log",value:function(i,r,t){if(!(this.EXCLUDE_LIST.indexOf(t[0])>=0)&&!(r<this.level)){t||(t=i,i=null);var f=Pc[r],b="";i&&(b="["+i+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+pa[r]+"]"+b,f].concat(t))}}}]),e}();Ee.LEVEL_DEBUG=Ws;Ee.LEVEL_INFO=ti;Ee.LEVEL_WARN=Vs;Ee.LEVEL_ERROR=Li;Ee.getInstance=function(){return this._instance===void 0&&(this._instance=new this),this._instance};Ee.setLevel=function(e){this.getInstance().level=e};Ee.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)};Ee.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)};Ee.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)};Ee.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var Dc=Array.prototype.slice,ma=/\s+/,jr=function(n,i,r,t){if(!r)return!0;if(hr(r)==="object"){for(var f in r)n[i].apply(n,[f,r[f]].concat(t));return!1}if(ma.test(r)){for(var b=r.split(ma),D=0,m=b.length;D<m;D++)n[i].apply(n,[b[D]].concat(t));return!1}return!0},ya=function(n,i,r,t){var f,b=-1,D=n.length,m=i[0],N=i[1],x=i[2];F();function F(){try{switch(i.length){case 0:for(;++b<D;)(f=n[b]).callback.call(f.ctx);return;case 1:for(;++b<D;)(f=n[b]).callback.call(f.ctx,m);return;case 2:for(;++b<D;)(f=n[b]).callback.call(f.ctx,m,N);return;case 3:for(;++b<D;)(f=n[b]).callback.call(f.ctx,m,N,x);return;default:for(;++b<D;)(f=n[b]).callback.apply(f.ctx,i);return}}catch(M){Ee.error.apply(Ee,[r,"error on event",t,"trigger","-",M]),F()}}},G=function(){function e(){Se(this,e)}return xe(e,[{key:"on",value:function(i,r,t){if(!jr(this,"on",i,[r,t])||!r)return this;this._events||(this._events={});var f=this._events[i]||(this._events[i]=[]);return f.push({callback:r,context:t,ctx:t||this}),this}},{key:"once",value:function(i,r,t){var f=this,b;if(!jr(this,"once",i,[r,t])||!r)return this;var D=function(){return f.off(i,b)};return b=function(){D(),r.apply(this,arguments)},this.on(i,b,t)}},{key:"off",value:function(i,r,t){var f,b,D,m,N,x,F,M;if(!this._events||!jr(this,"off",i,[r,t]))return this;if(!i&&!r&&!t)return this._events=void 0,this;for(m=i?[i]:Object.keys(this._events),N=0,x=m.length;N<x;N++)if(i=m[N],D=this._events[i],D){if(this._events[i]=f=[],r||t)for(F=0,M=D.length;F<M;F++)b=D[F],(r&&r!==b.callback&&r!==b.callback._callback||t&&t!==b.context)&&f.push(b);f.length||delete this._events[i]}return this}},{key:"trigger",value:function(i){var r=this.name||this.constructor.name;if(Ee.debug.apply(Ee,[r].concat(Array.prototype.slice.call(arguments))),!this._events)return this;var t=Dc.call(arguments,1);if(!jr(this,"trigger",i,t))return this;var f=this._events[i],b=this._events.all;return f&&ya(f,t,r,i),b&&ya(b,arguments,r,i),this}},{key:"stopListening",value:function(i,r,t){var f=this._listeningTo;if(!f)return this;var b=!r&&!t;!t&&hr(r)==="object"&&(t=this),i&&((f={})[i._listenId]=i);for(var D in f)i=f[D],i.off(r,t,this),(b||Object.keys(i._events).length===0)&&delete this._listeningTo[D];return this}}],[{key:"register",value:function(i){e.Custom||(e.Custom={});var r=typeof i=="string"&&i.toUpperCase().trim();r&&!e.Custom[r]?e.Custom[r]=r.toLowerCase().split("_").map(function(t,f){return f===0?t:t=t[0].toUpperCase()+t.slice(1)}).join(""):Ee.error("Events","Error when register event: "+i)}},{key:"listAvailableCustomEvents",value:function(){return e.Custom||(e.Custom={}),Object.keys(e.Custom).filter(function(i){return typeof e.Custom[i]=="string"})}}]),e}(),Ea={listenTo:"on",listenToOnce:"once"};Object.keys(Ea).forEach(function(e){G.prototype[e]=function(n,i,r){var t=this._listeningTo||(this._listeningTo={}),f=n._listenId||(n._listenId=wr("l"));return t[f]=n,!r&&hr(i)==="object"&&(r=this),n[Ea[e]](i,r,this),this}});G.PLAYER_READY="ready";G.PLAYER_RESIZE="resize";G.PLAYER_FULLSCREEN="fullscreen";G.PLAYER_PLAY="play";G.PLAYER_PAUSE="pause";G.PLAYER_STOP="stop";G.PLAYER_ENDED="ended";G.PLAYER_SEEK="seek";G.PLAYER_ERROR="playererror";G.ERROR="error";G.PLAYER_TIMEUPDATE="timeupdate";G.PLAYER_VOLUMEUPDATE="volumeupdate";G.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable";G.PLAYBACK_PIP_ENTER="playback:picture-in-picture:enter";G.PLAYBACK_PIP_EXIT="playback:picture-in-picture:exit";G.PLAYBACK_PROGRESS="playback:progress";G.PLAYBACK_TIMEUPDATE="playback:timeupdate";G.PLAYBACK_READY="playback:ready";G.PLAYBACK_BUFFERING="playback:buffering";G.PLAYBACK_BUFFERFULL="playback:bufferfull";G.PLAYBACK_SETTINGSUPDATE="playback:settingsupdate";G.PLAYBACK_LOADEDMETADATA="playback:loadedmetadata";G.PLAYBACK_HIGHDEFINITIONUPDATE="playback:highdefinitionupdate";G.PLAYBACK_BITRATE="playback:bitrate";G.PLAYBACK_LEVELS_AVAILABLE="playback:levels:available";G.PLAYBACK_LEVEL_SWITCH_START="playback:levels:switch:start";G.PLAYBACK_LEVEL_SWITCH_END="playback:levels:switch:end";G.PLAYBACK_PLAYBACKSTATE="playback:playbackstate";G.PLAYBACK_DVR="playback:dvr";G.PLAYBACK_MEDIACONTROL_DISABLE="playback:mediacontrol:disable";G.PLAYBACK_MEDIACONTROL_ENABLE="playback:mediacontrol:enable";G.PLAYBACK_ENDED="playback:ended";G.PLAYBACK_PLAY_INTENT="playback:play:intent";G.PLAYBACK_PLAY="playback:play";G.PLAYBACK_PAUSE="playback:pause";G.PLAYBACK_SEEK="playback:seek";G.PLAYBACK_SEEKED="playback:seeked";G.PLAYBACK_STOP="playback:stop";G.PLAYBACK_ERROR="playback:error";G.PLAYBACK_STATS_ADD="playback:stats:add";G.PLAYBACK_FRAGMENT_LOADED="playback:fragment:loaded";G.PLAYBACK_LEVEL_SWITCH="playback:level:switch";G.PLAYBACK_SUBTITLE_AVAILABLE="playback:subtitle:available";G.PLAYBACK_SUBTITLE_CHANGED="playback:subtitle:changed";G.PLAYBACK_AUDIO_AVAILABLE="playback:audio:available";G.PLAYBACK_AUDIO_CHANGED="playback:audio:changed";G.CORE_CONTAINERS_CREATED="core:containers:created";G.CORE_ACTIVE_CONTAINER_CHANGED="core:active:container:changed";G.CORE_OPTIONS_CHANGE="core:options:change";G.CORE_READY="core:ready";G.CORE_FULLSCREEN="core:fullscreen";G.CORE_RESIZE="core:resize";G.CORE_SCREEN_ORIENTATION_CHANGED="core:screen:orientation:changed";G.CORE_MOUSE_MOVE="core:mousemove";G.CORE_MOUSE_LEAVE="core:mouseleave";G.CONTAINER_PLAYBACKSTATE="container:playbackstate";G.CONTAINER_PLAYBACKDVRSTATECHANGED="container:dvr";G.CONTAINER_BITRATE="container:bitrate";G.CONTAINER_STATS_REPORT="container:stats:report";G.CONTAINER_DESTROYED="container:destroyed";G.CONTAINER_READY="container:ready";G.CONTAINER_RESIZE="container:resize";G.CONTAINER_ERROR="container:error";G.CONTAINER_LOADEDMETADATA="container:loadedmetadata";G.CONTAINER_SUBTITLE_AVAILABLE="container:subtitle:available";G.CONTAINER_SUBTITLE_CHANGED="container:subtitle:changed";G.CONTAINER_AUDIO_AVAILABLE="container:audio:available";G.CONTAINER_AUDIO_CHANGED="container:audio:changed";G.CONTAINER_TIMEUPDATE="container:timeupdate";G.CONTAINER_PROGRESS="container:progress";G.CONTAINER_PLAY="container:play";G.CONTAINER_STOP="container:stop";G.CONTAINER_PAUSE="container:pause";G.CONTAINER_ENDED="container:ended";G.CONTAINER_CLICK="container:click";G.CONTAINER_DBLCLICK="container:dblclick";G.CONTAINER_CONTEXTMENU="container:contextmenu";G.CONTAINER_MOUSE_ENTER="container:mouseenter";G.CONTAINER_MOUSE_LEAVE="container:mouseleave";G.CONTAINER_MOUSE_UP="container:mouseup";G.CONTAINER_MOUSE_DOWN="container:mousedown";G.CONTAINER_PIP_ENTER="container:picture-in-picture:enter";G.CONTAINER_PIP_EXIT="container:picture-in-picture:exit";G.CONTAINER_SEEK="container:seek";G.CONTAINER_SEEKED="container:seeked";G.CONTAINER_VOLUME="container:volume";G.CONTAINER_FULLSCREEN="container:fullscreen";G.CONTAINER_STATE_BUFFERING="container:state:buffering";G.CONTAINER_STATE_BUFFERFULL="container:state:bufferfull";G.CONTAINER_SETTINGSUPDATE="container:settingsupdate";G.CONTAINER_HIGHDEFINITIONUPDATE="container:highdefinitionupdate";G.CONTAINER_MEDIACONTROL_SHOW="container:mediacontrol:show";G.CONTAINER_MEDIACONTROL_HIDE="container:mediacontrol:hide";G.CONTAINER_MEDIACONTROL_DISABLE="container:mediacontrol:disable";G.CONTAINER_MEDIACONTROL_ENABLE="container:mediacontrol:enable";G.CONTAINER_STATS_ADD="container:stats:add";G.CONTAINER_OPTIONS_CHANGE="container:options:change";G.MEDIACONTROL_RENDERED="mediacontrol:rendered";G.MEDIACONTROL_FULLSCREEN="mediacontrol:fullscreen";G.MEDIACONTROL_SHOW="mediacontrol:show";G.MEDIACONTROL_HIDE="mediacontrol:hide";G.MEDIACONTROL_MOUSEMOVE_SEEKBAR="mediacontrol:mousemove:seekbar";G.MEDIACONTROL_MOUSELEAVE_SEEKBAR="mediacontrol:mouseleave:seekbar";G.MEDIACONTROL_PLAYING="mediacontrol:playing";G.MEDIACONTROL_NOTPLAYING="mediacontrol:notplaying";G.MEDIACONTROL_CONTAINERCHANGED="mediacontrol:containerchanged";G.MEDIACONTROL_OPTIONS_CHANGE="mediacontrol:options:change";var er=function(e){Me(i,e);var n=we(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Se(this,i),r=n.call(this,t),r._options=t,r.uniqueId=wr("o"),r}return xe(i,[{key:"options",get:function(){return this._options}}]),i}(G),Gt={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Fn=/(.)^/,Oc={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},Ic=/\\|'|\r|\n|\t|\u2028|\u2029/g,Rc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},kc=new RegExp(`[&<>"']`,"g"),Aa=function(n){return n===null?"":(""+n).replace(kc,function(i){return Rc[i]})},Mc=0,rt=function(n,i){var r,t=new RegExp([(Gt.escape||Fn).source,(Gt.interpolate||Fn).source,(Gt.evaluate||Fn).source].join("|")+"|$","g"),f=0,b="__p+='";n.replace(t,function(m,N,x,F,M){return b+=n.slice(f,M).replace(Ic,function(K){return"\\"+Oc[K]}),N&&(b+=`'+
((__t=(`+N+`))==null?'':escapeExpr(__t))+
'`),x&&(b+=`'+
((__t=(`+x+`))==null?'':__t)+
'`),F&&(b+=`';
`+F+`
__p+='`),f=M+m.length,m}),b+=`';
`,Gt.variable||(b=`with(obj||{}){
`+b+`}
`),b=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+b+`return __p;
//# sourceURL=/microtemplates/source[`+Mc+++"]";try{r=new Function(Gt.variable||"obj","escapeExpr",b)}catch(m){throw m.source=b,m}if(i)return r(i,Aa);var D=function(N){return r.call(this,N,Aa)};return D.source="function("+(Gt.variable||"obj")+`){
`+b+"}",D};rt.settings=Gt;var ze={getStyleFor:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{baseUrl:""};return ve('<style class="clappr-style"></style>').html(rt(n.toString())(i))}},wc=/^(\S+)\s*(.*)$/,Nr=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.cid=wr("c"),t._ensureElement(),t.delegateEvents(),t}return xe(i,[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}},{key:"$",value:function(t){return this.$el.find(t)}},{key:"render",value:function(){return this}},{key:"destroy",value:function(){return this.$el.remove(),this.stopListening(),this.undelegateEvents(),this}},{key:"setElement",value:function(t,f){return this.$el&&this.undelegateEvents(),this.$el=ve.zepto.isZ(t)?t:ve(t),this.el=this.$el[0],f!==!1&&this.delegateEvents(),this}},{key:"delegateEvents",value:function(t){t||(t=this.events),this.undelegateEvents();for(var f in t){var b=t[f];if(b&&b.constructor!==Function&&(b=this[t[f]]),!!b){var D=f.match(wc),m=D[1],N=D[2];m+=".delegateEvents"+this.cid,N===""?this.$el.on(m,b.bind(this)):this.$el.on(m,N,b.bind(this))}}return this}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"_ensureElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var t=ve.extend(!0,{},this.attributes);this.id&&(t.id=this.id),this.className&&(t.class=this.className);var f=ve(vr.create(this.tagName)).attr(t);this.setElement(f,!1)}}}]),i}(er),ot=function(e){Me(i,e);var n=we(i);function i(){var r,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0;return Se(this,i),r=n.call(this,t),r.core=f,r}return xe(i,[{key:"name",get:function(){return"error"}},{key:"createError",value:function(t){if(!this.core){Ee.warn(this.name,"Core is not set. Error: ",t);return}this.core.trigger(G.ERROR,t)}}],[{key:"Levels",get:function(){return{FATAL:"FATAL",WARN:"WARN",INFO:"INFO"}}}]),i}(er),Nt={createError:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{useCodePrefix:!0},r=this.constructor&&this.constructor.type||"",t=this.name||r,f=this.i18n||this.core&&this.core.i18n||this.container&&this.container.i18n,b="".concat(t,":").concat(n&&n.code||"unknown"),D={description:"",level:ot.Levels.FATAL,origin:t,scope:r,raw:{}},m=Object.assign({},D,n,{code:i.useCodePrefix?b:n.code});if(f&&m.level==ot.Levels.FATAL&&!m.UI){var N={title:f.t("default_error_title"),message:f.t("default_error_message")};m.UI=N}return this.playerError?this.playerError.createError(m):Ee.warn(t,"PlayerError is not defined. Error: ",m),m}},yt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t.render(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"getExternalInterface",value:function(){return{}}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"render",value:function(){return this}}]),i}(Nr);Object.assign(yt.prototype,Nt);yt.extend=function(e){return yr(yt,e)};yt.type="core";var Nc=`.container[data-container] {
  position: absolute;
  background-color: black;
  height: 100%;
  width: 100%;
  max-width: 100%; }
  .container[data-container] .chromeless {
    cursor: default; }

[data-player]:not(.nocursor) .container[data-container]:not(.chromeless).pointer-enabled {
  cursor: pointer; }
`,Gs=function(e){Me(i,e);var n=we(i);function i(r,t,f){var b;return Se(this,i),b=n.call(this,r),b._i18n=t,b.currentTime=0,b.volume=100,b.playback=r.playback,b.playerError=f,b.settings=ve.extend(!0,{},b.playback.settings),b.isReady=!1,b.mediaControlDisabled=!1,b.plugins=[b.playback],b.dblTapHandler=new Us(500),b.clickTimer=null,b.clickDelay=200,b.actionsMetadata={},b.bindEvents(),b}return xe(i,[{key:"name",get:function(){return"Container"}},{key:"attributes",get:function(){return{class:"container","data-container":""}}},{key:"events",get:function(){return{click:"clicked",dblclick:"dblClicked",touchend:"dblTap",contextmenu:"onContextMenu",mouseenter:"mouseEnter",mouseleave:"mouseLeave",mouseup:"onMouseUp",mousedown:"onMouseDown"}}},{key:"ended",get:function(){return this.playback.ended}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"i18n",get:function(){return this._i18n}},{key:"hasClosedCaptionsTracks",get:function(){return this.playback.hasClosedCaptionsTracks}},{key:"closedCaptionsTracks",get:function(){return this.playback.closedCaptionsTracks}},{key:"closedCaptionsTrackId",get:function(){return this.playback.closedCaptionsTrackId},set:function(t){this.playback.closedCaptionsTrackId=t}},{key:"audioTracks",get:function(){return this.playback.audioTracks}},{key:"currentAudioTrack",get:function(){return this.playback.currentAudioTrack}},{key:"isPiPActive",get:function(){return this.playback.isPiPActive}},{key:"bindEvents",value:function(){this.listenTo(this.playback,G.PLAYBACK_PROGRESS,this.onProgress),this.listenTo(this.playback,G.PLAYBACK_TIMEUPDATE,this.timeUpdated),this.listenTo(this.playback,G.PLAYBACK_READY,this.ready),this.listenTo(this.playback,G.PLAYBACK_BUFFERING,this.onBuffering),this.listenTo(this.playback,G.PLAYBACK_BUFFERFULL,this.bufferfull),this.listenTo(this.playback,G.PLAYBACK_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.playback,G.PLAYBACK_LOADEDMETADATA,this.loadedMetadata),this.listenTo(this.playback,G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.playback,G.PLAYBACK_BITRATE,this.updateBitrate),this.listenTo(this.playback,G.PLAYBACK_PLAYBACKSTATE,this.playbackStateChanged),this.listenTo(this.playback,G.PLAYBACK_DVR,this.playbackDvrStateChanged),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_DISABLE,this.disableMediaControl),this.listenTo(this.playback,G.PLAYBACK_MEDIACONTROL_ENABLE,this.enableMediaControl),this.listenTo(this.playback,G.PLAYBACK_SEEK,this.onSeek),this.listenTo(this.playback,G.PLAYBACK_SEEKED,this.onSeeked),this.listenTo(this.playback,G.PLAYBACK_ENDED,this.onEnded),this.listenTo(this.playback,G.PLAYBACK_PLAY,this.playing),this.listenTo(this.playback,G.PLAYBACK_PAUSE,this.paused),this.listenTo(this.playback,G.PLAYBACK_STOP,this.stopped),this.listenTo(this.playback,G.PLAYBACK_ERROR,this.error),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_AVAILABLE,this.subtitleAvailable),this.listenTo(this.playback,G.PLAYBACK_SUBTITLE_CHANGED,this.subtitleChanged),this.listenTo(this.playback,G.PLAYBACK_AUDIO_AVAILABLE,this.audioAvailable),this.listenTo(this.playback,G.PLAYBACK_AUDIO_CHANGED,this.audioChanged),this.listenTo(this.playback,G.PLAYBACK_PIP_ENTER,this.onEnterPiP),this.listenTo(this.playback,G.PLAYBACK_PIP_EXIT,this.onExitPiP)}},{key:"subtitleAvailable",value:function(){this.trigger(G.CONTAINER_SUBTITLE_AVAILABLE)}},{key:"subtitleChanged",value:function(t){this.trigger(G.CONTAINER_SUBTITLE_CHANGED,t)}},{key:"audioAvailable",value:function(t){this.trigger(G.CONTAINER_AUDIO_AVAILABLE,t)}},{key:"audioChanged",value:function(t){this.trigger(G.CONTAINER_AUDIO_CHANGED,t)}},{key:"playbackStateChanged",value:function(t){this.trigger(G.CONTAINER_PLAYBACKSTATE,t)}},{key:"playbackDvrStateChanged",value:function(t){this.settings=this.playback.settings,this.dvrInUse=t,this.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,t)}},{key:"updateBitrate",value:function(t){this.trigger(G.CONTAINER_BITRATE,t)}},{key:"statsReport",value:function(t){this.trigger(G.CONTAINER_STATS_REPORT,t)}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"isDvrEnabled",value:function(){return!!this.playback.dvrEnabled}},{key:"isDvrInUse",value:function(){return!!this.dvrInUse}},{key:"destroy",value:function(){this.disableResizeObserver(),this.trigger(G.CONTAINER_DESTROYED,this,this.name),this.stopListening(),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove()}},{key:"setStyle",value:function(t){this.$el.css(t)}},{key:"animate",value:function(t,f){return this.$el.animate(t,f).promise()}},{key:"ready",value:function(){this.isReady=!0,this.trigger(G.CONTAINER_READY,this.name)}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"getStartTimeOffset",value:function(){return this.playback.getStartTimeOffset()}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"error",value:function(t){this.isReady||this.ready(),this.trigger(G.CONTAINER_ERROR,t,this.name)}},{key:"loadedMetadata",value:function(t){this.trigger(G.CONTAINER_LOADEDMETADATA,t)}},{key:"timeUpdated",value:function(t){this.currentTime=t.current,this.trigger(G.CONTAINER_TIMEUPDATE,t,this.name)}},{key:"onProgress",value:function(){for(var t=arguments.length,f=new Array(t),b=0;b<t;b++)f[b]=arguments[b];this.trigger.apply(this,[G.CONTAINER_PROGRESS].concat(f,[this.name]))}},{key:"playing",value:function(){this.trigger(G.CONTAINER_PLAY,this.name,this.actionsMetadata.playEvent||{}),this.actionsMetadata.playEvent={}}},{key:"paused",value:function(){this.trigger(G.CONTAINER_PAUSE,this.name,this.actionsMetadata.pauseEvent||{}),this.actionsMetadata.pauseEvent={}}},{key:"stopped",value:function(){this.trigger(G.CONTAINER_STOP,this.actionsMetadata.stopEvent||{}),this.actionsMetadata.stopEvent={}}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.playEvent=t,this.playback.play(t)}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.stopEvent=t,this.playback.stop(t),this.currentTime=0}},{key:"switchAudioTrack",value:function(t){this.playback.switchAudioTrack(t)}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.actionsMetadata.pauseEvent=t,this.playback.pause(t)}},{key:"onEnded",value:function(){this.trigger(G.CONTAINER_ENDED,this,this.name),this.currentTime=0}},{key:"clicked",value:function(){var t=this;(!this.options.chromeless||this.options.allowUserInteraction)&&(this.clickTimer=setTimeout(function(){t.clickTimer&&t.trigger(G.CONTAINER_CLICK,t,t.name)},this.clickDelay))}},{key:"cancelClicked",value:function(){clearTimeout(this.clickTimer),this.clickTimer=null}},{key:"dblClicked",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&(this.cancelClicked(),this.trigger(G.CONTAINER_DBLCLICK,this,this.name))}},{key:"dblTap",value:function(t){var f=this;(!this.options.chromeless||this.options.allowUserInteraction)&&this.dblTapHandler.handle(t,function(){f.cancelClicked(),f.trigger(G.CONTAINER_DBLCLICK,f,f.name)})}},{key:"onContextMenu",value:function(t){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_CONTEXTMENU,t,this.name)}},{key:"seek",value:function(t){this.playback.seek(t)}},{key:"onSeek",value:function(t){this.trigger(G.CONTAINER_SEEK,t,this.name)}},{key:"onSeeked",value:function(){this.trigger(G.CONTAINER_SEEKED,this.name)}},{key:"seekPercentage",value:function(t){var f=this.getDuration();if(t>=0&&t<=100){var b=f*(t/100);this.seek(b)}}},{key:"setVolume",value:function(t){this.volume=parseFloat(t),this.trigger(G.CONTAINER_VOLUME,this.volume,this.name),this.playback.volume(this.volume)}},{key:"fullscreen",value:function(){this.trigger(G.CONTAINER_FULLSCREEN,this.name)}},{key:"onBuffering",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERING,this.name)}},{key:"bufferfull",value:function(){this.trigger(G.CONTAINER_STATE_BUFFERFULL,this.name)}},{key:"onEnterPiP",value:function(){this.trigger(G.CONTAINER_PIP_ENTER,this.name)}},{key:"onExitPiP",value:function(){this.trigger(G.CONTAINER_PIP_EXIT,this.name)}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(f){return f.name===t})[0]}},{key:"mouseEnter",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_ENTER)}},{key:"mouseLeave",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_LEAVE)}},{key:"mouseUp",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_UP)}},{key:"mouseDown",value:function(){(!this.options.chromeless||this.options.allowUserInteraction)&&this.trigger(G.CONTAINER_MOUSE_DOWN)}},{key:"enterPiP",value:function(){this.playback.enterPiP()}},{key:"exitPiP",value:function(){this.playback.exitPiP()}},{key:"settingsUpdate",value:function(){this.settings=this.playback.settings,this.trigger(G.CONTAINER_SETTINGSUPDATE)}},{key:"highDefinitionUpdate",value:function(t){this.trigger(G.CONTAINER_HIGHDEFINITIONUPDATE,t)}},{key:"isHighDefinitionInUse",value:function(){return this.playback.isHighDefinitionInUse()}},{key:"disableMediaControl",value:function(){this.mediaControlDisabled||(this.mediaControlDisabled=!0,this.trigger(G.CONTAINER_MEDIACONTROL_DISABLE))}},{key:"enableMediaControl",value:function(){this.mediaControlDisabled&&(this.mediaControlDisabled=!1,this.trigger(G.CONTAINER_MEDIACONTROL_ENABLE))}},{key:"updateStyle",value:function(){!this.options.chromeless||this.options.allowUserInteraction?this.$el.removeClass("chromeless"):this.$el.addClass("chromeless")}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver(),this.resizeObserverInterval=setInterval(function(){return t.checkResize()},500)}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval)}},{key:"checkResize",value:function(){var t={width:this.el.clientWidth,height:this.el.clientHeight},f=this.currentSize||{},b=f.width,D=f.height,m=D!==t.height||b!==t.width;m&&(this.currentSize=t,this.trigger(G.CONTAINER_RESIZE,t))}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t),this.updateStyle(),this.playback.configure(this.options),this.trigger(G.CONTAINER_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=ze.getStyleFor(Nc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.$el.append(this.playback.render().el),this.updateStyle(),this.checkResize(),this.enableResizeObserver(),this}}]),i}(Nr);Object.assign(Gs.prototype,Nt);var pe=function(e){Me(i,e);var n=we(i);function i(r,t,f){var b;return Se(this,i),b=n.call(this,r),b.settings={},b._i18n=t,b.playerError=f,b._consented=!1,b}return xe(i,[{key:"isAudioOnly",get:function(){return!1}},{key:"isAdaptive",get:function(){return!1}},{key:"ended",get:function(){return!1}},{key:"i18n",get:function(){return this._i18n}},{key:"buffering",get:function(){return!1}},{key:"latency",get:function(){return null}},{key:"currentProgramDateTime",get:function(){return null}},{key:"isPiPActive",get:function(){return!1}},{key:"consent",value:function(t){typeof t=="function"&&t()}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){}},{key:"enterPiP",value:function(){}},{key:"exitPiP",value:function(){}},{key:"seek",value:function(t){}},{key:"seekPercentage",value:function(t){}},{key:"getStartTimeOffset",value:function(){return 0}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",get:function(){return!1}},{key:"hasClosedCaptionsTracks",get:function(){return this.closedCaptionsTracks.length>0}},{key:"closedCaptionsTracks",get:function(){return[]}},{key:"closedCaptionsTrackId",get:function(){return-1},set:function(t){}},{key:"audioTracks",get:function(){return[]}},{key:"currentAudioTrack",get:function(){return null}},{key:"switchAudioTrack",value:function(t){}},{key:"getPlaybackType",value:function(){return i.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"mute",value:function(){}},{key:"unmute",value:function(){}},{key:"volume",value:function(t){}},{key:"configure",value:function(t){this._options=ve.extend(!0,this._options,t)}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(f,b){f&&t.play()})}},{key:"canAutoPlay",value:function(t){t(!0,null)}}]),i}(Nr);Object.assign(pe.prototype,Nt);pe.extend=function(e){return yr(pe,e)};pe.canPlay=function(e,n){return!1};pe.VOD="vod";pe.AOD="aod";pe.LIVE="live";pe.NO_OP="no_op";pe.type="playback";var Fc=function(e){Me(i,e);var n=we(i);function i(r,t,f,b){var D;return Se(this,i),D=n.call(this,r),D._i18n=f,D.loader=t,D.playerError=b,D}return xe(i,[{key:"options",get:function(){return this._options},set:function(t){this._options=t}},{key:"createContainers",value:function(){var t=this;return ve.Deferred(function(f){f.resolve(t.options.sources.map(function(b){return t.createContainer(b)}))})}},{key:"findPlaybackPlugin",value:function(t,f){return this.loader.playbackPlugins.filter(function(b){return b.canPlay(t,f)})[0]}},{key:"createContainer",value:function(t){var f=null,b=this.options.mimeType;hr(t)==="object"?(f=t.source.toString(),t.mimeType&&(b=t.mimeType)):f=t.toString(),f.match(/^\/\//)&&(f=window.location.protocol+f);var D=Hr(Hr({},this.options),{},{src:f,mimeType:b}),m=this.findPlaybackPlugin(f,b),N=m?new m(D,this._i18n,this.playerError):new pe;D=Hr(Hr({},D),{},{playback:N});var x=new Gs(D,this._i18n,this.playerError),F=ve.Deferred();return F.promise(x),this.addContainerPlugins(x),this.listenToOnce(x,G.CONTAINER_READY,function(){return F.resolve(x)}),x}},{key:"addContainerPlugins",value:function(t){this.loader.containerPlugins.forEach(function(f){t.addPlugin(new f(t))})}}]),i}(er),Bc=`[data-player] {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -o-user-select: none;
  user-select: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transform: translate3d(0, 0, 0);
  position: relative;
  margin: 0;
  padding: 0;
  border: 0;
  font-style: normal;
  font-weight: normal;
  text-align: center;
  overflow: hidden;
  font-size: 100%;
  font-family: "Roboto", "Open Sans", Arial, sans-serif;
  text-shadow: 0 0 0;
  box-sizing: border-box; }
  [data-player]:focus {
    outline: 0; }
  [data-player] * {
    box-sizing: inherit; }
  [data-player] > * {
    float: none;
    max-width: none; }
  [data-player] > div {
    display: block; }
  [data-player].fullscreen {
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0; }
  [data-player].nocursor {
    cursor: none; }

.clappr-style {
  display: none !important; }
`,Uc=`[data-player] div, [data-player] span, [data-player] applet, [data-player] object, [data-player] iframe,
[data-player] h1, [data-player] h2, [data-player] h3, [data-player] h4, [data-player] h5, [data-player] h6, [data-player] p, [data-player] blockquote, [data-player] pre,
[data-player] a, [data-player] abbr, [data-player] acronym, [data-player] address, [data-player] big, [data-player] cite, [data-player] code,
[data-player] del, [data-player] dfn, [data-player] em, [data-player] img, [data-player] ins, [data-player] kbd, [data-player] q, [data-player] s, [data-player] samp,
[data-player] small, [data-player] strike, [data-player] strong, [data-player] sub, [data-player] sup, [data-player] tt, [data-player] var,
[data-player] b, [data-player] u, [data-player] i, [data-player] center,
[data-player] dl, [data-player] dt, [data-player] dd, [data-player] ol, [data-player] ul, [data-player] li,
[data-player] fieldset, [data-player] form, [data-player] label, [data-player] legend,
[data-player] table, [data-player] caption, [data-player] tbody, [data-player] tfoot, [data-player] thead, [data-player] tr, [data-player] th, [data-player] td,
[data-player] article, [data-player] aside, [data-player] canvas, [data-player] details, [data-player] embed,
[data-player] figure, [data-player] figcaption, [data-player] footer, [data-player] header, [data-player] hgroup,
[data-player] menu, [data-player] nav, [data-player] output, [data-player] ruby, [data-player] section, [data-player] summary,
[data-player] time, [data-player] mark, [data-player] audio, [data-player] video {
  margin: 0;
  padding: 0;
  border: 0;
  font: inherit;
  font-size: 100%;
  vertical-align: baseline; }

[data-player] table {
  border-collapse: collapse;
  border-spacing: 0; }

[data-player] caption, [data-player] th, [data-player] td {
  text-align: left;
  font-weight: normal;
  vertical-align: middle; }

[data-player] q, [data-player] blockquote {
  quotes: none; }
  [data-player] q:before, [data-player] q:after, [data-player] blockquote:before, [data-player] blockquote:after {
    content: "";
    content: none; }

[data-player] a img {
  border: none; }
`,Hs=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.playerError=new ot(r,En(t)),t.configureDomRecycler(),t.firstResize=!0,t.styleRendered=!1,t.plugins=[],t.containers=[],t._boundFullscreenHandler=function(){return t.handleFullscreenChange()},ve(document).bind("fullscreenchange",t._boundFullscreenHandler),ve(document).bind("MSFullscreenChange",t._boundFullscreenHandler),ve(document).bind("mozfullscreenchange",t._boundFullscreenHandler),de.isMobile&&ve(window).bind("resize",function(f){t.handleWindowResize(f)}),t}return xe(i,[{key:"events",get:function(){return{webkitfullscreenchange:"handleFullscreenChange",mousemove:"onMouseMove",mouseleave:"onMouseLeave"}}},{key:"attributes",get:function(){return{"data-player":"",tabindex:9999}}},{key:"isReady",get:function(){return!!this.ready}},{key:"i18n",get:function(){return this.getPlugin("strings")||{t:function(f){return f}}}},{key:"mediaControl",get:function(){return this._mediaControl||(this._mediaControl=this.getPlugin("media_control"))||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl?this._dummyMediaControl:(this._dummyMediaControl=new yt(this),this._dummyMediaControl)}},{key:"activeContainer",get:function(){return this._activeContainer},set:function(t){this._activeContainer=t,this.trigger(G.CORE_ACTIVE_CONTAINER_CHANGED,this._activeContainer)}},{key:"activePlayback",get:function(){return this.activeContainer&&this.activeContainer.playback}},{key:"activePlaybackEl",get:function(){if(this.activePlayback)return this.activePlayback.$el?this.activePlayback.$el.find("video")[0]:this.activePlayback.el}},{key:"configureDomRecycler",value:function(){var t=this.options&&this.options.playback&&this.options.playback.recycleVideo;vr.configure({recycleVideo:t})}},{key:"createContainers",value:function(t){this.defer=ve.Deferred(),this.defer.promise(this),this.containerFactory=new Fc(t,t.loader,this.i18n,this.playerError),this.prepareContainers()}},{key:"prepareContainers",value:function(){var t=this;this.containerFactory.createContainers().then(function(f){return t.setupContainers(f)}).then(function(f){return t.resolveOnContainersReady(f)})}},{key:"updateSize",value:function(){this.isFullscreen()?this.setFullscreen():this.setPlayerSize()}},{key:"setFullscreen",value:function(){de.isiOS||(this.$el.addClass("fullscreen"),this.$el.removeAttr("style"),this.previousSize={width:this.options.width,height:this.options.height},this.currentSize={width:ve(window).width(),height:ve(window).height()})}},{key:"setPlayerSize",value:function(){this.$el.removeClass("fullscreen"),this.currentSize=this.previousSize,this.previousSize={width:ve(window).width(),height:ve(window).height()},this.resize(this.currentSize)}},{key:"resize",value:function(t){!nn(t.height)&&!nn(t.width)?(this.el.style.height="".concat(t.height),this.el.style.width="".concat(t.width)):(this.el.style.height="".concat(t.height,"px"),this.el.style.width="".concat(t.width,"px")),this.previousSize={width:this.options.width,height:this.options.height},this.options.width=t.width,this.options.height=t.height,this.currentSize=t,this.triggerResize(this.currentSize)}},{key:"enableResizeObserver",value:function(){var t=this;this.disableResizeObserver();var f=function(){t.triggerResize({width:t.el.clientWidth,height:t.el.clientHeight})};this.resizeObserverInterval=setInterval(f,500)}},{key:"triggerResize",value:function(t){var f=this.firstResize||this.oldHeight!==t.height||this.oldWidth!==t.width;f&&(this.oldHeight=t.height,this.oldWidth=t.width,this.computedSize=t,this.firstResize=!1,this.trigger(G.CORE_RESIZE,t))}},{key:"disableResizeObserver",value:function(){this.resizeObserverInterval&&clearInterval(this.resizeObserverInterval),this.resizeObserverInterval=null}},{key:"resolveOnContainersReady",value:function(t){var f=this;ve.when.apply(ve,t).done(function(){f.defer.resolve(f),f.ready=!0,f.trigger(G.CORE_READY)})}},{key:"addPlugin",value:function(t){this.plugins.push(t)}},{key:"hasPlugin",value:function(t){return!!this.getPlugin(t)}},{key:"getPlugin",value:function(t){return this.plugins.filter(function(f){return f.name===t})[0]}},{key:"load",value:function(t,f){this.options.mimeType=f,t=t&&t.constructor===Array?t:[t],this.options.sources=t,this.containers.forEach(function(b){return b.destroy()}),this.containerFactory.options=ve.extend(!0,this.options,{sources:t}),this.prepareContainers()}},{key:"destroy",value:function(){this.disableResizeObserver(),this.containers.forEach(function(t){return t.destroy()}),this.plugins.forEach(function(t){return t.destroy()}),this.$el.remove(),ve(document).unbind("fullscreenchange",this._boundFullscreenHandler),ve(document).unbind("MSFullscreenChange",this._boundFullscreenHandler),ve(document).unbind("mozfullscreenchange",this._boundFullscreenHandler),this.stopListening()}},{key:"handleFullscreenChange",value:function(){this.trigger(G.CORE_FULLSCREEN,this.isFullscreen()),this.updateSize()}},{key:"handleWindowResize",value:function(t){var f=window.innerWidth>window.innerHeight?"landscape":"portrait";this._screenOrientation!==f&&(this._screenOrientation=f,this.triggerResize({width:this.el.clientWidth,height:this.el.clientHeight}),this.trigger(G.CORE_SCREEN_ORIENTATION_CHANGED,{event:t,orientation:this._screenOrientation}))}},{key:"removeContainer",value:function(t){this.stopListening(t),this.containers=this.containers.filter(function(f){return f!==t})}},{key:"setupContainer",value:function(t){this.listenTo(t,G.CONTAINER_DESTROYED,this.removeContainer),this.containers.push(t)}},{key:"setupContainers",value:function(t){return t.forEach(this.setupContainer.bind(this)),this.trigger(G.CORE_CONTAINERS_CREATED),this.renderContainers(),this.activeContainer=t[0],this.render(),this.appendToParent(),this.containers}},{key:"renderContainers",value:function(){var t=this;this.containers.forEach(function(f){return t.el.appendChild(f.render().el)})}},{key:"createContainer",value:function(t,f){var b=this.containerFactory.createContainer(t,f);return this.setupContainer(b),this.el.appendChild(b.render().el),b}},{key:"getCurrentContainer",value:function(){return this.activeContainer}},{key:"getCurrentPlayback",value:function(){return this.activePlayback}},{key:"getPlaybackType",value:function(){return this.activeContainer&&this.activeContainer.getPlaybackType()}},{key:"isFullscreen",value:function(){var t=_r.fullscreenElement();return t&&t===this.el||t&&t===this.activePlaybackEl||this.activePlaybackEl&&this.activePlaybackEl.webkitDisplayingFullscreen||!1}},{key:"toggleFullscreen",value:function(){var t=this;if(this.isFullscreen()){var f=de.isiOS?this.activePlaybackEl:document;_r.cancelFullscreen(f),!de.isiOS&&this.$el.removeClass("fullscreen nocursor")}else{var b=de.isiOS?this.activePlaybackEl:this.el;if(!b)return;de.isSafari||de.isiOS?_r.requestFullscreen(b):_r.requestFullscreen(b).then(function(D){return D},function(D){return setTimeout(function(){if(!t.isFullscreen())throw new ReferenceError(D)},600)}),!de.isiOS&&this.$el.addClass("fullscreen")}}},{key:"onMouseMove",value:function(t){this.trigger(G.CORE_MOUSE_MOVE,t)}},{key:"onMouseLeave",value:function(t){this.trigger(G.CORE_MOUSE_LEAVE,t)}},{key:"configure",value:function(t){var f=this;this._options=ve.extend(!0,this._options,t),this.configureDomRecycler();var b=t.source||t.sources;b&&this.load(b,t.mimeType||this.options.mimeType),this.trigger(G.CORE_OPTIONS_CHANGE,t),this.containers.forEach(function(D){return D.configure(f.options)})}},{key:"appendToParent",value:function(){var t=this.$el.parent()&&this.$el.parent().length;!t&&this.$el.appendTo(this.options.parentElement)}},{key:"appendStyles",value:function(){if(!this.styleRendered){var t=ze.getStyleFor(Bc.toString(),{baseUrl:this.options.baseUrl});if(this.$el.append(t[0]),this.options.includeResetStyle){var f=ze.getStyleFor(Uc.toString(),{baseUrl:this.options.baseUrl});this.$el.append(f[0])}this.styleRendered=!0}}},{key:"render",value:function(){this.appendStyles(),this.options.width=this.options.width||this.$el.width(),this.options.height=this.options.height||this.$el.height();var t={width:this.options.width,height:this.options.height};return this.previousSize=this.currentSize=this.computedSize=t,this.updateSize(),this.enableResizeObserver(),this}}]),i}(Nr);Object.assign(Hs.prototype,Nt);var Kc=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.player=r,t}return xe(i,[{key:"loader",get:function(){return this.player.loader}},{key:"create",value:function(){return this.options.loader=this.loader,this.core=new Hs(this.options),this.addCorePlugins(),this.core.createContainers(this.options),this.core}},{key:"addCorePlugins",value:function(){var t=this;return this.loader.corePlugins.forEach(function(f){var b=new f(t.core);t.core.addPlugin(b),t.setupExternalInterface(b)}),this.core}},{key:"setupExternalInterface",value:function(t){var f=t.getExternalInterface();for(var b in f)this.player[b]=f[b].bind(t)}}]),i}(er),Wc=/(\d+)(?:\.(\d+))?(?:\.(\d+))?/,Yr=function(){function e(n,i,r){Se(this,e),this.major=parseInt(n||0,10),this.minor=parseInt(i||0,10),this.patch=parseInt(r||0,10)}return xe(e,[{key:"compare",value:function(i){var r=this.major-i.major;return r=r||this.minor-i.minor,r=r||this.patch-i.patch,r}},{key:"inc",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"patch";return typeof this[i]<"u"&&(this[i]+=1),this}},{key:"satisfies",value:function(i,r){return this.compare(i)>=0&&(!r||this.compare(r)<0)}},{key:"toString",value:function(){return"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}],[{key:"parse",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=i.match(Wc)||[],t=Jn(r,4),f=t[1],b=t[2],D=t[3];return typeof f>"u"?null:new e(f,b,D)}}]),e}(),_a=function(n,i){return!n||!i?{}:Object.entries(n).filter(function(r){var t=Jn(r,2),f=t[1];return f.type===i}).reduce(function(r,t){var f=Jn(t,2),b=f[0],D=f[1];return r[b]=D,r},{})},tr=function(){var e={plugins:{},playbacks:[]},n="0.7.2";return function(){function i(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Se(this,i),this.playerId=t,this.playbackPlugins=ur(e.playbacks);var f=i.registeredPlugins,b=f.core,D=f.container;this.containerPlugins=Object.values(D),this.corePlugins=Object.values(b),Array.isArray(r)||this.validateExternalPluginsType(r),this.addExternalPlugins(r)}return xe(i,[{key:"groupPluginsByType",value:function(t){return Array.isArray(t)&&(t=t.reduce(function(f,b){return f[b.type]||(f[b.type]=[]),f[b.type].push(b),f},{})),t}},{key:"removeDups",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=function(F,M){return F[M.prototype.name]&&f||(F[M.prototype.name]&&delete F[M.prototype.name],F[M.prototype.name]=M),F},D=t.reduceRight(b,Object.create(null)),m=[];for(var N in D)m.unshift(D[N]);return m}},{key:"addExternalPlugins",value:function(t){var f=typeof t.loadExternalPluginsFirst=="boolean"?t.loadExternalPluginsFirst:!0,b=typeof t.loadExternalPlaybacksFirst=="boolean"?t.loadExternalPlaybacksFirst:!0;if(t=this.groupPluginsByType(t),t.playback){var D=t.playback.filter(function(x){return i.checkVersionSupport(x),!0});this.playbackPlugins=b?this.removeDups(D.concat(this.playbackPlugins)):this.removeDups(this.playbackPlugins.concat(D),!0)}if(t.container){var m=t.container.filter(function(x){return i.checkVersionSupport(x),!0});this.containerPlugins=f?this.removeDups(m.concat(this.containerPlugins)):this.removeDups(this.containerPlugins.concat(m),!0)}if(t.core){var N=t.core.filter(function(x){return i.checkVersionSupport(x),!0});this.corePlugins=f?this.removeDups(N.concat(this.corePlugins)):this.removeDups(this.corePlugins.concat(N),!0)}}},{key:"validateExternalPluginsType",value:function(t){var f=["playback","container","core"];f.forEach(function(b){(t[b]||[]).forEach(function(D){var m="external "+D.type+" plugin on "+b+" array";if(D.type!==b)throw new ReferenceError(m)})})}}],[{key:"registeredPlaybacks",get:function(){return ur(e.playbacks)}},{key:"registeredPlugins",get:function(){var t=e.plugins,f=_a(t,"core"),b=_a(t,"container");return{core:f,container:b}}},{key:"checkVersionSupport",value:function(t){var f=t.prototype,b=f.supportedVersion,D=f.name;if(!b||!b.min)return Ee.warn("Loader","missing version information for ".concat(D)),!1;var m=b.max?Yr.parse(b.max):Yr.parse(b.min).inc("minor"),N=Yr.parse(b.min);return Yr.parse(n).satisfies(N,m)?!0:(Ee.warn("Loader","unsupported plugin ".concat(D,": Clappr version ").concat(n," does not match required range [").concat(N,",").concat(m,")")),!1)}},{key:"registerPlugin",value:function(t){if(!t||!t.prototype.name)return Ee.warn("Loader","missing information to register plugin: ".concat(t)),!1;i.checkVersionSupport(t);var f=e.plugins;if(!f)return!1;var b=f[t.prototype.name];return b&&Ee.warn("Loader","overriding plugin entry: ".concat(t.prototype.name," - ").concat(b)),f[t.prototype.name]=t,!0}},{key:"registerPlayback",value:function(t){if(!t||!t.prototype.name)return!1;i.checkVersionSupport(t);var f=e.playbacks,b=f.findIndex(function(m){return m.prototype.name===t.prototype.name});if(b>=0){var D=f[b];f.splice(b,1),Ee.warn("Loader","overriding playback entry: ".concat(D.name," - ").concat(D))}return e.playbacks=[t].concat(ur(f)),!0}},{key:"unregisterPlugin",value:function(t){if(!t)return!1;var f=e.plugins,b=f[t];return b?(delete f[t],!0):!1}},{key:"unregisterPlayback",value:function(t){if(!t)return!1;var f=e.playbacks,b=f.findIndex(function(D){return D.prototype.name===t});return b<0?!1:(f.splice(b,1),e.playbacks=f,!0)}},{key:"clearPlugins",value:function(){e.plugins={}}},{key:"clearPlaybacks",value:function(){e.playbacks=[]}}]),i}()}(),Vc=Ns().replace(/\/[^/]+$/,""),js=function(e){Me(i,e);var n=we(i);function i(r){var t;Se(this,i),t=n.call(this,r);var f={recycleVideo:!0},b={playerId:wr(""),persistConfig:!0,width:640,height:360,baseUrl:Vc,allowUserInteraction:de.isMobile,includeResetStyle:!0,playback:f};t._options=ve.extend(!0,b,r),t.options.sources=t._normalizeSources(r),t.options.chromeless||(t.options.allowUserInteraction=!0),t.options.allowUserInteraction||(t.options.disableKeyboardShortcuts=!0),t._registerOptionEventListeners(t.options.events),t._coreFactory=new Kc(En(t));var D=t._getParentElement(t.options);return D&&t.attachTo(D),t}return xe(i,[{key:"loader",get:function(){return this._loader||(this._loader=new tr(this.options.plugins||{},this.options.playerId)),this._loader},set:function(t){this._loader=t}},{key:"ended",get:function(){return this.core.activeContainer.ended}},{key:"buffering",get:function(){return this.core.activeContainer.buffering}},{key:"isReady",get:function(){return!!this._ready}},{key:"eventsMapping",get:function(){return{onReady:G.PLAYER_READY,onResize:G.PLAYER_RESIZE,onPlay:G.PLAYER_PLAY,onPause:G.PLAYER_PAUSE,onStop:G.PLAYER_STOP,onEnded:G.PLAYER_ENDED,onSeek:G.PLAYER_SEEK,onError:G.PLAYER_ERROR,onTimeUpdate:G.PLAYER_TIMEUPDATE,onVolumeUpdate:G.PLAYER_VOLUMEUPDATE,onSubtitleAvailable:G.PLAYER_SUBTITLE_AVAILABLE}}},{key:"_getParentElement",value:function(t){var f=t.parentId,b=t.parent;return f?document.querySelector(f):b}},{key:"attachTo",value:function(t){return this.options.parentElement=t,this.core=this._coreFactory.create(),this._addEventListeners(),this}},{key:"_addEventListeners",value:function(){return this.core.isReady?this._onReady():this.listenToOnce(this.core,G.CORE_READY,this._onReady),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this._containerChanged),this.listenTo(this.core,G.CORE_FULLSCREEN,this._onFullscreenChange),this.listenTo(this.core,G.CORE_RESIZE,this._onResize),this}},{key:"_addContainerEventListeners",value:function(){var t=this.core.activeContainer;return t&&(this.listenTo(t,G.CONTAINER_PLAY,this._onPlay),this.listenTo(t,G.CONTAINER_PAUSE,this._onPause),this.listenTo(t,G.CONTAINER_STOP,this._onStop),this.listenTo(t,G.CONTAINER_ENDED,this._onEnded),this.listenTo(t,G.CONTAINER_SEEK,this._onSeek),this.listenTo(t,G.CONTAINER_ERROR,this._onError),this.listenTo(t,G.CONTAINER_TIMEUPDATE,this._onTimeUpdate),this.listenTo(t,G.CONTAINER_VOLUME,this._onVolumeUpdate),this.listenTo(t,G.CONTAINER_SUBTITLE_AVAILABLE,this._onSubtitleAvailable)),this}},{key:"_registerOptionEventListeners",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=Object.keys(f).length>0;return D&&Object.keys(b).forEach(function(m){var N=t.eventsMapping[m];N&&t.off(N,b[m])}),Object.keys(f).forEach(function(m){var N=t.eventsMapping[m];if(N){var x=f[m];x=typeof x=="function"&&x,x&&t.on(N,x)}}),this}},{key:"_containerChanged",value:function(){this.stopListening(),this._addEventListeners()}},{key:"_onReady",value:function(){this._ready=!0,this._addContainerEventListeners(),this.trigger(G.PLAYER_READY)}},{key:"_onFullscreenChange",value:function(t){this.trigger(G.PLAYER_FULLSCREEN,t)}},{key:"_onVolumeUpdate",value:function(t){this.trigger(G.PLAYER_VOLUMEUPDATE,t)}},{key:"_onSubtitleAvailable",value:function(){this.trigger(G.PLAYER_SUBTITLE_AVAILABLE)}},{key:"_onResize",value:function(t){this.trigger(G.PLAYER_RESIZE,t)}},{key:"_onPlay",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PLAY,f)}},{key:"_onPause",value:function(t){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.trigger(G.PLAYER_PAUSE,f)}},{key:"_onStop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.trigger(G.PLAYER_STOP,this.getCurrentTime(),t)}},{key:"_onEnded",value:function(){this.trigger(G.PLAYER_ENDED)}},{key:"_onSeek",value:function(t){this.trigger(G.PLAYER_SEEK,t)}},{key:"_onTimeUpdate",value:function(t){this.trigger(G.PLAYER_TIMEUPDATE,t)}},{key:"_onError",value:function(t){this.trigger(G.PLAYER_ERROR,t)}},{key:"_normalizeSources",value:function(t){var f=t.sources||(t.source!==void 0?[t.source]:[]);return f.length===0?[{source:"",mimeType:""}]:f}},{key:"resize",value:function(t){return this.core.resize(t),this}},{key:"load",value:function(t,f,b){return b!==void 0&&this.configure({autoPlay:!!b}),this.core.load(t,f),this}},{key:"destroy",value:function(){return this.stopListening(),this.core.destroy(),this}},{key:"consent",value:function(t){this.core.getCurrentPlayback().consent(t)}},{key:"play",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.play(t),this}},{key:"pause",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.pause(t),this}},{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.core.activeContainer.stop(t),this}},{key:"seek",value:function(t){return this.core.activeContainer.seek(t),this}},{key:"seekPercentage",value:function(t){return this.core.activeContainer.seekPercentage(t),this}},{key:"mute",value:function(){return this.core.activePlayback.mute(),this}},{key:"unmute",value:function(){return this.core.activePlayback.unmute(),this}},{key:"isPlaying",value:function(){return this.core.activeContainer.isPlaying()}},{key:"isDvrEnabled",value:function(){return this.core.activeContainer.isDvrEnabled()}},{key:"isDvrInUse",value:function(){return this.core.activeContainer.isDvrInUse()}},{key:"configure",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._registerOptionEventListeners(t.events,this.options.events),this.core.configure(t),this}},{key:"getPlugin",value:function(t){var f=this.core.plugins.concat(this.core.activeContainer.plugins);return f.filter(function(b){return b.name===t})[0]}},{key:"getCurrentTime",value:function(){return this.core.activeContainer.getCurrentTime()}},{key:"getStartTimeOffset",value:function(){return this.core.activeContainer.getStartTimeOffset()}},{key:"getDuration",value:function(){return this.core.activeContainer.getDuration()}}]),i}(er);Object.assign(js.prototype,Nt);var Qt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"bindEvents",value:function(){}},{key:"destroy",value:function(){this.stopListening()}}]),i}(er);Object.assign(Qt.prototype,Nt);Qt.extend=function(e){return yr(Qt,e)};Qt.type="container";var Rt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.core=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.core.playerError}},{key:"bindEvents",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0)}},{key:"disable",value:function(){this.enabled&&(this.stopListening(),this.enabled=!1)}},{key:"getExternalInterface",value:function(){return{}}},{key:"destroy",value:function(){this.stopListening()}}]),i}(er);Object.assign(Rt.prototype,Nt);Rt.extend=function(e){return yr(Rt,e)};Rt.type="core";var Zt=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r.options),t.container=r,t.enabled=!0,t.bindEvents(),t}return xe(i,[{key:"playerError",get:function(){return this.container.playerError}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.$el.show(),this.enabled=!0)}},{key:"disable",value:function(){this.stopListening(),this.$el.hide(),this.enabled=!1}},{key:"bindEvents",value:function(){}}]),i}(Nr);Object.assign(Zt.prototype,Nt);Zt.extend=function(e){return yr(Zt,e)};Zt.type="container";var Gc=`<% for (var i = 0; i < tracks.length; i++) { %>
  <track data-html5-video-track="<%= i %>" kind="<%= tracks[i].kind %>" label="<%= tracks[i].label %>" srclang="<%= tracks[i].lang %>" src="<%= tracks[i].src %>">
<% }; %>
`,Hc=`[data-html5-video] {
  position: absolute;
  height: 100%;
  width: 100%;
  display: block; }
`,gr={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};gr.ogv=gr.ogg;gr["3gp"]=gr["3gpp"];var kr={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},jc=Object.keys(kr).reduce(function(e,n){return[].concat(ur(e),ur(kr[n]))},[]),Ta={code:"unknown",message:"unknown"},pt=function(e){Me(i,e);var n=we(i);function i(){var r;Se(this,i);for(var t=arguments.length,f=new Array(t),b=0;b<t;b++)f[b]=arguments[b];r=n.call.apply(n,[this].concat(f)),r._destroyed=!1,r._loadStarted=!1,r._isBuffering=!1,r._playheadMoving=!1,r._playheadMovingTimer=null,r._stopped=!1,r._ccTrackId=-1,r._playheadMovingCheckEnabled=!r.options.disablePlayheadMovingCheck,r._setupSrc(r.options.src),r._playheadMovingCheckInterval=r.options.playheadMovingCheckInterval||500,r.options.playback||(r.options.playback=r.options||{}),r.options.playback.disableContextMenu=r.options.playback.disableContextMenu||r.options.disableVideoTagContextMenu,r._minDvrSize=r.isValidMinimumDVRSizeConfig?r.minimumDVRSizeConfig:60;var D=r.options.playback,m=D.preload||(de.isSafari?"auto":r.options.preload),N;return r.options.poster&&(typeof r.options.poster=="string"?N=r.options.poster:typeof r.options.poster.url=="string"&&(N=r.options.poster.url)),ve.extend(!0,r.el,{muted:r.options.mute,defaultMuted:r.options.mute,loop:r.options.loop,poster:N,preload:m||"metadata",crossOrigin:D.crossOrigin,"x-webkit-playsinline":D.playInline}),(D.controls||r.options.useVideoTagDefaultControls)&&r.$el.attr("controls",""),D.playInline&&r.$el.attr({playsinline:"playsinline"}),D.crossOrigin&&r.$el.attr({crossorigin:D.crossOrigin}),r.settings={default:["seekbar"]},r.settings.left=["playpause","position","duration"],r.settings.right=["fullscreen","volume","hd-indicator"],D.externalTracks&&r._setupExternalTracks(D.externalTracks),r.options.autoPlay&&r.attemptAutoPlay(),r}return xe(i,[{key:"name",get:function(){return"html5_video"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"isAudioOnly",get:function(){var t=this.options.src,f=i._mimeTypesForUrl(t,kr,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||jc.indexOf(f[0])>=0}},{key:"attributes",get:function(){return{"data-html5-video":""}}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_handleBufferingEvents",durationchange:"_onDurationChange",ended:"_onEnded",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",stalled:"_handleBufferingEvents",timeupdate:"_onTimeUpdate",waiting:"_onWaiting",enterpictureinpicture:"_onEnterPiP",leavepictureinpicture:"_onExitPiP"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}},{key:"isPiPActive",get:function(){return this.el===document.pictureInPictureElement}},{key:"isLive",get:function(){return this.getPlaybackType()===pe.LIVE}},{key:"dvrEnabled",get:function(){return this.getDuration()>=this._minDvrSize&&this.isLive}},{key:"minimumDVRSizeConfig",get:function(){return this.options.playback&&this.options.playback.minimumDvrSize}},{key:"isValidMinimumDVRSizeConfig",get:function(){return typeof this.minimumDVRSizeConfig<"u"&&typeof this.minimumDVRSizeConfig=="number"}},{key:"sourceMedia",get:function(){return this._src}},{key:"configure",value:function(t){Yt(_t(i.prototype),"configure",this).call(this,t),this.el.loop=!!t.loop}},{key:"attemptAutoPlay",value:function(){var t=this;this.canAutoPlay(function(f,b){b&&Ee.warn(t.name,"autoplay error.",{result:f,error:b}),f&&setTimeout(function(){return!t._destroyed&&t.play()},0)})}},{key:"canAutoPlay",value:function(t){if(this.options.disableCanAutoPlay){t(!0,null);return}var f={timeout:this.options.autoPlayTimeout||500,inline:this.options.playback.playInline||!1,muted:this.options.mute||!1};de.isMobile&&vr.options.recycleVideo&&(f.element=this.el),Bs(t,f)}},{key:"_setupExternalTracks",value:function(t){this._externalTracks=t.map(function(f){return{kind:f.kind||"subtitles",label:f.label,lang:f.lang,src:f.src}})}},{key:"load",value:function(t){this._setupSrc(t)}},{key:"_setupSrc",value:function(t){this.el.src!==t&&(this._ccIsSetup=!1,this.el.src=t,this._src=this.el.src)}},{key:"_onLoadedMetadata",value:function(t){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_LOADEDMETADATA,{duration:t.target.duration,data:t}),this._updateSettings();var f=typeof this._options.autoSeekFromUrl>"u"||this._options.autoSeekFromUrl;this.getPlaybackType()!==pe.LIVE&&f&&this._checkInitialSeek()}},{key:"_onDurationChange",value:function(){this._updateSettings(),this._onTimeUpdate(),this._onProgress()}},{key:"_updateSettings",value:function(){this.getPlaybackType()===pe.VOD||this.getPlaybackType()===pe.AOD?this.settings.left=["playpause","position","duration"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"isSeekEnabled",value:function(){return isFinite(this.getDuration())}},{key:"getPlaybackType",value:function(){var t=this.tagName==="audio"?pe.AOD:pe.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?pe.LIVE:t}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"consent",value:function(t){var f=this;if(this.isPlaying()||this.el._consented)Yt(_t(i.prototype),"consent",this).call(this,t);else{var b=function D(){f.el.removeEventListener("loadedmetadata",D,!1),f.el.removeEventListener("error",D,!1),f.el._consented=!0,Yt(_t(i.prototype),"consent",f).call(f,t)};this.el.addEventListener("loadedmetadata",b,!1),this.el.addEventListener("error",b,!1),this.el.load()}}},{key:"play",value:function(){var t=this;this.trigger(G.PLAYBACK_PLAY_INTENT),this._stopped=!1,this._setupSrc(this._src),this._handleBufferingEvents();var f=this.el.play();return f&&f.catch&&f.catch(function(b){return Ee.warn(t.name,"HTML5 play failed",b)}),f}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this.el.removeAttribute("src"),this.el.load(),this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_STOP)}},{key:"volume",value:function(t){t===0?(this.$el.attr({muted:"true"}),this.el.muted=!0):(this.$el.attr({muted:null}),this.el.muted=!1,this.el.volume=t/100)}},{key:"mute",value:function(){this.el.muted=!0}},{key:"unmute",value:function(){this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted===!0||this.el.volume===0}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startPlayheadMovingChecks",value:function(){this._playheadMovingTimer!==null||!this._playheadMovingCheckEnabled||(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),this._playheadMovingCheckInterval))}},{key:"_stopPlayheadMovingChecks",value:function(){this._playheadMovingTimer!==null&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var t=this._playheadMovingTimeOnCheck,f=this.el.currentTime;this._playheadMoving=t!==f,this._playheadMovingTimeOnCheck=f,this._handleBufferingEvents()}},{key:"_onWaiting",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onPlaying",value:function(){this._checkForClosedCaptions(),this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PLAY)}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(G.PLAYBACK_PAUSE)}},{key:"_onSeeking",value:function(){this.trigger(G.PLAYBACK_SEEK,this.getCurrentTime()),this._handleBufferingEvents()}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_onEnterPiP",value:function(){this.trigger(G.PLAYBACK_PIP_ENTER,this.name)}},{key:"_onExitPiP",value:function(){this.trigger(G.PLAYBACK_PIP_EXIT,this.name)}},{key:"enterPiP",value:function(){var t=this;this.el.requestPictureInPicture().then(function(){Ee.info(t.name,"enter PIP success")}).catch(function(f){Ee.warn(t.name,"enter PIP failed",f)})}},{key:"exitPiP",value:function(){var t=this;document.exitPictureInPicture().then(function(){Ee.info(t.name,"exit PIP success")}).catch(function(f){Ee.warn(t.name,"exit PIP failed",f)})}},{key:"_handleBufferingEvents",value:function(){var t=this._loadStarted&&!this.el.ended&&!this._stopped,f=this.el.readyState<this.el.HAVE_FUTURE_DATA,b=!this.el.ended&&!this.el.paused&&!this._playheadMoving,D=t&&f;this._playheadMovingCheckEnabled&&(D=D||t&&b),this._isBuffering!==D&&(this._isBuffering=D,D?this.trigger(G.PLAYBACK_BUFFERING,this.name):this.trigger(G.PLAYBACK_BUFFERFULL,this.name))}},{key:"_onError",value:function(){var t=this.el.error||Ta,f=t.code,b=t.message,D=f===Ta.code,m=this.createError({code:f,description:b,raw:this.el.error,level:D?ot.Levels.WARN:ot.Levels.FATAL});D?Ee.warn(this.name,"HTML5 unknown error: ",m):this.trigger(G.PLAYBACK_ERROR,m)}},{key:"destroy",value:function(){this._destroyed=!0,this.handleTextTrackChange&&this.el.textTracks.removeEventListener("change",this.handleTextTrackChange),this.$el.off("contextmenu"),Yt(_t(i.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this.el.load(),this._src=null,vr.garbage(this.el)}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function(t){t<0&&(Ee.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this.el.seekable.start(0),this.el.currentTime=t}},{key:"seekPercentage",value:function(t){var f=this.el.duration*(t/100);this.seek(f)}},{key:"_checkInitialSeek",value:function(){var t=ws();t!==0&&this.seek(t)}},{key:"getCurrentTime",value:function(){return this.el.currentTime}},{key:"getDuration",value:function(){if(this.isLive){if(this.el.seekable.length>0)return this.el.seekable.end(0)-this.el.seekable.start(0);this._scheduleUpdateSettingsCheck()}return this.el.duration}},{key:"_scheduleUpdateSettingsCheck",value:function(){var t=this;this._updateSettingsCheckInFlight||(this._updateSettingsCheckInFlight=setTimeout(function(){t._updateSettings(),t._updateSettingsCheckInFlight=null},1e3))}},{key:"_onTimeUpdate",value:function(){var t=this.isLive?this.getDuration():this.el.duration;this.trigger(G.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:t},this.name)}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],f=0,b=0;b<this.el.buffered.length;b++)t=[].concat(ur(t),[{start:this.el.buffered.start(b),end:this.el.buffered.end(b)}]),this.el.currentTime>=t[b].start&&this.el.currentTime<=t[b].end&&(f=b);var D={start:t[f].start,current:t[f].end,total:this.el.duration};this.trigger(G.PLAYBACK_PROGRESS,D,t)}}},{key:"_typeFor",value:function(t){var f=i._mimeTypesForUrl(t,gr,this.options.mimeType);f.length===0&&(f=i._mimeTypesForUrl(t,kr,this.options.mimeType));var b=f[0]||"";return b.split(";")[0]}},{key:"_ready",value:function(){this._isReadyState||(this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_checkForClosedCaptions",value:function(){if(this.isHTML5Video&&!this._ccIsSetup){if(this.hasClosedCaptionsTracks){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this.handleTextTrackChange=this._handleTextTrackChange.bind(this),this.el.textTracks.addEventListener("change",this.handleTextTrackChange)}this._ccIsSetup=!0}}},{key:"_handleTextTrackChange",value:function(){var t=this.closedCaptionsTracks,f=t.find(function(b){return b.track.mode==="showing"})||{id:-1};this._ccTrackId!==f.id&&(this._ccTrackId=f.id,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:f.id}))}},{key:"isHTML5Video",get:function(){return this.name===i.prototype.name}},{key:"closedCaptionsTracks",get:function(){var t=0,f=function(){return t++},b=this.el.textTracks?Array.from(this.el.textTracks):[];return b.filter(function(D){return D.kind==="subtitles"||D.kind==="captions"}).map(function(D){return{id:f(),name:D.label,track:D}})}},{key:"closedCaptionsTrackId",get:function(){return this._ccTrackId},set:function(t){if(nn(t)){var f=this.closedCaptionsTracks,b;t!==-1&&(b=f.find(function(D){return D.id===t}),!b||b.track.mode==="showing")||(f.filter(function(D){return D.track.mode!=="hidden"}).forEach(function(D){return D.track.mode="hidden"}),b&&(b.track.mode="showing"),this._ccTrackId=t,this.trigger(G.PLAYBACK_SUBTITLE_CHANGED,{id:t}))}}},{key:"template",get:function(){return rt(Gc)}},{key:"render",value:function(){this.options.playback.disableContextMenu&&this.$el.on("contextmenu",function(){return!1}),this._externalTracks&&this._externalTracks.length>0&&this.$el.html(this.template({tracks:this._externalTracks})),this._ready();var t=ze.getStyleFor(Hc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this}}]),i}(pe);pt._mimeTypesForUrl=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],t=i||r&&n[r.toLowerCase()]||[];return t.constructor===Array?t:[t]};pt._canPlay=function(e,n,i,r){var t=pt._mimeTypesForUrl(i,n,r),f=document.createElement(e);return!!t.filter(function(b){return!!f.canPlayType(b).replace(/no/,"")})[0]};pt.canPlay=function(e,n){return pt._canPlay("audio",kr,e,n)||pt._canPlay("video",gr,e,n)};var Ys=function(e){Me(i,e);var n=we(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"html5_audio"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"tagName",get:function(){return"audio"}},{key:"isAudioOnly",get:function(){return!0}},{key:"updateSettings",value:function(){this.settings.left=["playpause","position","duration"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"getPlaybackType",value:function(){return pe.AOD}}]),i}(pt);Ys.canPlay=function(e,n){var i={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]};return pt._canPlay("audio",i,e,n)};var Yc=`[data-html-img] {
  max-width: 100%;
  max-height: 100%; }
`,$s=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t.el.src=r.src,t}return xe(i,[{key:"name",get:function(){return"html_img"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"tagName",get:function(){return"img"}},{key:"attributes",get:function(){return{"data-html-img":""}}},{key:"events",get:function(){return{load:"_onLoad",abort:"_onError",error:"_onError"}}},{key:"getPlaybackType",value:function(){return pe.NO_OP}},{key:"render",value:function(){var t=ze.getStyleFor(Yc.toString(),{baseUrl:this.options.baseUrl});return this.$el.append(t[0]),this.trigger(G.PLAYBACK_READY,this.name),this}},{key:"_onLoad",value:function(){this.trigger(G.PLAYBACK_ENDED,this.name)}},{key:"_onError",value:function(t){var f=t.type==="error"?"load error":"loading aborted";this.trigger(G.PLAYBACK_ERROR,{message:f},this.name)}}]),i}(pe);$s.canPlay=function(e){return/\.(png|jpg|jpeg|gif|bmp|tiff|pgm|pnm|webp)(|\?.*)$/i.test(e)};var $c=`<canvas data-no-op-canvas></canvas>
<p data-no-op-msg><%=message%></p><p>
</p>`,zc=`[data-no-op] {
  position: absolute;
  height: 100%;
  width: 100%;
  text-align: center; }

[data-no-op] p[data-no-op-msg] {
  position: absolute;
  text-align: center;
  font-size: 25px;
  left: 0;
  right: 0;
  color: white;
  padding: 10px;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%);
  max-height: 100%;
  overflow: auto; }

[data-no-op] canvas[data-no-op-canvas] {
  background-color: #777;
  height: 100%;
  width: 100%; }
`,zs=function(e){Me(i,e);var n=we(i);function i(){var r;Se(this,i);for(var t=arguments.length,f=new Array(t),b=0;b<t;b++)f[b]=arguments[b];return r=n.call.apply(n,[this].concat(f)),r._noiseFrameNum=-1,r}return xe(i,[{key:"name",get:function(){return"no_op"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"template",get:function(){return rt($c)}},{key:"attributes",get:function(){return{"data-no-op":""}}},{key:"render",value:function(){var t=this.options.playbackNotSupportedMessage||this.i18n.t("playback_not_supported"),f=ze.getStyleFor(zc.toString(),{baseUrl:this.options.baseUrl});this.$el.append(f[0]),this.$el.html(this.template({message:t})),this.trigger(G.PLAYBACK_READY,this.name);var b=!!(this.options.poster&&this.options.poster.showForNoOp);return(this.options.autoPlay||!b)&&this._animate(),this}},{key:"_noise",value:function(){if(this._noiseFrameNum=(this._noiseFrameNum+1)%5,!this._noiseFrameNum){var t=this.context.createImageData(this.context.canvas.width,this.context.canvas.height),f;try{f=new Uint32Array(t.data.buffer)}catch{f=new Uint32Array(this.context.canvas.width*this.context.canvas.height*4);for(var b=t.data,D=0;D<b.length;D++)f[D]=b[D]}for(var m=f.length,N=Math.random()*6+4,x=0,F=0,M=0;M<m;){if(x<0){x=N*Math.random();var K=Math.pow(Math.random(),.4);F=255*K<<24}x-=1,f[M++]=F}this.context.putImageData(t,0,0)}}},{key:"_loop",value:function(){var t=this;this._stop||(this._noise(),this._animationHandle=Rs(function(){return t._loop()}))}},{key:"destroy",value:function(){this._animationHandle&&(ks(this._animationHandle),this._stop=!0)}},{key:"_animate",value:function(){this.canvas=this.$el.find("canvas[data-no-op-canvas]")[0],this.context=this.canvas.getContext("2d"),this._loop()}}]),i}(pe);zs.canPlay=function(e){return!0};var Xc=function(e){Me(i,e);var n=we(i);function i(r){var t;return Se(this,i),t=n.call(this,r),t._initializeMessages(),t}return xe(i,[{key:"name",get:function(){return"strings"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"t",value:function(t){var f=this._language(),b=this._messages.en,D=f&&this._messages[f]||b;return D[t]||b[t]||t}},{key:"_language",value:function(){return this.core.options.language||Fs()}},{key:"_initializeMessages",value:function(){var t={en:{live:"live",back_to_live:"back to live",disabled:"Disabled",playback_not_supported:"Your browser does not support the playback of this video. Please try using a different browser.",default_error_title:"Could not play video.",default_error_message:"There was a problem trying to load the video."},de:{live:"Live",back_to_live:"Zurck zum Live-Video",disabled:"Deaktiviert",playback_not_supported:"Ihr Browser untersttzt das Playback Verfahren nicht. Bitte vesuchen Sie es mit einem anderen Browser.",default_error_title:"Video kann nicht abgespielt werden",default_error_message:"Es gab ein Problem beim Laden des Videos"},pt:{live:"ao vivo",back_to_live:"voltar para o ao vivo",disabled:"Desativado",playback_not_supported:"Seu navegador no suporta a reproduo deste video. Por favor, tente usar um navegador diferente.",default_error_title:"No foi possvel reproduzir o vdeo.",default_error_message:"Ocorreu um problema ao tentar carregar o vdeo."},es_am:{live:"vivo",back_to_live:"volver en vivo",disabled:"No disponible",playback_not_supported:"Su navegador no soporta la reproduccin de este video. Por favor, utilice un navegador diferente.",default_error_title:"No se puede reproducir el video.",default_error_message:"Se ha producido un error al cargar el video."},es:{live:"en directo",back_to_live:"volver al directo",disabled:"No disponible",playback_not_supported:"Este navegador no es compatible para reproducir este vdeo. Utilice un navegador diferente.",default_error_title:"No se puede reproducir el vdeo.",default_error_message:"Se ha producido un problema al cargar el vdeo."},ru:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"      . ,   ."},bg:{live:" ",back_to_live:"  ",disabled:"",playback_not_supported:"       . ,    .",default_error_title:"     .",default_error_message:"     ."},fr:{live:"en direct",back_to_live:"retour au direct",disabled:"Dsactiv",playback_not_supported:"Votre navigateur ne supporte pas la lecture de cette vido. Merci de tenter sur un autre navigateur.",default_error_title:"Impossible de lire la vido.",default_error_message:"Un problme est survenu lors du chargement de la vido."},tr:{live:"canl",back_to_live:"canl yayna dn",disabled:"Engelli",playback_not_supported:"Taraycnz bu videoyu oynatma desteine sahip deil. Ltfen farkl bir tarayc ile deneyin."},et:{live:"Otselekanne",back_to_live:"Tagasi otselekande juurde",disabled:"Keelatud",playback_not_supported:"Teie brauser ei toeta selle video taasesitust. Proovige kasutada muud brauserit."},ar:{live:"",back_to_live:"  ",disabled:"",playback_not_supported:"       .    .",default_error_title:"   .",default_error_message:"    ."},zh:{live:"",back_to_live:"",disabled:"",playback_not_supported:"",default_error_title:"",default_error_message:""}};this._messages=ve.extend(!0,t,this.core.options.strings||{}),this._messages["de-DE"]=this._messages.de,this._messages["pt-BR"]=this._messages.pt,this._messages["en-US"]=this._messages.en,this._messages["bg-BG"]=this._messages.bg,this._messages["es-419"]=this._messages.es_am,this._messages["es-ES"]=this._messages.es,this._messages["fr-FR"]=this._messages.fr,this._messages["tr-TR"]=this._messages.tr,this._messages["et-EE"]=this._messages.et,this._messages["ar-IQ"]=this._messages.ar,this._messages["zh-CN"]=this._messages.zh}}]),i}(Rt),Qc=function(e){Me(i,e);var n=we(i);function i(){return Se(this,i),n.apply(this,arguments)}return xe(i,[{key:"name",get:function(){return"sources"}},{key:"supportedVersion",get:function(){return{min:"0.7.2"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_CONTAINERS_CREATED,this.onContainersCreated)}},{key:"onContainersCreated",value:function(){var t=this.core.containers.filter(function(f){return f.playback.name!=="no_op"})[0]||this.core.containers[0];t&&this.core.containers.forEach(function(f){f!==t&&f.destroy()})}}]),i}(Rt);tr.registerPlugin(Xc);tr.registerPlugin(Qc);tr.registerPlayback(zs);tr.registerPlayback($s);tr.registerPlayback(Ys);tr.registerPlayback(pt);function Qe(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ba(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tf(r.key),r)}}function Ze(e,n,i){return n&&ba(e.prototype,n),i&&ba(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Je(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ri(e,n)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},kt(e)}function ri(e,n){return ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ri(e,n)}function Zc(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xs(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jc(e)}function qe(e){var n=Zc();return function(){var r=kt(e),t;if(n){var f=kt(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return Xs(this,t)}}function qc(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=kt(e),e!==null););return e}function cr(){return typeof Reflect<"u"&&Reflect.get?cr=Reflect.get.bind():cr=function(n,i,r){var t=qc(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},cr.apply(this,arguments)}function ef(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function tf(e){var n=ef(e,"string");return typeof n=="symbol"?n:String(n)}var rf=function(e){Je(i,e);var n=qe(i);function i(r){return Qe(this,i),n.call(this,r)}return Ze(i,[{key:"name",get:function(){return"click_to_pause"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"config",get:function(){return this.container.options.clickToPauseConfig||{}}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_CLICK,this.click),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate)}},{key:"click",value:function(){var t=this.config.onClickPayload;(this.container.getPlaybackType()!==pe.LIVE||this.container.isDvrEnabled())&&(this.container.isPlaying()?this.container.pause(t):this.container.play(t))}},{key:"settingsUpdate",value:function(){var t=this.container.getPlaybackType()!==pe.LIVE||this.container.isDvrEnabled();if(t!==this.pointerEnabled){var f=t?"addClass":"removeClass";this.container.$el[f]("pointer-enabled"),this.pointerEnabled=t}}}]),i}(Qt),nf=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve">
<path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1
	c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9
	C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4
	c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"/>
</svg>`,af=`<button type="button" class="cc-button media-control-button media-control-icon" data-cc-button aria-label="<%= ariaLabel %>"></button>
<ul>
  <% if (title) { %>
  <li data-title><%= title %></li>
  <% }; %>
  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>
  <% for (var i = 0; i < tracks.length; i++) { %>
    <li><a href="#" data-cc-select="<%= tracks[i].id %>"><%= tracks[i].label %></a></li>
  <% }; %>
</ul>
`,sf=`.cc-controls[data-cc-controls] {
  float: right;
  position: relative;
  display: none; }
  .cc-controls[data-cc-controls].available {
    display: block; }
  .cc-controls[data-cc-controls] .cc-button {
    padding: 6px !important; }
    .cc-controls[data-cc-controls] .cc-button.enabled {
      display: block;
      opacity: 1.0; }
      .cc-controls[data-cc-controls] .cc-button.enabled:hover {
        opacity: 1.0;
        text-shadow: none; }
  .cc-controls[data-cc-controls] > ul {
    list-style-type: none;
    position: absolute;
    bottom: 25px;
    border: 1px solid black;
    display: none;
    background-color: #e6e6e6; }
  .cc-controls[data-cc-controls] li {
    font-size: 10px; }
    .cc-controls[data-cc-controls] li[data-title] {
      background-color: #c3c2c2;
      padding: 5px; }
    .cc-controls[data-cc-controls] li a {
      color: #444;
      padding: 2px 10px;
      display: block;
      text-decoration: none; }
      .cc-controls[data-cc-controls] li a:hover {
        background-color: #555;
        color: white; }
        .cc-controls[data-cc-controls] li a:hover a {
          color: white;
          text-decoration: none; }
    .cc-controls[data-cc-controls] li.current a {
      color: #f00; }
`,of=function(e){Je(i,e);var n=qe(i);function i(r){var t;Qe(this,i),t=n.call(this,r);var f=r.options.closedCaptionsConfig;return t._title=f&&f.title?f.title:null,t._ariaLabel=f&&f.ariaLabel?f.ariaLabel:"cc-button",t._labelCb=f&&f.labelCallback&&typeof f.labelCallback=="function"?f.labelCallback:function(b){return b.name},t}return Ze(i,[{key:"name",get:function(){return"closed_captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return rt(af)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,G.CONTAINER_SUBTITLE_AVAILABLE,this.onSubtitleAvailable),this.listenTo(this.container,G.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,G.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){this.ccAvailable(!1),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(t){this.setCurrentContextMenuElement(t.id)}},{key:"onTrackSelect",value:function(t){var f=parseInt(t.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=f,this.hideContextMenu(),t.stopPropagation(),!1}},{key:"ccAvailable",value:function(t){var f=t?"addClass":"removeClass";this.$el[f]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(t){return this.$el.find("ul a"+(isNaN(t)?"":'[data-cc-select="'+t+'"]')).parent()}},{key:"setCurrentContextMenuElement",value:function(t){if(this._trackId!==t){this.contextMenuElement().removeClass("current"),this.contextMenuElement(t).addClass("current");var f=t>-1?"addClass":"removeClass";this.$ccButton[f]("enabled"),this._trackId=t}}},{key:"renderCcButton",value:function(){for(var t=this.container?this.container.closedCaptionsTracks:[],f=0;f<t.length;f++)t[f].label=this._labelCb(t[f]);var b=ze.getStyleFor(sf,{baseUrl:this.options.baseUrl});this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(nf),this.$el.append(b[0])}},{key:"render",value:function(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");return t[0]?this.$el.insertAfter(t):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),i}(yt),lf=`<div class="live-info"><%= live %></div>
<button type="button" class="live-button" aria-label="<%= backToLive %>"><%= backToLive %></button>
`,uf=`.dvr-controls[data-dvr-controls] {
  display: inline-block;
  float: left;
  color: #fff;
  line-height: 32px;
  font-size: 10px;
  font-weight: bold;
  margin-left: 6px; }
  .dvr-controls[data-dvr-controls] .live-info {
    cursor: default;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase; }
    .dvr-controls[data-dvr-controls] .live-info:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #ff0101; }
    .dvr-controls[data-dvr-controls] .live-info.disabled {
      opacity: 0.3; }
      .dvr-controls[data-dvr-controls] .live-info.disabled:before {
        background-color: #fff; }
  .dvr-controls[data-dvr-controls] .live-button {
    cursor: pointer;
    outline: none;
    display: none;
    border: 0;
    color: #fff;
    background-color: transparent;
    height: 32px;
    padding: 0;
    opacity: 0.7;
    font-family: "Roboto", "Open Sans", Arial, sans-serif;
    text-transform: uppercase;
    transition: all 0.1s ease; }
    .dvr-controls[data-dvr-controls] .live-button:before {
      content: "";
      display: inline-block;
      position: relative;
      width: 7px;
      height: 7px;
      border-radius: 3.5px;
      margin-right: 3.5px;
      background-color: #fff; }
    .dvr-controls[data-dvr-controls] .live-button:hover {
      opacity: 1;
      text-shadow: rgba(255, 255, 255, 0.75) 0 0 5px; }

.dvr .dvr-controls[data-dvr-controls] .live-info {
  display: none; }

.dvr .dvr-controls[data-dvr-controls] .live-button {
  display: block; }

.dvr.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #005aff; }

.media-control.live[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
  background-color: #ff0101; }
`,cf=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.settingsUpdate(),t}return Ze(i,[{key:"template",get:function(){return rt(lf)}},{key:"name",get:function(){return"dvr_controls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"events",get:function(){return{"click .live-button":"click"}}},{key:"attributes",get:function(){return{class:"dvr-controls","data-dvr-controls":""}}},{key:"bindEvents",value:function(){this.bindCoreEvents(),this.bindContainerEvents()}},{key:"bindCoreEvents",value:function(){var t=this;this.core.mediaControl.settings?(this.listenTo(this.core.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,G.MEDIACONTROL_RENDERED,this.settingsUpdate),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.render)):setTimeout(function(){return t.bindCoreEvents()},100)}},{key:"bindContainerEvents",value:function(){this.core.activeContainer&&(this.listenToOnce(this.core.activeContainer,G.CONTAINER_TIMEUPDATE,this.render),this.listenTo(this.core.activeContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.dvrChanged))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"dvrChanged",value:function(t){this.core.getPlaybackType()===pe.LIVE&&(this.settingsUpdate(),this.core.mediaControl.$el.addClass("live"),t?(this.core.mediaControl.$el.addClass("dvr"),this.core.mediaControl.$el.find(".media-control-indicator[data-position], .media-control-indicator[data-duration]").hide()):this.core.mediaControl.$el.removeClass("dvr"))}},{key:"click",value:function(){var t=this.core.mediaControl,f=t.container;f.isPlaying()||f.play(),t.$el.hasClass("dvr")&&f.seek(f.getDuration())}},{key:"settingsUpdate",value:function(){var t=this;this.stopListening(),this.core.mediaControl.$el.removeClass("live"),this.shouldRender()&&(this.render(),this.$el.click(function(){return t.click()})),this.bindEvents()}},{key:"shouldRender",value:function(){var t=this.core.options.useDvrControls===void 0||!!this.core.options.useDvrControls;return t&&this.core.getPlaybackType()===pe.LIVE}},{key:"render",value:function(){var t=ze.getStyleFor(uf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({live:this.core.i18n.t("live"),backToLive:this.core.i18n.t("back_to_live")})),this.$el.append(t[0]),this.shouldRender()&&(this.core.mediaControl.$el.addClass("live"),this.core.mediaControl.$(".media-control-left-panel[data-media-control]").append(this.$el)),this}}]),i}(yt),ff=function(e){Je(i,e);var n=qe(i);function i(){return Qe(this,i),n.apply(this,arguments)}return Ze(i,[{key:"name",get:function(){return"end_video"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged);var t=this.core.activeContainer;t&&(this.listenTo(t,G.CONTAINER_ENDED,this.ended),this.listenTo(t,G.CONTAINER_STOP,this.ended))}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"ended",value:function(){var t=typeof this.core.options.exitFullscreenOnEnd>"u"||this.core.options.exitFullscreenOnEnd;t&&this.core.isFullscreen()&&this.core.toggleFullscreen()}}]),i}(Rt),df=`<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`,hf=`<div class="player-error-screen__content" data-error-screen>
  <% if (icon) { %>
  <div class="player-error-screen__icon" data-error-screen><%= icon %></div>
  <% } %>
  <div class="player-error-screen__title" data-error-screen><%= title %></div>
  <div class="player-error-screen__message" data-error-screen><%= message %></div>
  <div class="player-error-screen__code" data-error-screen>Error code: <%= code %></div>
  <div class="player-error-screen__reload" data-error-screen><%= reloadIcon %></div>
</div>
`,vf=`[data-player] .player-error-screen {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #CCCACA;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 2000;
  display: flex;
  flex-direction: column;
  justify-content: center; }
  [data-player] .player-error-screen__content[data-error-screen] {
    font-size: 14px;
    color: #CCCACA;
    margin-top: 45px; }
  [data-player] .player-error-screen__title[data-error-screen] {
    font-weight: bold;
    line-height: 30px;
    font-size: 18px; }
  [data-player] .player-error-screen__message[data-error-screen] {
    width: 90%;
    margin: 0 auto; }
  [data-player] .player-error-screen__code[data-error-screen] {
    font-size: 13px;
    margin-top: 15px; }
  [data-player] .player-error-screen__reload {
    cursor: pointer;
    width: 30px;
    margin: 15px auto 0 !important; }
`,gf=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.options.disableErrorScreen?Xs(t,t.disable()):t}return Ze(i,[{key:"name",get:function(){return"error_screen"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return rt(hf)}},{key:"container",get:function(){return this.core.getCurrentContainer()}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.ERROR,this.onError),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onContainerChanged)}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var t=this;this.listenToOnce(this.core,G.CORE_READY,function(){return t.container.play()}),this.core.load(this.options.sources,this.options.mimeType),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onContainerChanged",value:function(){this.err=null,this.unbindReload(),this.hide()}},{key:"onError",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.level===ot.Levels.FATAL&&(this.err=t,this.container.disableMediaControl(),this.container.stop(),this.show())}},{key:"show",value:function(){this.render(),this.$el.show()}},{key:"hide",value:function(){this.$el.hide()}},{key:"render",value:function(){if(this.err){var t=ze.getStyleFor(vf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template({title:this.err.UI.title,message:this.err.UI.message,code:this.err.code,icon:this.err.UI.icon||"",reloadIcon:df})),this.$el.append(t[0]),this.core.$el.append(this.el),this.bindReload(),this}}}]),i}(yt),jt=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M1.425.35L14.575 8l-13.15 7.65V.35z"/>
</svg>`,ni=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 14.76H6.43V1.24H1.71v13.52zm7.86-13.52v13.52h4.716V1.24H9.573z"/>
</svg>`,pf=ve('link[rel="shortcut icon"]'),mf=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t._container=null,t.configure(),t}return Ze(i,[{key:"name",get:function(){return"favicon"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"oldIcon",get:function(){return pf}},{key:"configure",value:function(){this.core.options.changeFavicon?this.enabled||(this.stopListening(this.core,G.CORE_OPTIONS_CHANGE),this.enable()):this.enabled&&(this.disable(),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure))}},{key:"bindEvents",value:function(){this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.core.activeContainer&&this.containerChanged()}},{key:"containerChanged",value:function(){this._container&&this.stopListening(this._container),this._container=this.core.activeContainer,this.listenTo(this._container,G.CONTAINER_PLAY,this.setPlayIcon),this.listenTo(this._container,G.CONTAINER_PAUSE,this.setPauseIcon),this.listenTo(this._container,G.CONTAINER_STOP,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ENDED,this.resetIcon),this.listenTo(this._container,G.CONTAINER_ERROR,this.resetIcon),this.resetIcon()}},{key:"disable",value:function(){cr(kt(i.prototype),"disable",this).call(this),this.resetIcon()}},{key:"destroy",value:function(){cr(kt(i.prototype),"destroy",this).call(this),this.resetIcon()}},{key:"createIcon",value:function(t){var f=ve("<canvas/>");f[0].width=16,f[0].height=16;var b=f[0].getContext("2d");b.fillStyle="#000";var D=ve(t).find("path").attr("d"),m=new Path2D(D);b.fill(m);var N=ve('<link rel="shortcut icon" type="image/png"/>');return N.attr("href",f[0].toDataURL("image/png")),N}},{key:"setPlayIcon",value:function(){this.playIcon||(this.playIcon=this.createIcon(jt)),this.changeIcon(this.playIcon)}},{key:"setPauseIcon",value:function(){this.pauseIcon||(this.pauseIcon=this.createIcon(ni)),this.changeIcon(this.pauseIcon)}},{key:"resetIcon",value:function(){ve('link[rel="shortcut icon"]').remove(),ve("head").append(this.oldIcon)}},{key:"changeIcon",value:function(t){t&&(ve('link[rel="shortcut icon"]').remove(),ve("head").append(t))}}]),i}(Rt),yf=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.container.options.gaAccount&&(t.account=t.container.options.gaAccount,t.trackerName=t.container.options.gaTrackerName?t.container.options.gaTrackerName+".":"Clappr.",t.domainName=t.container.options.gaDomainName,t.currentHDState=void 0,t.embedScript()),t}return Ze(i,[{key:"name",get:function(){return"google_analytics"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"embedScript",value:function(){var t=this;if(window._gat)this.addEventListeners();else{var f=document.createElement("script");f.setAttribute("type","text/javascript"),f.setAttribute("async","async"),f.setAttribute("src","//www.google-analytics.com/ga.js"),f.onload=function(){return t.addEventListeners()},document.body.appendChild(f)}}},{key:"addEventListeners",value:function(){var t=this;this.container&&(this.listenTo(this.container,G.CONTAINER_READY,this.onReady),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PAUSE,this.onPause),this.listenTo(this.container,G.CONTAINER_ENDED,this.onEnded),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.listenTo(this.container,G.CONTAINER_PLAYBACKSTATE,this.onPlaybackChanged),this.listenTo(this.container,G.CONTAINER_VOLUME,function(f){return t.onVolumeChanged(f)}),this.listenTo(this.container,G.CONTAINER_SEEK,function(f){return t.onSeek(f)}),this.listenTo(this.container,G.CONTAINER_FULL_SCREEN,this.onFullscreen),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.onHD),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.onDVR)),_gaq.push([this.trackerName+"_setAccount",this.account]),this.domainName&&_gaq.push([this.trackerName+"_setDomainName",this.domainName])}},{key:"onReady",value:function(){this.push(["Video","Playback",this.container.playback.name])}},{key:"onPlay",value:function(){this.push(["Video","Play",this.container.playback.src])}},{key:"onStop",value:function(){this.push(["Video","Stop",this.container.playback.src])}},{key:"onEnded",value:function(){this.push(["Video","Ended",this.container.playback.src])}},{key:"onBuffering",value:function(){this.push(["Video","Buffering",this.container.playback.src])}},{key:"onBufferFull",value:function(){this.push(["Video","Bufferfull",this.container.playback.src])}},{key:"onError",value:function(){this.push(["Video","Error",this.container.playback.src])}},{key:"onHD",value:function(t){var f=t?"ON":"OFF";f!==this.currentHDState&&(this.currentHDState=f,this.push(["Video","HD - "+f,this.container.playback.src]))}},{key:"onPlaybackChanged",value:function(t){t.type!==null&&this.push(["Video","Playback Type - "+t.type,this.container.playback.src])}},{key:"onDVR",value:function(t){var f=t?"ON":"OFF";this.push(["Interaction","DVR - "+f,this.container.playback.src])}},{key:"onPause",value:function(){this.push(["Video","Pause",this.container.playback.src])}},{key:"onSeek",value:function(){this.push(["Video","Seek",this.container.playback.src])}},{key:"onVolumeChanged",value:function(){this.push(["Interaction","Volume",this.container.playback.src])}},{key:"onFullscreen",value:function(){this.push(["Interaction","Fullscreen",this.container.playback.src])}},{key:"push",value:function(t){var f=[this.trackerName+"_trackEvent"].concat(t);_gaq.push(f)}}]),i}(Qt),ce=function(n){this.element=n||window.document,this.initialize()};ce.KEY_NAMES_BY_CODE={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"caps_lock",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"};ce.KEY_CODES_BY_NAME={};(function(){for(var e in ce.KEY_NAMES_BY_CODE)Object.prototype.hasOwnProperty.call(ce.KEY_NAMES_BY_CODE,e)&&(ce.KEY_CODES_BY_NAME[ce.KEY_NAMES_BY_CODE[e]]=+e)})();ce.MODIFIERS=["shift","ctrl","alt"];ce.registerEvent=function(){if(document.addEventListener)return function(e,n,i){e.addEventListener(n,i,!1)};if(document.attachEvent)return function(e,n,i){e.attachEvent("on"+n,i)}}();ce.unregisterEvent=function(){if(document.removeEventListener)return function(e,n,i){e.removeEventListener(n,i,!1)};if(document.detachEvent)return function(e,n,i){e.detachEvent("on"+n,i)}}();ce.stringContains=function(e,n){return e.indexOf(n)!==-1};ce.neatString=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")};ce.capitalize=function(e){return e.toLowerCase().replace(/^./,function(n){return n.toUpperCase()})};ce.isString=function(e){return ce.stringContains(Object.prototype.toString.call(e),"String")};ce.arrayIncludes=function(){return Array.prototype.indexOf?function(e,n){return e.indexOf(n)!==-1}:function(e,n){for(var i=0;i<e.length;i++)if(e[i]===n)return!0;return!1}}();ce.extractModifiers=function(e){var n,i;for(n=[],i=0;i<ce.MODIFIERS.length;i++)ce.stringContains(e,ce.MODIFIERS[i])&&n.push(ce.MODIFIERS[i]);return n};ce.extractKey=function(e){var n,i;for(n=ce.neatString(e).split(" "),i=0;i<n.length;i++)if(!ce.arrayIncludes(ce.MODIFIERS,n[i]))return n[i]};ce.modifiersAndKey=function(e){var n,i;return ce.stringContains(e,"any")?ce.neatString(e).split(" ").slice(0,2).join(" "):(n=ce.extractModifiers(e),i=ce.extractKey(e),i&&!ce.arrayIncludes(ce.MODIFIERS,i)&&n.push(i),n.join(" "))};ce.keyName=function(e){return ce.KEY_NAMES_BY_CODE[e+""]};ce.keyCode=function(e){return+ce.KEY_CODES_BY_NAME[e]};ce.prototype.initialize=function(){var e,n=this;for(this.lastKeyCode=-1,this.lastModifiers={},e=0;e<ce.MODIFIERS.length;e++)this.lastModifiers[ce.MODIFIERS[e]]=!1;this.keysDown={any:[]},this.keysUp={any:[]},this.downHandler=this.handler("down"),this.upHandler=this.handler("up"),ce.registerEvent(this.element,"keydown",this.downHandler),ce.registerEvent(this.element,"keyup",this.upHandler),ce.registerEvent(window,"unload",function i(){ce.unregisterEvent(n.element,"keydown",n.downHandler),ce.unregisterEvent(n.element,"keyup",n.upHandler),ce.unregisterEvent(window,"unload",i)})};ce.prototype.handler=function(e){var n=this;return function(i){var r,t,f;for(i=i||window.event,n.lastKeyCode=i.keyCode,r=0;r<ce.MODIFIERS.length;r++)n.lastModifiers[ce.MODIFIERS[r]]=i[ce.MODIFIERS[r]+"Key"];for(ce.arrayIncludes(ce.MODIFIERS,ce.keyName(n.lastKeyCode))&&(n.lastModifiers[ce.keyName(n.lastKeyCode)]=!0),t=n["keys"+ce.capitalize(e)],r=0;r<t.any.length;r++)t.any[r](i)===!1&&i.preventDefault&&i.preventDefault();if(f=n.lastModifiersAndKey(),t[f])for(r=0;r<t[f].length;r++)t[f][r](i)===!1&&i.preventDefault&&i.preventDefault()}};ce.prototype.registerKeys=function(e,n,i){var r,t,f=this["keys"+ce.capitalize(e)];for(ce.isString(n)&&(n=[n]),r=0;r<n.length;r++)t=n[r],t=ce.modifiersAndKey(t+""),f[t]?f[t].push(i):f[t]=[i];return this};ce.prototype.unregisterKeys=function(e,n,i){var r,t,f,b=this["keys"+ce.capitalize(e)];for(ce.isString(n)&&(n=[n]),r=0;r<n.length;r++)if(f=n[r],f=ce.modifiersAndKey(f+""),i===null)delete b[f];else if(b[f]){for(t=0;t<b[f].length;t++)if(String(b[f][t])===String(i)){b[f].splice(t,1);break}}return this};ce.prototype.off=function(e){return this.unregisterKeys("down",e,null)};ce.prototype.delegate=function(e,n,i){return i!==null||i!==void 0?this.registerKeys(e,n,i):this.unregisterKeys(e,n,i)};ce.prototype.down=function(e,n){return this.delegate("down",e,n)};ce.prototype.up=function(e,n){return this.delegate("up",e,n)};ce.prototype.lastKey=function(e){return e?this.lastModifiers[e]:ce.keyName(this.lastKeyCode)};ce.prototype.lastModifiersAndKey=function(){var e,n;for(e=[],n=0;n<ce.MODIFIERS.length;n++)this.lastKey(ce.MODIFIERS[n])&&e.push(ce.MODIFIERS[n]);return ce.arrayIncludes(e,this.lastKey())||e.push(this.lastKey()),e.join(" ")};var Ef=`.media-control-notransition {
  transition: none !important; }

.media-control[data-media-control] {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 9999;
  pointer-events: none; }
  .media-control[data-media-control].dragging {
    pointer-events: auto;
    cursor: grabbing !important;
    cursor: url("closed-hand.cur"), move; }
    .media-control[data-media-control].dragging * {
      cursor: grabbing !important;
      cursor: url("closed-hand.cur"), move; }
  .media-control[data-media-control] .media-control-background[data-background] {
    position: absolute;
    height: 40%;
    width: 100%;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
    will-change: transform, opacity;
    transition: opacity 0.6s ease-out; }
  .media-control[data-media-control] .media-control-icon {
    line-height: 0;
    letter-spacing: 0;
    speak: none;
    color: #fff;
    opacity: 0.5;
    vertical-align: middle;
    text-align: left;
    transition: all 0.1s ease; }
  .media-control[data-media-control] .media-control-icon:hover {
    color: white;
    opacity: 0.75;
    text-shadow: rgba(255, 255, 255, 0.8) 0 0 5px; }
  .media-control[data-media-control].media-control-hide .media-control-background[data-background] {
    opacity: 0; }
  .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] {
    transform: translateY(50px); }
    .media-control[data-media-control].media-control-hide .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
      opacity: 0; }
  .media-control[data-media-control] .media-control-layer[data-controls] {
    position: absolute;
    transform: translateY(-7px);
    bottom: 0;
    width: 100%;
    height: 32px;
    font-size: 0;
    vertical-align: middle;
    pointer-events: auto;
    transition: bottom 0.4s ease-out; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-left-panel[data-media-control] {
      position: absolute;
      top: 0;
      left: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-center-panel[data-media-control] {
      height: 100%;
      text-align: center;
      line-height: 32px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-right-panel[data-media-control] {
      position: absolute;
      top: 0;
      right: 4px;
      height: 100%; }
    .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button {
      background-color: transparent;
      border: 0;
      margin: 0 6px;
      padding: 0;
      cursor: pointer;
      display: inline-block;
      width: 32px;
      height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg {
        width: 100%;
        height: 22px; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button svg path {
          fill: white; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button:focus {
        outline: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-play] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-pause] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-stop] {
        float: left;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-fullscreen] {
        float: right;
        background-color: transparent;
        border: 0;
        height: 100%; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator] {
        background-color: transparent;
        border: 0;
        cursor: default;
        display: none;
        float: right;
        height: 100%; }
        .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled {
          display: block;
          opacity: 1.0; }
          .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-hd-indicator].enabled:hover {
            opacity: 1.0;
            text-shadow: none; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playpause] {
        float: left; }
      .media-control[data-media-control] .media-control-layer[data-controls] button.media-control-button[data-playstop] {
        float: left; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position], .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      display: inline-block;
      font-size: 10px;
      color: white;
      cursor: default;
      line-height: 32px;
      position: relative; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-position] {
      margin: 0 6px 0 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration] {
      color: rgba(255, 255, 255, 0.5);
      margin-right: 6px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .media-control-indicator[data-duration]:before {
        content: "|";
        margin-right: 7px; }
    .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] {
      position: absolute;
      top: -20px;
      left: 0;
      display: inline-block;
      vertical-align: middle;
      width: 100%;
      height: 25px;
      cursor: pointer; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] {
        width: 100%;
        height: 1px;
        position: relative;
        top: 12px;
        background-color: #666666; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-1[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #c2c2c2;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-fill-2[data-seekbar] {
          position: absolute;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          background-color: #005aff;
          transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0;
          position: absolute;
          top: -3px;
          width: 5px;
          height: 7px;
          background-color: rgba(255, 255, 255, 0.5);
          transition: opacity 0.1s ease; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar]:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
        opacity: 1; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled {
        cursor: default; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar].seek-disabled:hover .bar-background[data-seekbar] .bar-hover[data-seekbar] {
          opacity: 0; }
      .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] {
        position: absolute;
        transform: translateX(-50%);
        top: 2px;
        left: 0;
        width: 20px;
        height: 20px;
        opacity: 1;
        transition: all 0.1s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .bar-container[data-seekbar] .bar-scrubber[data-seekbar] .bar-scrubber-icon[data-seekbar] {
          position: absolute;
          left: 6px;
          top: 6px;
          width: 8px;
          height: 8px;
          border-radius: 10px;
          box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
          background-color: white; }
    .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] {
      float: right;
      display: inline-block;
      height: 32px;
      cursor: pointer;
      margin: 0 6px;
      box-sizing: border-box; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] {
        float: left;
        bottom: 0; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] {
          background-color: transparent;
          border: 0;
          box-sizing: content-box;
          width: 32px;
          height: 32px;
          opacity: 0.5; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume]:hover {
            opacity: 0.75; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg {
            height: 24px;
            position: relative;
            top: 3px; }
            .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume] svg path {
              fill: white; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .drawer-icon-container[data-volume] .drawer-icon[data-volume].muted svg {
            margin-left: 2px; }
      .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] {
        float: left;
        position: relative;
        overflow: hidden;
        top: 6px;
        width: 42px;
        height: 18px;
        padding: 3px 0;
        transition: width .2s ease-out; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] {
          height: 1px;
          position: relative;
          top: 7px;
          margin: 0 3px;
          background-color: #666666; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-1[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #c2c2c2;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-fill-2[data-volume] {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background-color: #005aff;
            transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-background[data-volume] .bar-hover[data-volume] {
            opacity: 0;
            position: absolute;
            top: -3px;
            width: 5px;
            height: 7px;
            background-color: rgba(255, 255, 255, 0.5);
            transition: opacity 0.1s ease; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] {
          position: absolute;
          transform: translateX(-50%);
          top: 0px;
          left: 0;
          width: 20px;
          height: 20px;
          opacity: 1;
          transition: all 0.1s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .bar-scrubber[data-volume] .bar-scrubber-icon[data-volume] {
            position: absolute;
            left: 6px;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 10px;
            box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.2);
            background-color: white; }
        .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume] {
          float: left;
          width: 4px;
          padding-left: 2px;
          height: 12px;
          opacity: 0.5;
          box-shadow: inset 2px 0 0 white;
          transition: transform .2s ease-out; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume].fill {
            box-shadow: inset 2px 0 0 #fff;
            opacity: 1; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:nth-of-type(1) {
            padding-left: 0; }
          .media-control[data-media-control] .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume] .segmented-bar-element[data-volume]:hover {
            transform: scaleY(1.5); }
  .media-control[data-media-control].w320 .media-control-layer[data-controls] .drawer-container[data-volume] .bar-container[data-volume].volume-bar-hide {
    width: 0;
    height: 12px;
    top: 9px;
    padding: 0; }
`,Af=`<div class="media-control-background" data-background></div>
<div class="media-control-layer" data-controls>
  <%  var renderBar = function(name) { %>
      <div class="bar-container" data-<%= name %>>
        <div class="bar-background" data-<%= name %>>
          <div class="bar-fill-1" data-<%= name %>></div>
          <div class="bar-fill-2" data-<%= name %>></div>
          <div class="bar-hover" data-<%= name %>></div>
        </div>
        <div class="bar-scrubber" data-<%= name %>>
          <div class="bar-scrubber-icon" data-<%= name %>></div>
        </div>
      </div>
  <%  }; %>
  <%  var renderSegmentedBar = function(name, segments) {
      segments = segments || 10; %>
    <div class="bar-container" data-<%= name %>>
    <% for (var i = 0; i < segments; i++) { %>
      <div class="segmented-bar-element" data-<%= name %>></div>
    <% } %>
    </div>
  <% }; %>
  <% var renderDrawer = function(name, renderContent) { %>
      <div class="drawer-container" data-<%= name %>>
        <div class="drawer-icon-container" data-<%= name %>>
          <div class="drawer-icon media-control-icon" data-<%= name %>></div>
          <span class="drawer-text" data-<%= name %>></span>
        </div>
        <% renderContent(name); %>
      </div>
  <% }; %>
  <% var renderIndicator = function(name) { %>
      <div class="media-control-indicator" data-<%= name %>></div>
  <% }; %>
  <% var renderButton = function(name) { %>
    <button type="button" class="media-control-button media-control-icon" data-<%= name %> aria-label="<%= name %>"></button>
  <% }; %>
  <%  var templates = {
        bar: renderBar,
        segmentedBar: renderSegmentedBar,
      };
      var render = function(settingsList) {
        settingsList.forEach(function(setting) {
          if(setting === "seekbar") {
            renderBar(setting);
          } else if (setting === "volume") {
            renderDrawer(setting, settings.volumeBarTemplate ? templates[settings.volumeBarTemplate] : function(name) { return renderSegmentedBar(name); });
          } else if (setting === "duration" || setting === "position") {
            renderIndicator(setting);
          } else {
            renderButton(setting);
          }
        });
      }; %>
  <% if (settings.default && settings.default.length) { %>
  <div class="media-control-center-panel" data-media-control>
    <% render(settings.default); %>
  </div>
  <% } %>
  <% if (settings.left && settings.left.length) { %>
  <div class="media-control-left-panel" data-media-control>
    <% render(settings.left); %>
  </div>
  <% } %>
  <% if (settings.right && settings.right.length) { %>
  <div class="media-control-right-panel" data-media-control>
    <% render(settings.right); %>
  </div>
  <% } %>
</div>
`,Sa=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M1.712 1.24h12.6v13.52h-12.6z"/>
</svg>`,xa=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M11.5 11h-.002v1.502L7.798 10H4.5V6h3.297l3.7-2.502V4.5h.003V11zM11 4.49L7.953 6.5H5v3h2.953L11 11.51V4.49z"/>
</svg>`,_f=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#010101" d="M9.75 11.51L6.7 9.5H3.75v-3H6.7L9.75 4.49v.664l.497.498V3.498L6.547 6H3.248v4h3.296l3.7 2.502v-2.154l-.497.5v.662zm3-5.165L12.404 6l-1.655 1.653L9.093 6l-.346.345L10.402 8 8.747 9.654l.346.347 1.655-1.653L12.403 10l.348-.346L11.097 8l1.655-1.655z"/>
</svg>`,Ca=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M7.156 8L4 11.156V8.5H3V13h4.5v-1H4.844L8 8.844 7.156 8zM8.5 3v1h2.657L8 7.157 8.846 8 12 4.844V7.5h1V3H8.5z"/>
</svg>`,Tf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M13.5 3.344l-.844-.844L9.5 5.656V3h-1v4.5H13v-1h-2.656L13.5 3.344zM3 9.5h2.656L2.5 12.656l.844.844L6.5 10.344V13h1V8.5H3v1z"/>
</svg>`,bf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
  <path fill="#010101" d="M5.375 7.062H2.637V4.26H.502v7.488h2.135V8.9h2.738v2.848h2.133V4.26H5.375v2.802zm5.97-2.81h-2.84v7.496h2.798c2.65 0 4.195-1.607 4.195-3.77v-.022c0-2.162-1.523-3.704-4.154-3.704zm2.06 3.758c0 1.21-.81 1.896-2.03 1.896h-.83V6.093h.83c1.22 0 2.03.696 2.03 1.896v.02z"/>
</svg>`,La=wt.Config,Pa=wt.Fullscreen,Da=wt.formatTime,Sf=wt.extend,Bn=wt.removeArrayItem,ii=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.persistConfig=t.options.persistConfig,t.currentPositionValue=null,t.currentDurationValue=null,t.keepVisible=!1,t.fullScreenOnVideoTagSupported=null,t.setInitialVolume(),t.settings={left:["play","stop","pause"],right:["volume"],default:["position","seekbar","duration"]},t.kibo=new ce(t.options.focusElement),t.bindKeyEvents(),t.container?ve.isEmptyObject(t.container.settings)||(t.settings=ve.extend({},t.container.settings)):t.settings={},t.userDisabled=!1,(t.container&&t.container.mediaControlDisabled||t.options.chromeless)&&t.disable(),t.stopDragHandler=function(f){return t.stopDrag(f)},t.updateDragHandler=function(f){return t.updateDrag(f)},ve(document).bind("mouseup",t.stopDragHandler),ve(document).bind("mousemove",t.updateDragHandler),t}return Ze(i,[{key:"name",get:function(){return"media_control"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"disabled",get:function(){var t=this.container&&this.container.getPlaybackType()===pe.NO_OP;return this.userDisabled||t}},{key:"container",get:function(){return this.core&&this.core.activeContainer}},{key:"playback",get:function(){return this.core&&this.core.activePlayback}},{key:"attributes",get:function(){return{class:"media-control","data-media-control":""}}},{key:"events",get:function(){return{"click [data-play]":"play","click [data-pause]":"pause","click [data-playpause]":"togglePlayPause","click [data-stop]":"stop","click [data-playstop]":"togglePlayStop","click [data-fullscreen]":"toggleFullscreen","click .bar-container[data-seekbar]":"seek","click .bar-container[data-volume]":"onVolumeClick","click .drawer-icon[data-volume]":"toggleMute","mouseenter .drawer-container[data-volume]":"showVolumeBar","mouseleave .drawer-container[data-volume]":"hideVolumeBar","mousedown .bar-container[data-volume]":"startVolumeDrag","mousemove .bar-container[data-volume]":"mousemoveOnVolumeBar","mousedown .bar-scrubber[data-seekbar]":"startSeekDrag","mousemove .bar-container[data-seekbar]":"mousemoveOnSeekBar","mouseleave .bar-container[data-seekbar]":"mouseleaveOnSeekBar","mouseenter .media-control-layer[data-controls]":"setUserKeepVisible","mouseleave .media-control-layer[data-controls]":"resetUserKeepVisible"}}},{key:"template",get:function(){return rt(Af)}},{key:"volume",get:function(){return this.container&&this.container.isReady?this.container.volume:this.intendedVolume}},{key:"muted",get:function(){return this.volume===0}},{key:"getExternalInterface",value:function(){var t=this;return{setVolume:this.setVolume,getVolume:function(){return t.volume}}}},{key:"bindEvents",value:function(){var t=this;this.stopListening(),this.listenTo(this.core,G.CORE_ACTIVE_CONTAINER_CHANGED,this.onActiveContainerChanged),this.listenTo(this.core,G.CORE_MOUSE_MOVE,this.show),this.listenTo(this.core,G.CORE_MOUSE_LEAVE,function(){return t.hide(t.options.hideMediaControlDelay)}),this.listenTo(this.core,G.CORE_FULLSCREEN,this.show),this.listenTo(this.core,G.CORE_OPTIONS_CHANGE,this.configure),this.listenTo(this.core,G.CORE_RESIZE,this.playerResize),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container&&(this.listenTo(this.container,G.CONTAINER_PLAY,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_PAUSE,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_STOP,this.changeTogglePlay),this.listenTo(this.container,G.CONTAINER_DBLCLICK,this.toggleFullscreen),this.listenTo(this.container,G.CONTAINER_TIMEUPDATE,this.onTimeUpdate),this.listenTo(this.container,G.CONTAINER_PROGRESS,this.updateProgressBar),this.listenTo(this.container,G.CONTAINER_SETTINGSUPDATE,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.settingsUpdate),this.listenTo(this.container,G.CONTAINER_HIGHDEFINITIONUPDATE,this.highDefinitionUpdate),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_DISABLE,this.disable),this.listenTo(this.container,G.CONTAINER_MEDIACONTROL_ENABLE,this.enable),this.listenTo(this.container,G.CONTAINER_ENDED,this.ended),this.listenTo(this.container,G.CONTAINER_VOLUME,this.onVolumeChanged),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.setInitialVolume),this.container.playback.el.nodeName.toLowerCase()==="video"&&this.listenToOnce(this.container,G.CONTAINER_LOADEDMETADATA,this.onLoadedMetadataOnVideoTag))}},{key:"disable",value:function(){this.userDisabled=!0,this.hide(),this.unbindKeyEvents(),this.$el.hide()}},{key:"enable",value:function(){this.options.chromeless||(this.userDisabled=!1,this.bindKeyEvents(),this.show())}},{key:"play",value:function(){this.container&&this.container.play()}},{key:"pause",value:function(){this.container&&this.container.pause()}},{key:"stop",value:function(){this.container&&this.container.stop()}},{key:"setInitialVolume",value:function(){var t=this.persistConfig?La.restore("volume"):100,f=this.container&&this.container.options||this.options;this.setVolume(f.mute?0:t,!0)}},{key:"onVolumeChanged",value:function(){this.updateVolumeUI()}},{key:"onLoadedMetadataOnVideoTag",value:function(){var t=this.playback&&this.playback.el;!Pa.fullscreenEnabled()&&t.webkitSupportsFullscreen&&(this.fullScreenOnVideoTagSupported=!0,this.settingsUpdate())}},{key:"updateVolumeUI",value:function(){if(this.rendered){this.$volumeBarContainer.find(".bar-fill-2").css({});var t=this.$volumeBarContainer.width(),f=this.$volumeBarBackground.width(),b=(t-f)/2,D=f*this.volume/100+b;this.$volumeBarFill.css({width:"".concat(this.volume,"%")}),this.$volumeBarScrubber.css({left:D}),this.$volumeBarContainer.find(".segmented-bar-element").removeClass("fill");var m=Math.ceil(this.volume/10);this.$volumeBarContainer.find(".segmented-bar-element").slice(0,m).addClass("fill"),this.$volumeIcon.html(""),this.$volumeIcon.removeClass("muted"),this.muted?(this.$volumeIcon.append(_f),this.$volumeIcon.addClass("muted")):this.$volumeIcon.append(xa),this.applyButtonStyle(this.$volumeIcon)}}},{key:"changeTogglePlay",value:function(){this.$playPauseToggle.html(""),this.$playStopToggle.html(""),this.container&&this.container.isPlaying()?(this.$playPauseToggle.append(ni),this.$playStopToggle.append(Sa),this.trigger(G.MEDIACONTROL_PLAYING)):(this.$playPauseToggle.append(jt),this.$playStopToggle.append(jt),this.trigger(G.MEDIACONTROL_NOTPLAYING),de.isMobile&&this.show()),this.applyButtonStyle(this.$playPauseToggle),this.applyButtonStyle(this.$playStopToggle)}},{key:"mousemoveOnSeekBar",value:function(t){if(this.settings.seekEnabled){var f=t.pageX-this.$seekBarContainer.offset().left-this.$seekBarHover.width()/2;this.$seekBarHover.css({left:f})}this.trigger(G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,t)}},{key:"mouseleaveOnSeekBar",value:function(t){this.trigger(G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,t)}},{key:"onVolumeClick",value:function(t){this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"mousemoveOnVolumeBar",value:function(t){this.draggingVolumeBar&&this.setVolume(this.getVolumeFromUIEvent(t))}},{key:"playerResize",value:function(t){this.$fullscreenToggle.html("");var f=this.core.isFullscreen()?Tf:Ca;this.$fullscreenToggle.append(f),this.applyButtonStyle(this.$fullscreenToggle),this.$el.find(".media-control").length!==0&&this.$el.removeClass("w320"),(t.width<=320||this.options.hideVolumeBar)&&this.$el.addClass("w320")}},{key:"togglePlayPause",value:function(){return this.container.isPlaying()?this.container.pause():this.container.play(),!1}},{key:"togglePlayStop",value:function(){this.container.isPlaying()?this.container.stop():this.container.play()}},{key:"startSeekDrag",value:function(t){this.settings.seekEnabled&&(this.draggingSeekBar=!0,this.$el.addClass("dragging"),this.$seekBarLoaded.addClass("media-control-notransition"),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition"),t&&t.preventDefault())}},{key:"startVolumeDrag",value:function(t){this.draggingVolumeBar=!0,this.$el.addClass("dragging"),t&&t.preventDefault()}},{key:"stopDrag",value:function(t){this.draggingSeekBar&&this.seek(t),this.$el.removeClass("dragging"),this.$seekBarLoaded.removeClass("media-control-notransition"),this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition dragging"),this.draggingSeekBar=!1,this.draggingVolumeBar=!1}},{key:"updateDrag",value:function(t){if(this.draggingSeekBar){t.preventDefault();var f=t.pageX-this.$seekBarContainer.offset().left,b=f/this.$seekBarContainer.width()*100;b=Math.min(100,Math.max(b,0)),this.setSeekPercentage(b)}else this.draggingVolumeBar&&(t.preventDefault(),this.setVolume(this.getVolumeFromUIEvent(t)))}},{key:"getVolumeFromUIEvent",value:function(t){var f=t.pageX-this.$volumeBarContainer.offset().left,b=f/this.$volumeBarContainer.width()*100;return b}},{key:"toggleMute",value:function(){this.setVolume(this.muted?100:0)}},{key:"setVolume",value:function(t){var f=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t=Math.min(100,Math.max(t,0)),this.intendedVolume=t,this.persistConfig&&!b&&La.persist("volume",t);var D=function(){f.container&&f.container.isReady?f.container.setVolume(t):f.listenToOnce(f.container,G.CONTAINER_READY,function(){f.container.setVolume(t)})};this.container?D():this.listenToOnce(this,G.MEDIACONTROL_CONTAINERCHANGED,function(){return D()})}},{key:"toggleFullscreen",value:function(){this.trigger(G.MEDIACONTROL_FULLSCREEN,this.name),this.container.fullscreen(),this.core.toggleFullscreen(),this.resetUserKeepVisible()}},{key:"onActiveContainerChanged",value:function(){this.fullScreenOnVideoTagSupported=null,this.bindEvents(),this.setInitialVolume(),this.changeTogglePlay(),this.bindContainerEvents(),this.settingsUpdate(),this.container&&this.container.trigger(G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.container.isDvrInUse()),this.container&&this.container.mediaControlDisabled&&this.disable(),this.trigger(G.MEDIACONTROL_CONTAINERCHANGED)}},{key:"showVolumeBar",value:function(){this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.$volumeBarContainer.removeClass("volume-bar-hide")}},{key:"hideVolumeBar",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:400;this.$volumeBarContainer&&(this.draggingVolumeBar?this.hideVolumeId=setTimeout(function(){return t.hideVolumeBar()},f):(this.hideVolumeId&&clearTimeout(this.hideVolumeId),this.hideVolumeId=setTimeout(function(){return t.$volumeBarContainer.addClass("volume-bar-hide")},f)))}},{key:"ended",value:function(){this.changeTogglePlay()}},{key:"updateProgressBar",value:function(t){var f=t.start/t.total*100,b=t.current/t.total*100;this.$seekBarLoaded.css({left:"".concat(f,"%"),width:"".concat(b-f,"%")})}},{key:"onTimeUpdate",value:function(t){if(!this.draggingSeekBar){var f=t.current<0?t.total:t.current;this.currentPositionValue=f,this.currentDurationValue=t.total,this.renderSeekBar()}}},{key:"renderSeekBar",value:function(){if(!(this.currentPositionValue===null||this.currentDurationValue===null)){this.currentSeekBarPercentage=100,this.container&&(this.container.getPlaybackType()!==pe.LIVE||this.container.isDvrInUse())&&(this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100),this.setSeekPercentage(this.currentSeekBarPercentage);var t=Da(this.currentPositionValue),f=Da(this.currentDurationValue);t!==this.displayedPosition&&(this.$position.text(t),this.displayedPosition=t),f!==this.displayedDuration&&(this.$duration.text(f),this.displayedDuration=f)}}},{key:"seek",value:function(t){if(this.settings.seekEnabled){var f=t.pageX-this.$seekBarContainer.offset().left,b=f/this.$seekBarContainer.width()*100;return b=Math.min(100,Math.max(b,0)),this.container&&this.container.seekPercentage(b),this.setSeekPercentage(b),!1}}},{key:"setKeepVisible",value:function(){this.keepVisible=!0}},{key:"resetKeepVisible",value:function(){this.keepVisible=!1}},{key:"setUserKeepVisible",value:function(){this.userKeepVisible=!0}},{key:"resetUserKeepVisible",value:function(){this.userKeepVisible=!1}},{key:"isVisible",value:function(){return!this.$el.hasClass("media-control-hide")}},{key:"show",value:function(t){var f=this;if(!this.disabled){var b=2e3,D=t&&t.clientX!==this.lastMouseX&&t.clientY!==this.lastMouseY;(!t||D||navigator.userAgent.match(/firefox/i))&&(clearTimeout(this.hideId),this.$el.show(),this.trigger(G.MEDIACONTROL_SHOW,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_SHOW,this.name),this.$el.removeClass("media-control-hide"),this.hideId=setTimeout(function(){return f.hide()},b),t&&(this.lastMouseX=t.clientX,this.lastMouseY=t.clientY));var m=!0;this.updateCursorStyle(m)}}},{key:"hide",value:function(){var t=this,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(this.isVisible()){var b=f||2e3;if(clearTimeout(this.hideId),!(!this.disabled&&this.options.hideMediaControl===!1)){var D=this.userKeepVisible||this.keepVisible,m=this.draggingSeekBar||this.draggingVolumeBar;if(!this.disabled&&(f||D||m))this.hideId=setTimeout(function(){return t.hide()},b);else{this.trigger(G.MEDIACONTROL_HIDE,this.name),this.container&&this.container.trigger(G.CONTAINER_MEDIACONTROL_HIDE,this.name),this.$el.addClass("media-control-hide"),this.hideVolumeBar(0);var N=!1;this.updateCursorStyle(N)}}}}},{key:"updateCursorStyle",value:function(t){t?this.core.$el.removeClass("nocursor"):this.core.isFullscreen()&&this.core.$el.addClass("nocursor")}},{key:"settingsUpdate",value:function(){var t=this.getSettings();t&&!this.fullScreenOnVideoTagSupported&&!Pa.fullscreenEnabled()&&(t.default&&Bn(t.default,"fullscreen"),t.left&&Bn(t.left,"fullscreen"),t.right&&Bn(t.right,"fullscreen"));var f=JSON.stringify(this.settings)!==JSON.stringify(t);f&&(this.settings=t,this.render())}},{key:"getSettings",value:function(){return ve.extend(!0,{},this.container&&this.container.settings)}},{key:"highDefinitionUpdate",value:function(t){this.isHD=t;var f=t?"addClass":"removeClass";this.$hdIndicator[f]("enabled")}},{key:"createCachedElements",value:function(){var t=this.$el.find(".media-control-layer");this.$duration=t.find(".media-control-indicator[data-duration]"),this.$fullscreenToggle=t.find("button.media-control-button[data-fullscreen]"),this.$playPauseToggle=t.find("button.media-control-button[data-playpause]"),this.$playStopToggle=t.find("button.media-control-button[data-playstop]"),this.$position=t.find(".media-control-indicator[data-position]"),this.$seekBarContainer=t.find(".bar-container[data-seekbar]"),this.$seekBarHover=t.find(".bar-hover[data-seekbar]"),this.$seekBarLoaded=t.find(".bar-fill-1[data-seekbar]"),this.$seekBarPosition=t.find(".bar-fill-2[data-seekbar]"),this.$seekBarScrubber=t.find(".bar-scrubber[data-seekbar]"),this.$volumeBarContainer=t.find(".bar-container[data-volume]"),this.$volumeContainer=t.find(".drawer-container[data-volume]"),this.$volumeIcon=t.find(".drawer-icon[data-volume]"),this.$volumeBarBackground=this.$el.find(".bar-background[data-volume]"),this.$volumeBarFill=this.$el.find(".bar-fill-1[data-volume]"),this.$volumeBarScrubber=this.$el.find(".bar-scrubber[data-volume]"),this.$hdIndicator=this.$el.find("button.media-control-button[data-hd-indicator]"),this.resetIndicators(),this.initializeIcons()}},{key:"resetIndicators",value:function(){this.displayedPosition=this.$position.text(),this.displayedDuration=this.$duration.text()}},{key:"initializeIcons",value:function(){var t=this.$el.find(".media-control-layer");t.find("button.media-control-button[data-play]").append(jt),t.find("button.media-control-button[data-pause]").append(ni),t.find("button.media-control-button[data-stop]").append(Sa),this.$playPauseToggle.append(jt),this.$playStopToggle.append(jt),this.$volumeIcon.append(xa),this.$fullscreenToggle.append(Ca),this.$hdIndicator.append(bf)}},{key:"setSeekPercentage",value:function(t){t=Math.max(Math.min(t,100),0),this.displayedSeekBarPercentage!==t&&(this.displayedSeekBarPercentage=t,this.$seekBarPosition.removeClass("media-control-notransition"),this.$seekBarScrubber.removeClass("media-control-notransition"),this.$seekBarPosition.css({width:"".concat(t,"%")}),this.$seekBarScrubber.css({left:"".concat(t,"%")}))}},{key:"seekRelative",value:function(t){if(this.settings.seekEnabled){var f=this.container.getCurrentTime(),b=this.container.getDuration(),D=Math.min(Math.max(f+t,0),b);D=Math.min(D*100/b,100),this.container.seekPercentage(D)}}},{key:"bindKeyAndShow",value:function(t,f){var b=this;this.kibo.down(t,function(){return b.show(),f()})}},{key:"bindKeyEvents",value:function(){var t=this;if(!(de.isMobile||this.options.disableKeyboardShortcuts)){this.unbindKeyEvents(),this.kibo=new ce(this.options.focusElement||this.options.parentElement),this.bindKeyAndShow("space",function(){return t.togglePlayPause()}),this.bindKeyAndShow("left",function(){return t.seekRelative(-5)}),this.bindKeyAndShow("right",function(){return t.seekRelative(5)}),this.bindKeyAndShow("shift left",function(){return t.seekRelative(-10)}),this.bindKeyAndShow("shift right",function(){return t.seekRelative(10)}),this.bindKeyAndShow("shift ctrl left",function(){return t.seekRelative(-15)}),this.bindKeyAndShow("shift ctrl right",function(){return t.seekRelative(15)});var f=["1","2","3","4","5","6","7","8","9","0"];f.forEach(function(b){t.bindKeyAndShow(b,function(){t.settings.seekEnabled&&t.container&&t.container.seekPercentage(b*10)})})}}},{key:"unbindKeyEvents",value:function(){this.kibo&&(this.kibo.off("space"),this.kibo.off("left"),this.kibo.off("right"),this.kibo.off("shift left"),this.kibo.off("shift right"),this.kibo.off("shift ctrl left"),this.kibo.off("shift ctrl right"),this.kibo.off(["1","2","3","4","5","6","7","8","9","0"]))}},{key:"parseColors",value:function(){if(this.options.mediacontrol){this.buttonsColor=this.options.mediacontrol.buttons;var t=this.options.mediacontrol.seekbar;this.$el.find(".bar-fill-2[data-seekbar]").css("background-color",t),this.$el.find(".media-control-icon svg path").css("fill",this.buttonsColor),this.$el.find(".segmented-bar-element[data-volume]").css("boxShadow","inset 2px 0 0 "+this.buttonsColor)}}},{key:"applyButtonStyle",value:function(t){this.buttonsColor&&t&&ve(t).find("svg path").css("fill",this.buttonsColor)}},{key:"destroy",value:function(){ve(document).unbind("mouseup",this.stopDragHandler),ve(document).unbind("mousemove",this.updateDragHandler),this.unbindKeyEvents(),this.stopListening(),cr(kt(i.prototype),"destroy",this).call(this)}},{key:"configure",value:function(t){this.options.chromeless||t.source||t.sources?this.disable():this.enable(),this.trigger(G.MEDIACONTROL_OPTIONS_CHANGE)}},{key:"render",value:function(){var t=this,f=this.options.hideMediaControlDelay||2e3;this.settings&&this.$el.html(this.template({settings:this.settings}));var b=ze.getStyleFor(Ef,{baseUrl:this.options.baseUrl});this.$el.append(b[0]),this.createCachedElements(),this.$playPauseToggle.addClass("paused"),this.$playStopToggle.addClass("stopped"),this.changeTogglePlay(),this.container&&(this.hideId=setTimeout(function(){return t.hide()},f),this.disabled&&this.hide()),de.isSafari&&de.isMobile&&(de.version<10?this.$volumeContainer.css("display","none"):this.$volumeBarContainer.css("display","none")),this.$seekBarPosition.addClass("media-control-notransition"),this.$seekBarScrubber.addClass("media-control-notransition");var D=0;return this.displayedSeekBarPercentage&&(D=this.displayedSeekBarPercentage),this.displayedSeekBarPercentage=null,this.setSeekPercentage(D),setTimeout(function(){!t.settings.seekEnabled&&t.$seekBarContainer.addClass("seek-disabled"),!de.isMobile&&!t.options.disableKeyboardShortcuts&&t.bindKeyEvents(),t.playerResize({width:t.options.width,height:t.options.height}),t.hideVolumeBar(0)},0),this.parseColors(),this.highDefinitionUpdate(this.isHD),this.core.$el.append(this.el),this.rendered=!0,this.updateVolumeUI(),this.trigger(G.MEDIACONTROL_RENDERED),this}}]),i}(yt);ii.extend=function(e){return Sf(ii,e)};var xf=`<div class="play-wrapper" data-poster></div>
`,Cf=`.player-poster[data-poster] {
  display: flex;
  justify-content: center;
  align-items: center;
  position: absolute;
  height: 100%;
  width: 100%;
  z-index: 998;
  top: 0;
  left: 0;
  background-color: transparent;
  background-size: cover;
  background-repeat: no-repeat;
  background-position: 50% 50%; }
  .player-poster[data-poster].clickable {
    cursor: pointer; }
  .player-poster[data-poster]:hover .play-wrapper[data-poster] {
    opacity: 1; }
  .player-poster[data-poster] .play-wrapper[data-poster] {
    width: 100%;
    height: 25%;
    margin: 0 auto;
    opacity: 0.75;
    transition: opacity 0.1s ease; }
    .player-poster[data-poster] .play-wrapper[data-poster] svg {
      height: 100%; }
      .player-poster[data-poster] .play-wrapper[data-poster] svg path {
        fill: #fff; }
`,Lf=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.hasStartedPlaying=!1,t.playRequested=!1,t.render(),setTimeout(function(){return t.update()},0),t}return Ze(i,[{key:"name",get:function(){return"poster"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return rt(xf)}},{key:"shouldRender",get:function(){var t=!!(this.options.poster&&this.options.poster.showForNoOp);return this.container.playback.name!=="html_img"&&(this.container.playback.getPlaybackType()!==pe.NO_OP||t)}},{key:"attributes",get:function(){return{class:"player-poster","data-poster":""}}},{key:"events",get:function(){return{click:"clicked"}}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||this.options.poster.showOnVideoEnd===void 0}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.update),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.update),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.render),this.listenTo(this.container,G.CONTAINER_ERROR,this.onError),this.showOnVideoEnd&&this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop)}},{key:"onError",value:function(t){this.hasFatalError=t.level===ot.Levels.FATAL,this.hasFatalError&&(this.hasStartedPlaying=!1,this.playRequested=!1,this.showPlayButton())}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"updatePlayButton",value:function(t){t&&(!this.options.chromeless||this.options.allowUserInteraction)?this.showPlayButton():this.hidePlayButton()}},{key:"showPlayButton",value:function(){this.hasFatalError&&!this.options.disableErrorScreen||(this.$playButton.show(),this.$el.addClass("clickable"))}},{key:"hidePlayButton",value:function(){this.$playButton.hide(),this.$el.removeClass("clickable")}},{key:"clicked",value:function(){if(!this.hasStartedPlaying)return(!this.options.chromeless||this.options.allowUserInteraction)&&(this.playRequested=!0,this.update(),this.container.playback&&(this.container.playback._consented=!0),this.container.play()),!1}},{key:"shouldHideOnPlay",value:function(){return!this.container.playback.isAudioOnly}},{key:"update",value:function(){if(this.shouldRender){var t=!this.playRequested&&!this.hasStartedPlaying&&!this.container.buffering;this.updatePlayButton(t),this.updatePoster()}}},{key:"updatePoster",value:function(){this.hasStartedPlaying?this.hidePoster():this.showPoster()}},{key:"showPoster",value:function(){this.container.disableMediaControl(),this.$el.show()}},{key:"hidePoster",value:function(){this.container.enableMediaControl(),this.shouldHideOnPlay()&&this.$el.hide()}},{key:"render",value:function(){if(this.shouldRender){var t=ze.getStyleFor(Cf,{baseUrl:this.options.baseUrl});this.$el.html(this.template()),this.$el.append(t[0]);var f=this.options.poster&&this.options.poster.custom===void 0;if(f){var b=this.options.poster.url||this.options.poster;this.$el.css({"background-image":"url("+b+")"}),this.removeVideoElementPoster()}else this.options.poster&&(this.$el.css({background:this.options.poster.custom}),this.removeVideoElementPoster());this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(jt),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var D=this.options.mediacontrol&&this.options.mediacontrol.buttons;return D&&this.$el.find("svg path").css("fill",D),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(D=this.options.mediacontrol.buttons,this.$playButton.css("color",D)),this.update(),this}}},{key:"removeVideoElementPoster",value:function(){this.container.playback&&this.container.playback.$el&&this.container.playback.$el[0]&&this.container.playback.$el[0].removeAttribute&&this.container.playback.$el[0].removeAttribute("poster")}}]),i}(Zt),Pf=`<span data-seek-time></span>
<span data-duration></span>
`,Df=`.seek-time[data-seek-time] {
  position: absolute;
  white-space: nowrap;
  height: 20px;
  line-height: 20px;
  font-size: 0;
  left: -100%;
  bottom: 55px;
  background-color: rgba(2, 2, 2, 0.5);
  z-index: 9999;
  transition: opacity 0.1s ease; }
  .seek-time[data-seek-time].hidden[data-seek-time] {
    opacity: 0; }
  .seek-time[data-seek-time] [data-seek-time] {
    display: inline-block;
    color: white;
    font-size: 10px;
    padding-left: 7px;
    padding-right: 7px;
    vertical-align: top; }
  .seek-time[data-seek-time] [data-duration] {
    display: inline-block;
    color: rgba(255, 255, 255, 0.5);
    font-size: 10px;
    padding-right: 7px;
    vertical-align: top; }
    .seek-time[data-seek-time] [data-duration]:before {
      content: "|";
      margin-right: 7px; }
`,Oa=wt.formatTime,Of=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.hoveringOverSeekBar=!1,t.hoverPosition=null,t.duration=null,t.firstFragDateTime=null,t.actualLiveTime=!!t.mediaControl.options.actualLiveTime,t.actualLiveTime&&(t.mediaControl.options.actualLiveServerTime?t.actualLiveServerTimeDiff=new Date().getTime()-new Date(t.mediaControl.options.actualLiveServerTime).getTime():t.actualLiveServerTimeDiff=0),t}return Ze(i,[{key:"name",get:function(){return"seek_time"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return rt(Pf)}},{key:"attributes",get:function(){return{class:"seek-time","data-seek-time":""}}},{key:"mediaControl",get:function(){return this.core.mediaControl}},{key:"mediaControlContainer",get:function(){return this.mediaControl.container}},{key:"isLiveStreamWithDvr",get:function(){return this.mediaControlContainer&&this.mediaControlContainer.getPlaybackType()===pe.LIVE&&this.mediaControlContainer.isDvrEnabled()}},{key:"durationShown",get:function(){return this.isLiveStreamWithDvr&&!this.actualLiveTime}},{key:"useActualLiveTime",get:function(){return this.actualLiveTime&&this.isLiveStreamWithDvr}},{key:"bindEvents",value:function(){this.listenTo(this.mediaControl,G.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.showTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.hideTime),this.listenTo(this.mediaControl,G.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged),this.mediaControlContainer&&(this.listenTo(this.mediaControlContainer,G.CONTAINER_PLAYBACKDVRSTATECHANGED,this.update),this.listenTo(this.mediaControlContainer,G.CONTAINER_TIMEUPDATE,this.updateDuration))}},{key:"onContainerChanged",value:function(){this.stopListening(),this.bindEvents()}},{key:"updateDuration",value:function(t){this.duration=t.total,this.firstFragDateTime=t.firstFragDateTime,this.update()}},{key:"showTime",value:function(t){this.hoveringOverSeekBar=!0,this.calculateHoverPosition(t),this.update()}},{key:"hideTime",value:function(){this.hoveringOverSeekBar=!1,this.update()}},{key:"calculateHoverPosition",value:function(t){var f=t.pageX-this.mediaControl.$seekBarContainer.offset().left;this.hoverPosition=Math.min(1,Math.max(f/this.mediaControl.$seekBarContainer.width(),0))}},{key:"getSeekTime",value:function(){var t,f,b,D;return this.useActualLiveTime?(this.firstFragDateTime?(D=new Date(this.firstFragDateTime),b=new Date(this.firstFragDateTime),b.setHours(0,0,0,0),f=(D.getTime()-b.getTime())/1e3+this.duration):(b=new Date(new Date().getTime()-this.actualLiveServerTimeDiff),D=new Date(b),f=(D-b.setHours(0,0,0,0))/1e3),t=f-this.duration+this.hoverPosition*this.duration,t<0&&(t+=86400)):t=this.hoverPosition*this.duration,{seekTime:t,secondsSinceMidnight:f}}},{key:"update",value:function(){if(this.rendered)if(!this.shouldBeVisible())this.$el.hide(),this.$el.css("left","-100%");else{var t=this.getSeekTime(),f=Oa(t.seekTime,this.useActualLiveTime);if(f!==this.displayedSeekTime&&(this.$seekTimeEl.text(f),this.displayedSeekTime=f),this.durationShown){this.$durationEl.show();var b=Oa(this.actualLiveTime?t.secondsSinceMidnight:this.duration,this.actualLiveTime);b!==this.displayedDuration&&(this.$durationEl.text(b),this.displayedDuration=b)}else this.$durationEl.hide();this.$el.show();var D=this.mediaControl.$seekBarContainer.width(),m=this.$el.width(),N=this.hoverPosition*D;N-=m/2,N=Math.max(0,Math.min(N,D-m)),this.$el.css("left",N)}}},{key:"shouldBeVisible",value:function(){return this.mediaControlContainer&&this.mediaControlContainer.settings.seekEnabled&&this.hoveringOverSeekBar&&this.hoverPosition!==null&&this.duration!==null}},{key:"render",value:function(){var t=ze.getStyleFor(Df,{baseUrl:this.options.baseUrl});this.rendered=!0,this.displayedDuration=null,this.displayedSeekTime=null,this.$el.html(this.template()),this.$el.append(t[0]),this.$el.hide(),this.mediaControl.$el.append(this.el),this.$seekTimeEl=this.$el.find("[data-seek-time]"),this.$durationEl=this.$el.find("[data-duration]"),this.$durationEl.hide(),this.update()}}]),i}(yt),If=`<div data-bounce1></div><div data-bounce2></div><div data-bounce3></div>
`,Rf=`.spinner-three-bounce[data-spinner] {
  position: absolute;
  margin: 0 auto;
  width: 70px;
  text-align: center;
  z-index: 999;
  left: 0;
  right: 0;
  margin-left: auto;
  margin-right: auto;
  /* center vertically */
  top: 50%;
  transform: translateY(-50%); }
  .spinner-three-bounce[data-spinner] > div {
    width: 18px;
    height: 18px;
    background-color: #FFFFFF;
    border-radius: 100%;
    display: inline-block;
    animation: bouncedelay 1.4s infinite ease-in-out;
    /* Prevent first frame from flickering when animation starts */
    animation-fill-mode: both; }
  .spinner-three-bounce[data-spinner] [data-bounce1] {
    animation-delay: -0.32s; }
  .spinner-three-bounce[data-spinner] [data-bounce2] {
    animation-delay: -0.16s; }

@keyframes bouncedelay {
  0%, 80%, 100% {
    transform: scale(0); }
  40% {
    transform: scale(1); } }
`,Ia=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.template=rt(If),t.showTimeout=null,t.listenTo(t.container,G.CONTAINER_STATE_BUFFERING,t.onBuffering),t.listenTo(t.container,G.CONTAINER_STATE_BUFFERFULL,t.onBufferFull),t.listenTo(t.container,G.CONTAINER_STOP,t.onStop),t.listenTo(t.container,G.CONTAINER_ENDED,t.onStop),t.listenTo(t.container,G.CONTAINER_ERROR,t.onStop),t.render(),t}return Ze(i,[{key:"name",get:function(){return"spinner"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"attributes",get:function(){return{"data-spinner":"",class:"spinner-three-bounce"}}},{key:"onBuffering",value:function(){this.show()}},{key:"onBufferFull",value:function(){this.hide()}},{key:"onStop",value:function(){this.hide()}},{key:"show",value:function(){var t=this;this.showTimeout===null&&(this.showTimeout=setTimeout(function(){return t.$el.show()},300))}},{key:"hide",value:function(){this.showTimeout!==null&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.$el.hide()}},{key:"render",value:function(){var t=ze.getStyleFor(Rf,{baseUrl:this.options.baseUrl});return this.$el.html(this.template()),this.$el.append(t[0]),this.container.$el.append(this.$el),this.$el.hide(),this.container.buffering&&this.onBuffering(),this}}]),i}(Zt),Ra=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.setInitialAttrs(),t.reportInterval=t.options.reportInterval||5e3,t.state="IDLE",t}return Ze(i,[{key:"name",get:function(){return"stats"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"bindEvents",value:function(){this.listenTo(this.container.playback,G.PLAYBACK_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_ENDED,this.onStop),this.listenTo(this.container,G.CONTAINER_DESTROYED,this.onStop),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERING,this.onBuffering),this.listenTo(this.container,G.CONTAINER_STATE_BUFFERFULL,this.onBufferFull),this.listenTo(this.container,G.CONTAINER_STATS_ADD,this.onStatsAdd),this.listenTo(this.container,G.CONTAINER_BITRATE,this.onStatsAdd),this.listenTo(this.container.playback,G.PLAYBACK_STATS_ADD,this.onStatsAdd)}},{key:"setInitialAttrs",value:function(){this.firstPlay=!0,this.startupTime=0,this.rebufferingTime=0,this.watchingTime=0,this.rebuffers=0,this.externalMetrics={}}},{key:"onPlay",value:function(){this.state="PLAYING",this.watchingTimeInit=Date.now(),this.intervalId||(this.intervalId=setInterval(this.report.bind(this),this.reportInterval))}},{key:"onStop",value:function(){clearInterval(this.intervalId),this.report(),this.intervalId=void 0,this.state="STOPPED"}},{key:"onBuffering",value:function(){this.firstPlay?this.startupTimeInit=Date.now():this.rebufferingTimeInit=Date.now(),this.state="BUFFERING",this.rebuffers++}},{key:"onBufferFull",value:function(){this.firstPlay&&this.startupTimeInit?(this.firstPlay=!1,this.startupTime=Date.now()-this.startupTimeInit,this.watchingTimeInit=Date.now()):this.rebufferingTimeInit&&(this.rebufferingTime+=this.getRebufferingTime()),this.rebufferingTimeInit=void 0,this.state="PLAYING"}},{key:"getRebufferingTime",value:function(){return Date.now()-this.rebufferingTimeInit}},{key:"getWatchingTime",value:function(){var t=Date.now()-this.watchingTimeInit;return t-this.rebufferingTime}},{key:"isRebuffering",value:function(){return!!this.rebufferingTimeInit}},{key:"onStatsAdd",value:function(t){ve.extend(this.externalMetrics,t)}},{key:"getStats",value:function(){var t={startupTime:this.startupTime,rebuffers:this.rebuffers,rebufferingTime:this.isRebuffering()?this.rebufferingTime+this.getRebufferingTime():this.rebufferingTime,watchingTime:this.isRebuffering()?this.getWatchingTime()-this.getRebufferingTime():this.getWatchingTime()};return ve.extend(t,this.externalMetrics),t}},{key:"report",value:function(){this.container.statsReport(this.getStats())}}]),i}(Qt),kf=`<div class="clappr-watermark" data-watermark data-watermark-<%=position %>>
<% if(typeof imageLink !== 'undefined') { %>
<a target="_blank" href="<%= imageLink %>">
<% } %>
<img src="<%= imageUrl %>">
<% if(typeof imageLink !== 'undefined') { %>
</a>
<% } %>
</div>
`,Mf=`.clappr-watermark[data-watermark] {
  position: absolute;
  min-width: 70px;
  max-width: 200px;
  width: 12%;
  text-align: center;
  z-index: 10; }

.clappr-watermark[data-watermark] a {
  outline: none;
  cursor: pointer; }

.clappr-watermark[data-watermark] img {
  max-width: 100%; }

.clappr-watermark[data-watermark-bottom-left] {
  bottom: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-bottom-right] {
  bottom: 10px;
  right: 42px; }

.clappr-watermark[data-watermark-top-left] {
  top: 10px;
  left: 10px; }

.clappr-watermark[data-watermark-top-right] {
  top: 10px;
  right: 37px; }
`,ka=function(e){Je(i,e);var n=qe(i);function i(r){var t;return Qe(this,i),t=n.call(this,r),t.configure(),t}return Ze(i,[{key:"name",get:function(){return"watermark"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"template",get:function(){return rt(kf)}},{key:"bindEvents",value:function(){this.listenTo(this.container,G.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,G.CONTAINER_STOP,this.onStop),this.listenTo(this.container,G.CONTAINER_OPTIONS_CHANGE,this.configure)}},{key:"configure",value:function(){this.position=this.options.position||"bottom-right",this.options.watermark?(this.imageUrl=this.options.watermark,this.imageLink=this.options.watermarkLink,this.render()):this.$el.remove()}},{key:"onPlay",value:function(){this.hidden||this.$el.show()}},{key:"onStop",value:function(){this.$el.hide()}},{key:"render",value:function(){this.$el.hide();var t=ze.getStyleFor(Mf,{baseUrl:this.options.baseUrl}),f={position:this.position,imageUrl:this.imageUrl,imageLink:this.imageLink};return this.$el.html(this.template(f)),this.$el.append(t[0]),this.container.$el.append(this.$el),this}}]),i}(Zt);function Ma(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function Un(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Ma(Object(i),!0).forEach(function(r){Ff(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ma(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function wf(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function wa(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qs(r.key),r)}}function Nf(e,n,i){return n&&wa(e.prototype,n),i&&wa(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ff(e,n,i){return n=Qs(n),n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Bf(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&ai(e,n)}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},gt(e)}function ai(e,n){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},ai(e,n)}function Uf(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kf(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wf(e,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kf(e)}function Vf(e){var n=Uf();return function(){var r=gt(e),t;if(n){var f=gt(this).constructor;t=Reflect.construct(r,arguments,f)}else t=r.apply(this,arguments);return Wf(this,t)}}function Gf(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=gt(e),e!==null););return e}function Pt(){return typeof Reflect<"u"&&Reflect.get?Pt=Reflect.get.bind():Pt=function(n,i,r){var t=Gf(n,i);if(t){var f=Object.getOwnPropertyDescriptor(t,i);return f.get?f.get.call(arguments.length<3?n:r):f.value}},Pt.apply(this,arguments)}function Hf(e){return jf(e)||Yf(e)||$f(e)||zf()}function jf(e){if(Array.isArray(e))return si(e)}function Yf(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $f(e,n){if(e){if(typeof e=="string")return si(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return si(e,n)}}function si(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=e[i];return r}function zf(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xf(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Qs(e){var n=Xf(e,"string");return typeof n=="symbol"?n:String(n)}var Qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zs={exports:{}};(function(e,n){typeof window<"u"&&function(r,t){e.exports=t()}(Qf,()=>(()=>{var i={"./src/config.ts":(b,D,m)=>{m.r(D),m.d(D,{enableStreamingMode:()=>_,hlsDefaultConfig:()=>s,mergeConfig:()=>p});var N=m("./src/controller/abr-controller.ts"),x=m("./src/controller/audio-stream-controller.ts"),F=m("./src/controller/audio-track-controller.ts"),M=m("./src/controller/subtitle-stream-controller.ts"),K=m("./src/controller/subtitle-track-controller.ts"),w=m("./src/controller/buffer-controller.ts"),I=m("./src/controller/timeline-controller.ts"),k=m("./src/controller/cap-level-controller.ts"),S=m("./src/controller/fps-controller.ts"),L=m("./src/controller/eme-controller.ts"),R=m("./src/controller/cmcd-controller.ts"),O=m("./src/utils/xhr-loader.ts"),C=m("./src/utils/fetch-loader.ts"),y=m("./src/utils/cues.ts"),u=m("./src/utils/mediakeys-helper.ts"),l=m("./src/utils/logger.ts");function c(){return c=Object.assign?Object.assign.bind():function(v){for(var A=1;A<arguments.length;A++){var E=arguments[A];for(var g in E)Object.prototype.hasOwnProperty.call(E,g)&&(v[g]=E[g])}return v},c.apply(this,arguments)}function d(v,A){var E=Object.keys(v);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(v);A&&(g=g.filter(function(T){return Object.getOwnPropertyDescriptor(v,T).enumerable})),E.push.apply(E,g)}return E}function o(v){for(var A=1;A<arguments.length;A++){var E=arguments[A]!=null?arguments[A]:{};A%2?d(Object(E),!0).forEach(function(g){a(v,g,E[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(E)):d(Object(E)).forEach(function(g){Object.defineProperty(v,g,Object.getOwnPropertyDescriptor(E,g))})}return v}function a(v,A,E){return A in v?Object.defineProperty(v,A,{value:E,enumerable:!0,configurable:!0,writable:!0}):v[A]=E,v}var s=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:O.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:N.default,bufferController:w.default,capLevelController:k.default,fpsController:S.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:u.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},h()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:K.default,timelineController:I.TimelineController,audioStreamController:x.default,audioTrackController:F.default,emeController:L.default,cmcdController:R.default});function h(){return{cueHandler:y.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function p(v,A){if((A.liveSyncDurationCount||A.liveMaxLatencyDurationCount)&&(A.liveSyncDuration||A.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(A.liveMaxLatencyDurationCount!==void 0&&(A.liveSyncDurationCount===void 0||A.liveMaxLatencyDurationCount<=A.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(A.liveMaxLatencyDuration!==void 0&&(A.liveSyncDuration===void 0||A.liveMaxLatencyDuration<=A.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return c({},v,A)}function _(v){var A=v.loader;if(A!==C.default&&A!==O.default)l.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),v.progressive=!1;else{var E=(0,C.fetchSupported)();E&&(v.loader=C.default,v.progressive=!0,v.enableSoftwareAES=!0,l.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>L});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/ewma-bandwidth-estimator.ts"),F=m("./src/events.ts"),M=m("./src/errors.ts"),K=m("./src/types/loader.ts"),w=m("./src/utils/logger.ts");function I(R,O){for(var C=0;C<O.length;C++){var y=O[C];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}function k(R,O,C){return O&&I(R.prototype,O),C&&I(R,C),Object.defineProperty(R,"prototype",{writable:!1}),R}var S=function(){function R(C){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=C;var y=C.config;this.bwEstimator=new x.default(y.abrEwmaSlowVoD,y.abrEwmaFastVoD,y.abrEwmaDefaultEstimate),this.registerListeners()}var O=R.prototype;return O.registerListeners=function(){var y=this.hls;y.on(F.Events.FRAG_LOADING,this.onFragLoading,this),y.on(F.Events.FRAG_LOADED,this.onFragLoaded,this),y.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.on(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.on(F.Events.ERROR,this.onError,this)},O.unregisterListeners=function(){var y=this.hls;y.off(F.Events.FRAG_LOADING,this.onFragLoading,this),y.off(F.Events.FRAG_LOADED,this.onFragLoaded,this),y.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.off(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),y.off(F.Events.ERROR,this.onError,this)},O.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},O.onFragLoading=function(y,u){var l=u.frag;if(l.type===K.PlaylistLevelType.MAIN&&!this.timer){var c;this.fragCurrent=l,this.partCurrent=(c=u.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)}},O.onLevelLoaded=function(y,u){var l=this.hls.config;u.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},O._abandonRulesCheck=function(){var y=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.autoLevelEnabled;l.config;var d=l.media;if(!(!y||!d)){var o=u?u.stats:y.stats,a=u?u.duration:y.duration;if(o.aborted||o.loaded&&o.loaded===o.total||y.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!c||d.paused||!d.playbackRate||!d.readyState)){var s=l.mainForwardBufferInfo;if(s!==null){var h=performance.now()-o.loading.start,p=Math.abs(d.playbackRate);if(!(h<=500*a/p)){var _=o.loaded&&o.loading.first,v=this.bwEstimator.getEstimate(),A=l.levels,E=l.minAutoLevel,g=A[y.level],T=o.total||Math.max(o.loaded,Math.round(a*g.maxBitrate/8)),P=_?o.loaded*1e3/h:0,B=P?(T-o.loaded)/P:T*8/v,V=s.len/p;if(!(B<=V)){var W=Number.POSITIVE_INFINITY,j;for(j=y.level-1;j>E;j--){var z=A[j].maxBitrate;if(W=P?a*z/(8*.8*P):a*z/v,W<V)break}W>=B||(w.logger.warn("Fragment "+y.sn+(u?" part "+u.index:"")+" of level "+y.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+j+`
      Current BW estimate: `+((0,N.isFiniteNumber)(v)?(v/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+B.toFixed(3)+` s
      Estimated load time for the next fragment: `+W.toFixed(3)+` s
      Time to underbuffer: `+V.toFixed(3)+" s"),l.nextLoadLevel=j,_&&this.bwEstimator.sample(h,o.loaded),this.clearTimer(),y.loader&&(this.fragCurrent=this.partCurrent=null,y.loader.abort()),l.trigger(F.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:y,part:u,stats:o}))}}}}}},O.onFragLoaded=function(y,u){var l=u.frag,c=u.part;if(l.type===K.PlaylistLevelType.MAIN&&(0,N.isFiniteNumber)(l.sn)){var d=c?c.stats:l.stats,o=c?c.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[l.level],s=(a.loaded?a.loaded.bytes:0)+d.loaded,h=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:s,duration:h},a.realBitrate=Math.round(8*s/h)}if(l.bitrateTest){var p={stats:d,frag:l,part:c,id:l.type};this.onFragBuffered(F.Events.FRAG_BUFFERED,p)}}},O.onFragBuffered=function(y,u){var l=u.frag,c=u.part,d=c?c.stats:l.stats;if(!d.aborted&&!(l.type!==K.PlaylistLevelType.MAIN||l.sn==="initSegment")){var o=d.parsing.end-d.loading.start;this.bwEstimator.sample(o,d.loaded),d.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},O.onError=function(y,u){switch(u.details){case M.ErrorDetails.FRAG_LOAD_ERROR:case M.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},O.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},O.getNextABRAutoLevel=function(){var y=this.fragCurrent,u=this.partCurrent,l=this.hls,c=l.maxAutoLevel,d=l.config,o=l.minAutoLevel,a=l.media,s=u?u.duration:y?y.duration:0;a&&a.currentTime;var h=a&&a.playbackRate!==0?Math.abs(a.playbackRate):1,p=this.bwEstimator?this.bwEstimator.getEstimate():d.abrEwmaDefaultEstimate,_=l.mainForwardBufferInfo,v=(_?_.len:0)/h,A=this.findBestLevel(p,o,c,v,d.abrBandWidthFactor,d.abrBandWidthUpFactor);if(A>=0)return A;w.logger.trace((v?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var E=s?Math.min(s,d.maxStarvationDelay):d.maxStarvationDelay,g=d.abrBandWidthFactor,T=d.abrBandWidthUpFactor;if(!v){var P=this.bitrateTestDelay;if(P){var B=s?Math.min(s,d.maxLoadingDelay):d.maxLoadingDelay;E=B-P,w.logger.trace("bitrate test took "+Math.round(1e3*P)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*E)+" ms"),g=T=1}}return A=this.findBestLevel(p,o,c,v+E,g,T),Math.max(A,0)},O.findBestLevel=function(y,u,l,c,d,o){for(var a,s=this.fragCurrent,h=this.partCurrent,p=this.lastLoadedFragLevel,_=this.hls.levels,v=_[p],A=!!(v!=null&&(a=v.details)!==null&&a!==void 0&&a.live),E=v==null?void 0:v.codecSet,g=h?h.duration:s?s.duration:0,T=l;T>=u;T--){var P=_[T];if(!(!P||E&&P.codecSet!==E)){var B=P.details,V=(h?B==null?void 0:B.partTarget:B==null?void 0:B.averagetargetduration)||g,W=void 0;T<=p?W=d*y:W=o*y;var j=_[T].maxBitrate,z=j*V/W;if(w.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+T+"/"+Math.round(W)+"/"+j+"/"+V+"/"+c+"/"+z),W>j&&(z===0||!(0,N.isFiniteNumber)(z)||A&&!this.bitrateTestDelay||z<c))return T}}return-1},k(R,[{key:"nextAutoLevel",get:function(){var y=this._nextAutoLevel,u=this.bwEstimator;if(y!==-1&&!u.canEstimate())return y;var l=this.getNextABRAutoLevel();return y!==-1&&this.hls.levels[l].loadError?y:(y!==-1&&(l=Math.min(y,l)),l)},set:function(y){this._nextAutoLevel=y}}]),R}();const L=S},"./src/controller/audio-stream-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>a});var N=m("./src/polyfills/number.ts"),x=m("./src/controller/base-stream-controller.ts"),F=m("./src/events.ts"),M=m("./src/utils/buffer-helper.ts"),K=m("./src/controller/fragment-tracker.ts"),w=m("./src/types/level.ts"),I=m("./src/types/loader.ts"),k=m("./src/loader/fragment.ts"),S=m("./src/demux/chunk-cache.ts"),L=m("./src/demux/transmuxer-interface.ts"),R=m("./src/types/transmuxer.ts"),O=m("./src/controller/fragment-finders.ts"),C=m("./src/utils/discontinuities.ts"),y=m("./src/errors.ts");function u(){return u=Object.assign?Object.assign.bind():function(s){for(var h=1;h<arguments.length;h++){var p=arguments[h];for(var _ in p)Object.prototype.hasOwnProperty.call(p,_)&&(s[_]=p[_])}return s},u.apply(this,arguments)}function l(s,h){s.prototype=Object.create(h.prototype),s.prototype.constructor=s,c(s,h)}function c(s,h){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,v){return _.__proto__=v,_},c(s,h)}var d=100,o=function(s){l(h,s);function h(_,v){var A;return A=s.call(this,_,v,"[audio-stream-controller]")||this,A.videoBuffer=null,A.videoTrackCC=-1,A.waitingVideoCC=-1,A.audioSwitch=!1,A.trackId=-1,A.waitingData=null,A.mainDetails=null,A.bufferFlushed=!1,A.cachedTrackLoadedData=null,A._registerListeners(),A}var p=h.prototype;return p.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},p._registerListeners=function(){var v=this.hls;v.on(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.on(F.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),v.on(F.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),v.on(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),v.on(F.Events.ERROR,this.onError,this),v.on(F.Events.BUFFER_RESET,this.onBufferReset,this),v.on(F.Events.BUFFER_CREATED,this.onBufferCreated,this),v.on(F.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),v.on(F.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),v.on(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},p._unregisterListeners=function(){var v=this.hls;v.off(F.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(F.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(F.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(F.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.off(F.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),v.off(F.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),v.off(F.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),v.off(F.Events.ERROR,this.onError,this),v.off(F.Events.BUFFER_RESET,this.onBufferReset,this),v.off(F.Events.BUFFER_CREATED,this.onBufferCreated,this),v.off(F.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),v.off(F.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),v.off(F.Events.FRAG_BUFFERED,this.onFragBuffered,this)},p.onInitPtsFound=function(v,A){var E=A.frag,g=A.id,T=A.initPTS;if(g==="main"){var P=E.cc;this.initPTS[E.cc]=T,this.log("InitPTS for cc: "+P+" found from main: "+T),this.videoTrackCC=P,this.state===x.State.WAITING_INIT_PTS&&this.tick()}},p.startLoad=function(v){if(!this.levels){this.startPosition=v,this.state=x.State.STOPPED;return}var A=this.lastCurrentTime;this.stopLoad(),this.setInterval(d),this.fragLoadError=0,A>0&&v===-1?(this.log("Override startPosition with lastCurrentTime @"+A.toFixed(3)),v=A,this.state=x.State.IDLE):(this.loadedmetadata=!1,this.state=x.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=v,this.tick()},p.doTick=function(){switch(this.state){case x.State.IDLE:this.doTickIdle();break;case x.State.WAITING_TRACK:{var v,A=this.levels,E=this.trackId,g=A==null||(v=A[E])===null||v===void 0?void 0:v.details;if(g){if(this.waitForCdnTuneIn(g))break;this.state=x.State.WAITING_INIT_PTS}break}case x.State.FRAG_LOADING_WAITING_RETRY:{var T,P=performance.now(),B=this.retryDate;(!B||P>=B||(T=this.media)!==null&&T!==void 0&&T.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=x.State.IDLE);break}case x.State.WAITING_INIT_PTS:{var V=this.waitingData;if(V){var W=V.frag,j=V.part,z=V.cache,Q=V.complete;if(this.initPTS[W.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=x.State.FRAG_LOADING;var Z=z.flush(),ee={frag:W,part:j,payload:Z,networkDetails:null};this._handleFragmentLoadProgress(ee),Q&&s.prototype._handleFragmentLoadComplete.call(this,ee)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+W.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var ae=this.getLoadPosition(),se=M.BufferHelper.bufferInfo(this.mediaBuffer,ae,this.config.maxBufferHole),Y=(0,O.fragmentWithinToleranceTest)(se.end,this.config.maxFragLookUpTolerance,W);Y<0&&(this.log("Waiting fragment cc ("+W.cc+") @ "+W.start+" cancelled because another fragment at "+se.end+" is needed"),this.clearWaitingFragment())}}else this.state=x.State.IDLE}}this.onTickEnd()},p.clearWaitingFragment=function(){var v=this.waitingData;v&&(this.fragmentTracker.removeFragment(v.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=x.State.IDLE)},p.resetLoadingState=function(){this.clearWaitingFragment(),s.prototype.resetLoadingState.call(this)},p.onTickEnd=function(){var v=this.media;!v||!v.readyState||(this.lastCurrentTime=v.currentTime)},p.doTickIdle=function(){var v,A,E=this.hls,g=this.levels,T=this.media,P=this.trackId,B=E.config;if(!(!g||!g[P])&&!(!T&&(this.startFragRequested||!B.startFragPrefetch))){var V=g[P],W=V.details;if(!W||W.live&&this.levelLastLoaded!==P||this.waitForCdnTuneIn(W)){this.state=x.State.WAITING_TRACK;return}var j=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&j&&(this.bufferFlushed=!1,this.afterBufferFlushed(j,k.ElementaryStreamTypes.AUDIO,I.PlaylistLevelType.AUDIO));var z=this.getFwdBufferInfo(j,I.PlaylistLevelType.AUDIO);if(z!==null){var Q=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,I.PlaylistLevelType.MAIN),Z=z.len,ee=this.getMaxBufferLength(Q==null?void 0:Q.len),ae=this.audioSwitch;if(!(Z>=ee&&!ae)){if(!ae&&this._streamEnded(z,W)){E.trigger(F.Events.BUFFER_EOS,{type:"audio"}),this.state=x.State.ENDED;return}var se=W.fragments,Y=se[0].start,X=z.end;if(ae&&T){var q=this.getLoadPosition();X=q,W.PTSKnown&&q<Y&&(z.end>Y||z.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),T.currentTime=Y+.05)}if(!(Q&&X>Q.end+W.targetduration)&&!((!Q||!Q.len)&&z.len)){var re=this.getNextFragment(X,W);if(!re){this.bufferFlushed=!0;return}((v=re.decryptdata)===null||v===void 0?void 0:v.keyFormat)==="identity"&&!((A=re.decryptdata)!==null&&A!==void 0&&A.key)?this.loadKey(re,W):this.loadFragment(re,W,X)}}}}},p.getMaxBufferLength=function(v){var A=s.prototype.getMaxBufferLength.call(this);return v?Math.max(A,v):A},p.onMediaDetaching=function(){this.videoBuffer=null,s.prototype.onMediaDetaching.call(this)},p.onAudioTracksUpdated=function(v,A){var E=A.audioTracks;this.resetTransmuxer(),this.levels=E.map(function(g){return new w.Level(g)})},p.onAudioTrackSwitching=function(v,A){var E=!!A.url;this.trackId=A.id;var g=this.fragCurrent;g!=null&&g.loader&&g.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),E?this.setInterval(d):this.resetTransmuxer(),E?(this.audioSwitch=!0,this.state=x.State.IDLE):this.state=x.State.STOPPED,this.tick()},p.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},p.onLevelLoaded=function(v,A){this.mainDetails=A.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(F.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},p.onAudioTrackLoaded=function(v,A){var E;if(this.mainDetails==null){this.cachedTrackLoadedData=A;return}var g=this.levels,T=A.details,P=A.id;if(!g){this.warn("Audio tracks were reset while loading level "+P);return}this.log("Track "+P+" loaded ["+T.startSN+","+T.endSN+"],duration:"+T.totalduration);var B=g[P],V=0;if(T.live||(E=B.details)!==null&&E!==void 0&&E.live){var W=this.mainDetails;if(T.fragments[0]||(T.deltaUpdateFailed=!0),T.deltaUpdateFailed||!W)return;!B.details&&T.hasProgramDateTime&&W.hasProgramDateTime?((0,C.alignMediaPlaylistByPDT)(T,W),V=T.fragments[0].start):V=this.alignPlaylists(T,B.details)}B.details=T,this.levelLastLoaded=P,!this.startFragRequested&&(this.mainDetails||!T.live)&&this.setStartPosition(B.details,V),this.state===x.State.WAITING_TRACK&&!this.waitForCdnTuneIn(T)&&(this.state=x.State.IDLE),this.tick()},p._handleFragmentLoadProgress=function(v){var A,E=v.frag,g=v.part,T=v.payload,P=this.config,B=this.trackId,V=this.levels;if(!V){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+E.sn+" of level "+E.level+" will not be buffered");return}var W=V[B];console.assert(W,"Audio track is defined on fragment load progress");var j=W.details;console.assert(j,"Audio track details are defined on fragment load progress");var z=P.defaultAudioCodec||W.audioCodec||"mp4a.40.2",Q=this.transmuxer;Q||(Q=this.transmuxer=new L.default(this.hls,I.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var Z=this.initPTS[E.cc],ee=(A=E.initSegment)===null||A===void 0?void 0:A.data;if(Z!==void 0){var ae=!1,se=g?g.index:-1,Y=se!==-1,X=new R.ChunkMetadata(E.level,E.sn,E.stats.chunkCount,T.byteLength,se,Y);Q.push(T,ee,z,"",E,g,j.totalduration,ae,X,Z)}else{this.log("Unknown video PTS for cc "+E.cc+", waiting for video PTS before demuxing audio frag "+E.sn+" of ["+j.startSN+" ,"+j.endSN+"],track "+B);var q=this.waitingData=this.waitingData||{frag:E,part:g,cache:new S.default,complete:!1},re=q.cache;re.push(new Uint8Array(T)),this.waitingVideoCC=this.videoTrackCC,this.state=x.State.WAITING_INIT_PTS}},p._handleFragmentLoadComplete=function(v){if(this.waitingData){this.waitingData.complete=!0;return}s.prototype._handleFragmentLoadComplete.call(this,v)},p.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},p.onBufferCreated=function(v,A){var E=A.tracks.audio;E&&(this.mediaBuffer=E.buffer||null),A.tracks.video&&(this.videoBuffer=A.tracks.video.buffer||null)},p.onFragBuffered=function(v,A){var E=A.frag,g=A.part;if(E.type!==I.PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&E.type===I.PlaylistLevelType.MAIN){var T;(T=this.videoBuffer||this.media)!==null&&T!==void 0&&T.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(E)){this.warn("Fragment "+E.sn+(g?" p: "+g.index:"")+" of level "+E.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}E.sn!=="initSegment"&&(this.fragPrevious=E,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(F.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(E,g)},p.onError=function(v,A){switch(A.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.AUDIO,A);break;case y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case y.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==x.State.ERROR&&this.state!==x.State.STOPPED&&(this.state=A.fatal?x.State.ERROR:x.State.IDLE,this.warn(A.details+" while loading frag, switching to "+this.state+" state"));break;case y.ErrorDetails.BUFFER_FULL_ERROR:if(A.parent==="audio"&&(this.state===x.State.PARSING||this.state===x.State.PARSED)){var E=!0,g=this.getFwdBufferInfo(this.mediaBuffer,I.PlaylistLevelType.AUDIO);g&&g.len>.5&&(E=!this.reduceMaxBufferLength(g.len)),E&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},p.onBufferFlushed=function(v,A){var E=A.type;E===k.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},p._handleTransmuxComplete=function(v){var A,E="audio",g=this.hls,T=v.remuxResult,P=v.chunkMeta,B=this.getCurrentContext(P);if(!B){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(P.level);return}var V=B.frag,W=B.part,j=B.level.details,z=T.audio,Q=T.text,Z=T.id3,ee=T.initSegment;if(!(this.fragContextChanged(V)||!j)){if(this.state=x.State.PARSING,this.audioSwitch&&z&&this.completeAudioSwitch(),ee!=null&&ee.tracks&&(this._bufferInitSegment(ee.tracks,V,P),g.trigger(F.Events.FRAG_PARSING_INIT_SEGMENT,{frag:V,id:E,tracks:ee.tracks})),z){var ae=z.startPTS,se=z.endPTS,Y=z.startDTS,X=z.endDTS;W&&(W.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:ae,endPTS:se,startDTS:Y,endDTS:X}),V.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,ae,se,Y,X),this.bufferFragmentData(z,V,W,P)}if(Z!=null&&(A=Z.samples)!==null&&A!==void 0&&A.length){var q=u({id:E,frag:V,details:j},Z);g.trigger(F.Events.FRAG_PARSING_METADATA,q)}if(Q){var re=u({id:E,frag:V,details:j},Q);g.trigger(F.Events.FRAG_PARSING_USERDATA,re)}}},p._bufferInitSegment=function(v,A,E){if(this.state===x.State.PARSING){v.video&&delete v.video;var g=v.audio;if(g){g.levelCodec=g.codec,g.id="audio",this.log("Init audio buffer, container:"+g.container+", codecs[parsed]=["+g.codec+"]"),this.hls.trigger(F.Events.BUFFER_CODECS,v);var T=g.initSegment;if(T!=null&&T.byteLength){var P={type:"audio",frag:A,part:null,chunkMeta:E,parent:A.type,data:T};this.hls.trigger(F.Events.BUFFER_APPENDING,P)}this.tick()}}},p.loadFragment=function(v,A,E){var g=this.fragmentTracker.getState(v);this.fragCurrent=v,(this.audioSwitch||g===K.FragmentState.NOT_LOADED||g===K.FragmentState.PARTIAL)&&(v.sn==="initSegment"?this._loadInitSegment(v):A.live&&!(0,N.isFiniteNumber)(this.initPTS[v.cc])?(this.log("Waiting for video PTS in continuity counter "+v.cc+" of live stream before loading audio fragment "+v.sn+" of level "+this.trackId),this.state=x.State.WAITING_INIT_PTS):(this.startFragRequested=!0,s.prototype.loadFragment.call(this,v,A,E)))},p.completeAudioSwitch=function(){var v=this.hls,A=this.media,E=this.trackId;A&&(this.log("Switching audio track : flushing all audio"),s.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,v.trigger(F.Events.AUDIO_TRACK_SWITCHED,{id:E})},h}(x.default);const a=o},"./src/controller/audio-track-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>L});var N=m("./src/events.ts"),x=m("./src/errors.ts"),F=m("./src/controller/base-playlist-controller.ts"),M=m("./src/types/loader.ts");function K(R,O){for(var C=0;C<O.length;C++){var y=O[C];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}function w(R,O,C){return O&&K(R.prototype,O),C&&K(R,C),Object.defineProperty(R,"prototype",{writable:!1}),R}function I(R,O){R.prototype=Object.create(O.prototype),R.prototype.constructor=R,k(R,O)}function k(R,O){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,u){return y.__proto__=u,y},k(R,O)}var S=function(R){I(O,R);function O(y){var u;return u=R.call(this,y,"[audio-track-controller]")||this,u.tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.trackName="",u.selectDefaultTrack=!0,u.registerListeners(),u}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(N.Events.LEVEL_LOADING,this.onLevelLoading,this),u.on(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.on(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.on(N.Events.ERROR,this.onError,this)},C.unregisterListeners=function(){var u=this.hls;u.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(N.Events.LEVEL_LOADING,this.onLevelLoading,this),u.off(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),u.off(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),u.off(N.Events.ERROR,this.onError,this)},C.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,R.prototype.destroy.call(this)},C.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},C.onManifestParsed=function(u,l){this.tracks=l.audioTracks||[]},C.onAudioTrackLoaded=function(u,l){var c=l.id,d=l.details,o=this.tracksInGroup[c];if(!o){this.warn("Invalid audio track id "+c);return}var a=o.details;o.details=l.details,this.log("audioTrack "+c+" loaded ["+d.startSN+"-"+d.endSN+"]"),c===this.trackId&&(this.retryCount=0,this.playlistLoaded(c,l,a))},C.onLevelLoading=function(u,l){this.switchLevel(l.level)},C.onLevelSwitching=function(u,l){this.switchLevel(l.level)},C.switchLevel=function(u){var l=this.hls.levels[u];if(l!=null&&l.audioGroupIds){var c=l.audioGroupIds[l.urlId];if(this.groupId!==c){this.groupId=c;var d=this.tracks.filter(function(a){return!c||a.groupId===c});this.selectDefaultTrack&&!d.some(function(a){return a.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=d;var o={audioTracks:d};this.log("Updating audio tracks, "+d.length+' track(s) found in "'+c+'" group-id'),this.hls.trigger(N.Events.AUDIO_TRACKS_UPDATED,o),this.selectInitialTrack()}}},C.onError=function(u,l){R.prototype.onError.call(this,u,l),!(l.fatal||!l.context)&&l.context.type===M.PlaylistContextType.AUDIO_TRACK&&l.context.id===this.trackId&&l.context.groupId===this.groupId&&this.retryLoadingOrFail(l)},C.setAudioTrack=function(u){var l=this.tracksInGroup;if(u<0||u>=l.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var c=l[this.trackId];this.log("Now switching to audio-track index "+u);var d=l[u],o=d.id,a=d.groupId,s=a===void 0?"":a,h=d.name,p=d.type,_=d.url;if(this.trackId=u,this.trackName=h,this.selectDefaultTrack=!1,this.hls.trigger(N.Events.AUDIO_TRACK_SWITCHING,{id:o,groupId:s,name:h,type:p,url:_}),!(d.details&&!d.details.live)){var v=this.switchParams(d.url,c==null?void 0:c.details);this.loadPlaylist(v)}},C.selectInitialTrack=function(){var u=this.tracksInGroup;console.assert(u.length,"Initial audio track should be selected when tracks are known");var l=this.trackName,c=this.findTrackId(l)||this.findTrackId();c!==-1?this.setAudioTrack(c):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},C.findTrackId=function(u){for(var l=this.tracksInGroup,c=0;c<l.length;c++){var d=l[c];if((!this.selectDefaultTrack||d.default)&&(!u||u===d.name))return d.id}return-1},C.loadPlaylist=function(u){var l=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(l)){var c=l.id,d=l.groupId,o=l.url;if(u)try{o=u.addDirectives(o)}catch(a){this.warn("Could not construct new URL with HLS Delivery Directives: "+a)}this.log("loading audio-track playlist for id: "+c),this.clearTimer(),this.hls.trigger(N.Events.AUDIO_TRACK_LOADING,{url:o,id:c,groupId:d,deliveryDirectives:u||null})}},w(O,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(u){this.selectDefaultTrack=!1,this.setAudioTrack(u)}}]),O}(F.default);const L=S},"./src/controller/base-playlist-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>w});var N=m("./src/polyfills/number.ts"),x=m("./src/types/level.ts"),F=m("./src/controller/level-helper.ts"),M=m("./src/utils/logger.ts"),K=m("./src/errors.ts"),w=function(){function I(S,L){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,L+":"),this.warn=M.logger.warn.bind(M.logger,L+":"),this.hls=S}var k=I.prototype;return k.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},k.onError=function(L,R){R.fatal&&R.type===K.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},k.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},k.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},k.stopLoad=function(){this.canLoad=!1,this.clearTimer()},k.switchParams=function(L,R){var O=R==null?void 0:R.renditionReports;if(O)for(var C=0;C<O.length;C++){var y=O[C],u=""+y.URI;if(u===L.slice(-u.length)){var l=parseInt(y["LAST-MSN"]),c=parseInt(y["LAST-PART"]);if(R&&this.hls.config.lowLatencyMode){var d=Math.min(R.age-R.partTarget,R.targetduration);c!==void 0&&d>R.partTarget&&(c+=1)}if((0,N.isFiniteNumber)(l))return new x.HlsUrlParameters(l,(0,N.isFiniteNumber)(c)?c:void 0,x.HlsSkip.No)}}},k.loadPlaylist=function(L){},k.shouldLoadTrack=function(L){return this.canLoad&&L&&!!L.url&&(!L.details||L.details.live)},k.playlistLoaded=function(L,R,O){var C=this,y=R.details,u=R.stats,l=u.loading.end?Math.max(0,self.performance.now()-u.loading.end):0;if(y.advancedDateTime=Date.now()-l,y.live||O!=null&&O.live){if(y.reloaded(O),O&&this.log("live playlist "+L+" "+(y.advanced?"REFRESHED "+y.lastPartSn+"-"+y.lastPartIndex:"MISSED")),O&&y.fragments.length>0&&(0,F.mergeDetails)(O,y),!this.canLoad||!y.live)return;var c,d=void 0,o=void 0;if(y.canBlockReload&&y.endSN&&y.advanced){var a=this.hls.config.lowLatencyMode,s=y.lastPartSn,h=y.endSN,p=y.lastPartIndex,_=p!==-1,v=s===h,A=a?0:p;_?(d=v?h+1:s,o=v?A:p+1):d=h+1;var E=y.age,g=E+y.ageHeader,T=Math.min(g-y.partTarget,y.targetduration*1.5);if(T>0){if(O&&T>O.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+O.tuneInGoal+" to: "+T+" with playlist age: "+y.age),T=0;else{var P=Math.floor(T/y.targetduration);if(d+=P,o!==void 0){var B=Math.round(T%y.targetduration/y.partTarget);o+=B}this.log("CDN Tune-in age: "+y.ageHeader+"s last advanced "+E.toFixed(2)+"s goal: "+T+" skip sn "+P+" to part "+o)}y.tuneInGoal=T}if(c=this.getDeliveryDirectives(y,R.deliveryDirectives,d,o),a||!v){this.loadPlaylist(c);return}}else c=this.getDeliveryDirectives(y,R.deliveryDirectives,d,o);var V=(0,F.computeReloadInterval)(y,u);d!==void 0&&y.canBlockReload&&(V-=y.partTarget||1),this.log("reload live playlist "+L+" in "+Math.round(V)+" ms"),this.timer=self.setTimeout(function(){return C.loadPlaylist(c)},V)}else this.clearTimer()},k.getDeliveryDirectives=function(L,R,O,C){var y=(0,x.getSkipValue)(L,O);return R!=null&&R.skip&&L.deltaUpdateFailed&&(O=R.msn,C=R.part,y=x.HlsSkip.No),new x.HlsUrlParameters(O,C,y)},k.retryLoadingOrFail=function(L){var R=this,O=this.hls.config,C=this.retryCount<O.levelLoadingMaxRetry;if(C){var y;if(this.retryCount++,L.details.indexOf("LoadTimeOut")>-1&&(y=L.context)!==null&&y!==void 0&&y.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+L.details+'"'),this.loadPlaylist();else{var u=Math.min(Math.pow(2,this.retryCount)*O.levelLoadingRetryDelay,O.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return R.loadPlaylist()},u),this.warn("retry playlist loading #"+this.retryCount+" in "+u+' ms after "'+L.details+'"')}}else this.warn('cannot recover from error "'+L.details+'"'),this.clearTimer(),L.fatal=!0;return C},I}()},"./src/controller/base-stream-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{State:()=>h,default:()=>p});var N=m("./src/polyfills/number.ts"),x=m("./src/task-loop.ts"),F=m("./src/controller/fragment-tracker.ts"),M=m("./src/utils/buffer-helper.ts"),K=m("./src/utils/logger.ts"),w=m("./src/events.ts"),I=m("./src/errors.ts"),k=m("./src/types/transmuxer.ts"),S=m("./src/utils/mp4-tools.ts"),L=m("./src/utils/discontinuities.ts"),R=m("./src/controller/fragment-finders.ts"),O=m("./src/controller/level-helper.ts"),C=m("./src/loader/fragment-loader.ts"),y=m("./src/crypt/decrypter.ts"),u=m("./src/utils/time-ranges.ts"),l=m("./src/types/loader.ts");function c(_,v){for(var A=0;A<v.length;A++){var E=v[A];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(_,E.key,E)}}function d(_,v,A){return v&&c(_.prototype,v),A&&c(_,A),Object.defineProperty(_,"prototype",{writable:!1}),_}function o(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}function a(_,v){_.prototype=Object.create(v.prototype),_.prototype.constructor=_,s(_,v)}function s(_,v){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,g){return E.__proto__=g,E},s(_,v)}var h={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},p=function(_){a(v,_);function v(E,g,T){var P;return P=_.call(this)||this,P.hls=void 0,P.fragPrevious=null,P.fragCurrent=null,P.fragmentTracker=void 0,P.transmuxer=null,P._state=h.STOPPED,P.media=null,P.mediaBuffer=null,P.config=void 0,P.bitrateTest=!1,P.lastCurrentTime=0,P.nextLoadPosition=0,P.startPosition=0,P.loadedmetadata=!1,P.fragLoadError=0,P.retryDate=0,P.levels=null,P.fragmentLoader=void 0,P.levelLastLoaded=null,P.startFragRequested=!1,P.decrypter=void 0,P.initPTS=[],P.onvseeking=null,P.onvended=null,P.logPrefix="",P.log=void 0,P.warn=void 0,P.logPrefix=T,P.log=K.logger.log.bind(K.logger,T+":"),P.warn=K.logger.warn.bind(K.logger,T+":"),P.hls=E,P.fragmentLoader=new C.default(E.config),P.fragmentTracker=g,P.config=E.config,P.decrypter=new y.default(E,E.config),E.on(w.Events.KEY_LOADED,P.onKeyLoaded,o(P)),E.on(w.Events.LEVEL_SWITCHING,P.onLevelSwitching,o(P)),P}var A=v.prototype;return A.doTick=function(){this.onTickEnd()},A.onTickEnd=function(){},A.startLoad=function(g){},A.stopLoad=function(){this.fragmentLoader.abort();var g=this.fragCurrent;g&&this.fragmentTracker.removeFragment(g),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=h.STOPPED},A._streamEnded=function(g,T){var P=this.fragCurrent,B=this.fragmentTracker;if(!T.live&&P&&this.media&&P.sn>=T.endSN&&!g.nextStart){var V=T.partList;if(V!=null&&V.length){var W=V[V.length-1],j=M.BufferHelper.isBuffered(this.media,W.start+W.duration/2);return j}var z=B.getState(P);return z===F.FragmentState.PARTIAL||z===F.FragmentState.OK}return!1},A.onMediaAttached=function(g,T){var P=this.media=this.mediaBuffer=T.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),P.addEventListener("seeking",this.onvseeking),P.addEventListener("ended",this.onvended);var B=this.config;this.levels&&B.autoStartLoad&&this.state===h.STOPPED&&this.startLoad(B.startPosition)},A.onMediaDetaching=function(){var g=this.media;g!=null&&g.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),g&&this.onvseeking&&this.onvended&&(g.removeEventListener("seeking",this.onvseeking),g.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},A.onMediaSeeking=function(){var g=this.config,T=this.fragCurrent,P=this.media,B=this.mediaBuffer,V=this.state,W=P?P.currentTime:0,j=M.BufferHelper.bufferInfo(B||P,W,g.maxBufferHole);if(this.log("media seeking to "+((0,N.isFiniteNumber)(W)?W.toFixed(3):W)+", state: "+V),V===h.ENDED)this.resetLoadingState();else if(T){var z=g.maxFragLookUpTolerance,Q=T.start-z,Z=T.start+T.duration+z;if(!j.len||Z<j.start||Q>j.end){var ee=W>Z;(W<Q||ee)&&(ee&&T.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),T.loader.abort()),this.resetLoadingState())}}P&&(this.lastCurrentTime=W),!this.loadedmetadata&&!j.len&&(this.nextLoadPosition=this.startPosition=W),this.tickImmediate()},A.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},A.onKeyLoaded=function(g,T){if(!(this.state!==h.KEY_LOADING||T.frag!==this.fragCurrent||!this.levels)){this.state=h.IDLE;var P=this.levels[T.frag.level].details;P&&this.loadFragment(T.frag,P,T.frag.start)}},A.onLevelSwitching=function(g,T){this.fragLoadError=0},A.onHandlerDestroying=function(){this.stopLoad(),_.prototype.onHandlerDestroying.call(this)},A.onHandlerDestroyed=function(){this.state=h.STOPPED,this.hls.off(w.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,_.prototype.onHandlerDestroyed.call(this)},A.loadKey=function(g,T){this.log("Loading key for "+g.sn+" of ["+T.startSN+"-"+T.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+g.level),this.state=h.KEY_LOADING,this.fragCurrent=g,this.hls.trigger(w.Events.KEY_LOADING,{frag:g})},A.loadFragment=function(g,T,P){this._loadFragForPlayback(g,T,P)},A._loadFragForPlayback=function(g,T,P){var B=this,V=function(j){if(B.fragContextChanged(g)){B.warn("Fragment "+g.sn+(j.part?" p: "+j.part.index:"")+" of level "+g.level+" was dropped during download."),B.fragmentTracker.removeFragment(g);return}g.stats.chunkCount++,B._handleFragmentLoadProgress(j)};this._doFragLoad(g,T,P,V).then(function(W){if(W){B.fragLoadError=0;var j=B.state;if(B.fragContextChanged(g)){(j===h.FRAG_LOADING||!B.fragCurrent&&j===h.PARSING)&&(B.fragmentTracker.removeFragment(g),B.state=h.IDLE);return}"payload"in W&&(B.log("Loaded fragment "+g.sn+" of level "+g.level),B.hls.trigger(w.Events.FRAG_LOADED,W)),B._handleFragmentLoadComplete(W)}}).catch(function(W){B.state===h.STOPPED||B.state===h.ERROR||(B.warn(W),B.resetFragmentLoading(g))})},A.flushMainBuffer=function(g,T,P){if(P===void 0&&(P=null),!!(g-T)){var B={startOffset:g,endOffset:T,type:P};this.fragLoadError=0,this.hls.trigger(w.Events.BUFFER_FLUSHING,B)}},A._loadInitSegment=function(g){var T=this;this._doFragLoad(g).then(function(P){if(!P||T.fragContextChanged(g)||!T.levels)throw new Error("init load aborted");return P}).then(function(P){var B=T.hls,V=P.payload,W=g.decryptdata;if(V&&V.byteLength>0&&W&&W.key&&W.iv&&W.method==="AES-128"){var j=self.performance.now();return T.decrypter.webCryptoDecrypt(new Uint8Array(V),W.key.buffer,W.iv.buffer).then(function(z){var Q=self.performance.now();return B.trigger(w.Events.FRAG_DECRYPTED,{frag:g,payload:z,stats:{tstart:j,tdecrypt:Q}}),P.payload=z,P})}return P}).then(function(P){var B=T.fragCurrent,V=T.hls,W=T.levels;if(!W)throw new Error("init load aborted, missing levels");var j=W[g.level].details;console.assert(j,"Level details are defined when init segment is loaded");var z=g.stats;T.state=h.IDLE,T.fragLoadError=0,g.data=new Uint8Array(P.payload),z.parsing.start=z.buffering.start=self.performance.now(),z.parsing.end=z.buffering.end=self.performance.now(),P.frag===B&&V.trigger(w.Events.FRAG_BUFFERED,{stats:z,frag:B,part:null,id:g.type}),T.tick()}).catch(function(P){T.state===h.STOPPED||T.state===h.ERROR||(T.warn(P),T.resetFragmentLoading(g))})},A.fragContextChanged=function(g){var T=this.fragCurrent;return!g||!T||g.level!==T.level||g.sn!==T.sn||g.urlId!==T.urlId},A.fragBufferedComplete=function(g,T){var P,B,V=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+g.type+" sn: "+g.sn+(T?" part: "+T.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+g.level+" "+(V?u.default.toString(M.BufferHelper.getBuffered(V)):"(detached)")),this.state=h.IDLE,V&&(!this.loadedmetadata&&g.type==l.PlaylistLevelType.MAIN&&V.buffered.length&&((P=this.fragCurrent)===null||P===void 0?void 0:P.sn)===((B=this.fragPrevious)===null||B===void 0?void 0:B.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},A.seekToStartPos=function(){},A._handleFragmentLoadComplete=function(g){var T=this.transmuxer;if(T){var P=g.frag,B=g.part,V=g.partsLoaded,W=!V||V.length===0||V.some(function(z){return!z}),j=new k.ChunkMetadata(P.level,P.sn,P.stats.chunkCount+1,0,B?B.index:-1,!W);T.flush(j)}},A._handleFragmentLoadProgress=function(g){},A._doFragLoad=function(g,T,P,B){var V=this;if(P===void 0&&(P=null),!this.levels)throw new Error("frag load aborted, missing levels");if(P=Math.max(g.start,P||0),this.config.lowLatencyMode&&T){var W=T.partList;if(W&&B){P>g.end&&T.fragmentHint&&(g=T.fragmentHint);var j=this.getNextPart(W,g,P);if(j>-1){var z=W[j];return this.log("Loading part sn: "+g.sn+" p: "+z.index+" cc: "+g.cc+" of playlist ["+T.startSN+"-"+T.endSN+"] parts [0-"+j+"-"+(W.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+g.level+", target: "+parseFloat(P.toFixed(3))),this.nextLoadPosition=z.start+z.duration,this.state=h.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:g,part:W[j],targetBufferTime:P}),this.doFragPartsLoad(g,W,j,B).catch(function(Q){return V.handleFragLoadError(Q)})}else if(!g.url||this.loadedEndOfParts(W,P))return Promise.resolve(null)}}return this.log("Loading fragment "+g.sn+" cc: "+g.cc+" "+(T?"of ["+T.startSN+"-"+T.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+g.level+", target: "+parseFloat(P.toFixed(3))),(0,N.isFiniteNumber)(g.sn)&&!this.bitrateTest&&(this.nextLoadPosition=g.start+g.duration),this.state=h.FRAG_LOADING,this.hls.trigger(w.Events.FRAG_LOADING,{frag:g,targetBufferTime:P}),this.fragmentLoader.load(g,B).catch(function(Q){return V.handleFragLoadError(Q)})},A.doFragPartsLoad=function(g,T,P,B){var V=this;return new Promise(function(W,j){var z=[],Q=function Z(ee){var ae=T[ee];V.fragmentLoader.loadPart(g,ae,B).then(function(se){z[ae.index]=se;var Y=se.part;V.hls.trigger(w.Events.FRAG_LOADED,se);var X=T[ee+1];if(X&&X.fragment===g)Z(ee+1);else return W({frag:g,part:Y,partsLoaded:z})}).catch(j)};Q(P)})},A.handleFragLoadError=function(g){var T=g.data;return T&&T.details===I.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(T.frag,T.part):this.hls.trigger(w.Events.ERROR,T),null},A._handleTransmuxerFlush=function(g){var T=this.getCurrentContext(g);if(!T||this.state!==h.PARSING){this.fragCurrent||(this.state=h.IDLE);return}var P=T.frag,B=T.part,V=T.level,W=self.performance.now();P.stats.parsing.end=W,B&&(B.stats.parsing.end=W),this.updateLevelTiming(P,B,V,g.partial)},A.getCurrentContext=function(g){var T=this.levels,P=g.level,B=g.sn,V=g.part;if(!T||!T[P])return this.warn("Levels object was unset while buffering fragment "+B+" of level "+P+". The current chunk will not be buffered."),null;var W=T[P],j=V>-1?(0,O.getPartWith)(W,B,V):null,z=j?j.fragment:(0,O.getFragmentWithSN)(W,B,this.fragCurrent);return z?{frag:z,part:j,level:W}:null},A.bufferFragmentData=function(g,T,P,B){if(!(!g||this.state!==h.PARSING)){var V=g.data1,W=g.data2,j=V;if(V&&W&&(j=(0,S.appendUint8Array)(V,W)),!(!j||!j.length)){var z={type:g.type,frag:T,part:P,chunkMeta:B,parent:T.type,data:j};this.hls.trigger(w.Events.BUFFER_APPENDING,z),g.dropped&&g.independent&&!P&&this.flushBufferGap(T)}}},A.flushBufferGap=function(g){var T=this.media;if(T){if(!M.BufferHelper.isBuffered(T,T.currentTime)){this.flushMainBuffer(0,g.start);return}var P=T.currentTime,B=M.BufferHelper.bufferInfo(T,P,0),V=g.duration,W=Math.min(this.config.maxFragLookUpTolerance*2,V*.25),j=Math.max(Math.min(g.start-W,B.end-W),P+W);g.start-j>W&&this.flushMainBuffer(j,g.start)}},A.getFwdBufferInfo=function(g,T){var P=this.config,B=this.getLoadPosition();if(!(0,N.isFiniteNumber)(B))return null;var V=M.BufferHelper.bufferInfo(g,B,P.maxBufferHole);if(V.len===0&&V.nextStart!==void 0){var W=this.fragmentTracker.getBufferedFrag(B,T);if(W&&V.nextStart<W.end)return M.BufferHelper.bufferInfo(g,B,Math.max(V.nextStart,P.maxBufferHole))}return V},A.getMaxBufferLength=function(g){var T=this.config,P;return g?P=Math.max(8*T.maxBufferSize/g,T.maxBufferLength):P=T.maxBufferLength,Math.min(P,T.maxMaxBufferLength)},A.reduceMaxBufferLength=function(g){var T=this.config,P=g||T.maxBufferLength;return T.maxMaxBufferLength>=P?(T.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+T.maxMaxBufferLength+"s"),!0):!1},A.getNextFragment=function(g,T){var P=T.fragments,B=P.length;if(!B)return null;var V=this.config,W=P[0].start,j;if(T.live){var z=V.initialLiveManifestSize;if(B<z)return this.warn("Not enough fragments to start playback (have: "+B+", need: "+z+")"),null;!T.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(j=this.getInitialLiveFragment(T,P),this.startPosition=j?this.hls.liveSyncPosition||j.start:g)}else g<=W&&(j=P[0]);if(!j){var Q=V.lowLatencyMode?T.partEnd:T.fragmentEnd;j=this.getFragmentAtPosition(g,Q,T)}return this.mapToInitFragWhenRequired(j)},A.mapToInitFragWhenRequired=function(g){return g!=null&&g.initSegment&&!(g!=null&&g.initSegment.data)&&!this.bitrateTest?g.initSegment:g},A.getNextPart=function(g,T,P){for(var B=-1,V=!1,W=!0,j=0,z=g.length;j<z;j++){var Q=g[j];if(W=W&&!Q.independent,B>-1&&P<Q.start)break;var Z=Q.loaded;!Z&&(V||Q.independent||W)&&Q.fragment===T&&(B=j),V=Z}return B},A.loadedEndOfParts=function(g,T){var P=g[g.length-1];return P&&T>P.start&&P.loaded},A.getInitialLiveFragment=function(g,T){var P=this.fragPrevious,B=null;if(P){if(g.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+P.programDateTime),B=(0,R.findFragmentByPDT)(T,P.endProgramDateTime,this.config.maxFragLookUpTolerance)),!B){var V=P.sn+1;if(V>=g.startSN&&V<=g.endSN){var W=T[V-g.startSN];P.cc===W.cc&&(B=W,this.log("Live playlist, switching playlist, load frag with next SN: "+B.sn))}B||(B=(0,R.findFragWithCC)(T,P.cc),B&&this.log("Live playlist, switching playlist, load frag with same CC: "+B.sn))}}else{var j=this.hls.liveSyncPosition;j!==null&&(B=this.getFragmentAtPosition(j,this.bitrateTest?g.fragmentEnd:g.edge,g))}return B},A.getFragmentAtPosition=function(g,T,P){var B=this.config,V=this.fragPrevious,W=P.fragments,j=P.endSN,z=P.fragmentHint,Q=B.maxFragLookUpTolerance,Z=!!(B.lowLatencyMode&&P.partList&&z);Z&&z&&!this.bitrateTest&&(W=W.concat(z),j=z.sn);var ee;if(g<T){var ae=g>T-Q?0:Q;ee=(0,R.findFragmentByPTS)(V,W,g,ae)}else ee=W[W.length-1];if(ee){var se=ee.sn-P.startSN;if(this.fragmentTracker.getState(ee)===F.FragmentState.OK&&(V=ee),V&&ee.sn===V.sn&&!Z){var Y=V&&ee.level===V.level;if(Y){var X=W[se+1];ee.sn<j&&this.fragmentTracker.getState(X)!==F.FragmentState.OK?(this.log("SN "+ee.sn+" just loaded, load next one: "+X.sn),ee=X):ee=null}}}return ee},A.synchronizeToLiveEdge=function(g){var T=this.config,P=this.media;if(P){var B=this.hls.liveSyncPosition,V=P.currentTime,W=g.fragments[0].start,j=g.edge,z=V>=W-T.maxFragLookUpTolerance&&V<=j;if(B!==null&&P.duration>B&&(V<B||!z)){var Q=T.liveMaxLatencyDuration!==void 0?T.liveMaxLatencyDuration:T.liveMaxLatencyDurationCount*g.targetduration;(!z&&P.readyState<4||V<j-Q)&&(this.loadedmetadata||(this.nextLoadPosition=B),P.readyState&&(this.warn("Playback: "+V.toFixed(3)+" is located too far from the end of live sliding playlist: "+j+", reset currentTime to : "+B.toFixed(3)),P.currentTime=B))}}},A.alignPlaylists=function(g,T){var P=this.levels,B=this.levelLastLoaded,V=this.fragPrevious,W=B!==null?P[B]:null,j=g.fragments.length;if(!j)return this.warn("No fragments in live playlist"),0;var z=g.fragments[0].start,Q=!T,Z=g.alignedSliding&&(0,N.isFiniteNumber)(z);if(Q||!Z&&!z){(0,L.alignStream)(V,W,g);var ee=g.fragments[0].start;return this.log("Live playlist sliding: "+ee.toFixed(2)+" start-sn: "+(T?T.startSN:"na")+"->"+g.startSN+" prev-sn: "+(V?V.sn:"na")+" fragments: "+j),ee}return z},A.waitForCdnTuneIn=function(g){var T=3;return g.live&&g.canBlockReload&&g.partTarget&&g.tuneInGoal>Math.max(g.partHoldBack,g.partTarget*T)},A.setStartPosition=function(g,T){var P=this.startPosition;if(P<T&&(P=-1),P===-1||this.lastCurrentTime===-1){var B=g.startTimeOffset;(0,N.isFiniteNumber)(B)?(P=T+B,B<0&&(P+=g.totalduration),P=Math.min(Math.max(T,P),T+g.totalduration),this.log("Start time offset "+B+" found in playlist, adjust startPosition to "+P),this.startPosition=P):g.live?P=this.hls.liveSyncPosition||T:this.startPosition=P=0,this.lastCurrentTime=P}this.nextLoadPosition=P},A.getLoadPosition=function(){var g=this.media,T=0;return this.loadedmetadata&&g?T=g.currentTime:this.nextLoadPosition&&(T=this.nextLoadPosition),T},A.handleFragLoadAborted=function(g,T){this.transmuxer&&g.sn!=="initSegment"&&g.stats.aborted&&(this.warn("Fragment "+g.sn+(T?" part"+T.index:"")+" of level "+g.level+" was aborted"),this.resetFragmentLoading(g))},A.resetFragmentLoading=function(g){(!this.fragCurrent||!this.fragContextChanged(g)&&this.state!==h.FRAG_LOADING_WAITING_RETRY)&&(this.state=h.IDLE)},A.onFragmentOrKeyLoadError=function(g,T){if(!T.fatal){var P=T.frag;if(!(!P||P.type!==g)){var B=this.fragCurrent;console.assert(B&&P.sn===B.sn&&P.level===B.level&&P.urlId===B.urlId,"Frag load error must match current frag to retry");var V=this.config;if(this.fragLoadError+1<=V.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var W=Math.min(Math.pow(2,this.fragLoadError)*V.fragLoadingRetryDelay,V.fragLoadingMaxRetryTimeout);this.warn("Fragment "+P.sn+" of "+g+" "+P.level+" failed to load, retrying in "+W+"ms"),this.retryDate=self.performance.now()+W,this.fragLoadError++,this.state=h.FRAG_LOADING_WAITING_RETRY}else T.levelRetry?(g===l.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=h.IDLE):(K.logger.error(T.details+" reaches max retry, redispatch as fatal ..."),T.fatal=!0,this.hls.stopLoad(),this.state=h.ERROR)}}},A.afterBufferFlushed=function(g,T,P){if(g){var B=M.BufferHelper.getBuffered(g);this.fragmentTracker.detectEvictedFragments(T,B,P),this.state===h.ENDED&&this.resetLoadingState()}},A.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=h.IDLE},A.resetStartWhenNotLoaded=function(g){if(!this.loadedmetadata){this.startFragRequested=!1;var T=this.levels?this.levels[g].details:null;T!=null&&T.live?(this.startPosition=-1,this.setStartPosition(T,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},A.updateLevelTiming=function(g,T,P,B){var V=this,W=P.details;console.assert(!!W,"level.details must be defined");var j=Object.keys(g.elementaryStreams).reduce(function(z,Q){var Z=g.elementaryStreams[Q];if(Z){var ee=Z.endPTS-Z.startPTS;if(ee<=0)return V.warn("Could not parse fragment "+g.sn+" "+Q+" duration reliably ("+ee+")"),z||!1;var ae=B?0:(0,O.updateFragPTSDTS)(W,g,Z.startPTS,Z.endPTS,Z.startDTS,Z.endDTS);return V.hls.trigger(w.Events.LEVEL_PTS_UPDATED,{details:W,level:P,drift:ae,type:Q,frag:g,start:Z.startPTS,end:Z.endPTS}),!0}return z},!1);j||(this.warn("Found no media in fragment "+g.sn+" of level "+P.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=h.PARSED,this.hls.trigger(w.Events.FRAG_PARSED,{frag:g,part:T})},A.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},d(v,[{key:"state",get:function(){return this._state},set:function(g){var T=this._state;T!==g&&(this._state=g,this.log(T+"->"+g))}}]),v}(x.default)},"./src/controller/buffer-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>R});var N=m("./src/polyfills/number.ts"),x=m("./src/events.ts"),F=m("./src/utils/logger.ts"),M=m("./src/errors.ts"),K=m("./src/utils/buffer-helper.ts"),w=m("./src/utils/mediasource-helper.ts"),I=m("./src/loader/fragment.ts"),k=m("./src/controller/buffer-operation-queue.ts"),S=(0,w.getMediaSource)(),L=/([ha]vc.)(?:\.[^.,]+)+/,R=function(){function O(y){var u=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var l=u.hls,c=u.media,d=u.mediaSource;F.logger.log("[buffer-controller]: Media source opened"),c&&(u.updateMediaElementDuration(),l.trigger(x.Events.MEDIA_ATTACHED,{media:c})),d&&d.removeEventListener("sourceopen",u._onMediaSourceOpen),u.checkPendingTracks()},this._onMediaSourceClose=function(){F.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){F.logger.log("[buffer-controller]: Media source ended")},this.hls=y,this._initSourceBuffer(),this.registerListeners()}var C=O.prototype;return C.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},C.destroy=function(){this.unregisterListeners(),this.details=null},C.registerListeners=function(){var u=this.hls;u.on(x.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.on(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.on(x.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.on(x.Events.BUFFER_RESET,this.onBufferReset,this),u.on(x.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.on(x.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.on(x.Events.BUFFER_EOS,this.onBufferEos,this),u.on(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.on(x.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.on(x.Events.FRAG_PARSED,this.onFragParsed,this),u.on(x.Events.FRAG_CHANGED,this.onFragChanged,this)},C.unregisterListeners=function(){var u=this.hls;u.off(x.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(x.Events.MANIFEST_PARSED,this.onManifestParsed,this),u.off(x.Events.BUFFER_RESET,this.onBufferReset,this),u.off(x.Events.BUFFER_APPENDING,this.onBufferAppending,this),u.off(x.Events.BUFFER_CODECS,this.onBufferCodecs,this),u.off(x.Events.BUFFER_EOS,this.onBufferEos,this),u.off(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),u.off(x.Events.LEVEL_UPDATED,this.onLevelUpdated,this),u.off(x.Events.FRAG_PARSED,this.onFragParsed,this),u.off(x.Events.FRAG_CHANGED,this.onFragChanged,this)},C._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new k.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},C.onManifestParsed=function(u,l){var c=2;(l.audio&&!l.video||!l.altAudio)&&(c=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=c,this.details=null,F.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},C.onMediaAttaching=function(u,l){var c=this.media=l.media;if(c&&S){var d=this.mediaSource=new S;d.addEventListener("sourceopen",this._onMediaSourceOpen),d.addEventListener("sourceended",this._onMediaSourceEnded),d.addEventListener("sourceclose",this._onMediaSourceClose),c.src=self.URL.createObjectURL(d),this._objectUrl=c.src}},C.onMediaDetaching=function(){var u=this.media,l=this.mediaSource,c=this._objectUrl;if(l){if(F.logger.log("[buffer-controller]: media source detaching"),l.readyState==="open")try{l.endOfStream()}catch(d){F.logger.warn("[buffer-controller]: onMediaDetaching: "+d.message+" while calling endOfStream")}this.onBufferReset(),l.removeEventListener("sourceopen",this._onMediaSourceOpen),l.removeEventListener("sourceended",this._onMediaSourceEnded),l.removeEventListener("sourceclose",this._onMediaSourceClose),u&&(c&&self.URL.revokeObjectURL(c),u.src===c?(u.removeAttribute("src"),u.load()):F.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(x.Events.MEDIA_DETACHED,void 0)},C.onBufferReset=function(){var u=this;this.getSourceBufferTypes().forEach(function(l){var c=u.sourceBuffer[l];try{c&&(u.removeBufferListeners(l),u.mediaSource&&u.mediaSource.removeSourceBuffer(c),u.sourceBuffer[l]=void 0)}catch(d){F.logger.warn("[buffer-controller]: Failed to reset the "+l+" buffer",d)}}),this._initSourceBuffer()},C.onBufferCodecs=function(u,l){var c=this,d=this.getSourceBufferTypes().length;Object.keys(l).forEach(function(o){if(d){var a=c.tracks[o];if(a&&typeof a.buffer.changeType=="function"){var s=l[o],h=s.id,p=s.codec,_=s.levelCodec,v=s.container,A=s.metadata,E=(a.levelCodec||a.codec).replace(L,"$1"),g=(_||p).replace(L,"$1");if(E!==g){var T=v+";codecs="+(_||p);c.appendChangeType(o,T),F.logger.log("[buffer-controller]: switching codec "+E+" to "+g),c.tracks[o]={buffer:a.buffer,codec:p,container:v,levelCodec:_,metadata:A,id:h}}}}else c.pendingTracks[o]=l[o]}),!d&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},C.appendChangeType=function(u,l){var c=this,d=this.operationQueue,o={execute:function(){var s=c.sourceBuffer[u];s&&(F.logger.log("[buffer-controller]: changing "+u+" sourceBuffer type to "+l),s.changeType(l)),d.shiftAndExecuteNext(u)},onStart:function(){},onComplete:function(){},onError:function(s){F.logger.warn("[buffer-controller]: Failed to change "+u+" SourceBuffer type",s)}};d.append(o,u)},C.onBufferAppending=function(u,l){var c=this,d=this.hls,o=this.operationQueue,a=this.tracks,s=l.data,h=l.type,p=l.frag,_=l.part,v=l.chunkMeta,A=v.buffering[h],E=self.performance.now();A.start=E;var g=p.stats.buffering,T=_?_.stats.buffering:null;g.start===0&&(g.start=E),T&&T.start===0&&(T.start=E);var P=a.audio,B=h==="audio"&&v.id===1&&(P==null?void 0:P.container)==="audio/mpeg",V={execute:function(){if(A.executeStart=self.performance.now(),B){var j=c.sourceBuffer[h];if(j){var z=p.start-j.timestampOffset;Math.abs(z)>=.1&&(F.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+p.start+" (delta: "+z+") sn: "+p.sn+")"),j.timestampOffset=p.start)}}c.appendExecutor(s,h)},onStart:function(){},onComplete:function(){var j=self.performance.now();A.executeEnd=A.end=j,g.first===0&&(g.first=j),T&&T.first===0&&(T.first=j);var z=c.sourceBuffer,Q={};for(var Z in z)Q[Z]=K.BufferHelper.getBuffered(z[Z]);c.appendError=0,c.hls.trigger(x.Events.BUFFER_APPENDED,{type:h,frag:p,part:_,chunkMeta:v,parent:p.type,timeRanges:Q})},onError:function(j){F.logger.error("[buffer-controller]: Error encountered while trying to append to the "+h+" SourceBuffer",j);var z={type:M.ErrorTypes.MEDIA_ERROR,parent:p.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:j,fatal:!1};j.code===DOMException.QUOTA_EXCEEDED_ERR?z.details=M.ErrorDetails.BUFFER_FULL_ERROR:(c.appendError++,z.details=M.ErrorDetails.BUFFER_APPEND_ERROR,c.appendError>d.config.appendErrorMaxRetry&&(F.logger.error("[buffer-controller]: Failed "+d.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),z.fatal=!0,d.stopLoad())),d.trigger(x.Events.ERROR,z)}};o.append(V,h)},C.onBufferFlushing=function(u,l){var c=this,d=this.operationQueue,o=function(s){return{execute:c.removeExecutor.bind(c,s,l.startOffset,l.endOffset),onStart:function(){},onComplete:function(){c.hls.trigger(x.Events.BUFFER_FLUSHED,{type:s})},onError:function(p){F.logger.warn("[buffer-controller]: Failed to remove from "+s+" SourceBuffer",p)}}};l.type?d.append(o(l.type),l.type):this.getSourceBufferTypes().forEach(function(a){d.append(o(a),a)})},C.onFragParsed=function(u,l){var c=this,d=l.frag,o=l.part,a=[],s=o?o.elementaryStreams:d.elementaryStreams;s[I.ElementaryStreamTypes.AUDIOVIDEO]?a.push("audiovideo"):(s[I.ElementaryStreamTypes.AUDIO]&&a.push("audio"),s[I.ElementaryStreamTypes.VIDEO]&&a.push("video"));var h=function(){var _=self.performance.now();d.stats.buffering.end=_,o&&(o.stats.buffering.end=_);var v=o?o.stats:d.stats;c.hls.trigger(x.Events.FRAG_BUFFERED,{frag:d,part:o,stats:v,id:d.type})};a.length===0&&F.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+d.type+" level: "+d.level+" sn: "+d.sn),this.blockBuffers(h,a)},C.onFragChanged=function(u,l){this.flushBackBuffer()},C.onBufferEos=function(u,l){var c=this,d=this.getSourceBufferTypes().reduce(function(o,a){var s=c.sourceBuffer[a];return(!l.type||l.type===a)&&s&&!s.ended&&(s.ended=!0,F.logger.log("[buffer-controller]: "+a+" sourceBuffer now EOS")),o&&!!(!s||s.ended)},!0);d&&this.blockBuffers(function(){var o=c.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},C.onLevelUpdated=function(u,l){var c=l.details;c.fragments.length&&(this.details=c,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},C.flushBackBuffer=function(){var u=this.hls,l=this.details,c=this.media,d=this.sourceBuffer;if(!(!c||l===null)){var o=this.getSourceBufferTypes();if(o.length){var a=l.live&&u.config.liveBackBufferLength!==null?u.config.liveBackBufferLength:u.config.backBufferLength;if(!(!(0,N.isFiniteNumber)(a)||a<0)){var s=c.currentTime,h=l.levelTargetDuration,p=Math.max(a,h),_=Math.floor(s/h)*h-p;o.forEach(function(v){var A=d[v];if(A){var E=K.BufferHelper.getBuffered(A);E.length>0&&_>E.start(0)&&(u.trigger(x.Events.BACK_BUFFER_REACHED,{bufferEnd:_}),l.live&&u.trigger(x.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:_}),u.trigger(x.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:_,type:v}))}})}}}},C.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var u=this.details,l=this.hls,c=this.media,d=this.mediaSource,o=u.fragments[0].start+u.totalduration,a=c.duration,s=(0,N.isFiniteNumber)(d.duration)?d.duration:0;u.live&&l.config.liveDurationInfinity?(F.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),d.duration=1/0,this.updateSeekableRange(u)):(o>s&&o>a||!(0,N.isFiniteNumber)(a))&&(F.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),d.duration=o)}},C.updateSeekableRange=function(u){var l=this.mediaSource,c=u.fragments,d=c.length;if(d&&u.live&&l!==null&&l!==void 0&&l.setLiveSeekableRange){var o=Math.max(0,c[0].start),a=Math.max(o,o+u.totalduration);l.setLiveSeekableRange(o,a)}},C.checkPendingTracks=function(){var u=this.bufferCodecEventsExpected,l=this.operationQueue,c=this.pendingTracks,d=Object.keys(c).length;if(d&&!u||d===2){this.createSourceBuffers(c),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(x.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(a){l.executeNext(a)})}},C.createSourceBuffers=function(u){var l=this.sourceBuffer,c=this.mediaSource;if(!c)throw Error("createSourceBuffers called when mediaSource was null");var d=0;for(var o in u)if(!l[o]){var a=u[o];if(!a)throw Error("source buffer exists for track "+o+", however track does not");var s=a.levelCodec||a.codec,h=a.container+";codecs="+s;F.logger.log("[buffer-controller]: creating sourceBuffer("+h+")");try{var p=l[o]=c.addSourceBuffer(h),_=o;this.addBufferListener(_,"updatestart",this._onSBUpdateStart),this.addBufferListener(_,"updateend",this._onSBUpdateEnd),this.addBufferListener(_,"error",this._onSBUpdateError),this.tracks[o]={buffer:p,codec:s,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id},d++}catch(v){F.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+v.message),this.hls.trigger(x.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:v,mimeType:h})}}d&&this.hls.trigger(x.Events.BUFFER_CREATED,{tracks:this.tracks})},C._onSBUpdateStart=function(u){var l=this.operationQueue,c=l.current(u);c.onStart()},C._onSBUpdateEnd=function(u){var l=this.operationQueue,c=l.current(u);c.onComplete(),l.shiftAndExecuteNext(u)},C._onSBUpdateError=function(u,l){F.logger.error("[buffer-controller]: "+u+" SourceBuffer error",l),this.hls.trigger(x.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var c=this.operationQueue.current(u);c&&c.onError(l)},C.removeExecutor=function(u,l,c){var d=this.media,o=this.mediaSource,a=this.operationQueue,s=this.sourceBuffer,h=s[u];if(!d||!o||!h){F.logger.warn("[buffer-controller]: Attempting to remove from the "+u+" SourceBuffer, but it does not exist"),a.shiftAndExecuteNext(u);return}var p=(0,N.isFiniteNumber)(d.duration)?d.duration:1/0,_=(0,N.isFiniteNumber)(o.duration)?o.duration:1/0,v=Math.max(0,l),A=Math.min(c,p,_);A>v?(F.logger.log("[buffer-controller]: Removing ["+v+","+A+"] from the "+u+" SourceBuffer"),console.assert(!h.updating,u+" sourceBuffer must not be updating"),h.remove(v,A)):a.shiftAndExecuteNext(u)},C.appendExecutor=function(u,l){var c=this.operationQueue,d=this.sourceBuffer,o=d[l];if(!o){F.logger.warn("[buffer-controller]: Attempting to append to the "+l+" SourceBuffer, but it does not exist"),c.shiftAndExecuteNext(l);return}o.ended=!1,console.assert(!o.updating,l+" sourceBuffer must not be updating"),o.appendBuffer(u)},C.blockBuffers=function(u,l){var c=this;if(l===void 0&&(l=this.getSourceBufferTypes()),!l.length){F.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(u);return}var d=this.operationQueue,o=l.map(function(a){return d.appendBlocker(a)});Promise.all(o).then(function(){u(),l.forEach(function(a){var s=c.sourceBuffer[a];(!s||!s.updating)&&d.shiftAndExecuteNext(a)})})},C.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},C.addBufferListener=function(u,l,c){var d=this.sourceBuffer[u];if(d){var o=c.bind(this,u);this.listeners[u].push({event:l,listener:o}),d.addEventListener(l,o)}},C.removeBufferListeners=function(u){var l=this.sourceBuffer[u];l&&this.listeners[u].forEach(function(c){l.removeEventListener(c.event,c.listener)})},O}()},"./src/controller/buffer-operation-queue.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>x});var N=m("./src/utils/logger.ts"),x=function(){function F(K){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=K}var M=F.prototype;return M.append=function(w,I){var k=this.queues[I];k.push(w),k.length===1&&this.buffers[I]&&this.executeNext(I)},M.insertAbort=function(w,I){var k=this.queues[I];k.unshift(w),this.executeNext(I)},M.appendBlocker=function(w){var I,k=new Promise(function(L){I=L}),S={execute:I,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(S,w),k},M.executeNext=function(w){var I=this.buffers,k=this.queues,S=I[w],L=k[w];if(L.length){var R=L[0];try{R.execute()}catch(O){N.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),R.onError(O),(!S||!S.updating)&&(L.shift(),this.executeNext(w))}}},M.shiftAndExecuteNext=function(w){this.queues[w].shift(),this.executeNext(w)},M.current=function(w){return this.queues[w][0]},F}()},"./src/controller/cap-level-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>K});var N=m("./src/events.ts");function x(w,I){for(var k=0;k<I.length;k++){var S=I[k];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}function F(w,I,k){return I&&x(w.prototype,I),k&&x(w,k),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=function(){function w(k){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=k,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var I=w.prototype;return I.setStreamController=function(S){this.streamController=S},I.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},I.registerListeners=function(){var S=this.hls;S.on(N.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),S.on(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),S.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),S.on(N.Events.BUFFER_CODECS,this.onBufferCodecs,this),S.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.unregisterListener=function(){var S=this.hls;S.off(N.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),S.off(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),S.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),S.off(N.Events.BUFFER_CODECS,this.onBufferCodecs,this),S.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},I.onFpsDropLevelCapping=function(S,L){w.isLevelAllowed(L.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(L.droppedLevel)},I.onMediaAttaching=function(S,L){this.media=L.media instanceof HTMLVideoElement?L.media:null},I.onManifestParsed=function(S,L){var R=this.hls;this.restrictedLevels=[],this.firstLevel=L.firstLevel,R.config.capLevelToPlayerSize&&L.video&&this.startCapping()},I.onBufferCodecs=function(S,L){var R=this.hls;R.config.capLevelToPlayerSize&&L.video&&this.startCapping()},I.onMediaDetaching=function(){this.stopCapping()},I.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var S=this.hls.levels;if(S.length){var L=this.hls;L.autoLevelCapping=this.getMaxLevel(S.length-1),L.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=L.autoLevelCapping}}},I.getMaxLevel=function(S){var L=this,R=this.hls.levels;if(!R.length)return-1;var O=R.filter(function(C,y){return w.isLevelAllowed(y,L.restrictedLevels)&&y<=S});return this.clientRect=null,w.getMaxLevelByMediaSize(O,this.mediaWidth,this.mediaHeight)},I.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},I.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},I.getDimensions=function(){if(this.clientRect)return this.clientRect;var S=this.media,L={width:0,height:0};if(S){var R=S.getBoundingClientRect();L.width=R.width,L.height=R.height,!L.width&&!L.height&&(L.width=R.right-R.left||S.width||0,L.height=R.bottom-R.top||S.height||0)}return this.clientRect=L,L},w.isLevelAllowed=function(S,L){return L===void 0&&(L=[]),L.indexOf(S)===-1},w.getMaxLevelByMediaSize=function(S,L,R){if(!S||!S.length)return-1;for(var O=function(c,d){return d?c.width!==d.width||c.height!==d.height:!0},C=S.length-1,y=0;y<S.length;y+=1){var u=S[y];if((u.width>=L||u.height>=R)&&O(u,S[y+1])){C=y;break}}return C},F(w,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var S=1;if(!this.hls.config.ignoreDevicePixelRatio)try{S=self.devicePixelRatio}catch{}return S}}]),w}();const K=M},"./src/controller/cmcd-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>R});var N=m("./src/events.ts"),x=m("./src/types/cmcd.ts"),F=m("./src/utils/buffer-helper.ts"),M=m("./src/utils/logger.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){var y=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(y)return(y=y.call(O)).next.bind(y);if(Array.isArray(O)||(y=k(O))||C&&O&&typeof O.length=="number"){y&&(O=y);var u=0;return function(){return u>=O.length?{done:!0}:{done:!1,value:O[u++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(O,C){if(O){if(typeof O=="string")return S(O,C);var y=Object.prototype.toString.call(O).slice(8,-1);if(y==="Object"&&O.constructor&&(y=O.constructor.name),y==="Map"||y==="Set")return Array.from(O);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return S(O,C)}}function S(O,C){(C==null||C>O.length)&&(C=O.length);for(var y=0,u=new Array(C);y<C;y++)u[y]=O[y];return u}function L(){return L=Object.assign?Object.assign.bind():function(O){for(var C=1;C<arguments.length;C++){var y=arguments[C];for(var u in y)Object.prototype.hasOwnProperty.call(y,u)&&(O[u]=y[u])}return O},L.apply(this,arguments)}var R=function(){function O(y){var u=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){u.initialized&&(u.starved=!0),u.buffering=!0},this.onPlaying=function(){u.initialized||(u.initialized=!0),u.buffering=!1},this.applyPlaylistData=function(d){try{u.apply(d,{ot:x.CMCDObjectType.MANIFEST,su:!u.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(d){try{var o=d.frag,a=u.hls.levels[o.level],s=u.getObjectType(o),h={d:o.duration*1e3,ot:s};(s===x.CMCDObjectType.VIDEO||s===x.CMCDObjectType.AUDIO||s==x.CMCDObjectType.MUXED)&&(h.br=a.bitrate/1e3,h.tb=u.getTopBandwidth(s)/1e3,h.bl=u.getBufferLength(s)),u.apply(d,h)}catch(p){M.logger.warn("Could not generate segment CMCD data.",p)}},this.hls=y;var l=this.config=y.config,c=l.cmcd;c!=null&&(l.pLoader=this.createPlaylistLoader(),l.fLoader=this.createFragmentLoader(),this.sid=c.sessionId||O.uuid(),this.cid=c.contentId,this.useHeaders=c.useHeaders===!0,this.registerListeners())}var C=O.prototype;return C.registerListeners=function(){var u=this.hls;u.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.on(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.on(N.Events.BUFFER_CREATED,this.onBufferCreated,this)},C.unregisterListeners=function(){var u=this.hls;u.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),u.off(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),u.off(N.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},C.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},C.onMediaAttached=function(u,l){this.media=l.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},C.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},C.onBufferCreated=function(u,l){var c,d;this.audioBuffer=(c=l.tracks.audio)===null||c===void 0?void 0:c.buffer,this.videoBuffer=(d=l.tracks.video)===null||d===void 0?void 0:d.buffer},C.createData=function(){var u;return{v:x.CMCDVersion,sf:x.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(u=this.media)===null||u===void 0?void 0:u.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},C.apply=function(u,l){l===void 0&&(l={}),L(l,this.createData());var c=l.ot===x.CMCDObjectType.INIT||l.ot===x.CMCDObjectType.VIDEO||l.ot===x.CMCDObjectType.MUXED;if(this.starved&&c&&(l.bs=!0,l.su=!0,this.starved=!1),l.su==null&&(l.su=this.buffering),this.useHeaders){var d=O.toHeaders(l);if(!Object.keys(d).length)return;u.headers||(u.headers={}),L(u.headers,d)}else{var o=O.toQuery(l);if(!o)return;u.url=O.appendQueryToUri(u.url,o)}},C.getObjectType=function(u){var l=u.type;if(l==="subtitle")return x.CMCDObjectType.TIMED_TEXT;if(u.sn==="initSegment")return x.CMCDObjectType.INIT;if(l==="audio")return x.CMCDObjectType.AUDIO;if(l==="main")return this.hls.audioTracks.length?x.CMCDObjectType.VIDEO:x.CMCDObjectType.MUXED},C.getTopBandwidth=function(u){var l=0,c,d=this.hls;if(u===x.CMCDObjectType.AUDIO)c=d.audioTracks;else{var o=d.maxAutoLevel,a=o>-1?o+1:d.levels.length;c=d.levels.slice(0,a)}for(var s=I(c),h;!(h=s()).done;){var p=h.value;p.bitrate>l&&(l=p.bitrate)}return l>0?l:NaN},C.getBufferLength=function(u){var l=this.hls.media,c=u===x.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!c||!l)return NaN;var d=F.BufferHelper.bufferInfo(c,l.currentTime,this.config.maxBufferHole);return d.len*1e3},C.createPlaylistLoader=function(){var u=this.config.pLoader,l=this.applyPlaylistData,c=u||this.config.loader;return function(){function d(a){this.loader=void 0,this.loader=new c(a)}var o=d.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,h,p){l(s),this.loader.load(s,h,p)},w(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d}()},C.createFragmentLoader=function(){var u=this.config.fLoader,l=this.applyFragmentData,c=u||this.config.loader;return function(){function d(a){this.loader=void 0,this.loader=new c(a)}var o=d.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(s,h,p){l(s),this.loader.load(s,h,p)},w(d,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),d}()},O.uuid=function(){var u=URL.createObjectURL(new Blob),l=u.toString();return URL.revokeObjectURL(u),l.slice(l.lastIndexOf("/")+1)},O.serialize=function(u){for(var l=[],c=function(B){return!Number.isNaN(B)&&B!=null&&B!==""&&B!==!1},d=function(B){return Math.round(B)},o=function(B){return d(B/100)*100},a=function(B){return encodeURIComponent(B)},s={br:d,d,bl:o,dl:o,mtp:o,nor:a,rtp:o,tb:d},h=Object.keys(u||{}).sort(),p=I(h),_;!(_=p()).done;){var v=_.value,A=u[v];if(c(A)&&!(v==="v"&&A===1)&&!(v=="pr"&&A===1)){var E=s[v];E&&(A=E(A));var g=typeof A,T=void 0;v==="ot"||v==="sf"||v==="st"?T=v+"="+A:g==="boolean"?T=v:g==="number"?T=v+"="+A:T=v+"="+JSON.stringify(A),l.push(T)}}return l.join(",")},O.toHeaders=function(u){for(var l=Object.keys(u),c={},d=["Object","Request","Session","Status"],o=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},s=0,h=l;s<h.length;s++){var p=h[s],_=a[p]!=null?a[p]:1;o[_][p]=u[p]}for(var v=0;v<o.length;v++){var A=O.serialize(o[v]);A&&(c["CMCD-"+d[v]]=A)}return c},O.toQuery=function(u){return"CMCD="+encodeURIComponent(O.serialize(u))},O.appendQueryToUri=function(u,l){if(!l)return u;var c=u.includes("?")?"&":"?";return""+u+c+l},O}()},"./src/controller/eme-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>R});var N=m("./src/events.ts"),x=m("./src/errors.ts"),F=m("./src/utils/logger.ts"),M=m("./src/utils/mediakeys-helper.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}var I=3,k=function(C,y,u){var l={audioCapabilities:[],videoCapabilities:[]};return C.forEach(function(c){l.audioCapabilities.push({contentType:'audio/mp4; codecs="'+c+'"',robustness:u.audioRobustness||""})}),y.forEach(function(c){l.videoCapabilities.push({contentType:'video/mp4; codecs="'+c+'"',robustness:u.videoRobustness||""})}),[l]},S=function(C,y,u,l){switch(C){case M.KeySystems.WIDEVINE:return k(y,u,l);default:throw new Error("Unknown key-system: "+C)}},L=function(){function O(y){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=y,this._config=y.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var C=O.prototype;return C.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},C._registerListeners=function(){this.hls.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C._unregisterListeners=function(){this.hls.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(N.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this)},C.getLicenseServerUrl=function(u){switch(u){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+u+'"')},C._attemptKeySystemAccess=function(u,l,c){var d=this,o=S(u,l,c,this._drmSystemOptions);F.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(u,o);this.mediaKeysPromise=a.then(function(s){return d._onMediaKeySystemAccessObtained(u,s)}),a.catch(function(s){F.logger.error('Failed to obtain key-system "'+u+'" access:',s)})},C._onMediaKeySystemAccessObtained=function(u,l){var c=this;F.logger.log('Access for key-system "'+u+'" obtained');var d={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:l,mediaKeySystemDomain:u};this._mediaKeysList.push(d);var o=Promise.resolve().then(function(){return l.createMediaKeys()}).then(function(a){return d.mediaKeys=a,F.logger.log('Media-keys created for key-system "'+u+'"'),c._onMediaKeysCreated(),a});return o.catch(function(a){F.logger.error("Failed to create media-keys:",a)}),o},C._onMediaKeysCreated=function(){var u=this;this._mediaKeysList.forEach(function(l){l.mediaKeysSession||(l.mediaKeysSession=l.mediaKeys.createSession(),u._onNewMediaKeySession(l.mediaKeysSession))})},C._onNewMediaKeySession=function(u){var l=this;F.logger.log("New key-system session "+u.sessionId),u.addEventListener("message",function(c){l._onKeySessionMessage(u,c.message)},!1)},C._onKeySessionMessage=function(u,l){F.logger.log("Got EME message event, creating license request"),this._requestLicense(l,function(c){F.logger.log("Received license data (length: "+(c&&c.byteLength)+"), updating key-session"),u.update(c).catch(function(d){F.logger.warn("Updating key-session failed: "+d)})})},C.onMediaEncrypted=function(u){var l=this;if(F.logger.log('Media is encrypted using "'+u.initDataType+'" init data type'),!this.mediaKeysPromise){F.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var c=function(o){l._media&&(l._attemptSetMediaKeys(o),l._generateRequestWithPreferredKeySession(u.initDataType,u.initData))};this.mediaKeysPromise.then(c).catch(c)},C._attemptSetMediaKeys=function(u){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var l=this._mediaKeysList[0];if(!l||!l.mediaKeys){F.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}F.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(l.mediaKeys),this._hasSetMediaKeys=!0}},C._generateRequestWithPreferredKeySession=function(u,l){var c=this,d=this._mediaKeysList[0];if(!d){F.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(d.mediaKeysSessionInitialized){F.logger.warn("Key-Session already initialized but requested again");return}var o=d.mediaKeysSession;if(!o){F.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!l){F.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}F.logger.log('Generating key-session request for "'+u+'" init data type'),d.mediaKeysSessionInitialized=!0,o.generateRequest(u,l).then(function(){F.logger.debug("Key-session generation succeeded")}).catch(function(a){F.logger.error("Error generating key-session request:",a),c.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},C._createLicenseXhr=function(u,l,c){var d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,d,u,l,c);var o=this._licenseXhrSetup;if(o)try{o.call(this.hls,d,u),o=void 0}catch(a){F.logger.error(a)}try{d.readyState||d.open("POST",u,!0),o&&o.call(this.hls,d,u)}catch(a){throw new Error("issue setting up KeySystem license XHR "+a)}return d},C._onLicenseRequestReadyStageChange=function(u,l,c,d){switch(u.readyState){case 4:if(u.status===200){this._requestLicenseFailureCount=0,F.logger.log("License request succeeded");var o=u.response,a=this._licenseResponseCallback;if(a)try{o=a.call(this.hls,u,l)}catch(h){F.logger.error(h)}d(o)}else{if(F.logger.error("License Request XHR failed ("+l+"). Status: "+u.status+" ("+u.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>I){this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var s=I-this._requestLicenseFailureCount+1;F.logger.warn("Retrying license request, "+s+" attempts left"),this._requestLicense(c,d)}break}},C._generateLicenseRequestChallenge=function(u,l){switch(u.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return l}throw new Error("unsupported key-system: "+u.mediaKeySystemDomain)},C._requestLicense=function(u,l){F.logger.log("Requesting content license for key-system");var c=this._mediaKeysList[0];if(!c){F.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var d=this.getLicenseServerUrl(c.mediaKeySystemDomain),o=this._createLicenseXhr(d,u,l);F.logger.log("Sending license request to URL: "+d);var a=this._generateLicenseRequestChallenge(c,u);o.send(a)}catch(s){F.logger.error("Failure requesting DRM license: "+s),this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.KEY_SYSTEM_ERROR,details:x.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},C.onMediaAttached=function(u,l){if(this._emeEnabled){var c=l.media;this._media=c,c.addEventListener("encrypted",this._onMediaEncrypted)}},C.onMediaDetached=function(){var u=this._media,l=this._mediaKeysList;u&&(u.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(l.map(function(c){if(c.mediaKeysSession)return c.mediaKeysSession.close().catch(function(){})})).then(function(){return u.setMediaKeys(null)}).catch(function(){}))},C.onManifestParsed=function(u,l){if(this._emeEnabled){var c=l.levels.map(function(o){return o.audioCodec}).filter(function(o){return!!o}),d=l.levels.map(function(o){return o.videoCodec}).filter(function(o){return!!o});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,c,d)}},w(O,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),O}();const R=L},"./src/controller/fps-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>M});var N=m("./src/events.ts"),x=m("./src/utils/logger.ts"),F=function(){function K(I){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=I,this.registerListeners()}var w=K.prototype;return w.setStreamController=function(k){this.streamController=k},w.registerListeners=function(){this.hls.on(N.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},w.unregisterListeners=function(){this.hls.off(N.Events.MEDIA_ATTACHING,this.onMediaAttaching)},w.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},w.onMediaAttaching=function(k,S){var L=this.hls.config;if(L.capLevelOnFPSDrop){var R=S.media instanceof self.HTMLVideoElement?S.media:null;this.media=R,R&&typeof R.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),L.fpsDroppedMonitoringPeriod)}},w.checkFPS=function(k,S,L){var R=performance.now();if(S){if(this.lastTime){var O=R-this.lastTime,C=L-this.lastDroppedFrames,y=S-this.lastDecodedFrames,u=1e3*C/O,l=this.hls;if(l.trigger(N.Events.FPS_DROP,{currentDropped:C,currentDecoded:y,totalDroppedFrames:L}),u>0&&C>l.config.fpsDroppedMonitoringThreshold*y){var c=l.currentLevel;x.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(l.autoLevelCapping===-1||l.autoLevelCapping>=c)&&(c=c-1,l.trigger(N.Events.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:l.currentLevel}),l.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=R,this.lastDroppedFrames=L,this.lastDecodedFrames=S}},w.checkFPSInterval=function(){var k=this.media;if(k)if(this.isVideoPlaybackQualityAvailable){var S=k.getVideoPlaybackQuality();this.checkFPS(k,S.totalVideoFrames,S.droppedVideoFrames)}else this.checkFPS(k,k.webkitDecodedFrameCount,k.webkitDroppedFrameCount)},K}();const M=F},"./src/controller/fragment-finders.ts":(b,D,m)=>{m.r(D),m.d(D,{findFragWithCC:()=>I,findFragmentByPDT:()=>F,findFragmentByPTS:()=>M,fragmentWithinToleranceTest:()=>K,pdtWithinToleranceTest:()=>w});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/binary-search.ts");function F(k,S,L){if(S===null||!Array.isArray(k)||!k.length||!(0,N.isFiniteNumber)(S))return null;var R=k[0].programDateTime;if(S<(R||0))return null;var O=k[k.length-1].endProgramDateTime;if(S>=(O||0))return null;L=L||0;for(var C=0;C<k.length;++C){var y=k[C];if(w(S,L,y))return y}return null}function M(k,S,L,R){L===void 0&&(L=0),R===void 0&&(R=0);var O=null;if(k?O=S[k.sn-S[0].sn+1]||null:L===0&&S[0].start===0&&(O=S[0]),O&&K(L,R,O)===0)return O;var C=x.default.search(S,K.bind(null,L,R));return C||O}function K(k,S,L){k===void 0&&(k=0),S===void 0&&(S=0);var R=Math.min(S,L.duration+(L.deltaPTS?L.deltaPTS:0));return L.start+L.duration-R<=k?1:L.start-R>k&&L.start?-1:0}function w(k,S,L){var R=Math.min(S,L.duration+(L.deltaPTS?L.deltaPTS:0))*1e3,O=L.endProgramDateTime||0;return O-R>k}function I(k,S){return x.default.search(k,function(L){return L.cc<S?1:L.cc>S?-1:0})}},"./src/controller/fragment-tracker.ts":(b,D,m)=>{m.r(D),m.d(D,{FragmentState:()=>F,FragmentTracker:()=>M});var N=m("./src/events.ts"),x=m("./src/types/loader.ts"),F;(function(I){I.NOT_LOADED="NOT_LOADED",I.APPENDING="APPENDING",I.PARTIAL="PARTIAL",I.OK="OK"})(F||(F={}));var M=function(){function I(S){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=S,this._registerListeners()}var k=I.prototype;return k._registerListeners=function(){var L=this.hls;L.on(N.Events.BUFFER_APPENDED,this.onBufferAppended,this),L.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),L.on(N.Events.FRAG_LOADED,this.onFragLoaded,this)},k._unregisterListeners=function(){var L=this.hls;L.off(N.Events.BUFFER_APPENDED,this.onBufferAppended,this),L.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),L.off(N.Events.FRAG_LOADED,this.onFragLoaded,this)},k.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},k.getAppendedFrag=function(L,R){if(R===x.PlaylistLevelType.MAIN){var O=this.activeFragment,C=this.activeParts;if(!O)return null;if(C)for(var y=C.length;y--;){var u=C[y],l=u?u.end:O.appendedPTS;if(u.start<=L&&l!==void 0&&L<=l)return y>9&&(this.activeParts=C.slice(y-9)),u}else if(O.start<=L&&O.appendedPTS!==void 0&&L<=O.appendedPTS)return O}return this.getBufferedFrag(L,R)},k.getBufferedFrag=function(L,R){for(var O=this.fragments,C=Object.keys(O),y=C.length;y--;){var u=O[C[y]];if((u==null?void 0:u.body.type)===R&&u.buffered){var l=u.body;if(l.start<=L&&L<=l.end)return l}}return null},k.detectEvictedFragments=function(L,R,O){var C=this;Object.keys(this.fragments).forEach(function(y){var u=C.fragments[y];if(u){if(!u.buffered){u.body.type===O&&C.removeFragment(u.body);return}var l=u.range[L];l&&l.time.some(function(c){var d=!C.isTimeBuffered(c.startPTS,c.endPTS,R);return d&&C.removeFragment(u.body),d})}})},k.detectPartialFragments=function(L){var R=this,O=this.timeRanges,C=L.frag,y=L.part;if(!(!O||C.sn==="initSegment")){var u=w(C),l=this.fragments[u];l&&(Object.keys(O).forEach(function(c){var d=C.elementaryStreams[c];if(d){var o=O[c],a=y!==null||d.partial===!0;l.range[c]=R.getBufferedTimes(C,y,a,o)}}),l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},k.fragBuffered=function(L){var R=w(L),O=this.fragments[R];O&&(O.loaded=null,O.buffered=!0)},k.getBufferedTimes=function(L,R,O,C){for(var y={time:[],partial:O},u=R?R.start:L.start,l=R?R.end:L.end,c=L.minEndPTS||l,d=L.maxStartPTS||u,o=0;o<C.length;o++){var a=C.start(o)-this.bufferPadding,s=C.end(o)+this.bufferPadding;if(d>=a&&c<=s){y.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});break}else if(u<s&&l>a)y.partial=!0,y.time.push({startPTS:Math.max(u,C.start(o)),endPTS:Math.min(l,C.end(o))});else if(l<=a)break}return y},k.getPartialFragment=function(L){var R=null,O,C,y,u=0,l=this.bufferPadding,c=this.fragments;return Object.keys(c).forEach(function(d){var o=c[d];o&&K(o)&&(C=o.body.start-l,y=o.body.end+l,L>=C&&L<=y&&(O=Math.min(L-C,y-L),u<=O&&(R=o.body,u=O)))}),R},k.getState=function(L){var R=w(L),O=this.fragments[R];return O?O.buffered?K(O)?F.PARTIAL:F.OK:F.APPENDING:F.NOT_LOADED},k.isTimeBuffered=function(L,R,O){for(var C,y,u=0;u<O.length;u++){if(C=O.start(u)-this.bufferPadding,y=O.end(u)+this.bufferPadding,L>=C&&R<=y)return!0;if(R<=C)return!1}return!1},k.onFragLoaded=function(L,R){var O=R.frag,C=R.part;if(!(O.sn==="initSegment"||O.bitrateTest||C)){var y=w(O);this.fragments[y]={body:O,loaded:R,buffered:!1,range:Object.create(null)}}},k.onBufferAppended=function(L,R){var O=this,C=R.frag,y=R.part,u=R.timeRanges;if(C.type===x.PlaylistLevelType.MAIN)if(this.activeFragment=C,y){var l=this.activeParts;l||(this.activeParts=l=[]),l.push(y)}else this.activeParts=null;this.timeRanges=u,Object.keys(u).forEach(function(c){var d=u[c];if(O.detectEvictedFragments(c,d),!y)for(var o=0;o<d.length;o++)C.appendedPTS=Math.max(d.end(o),C.appendedPTS||0)})},k.onFragBuffered=function(L,R){this.detectPartialFragments(R)},k.hasFragment=function(L){var R=w(L);return!!this.fragments[R]},k.removeFragmentsInRange=function(L,R,O){var C=this;Object.keys(this.fragments).forEach(function(y){var u=C.fragments[y];if(u&&u.buffered){var l=u.body;l.type===O&&l.start<R&&l.end>L&&C.removeFragment(l)}})},k.removeFragment=function(L){var R=w(L);L.stats.loaded=0,L.clearElementaryStreamInfo(),delete this.fragments[R]},k.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},I}();function K(I){var k,S;return I.buffered&&(((k=I.range.video)===null||k===void 0?void 0:k.partial)||((S=I.range.audio)===null||S===void 0?void 0:S.partial))}function w(I){return I.type+"_"+I.level+"_"+I.urlId+"_"+I.sn}},"./src/controller/gap-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{MAX_START_GAP_JUMP:()=>w,SKIP_BUFFER_HOLE_STEP_SECONDS:()=>I,SKIP_BUFFER_RANGE_START:()=>k,STALL_MINIMUM_DURATION_MS:()=>K,default:()=>S});var N=m("./src/utils/buffer-helper.ts"),x=m("./src/errors.ts"),F=m("./src/events.ts"),M=m("./src/utils/logger.ts"),K=250,w=2,I=.1,k=.05,S=function(){function L(O,C,y,u){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=O,this.media=C,this.fragmentTracker=y,this.hls=u}var R=L.prototype;return R.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},R.poll=function(C,y){var u=this.config,l=this.media,c=this.stalled;if(l!==null){var d=l.currentTime,o=l.seeking,a=this.seeking&&!o,s=!this.seeking&&o;if(this.seeking=o,d!==C){if(this.moved=!0,c!==null){if(this.stallReported){var h=self.performance.now()-c;M.logger.warn("playback not stuck anymore @"+d+", after "+Math.round(h)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((s||a)&&(this.stalled=null),!(l.paused&&!o||l.ended||l.playbackRate===0||!N.BufferHelper.getBuffered(l).length)){var p=N.BufferHelper.bufferInfo(l,d,0),_=p.len>0,v=p.nextStart||0;if(!(!_&&!v)){if(o){var A=p.len>w,E=!v||y&&y.start<=d||v-d>w&&!this.fragmentTracker.getPartialFragment(d);if(A||E)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var g,T=Math.max(v,p.start||0)-d,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,B=P==null||(g=P.details)===null||g===void 0?void 0:g.live,V=B?P.details.targetduration*2:w;if(T>0&&T<=V){this._trySkipBufferHole(null);return}}var W=self.performance.now();if(c===null){this.stalled=W;return}var j=W-c;if(!(!o&&j>=K&&(this._reportStall(p),!this.media))){var z=N.BufferHelper.bufferInfo(l,d,u.maxBufferHole);this._tryFixBufferStall(z,j)}}}}},R._tryFixBufferStall=function(C,y){var u=this.config,l=this.fragmentTracker,c=this.media;if(c!==null){var d=c.currentTime,o=l.getPartialFragment(d);if(o){var a=this._trySkipBufferHole(o);if(a||!this.media)return}C.len>u.maxBufferHole&&y>u.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},R._reportStall=function(C){var y=this.hls,u=this.media,l=this.stallReported;!l&&u&&(this.stallReported=!0,M.logger.warn("Playback stalling at @"+u.currentTime+" due to low buffer ("+JSON.stringify(C)+")"),y.trigger(F.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:C.len}))},R._trySkipBufferHole=function(C){var y=this.config,u=this.hls,l=this.media;if(l===null)return 0;for(var c=l.currentTime,d=0,o=N.BufferHelper.getBuffered(l),a=0;a<o.length;a++){var s=o.start(a);if(c+y.maxBufferHole>=d&&c<s){var h=Math.max(s+k,l.currentTime+I);return M.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+h),this.moved=!0,this.stalled=null,l.currentTime=h,C&&u.trigger(F.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+h,frag:C}),h}d=o.end(a)}return 0},R._tryNudgeBuffer=function(){var C=this.config,y=this.hls,u=this.media,l=this.nudgeRetry;if(u!==null){var c=u.currentTime;if(this.nudgeRetry++,l<C.nudgeMaxRetry){var d=c+(l+1)*C.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+c+" to "+d),u.currentTime=d,y.trigger(F.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+C.nudgeMaxRetry+" nudges"),y.trigger(F.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},L}()},"./src/controller/id3-track-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>C});var N=m("./src/polyfills/number.ts"),x=m("./src/events.ts"),F=m("./src/utils/texttrack-utils.ts"),M=m("./src/demux/id3.ts"),K=m("./src/loader/date-range.ts"),w=m("./src/types/demuxer.ts"),I=.25;function k(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var S=function(){var y=k();try{new y(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function L(y,u){return y.getTime()/1e3-u}function R(y){return Uint8Array.from(y.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var O=function(){function y(l){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=l,this._registerListeners()}var u=y.prototype;return u.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},u._registerListeners=function(){var c=this.hls;c.on(x.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(x.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.on(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.on(x.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u._unregisterListeners=function(){var c=this.hls;c.off(x.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(x.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),c.off(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),c.off(x.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},u.onMediaAttached=function(c,d){this.media=d.media},u.onMediaDetaching=function(){this.id3Track&&((0,F.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},u.onManifestLoading=function(){this.dateRangeCuesAppended={}},u.createTrack=function(c){var d=this.getID3Track(c.textTracks);return d.mode="hidden",d},u.getID3Track=function(c){if(this.media){for(var d=0;d<c.length;d++){var o=c[d];if(o.kind==="metadata"&&o.label==="id3")return(0,F.sendAddTrackEvent)(o,this.media),o}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(c,d){if(this.media){var o=this.hls.config,a=o.enableEmsgMetadataCues,s=o.enableID3MetadataCues;if(!(!a&&!s)){d.frag;var h=d.samples;d.details,this.id3Track||(this.id3Track=this.createTrack(this.media));for(var p=k(),_=0;_<h.length;_++){var v=h[_].type;if(!(v===w.MetadataSchema.emsg&&!a||!s)){var A=M.getID3Frames(h[_].data);if(A){var E=h[_].pts,g=E+h[_].duration;g>S&&(g=S);var T=g-E;T<=0&&(g=E+I);for(var P=0;P<A.length;P++){var B=A[P];if(!M.isTimeStampFrame(B)){this.updateId3CueEnds(E);var V=new p(E,g,"");V.value=B,v&&(V.type=v),this.id3Track.addCue(V)}}}}}}}},u.updateId3CueEnds=function(c){var d,o=(d=this.id3Track)===null||d===void 0?void 0:d.cues;if(o)for(var a=o.length;a--;){var s=o[a];s.startTime<c&&s.endTime===S&&(s.endTime=c)}},u.onBufferFlushing=function(c,d){var o=d.startOffset,a=d.endOffset,s=d.type,h=this.id3Track,p=this.hls;if(p){var _=p.config,v=_.enableEmsgMetadataCues,A=_.enableID3MetadataCues;if(h&&(v||A)){var E;s==="audio"?E=function(T){return T.type===w.MetadataSchema.audioId3&&A}:s==="video"?E=function(T){return T.type===w.MetadataSchema.emsg&&v}:E=function(T){return T.type===w.MetadataSchema.audioId3&&A||T.type===w.MetadataSchema.emsg&&v},(0,F.removeCuesInRange)(h,o,a,E)}}},u.onLevelUpdated=function(c,d){var o=this,a=d.details;if(!(!this.media||!a.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var s=this.dateRangeCuesAppended,h=this.id3Track,p=a.dateRanges,_=Object.keys(p);if(h)for(var v=Object.keys(s).filter(function(W){return!_.includes(W)}),A=function(j){var z=v[j];Object.keys(s[z].cues).forEach(function(Q){h.removeCue(s[z].cues[Q])}),delete s[z]},E=v.length;E--;)A(E);var g=a.fragments[a.fragments.length-1];if(!(_.length===0||!(0,N.isFiniteNumber)(g==null?void 0:g.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var T=g.programDateTime/1e3-g.start,P=k(),B=function(j){var z=_[j],Q=p[z],Z=s[z],ee=(Z==null?void 0:Z.cues)||{},ae=(Z==null?void 0:Z.durationKnown)||!1,se=L(Q.startDate,T),Y=S,X=Q.endDate;if(X)Y=L(X,T),ae=!0;else if(Q.endOnNext&&!ae){var q=_.reduce(function(J,te){var ie=p[te];return ie.class===Q.class&&ie.id!==te&&ie.startDate>Q.startDate&&J.push(ie),J},[]).sort(function(J,te){return J.startDate.getTime()-te.startDate.getTime()})[0];q&&(Y=L(q.startDate,T),ae=!0)}for(var re=Object.keys(Q.attr),ne=0;ne<re.length;ne++){var U=re[ne];if(!(U===K.DateRangeAttribute.ID||U===K.DateRangeAttribute.CLASS||U===K.DateRangeAttribute.START_DATE||U===K.DateRangeAttribute.DURATION||U===K.DateRangeAttribute.END_DATE||U===K.DateRangeAttribute.END_ON_NEXT)){var H=ee[U];if(H)ae&&!Z.durationKnown&&(H.endTime=Y);else{var $=Q.attr[U];H=new P(se,Y,""),(U===K.DateRangeAttribute.SCTE35_OUT||U===K.DateRangeAttribute.SCTE35_IN)&&($=R($)),H.value={key:U,data:$},H.type=w.MetadataSchema.dateRange,o.id3Track.addCue(H),ee[U]=H}}}s[z]={cues:ee,dateRange:Q,durationKnown:ae}},V=0;V<_.length;V++)B(V)}}},y}();const C=O},"./src/controller/latency-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>w});var N=m("./src/errors.ts"),x=m("./src/events.ts"),F=m("./src/utils/logger.ts");function M(I,k){for(var S=0;S<k.length;S++){var L=k[S];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(I,L.key,L)}}function K(I,k,S){return k&&M(I.prototype,k),S&&M(I,S),Object.defineProperty(I,"prototype",{writable:!1}),I}var w=function(){function I(S){var L=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return L.timeupdate()},this.hls=S,this.config=S.config,this.registerListeners()}var k=I.prototype;return k.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},k.registerListeners=function(){this.hls.on(x.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(x.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(x.Events.ERROR,this.onError,this)},k.unregisterListeners=function(){this.hls.off(x.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(x.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(x.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(x.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(x.Events.ERROR,this.onError)},k.onMediaAttached=function(L,R){this.media=R.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},k.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},k.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},k.onLevelUpdated=function(L,R){var O=R.details;this.levelDetails=O,O.advanced&&this.timeupdate(),!O.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},k.onError=function(L,R){R.details===N.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,F.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},k.timeupdate=function(){var L=this.media,R=this.levelDetails;if(!(!L||!R)){this.currentTime=L.currentTime;var O=this.computeLatency();if(O!==null){this._latency=O;var C=this.config,y=C.lowLatencyMode,u=C.maxLiveSyncPlaybackRate;if(!(!y||u===1)){var l=this.targetLatency;if(l!==null){var c=O-l,d=Math.min(this.maxLatency,l+R.targetduration),o=c<d;if(R.live&&o&&c>.05&&this.forwardBufferLength>1){var a=Math.min(2,Math.max(1,u)),s=Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20;L.playbackRate=Math.min(a,Math.max(1,s))}else L.playbackRate!==1&&L.playbackRate!==0&&(L.playbackRate=1)}}}}},k.estimateLiveEdge=function(){var L=this.levelDetails;return L===null?null:L.edge+L.age},k.computeLatency=function(){var L=this.estimateLiveEdge();return L===null?null:L-this.currentTime},K(I,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var L=this.config,R=this.levelDetails;return L.liveMaxLatencyDuration!==void 0?L.liveMaxLatencyDuration:R?L.liveMaxLatencyDurationCount*R.targetduration:0}},{key:"targetLatency",get:function(){var L=this.levelDetails;if(L===null)return null;var R=L.holdBack,O=L.partHoldBack,C=L.targetduration,y=this.config,u=y.liveSyncDuration,l=y.liveSyncDurationCount,c=y.lowLatencyMode,d=this.hls.userConfig,o=c&&O||R;(d.liveSyncDuration||d.liveSyncDurationCount||o===0)&&(o=u!==void 0?u:l*C);var a=C,s=1;return o+Math.min(this.stallCount*s,a)}},{key:"liveSyncPosition",get:function(){var L=this.estimateLiveEdge(),R=this.targetLatency,O=this.levelDetails;if(L===null||R===null||O===null)return null;var C=O.edge,y=L-R-this.edgeStalled,u=C-O.totalduration,l=C-(this.config.lowLatencyMode&&O.partTarget||O.targetduration);return Math.min(Math.max(u,y),l)}},{key:"drift",get:function(){var L=this.levelDetails;return L===null?1:L.drift}},{key:"edgeStalled",get:function(){var L=this.levelDetails;if(L===null)return 0;var R=(this.config.lowLatencyMode&&L.partTarget||L.targetduration)*3;return Math.max(L.age-R,0)}},{key:"forwardBufferLength",get:function(){var L=this.media,R=this.levelDetails;if(!L||!R)return 0;var O=L.buffered.length;return(O?L.buffered.end(O-1):R.edge)-this.currentTime}}]),I}()},"./src/controller/level-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>y});var N=m("./src/types/level.ts"),x=m("./src/events.ts"),F=m("./src/errors.ts"),M=m("./src/utils/codecs.ts"),K=m("./src/controller/level-helper.ts"),w=m("./src/controller/base-playlist-controller.ts"),I=m("./src/types/loader.ts");function k(){return k=Object.assign?Object.assign.bind():function(u){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(u[d]=c[d])}return u},k.apply(this,arguments)}function S(u,l){for(var c=0;c<l.length;c++){var d=l[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}function L(u,l,c){return l&&S(u.prototype,l),c&&S(u,c),Object.defineProperty(u,"prototype",{writable:!1}),u}function R(u,l){u.prototype=Object.create(l.prototype),u.prototype.constructor=u,O(u,l)}function O(u,l){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,o){return d.__proto__=o,d},O(u,l)}var C=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),y=function(u){R(l,u);function l(d){var o;return o=u.call(this,d,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var c=l.prototype;return c._registerListeners=function(){var o=this.hls;o.on(x.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(x.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(x.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(x.Events.ERROR,this.onError,this)},c._unregisterListeners=function(){var o=this.hls;o.off(x.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(x.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(x.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(x.Events.ERROR,this.onError,this)},c.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,u.prototype.destroy.call(this)},c.startLoad=function(){var o=this._levels;o.forEach(function(a){a.loadError=0}),u.prototype.startLoad.call(this)},c.onManifestLoaded=function(o,a){var s=[],h=[],p=[],_,v={},A,E=!1,g=!1,T=!1;if(a.levels.forEach(function(W){var j=W.attrs;E=E||!!(W.width&&W.height),g=g||!!W.videoCodec,T=T||!!W.audioCodec,C&&W.audioCodec&&W.audioCodec.indexOf("mp4a.40.34")!==-1&&(W.audioCodec=void 0);var z=W.bitrate+"-"+W.attrs.RESOLUTION+"-"+W.attrs.CODECS;A=v[z],A?A.url.push(W.url):(A=new N.Level(W),v[z]=A,s.push(A)),j&&(j.AUDIO&&(0,K.addGroupId)(A,"audio",j.AUDIO),j.SUBTITLES&&(0,K.addGroupId)(A,"text",j.SUBTITLES))}),(E||g)&&T&&(s=s.filter(function(W){var j=W.videoCodec,z=W.width,Q=W.height;return!!j||!!(z&&Q)})),s=s.filter(function(W){var j=W.audioCodec,z=W.videoCodec;return(!j||(0,M.isCodecSupportedInMp4)(j,"audio"))&&(!z||(0,M.isCodecSupportedInMp4)(z,"video"))}),a.audioTracks&&(h=a.audioTracks.filter(function(W){return!W.audioCodec||(0,M.isCodecSupportedInMp4)(W.audioCodec,"audio")}),(0,K.assignTrackIdsByGroup)(h)),a.subtitles&&(p=a.subtitles,(0,K.assignTrackIdsByGroup)(p)),s.length>0){_=s[0].bitrate,s.sort(function(W,j){return W.bitrate-j.bitrate}),this._levels=s;for(var P=0;P<s.length;P++)if(s[P].bitrate===_){this._firstLevel=P,this.log("manifest loaded, "+s.length+" level(s) found, first bitrate: "+_);break}var B=T&&!g,V={levels:s,audioTracks:h,subtitleTracks:p,firstLevel:this._firstLevel,stats:a.stats,audio:T,video:g,altAudio:!B&&h.some(function(W){return!!W.url})};this.hls.trigger(x.Events.MANIFEST_PARSED,V),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(x.Events.ERROR,{type:F.ErrorTypes.MEDIA_ERROR,details:F.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:a.url,reason:"no level with compatible codecs found in manifest"})},c.onError=function(o,a){var s;if(u.prototype.onError.call(this,o,a),!a.fatal){var h=a.context,p=this._levels[this.currentLevelIndex];if(h&&(h.type===I.PlaylistContextType.AUDIO_TRACK&&p.audioGroupIds&&h.groupId===p.audioGroupIds[p.urlId]||h.type===I.PlaylistContextType.SUBTITLE_TRACK&&p.textGroupIds&&h.groupId===p.textGroupIds[p.urlId])){this.redundantFailover(this.currentLevelIndex);return}var _=!1,v=!0,A;switch(a.details){case F.ErrorDetails.FRAG_LOAD_ERROR:case F.ErrorDetails.FRAG_LOAD_TIMEOUT:case F.ErrorDetails.KEY_LOAD_ERROR:case F.ErrorDetails.KEY_LOAD_TIMEOUT:if(a.frag){var E=a.frag.type===I.PlaylistLevelType.MAIN?a.frag.level:this.currentLevelIndex,g=this._levels[E];g?(g.fragmentError++,g.fragmentError>this.hls.config.fragLoadingMaxRetry&&(A=E)):A=E}break;case F.ErrorDetails.LEVEL_LOAD_ERROR:case F.ErrorDetails.LEVEL_LOAD_TIMEOUT:h&&(h.deliveryDirectives&&(v=!1),A=h.level),_=!0;break;case F.ErrorDetails.REMUX_ALLOC_ERROR:A=(s=a.level)!=null?s:this.currentLevelIndex,_=!0;break}A!==void 0&&this.recoverLevel(a,A,_,v)}},c.recoverLevel=function(o,a,s,h){var p=o.details,_=this._levels[a];if(_.loadError++,s){var v=this.retryLoadingOrFail(o);if(v)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(h){var A=_.url.length;if(A>1&&_.loadError<A)o.levelRetry=!0,this.redundantFailover(a);else if(this.manualLevelIndex===-1){for(var E=-1,g=this._levels,T=g.length;T--;){var P=(T+this.currentLevelIndex)%g.length;if(P!==this.currentLevelIndex&&g[P].loadError===0){E=P;break}}E>-1&&this.currentLevelIndex!==E&&(this.warn(p+": switch to "+E),o.levelRetry=!0,this.hls.nextAutoLevel=E)}}},c.redundantFailover=function(o){var a=this._levels[o],s=a.url.length;if(s>1){var h=(a.urlId+1)%s;this.warn("Switching to redundant URL-id "+h),this._levels.forEach(function(p){p.urlId=h}),this.level=o}},c.onFragLoaded=function(o,a){var s=a.frag;if(s!==void 0&&s.type===I.PlaylistLevelType.MAIN){var h=this._levels[s.level];h!==void 0&&(h.fragmentError=0,h.loadError=0)}},c.onLevelLoaded=function(o,a){var s,h=a.level,p=a.details,_=this._levels[h];if(!_){var v;this.warn("Invalid level index "+h),(v=a.deliveryDirectives)!==null&&v!==void 0&&v.skip&&(p.deltaUpdateFailed=!0);return}h===this.currentLevelIndex?(_.fragmentError===0&&(_.loadError=0,this.retryCount=0),this.playlistLoaded(h,a,_.details)):(s=a.deliveryDirectives)!==null&&s!==void 0&&s.skip&&(p.deltaUpdateFailed=!0)},c.onAudioTrackSwitched=function(o,a){var s=this.hls.levels[this.currentLevelIndex];if(s&&s.audioGroupIds){for(var h=-1,p=this.hls.audioTracks[a.id].groupId,_=0;_<s.audioGroupIds.length;_++)if(s.audioGroupIds[_]===p){h=_;break}h!==s.urlId&&(s.urlId=h,this.startLoad())}},c.loadPlaylist=function(o){var a=this.currentLevelIndex,s=this._levels[a];if(this.canLoad&&s&&s.url.length>0){var h=s.urlId,p=s.url[h];if(o)try{p=o.addDirectives(p)}catch(_){this.warn("Could not construct new URL with HLS Delivery Directives: "+_)}this.log("Attempt loading level index "+a+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+h+" "+p),this.clearTimer(),this.hls.trigger(x.Events.LEVEL_LOADING,{url:p,level:a,id:h,deliveryDirectives:o||null})}},c.removeLevel=function(o,a){var s=function(_,v){return v!==a},h=this._levels.filter(function(p,_){return _!==o?!0:p.url.length>1&&a!==void 0?(p.url=p.url.filter(s),p.audioGroupIds&&(p.audioGroupIds=p.audioGroupIds.filter(s)),p.textGroupIds&&(p.textGroupIds=p.textGroupIds.filter(s)),p.urlId=0,!0):!1}).map(function(p,_){var v=p.details;return v!=null&&v.fragments&&v.fragments.forEach(function(A){A.level=_}),p});this._levels=h,this.hls.trigger(x.Events.LEVELS_UPDATED,{levels:h})},L(l,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var a,s=this._levels;if(s.length!==0&&!(this.currentLevelIndex===o&&(a=s[o])!==null&&a!==void 0&&a.details)){if(o<0||o>=s.length){var h=o<0;if(this.hls.trigger(x.Events.ERROR,{type:F.ErrorTypes.OTHER_ERROR,details:F.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:h,reason:"invalid level idx"}),h)return;o=Math.min(o,s.length-1)}this.clearTimer();var p=this.currentLevelIndex,_=s[p],v=s[o];this.log("switching to level "+o+" from "+p),this.currentLevelIndex=o;var A=k({},v,{level:o,maxBitrate:v.maxBitrate,uri:v.uri,urlId:v.urlId});delete A._urlId,this.hls.trigger(x.Events.LEVEL_SWITCHING,A);var E=v.details;if(!E||E.live){var g=this.switchParams(v.uri,_==null?void 0:_.details);this.loadPlaylist(g)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),l}(w.default)},"./src/controller/level-helper.ts":(b,D,m)=>{m.r(D),m.d(D,{addGroupId:()=>K,addSliding:()=>u,adjustSliding:()=>y,assignTrackIdsByGroup:()=>w,computeReloadInterval:()=>l,getFragmentWithSN:()=>c,getPartWith:()=>d,mapFragmentIntersection:()=>C,mapPartIntersection:()=>O,mergeDetails:()=>L,updateFragPTSDTS:()=>S,updatePTS:()=>I});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/logger.ts"),F=m("./src/loader/date-range.ts");function M(){return M=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(o[h]=s[h])}return o},M.apply(this,arguments)}function K(o,a,s){switch(a){case"audio":o.audioGroupIds||(o.audioGroupIds=[]),o.audioGroupIds.push(s);break;case"text":o.textGroupIds||(o.textGroupIds=[]),o.textGroupIds.push(s);break}}function w(o){var a={};o.forEach(function(s){var h=s.groupId||"";s.id=a[h]=a[h]||0,a[h]++})}function I(o,a,s){var h=o[a],p=o[s];k(h,p)}function k(o,a){var s=a.startPTS;if((0,N.isFiniteNumber)(s)){var h=0,p;a.sn>o.sn?(h=s-o.start,p=o):(h=o.start-s,p=a),p.duration!==h&&(p.duration=h)}else if(a.sn>o.sn){var _=o.cc===a.cc;_&&o.minEndPTS?a.start=o.start+(o.minEndPTS-o.start):a.start=o.start+o.duration}else a.start=Math.max(o.start-a.duration,0)}function S(o,a,s,h,p,_){var v=h-s;v<=0&&(x.logger.warn("Fragment should have a positive duration",a),h=s+a.duration,_=p+a.duration);var A=s,E=h,g=a.startPTS,T=a.endPTS;if((0,N.isFiniteNumber)(g)){var P=Math.abs(g-s);(0,N.isFiniteNumber)(a.deltaPTS)?a.deltaPTS=Math.max(P,a.deltaPTS):a.deltaPTS=P,A=Math.max(s,g),s=Math.min(s,g),p=Math.min(p,a.startDTS),E=Math.min(h,T),h=Math.max(h,T),_=Math.max(_,a.endDTS)}a.duration=h-s;var B=s-a.start;a.appendedPTS=h,a.start=a.startPTS=s,a.maxStartPTS=A,a.startDTS=p,a.endPTS=h,a.minEndPTS=E,a.endDTS=_;var V=a.sn;if(!o||V<o.startSN||V>o.endSN)return 0;var W,j=V-o.startSN,z=o.fragments;for(z[j]=a,W=j;W>0;W--)k(z[W],z[W-1]);for(W=j;W<z.length-1;W++)k(z[W],z[W+1]);return o.fragmentHint&&k(z[z.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,B}function L(o,a){for(var s=null,h=o.fragments,p=h.length-1;p>=0;p--){var _=h[p].initSegment;if(_){s=_;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;var v=0,A;if(C(o,a,function(W,j){W.relurl&&(v=W.cc-j.cc),(0,N.isFiniteNumber)(W.startPTS)&&(0,N.isFiniteNumber)(W.endPTS)&&(j.start=j.startPTS=W.startPTS,j.startDTS=W.startDTS,j.appendedPTS=W.appendedPTS,j.maxStartPTS=W.maxStartPTS,j.endPTS=W.endPTS,j.endDTS=W.endDTS,j.minEndPTS=W.minEndPTS,j.duration=W.endPTS-W.startPTS,j.duration&&(A=j),a.PTSKnown=a.alignedSliding=!0),j.elementaryStreams=W.elementaryStreams,j.loader=W.loader,j.stats=W.stats,j.urlId=W.urlId,W.initSegment&&(j.initSegment=W.initSegment,s=W.initSegment)}),s){var E=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;E.forEach(function(W){var j;(!W.initSegment||W.initSegment.relurl===((j=s)===null||j===void 0?void 0:j.relurl))&&(W.initSegment=s)})}if(a.skippedSegments)if(a.deltaUpdateFailed=a.fragments.some(function(W){return!W}),a.deltaUpdateFailed){x.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var g=a.skippedSegments;g--;)a.fragments.shift();a.startSN=a.fragments[0].sn,a.startCC=a.fragments[0].cc}else a.canSkipDateRanges&&(a.dateRanges=R(o.dateRanges,a.dateRanges,a.recentlyRemovedDateranges));var T=a.fragments;if(v){x.logger.warn("discontinuity sliding from playlist, take drift into account");for(var P=0;P<T.length;P++)T[P].cc+=v}a.skippedSegments&&(a.startCC=a.fragments[0].cc),O(o.partList,a.partList,function(W,j){j.elementaryStreams=W.elementaryStreams,j.stats=W.stats}),A?S(a,A,A.startPTS,A.endPTS,A.startDTS,A.endDTS):y(o,a),T.length&&(a.totalduration=a.edge-T[0].start),a.driftStartTime=o.driftStartTime,a.driftStart=o.driftStart;var B=a.advancedDateTime;if(a.advanced&&B){var V=a.edge;a.driftStart||(a.driftStartTime=B,a.driftStart=V),a.driftEndTime=B,a.driftEnd=V}else a.driftEndTime=o.driftEndTime,a.driftEnd=o.driftEnd,a.advancedDateTime=o.advancedDateTime}function R(o,a,s){var h=M({},o);return s&&s.forEach(function(p){delete h[p]}),Object.keys(a).forEach(function(p){var _=new F.DateRange(a[p].attr,h[p]);_.isValid?h[p]=_:x.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(a[p].attr)+'"')}),h}function O(o,a,s){if(o&&a)for(var h=0,p=0,_=o.length;p<=_;p++){var v=o[p],A=a[p+h];v&&A&&v.index===A.index&&v.fragment.sn===A.fragment.sn?s(v,A):h--}}function C(o,a,s){for(var h=a.skippedSegments,p=Math.max(o.startSN,a.startSN)-a.startSN,_=(o.fragmentHint?1:0)+(h?a.endSN:Math.min(o.endSN,a.endSN))-a.startSN,v=a.startSN-o.startSN,A=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments,E=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments,g=p;g<=_;g++){var T=E[v+g],P=A[g];h&&!P&&g<h&&(P=a.fragments[g]=T),T&&P&&s(T,P)}}function y(o,a){var s=a.startSN+a.skippedSegments-o.startSN,h=o.fragments;s<0||s>=h.length||u(a,h[s].start)}function u(o,a){if(a){for(var s=o.fragments,h=o.skippedSegments;h<s.length;h++)s[h].start+=a;o.fragmentHint&&(o.fragmentHint.start+=a)}}function l(o,a){var s=1e3*o.levelTargetDuration,h=s/2,p=o.age,_=p>0&&p<s*3,v=a.loading.end-a.loading.start,A,E=o.availabilityDelay;if(o.updated===!1)if(_){var g=333*o.misses;A=Math.max(Math.min(h,v*2),g),o.availabilityDelay=(o.availabilityDelay||0)+A}else A=h;else _?(E=Math.min(E||s/2,p),o.availabilityDelay=E,A=E+s-p):A=s-v;return Math.round(A)}function c(o,a,s){if(!o||!o.details)return null;var h=o.details,p=h.fragments[a-h.startSN];return p||(p=h.fragmentHint,p&&p.sn===a)?p:a<h.startSN&&s&&s.sn===a?s:null}function d(o,a,s){if(!o||!o.details)return null;var h=o.details.partList;if(h)for(var p=h.length;p--;){var _=h[p];if(_.index===s&&_.fragment.sn===a)return _}return null}},"./src/controller/stream-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>d});var N=m("./src/polyfills/number.ts"),x=m("./src/controller/base-stream-controller.ts"),F=m("./src/is-supported.ts"),M=m("./src/events.ts"),K=m("./src/utils/buffer-helper.ts"),w=m("./src/controller/fragment-tracker.ts"),I=m("./src/types/loader.ts"),k=m("./src/loader/fragment.ts"),S=m("./src/demux/transmuxer-interface.ts"),L=m("./src/types/transmuxer.ts"),R=m("./src/controller/gap-controller.ts"),O=m("./src/errors.ts");function C(o,a){for(var s=0;s<a.length;s++){var h=a[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(o,h.key,h)}}function y(o,a,s){return a&&C(o.prototype,a),s&&C(o,s),Object.defineProperty(o,"prototype",{writable:!1}),o}function u(o,a){o.prototype=Object.create(a.prototype),o.prototype.constructor=o,l(o,a)}function l(o,a){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,p){return h.__proto__=p,h},l(o,a)}var c=100,d=function(o){u(a,o);function a(h,p){var _;return _=o.call(this,h,p,"[stream-controller]")||this,_.audioCodecSwap=!1,_.gapController=null,_.level=-1,_._forceStartLoad=!1,_.altAudio=!1,_.audioOnly=!1,_.fragPlaying=null,_.onvplaying=null,_.onvseeked=null,_.fragLastKbps=0,_.couldBacktrack=!1,_.backtrackFragment=null,_.audioCodecSwitch=!1,_.videoBuffer=null,_._registerListeners(),_}var s=a.prototype;return s._registerListeners=function(){var p=this.hls;p.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),p.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),p.on(M.Events.ERROR,this.onError,this),p.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),p.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),p.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var p=this.hls;p.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),p.off(M.Events.ERROR,this.onError,this),p.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),p.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),p.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),p.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),p.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},s.startLoad=function(p){if(this.levels){var _=this.lastCurrentTime,v=this.hls;if(this.stopLoad(),this.setInterval(c),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var A=v.startLevel;A===-1&&(v.config.testBandwidth&&this.levels.length>1?(A=0,this.bitrateTest=!0):A=v.nextAutoLevel),this.level=v.nextLoadLevel=A,this.loadedmetadata=!1}_>0&&p===-1&&(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),p=_),this.state=x.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=p,this.tick()}else this._forceStartLoad=!0,this.state=x.State.STOPPED},s.stopLoad=function(){this._forceStartLoad=!1,o.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case x.State.IDLE:this.doTickIdle();break;case x.State.WAITING_LEVEL:{var p,_=this.levels,v=this.level,A=_==null||(p=_[v])===null||p===void 0?void 0:p.details;if(A&&(!A.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(A))break;this.state=x.State.IDLE;break}break}case x.State.FRAG_LOADING_WAITING_RETRY:{var E,g=self.performance.now(),T=this.retryDate;(!T||g>=T||(E=this.media)!==null&&E!==void 0&&E.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=x.State.IDLE)}break}this.onTickEnd()},s.onTickEnd=function(){o.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},s.doTickIdle=function(){var p,_,v=this.hls,A=this.levelLastLoaded,E=this.levels,g=this.media,T=v.config,P=v.nextLoadLevel;if(!(A===null||!g&&(this.startFragRequested||!T.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!E||!E[P])){var B=E[P];this.level=v.nextLoadLevel=P;var V=B.details;if(!V||this.state===x.State.WAITING_LEVEL||V.live&&this.levelLastLoaded!==P){this.state=x.State.WAITING_LEVEL;return}var W=this.getMainFwdBufferInfo();if(W!==null){var j=W.len,z=this.getMaxBufferLength(B.maxBitrate);if(!(j>=z)){if(this._streamEnded(W,V)){var Q={};this.altAudio&&(Q.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,Q),this.state=x.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>W.end&&(this.backtrackFragment=null);var Z=this.backtrackFragment?this.backtrackFragment.start:W.end,ee=this.getNextFragment(Z,V);if(this.couldBacktrack&&!this.fragPrevious&&ee&&ee.sn!=="initSegment"&&this.fragmentTracker.getState(ee)!==w.FragmentState.OK){var ae,se=((ae=this.backtrackFragment)!=null?ae:ee).sn,Y=se-V.startSN,X=V.fragments[Y-1];X&&ee.cc===X.cc&&(ee=X,this.fragmentTracker.removeFragment(X))}else this.backtrackFragment&&W.len&&(this.backtrackFragment=null);if(ee&&this.fragmentTracker.getState(ee)===w.FragmentState.OK&&this.nextLoadPosition>Z){var q=this.audioOnly&&!this.altAudio?k.ElementaryStreamTypes.AUDIO:k.ElementaryStreamTypes.VIDEO;g&&this.afterBufferFlushed(g,q,I.PlaylistLevelType.MAIN),ee=this.getNextFragment(this.nextLoadPosition,V)}ee&&(ee.initSegment&&!ee.initSegment.data&&!this.bitrateTest&&(ee=ee.initSegment),((p=ee.decryptdata)===null||p===void 0?void 0:p.keyFormat)==="identity"&&!((_=ee.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(ee,V):this.loadFragment(ee,V,Z))}}}},s.loadFragment=function(p,_,v){var A,E=this.fragmentTracker.getState(p);this.fragCurrent=p,E===w.FragmentState.NOT_LOADED?p.sn==="initSegment"?this._loadInitSegment(p):this.bitrateTest?(this.log("Fragment "+p.sn+" of level "+p.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(p)):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,p,_,v)):E===w.FragmentState.APPENDING?this.reduceMaxBufferLength(p.duration)&&this.fragmentTracker.removeFragment(p):((A=this.media)===null||A===void 0?void 0:A.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},s.getAppendedFrag=function(p){var _=this.fragmentTracker.getAppendedFrag(p,I.PlaylistLevelType.MAIN);return _&&"fragment"in _?_.fragment:_},s.getBufferedFrag=function(p){return this.fragmentTracker.getBufferedFrag(p,I.PlaylistLevelType.MAIN)},s.followingBufferedFrag=function(p){return p?this.getBufferedFrag(p.end+.5):null},s.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.nextLevelSwitch=function(){var p=this.levels,_=this.media;if(_!=null&&_.readyState){var v,A=this.getAppendedFrag(_.currentTime);if(A&&A.start>1&&this.flushMainBuffer(0,A.start-1),!_.paused&&p){var E=this.hls.nextLoadLevel,g=p[E],T=this.fragLastKbps;T&&this.fragCurrent?v=this.fragCurrent.duration*g.maxBitrate/(1e3*T)+1:v=0}else v=0;var P=this.getBufferedFrag(_.currentTime+v);if(P){var B=this.followingBufferedFrag(P);if(B){this.abortCurrentFrag();var V=B.maxStartPTS?B.maxStartPTS:B.start,W=B.duration,j=Math.max(P.end,V+Math.min(Math.max(W-this.config.maxFragLookUpTolerance,W*.5),W*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},s.abortCurrentFrag=function(){var p=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,p!=null&&p.loader&&p.loader.abort(),this.state){case x.State.KEY_LOADING:case x.State.FRAG_LOADING:case x.State.FRAG_LOADING_WAITING_RETRY:case x.State.PARSING:case x.State.PARSED:this.state=x.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},s.flushMainBuffer=function(p,_){o.prototype.flushMainBuffer.call(this,p,_,this.altAudio?"video":null)},s.onMediaAttached=function(p,_){o.prototype.onMediaAttached.call(this,p,_);var v=_.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),v.addEventListener("playing",this.onvplaying),v.addEventListener("seeked",this.onvseeked),this.gapController=new R.default(this.config,v,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var p=this.media;p&&this.onvplaying&&this.onvseeked&&(p.removeEventListener("playing",this.onvplaying),p.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),o.prototype.onMediaDetaching.call(this)},s.onMediaPlaying=function(){this.tick()},s.onMediaSeeked=function(){var p=this.media,_=p?p.currentTime:null;(0,N.isFiniteNumber)(_)&&this.log("Media seeked to "+_.toFixed(3)),this.tick()},s.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},s.onManifestParsed=function(p,_){var v=!1,A=!1,E;_.levels.forEach(function(g){E=g.audioCodec,E&&(E.indexOf("mp4a.40.2")!==-1&&(v=!0),E.indexOf("mp4a.40.5")!==-1&&(A=!0))}),this.audioCodecSwitch=v&&A&&!(0,F.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=_.levels,this.startFragRequested=!1},s.onLevelLoading=function(p,_){var v=this.levels;if(!(!v||this.state!==x.State.IDLE)){var A=v[_.level];(!A.details||A.details.live&&this.levelLastLoaded!==_.level||this.waitForCdnTuneIn(A.details))&&(this.state=x.State.WAITING_LEVEL)}},s.onLevelLoaded=function(p,_){var v,A=this.levels,E=_.level,g=_.details,T=g.totalduration;if(!A){this.warn("Levels were reset while loading level "+E);return}this.log("Level "+E+" loaded ["+g.startSN+","+g.endSN+"], cc ["+g.startCC+", "+g.endCC+"] duration:"+T);var P=this.fragCurrent;P&&(this.state===x.State.FRAG_LOADING||this.state===x.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==_.level&&P.loader&&(this.state=x.State.IDLE,this.backtrackFragment=null,P.loader.abort());var B=A[E],V=0;if(g.live||(v=B.details)!==null&&v!==void 0&&v.live){if(g.fragments[0]||(g.deltaUpdateFailed=!0),g.deltaUpdateFailed)return;V=this.alignPlaylists(g,B.details)}if(B.details=g,this.levelLastLoaded=E,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:g,level:E}),this.state===x.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(g))return;this.state=x.State.IDLE}this.startFragRequested?g.live&&this.synchronizeToLiveEdge(g):this.setStartPosition(g,V),this.tick()},s._handleFragmentLoadProgress=function(p){var _,v=p.frag,A=p.part,E=p.payload,g=this.levels;if(!g){this.warn("Levels were reset while fragment load was in progress. Fragment "+v.sn+" of level "+v.level+" will not be buffered");return}var T=g[v.level],P=T.details;if(!P){this.warn("Dropping fragment "+v.sn+" of level "+v.level+" after level details were reset");return}var B=T.videoCodec,V=P.PTSKnown||!P.live,W=(_=v.initSegment)===null||_===void 0?void 0:_.data,j=this._getAudioCodec(T),z=this.transmuxer=this.transmuxer||new S.default(this.hls,I.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),Q=A?A.index:-1,Z=Q!==-1,ee=new L.ChunkMetadata(v.level,v.sn,v.stats.chunkCount,E.byteLength,Q,Z),ae=this.initPTS[v.cc];z.push(E,W,j,B,v,A,P.totalduration,V,ee,ae)},s.onAudioTrackSwitching=function(p,_){var v=this.altAudio,A=!!_.url,E=_.id;if(!A){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var g=this.fragCurrent;g!=null&&g.loader&&(this.log("Switching to main audio track, cancel main fragment load"),g.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var T=this.hls;v&&T.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),T.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:E})}},s.onAudioTrackSwitched=function(p,_){var v=_.id,A=!!this.hls.audioTracks[v].url;if(A){var E=this.videoBuffer;E&&this.mediaBuffer!==E&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=E)}this.altAudio=A,this.tick()},s.onBufferCreated=function(p,_){var v=_.tracks,A,E,g=!1;for(var T in v){var P=v[T];if(P.id==="main"){if(E=T,A=P,T==="video"){var B=v[T];B&&(this.videoBuffer=B.buffer)}}else g=!0}g&&A?(this.log("Alternate track found, use "+E+".buffered to schedule main fragment loading"),this.mediaBuffer=A.buffer):this.mediaBuffer=this.media},s.onFragBuffered=function(p,_){var v=_.frag,A=_.part;if(!(v&&v.type!==I.PlaylistLevelType.MAIN)){if(this.fragContextChanged(v)){this.warn("Fragment "+v.sn+(A?" p: "+A.index:"")+" of level "+v.level+" finished buffering, but was aborted. state: "+this.state),this.state===x.State.PARSED&&(this.state=x.State.IDLE);return}var E=A?A.stats:v.stats;this.fragLastKbps=Math.round(8*E.total/(E.buffering.end-E.loading.first)),v.sn!=="initSegment"&&(this.fragPrevious=v),this.fragBufferedComplete(v,A)}},s.onError=function(p,_){switch(_.details){case O.ErrorDetails.FRAG_LOAD_ERROR:case O.ErrorDetails.FRAG_LOAD_TIMEOUT:case O.ErrorDetails.KEY_LOAD_ERROR:case O.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(I.PlaylistLevelType.MAIN,_);break;case O.ErrorDetails.LEVEL_LOAD_ERROR:case O.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==x.State.ERROR&&(_.fatal?(this.warn(""+_.details),this.state=x.State.ERROR):!_.levelRetry&&this.state===x.State.WAITING_LEVEL&&(this.state=x.State.IDLE));break;case O.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="main"&&(this.state===x.State.PARSING||this.state===x.State.PARSED)){var v=!0,A=this.getFwdBufferInfo(this.media,I.PlaylistLevelType.MAIN);A&&A.len>.5&&(v=!this.reduceMaxBufferLength(A.len)),v&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},s.checkBuffer=function(){var p=this.media,_=this.gapController;if(!(!p||!_||!p.readyState)){if(this.loadedmetadata||!K.BufferHelper.getBuffered(p).length){var v=this.state!==x.State.IDLE?this.fragCurrent:null;_.poll(this.lastCurrentTime,v)}this.lastCurrentTime=p.currentTime}},s.onFragLoadEmergencyAborted=function(){this.state=x.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},s.onBufferFlushed=function(p,_){var v=_.type;if(v!==k.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var A=(v===k.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(A,v,I.PlaylistLevelType.MAIN)}},s.onLevelsUpdated=function(p,_){this.levels=_.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s.seekToStartPos=function(){var p=this.media;if(p){var _=p.currentTime,v=this.startPosition;if(v>=0&&_<v){if(p.seeking){this.log("could not seek to "+v+", already seeking at "+_);return}var A=K.BufferHelper.getBuffered(p),E=A.length?A.start(0):0,g=E-v;g>0&&(g<this.config.maxBufferHole||g<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+g+" to match buffer start"),v+=g,this.startPosition=v),this.log("seek to target start position "+v+" from current time "+_),p.currentTime=v}}},s._getAudioCodec=function(p){var _=this.config.defaultAudioCodec||p.audioCodec;return this.audioCodecSwap&&_&&(this.log("Swapping audio codec"),_.indexOf("mp4a.40.5")!==-1?_="mp4a.40.2":_="mp4a.40.5"),_},s._loadBitrateTestFrag=function(p){var _=this;p.bitrateTest=!0,this._doFragLoad(p).then(function(v){var A=_.hls;if(!(!v||A.nextLoadLevel||_.fragContextChanged(p))){_.fragLoadError=0,_.state=x.State.IDLE,_.startFragRequested=!1,_.bitrateTest=!1;var E=p.stats;E.parsing.start=E.parsing.end=E.buffering.start=E.buffering.end=self.performance.now(),A.trigger(M.Events.FRAG_LOADED,v),p.bitrateTest=!1}})},s._handleTransmuxComplete=function(p){var _,v="main",A=this.hls,E=p.remuxResult,g=p.chunkMeta,T=this.getCurrentContext(g);if(!T){this.warn("The loading context changed while buffering fragment "+g.sn+" of level "+g.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(g.level);return}var P=T.frag,B=T.part,V=T.level,W=E.video,j=E.text,z=E.id3,Q=E.initSegment,Z=V.details,ee=this.altAudio?void 0:E.audio;if(!this.fragContextChanged(P)){if(this.state=x.State.PARSING,Q){Q.tracks&&(this._bufferInitSegment(V,Q.tracks,P,g),A.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:v,tracks:Q.tracks}));var ae=Q.initPTS,se=Q.timescale;(0,N.isFiniteNumber)(ae)&&(this.initPTS[P.cc]=ae,A.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:v,initPTS:ae,timescale:se}))}if(W&&E.independent!==!1){if(Z){var Y=W.startPTS,X=W.endPTS,q=W.startDTS,re=W.endDTS;if(B)B.elementaryStreams[W.type]={startPTS:Y,endPTS:X,startDTS:q,endDTS:re};else if(W.firstKeyFrame&&W.independent&&(this.couldBacktrack=!0),W.dropped&&W.independent){var ne=this.getMainFwdBufferInfo(),U=(ne?ne.end:this.getLoadPosition())+this.config.maxBufferHole,H=W.firstKeyFramePTS?W.firstKeyFramePTS:Y;if(U<H-this.config.maxBufferHole){this.backtrack(P);return}P.setElementaryStreamInfo(W.type,P.start,X,P.start,re,!0)}P.setElementaryStreamInfo(W.type,Y,X,q,re),this.backtrackFragment&&(this.backtrackFragment=P),this.bufferFragmentData(W,P,B,g)}}else if(E.independent===!1){this.backtrack(P);return}if(ee){var $=ee.startPTS,J=ee.endPTS,te=ee.startDTS,ie=ee.endDTS;B&&(B.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:$,endPTS:J,startDTS:te,endDTS:ie}),P.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,$,J,te,ie),this.bufferFragmentData(ee,P,B,g)}if(Z&&z!==null&&z!==void 0&&(_=z.samples)!==null&&_!==void 0&&_.length){var le={id:v,frag:P,details:Z,samples:z.samples};A.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(Z&&j){var oe={id:v,frag:P,details:Z,samples:j.samples};A.trigger(M.Events.FRAG_PARSING_USERDATA,oe)}}},s._bufferInitSegment=function(p,_,v,A){var E=this;if(this.state===x.State.PARSING){this.audioOnly=!!_.audio&&!_.video,this.altAudio&&!this.audioOnly&&delete _.audio;var g=_.audio,T=_.video,P=_.audiovideo;if(g){var B=p.audioCodec,V=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),g.metadata.channelCount!==1&&V.indexOf("firefox")===-1&&(B="mp4a.40.5")),V.indexOf("android")!==-1&&g.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),p.audioCodec&&p.audioCodec!==B&&this.log('Swapping manifest audio codec "'+p.audioCodec+'" for "'+B+'"'),g.levelCodec=B,g.id="main",this.log("Init audio buffer, container:"+g.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(p.audioCodec||"")+"/"+g.codec+"]")}T&&(T.levelCodec=p.videoCodec,T.id="main",this.log("Init video buffer, container:"+T.container+", codecs[level/parsed]=["+(p.videoCodec||"")+"/"+T.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(p.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,_),Object.keys(_).forEach(function(W){var j=_[W],z=j.initSegment;z!=null&&z.byteLength&&E.hls.trigger(M.Events.BUFFER_APPENDING,{type:W,data:z,frag:v,part:null,chunkMeta:A,parent:v.type})}),this.tick()}},s.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,I.PlaylistLevelType.MAIN)},s.backtrack=function(p){this.couldBacktrack=!0,this.backtrackFragment=p,this.resetTransmuxer(),this.flushBufferGap(p),this.fragmentTracker.removeFragment(p),this.fragPrevious=null,this.nextLoadPosition=p.start,this.state=x.State.IDLE},s.checkFragmentChanged=function(){var p=this.media,_=null;if(p&&p.readyState>1&&p.seeking===!1){var v=p.currentTime;if(K.BufferHelper.isBuffered(p,v)?_=this.getAppendedFrag(v):K.BufferHelper.isBuffered(p,v+.1)&&(_=this.getAppendedFrag(v+.1)),_){this.backtrackFragment=null;var A=this.fragPlaying,E=_.level;(!A||_.sn!==A.sn||A.level!==E||_.urlId!==A.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:_}),(!A||A.level!==E)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:E}),this.fragPlaying=_)}}},y(a,[{key:"nextLevel",get:function(){var p=this.nextBufferedFrag;return p?p.level:-1}},{key:"currentFrag",get:function(){var p=this.media;return p?this.fragPlaying||this.getAppendedFrag(p.currentTime):null}},{key:"currentProgramDateTime",get:function(){var p=this.media;if(p){var _=p.currentTime,v=this.currentFrag;if(v&&(0,N.isFiniteNumber)(_)&&(0,N.isFiniteNumber)(v.programDateTime)){var A=v.programDateTime+(_-v.start)*1e3;return new Date(A)}}return null}},{key:"currentLevel",get:function(){var p=this.currentFrag;return p?p.level:-1}},{key:"nextBufferedFrag",get:function(){var p=this.currentFrag;return p?this.followingBufferedFrag(p):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),a}(x.default)},"./src/controller/subtitle-stream-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{SubtitleStreamController:()=>u});var N=m("./src/events.ts"),x=m("./src/utils/buffer-helper.ts"),F=m("./src/controller/fragment-finders.ts"),M=m("./src/utils/discontinuities.ts"),K=m("./src/controller/level-helper.ts"),w=m("./src/controller/fragment-tracker.ts"),I=m("./src/controller/base-stream-controller.ts"),k=m("./src/types/loader.ts"),S=m("./src/types/level.ts");function L(c,d){for(var o=0;o<d.length;o++){var a=d[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(c,a.key,a)}}function R(c,d,o){return d&&L(c.prototype,d),o&&L(c,o),Object.defineProperty(c,"prototype",{writable:!1}),c}function O(c,d){c.prototype=Object.create(d.prototype),c.prototype.constructor=c,C(c,d)}function C(c,d){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},C(c,d)}var y=500,u=function(c){O(d,c);function d(a,s){var h;return h=c.call(this,a,s,"[subtitle-stream-controller]")||this,h.levels=[],h.currentTrackId=-1,h.tracksBuffered=[],h.mainDetails=null,h._registerListeners(),h}var o=d.prototype;return o.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},o._registerListeners=function(){var s=this.hls;s.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(N.Events.ERROR,this.onError,this),s.on(N.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.on(N.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.on(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.on(N.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.on(N.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o._unregisterListeners=function(){var s=this.hls;s.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(N.Events.ERROR,this.onError,this),s.off(N.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.off(N.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.off(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.off(N.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.off(N.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),s.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},o.startLoad=function(s){this.stopLoad(),this.state=I.State.IDLE,this.setInterval(y),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=s,this.tick()},o.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},o.onLevelLoaded=function(s,h){this.mainDetails=h.details},o.onSubtitleFragProcessed=function(s,h){var p=h.frag,_=h.success;if(this.fragPrevious=p,this.state=I.State.IDLE,!!_){var v=this.tracksBuffered[this.currentTrackId];if(v){for(var A,E=p.start,g=0;g<v.length;g++)if(E>=v[g].start&&E<=v[g].end){A=v[g];break}var T=p.start+p.duration;A?A.end=T:(A={start:E,end:T},v.push(A)),this.fragmentTracker.fragBuffered(p)}}},o.onBufferFlushing=function(s,h){var p=h.startOffset,_=h.endOffset;if(p===0&&_!==Number.POSITIVE_INFINITY){var v=this.currentTrackId,A=this.levels;if(!A.length||!A[v]||!A[v].details)return;var E=A[v].details,g=E.targetduration,T=_-g;if(T<=0)return;h.endOffsetSubtitles=Math.max(0,T),this.tracksBuffered.forEach(function(P){for(var B=0;B<P.length;){if(P[B].end<=T){P.shift();continue}else if(P[B].start<T)P[B].start=T;else break;B++}}),this.fragmentTracker.removeFragmentsInRange(p,T,k.PlaylistLevelType.SUBTITLE)}},o.onFragBuffered=function(s,h){if(!this.loadedmetadata&&h.frag.type===k.PlaylistLevelType.MAIN){var p;(p=this.media)!==null&&p!==void 0&&p.buffered.length&&(this.loadedmetadata=!0)}},o.onError=function(s,h){var p,_=h.frag;!_||_.type!==k.PlaylistLevelType.SUBTITLE||((p=this.fragCurrent)!==null&&p!==void 0&&p.loader&&this.fragCurrent.loader.abort(),this.state=I.State.IDLE)},o.onSubtitleTracksUpdated=function(s,h){var p=this,_=h.subtitleTracks;this.tracksBuffered=[],this.levels=_.map(function(v){return new S.Level(v)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(v){p.tracksBuffered[v.id]=[]}),this.mediaBuffer=null},o.onSubtitleTrackSwitch=function(s,h){if(this.currentTrackId=h.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var p=this.levels[this.currentTrackId];p!=null&&p.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,p&&this.setInterval(y)},o.onSubtitleTrackLoaded=function(s,h){var p,_=h.details,v=h.id,A=this.currentTrackId,E=this.levels;if(E.length){var g=E[A];if(!(v>=E.length||v!==A||!g)){this.mediaBuffer=this.mediaBufferTimeRanges;var T=0;if(_.live||(p=g.details)!==null&&p!==void 0&&p.live){var P=this.mainDetails;if(_.deltaUpdateFailed||!P)return;var B=P.fragments[0];g.details?(T=this.alignPlaylists(_,g.details),T===0&&B&&(T=B.start,(0,K.addSliding)(_,T))):_.hasProgramDateTime&&P.hasProgramDateTime?((0,M.alignMediaPlaylistByPDT)(_,P),T=_.fragments[0].start):B&&(T=B.start,(0,K.addSliding)(_,T))}if(g.details=_,this.levelLastLoaded=v,!this.startFragRequested&&(this.mainDetails||!_.live)&&this.setStartPosition(g.details,T),this.tick(),_.live&&!this.fragCurrent&&this.media&&this.state===I.State.IDLE){var V=(0,F.findFragmentByPTS)(null,_.fragments,this.media.currentTime,0);V||(this.warn("Subtitle playlist not aligned with playback"),g.details=void 0)}}}},o._handleFragmentLoadComplete=function(s){var h=s.frag,p=s.payload,_=h.decryptdata,v=this.hls;if(!this.fragContextChanged(h)&&p&&p.byteLength>0&&_&&_.key&&_.iv&&_.method==="AES-128"){var A=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(p),_.key.buffer,_.iv.buffer).then(function(E){var g=performance.now();v.trigger(N.Events.FRAG_DECRYPTED,{frag:h,payload:E,stats:{tstart:A,tdecrypt:g}})})}},o.doTick=function(){if(!this.media){this.state=I.State.IDLE;return}if(this.state===I.State.IDLE){var s=this.currentTrackId,h=this.levels;if(!h.length||!h[s]||!h[s].details)return;var p=h[s].details,_=p.targetduration,v=this.config,A=this.getLoadPosition(),E=x.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],A-_,v.maxBufferHole),g=E.end,T=E.len,P=this.getFwdBufferInfo(this.media,k.PlaylistLevelType.MAIN),B=this.getMaxBufferLength(P==null?void 0:P.len)+_;if(T>B)return;console.assert(p,"Subtitle track details are defined on idle subtitle stream controller tick");var V=p.fragments,W=V.length,j=p.edge,z,Q=this.fragPrevious;if(g<j){var Z=v.maxFragLookUpTolerance;z=(0,F.findFragmentByPTS)(Q,V,Math.max(V[0].start,g),Z),!z&&Q&&Q.start<V[0].start&&(z=V[0])}else z=V[W-1];if(z=this.mapToInitFragWhenRequired(z),!z||this.fragmentTracker.getState(z)!==w.FragmentState.NOT_LOADED)return;z.encrypted?this.loadKey(z,p):this.loadFragment(z,p,g)}},o.getMaxBufferLength=function(s){var h=c.prototype.getMaxBufferLength.call(this);return s?Math.max(h,s):h},o.loadFragment=function(s,h,p){this.fragCurrent=s,s.sn==="initSegment"?this._loadInitSegment(s):(this.startFragRequested=!0,c.prototype.loadFragment.call(this,s,h,p))},R(d,[{key:"mediaBufferTimeRanges",get:function(){return new l(this.tracksBuffered[this.currentTrackId]||[])}}]),d}(I.default),l=function(d){this.buffered=void 0;var o=function(s,h,p){if(h=h>>>0,h>p-1)throw new DOMException("Failed to execute '"+s+"' on 'TimeRanges': The index provided ("+h+") is greater than the maximum bound ("+p+")");return d[h][s]};this.buffered={get length(){return d.length},end:function(s){return o("end",s,d.length)},start:function(s){return o("start",s,d.length)}}}},"./src/controller/subtitle-track-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>R});var N=m("./src/events.ts"),x=m("./src/utils/texttrack-utils.ts"),F=m("./src/controller/base-playlist-controller.ts"),M=m("./src/types/loader.ts");function K(O,C){for(var y=0;y<C.length;y++){var u=C[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(O,u.key,u)}}function w(O,C,y){return C&&K(O.prototype,C),y&&K(O,y),Object.defineProperty(O,"prototype",{writable:!1}),O}function I(O,C){O.prototype=Object.create(C.prototype),O.prototype.constructor=O,k(O,C)}function k(O,C){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,l){return u.__proto__=l,u},k(O,C)}var S=function(O){I(C,O);function C(u){var l;return l=O.call(this,u,"[subtitle-track-controller]")||this,l.media=null,l.tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.selectDefaultTrack=!0,l.queuedDefaultTrack=-1,l.trackChangeListener=function(){return l.onTextTracksChanged()},l.asyncPollTrackChange=function(){return l.pollTrackChange(0)},l.useTextTrackPolling=!1,l.subtitlePollingInterval=-1,l._subtitleDisplay=!0,l.registerListeners(),l}var y=C.prototype;return y.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,O.prototype.destroy.call(this)},y.registerListeners=function(){var l=this.hls;l.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(N.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.on(N.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){var l=this.hls;l.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(N.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(N.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(N.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(N.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.off(N.Events.ERROR,this.onError,this)},y.onMediaAttached=function(l,c){this.media=c.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},y.pollTrackChange=function(l){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,l)},y.onMediaDetaching=function(){if(this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var l=L(this.media.textTracks);l.forEach(function(c){(0,x.clearCurrentCues)(c)}),this.subtitleTrack=-1,this.media=null}},y.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},y.onManifestParsed=function(l,c){this.tracks=c.subtitleTracks},y.onSubtitleTrackLoaded=function(l,c){var d=c.id,o=c.details,a=this.trackId,s=this.tracksInGroup[a];if(!s){this.warn("Invalid subtitle track id "+d);return}var h=s.details;s.details=c.details,this.log("subtitle track "+d+" loaded ["+o.startSN+"-"+o.endSN+"]"),d===this.trackId&&(this.retryCount=0,this.playlistLoaded(d,c,h))},y.onLevelLoading=function(l,c){this.switchLevel(c.level)},y.onLevelSwitching=function(l,c){this.switchLevel(c.level)},y.switchLevel=function(l){var c=this.hls.levels[l];if(c!=null&&c.textGroupIds){var d=c.textGroupIds[c.urlId];if(this.groupId!==d){var o=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,a=this.tracks.filter(function(p){return!d||p.groupId===d});this.tracksInGroup=a;var s=this.findTrackId(o==null?void 0:o.name)||this.findTrackId();this.groupId=d;var h={subtitleTracks:a};this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+d+'" group-id'),this.hls.trigger(N.Events.SUBTITLE_TRACKS_UPDATED,h),s!==-1&&this.setSubtitleTrack(s,o)}}},y.findTrackId=function(l){for(var c=this.tracksInGroup,d=0;d<c.length;d++){var o=c[d];if((!this.selectDefaultTrack||o.default)&&(!l||l===o.name))return o.id}return-1},y.onError=function(l,c){O.prototype.onError.call(this,l,c),!(c.fatal||!c.context)&&c.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&c.context.id===this.trackId&&c.context.groupId===this.groupId&&this.retryLoadingOrFail(c)},y.loadPlaylist=function(l){var c=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(c)){var d=c.id,o=c.groupId,a=c.url;if(l)try{a=l.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+d),this.hls.trigger(N.Events.SUBTITLE_TRACK_LOADING,{url:a,id:d,groupId:o,deliveryDirectives:l||null})}},y.toggleTrackModes=function(l){var c=this,d=this.media,o=this.trackId;if(d){var a=L(d.textTracks),s=a.filter(function(_){return _.groupId===c.groupId});if(l===-1)[].slice.call(a).forEach(function(_){_.mode="disabled"});else{var h=s[o];h&&(h.mode="disabled")}var p=s[l];p&&(p.mode=this.subtitleDisplay?"showing":"hidden")}},y.setSubtitleTrack=function(l,c){var d,o=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=l;return}if(this.trackId!==l&&this.toggleTrackModes(l),!(this.trackId===l&&(l===-1||(d=o[l])!==null&&d!==void 0&&d.details)||l<-1||l>=o.length)){this.clearTimer();var a=o[l];if(this.log("Switching to subtitle track "+l),this.trackId=l,a){var s=a.id,h=a.groupId,p=h===void 0?"":h,_=a.name,v=a.type,A=a.url;this.hls.trigger(N.Events.SUBTITLE_TRACK_SWITCH,{id:s,groupId:p,name:_,type:v,url:A});var E=this.switchParams(a.url,c==null?void 0:c.details);this.loadPlaylist(E)}else this.hls.trigger(N.Events.SUBTITLE_TRACK_SWITCH,{id:l})}},y.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var l=-1,c=L(this.media.textTracks),d=0;d<c.length;d++)if(c[d].mode==="hidden")l=d;else if(c[d].mode==="showing"){l=d;break}this.subtitleTrack!==l&&(this.subtitleTrack=l)}},w(C,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(l){this._subtitleDisplay=l,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1;var c=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(l,c)}}]),C}(F.default);function L(O){for(var C=[],y=0;y<O.length;y++){var u=O[y];u.kind==="subtitles"&&u.label&&C.push(O[y])}return C}const R=S},"./src/controller/timeline-controller.ts":(b,D,m)=>{m.r(D),m.d(D,{TimelineController:()=>R});var N=m("./src/polyfills/number.ts"),x=m("./src/events.ts"),F=m("./src/utils/cea-608-parser.ts"),M=m("./src/utils/output-filter.ts"),K=m("./src/utils/webvtt-parser.ts"),w=m("./src/utils/texttrack-utils.ts"),I=m("./src/utils/imsc1-ttml-parser.ts"),k=m("./src/utils/mp4-tools.ts"),S=m("./src/types/loader.ts"),L=m("./src/utils/logger.ts"),R=function(){function u(c){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=y(),this.captionsProperties=void 0,this.hls=c,this.config=c.config,this.Cues=c.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var d=new M.default(this,"textTrack1"),o=new M.default(this,"textTrack2"),a=new M.default(this,"textTrack3"),s=new M.default(this,"textTrack4");this.cea608Parser1=new F.default(1,d,o),this.cea608Parser2=new F.default(3,a,s)}c.on(x.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),c.on(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(x.Events.MANIFEST_LOADED,this.onManifestLoaded,this),c.on(x.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),c.on(x.Events.FRAG_LOADING,this.onFragLoading,this),c.on(x.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(x.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),c.on(x.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),c.on(x.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.on(x.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),c.on(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var l=u.prototype;return l.destroy=function(){var d=this.hls;d.off(x.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(x.Events.MANIFEST_LOADED,this.onManifestLoaded,this),d.off(x.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),d.off(x.Events.FRAG_LOADING,this.onFragLoading,this),d.off(x.Events.FRAG_LOADED,this.onFragLoaded,this),d.off(x.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),d.off(x.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),d.off(x.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),d.off(x.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),d.off(x.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},l.addCues=function(d,o,a,s,h){for(var p=!1,_=h.length;_--;){var v=h[_],A=C(v[0],v[1],o,a);if(A>=0&&(v[0]=Math.min(v[0],o),v[1]=Math.max(v[1],a),p=!0,A/(a-o)>.5))return}if(p||h.push([o,a]),this.config.renderTextTracksNatively){var E=this.captionsTracks[d];this.Cues.newCue(E,o,a,s)}else{var g=this.Cues.newCue(null,o,a,s);this.hls.trigger(x.Events.CUES_PARSED,{type:"captions",cues:g,track:d})}},l.onInitPtsFound=function(d,o){var a=this,s=o.frag,h=o.id,p=o.initPTS,_=o.timescale,v=this.unparsedVttFrags;h==="main"&&(this.initPTS[s.cc]=p,this.timescale[s.cc]=_),v.length&&(this.unparsedVttFrags=[],v.forEach(function(A){a.onFragLoaded(x.Events.FRAG_LOADED,A)}))},l.getExistingTrack=function(d){var o=this.media;if(o)for(var a=0;a<o.textTracks.length;a++){var s=o.textTracks[a];if(s[d])return s}return null},l.createCaptionsTrack=function(d){this.config.renderTextTracksNatively?this.createNativeTrack(d):this.createNonNativeTrack(d)},l.createNativeTrack=function(d){if(!this.captionsTracks[d]){var o=this.captionsProperties,a=this.captionsTracks,s=this.media,h=o[d],p=h.label,_=h.languageCode,v=this.getExistingTrack(d);if(v)a[d]=v,(0,w.clearCurrentCues)(a[d]),(0,w.sendAddTrackEvent)(a[d],s);else{var A=this.createTextTrack("captions",p,_);A&&(A[d]=!0,a[d]=A)}}},l.createNonNativeTrack=function(d){if(!this.nonNativeCaptionsTracks[d]){var o=this.captionsProperties[d];if(o){var a=o.label,s={_id:d,label:a,kind:"captions",default:o.media?!!o.media.default:!1,closedCaptions:o.media};this.nonNativeCaptionsTracks[d]=s,this.hls.trigger(x.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},l.createTextTrack=function(d,o,a){var s=this.media;if(s)return s.addTextTrack(d,o,a)},l.onMediaAttaching=function(d,o){this.media=o.media,this._cleanTracks()},l.onMediaDetaching=function(){var d=this.captionsTracks;Object.keys(d).forEach(function(o){(0,w.clearCurrentCues)(d[o]),delete d[o]}),this.nonNativeCaptionsTracks={}},l.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=y(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},l._cleanTracks=function(){var d=this.media;if(d){var o=d.textTracks;if(o)for(var a=0;a<o.length;a++)(0,w.clearCurrentCues)(o[a])}},l.onSubtitleTracksUpdated=function(d,o){var a=this;this.textTracks=[];var s=o.subtitleTracks||[],h=s.some(function(A){return A.textCodec===I.IMSC1_CODEC});if(this.config.enableWebVTT||h&&this.config.enableIMSC1){var p=this.tracks&&s&&this.tracks.length===s.length;if(this.tracks=s||[],this.config.renderTextTracksNatively){var _=this.media?this.media.textTracks:[];this.tracks.forEach(function(A,E){var g;if(E<_.length){for(var T=null,P=0;P<_.length;P++)if(O(_[P],A)){T=_[P];break}T&&(g=T)}if(g)(0,w.clearCurrentCues)(g);else{var B=a._captionsOrSubtitlesFromCharacteristics(A);g=a.createTextTrack(B,A.name,A.lang),g&&(g.mode="disabled")}g&&(g.groupId=A.groupId,a.textTracks.push(g))})}else if(!p&&this.tracks&&this.tracks.length){var v=this.tracks.map(function(A){return{label:A.name,kind:A.type.toLowerCase(),default:A.default,subtitleTrack:A}});this.hls.trigger(x.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:v})}}},l._captionsOrSubtitlesFromCharacteristics=function(d){var o;if((o=d.attrs)!==null&&o!==void 0&&o.CHARACTERISTICS){var a=/transcribes-spoken-dialog/gi.test(d.attrs.CHARACTERISTICS),s=/describes-music-and-sound/gi.test(d.attrs.CHARACTERISTICS);if(a&&s)return"captions"}return"subtitles"},l.onManifestLoaded=function(d,o){var a=this;this.config.enableCEA708Captions&&o.captions&&o.captions.forEach(function(s){var h=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(h){var p="textTrack"+h[1],_=a.captionsProperties[p];_&&(_.label=s.name,s.lang&&(_.languageCode=s.lang),_.media=s)}})},l.closedCaptionsForLevel=function(d){var o=this.hls.levels[d.level];return o==null?void 0:o.attrs["CLOSED-CAPTIONS"]},l.onFragLoading=function(d,o){var a=this.cea608Parser1,s=this.cea608Parser2,h=this.lastSn,p=this.lastPartIndex;if(!(!this.enabled||!(a&&s))&&o.frag.type===S.PlaylistLevelType.MAIN){var _,v,A=o.frag.sn,E=(_=o==null||(v=o.part)===null||v===void 0?void 0:v.index)!=null?_:-1;A===h+1||A===h&&E===p+1||(a.reset(),s.reset()),this.lastSn=A,this.lastPartIndex=E}},l.onFragLoaded=function(d,o){var a=o.frag,s=o.payload,h=this.initPTS,p=this.unparsedVttFrags;if(a.type===S.PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!(0,N.isFiniteNumber)(h[a.cc])){p.push(o),h.length&&this.hls.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Missing initial subtitle PTS")});return}var _=a.decryptdata,v="stats"in o;if(_==null||_.key==null||_.method!=="AES-128"||v){var A=this.tracks[a.level],E=this.vttCCs;E[a.cc]||(E[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),A&&A.textCodec===I.IMSC1_CODEC?this._parseIMSC1(a,s):this._parseVTTs(a,s,E)}}else this.hls.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})},l._parseIMSC1=function(d,o){var a=this,s=this.hls;(0,I.parseIMSC1)(o,this.initPTS[d.cc],this.timescale[d.cc],function(h){a._appendCues(h,d.level),s.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(h){L.logger.log("Failed to parse IMSC1: "+h),s.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:h})})},l._parseVTTs=function(d,o,a){var s,h=this,p=this.hls,_=(s=d.initSegment)!==null&&s!==void 0&&s.data?(0,k.appendUint8Array)(d.initSegment.data,new Uint8Array(o)):o;(0,K.parseWebVTT)(_,this.initPTS[d.cc],this.timescale[d.cc],a,d.cc,d.start,function(v){h._appendCues(v,d.level),p.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:d})},function(v){h._fallbackToIMSC1(d,o),L.logger.log("Failed to parse VTT cue: "+v),p.trigger(x.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d,error:v})})},l._fallbackToIMSC1=function(d,o){var a=this,s=this.tracks[d.level];s.textCodec||(0,I.parseIMSC1)(o,this.initPTS[d.cc],this.timescale[d.cc],function(){s.textCodec=I.IMSC1_CODEC,a._parseIMSC1(d,o)},function(){s.textCodec="wvtt"})},l._appendCues=function(d,o){var a=this.hls;if(this.config.renderTextTracksNatively){var s=this.textTracks[o];if(!s||s.mode==="disabled")return;d.forEach(function(_){return(0,w.addCueToTrack)(s,_)})}else{var h=this.tracks[o];if(!h)return;var p=h.default?"default":"subtitles"+o;a.trigger(x.Events.CUES_PARSED,{type:"subtitles",cues:d,track:p})}},l.onFragDecrypted=function(d,o){var a=o.frag;if(a.type===S.PlaylistLevelType.SUBTITLE){if(!(0,N.isFiniteNumber)(this.initPTS[a.cc])){this.unparsedVttFrags.push(o);return}this.onFragLoaded(x.Events.FRAG_LOADED,o)}},l.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},l.onFragParsingUserdata=function(d,o){var a=this.cea608Parser1,s=this.cea608Parser2;if(!(!this.enabled||!(a&&s))){var h=o.frag,p=o.samples;if(!(h.type===S.PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(h)==="NONE"))for(var _=0;_<p.length;_++){var v=p[_].bytes;if(v){var A=this.extractCea608Data(v);a.addData(p[_].pts,A[0]),s.addData(p[_].pts,A[1])}}}},l.onBufferFlushing=function(d,o){var a=o.startOffset,s=o.endOffset,h=o.endOffsetSubtitles,p=o.type,_=this.media;if(!(!_||_.currentTime<s)){if(!p||p==="video"){var v=this.captionsTracks;Object.keys(v).forEach(function(E){return(0,w.removeCuesInRange)(v[E],a,s)})}if(this.config.renderTextTracksNatively&&a===0&&h!==void 0){var A=this.textTracks;Object.keys(A).forEach(function(E){return(0,w.removeCuesInRange)(A[E],a,h)})}}},l.extractCea608Data=function(d){for(var o=[[],[]],a=d[0]&31,s=2,h=0;h<a;h++){var p=d[s++],_=127&d[s++],v=127&d[s++];if(!(_===0&&v===0)){var A=(4&p)!==0;if(A){var E=3&p;(E===0||E===1)&&(o[E].push(_),o[E].push(v))}}}return o},u}();function O(u,l){return u&&u.label===l.name&&!(u.textTrack1||u.textTrack2)}function C(u,l,c,d){return Math.min(l,d)-Math.max(u,c)}function y(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});var N=function(){function x(M,K){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=K}var F=x.prototype;return F.decrypt=function(K,w){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},w,K)},x}()},"./src/crypt/aes-decryptor.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>F,removePadding:()=>x});var N=m("./src/utils/typed-array.ts");function x(M){var K=M.byteLength,w=K&&new DataView(M.buffer).getUint8(K-1);return w?(0,N.sliceUint8)(M,0,K-w):M}var F=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var K=M.prototype;return K.uint8ArrayToUint32Array_=function(I){for(var k=new DataView(I),S=new Uint32Array(4),L=0;L<4;L++)S[L]=k.getUint32(L*4);return S},K.initTable=function(){var I=this.sBox,k=this.invSBox,S=this.subMix,L=S[0],R=S[1],O=S[2],C=S[3],y=this.invSubMix,u=y[0],l=y[1],c=y[2],d=y[3],o=new Uint32Array(256),a=0,s=0,h=0;for(h=0;h<256;h++)h<128?o[h]=h<<1:o[h]=h<<1^283;for(h=0;h<256;h++){var p=s^s<<1^s<<2^s<<3^s<<4;p=p>>>8^p&255^99,I[a]=p,k[p]=a;var _=o[a],v=o[_],A=o[v],E=o[p]*257^p*16843008;L[a]=E<<24|E>>>8,R[a]=E<<16|E>>>16,O[a]=E<<8|E>>>24,C[a]=E,E=A*16843009^v*65537^_*257^a*16843008,u[p]=E<<24|E>>>8,l[p]=E<<16|E>>>16,c[p]=E<<8|E>>>24,d[p]=E,a?(a=_^o[o[o[A^_]]],s^=o[o[s]]):a=s=1}},K.expandKey=function(I){for(var k=this.uint8ArrayToUint32Array_(I),S=!0,L=0;L<k.length&&S;)S=k[L]===this.key[L],L++;if(!S){this.key=k;var R=this.keySize=k.length;if(R!==4&&R!==6&&R!==8)throw new Error("Invalid aes key size="+R);var O=this.ksRows=(R+6+1)*4,C,y,u=this.keySchedule=new Uint32Array(O),l=this.invKeySchedule=new Uint32Array(O),c=this.sBox,d=this.rcon,o=this.invSubMix,a=o[0],s=o[1],h=o[2],p=o[3],_,v;for(C=0;C<O;C++){if(C<R){_=u[C]=k[C];continue}v=_,C%R===0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[v&255],v^=d[C/R|0]<<24):R>6&&C%R===4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[v&255]),u[C]=_=(u[C-R]^v)>>>0}for(y=0;y<O;y++)C=O-y,y&3?v=u[C]:v=u[C-4],y<4||C<=4?l[y]=v:l[y]=a[c[v>>>24]]^s[c[v>>>16&255]]^h[c[v>>>8&255]]^p[c[v&255]],l[y]=l[y]>>>0}},K.networkToHostOrderSwap=function(I){return I<<24|(I&65280)<<8|(I&16711680)>>8|I>>>24},K.decrypt=function(I,k,S){for(var L=this.keySize+6,R=this.invKeySchedule,O=this.invSBox,C=this.invSubMix,y=C[0],u=C[1],l=C[2],c=C[3],d=this.uint8ArrayToUint32Array_(S),o=d[0],a=d[1],s=d[2],h=d[3],p=new Int32Array(I),_=new Int32Array(p.length),v,A,E,g,T,P,B,V,W,j,z,Q,Z,ee,ae=this.networkToHostOrderSwap;k<p.length;){for(W=ae(p[k]),j=ae(p[k+1]),z=ae(p[k+2]),Q=ae(p[k+3]),T=W^R[0],P=Q^R[1],B=z^R[2],V=j^R[3],Z=4,ee=1;ee<L;ee++)v=y[T>>>24]^u[P>>16&255]^l[B>>8&255]^c[V&255]^R[Z],A=y[P>>>24]^u[B>>16&255]^l[V>>8&255]^c[T&255]^R[Z+1],E=y[B>>>24]^u[V>>16&255]^l[T>>8&255]^c[P&255]^R[Z+2],g=y[V>>>24]^u[T>>16&255]^l[P>>8&255]^c[B&255]^R[Z+3],T=v,P=A,B=E,V=g,Z=Z+4;v=O[T>>>24]<<24^O[P>>16&255]<<16^O[B>>8&255]<<8^O[V&255]^R[Z],A=O[P>>>24]<<24^O[B>>16&255]<<16^O[V>>8&255]<<8^O[T&255]^R[Z+1],E=O[B>>>24]<<24^O[V>>16&255]<<16^O[T>>8&255]<<8^O[P&255]^R[Z+2],g=O[V>>>24]<<24^O[T>>16&255]<<16^O[P>>8&255]<<8^O[B&255]^R[Z+3],_[k]=ae(v^o),_[k+1]=ae(g^a),_[k+2]=ae(E^s),_[k+3]=ae(A^h),o=W,a=j,s=z,h=Q,k=k+4}return _.buffer},M}()},"./src/crypt/decrypter.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>k});var N=m("./src/crypt/aes-crypto.ts"),x=m("./src/crypt/fast-aes-key.ts"),F=m("./src/crypt/aes-decryptor.ts"),M=m("./src/utils/logger.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/utils/typed-array.ts"),I=16,k=function(){function S(R,O,C){var y=C===void 0?{}:C,u=y.removePKCS7Padding,l=u===void 0?!0:u;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=R,this.config=O,this.removePKCS7Padding=l,l)try{var c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var L=S.prototype;return L.destroy=function(){this.observer=null},L.isSync=function(){return this.config.enableSoftwareAES},L.flush=function(){var O=this.currentResult;if(!O){this.reset();return}var C=new Uint8Array(O);return this.reset(),this.removePKCS7Padding?(0,F.removePadding)(C):C},L.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},L.decrypt=function(O,C,y,u){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(O),C,y);var l=this.flush();l&&u(l.buffer)}else this.webCryptoDecrypt(new Uint8Array(O),C,y).then(u)},L.softwareDecrypt=function(O,C,y){var u=this.currentIV,l=this.currentResult,c=this.remainderData;this.logOnce("JS AES decrypt"),c&&(O=(0,K.appendUint8Array)(c,O),this.remainderData=null);var d=this.getValidChunk(O);if(!d.length)return null;u&&(y=u);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new F.default),o.expandKey(C);var a=l;return this.currentResult=o.decrypt(d.buffer,0,y),this.currentIV=(0,w.sliceUint8)(d,-16).buffer,a||null},L.webCryptoDecrypt=function(O,C,y){var u=this,l=this.subtle;return(this.key!==C||!this.fastAesKey)&&(this.key=C,this.fastAesKey=new x.default(l,C)),this.fastAesKey.expandKey().then(function(c){if(!l)return Promise.reject(new Error("web crypto not initialized"));var d=new N.default(l,y);return d.decrypt(O.buffer,c)}).catch(function(c){return u.onWebCryptoError(c,O,C,y)})},L.onWebCryptoError=function(O,C,y,u){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",O),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(C,y,u)},L.getValidChunk=function(O){var C=O,y=O.length-O.length%I;return y!==O.length&&(C=(0,w.sliceUint8)(O,0,y),this.remainderData=(0,w.sliceUint8)(O,y)),C},L.logOnce=function(O){this.logEnabled&&(M.logger.log("[decrypter.ts]: "+O),this.logEnabled=!1)},S}()},"./src/crypt/fast-aes-key.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});var N=function(){function x(M,K){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=K}var F=x.prototype;return F.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},x}()},"./src/demux/aacdemuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>k});var N=m("./src/demux/base-audio-demuxer.ts"),x=m("./src/demux/adts.ts"),F=m("./src/utils/logger.ts"),M=m("./src/demux/id3.ts");function K(S,L){S.prototype=Object.create(L.prototype),S.prototype.constructor=S,w(S,L)}function w(S,L){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(S,L)}var I=function(S){K(L,S);function L(O,C){var y;return y=S.call(this)||this,y.observer=void 0,y.config=void 0,y.observer=O,y.config=C,y}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){S.prototype.resetInitSegment.call(this,C,y,u,l),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:y,duration:l,inputTimeScale:9e4,dropped:0}},L.probe=function(C){if(!C)return!1;for(var y=M.getID3Data(C,0)||[],u=y.length,l=C.length;u<l;u++)if(x.probe(C,u))return F.logger.log("ADTS sync word found !"),!0;return!1},R.canParse=function(C,y){return x.canParse(C,y)},R.appendFrame=function(C,y,u){x.initTrackConfig(C,this.observer,y,u,C.manifestCodec);var l=x.appendFrame(C,y,u,this.basePTS,this.frameIndex);if(l&&l.missing===0)return l},L}(N.default);const k=I},"./src/demux/adts.ts":(b,D,m)=>{m.r(D),m.d(D,{appendFrame:()=>u,canGetFrameLength:()=>k,canParse:()=>L,getAudioConfig:()=>M,getFrameDuration:()=>C,getFullFrameLength:()=>I,getHeaderLength:()=>w,initTrackConfig:()=>O,isHeader:()=>S,isHeaderPattern:()=>K,parseFrameHeader:()=>y,probe:()=>R});var N=m("./src/utils/logger.ts"),x=m("./src/errors.ts"),F=m("./src/events.ts");function M(l,c,d,o){var a,s,h,p,_=navigator.userAgent.toLowerCase(),v=o,A=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((c[d+2]&192)>>>6)+1;var E=(c[d+2]&60)>>>2;if(E>A.length-1){l.trigger(F.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+E});return}return h=(c[d+2]&1)<<2,h|=(c[d+3]&192)>>>6,N.logger.log("manifest codec:"+o+", ADTS type:"+a+", samplingIndex:"+E),/firefox/i.test(_)?E>=6?(a=5,p=new Array(4),s=E-3):(a=2,p=new Array(2),s=E):_.indexOf("android")!==-1?(a=2,p=new Array(2),s=E):(a=5,p=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&E>=6?s=E-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(E>=6&&h===1||/vivaldi/i.test(_))||!o&&h===1)&&(a=2,p=new Array(2)),s=E)),p[0]=a<<3,p[0]|=(E&14)>>1,p[1]|=(E&1)<<7,p[1]|=h<<3,a===5&&(p[1]|=(s&14)>>1,p[2]=(s&1)<<7,p[2]|=8,p[3]=0),{config:p,samplerate:A[E],channelCount:h,codec:"mp4a.40."+a,manifestCodec:v}}function K(l,c){return l[c]===255&&(l[c+1]&246)===240}function w(l,c){return l[c+1]&1?7:9}function I(l,c){return(l[c+3]&3)<<11|l[c+4]<<3|(l[c+5]&224)>>>5}function k(l,c){return c+5<l.length}function S(l,c){return c+1<l.length&&K(l,c)}function L(l,c){return k(l,c)&&K(l,c)&&I(l,c)<=l.length-c}function R(l,c){if(S(l,c)){var d=w(l,c);if(c+d>=l.length)return!1;var o=I(l,c);if(o<=d)return!1;var a=c+o;return a===l.length||S(l,a)}return!1}function O(l,c,d,o,a){if(!l.samplerate){var s=M(c,d,o,a);if(!s)return;l.config=s.config,l.samplerate=s.samplerate,l.channelCount=s.channelCount,l.codec=s.codec,l.manifestCodec=s.manifestCodec,N.logger.log("parsed codec:"+l.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function C(l){return 9216e4/l}function y(l,c){var d=w(l,c);if(c+d<=l.length){var o=I(l,c)-d;if(o>0)return{headerLength:d,frameLength:o}}}function u(l,c,d,o,a){var s=C(l.samplerate),h=o+a*s,p=y(c,d),_;if(p){var v=p.frameLength,A=p.headerLength,E=A+v,g=Math.max(0,d+E-c.length);g?(_=new Uint8Array(E-A),_.set(c.subarray(d+A,c.length),0)):_=c.subarray(d+A,d+E);var T={unit:_,pts:h};return g||l.samples.push(T),{sample:T,length:E,missing:g}}var P=c.length-d;_=new Uint8Array(P),_.set(c.subarray(d,c.length),0);var B={unit:_,pts:h};return{sample:B,length:P,missing:-1}}},"./src/demux/base-audio-demuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>S,initPTSFn:()=>k});var N=m("./src/polyfills/number.ts"),x=m("./src/demux/id3.ts"),F=m("./src/types/demuxer.ts"),M=m("./src/demux/dummy-demuxed-track.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/utils/typed-array.ts"),I=function(){function L(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},R.resetTimeStamp=function(C){this.initPTS=C,this.resetContiguity()},R.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},R.canParse=function(C,y){return!1},R.appendFrame=function(C,y,u){},R.demux=function(C,y){this.cachedData&&(C=(0,K.appendUint8Array)(this.cachedData,C),this.cachedData=null);var u=x.getID3Data(C,0),l=u?u.length:0,c,d=this._audioTrack,o=this._id3Track,a=u?x.getTimeStamp(u):void 0,s=C.length;for((this.basePTS===null||this.frameIndex===0&&(0,N.isFiniteNumber)(a))&&(this.basePTS=k(a,y,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),u&&u.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:F.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});l<s;){if(this.canParse(C,l)){var h=this.appendFrame(d,C,l);h?(this.frameIndex++,this.lastPTS=h.sample.pts,l+=h.length,c=l):l=s}else x.canParse(C,l)?(u=x.getID3Data(C,l),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:u,type:F.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),l+=u.length,c=l):l++;if(l===s&&c!==s){var p=(0,w.sliceUint8)(C,c);this.cachedData?this.cachedData=(0,K.appendUint8Array)(this.cachedData,p):this.cachedData=p}}return{audioTrack:d,videoTrack:(0,M.dummyTrack)(),id3Track:o,textTrack:(0,M.dummyTrack)()}},R.demuxSampleAes=function(C,y,u){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},R.flush=function(C){var y=this.cachedData;return y&&(this.cachedData=null,this.demux(y,0)),{audioTrack:this._audioTrack,videoTrack:(0,M.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,M.dummyTrack)()}},R.destroy=function(){},L}(),k=function(R,O,C){return(0,N.isFiniteNumber)(R)?R*90:O*9e4+(C||0)};const S=I},"./src/demux/chunk-cache.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});var N=function(){function F(){this.chunks=[],this.dataLength=0}var M=F.prototype;return M.push=function(w){this.chunks.push(w),this.dataLength+=w.length},M.flush=function(){var w=this.chunks,I=this.dataLength,k;if(w.length)w.length===1?k=w[0]:k=x(w,I);else return new Uint8Array(0);return this.reset(),k},M.reset=function(){this.chunks.length=0,this.dataLength=0},F}();function x(F,M){for(var K=new Uint8Array(M),w=0,I=0;I<F.length;I++){var k=F[I];K.set(k,w),w+=k.length}return K}},"./src/demux/dummy-demuxed-track.ts":(b,D,m)=>{m.r(D),m.d(D,{dummyTrack:()=>N});function N(x,F){return x===void 0&&(x=""),F===void 0&&(F=9e4),{type:x,id:-1,pid:-1,inputTimeScale:F,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>F});var N=m("./src/utils/logger.ts"),x=function(){function M(w){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=w,this.bytesAvailable=w.byteLength,this.word=0,this.bitsAvailable=0}var K=M.prototype;return K.loadWord=function(){var I=this.data,k=this.bytesAvailable,S=I.byteLength-k,L=new Uint8Array(4),R=Math.min(4,k);if(R===0)throw new Error("no bytes available");L.set(I.subarray(S,S+R)),this.word=new DataView(L.buffer).getUint32(0),this.bitsAvailable=R*8,this.bytesAvailable-=R},K.skipBits=function(I){var k;this.bitsAvailable>I?(this.word<<=I,this.bitsAvailable-=I):(I-=this.bitsAvailable,k=I>>3,I-=k>>3,this.bytesAvailable-=k,this.loadWord(),this.word<<=I,this.bitsAvailable-=I)},K.readBits=function(I){var k=Math.min(this.bitsAvailable,I),S=this.word>>>32-k;return I>32&&N.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=k,this.bitsAvailable>0?this.word<<=k:this.bytesAvailable>0&&this.loadWord(),k=I-k,k>0&&this.bitsAvailable?S<<k|this.readBits(k):S},K.skipLZ=function(){var I;for(I=0;I<this.bitsAvailable;++I)if(this.word&2147483648>>>I)return this.word<<=I,this.bitsAvailable-=I,I;return this.loadWord(),I+this.skipLZ()},K.skipUEG=function(){this.skipBits(1+this.skipLZ())},K.skipEG=function(){this.skipBits(1+this.skipLZ())},K.readUEG=function(){var I=this.skipLZ();return this.readBits(I+1)-1},K.readEG=function(){var I=this.readUEG();return 1&I?1+I>>>1:-1*(I>>>1)},K.readBoolean=function(){return this.readBits(1)===1},K.readUByte=function(){return this.readBits(8)},K.readUShort=function(){return this.readBits(16)},K.readUInt=function(){return this.readBits(32)},K.skipScalingList=function(I){for(var k=8,S=8,L,R=0;R<I;R++)S!==0&&(L=this.readEG(),S=(k+L+256)%256),k=S===0?k:S},K.readSPS=function(){var I=0,k=0,S=0,L=0,R,O,C,y=this.readUByte.bind(this),u=this.readBits.bind(this),l=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),o=this.skipEG.bind(this),a=this.skipUEG.bind(this),s=this.skipScalingList.bind(this);y();var h=y();if(u(5),d(3),y(),a(),h===100||h===110||h===122||h===244||h===44||h===83||h===86||h===118||h===128){var p=l();if(p===3&&d(1),a(),a(),d(1),c())for(O=p!==3?8:12,C=0;C<O;C++)c()&&(C<6?s(16):s(64))}a();var _=l();if(_===0)l();else if(_===1)for(d(1),o(),o(),R=l(),C=0;C<R;C++)o();a(),d(1);var v=l(),A=l(),E=u(1);E===0&&d(1),d(1),c()&&(I=l(),k=l(),S=l(),L=l());var g=[1,1];if(c()&&c()){var T=y();switch(T){case 1:g=[1,1];break;case 2:g=[12,11];break;case 3:g=[10,11];break;case 4:g=[16,11];break;case 5:g=[40,33];break;case 6:g=[24,11];break;case 7:g=[20,11];break;case 8:g=[32,11];break;case 9:g=[80,33];break;case 10:g=[18,11];break;case 11:g=[15,11];break;case 12:g=[64,33];break;case 13:g=[160,99];break;case 14:g=[4,3];break;case 15:g=[3,2];break;case 16:g=[2,1];break;case 255:{g=[y()<<8|y(),y()<<8|y()];break}}}return{width:Math.ceil((v+1)*16-I*2-k*2),height:(2-E)*(A+1)*16-(E?2:4)*(S+L),pixelRatio:g}},K.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},M}();const F=x},"./src/demux/id3.ts":(b,D,m)=>{m.r(D),m.d(D,{canParse:()=>K,decodeFrame:()=>L,getID3Data:()=>F,getID3Frames:()=>S,getTimeStamp:()=>w,isFooter:()=>x,isHeader:()=>N,isTimeStampFrame:()=>I,testables:()=>l,utf8ArrayToStr:()=>u});var N=function(a,s){return s+10<=a.length&&a[s]===73&&a[s+1]===68&&a[s+2]===51&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},x=function(a,s){return s+10<=a.length&&a[s]===51&&a[s+1]===68&&a[s+2]===73&&a[s+3]<255&&a[s+4]<255&&a[s+6]<128&&a[s+7]<128&&a[s+8]<128&&a[s+9]<128},F=function(a,s){for(var h=s,p=0;N(a,s);){p+=10;var _=M(a,s+6);p+=_,x(a,s+10)&&(p+=10),s+=p}if(p>0)return a.subarray(h,h+p)},M=function(a,s){var h=0;return h=(a[s]&127)<<21,h|=(a[s+1]&127)<<14,h|=(a[s+2]&127)<<7,h|=a[s+3]&127,h},K=function(a,s){return N(a,s)&&M(a,s+6)+10<=a.length-s},w=function(a){for(var s=S(a),h=0;h<s.length;h++){var p=s[h];if(I(p))return y(p)}},I=function(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"},k=function(a){var s=String.fromCharCode(a[0],a[1],a[2],a[3]),h=M(a,4),p=10;return{type:s,size:h,data:a.subarray(p,p+h)}},S=function(a){for(var s=0,h=[];N(a,s);){var p=M(a,s+6);s+=10;for(var _=s+p;s+8<_;){var v=k(a.subarray(s)),A=L(v);A&&h.push(A),s+=v.size+10}x(a,s)&&(s+=10)}return h},L=function(a){return a.type==="PRIV"?R(a):a.type[0]==="W"?C(a):O(a)},R=function(a){if(!(a.size<2)){var s=u(a.data,!0),h=new Uint8Array(a.data.subarray(s.length+1));return{key:a.type,info:s,data:h.buffer}}},O=function(a){if(!(a.size<2)){if(a.type==="TXXX"){var s=1,h=u(a.data.subarray(s),!0);s+=h.length+1;var p=u(a.data.subarray(s));return{key:a.type,info:h,data:p}}var _=u(a.data.subarray(1));return{key:a.type,data:_}}},C=function(a){if(a.type==="WXXX"){if(a.size<2)return;var s=1,h=u(a.data.subarray(s),!0);s+=h.length+1;var p=u(a.data.subarray(s));return{key:a.type,info:h,data:p}}var _=u(a.data);return{key:a.type,data:_}},y=function(a){if(a.data.byteLength===8){var s=new Uint8Array(a.data),h=s[3]&1,p=(s[4]<<23)+(s[5]<<15)+(s[6]<<7)+s[7];return p/=45,h&&(p+=4772185884e-2),Math.round(p)}},u=function(a,s){s===void 0&&(s=!1);var h=d();if(h){var p=h.decode(a);if(s){var _=p.indexOf("\0");return _!==-1?p.substring(0,_):p}return p.replace(/\0/g,"")}for(var v=a.length,A,E,g,T="",P=0;P<v;){if(A=a[P++],A===0&&s)return T;if(A===0||A===3)continue;switch(A>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:T+=String.fromCharCode(A);break;case 12:case 13:E=a[P++],T+=String.fromCharCode((A&31)<<6|E&63);break;case 14:E=a[P++],g=a[P++],T+=String.fromCharCode((A&15)<<12|(E&63)<<6|(g&63)<<0);break}}return T},l={decodeTextFrame:O},c;function d(){return!c&&typeof self.TextDecoder<"u"&&(c=new self.TextDecoder("utf-8")),c}},"./src/demux/mp3demuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>k});var N=m("./src/demux/base-audio-demuxer.ts"),x=m("./src/demux/id3.ts"),F=m("./src/utils/logger.ts"),M=m("./src/demux/mpegaudio.ts");function K(S,L){S.prototype=Object.create(L.prototype),S.prototype.constructor=S,w(S,L)}function w(S,L){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(S,L)}var I=function(S){K(L,S);function L(){return S.apply(this,arguments)||this}var R=L.prototype;return R.resetInitSegment=function(C,y,u,l){S.prototype.resetInitSegment.call(this,C,y,u,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:y,duration:l,inputTimeScale:9e4,dropped:0}},L.probe=function(C){if(!C)return!1;for(var y=x.getID3Data(C,0)||[],u=y.length,l=C.length;u<l;u++)if(M.probe(C,u))return F.logger.log("MPEG Audio sync word found !"),!0;return!1},R.canParse=function(C,y){return M.canParse(C,y)},R.appendFrame=function(C,y,u){if(this.basePTS!==null)return M.appendFrame(C,y,u,this.basePTS,this.frameIndex)},L}(N.default);const k=I},"./src/demux/mp4demuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>I});var N=m("./src/polyfills/number.ts"),x=m("./src/types/demuxer.ts"),F=m("./src/utils/mp4-tools.ts"),M=m("./src/demux/dummy-demuxed-track.ts"),K=/\/emsg[-/]ID3/i,w=function(){function k(L,R){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=R}var S=k.prototype;return S.resetTimeStamp=function(){},S.resetInitSegment=function(R,O,C,y){var u=(0,F.parseInitSegment)(R),l=this.videoTrack=(0,M.dummyTrack)("video",1),c=this.audioTrack=(0,M.dummyTrack)("audio",1),d=this.txtTrack=(0,M.dummyTrack)("text",1);if(this.id3Track=(0,M.dummyTrack)("id3",1),this.timeOffset=0,u.video){var o=u.video,a=o.id,s=o.timescale,h=o.codec;l.id=a,l.timescale=d.timescale=s,l.codec=h}if(u.audio){var p=u.audio,_=p.id,v=p.timescale,A=p.codec;c.id=_,c.timescale=v,c.codec=A}d.id=F.RemuxerTrackIdConfig.text,l.sampleDuration=0,l.duration=c.duration=y},S.resetContiguity=function(){},k.probe=function(R){return R=R.length>16384?R.subarray(0,16384):R,(0,F.findBox)(R,["moof"]).length>0},S.demux=function(R,O){this.timeOffset=O;var C=R,y=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(C=(0,F.appendUint8Array)(this.remainderData,R));var l=(0,F.segmentValidRange)(C);this.remainderData=l.remainder,y.samples=l.valid||new Uint8Array}else y.samples=C;var c=this.extractID3Track(y,O);return u.samples=(0,F.parseSamples)(O,y),{videoTrack:y,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}},S.flush=function(){var R=this.timeOffset,O=this.videoTrack,C=this.txtTrack;O.samples=this.remainderData||new Uint8Array,this.remainderData=null;var y=this.extractID3Track(O,this.timeOffset);return C.samples=(0,F.parseSamples)(R,O),{videoTrack:O,audioTrack:(0,M.dummyTrack)(),id3Track:y,textTrack:(0,M.dummyTrack)()}},S.extractID3Track=function(R,O){var C=this.id3Track;if(R.samples.length){var y=(0,F.findBox)(R.samples,["emsg"]);y&&y.forEach(function(u){var l=(0,F.parseEmsg)(u);if(K.test(l.schemeIdUri)){var c=(0,N.isFiniteNumber)(l.presentationTime)?l.presentationTime/l.timeScale:O+l.presentationTimeDelta/l.timeScale,d=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);var o=l.payload;C.samples.push({data:o,len:o.byteLength,dts:c,pts:c,type:x.MetadataSchema.emsg,duration:d})}})}return C},S.demuxSampleAes=function(R,O,C){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},S.destroy=function(){},k}();const I=w},"./src/demux/mpegaudio.ts":(b,D,m)=>{m.r(D),m.d(D,{appendFrame:()=>w,canParse:()=>L,isHeader:()=>S,isHeaderPattern:()=>k,parseHeader:()=>I,probe:()=>R});var N=null,x=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],F=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],K=[0,1,1,4];function w(O,C,y,u,l){if(!(y+24>C.length)){var c=I(C,y);if(c&&y+c.frameLength<=C.length){var d=c.samplesPerFrame*9e4/c.sampleRate,o=u+l*d,a={unit:C.subarray(y,y+c.frameLength),pts:o,dts:o};return O.config=[],O.channelCount=c.channelCount,O.samplerate=c.sampleRate,O.samples.push(a),{sample:a,length:c.frameLength,missing:0}}}}function I(O,C){var y=O[C+1]>>3&3,u=O[C+1]>>1&3,l=O[C+2]>>4&15,c=O[C+2]>>2&3;if(y!==1&&l!==0&&l!==15&&c!==3){var d=O[C+2]>>1&1,o=O[C+3]>>6,a=y===3?3-u:u===3?3:4,s=x[a*14+l-1]*1e3,h=y===3?0:y===2?1:2,p=F[h*3+c],_=o===3?1:2,v=M[y][u],A=K[u],E=v*8*A,g=Math.floor(v*s/p+d)*A;if(N===null){var T=navigator.userAgent||"",P=T.match(/Chrome\/(\d+)/i);N=P?parseInt(P[1]):0}var B=!!N&&N<=87;return B&&u===2&&s>=224e3&&o===0&&(O[C+3]=O[C+3]|128),{sampleRate:p,channelCount:_,frameLength:g,samplesPerFrame:E}}}function k(O,C){return O[C]===255&&(O[C+1]&224)===224&&(O[C+1]&6)!==0}function S(O,C){return C+1<O.length&&k(O,C)}function L(O,C){var y=4;return k(O,C)&&y<=O.length-C}function R(O,C){if(C+1<O.length&&k(O,C)){var y=4,u=I(O,C),l=y;u!=null&&u.frameLength&&(l=u.frameLength);var c=C+l;return c===O.length||S(O,c)}return!1}},"./src/demux/sample-aes.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>M});var N=m("./src/crypt/decrypter.ts"),x=m("./src/utils/mp4-tools.ts"),F=function(){function K(I,k,S){this.keyData=void 0,this.decrypter=void 0,this.keyData=S,this.decrypter=new N.default(I,k,{removePKCS7Padding:!1})}var w=K.prototype;return w.decryptBuffer=function(k,S){this.decrypter.decrypt(k,this.keyData.key.buffer,this.keyData.iv.buffer,S)},w.decryptAacSample=function(k,S,L,R){var O=k[S].unit;if(!(O.length<=16)){var C=O.subarray(16,O.length-O.length%16),y=C.buffer.slice(C.byteOffset,C.byteOffset+C.length),u=this;this.decryptBuffer(y,function(l){var c=new Uint8Array(l);O.set(c,16),R||u.decryptAacSamples(k,S+1,L)})}},w.decryptAacSamples=function(k,S,L){for(;;S++){if(S>=k.length){L();return}if(!(k[S].unit.length<32)){var R=this.decrypter.isSync();if(this.decryptAacSample(k,S,L,R),!R)return}}},w.getAvcEncryptedData=function(k){for(var S=Math.floor((k.length-48)/160)*16+16,L=new Int8Array(S),R=0,O=32;O<k.length-16;O+=160,R+=16)L.set(k.subarray(O,O+16),R);return L},w.getAvcDecryptedUnit=function(k,S){for(var L=new Uint8Array(S),R=0,O=32;O<k.length-16;O+=160,R+=16)k.set(L.subarray(R,R+16),O);return k},w.decryptAvcSample=function(k,S,L,R,O,C){var y=(0,x.discardEPB)(O.data),u=this.getAvcEncryptedData(y),l=this;this.decryptBuffer(u.buffer,function(c){O.data=l.getAvcDecryptedUnit(y,c),C||l.decryptAvcSamples(k,S,L+1,R)})},w.decryptAvcSamples=function(k,S,L,R){if(k instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;S++,L=0){if(S>=k.length){R();return}for(var O=k[S].units;!(L>=O.length);L++){var C=O[L];if(!(C.data.length<=48||C.type!==1&&C.type!==5)){var y=this.decrypter.isSync();if(this.decryptAvcSample(k,S,L,R,C,y),!y)return}}}},K}();const M=F},"./src/demux/transmuxer-interface.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>S});var N=m("./src/demux/webworkify-webpack.js"),x=m("./src/events.ts"),F=m("./src/demux/transmuxer.ts"),M=m("./src/utils/logger.ts"),K=m("./src/errors.ts"),w=m("./src/utils/mediasource-helper.ts"),I=m("./node_modules/eventemitter3/index.js"),k=(0,w.getMediaSource)()||{isTypeSupported:function(){return!1}},S=function(){function L(O,C,y,u){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var c=O.config;this.hls=O,this.id=C,this.useWorker=!!c.enableWorker,this.onTransmuxComplete=y,this.onFlush=u;var d=function(p,_){_=_||{},_.frag=l.frag,_.id=l.id,l.hls.trigger(p,_)};this.observer=new I.EventEmitter,this.observer.on(x.Events.FRAG_DECRYPTED,d),this.observer.on(x.Events.ERROR,d);var o={mp4:k.isTypeSupported("video/mp4"),mpeg:k.isTypeSupported("audio/mpeg"),mp3:k.isTypeSupported('audio/mp4; codecs="mp3"')},a=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){M.logger.log("demuxing in webworker");var s;try{s=this.worker=(0,N.default)("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),s.addEventListener("message",this.onwmsg),s.onerror=function(h){l.useWorker=!1,M.logger.warn("Exception in webworker, fallback to inline"),l.hls.trigger(x.Events.ERROR,{type:K.ErrorTypes.OTHER_ERROR,details:K.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(h.message+"  ("+h.filename+":"+h.lineno+")")})},s.postMessage({cmd:"init",typeSupported:o,vendor:a,id:C,config:JSON.stringify(c)})}catch(h){M.logger.warn("Error in worker:",h),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),s&&self.URL.revokeObjectURL(s.objectURL),this.transmuxer=new F.default(this.observer,o,c,a,C),this.worker=null}}else this.transmuxer=new F.default(this.observer,o,c,a,C)}var R=L.prototype;return R.destroy=function(){var C=this.worker;if(C)C.removeEventListener("message",this.onwmsg),C.terminate(),this.worker=null,this.onwmsg=void 0;else{var y=this.transmuxer;y&&(y.destroy(),this.transmuxer=null)}var u=this.observer;u&&u.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},R.push=function(C,y,u,l,c,d,o,a,s,h){var p,_,v=this;s.transmuxing.start=self.performance.now();var A=this.transmuxer,E=this.worker,g=d?d.start:c.start,T=c.decryptdata,P=this.frag,B=!(P&&c.cc===P.cc),V=!(P&&s.level===P.level),W=P?s.sn-P.sn:-1,j=this.part?s.part-this.part.index:-1,z=W===0&&s.id>1&&s.id===(P==null?void 0:P.stats.chunkCount),Q=!V&&(W===1||W===0&&(j===1||z&&j<=0)),Z=self.performance.now();(V||W||c.stats.parsing.start===0)&&(c.stats.parsing.start=Z),d&&(j||!Q)&&(d.stats.parsing.start=Z);var ee=!(P&&((p=c.initSegment)===null||p===void 0?void 0:p.url)===((_=P.initSegment)===null||_===void 0?void 0:_.url)),ae=new F.TransmuxState(B,Q,a,V,g,ee);if(!Q||B||ee){M.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+s.sn+" p: "+s.part+" level: "+s.level+" id: "+s.id+`
        discontinuity: `+B+`
        trackSwitch: `+V+`
        contiguous: `+Q+`
        accurateTimeOffset: `+a+`
        timeOffset: `+g+`
        initSegmentChange: `+ee);var se=new F.TransmuxConfig(u,l,y,o,h);this.configureTransmuxer(se)}if(this.frag=c,this.part=d,E)E.postMessage({cmd:"demux",data:C,decryptdata:T,chunkMeta:s,state:ae},C instanceof ArrayBuffer?[C]:[]);else if(A){var Y=A.push(C,T,s,ae);(0,F.isPromise)(Y)?Y.then(function(X){v.handleTransmuxComplete(X)}):this.handleTransmuxComplete(Y)}},R.flush=function(C){var y=this;C.transmuxing.start=self.performance.now();var u=this.transmuxer,l=this.worker;if(l)l.postMessage({cmd:"flush",chunkMeta:C});else if(u){var c=u.flush(C);(0,F.isPromise)(c)?c.then(function(d){y.handleFlushResult(d,C)}):this.handleFlushResult(c,C)}},R.handleFlushResult=function(C,y){var u=this;C.forEach(function(l){u.handleTransmuxComplete(l)}),this.onFlush(y)},R.onWorkerMessage=function(C){var y=C.data,u=this.hls;switch(y.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(y.data);break}case"flush":{this.onFlush(y.data);break}case"workerLog":M.logger[y.data.logType]&&M.logger[y.data.logType](y.data.message);break;default:{y.data=y.data||{},y.data.frag=this.frag,y.data.id=this.id,u.trigger(y.event,y.data);break}}},R.configureTransmuxer=function(C){var y=this.worker,u=this.transmuxer;y?y.postMessage({cmd:"configure",config:C}):u&&u.configure(C)},R.handleTransmuxComplete=function(C){C.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(C)},L}()},"./src/demux/transmuxer-worker.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>K});var N=m("./src/demux/transmuxer.ts"),x=m("./src/events.ts"),F=m("./src/utils/logger.ts"),M=m("./node_modules/eventemitter3/index.js");function K(L){var R=new M.EventEmitter,O=function(u,l){L.postMessage({event:u,data:l})};R.on(x.Events.FRAG_DECRYPTED,O),R.on(x.Events.ERROR,O);var C=function(){var u=function(d){var o=function(s){O("workerLog",{logType:d,message:s})};F.logger[d]=o};for(var l in F.logger)u(l)};L.addEventListener("message",function(y){var u=y.data;switch(u.cmd){case"init":{var l=JSON.parse(u.config);L.transmuxer=new N.default(R,u.typeSupported,l,u.vendor,u.id),(0,F.enableLogs)(l.debug,u.id),C(),O("init",null);break}case"configure":{L.transmuxer.configure(u.config);break}case"demux":{var c=L.transmuxer.push(u.data,u.decryptdata,u.chunkMeta,u.state);(0,N.isPromise)(c)?c.then(function(a){w(L,a)}):w(L,c);break}case"flush":{var d=u.chunkMeta,o=L.transmuxer.flush(d);(0,N.isPromise)(o)?o.then(function(a){k(L,a,d)}):k(L,o,d);break}}})}function w(L,R){if(S(R.remuxResult))return!1;var O=[],C=R.remuxResult,y=C.audio,u=C.video;return y&&I(O,y),u&&I(O,u),L.postMessage({event:"transmuxComplete",data:R},O),!0}function I(L,R){R.data1&&L.push(R.data1.buffer),R.data2&&L.push(R.data2.buffer)}function k(L,R,O){var C=R.reduce(function(y,u){return w(L,u)||y},!1);C||L.postMessage({event:"transmuxComplete",data:R[0]}),L.postMessage({event:"flush",data:O})}function S(L){return!L.audio&&!L.video&&!L.text&&!L.id3&&!L.initSegment}},"./src/demux/transmuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{TransmuxConfig:()=>c,TransmuxState:()=>d,default:()=>C,isPromise:()=>l});var N=m("./src/events.ts"),x=m("./src/errors.ts"),F=m("./src/crypt/decrypter.ts"),M=m("./src/demux/aacdemuxer.ts"),K=m("./src/demux/mp4demuxer.ts"),w=m("./src/demux/tsdemuxer.ts"),I=m("./src/demux/mp3demuxer.ts"),k=m("./src/remux/mp4-remuxer.ts"),S=m("./src/remux/passthrough-remuxer.ts"),L=m("./src/utils/logger.ts"),R;try{R=self.performance.now.bind(self.performance)}catch{L.logger.debug("Unable to use Performance API on this environment"),R=self.Date.now}var O=[{demux:w.default,remux:k.default},{demux:K.default,remux:S.default},{demux:M.default,remux:k.default},{demux:I.default,remux:k.default}],C=function(){function o(s,h,p,_,v){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=s,this.typeSupported=h,this.config=p,this.vendor=_,this.id=v}var a=o.prototype;return a.configure=function(h){this.transmuxConfig=h,this.decrypter&&this.decrypter.reset()},a.push=function(h,p,_,v){var A=this,E=_.transmuxing;E.executeStart=R();var g=new Uint8Array(h),T=this.config,P=this.currentTransmuxState,B=this.transmuxConfig;v&&(this.currentTransmuxState=v);var V=v||P,W=V.contiguous,j=V.discontinuity,z=V.trackSwitch,Q=V.accurateTimeOffset,Z=V.timeOffset,ee=V.initSegmentChange,ae=B.audioCodec,se=B.videoCodec,Y=B.defaultInitPts,X=B.duration,q=B.initSegmentData;(j||z||ee)&&this.resetInitSegment(q,ae,se,X),(j||ee)&&this.resetInitialTimestamp(Y),W||this.resetContiguity();var re=y(g,p);if(re&&re.method==="AES-128"){var ne=this.getDecrypter();if(T.enableSoftwareAES){var U=ne.softwareDecrypt(g,re.key.buffer,re.iv.buffer);if(!U)return E.executeEnd=R(),u(_);g=new Uint8Array(U)}else return this.decryptionPromise=ne.webCryptoDecrypt(g,re.key.buffer,re.iv.buffer).then(function(J){var te=A.push(J,null,_);return A.decryptionPromise=null,te}),this.decryptionPromise}this.needsProbing(g,j,z)&&this.configureTransmuxer(g,B);var H=this.transmux(g,re,Z,Q,_),$=this.currentTransmuxState;return $.contiguous=!0,$.discontinuity=!1,$.trackSwitch=!1,E.executeEnd=R(),H},a.flush=function(h){var p=this,_=h.transmuxing;_.executeStart=R();var v=this.decrypter,A=this.currentTransmuxState,E=this.decryptionPromise;if(E)return E.then(function(){return p.flush(h)});var g=[],T=A.timeOffset;if(v){var P=v.flush();P&&g.push(this.push(P,null,h))}var B=this.demuxer,V=this.remuxer;if(!B||!V)return this.observer.emit(N.Events.ERROR,N.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),_.executeEnd=R(),[u(h)];var W=B.flush(T);return l(W)?W.then(function(j){return p.flushRemux(g,j,h),g}):(this.flushRemux(g,W,h),g)},a.flushRemux=function(h,p,_){var v=p.audioTrack,A=p.videoTrack,E=p.id3Track,g=p.textTrack,T=this.currentTransmuxState,P=T.accurateTimeOffset,B=T.timeOffset;L.logger.log("[transmuxer.ts]: Flushed fragment "+_.sn+(_.part>-1?" p: "+_.part:"")+" of level "+_.level);var V=this.remuxer.remux(v,A,E,g,B,P,!0,this.id);h.push({remuxResult:V,chunkMeta:_}),_.transmuxing.executeEnd=R()},a.resetInitialTimestamp=function(h){var p=this.demuxer,_=this.remuxer;!p||!_||(p.resetTimeStamp(h),_.resetTimeStamp(h))},a.resetContiguity=function(){var h=this.demuxer,p=this.remuxer;!h||!p||(h.resetContiguity(),p.resetNextTimestamp())},a.resetInitSegment=function(h,p,_,v){var A=this.demuxer,E=this.remuxer;!A||!E||(A.resetInitSegment(h,p,_,v),E.resetInitSegment(h,p,_))},a.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},a.transmux=function(h,p,_,v,A){var E;return p&&p.method==="SAMPLE-AES"?E=this.transmuxSampleAes(h,p,_,v,A):E=this.transmuxUnencrypted(h,_,v,A),E},a.transmuxUnencrypted=function(h,p,_,v){var A=this.demuxer.demux(h,p,!1,!this.config.progressive),E=A.audioTrack,g=A.videoTrack,T=A.id3Track,P=A.textTrack,B=this.remuxer.remux(E,g,T,P,p,_,!1,this.id);return{remuxResult:B,chunkMeta:v}},a.transmuxSampleAes=function(h,p,_,v,A){var E=this;return this.demuxer.demuxSampleAes(h,p,_).then(function(g){var T=E.remuxer.remux(g.audioTrack,g.videoTrack,g.id3Track,g.textTrack,_,v,!1,E.id);return{remuxResult:T,chunkMeta:A}})},a.configureTransmuxer=function(h,p){for(var _=this.config,v=this.observer,A=this.typeSupported,E=this.vendor,g=p.audioCodec,T=p.defaultInitPts,P=p.duration,B=p.initSegmentData,V=p.videoCodec,W,j=0,z=O.length;j<z;j++)if(O[j].demux.probe(h)){W=O[j];break}W||(L.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),W={demux:K.default,remux:S.default});var Q=this.demuxer,Z=this.remuxer,ee=W.remux,ae=W.demux;(!Z||!(Z instanceof ee))&&(this.remuxer=new ee(v,_,A,E)),(!Q||!(Q instanceof ae))&&(this.demuxer=new ae(v,_,A),this.probe=ae.probe),this.resetInitSegment(B,g,V,P),this.resetInitialTimestamp(T)},a.needsProbing=function(h,p,_){return!this.demuxer||!this.remuxer||p||_},a.getDecrypter=function(){var h=this.decrypter;return h||(h=this.decrypter=new F.default(this.observer,this.config)),h},o}();function y(o,a){var s=null;return o.byteLength>0&&a!=null&&a.key!=null&&a.iv!==null&&a.method!=null&&(s=a),s}var u=function(a){return{remuxResult:{},chunkMeta:a}};function l(o){return"then"in o&&o.then instanceof Function}var c=function(a,s,h,p,_){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=a,this.videoCodec=s,this.initSegmentData=h,this.duration=p,this.defaultInitPts=_},d=function(a,s,h,p,_,v){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=a,this.contiguous=s,this.accurateTimeOffset=h,this.trackSwitch=p,this.timeOffset=_,this.initSegmentChange=v}},"./src/demux/tsdemuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>d});var N=m("./src/demux/adts.ts"),x=m("./src/demux/mpegaudio.ts"),F=m("./src/demux/exp-golomb.ts"),M=m("./src/demux/sample-aes.ts"),K=m("./src/events.ts"),w=m("./src/utils/mp4-tools.ts"),I=m("./src/utils/logger.ts"),k=m("./src/errors.ts"),S=m("./src/types/demuxer.ts");function L(){return L=Object.assign?Object.assign.bind():function(o){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(o[h]=s[h])}return o},L.apply(this,arguments)}var R=188,O=function(){function o(s,h,p){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=s,this.config=h,this.typeSupported=p}o.probe=function(h){var p=o.syncOffset(h);return p>0&&I.logger.warn("MPEG2-TS detected but first sync word found @ offset "+p),p!==-1},o.syncOffset=function(h){for(var p=Math.min(R*5,h.length-R*2)+1,_=0;_<p;){if(h[_]===71&&h[_+R]===71)return _;_++}return-1},o.createTrack=function(h,p){return{container:h==="video"||h==="audio"?"video/mp2t":void 0,type:h,id:w.RemuxerTrackIdConfig[h],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:h==="audio"?p:void 0}};var a=o.prototype;return a.resetInitSegment=function(h,p,_,v){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video"),this._audioTrack=o.createTrack("audio",v),this._id3Track=o.createTrack("id3"),this._txtTrack=o.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=p,this.videoCodec=_,this._duration=v},a.resetTimeStamp=function(){},a.resetContiguity=function(){var h=this._audioTrack,p=this._avcTrack,_=this._id3Track;h&&(h.pesData=null),p&&(p.pesData=null),_&&(_.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},a.demux=function(h,p,_,v){_===void 0&&(_=!1),v===void 0&&(v=!1),_||(this.sampleAes=null);var A,E=this._avcTrack,g=this._audioTrack,T=this._id3Track,P=this._txtTrack,B=E.pid,V=E.pesData,W=g.pid,j=T.pid,z=g.pesData,Q=T.pesData,Z=null,ee=this.pmtParsed,ae=this._pmtId,se=h.length;if(this.remainderData&&(h=(0,w.appendUint8Array)(this.remainderData,h),se=h.length,this.remainderData=null),se<R&&!v)return this.remainderData=h,{audioTrack:g,videoTrack:E,id3Track:T,textTrack:P};var Y=Math.max(0,o.syncOffset(h));se-=(se-Y)%R,se<h.byteLength&&!v&&(this.remainderData=new Uint8Array(h.buffer,se,h.buffer.byteLength-se));for(var X=0,q=Y;q<se;q+=R)if(h[q]===71){var re=!!(h[q+1]&64),ne=((h[q+1]&31)<<8)+h[q+2],U=(h[q+3]&48)>>4,H=void 0;if(U>1){if(H=q+5+h[q+4],H===q+R)continue}else H=q+4;switch(ne){case B:re&&(V&&(A=l(V))&&this.parseAVCPES(E,P,A,!1),V={data:[],size:0}),V&&(V.data.push(h.subarray(H,q+R)),V.size+=q+R-H);break;case W:if(re){if(z&&(A=l(z)))switch(g.segmentCodec){case"aac":this.parseAACPES(g,A);break;case"mp3":this.parseMPEGPES(g,A);break}z={data:[],size:0}}z&&(z.data.push(h.subarray(H,q+R)),z.size+=q+R-H);break;case j:re&&(Q&&(A=l(Q))&&this.parseID3PES(T,A),Q={data:[],size:0}),Q&&(Q.data.push(h.subarray(H,q+R)),Q.size+=q+R-H);break;case 0:re&&(H+=h[H]+1),ae=this._pmtId=y(h,H);break;case ae:{re&&(H+=h[H]+1);var $=u(h,H,this.typeSupported,_);B=$.avc,B>0&&(E.pid=B),W=$.audio,W>0&&(g.pid=W,g.segmentCodec=$.segmentCodec),j=$.id3,j>0&&(T.pid=j),Z!==null&&!ee&&(I.logger.log("unknown PID '"+Z+"' in TS found"),Z=null,q=Y-188),ee=this.pmtParsed=!0;break}case 17:case 8191:break;default:Z=ne;break}}else X++;X>0&&this.observer.emit(K.Events.ERROR,K.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+X+" TS packet/s that do not start with 0x47"}),E.pesData=V,g.pesData=z,T.pesData=Q;var J={audioTrack:g,videoTrack:E,id3Track:T,textTrack:P};return v&&this.extractRemainingSamples(J),J},a.flush=function(){var h=this.remainderData;this.remainderData=null;var p;return h?p=this.demux(h,-1,!1,!0):p={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(p),this.sampleAes?this.decrypt(p,this.sampleAes):p},a.extractRemainingSamples=function(h){var p=h.audioTrack,_=h.videoTrack,v=h.id3Track,A=h.textTrack,E=_.pesData,g=p.pesData,T=v.pesData,P;if(E&&(P=l(E))?(this.parseAVCPES(_,A,P,!0),_.pesData=null):_.pesData=E,g&&(P=l(g))){switch(p.segmentCodec){case"aac":this.parseAACPES(p,P);break;case"mp3":this.parseMPEGPES(p,P);break}p.pesData=null}else g!=null&&g.size&&I.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=g;T&&(P=l(T))?(this.parseID3PES(v,P),v.pesData=null):v.pesData=T},a.demuxSampleAes=function(h,p,_){var v=this.demux(h,_,!0,!this.config.progressive),A=this.sampleAes=new M.default(this.observer,this.config,p);return this.decrypt(v,A)},a.decrypt=function(h,p){return new Promise(function(_){var v=h.audioTrack,A=h.videoTrack;v.samples&&v.segmentCodec==="aac"?p.decryptAacSamples(v.samples,0,function(){A.samples?p.decryptAvcSamples(A.samples,0,0,function(){_(h)}):_(h)}):A.samples&&p.decryptAvcSamples(A.samples,0,0,function(){_(h)})})},a.destroy=function(){this._duration=0},a.parseAVCPES=function(h,p,_,v){var A=this,E=this.parseAVCNALu(h,_.data),g=this.avcSample,T,P=!1;_.data=null,g&&E.length&&!h.audFound&&(c(g,h),g=this.avcSample=C(!1,_.pts,_.dts,"")),E.forEach(function(B){switch(B.type){case 1:{T=!0,g||(g=A.avcSample=C(!0,_.pts,_.dts,"")),g.frame=!0;var V=B.data;if(P&&V.length>4){var W=new F.default(V).readSliceType();(W===2||W===4||W===7||W===9)&&(g.key=!0)}break}case 5:T=!0,g||(g=A.avcSample=C(!0,_.pts,_.dts,"")),g.key=!0,g.frame=!0;break;case 6:{T=!0,(0,w.parseSEIMessageFromNALu)(B.data,1,_.pts,p.samples);break}case 7:if(T=!0,P=!0,!h.sps){var j=new F.default(B.data),z=j.readSPS();h.width=z.width,h.height=z.height,h.pixelRatio=z.pixelRatio,h.sps=[B.data],h.duration=A._duration;for(var Q=B.data.subarray(1,4),Z="avc1.",ee=0;ee<3;ee++){var ae=Q[ee].toString(16);ae.length<2&&(ae="0"+ae),Z+=ae}h.codec=Z}break;case 8:T=!0,h.pps||(h.pps=[B.data]);break;case 9:T=!1,h.audFound=!0,g&&c(g,h),g=A.avcSample=C(!1,_.pts,_.dts,"");break;case 12:T=!0;break;default:T=!1,g&&(g.debug+="unknown NAL "+B.type+" ");break}if(g&&T){var se=g.units;se.push(B)}}),v&&g&&(c(g,h),this.avcSample=null)},a.getLastNalUnit=function(h){var p,_=this.avcSample,v;if((!_||_.units.length===0)&&(_=h[h.length-1]),(p=_)!==null&&p!==void 0&&p.units){var A=_.units;v=A[A.length-1]}return v},a.parseAVCNALu=function(h,p){var _=p.byteLength,v=h.naluState||0,A=v,E=[],g=0,T,P,B,V=-1,W=0;for(v===-1&&(V=0,W=p[0]&31,v=0,g=1);g<_;){if(T=p[g++],!v){v=T?0:1;continue}if(v===1){v=T?0:2;continue}if(!T)v=3;else if(T===1){if(V>=0){var j={data:p.subarray(V,g-v-1),type:W};E.push(j)}else{var z=this.getLastNalUnit(h.samples);if(z&&(A&&g<=4-A&&z.state&&(z.data=z.data.subarray(0,z.data.byteLength-A)),P=g-v-1,P>0)){var Q=new Uint8Array(z.data.byteLength+P);Q.set(z.data,0),Q.set(p.subarray(0,P),z.data.byteLength),z.data=Q,z.state=0}}g<_?(B=p[g]&31,V=g,W=B,v=0):v=-1}else v=0}if(V>=0&&v>=0){var Z={data:p.subarray(V,_),type:W,state:v};E.push(Z)}if(E.length===0){var ee=this.getLastNalUnit(h.samples);if(ee){var ae=new Uint8Array(ee.data.byteLength+p.byteLength);ae.set(ee.data,0),ae.set(p,ee.data.byteLength),ee.data=ae}}return h.naluState=v,E},a.parseAACPES=function(h,p){var _=0,v=this.aacOverFlow,A=p.data;if(v){this.aacOverFlow=null;var E=v.missing,g=v.sample.unit.byteLength;if(E===-1){var T=new Uint8Array(g+A.byteLength);T.set(v.sample.unit,0),T.set(A,g),A=T}else{var P=g-E;v.sample.unit.set(A.subarray(0,E),P),h.samples.push(v.sample),_=v.missing}}var B,V;for(B=_,V=A.length;B<V-1&&!N.isHeader(A,B);B++);if(B!==_){var W,j;if(B<V-1?(W="AAC PES did not start with ADTS header,offset:"+B,j=!1):(W="no ADTS header found in AAC PES",j=!0),I.logger.warn("parsing error:"+W),this.observer.emit(K.Events.ERROR,K.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:W}),j)return}N.initTrackConfig(h,this.observer,A,B,this.audioCodec);var z;if(p.pts!==void 0)z=p.pts;else if(v){var Q=N.getFrameDuration(h.samplerate);z=v.sample.pts+Q}else{I.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var Z=0,ee;B<V;)if(ee=N.appendFrame(h,A,B,z,Z),B+=ee.length,ee.missing){this.aacOverFlow=ee;break}else for(Z++;B<V-1&&!N.isHeader(A,B);B++);},a.parseMPEGPES=function(h,p){var _=p.data,v=_.length,A=0,E=0,g=p.pts;if(g===void 0){I.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;E<v;)if(x.isHeader(_,E)){var T=x.appendFrame(h,_,E,g,A);if(T)E+=T.length,A++;else break}else E++},a.parseID3PES=function(h,p){if(p.pts===void 0){I.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var _=L({},p,{type:this._avcTrack?S.MetadataSchema.emsg:S.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});h.samples.push(_)},o}();function C(o,a,s,h){return{key:o,frame:!1,pts:a,dts:s,units:[],debug:h,length:0}}function y(o,a){return(o[a+10]&31)<<8|o[a+11]}function u(o,a,s,h){var p={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},_=(o[a+1]&15)<<8|o[a+2],v=a+3+_-4,A=(o[a+10]&15)<<8|o[a+11];for(a+=12+A;a<v;){var E=(o[a+1]&31)<<8|o[a+2];switch(o[a]){case 207:if(!h){I.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:p.audio===-1&&(p.audio=E);break;case 21:p.id3===-1&&(p.id3=E);break;case 219:if(!h){I.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:p.avc===-1&&(p.avc=E);break;case 3:case 4:s.mpeg!==!0&&s.mp3!==!0?I.logger.log("MPEG audio found, not supported in this browser"):p.audio===-1&&(p.audio=E,p.segmentCodec="mp3");break;case 36:I.logger.warn("Unsupported HEVC stream type found");break}a+=((o[a+3]&15)<<8|o[a+4])+5}return p}function l(o){var a=0,s,h,p,_,v,A=o.data;if(!o||o.size===0)return null;for(;A[0].length<19&&A.length>1;){var E=new Uint8Array(A[0].length+A[1].length);E.set(A[0]),E.set(A[1],A[0].length),A[0]=E,A.splice(1,1)}s=A[0];var g=(s[0]<<16)+(s[1]<<8)+s[2];if(g===1){if(h=(s[4]<<8)+s[5],h&&h>o.size-6)return null;var T=s[7];T&192&&(_=(s[9]&14)*536870912+(s[10]&255)*4194304+(s[11]&254)*16384+(s[12]&255)*128+(s[13]&254)/2,T&64?(v=(s[14]&14)*536870912+(s[15]&255)*4194304+(s[16]&254)*16384+(s[17]&255)*128+(s[18]&254)/2,_-v>54e5&&(I.logger.warn(Math.round((_-v)/9e4)+"s delta between PTS and DTS, align them"),_=v)):v=_),p=s[8];var P=p+9;if(o.size<=P)return null;o.size-=P;for(var B=new Uint8Array(o.size),V=0,W=A.length;V<W;V++){s=A[V];var j=s.byteLength;if(P)if(P>j){P-=j;continue}else s=s.subarray(P),j-=P,P=0;B.set(s,a),a+=j}return h&&(h-=p+3),{data:B,pts:_,dts:v,len:h}}return null}function c(o,a){if(o.units.length&&o.frame){if(o.pts===void 0){var s=a.samples,h=s.length;if(h){var p=s[h-1];o.pts=p.pts,o.dts=p.dts}else{a.dropped++;return}}a.samples.push(o)}o.debug.length&&I.logger.log(o.pts+"/"+o.dts+":"+o.debug)}const d=O},"./src/demux/webworkify-webpack.js":(b,D,m)=>{m.r(D),m.d(D,{default:()=>R});var N=function(){var C=ENTRY_MODULE,y={},u=function c(d){var o=y[d];if(o!==void 0)return o.exports;var a=y[d]={exports:{}};return C[d].call(a.exports,a,a.exports,c),a.exports};u.m=C,function(){u.n=function(c){var d=c&&c.__esModule?function(){return c.default}:function(){return c};return u.d(d,{a:d}),d}}(),function(){u.d=function(c,d){for(var o in d)u.o(d,o)&&!u.o(c,o)&&Object.defineProperty(c,o,{enumerable:!0,get:d[o]})}}(),function(){u.o=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)}}(),function(){u.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}();var l=u(ENTRY_MODULE);return l.default||l},x=N.toString().split("ENTRY_MODULE"),F="[\\.|\\-|\\+|\\w|/|@]+",M="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+F+").*?\\)";function K(O){return(O+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function w(O){return!isNaN(1*O)}function I(O,C,y){var u={};u[y]=[];var l=C.toString().replace(/^"[^"]+"/,"function"),c=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||l.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!c)return u;for(var d=c[1],o=new RegExp("(\\\\n|\\W)"+K(d)+M,"g"),a;a=o.exec(l);)a[3]!=="dll-reference"&&u[y].push(a[3]);for(o=new RegExp("\\("+K(d)+'\\("(dll-reference\\s('+F+'))"\\)\\)'+M,"g");a=o.exec(l);)O[a[2]]||(u[y].push(a[1]),O[a[2]]=m(a[1]).m),u[a[2]]=u[a[2]]||[],u[a[2]].push(a[4]);for(var s=Object.keys(u),h=0;h<s.length;h++)for(var p=0;p<u[s[h]].length;p++)w(u[s[h]][p])&&(u[s[h]][p]=1*u[s[h]][p]);return u}function k(O){var C=Object.keys(O);return C.reduce(function(y,u){return y||O[u].length>0},!1)}function S(O,C){for(var y={main:[C]},u={main:[]},l={main:{}};k(y);)for(var c=Object.keys(y),d=0;d<c.length;d++){var o=c[d],a=y[o],s=a.pop();if(l[o]=l[o]||{},!(l[o][s]||!O[o][s])){l[o][s]=!0,u[o]=u[o]||[],u[o].push(s);for(var h=I(O,O[o][s],o),p=Object.keys(h),_=0;_<p.length;_++)y[p[_]]=y[p[_]]||[],y[p[_]]=y[p[_]].concat(h[p[_]])}}return u}function L(O,C,y,u){var l=O[u].map(function(c){return'"'+c+'": '+C[u][c].toString().replace(/^"[^"]+"/,"function")}).join(",");return x[0]+"{"+l+"}"+x[1]+'"'+y+'"'+x[2]}function R(O,C){C=C||{};var y={main:m.m},u=C.all?{main:Object.keys(y.main)}:S(y,O),l="";Object.keys(u).filter(function(s){return s!=="main"}).forEach(function(s){for(var h=0;u[s][h];)h++;u[s].push(h),y[s][h]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+("var "+s+" = ("+L(u,y,h,modules)+`)();
`)}),l=l+("new (("+L(u,y,O,"main")+")())(self);");var c=new window.Blob([l],{type:"text/javascript"}),d=window.URL||window.webkitURL||window.mozURL||window.msURL,o=d.createObjectURL(c),a=new window.Worker(o);return a.objectURL=o,a}},"./src/errors.ts":(b,D,m)=>{m.r(D),m.d(D,{ErrorDetails:()=>x,ErrorTypes:()=>N});var N;(function(F){F.NETWORK_ERROR="networkError",F.MEDIA_ERROR="mediaError",F.KEY_SYSTEM_ERROR="keySystemError",F.MUX_ERROR="muxError",F.OTHER_ERROR="otherError"})(N||(N={}));var x;(function(F){F.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",F.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",F.KEY_SYSTEM_NO_SESSION="keySystemNoSession",F.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",F.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",F.MANIFEST_LOAD_ERROR="manifestLoadError",F.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",F.MANIFEST_PARSING_ERROR="manifestParsingError",F.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",F.LEVEL_EMPTY_ERROR="levelEmptyError",F.LEVEL_LOAD_ERROR="levelLoadError",F.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",F.LEVEL_SWITCH_ERROR="levelSwitchError",F.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",F.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",F.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",F.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",F.FRAG_LOAD_ERROR="fragLoadError",F.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",F.FRAG_DECRYPT_ERROR="fragDecryptError",F.FRAG_PARSING_ERROR="fragParsingError",F.REMUX_ALLOC_ERROR="remuxAllocError",F.KEY_LOAD_ERROR="keyLoadError",F.KEY_LOAD_TIMEOUT="keyLoadTimeOut",F.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",F.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",F.BUFFER_APPEND_ERROR="bufferAppendError",F.BUFFER_APPENDING_ERROR="bufferAppendingError",F.BUFFER_STALLED_ERROR="bufferStalledError",F.BUFFER_FULL_ERROR="bufferFullError",F.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",F.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",F.INTERNAL_EXCEPTION="internalException",F.INTERNAL_ABORTED="aborted",F.UNKNOWN="unknown"})(x||(x={}))},"./src/events.ts":(b,D,m)=>{m.r(D),m.d(D,{Events:()=>N});var N;(function(x){x.MEDIA_ATTACHING="hlsMediaAttaching",x.MEDIA_ATTACHED="hlsMediaAttached",x.MEDIA_DETACHING="hlsMediaDetaching",x.MEDIA_DETACHED="hlsMediaDetached",x.BUFFER_RESET="hlsBufferReset",x.BUFFER_CODECS="hlsBufferCodecs",x.BUFFER_CREATED="hlsBufferCreated",x.BUFFER_APPENDING="hlsBufferAppending",x.BUFFER_APPENDED="hlsBufferAppended",x.BUFFER_EOS="hlsBufferEos",x.BUFFER_FLUSHING="hlsBufferFlushing",x.BUFFER_FLUSHED="hlsBufferFlushed",x.MANIFEST_LOADING="hlsManifestLoading",x.MANIFEST_LOADED="hlsManifestLoaded",x.MANIFEST_PARSED="hlsManifestParsed",x.LEVEL_SWITCHING="hlsLevelSwitching",x.LEVEL_SWITCHED="hlsLevelSwitched",x.LEVEL_LOADING="hlsLevelLoading",x.LEVEL_LOADED="hlsLevelLoaded",x.LEVEL_UPDATED="hlsLevelUpdated",x.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",x.LEVELS_UPDATED="hlsLevelsUpdated",x.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",x.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",x.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",x.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",x.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",x.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",x.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",x.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",x.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",x.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",x.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",x.CUES_PARSED="hlsCuesParsed",x.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",x.INIT_PTS_FOUND="hlsInitPtsFound",x.FRAG_LOADING="hlsFragLoading",x.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",x.FRAG_LOADED="hlsFragLoaded",x.FRAG_DECRYPTED="hlsFragDecrypted",x.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",x.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",x.FRAG_PARSING_METADATA="hlsFragParsingMetadata",x.FRAG_PARSED="hlsFragParsed",x.FRAG_BUFFERED="hlsFragBuffered",x.FRAG_CHANGED="hlsFragChanged",x.FPS_DROP="hlsFpsDrop",x.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",x.ERROR="hlsError",x.DESTROYING="hlsDestroying",x.KEY_LOADING="hlsKeyLoading",x.KEY_LOADED="hlsKeyLoaded",x.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",x.BACK_BUFFER_REACHED="hlsBackBufferReached"})(N||(N={}))},"./src/hls.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>c});var N=m("./node_modules/url-toolkit/src/url-toolkit.js"),x=m("./src/loader/playlist-loader.ts"),F=m("./src/loader/key-loader.ts"),M=m("./src/controller/id3-track-controller.ts"),K=m("./src/controller/latency-controller.ts"),w=m("./src/controller/level-controller.ts"),I=m("./src/controller/fragment-tracker.ts"),k=m("./src/controller/stream-controller.ts"),S=m("./src/is-supported.ts"),L=m("./src/utils/logger.ts"),R=m("./src/config.ts"),O=m("./node_modules/eventemitter3/index.js"),C=m("./src/events.ts"),y=m("./src/errors.ts");function u(d,o){for(var a=0;a<o.length;a++){var s=o[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(d,s.key,s)}}function l(d,o,a){return o&&u(d.prototype,o),a&&u(d,a),Object.defineProperty(d,"prototype",{writable:!1}),d}var c=function(){d.isSupported=function(){return(0,S.isSupported)()};function d(a){a===void 0&&(a={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new O.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var s=this.config=(0,R.mergeConfig)(d.DefaultConfig,a);this.userConfig=a,(0,L.enableLogs)(s.debug,"Hls instance"),this._autoLevelCapping=-1,s.progressive&&(0,R.enableStreamingMode)(s);var h=s.abrController,p=s.bufferController,_=s.capLevelController,v=s.fpsController,A=this.abrController=new h(this),E=this.bufferController=new p(this),g=this.capLevelController=new _(this),T=new v(this),P=new x.default(this),B=new F.default(this),V=new M.default(this),W=this.levelController=new w.default(this),j=new I.FragmentTracker(this),z=this.streamController=new k.default(this,j);g.setStreamController(z),T.setStreamController(z);var Q=[P,B,W,z];this.networkControllers=Q;var Z=[A,E,g,T,V,j];this.audioTrackController=this.createController(s.audioTrackController,null,Q),this.createController(s.audioStreamController,j,Q),this.subtitleTrackController=this.createController(s.subtitleTrackController,null,Q),this.createController(s.subtitleStreamController,j,Q),this.createController(s.timelineController,null,Z),this.emeController=this.createController(s.emeController,null,Z),this.cmcdController=this.createController(s.cmcdController,null,Z),this.latencyController=this.createController(K.default,null,Z),this.coreComponents=Z}var o=d.prototype;return o.createController=function(s,h,p){if(s){var _=h?new s(this,h):new s(this);return p&&p.push(_),_}return null},o.on=function(s,h,p){p===void 0&&(p=this),this._emitter.on(s,h,p)},o.once=function(s,h,p){p===void 0&&(p=this),this._emitter.once(s,h,p)},o.removeAllListeners=function(s){this._emitter.removeAllListeners(s)},o.off=function(s,h,p,_){p===void 0&&(p=this),this._emitter.off(s,h,p,_)},o.listeners=function(s){return this._emitter.listeners(s)},o.emit=function(s,h,p){return this._emitter.emit(s,h,p)},o.trigger=function(s,h){if(this.config.debug)return this.emit(s,s,h);try{return this.emit(s,s,h)}catch(p){L.logger.error("An internal error happened while handling event "+s+'. Error message: "'+p.message+'". Here is a stacktrace:',p),this.trigger(C.Events.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:s,error:p})}return!1},o.listenerCount=function(s){return this._emitter.listenerCount(s)},o.destroy=function(){L.logger.log("destroy"),this.trigger(C.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(s){return s.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(s){return s.destroy()}),this.coreComponents.length=0},o.attachMedia=function(s){L.logger.log("attachMedia"),this._media=s,this.trigger(C.Events.MEDIA_ATTACHING,{media:s})},o.detachMedia=function(){L.logger.log("detachMedia"),this.trigger(C.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(s){this.stopLoad();var h=this.media,p=this.url,_=this.url=N.buildAbsoluteURL(self.location.href,s,{alwaysNormalize:!0});L.logger.log("loadSource:"+_),h&&p&&p!==_&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(h)),this.trigger(C.Events.MANIFEST_LOADING,{url:s})},o.startLoad=function(s){s===void 0&&(s=-1),L.logger.log("startLoad("+s+")"),this.networkControllers.forEach(function(h){h.startLoad(s)})},o.stopLoad=function(){L.logger.log("stopLoad"),this.networkControllers.forEach(function(s){s.stopLoad()})},o.swapAudioCodec=function(){L.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){L.logger.log("recoverMediaError");var s=this._media;this.detachMedia(),s&&this.attachMedia(s)},o.removeLevel=function(s,h){h===void 0&&(h=0),this.levelController.removeLevel(s,h)},l(d,[{key:"levels",get:function(){var s=this.levelController.levels;return s||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(s){L.logger.log("set currentLevel:"+s),this.loadLevel=s,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(s){L.logger.log("set nextLevel:"+s),this.levelController.manualLevel=s,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(s){L.logger.log("set loadLevel:"+s),this.levelController.manualLevel=s}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(s){this.levelController.nextLoadLevel=s}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(s){L.logger.log("set firstLevel:"+s),this.levelController.firstLevel=s}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(s){L.logger.log("set startLevel:"+s),s!==-1&&(s=Math.max(s,this.minAutoLevel)),this.levelController.startLevel=s}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(s){var h=!!s;h!==this.config.capLevelToPlayerSize&&(h?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=h)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(s){this._autoLevelCapping!==s&&(L.logger.log("set autoLevelCapping:"+s),this._autoLevelCapping=s)}},{key:"bandwidthEstimate",get:function(){var s=this.abrController.bwEstimator;return s?s.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var s=this.levels,h=this.config.minAutoBitrate;if(!s)return 0;for(var p=s.length,_=0;_<p;_++)if(s[_].maxBitrate>=h)return _;return 0}},{key:"maxAutoLevel",get:function(){var s=this.levels,h=this.autoLevelCapping,p;return h===-1&&s&&s.length?p=s.length-1:p=h,p}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(s){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,s)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var s=this.audioTrackController;return s?s.audioTracks:[]}},{key:"audioTrack",get:function(){var s=this.audioTrackController;return s?s.audioTrack:-1},set:function(s){var h=this.audioTrackController;h&&(h.audioTrack=s)}},{key:"subtitleTracks",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var s=this.subtitleTrackController;return s?s.subtitleTrack:-1},set:function(s){var h=this.subtitleTrackController;h&&(h.subtitleTrack=s)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var s=this.subtitleTrackController;return s?s.subtitleDisplay:!1},set:function(s){var h=this.subtitleTrackController;h&&(h.subtitleDisplay=s)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(s){this.config.lowLatencyMode=s}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.9"}},{key:"Events",get:function(){return C.Events}},{key:"ErrorTypes",get:function(){return y.ErrorTypes}},{key:"ErrorDetails",get:function(){return y.ErrorDetails}},{key:"DefaultConfig",get:function(){return d.defaultConfig?d.defaultConfig:R.hlsDefaultConfig},set:function(s){d.defaultConfig=s}}]),d}();c.defaultConfig=void 0},"./src/is-supported.ts":(b,D,m)=>{m.r(D),m.d(D,{changeTypeSupported:()=>M,isSupported:()=>F});var N=m("./src/utils/mediasource-helper.ts");function x(){return self.SourceBuffer||self.WebKitSourceBuffer}function F(){var K=(0,N.getMediaSource)();if(!K)return!1;var w=x(),I=K&&typeof K.isTypeSupported=="function"&&K.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),k=!w||w.prototype&&typeof w.prototype.appendBuffer=="function"&&typeof w.prototype.remove=="function";return!!I&&!!k}function M(){var K,w=x();return typeof(w==null||(K=w.prototype)===null||K===void 0?void 0:K.changeType)=="function"}},"./src/loader/date-range.ts":(b,D,m)=>{m.r(D),m.d(D,{DateRange:()=>k,DateRangeAttribute:()=>I});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/attr-list.ts"),F=m("./src/utils/logger.ts");function M(){return M=Object.assign?Object.assign.bind():function(S){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var O in R)Object.prototype.hasOwnProperty.call(R,O)&&(S[O]=R[O])}return S},M.apply(this,arguments)}function K(S,L){for(var R=0;R<L.length;R++){var O=L[R];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(S,O.key,O)}}function w(S,L,R){return L&&K(S.prototype,L),R&&K(S,R),Object.defineProperty(S,"prototype",{writable:!1}),S}var I;(function(S){S.ID="ID",S.CLASS="CLASS",S.START_DATE="START-DATE",S.DURATION="DURATION",S.END_DATE="END-DATE",S.END_ON_NEXT="END-ON-NEXT",S.PLANNED_DURATION="PLANNED-DURATION",S.SCTE35_OUT="SCTE35-OUT",S.SCTE35_IN="SCTE35-IN"})(I||(I={}));var k=function(){function S(L,R){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,R){var O=R.attr;for(var C in O)if(Object.prototype.hasOwnProperty.call(L,C)&&L[C]!==O[C]){F.logger.warn('DATERANGE tag attribute: "'+C+'" does not match for tags with ID: "'+L.ID+'"'),this._badValueForSameId=C;break}L=M(new x.AttrList({}),O,L)}if(this.attr=L,this._startDate=new Date(L[I.START_DATE]),I.END_DATE in this.attr){var y=new Date(this.attr[I.END_DATE]);(0,N.isFiniteNumber)(y.getTime())&&(this._endDate=y)}}return w(S,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var R=this.duration;return R!==null?new Date(this._startDate.getTime()+R*1e3):null}},{key:"duration",get:function(){if(I.DURATION in this.attr){var R=this.attr.decimalFloatingPoint(I.DURATION);if((0,N.isFiniteNumber)(R))return R}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return I.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(I.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(I.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,N.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),S}()},"./src/loader/fragment-loader.ts":(b,D,m)=>{m.r(D),m.d(D,{LoadError:()=>C,default:()=>R});var N=m("./src/polyfills/number.ts"),x=m("./src/errors.ts");function F(y,u){y.prototype=Object.create(u.prototype),y.prototype.constructor=y,k(y,u)}function M(y){var u=typeof Map=="function"?new Map:void 0;return M=function(c){if(c===null||!I(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,d)}function d(){return K(c,arguments,S(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),k(d,c)},M(y)}function K(y,u,l){return w()?K=Reflect.construct.bind():K=function(d,o,a){var s=[null];s.push.apply(s,o);var h=Function.bind.apply(d,s),p=new h;return a&&k(p,a.prototype),p},K.apply(null,arguments)}function w(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I(y){return Function.toString.call(y).indexOf("[native code]")!==-1}function k(y,u){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},k(y,u)}function S(y){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},S(y)}var L=Math.pow(2,17),R=function(){function y(l){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=l}var u=y.prototype;return u.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},u.abort=function(){this.loader&&this.loader.abort()},u.load=function(c,d){var o=this,a=c.url;if(!a)return Promise.reject(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,networkDetails:null},"Fragment does not have a "+(a?"part list":"url")));this.abort();var s=this.config,h=s.fLoader,p=s.loader;return new Promise(function(_,v){o.loader&&o.loader.destroy();var A=o.loader=c.loader=h?new h(s):new p(s),E=O(c),g={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:c.sn==="initSegment"?1/0:L};c.stats=A.stats,A.load(E,g,{onSuccess:function(P,B,V,W){o.resetLoader(c,A),_({frag:c,part:null,payload:P.data,networkDetails:W})},onError:function(P,B,V){o.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,response:P,networkDetails:V}))},onAbort:function(P,B,V){o.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,networkDetails:V}))},onTimeout:function(P,B,V){o.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,networkDetails:V}))},onProgress:function(P,B,V,W){d&&d({frag:c,part:null,payload:V,networkDetails:W})}})})},u.loadPart=function(c,d,o){var a=this;this.abort();var s=this.config,h=s.fLoader,p=s.loader;return new Promise(function(_,v){a.loader&&a.loader.destroy();var A=a.loader=c.loader=h?new h(s):new p(s),E=O(c,d),g={timeout:s.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:s.fragLoadingMaxRetryTimeout,highWaterMark:L};d.stats=A.stats,A.load(E,g,{onSuccess:function(P,B,V,W){a.resetLoader(c,A),a.updateStatsFromPart(c,d);var j={frag:c,part:d,payload:P.data,networkDetails:W};o(j),_(j)},onError:function(P,B,V){a.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:c,part:d,response:P,networkDetails:V}))},onAbort:function(P,B,V){c.stats.aborted=d.stats.aborted,a.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:c,part:d,networkDetails:V}))},onTimeout:function(P,B,V){a.resetLoader(c,A),v(new C({type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:c,part:d,networkDetails:V}))}})})},u.updateStatsFromPart=function(c,d){var o=c.stats,a=d.stats,s=a.total;if(o.loaded+=a.loaded,s){var h=Math.round(c.duration/d.duration),p=Math.min(Math.round(o.loaded/s),h),_=h-p,v=_*Math.round(o.loaded/p);o.total=o.loaded+v}else o.total=Math.max(o.loaded,o.total);var A=o.loading,E=a.loading;A.start?A.first+=E.first-E.start:(A.start=E.start,A.first=E.first),A.end=E.end},u.resetLoader=function(c,d){c.loader=null,this.loader===d&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),d.destroy()},y}();function O(y,u){u===void 0&&(u=null);var l=u||y,c={frag:y,part:u,responseType:"arraybuffer",url:l.url,headers:{},rangeStart:0,rangeEnd:0},d=l.byteRangeStartOffset,o=l.byteRangeEndOffset;return(0,N.isFiniteNumber)(d)&&(0,N.isFiniteNumber)(o)&&(c.rangeStart=d,c.rangeEnd=o),c}var C=function(y){F(u,y);function u(l){for(var c,d=arguments.length,o=new Array(d>1?d-1:0),a=1;a<d;a++)o[a-1]=arguments[a];return c=y.call.apply(y,[this].concat(o))||this,c.data=void 0,c.data=l,c}return u}(M(Error))},"./src/loader/fragment.ts":(b,D,m)=>{m.r(D),m.d(D,{BaseSegment:()=>R,ElementaryStreamTypes:()=>L,Fragment:()=>O,Part:()=>C});var N=m("./src/polyfills/number.ts"),x=m("./node_modules/url-toolkit/src/url-toolkit.js"),F=m("./src/utils/logger.ts"),M=m("./src/loader/level-key.ts"),K=m("./src/loader/load-stats.ts");function w(y,u){y.prototype=Object.create(u.prototype),y.prototype.constructor=y,I(y,u)}function I(y,u){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,d){return c.__proto__=d,c},I(y,u)}function k(y,u){for(var l=0;l<u.length;l++){var c=u[l];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(y,c.key,c)}}function S(y,u,l){return u&&k(y.prototype,u),l&&k(y,l),Object.defineProperty(y,"prototype",{writable:!1}),y}var L;(function(y){y.AUDIO="audio",y.VIDEO="video",y.AUDIOVIDEO="audiovideo"})(L||(L={}));var R=function(){function y(l){var c;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(c={},c[L.AUDIO]=null,c[L.VIDEO]=null,c[L.AUDIOVIDEO]=null,c),this.baseurl=l}var u=y.prototype;return u.setByteRange=function(c,d){var o=c.split("@",2),a=[];o.length===1?a[0]=d?d.byteRangeEndOffset:0:a[0]=parseInt(o[1]),a[1]=parseInt(o[0])+a[0],this._byteRange=a},S(y,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,x.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(c){this._url=c}}]),y}(),O=function(y){w(u,y);function u(c,d){var o;return o=y.call(this,d)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new K.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=c,o}var l=u.prototype;return l.createInitializationVector=function(d){for(var o=new Uint8Array(16),a=12;a<16;a++)o[a]=d>>8*(15-a)&255;return o},l.setDecryptDataFromLevelKey=function(d,o){var a=d;return(d==null?void 0:d.method)==="AES-128"&&d.uri&&!d.iv&&(a=M.LevelKey.fromURI(d.uri),a.method=d.method,a.iv=this.createInitializationVector(o),a.keyFormat="identity"),a},l.setElementaryStreamInfo=function(d,o,a,s,h,p){p===void 0&&(p=!1);var _=this.elementaryStreams,v=_[d];if(!v){_[d]={startPTS:o,endPTS:a,startDTS:s,endDTS:h,partial:p};return}v.startPTS=Math.min(v.startPTS,o),v.endPTS=Math.max(v.endPTS,a),v.startDTS=Math.min(v.startDTS,s),v.endDTS=Math.max(v.endDTS,h)},l.clearElementaryStreamInfo=function(){var d=this.elementaryStreams;d[L.AUDIO]=null,d[L.VIDEO]=null,d[L.AUDIOVIDEO]=null},S(u,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var d=this.sn;typeof d!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&F.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),d=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,d)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,N.isFiniteNumber)(this.programDateTime))return null;var d=(0,N.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+d*1e3}},{key:"encrypted",get:function(){var d;return!!((d=this.decryptdata)!==null&&d!==void 0&&d.keyFormat&&this.decryptdata.uri)}}]),u}(R),C=function(y){w(u,y);function u(l,c,d,o,a){var s;s=y.call(this,d)||this,s.fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new K.LoadStats,s.duration=l.decimalFloatingPoint("DURATION"),s.gap=l.bool("GAP"),s.independent=l.bool("INDEPENDENT"),s.relurl=l.enumeratedString("URI"),s.fragment=c,s.index=o;var h=l.enumeratedString("BYTERANGE");return h&&s.setByteRange(h,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return S(u,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var c=this.elementaryStreams;return!!(c.audio||c.video||c.audiovideo)}}]),u}(R)},"./src/loader/key-loader.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>M});var N=m("./src/events.ts"),x=m("./src/errors.ts"),F=m("./src/utils/logger.ts"),M=function(){function K(I){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=I,this.registerListeners()}var w=K.prototype;return w.startLoad=function(k){},w.stopLoad=function(){this.destroyInternalLoaders()},w.registerListeners=function(){this.hls.on(N.Events.KEY_LOADING,this.onKeyLoading,this)},w.unregisterListeners=function(){this.hls.off(N.Events.KEY_LOADING,this.onKeyLoading)},w.destroyInternalLoaders=function(){for(var k in this.loaders){var S=this.loaders[k];S&&S.destroy()}this.loaders={}},w.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},w.onKeyLoading=function(k,S){var L=S.frag,R=L.type,O=this.loaders[R];if(!L.decryptdata){F.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var C=L.decryptdata.uri;if(C!==this.decrypturl||this.decryptkey===null){var y=this.hls.config;if(O&&(F.logger.warn("abort previous key loader for type:"+R),O.abort()),!C){F.logger.warn("key uri is falsy");return}var u=y.loader,l=L.loader=this.loaders[R]=new u(y);this.decrypturl=C,this.decryptkey=null;var c={url:C,frag:L,responseType:"arraybuffer"},d={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:y.fragLoadingRetryDelay,maxRetryDelay:y.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};l.load(c,d,o)}else this.decryptkey&&(L.decryptdata.key=this.decryptkey,this.hls.trigger(N.Events.KEY_LOADED,{frag:L}))},w.loadsuccess=function(k,S,L){var R=L.frag;if(!R.decryptdata){F.logger.error("after key load, decryptdata unset");return}this.decryptkey=R.decryptdata.key=new Uint8Array(k.data),R.loader=null,delete this.loaders[R.type],this.hls.trigger(N.Events.KEY_LOADED,{frag:R})},w.loaderror=function(k,S){var L=S.frag,R=L.loader;R&&R.abort(),delete this.loaders[L.type],this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:L,response:k})},w.loadtimeout=function(k,S){var L=S.frag,R=L.loader;R&&R.abort(),delete this.loaders[L.type],this.hls.trigger(N.Events.ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:L})},K}()},"./src/loader/level-details.ts":(b,D,m)=>{m.r(D),m.d(D,{LevelDetails:()=>K});var N=m("./src/polyfills/number.ts");function x(w,I){for(var k=0;k<I.length;k++){var S=I[k];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}function F(w,I,k){return I&&x(w.prototype,I),k&&x(w,k),Object.defineProperty(w,"prototype",{writable:!1}),w}var M=10,K=function(){function w(k){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=k}var I=w.prototype;return I.reloaded=function(S){if(!S){this.advanced=!0,this.updated=!0;return}var L=this.lastPartSn-S.lastPartSn,R=this.lastPartIndex-S.lastPartIndex;this.updated=this.endSN!==S.endSN||!!R||!!L,this.advanced=this.endSN>S.endSN||L>0||L===0&&R>0,this.updated||this.advanced?this.misses=Math.floor(S.misses*.6):this.misses=S.misses+1,this.availabilityDelay=S.availabilityDelay},F(w,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?(0,N.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var S=this.driftEndTime-this.driftStartTime;if(S>0){var L=this.driftEnd-this.driftStart;return L*1e3/S}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var S;return(S=this.partList)!==null&&S!==void 0&&S.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var S;return(S=this.fragments)!==null&&S!==void 0&&S.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var S;return(S=this.partList)!==null&&S!==void 0&&S.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var S;return(S=this.partList)!==null&&S!==void 0&&S.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),w}()},"./src/loader/level-key.ts":(b,D,m)=>{m.r(D),m.d(D,{LevelKey:()=>M});var N=m("./node_modules/url-toolkit/src/url-toolkit.js");function x(K,w){for(var I=0;I<w.length;I++){var k=w[I];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(K,k.key,k)}}function F(K,w,I){return w&&x(K.prototype,w),I&&x(K,I),Object.defineProperty(K,"prototype",{writable:!1}),K}var M=function(){K.fromURL=function(I,k){return new K(I,k)},K.fromURI=function(I){return new K(I)};function K(w,I){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,I?this._uri=(0,N.buildAbsoluteURL)(w,I,{alwaysNormalize:!0}):this._uri=w}return F(K,[{key:"uri",get:function(){return this._uri}}]),K}()},"./src/loader/load-stats.ts":(b,D,m)=>{m.r(D),m.d(D,{LoadStats:()=>N});var N=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>l});var N=m("./src/polyfills/number.ts"),x=m("./node_modules/url-toolkit/src/url-toolkit.js"),F=m("./src/loader/date-range.ts"),M=m("./src/loader/fragment.ts"),K=m("./src/loader/level-details.ts"),w=m("./src/loader/level-key.ts"),I=m("./src/utils/attr-list.ts"),k=m("./src/utils/logger.ts"),S=m("./src/utils/codecs.ts"),L=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,R=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),C=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),y=/\.(mp4|m4s|m4v|m4a)$/i;function u(h){var p,_;return y.test((p=(_=x.parseURL(h))===null||_===void 0?void 0:_.path)!=null?p:"")}var l=function(){function h(){}return h.findGroup=function(_,v){for(var A=0;A<_.length;A++){var E=_[A];if(E.id===v)return E}},h.convertAVC1ToAVCOTI=function(_){var v=_.split(".");if(v.length>2){var A=v.shift()+".";return A+=parseInt(v.shift()).toString(16),A+=("000"+parseInt(v.shift()).toString(16)).slice(-4),A}return _},h.resolve=function(_,v){return x.buildAbsoluteURL(v,_,{alwaysNormalize:!0})},h.parseMasterPlaylist=function(_,v){var A=[],E=[],g={},T=!1;L.lastIndex=0;for(var P;(P=L.exec(_))!=null;)if(P[1]){var B,V=new I.AttrList(P[1]),W={attrs:V,bitrate:V.decimalInteger("AVERAGE-BANDWIDTH")||V.decimalInteger("BANDWIDTH"),name:V.NAME,url:h.resolve(P[2],v)},j=V.decimalResolution("RESOLUTION");j&&(W.width=j.width,W.height=j.height),c((V.CODECS||"").split(/[ ,]+/).filter(function(Z){return Z}),W),W.videoCodec&&W.videoCodec.indexOf("avc1")!==-1&&(W.videoCodec=h.convertAVC1ToAVCOTI(W.videoCodec)),(B=W.unknownCodecs)!==null&&B!==void 0&&B.length||E.push(W),A.push(W)}else if(P[3]){var z=new I.AttrList(P[3]);z["DATA-ID"]&&(T=!0,g[z["DATA-ID"]]=z)}var Q=E.length>0&&E.length<A.length;return{levels:Q?E:A,sessionData:T?g:null}},h.parseMasterPlaylistMedia=function(_,v,A,E){E===void 0&&(E=[]);var g,T=[],P=0;for(R.lastIndex=0;(g=R.exec(_))!==null;){var B=new I.AttrList(g[1]);if(B.TYPE===A){var V={attrs:B,bitrate:0,id:P++,groupId:B["GROUP-ID"],instreamId:B["INSTREAM-ID"],name:B.NAME||B.LANGUAGE||"",type:A,default:B.bool("DEFAULT"),autoselect:B.bool("AUTOSELECT"),forced:B.bool("FORCED"),lang:B.LANGUAGE,url:B.URI?h.resolve(B.URI,v):""};if(E.length){var W=h.findGroup(E,V.groupId)||E[0];d(V,W,"audioCodec"),d(V,W,"textCodec")}T.push(V)}}return T},h.parseLevelPlaylist=function(_,v,A,E,g){var T=new K.LevelDetails(v),P=T.fragments,B=null,V=0,W=0,j=0,z=0,Q=null,Z=new M.Fragment(E,v),ee,ae,se,Y=-1,X=!1;for(O.lastIndex=0,T.m3u8=_;(ee=O.exec(_))!==null;){X&&(X=!1,Z=new M.Fragment(E,v),Z.start=j,Z.sn=V,Z.cc=z,Z.level=A,B&&(Z.initSegment=B,Z.rawProgramDateTime=B.rawProgramDateTime,B.rawProgramDateTime=null));var q=ee[1];if(q){Z.duration=parseFloat(q);var re=(" "+ee[2]).slice(1);Z.title=re||null,Z.tagList.push(re?["INF",q,re]:["INF",q])}else if(ee[3])(0,N.isFiniteNumber)(Z.duration)&&(Z.start=j,se&&(Z.levelkey=se),Z.sn=V,Z.level=A,Z.cc=z,Z.urlId=g,P.push(Z),Z.relurl=(" "+ee[3]).slice(1),a(Z,Q),Q=Z,j+=Z.duration,V++,W=0,X=!0);else if(ee[4]){var ne=(" "+ee[4]).slice(1);Q?Z.setByteRange(ne,Q):Z.setByteRange(ne)}else if(ee[5])Z.rawProgramDateTime=(" "+ee[5]).slice(1),Z.tagList.push(["PROGRAM-DATE-TIME",Z.rawProgramDateTime]),Y===-1&&(Y=P.length);else{if(ee=ee[0].match(C),!ee){k.logger.warn("No matches on slow regex match for level playlist!");continue}for(ae=1;ae<ee.length&&!(typeof ee[ae]<"u");ae++);var U=(" "+ee[ae]).slice(1),H=(" "+ee[ae+1]).slice(1),$=ee[ae+2]?(" "+ee[ae+2]).slice(1):"";switch(U){case"PLAYLIST-TYPE":T.type=H.toUpperCase();break;case"MEDIA-SEQUENCE":V=T.startSN=parseInt(H);break;case"SKIP":{var J=new I.AttrList(H),te=J.decimalInteger("SKIPPED-SEGMENTS");if((0,N.isFiniteNumber)(te)){T.skippedSegments=te;for(var ie=te;ie--;)P.unshift(null);V+=te}var le=J.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(T.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":T.targetduration=parseFloat(H);break;case"VERSION":T.version=parseInt(H);break;case"EXTM3U":break;case"ENDLIST":T.live=!1;break;case"#":(H||$)&&Z.tagList.push($?[H,$]:[H]);break;case"DISCONTINUITY":z++,Z.tagList.push(["DIS"]);break;case"GAP":Z.tagList.push([U]);break;case"BITRATE":Z.tagList.push([U,H]);break;case"DATERANGE":{var oe=new I.AttrList(H),ue=new F.DateRange(oe,T.dateRanges[oe.ID]);ue.isValid||T.skippedSegments?T.dateRanges[ue.id]=ue:k.logger.warn('Ignoring invalid DATERANGE tag: "'+H+'"'),Z.tagList.push(["EXT-X-DATERANGE",H]);break}case"DISCONTINUITY-SEQUENCE":z=parseInt(H);break;case"KEY":{var fe,he=new I.AttrList(H),ge=he.enumeratedString("METHOD"),Ae=he.URI,Ce=he.hexadecimalInteger("IV"),Ie=he.enumeratedString("KEYFORMATVERSIONS"),Fe=he.enumeratedString("KEYID"),Ne=(fe=he.enumeratedString("KEYFORMAT"))!=null?fe:"identity",We=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(We.indexOf(Ne)>-1){k.logger.warn("Keyformat "+Ne+" is not supported from the manifest");continue}else if(Ne!=="identity")continue;ge&&(se=w.LevelKey.fromURL(v,Ae),Ae&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(ge)>=0&&(se.method=ge,se.keyFormat=Ne,Fe&&(se.keyID=Fe),Ie&&(se.keyFormatVersions=Ie),se.iv=Ce));break}case"START":{var De=new I.AttrList(H),Te=De.decimalFloatingPoint("TIME-OFFSET");(0,N.isFiniteNumber)(Te)&&(T.startTimeOffset=Te);break}case"MAP":{var Re=new I.AttrList(H);if(Z.duration){var et=new M.Fragment(E,v);s(et,Re,A,se),B=et,Z.initSegment=B,B.rawProgramDateTime&&!Z.rawProgramDateTime&&(Z.rawProgramDateTime=B.rawProgramDateTime)}else s(Z,Re,A,se),B=Z,X=!0;break}case"SERVER-CONTROL":{var Oe=new I.AttrList(H);T.canBlockReload=Oe.bool("CAN-BLOCK-RELOAD"),T.canSkipUntil=Oe.optionalFloat("CAN-SKIP-UNTIL",0),T.canSkipDateRanges=T.canSkipUntil>0&&Oe.bool("CAN-SKIP-DATERANGES"),T.partHoldBack=Oe.optionalFloat("PART-HOLD-BACK",0),T.holdBack=Oe.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Be=new I.AttrList(H);T.partTarget=Be.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Xe=T.partList;Xe||(Xe=T.partList=[]);var Ft=W>0?Xe[Xe.length-1]:void 0,Bt=W++,rr=new M.Part(new I.AttrList(H),Z,v,Bt,Ft);Xe.push(rr),Z.duration+=rr.duration;break}case"PRELOAD-HINT":{var ft=new I.AttrList(H);T.preloadHint=ft;break}case"RENDITION-REPORT":{var _n=new I.AttrList(H);T.renditionReports=T.renditionReports||[],T.renditionReports.push(_n);break}default:k.logger.warn("line parsed but not handled: "+ee);break}}}Q&&!Q.relurl?(P.pop(),j-=Q.duration,T.partList&&(T.fragmentHint=Q)):T.partList&&(a(Z,Q),Z.cc=z,T.fragmentHint=Z);var Ut=P.length,Et=P[0],nr=P[Ut-1];if(j+=T.skippedSegments*T.targetduration,j>0&&Ut&&nr){T.averagetargetduration=j/Ut;var Kt=nr.sn;T.endSN=Kt!=="initSegment"?Kt:0,Et&&(T.startCC=Et.cc,Et.initSegment||T.fragments.every(function(Fr){return Fr.relurl&&u(Fr.relurl)})&&(k.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),Z=new M.Fragment(E,v),Z.relurl=nr.relurl,Z.level=A,Z.sn="initSegment",Et.initSegment=Z,T.needSidxRanges=!0))}else T.endSN=0,T.startCC=0;return T.fragmentHint&&(j+=T.fragmentHint.duration),T.totalduration=j,T.endCC=z,Y>0&&o(P,Y),T},h}();function c(h,p){["video","audio","text"].forEach(function(_){var v=h.filter(function(E){return(0,S.isCodecType)(E,_)});if(v.length){var A=v.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});p[_+"Codec"]=A.length>0?A[0]:v[0],h=h.filter(function(E){return v.indexOf(E)===-1})}}),p.unknownCodecs=h}function d(h,p,_){var v=p[_];v&&(h[_]=v)}function o(h,p){for(var _=h[p],v=p;v--;){var A=h[v];if(!A)return;A.programDateTime=_.programDateTime-A.duration*1e3,_=A}}function a(h,p){h.rawProgramDateTime?h.programDateTime=Date.parse(h.rawProgramDateTime):p!=null&&p.programDateTime&&(h.programDateTime=p.endProgramDateTime),(0,N.isFiniteNumber)(h.programDateTime)||(h.programDateTime=null,h.rawProgramDateTime=null)}function s(h,p,_,v){h.relurl=p.URI,p.BYTERANGE&&h.setByteRange(p.BYTERANGE),h.level=_,h.sn="initSegment",v&&(h.levelkey=v),h.initSegment=null}},"./src/loader/playlist-loader.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>O});var N=m("./src/polyfills/number.ts"),x=m("./src/events.ts"),F=m("./src/errors.ts"),M=m("./src/utils/logger.ts"),K=m("./src/utils/mp4-tools.ts"),w=m("./src/loader/m3u8-parser.ts"),I=m("./src/types/loader.ts"),k=m("./src/utils/attr-list.ts");function S(C){var y=C.type;switch(y){case I.PlaylistContextType.AUDIO_TRACK:return I.PlaylistLevelType.AUDIO;case I.PlaylistContextType.SUBTITLE_TRACK:return I.PlaylistLevelType.SUBTITLE;default:return I.PlaylistLevelType.MAIN}}function L(C,y){var u=C.url;return(u===void 0||u.indexOf("data:")===0)&&(u=y.url),u}var R=function(){function C(u){this.hls=void 0,this.loaders=Object.create(null),this.hls=u,this.registerListeners()}var y=C.prototype;return y.startLoad=function(l){},y.stopLoad=function(){this.destroyInternalLoaders()},y.registerListeners=function(){var l=this.hls;l.on(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(x.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(x.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.on(x.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},y.unregisterListeners=function(){var l=this.hls;l.off(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(x.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(x.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),l.off(x.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},y.createInternalLoader=function(l){var c=this.hls.config,d=c.pLoader,o=c.loader,a=d||o,s=new a(c);return l.loader=s,this.loaders[l.type]=s,s},y.getInternalLoader=function(l){return this.loaders[l.type]},y.resetInternalLoader=function(l){this.loaders[l]&&delete this.loaders[l]},y.destroyInternalLoaders=function(){for(var l in this.loaders){var c=this.loaders[l];c&&c.destroy(),this.resetInternalLoader(l)}},y.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},y.onManifestLoading=function(l,c){var d=c.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:I.PlaylistContextType.MANIFEST,url:d,deliveryDirectives:null})},y.onLevelLoading=function(l,c){var d=c.id,o=c.level,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:null,level:o,responseType:"text",type:I.PlaylistContextType.LEVEL,url:a,deliveryDirectives:s})},y.onAudioTrackLoading=function(l,c){var d=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.AUDIO_TRACK,url:a,deliveryDirectives:s})},y.onSubtitleTrackLoading=function(l,c){var d=c.id,o=c.groupId,a=c.url,s=c.deliveryDirectives;this.load({id:d,groupId:o,level:null,responseType:"text",type:I.PlaylistContextType.SUBTITLE_TRACK,url:a,deliveryDirectives:s})},y.load=function(l){var c,d=this.hls.config,o=this.getInternalLoader(l);if(o){var a=o.context;if(a&&a.url===l.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+l.type),o.abort()}var s,h,p,_;switch(l.type){case I.PlaylistContextType.MANIFEST:s=d.manifestLoadingMaxRetry,h=d.manifestLoadingTimeOut,p=d.manifestLoadingRetryDelay,_=d.manifestLoadingMaxRetryTimeout;break;case I.PlaylistContextType.LEVEL:case I.PlaylistContextType.AUDIO_TRACK:case I.PlaylistContextType.SUBTITLE_TRACK:s=0,h=d.levelLoadingTimeOut;break;default:s=d.levelLoadingMaxRetry,h=d.levelLoadingTimeOut,p=d.levelLoadingRetryDelay,_=d.levelLoadingMaxRetryTimeout;break}if(o=this.createInternalLoader(l),(c=l.deliveryDirectives)!==null&&c!==void 0&&c.part){var v;if(l.type===I.PlaylistContextType.LEVEL&&l.level!==null?v=this.hls.levels[l.level].details:l.type===I.PlaylistContextType.AUDIO_TRACK&&l.id!==null?v=this.hls.audioTracks[l.id].details:l.type===I.PlaylistContextType.SUBTITLE_TRACK&&l.id!==null&&(v=this.hls.subtitleTracks[l.id].details),v){var A=v.partTarget,E=v.targetduration;A&&E&&(h=Math.min(Math.max(A*3,E*.8)*1e3,h))}}var g={timeout:h,maxRetry:s,retryDelay:p,maxRetryDelay:_,highWaterMark:0},T={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};o.load(l,g,T)},y.loadsuccess=function(l,c,d,o){if(o===void 0&&(o=null),d.isSidxRequest){this.handleSidxRequest(l,d),this.handlePlaylistLoaded(l,c,d,o);return}this.resetInternalLoader(d.type);var a=l.data;if(a.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(l,d,"no EXTM3U delimiter",o);return}c.parsing.start=performance.now(),a.indexOf("#EXTINF:")>0||a.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(l,c,d,o):this.handleMasterPlaylist(l,c,d,o)},y.loaderror=function(l,c,d){d===void 0&&(d=null),this.handleNetworkError(c,d,!1,l)},y.loadtimeout=function(l,c,d){d===void 0&&(d=null),this.handleNetworkError(c,d,!0)},y.handleMasterPlaylist=function(l,c,d,o){var a=this.hls,s=l.data,h=L(l,d),p=w.default.parseMasterPlaylist(s,h),_=p.levels,v=p.sessionData;if(!_.length){this.handleManifestParsingError(l,d,"no level found in manifest",o);return}var A=_.map(function(V){return{id:V.attrs.AUDIO,audioCodec:V.audioCodec}}),E=_.map(function(V){return{id:V.attrs.SUBTITLES,textCodec:V.textCodec}}),g=w.default.parseMasterPlaylistMedia(s,h,"AUDIO",A),T=w.default.parseMasterPlaylistMedia(s,h,"SUBTITLES",E),P=w.default.parseMasterPlaylistMedia(s,h,"CLOSED-CAPTIONS");if(g.length){var B=g.some(function(V){return!V.url});!B&&_[0].audioCodec&&!_[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new k.AttrList({}),bitrate:0,url:""}))}a.trigger(x.Events.MANIFEST_LOADED,{levels:_,audioTracks:g,subtitles:T,captions:P,url:h,stats:c,networkDetails:o,sessionData:v})},y.handleTrackOrLevelPlaylist=function(l,c,d,o){var a=this.hls,s=d.id,h=d.level,p=d.type,_=L(l,d),v=(0,N.isFiniteNumber)(s)?s:0,A=(0,N.isFiniteNumber)(h)?h:v,E=S(d),g=w.default.parseLevelPlaylist(l.data,_,A,E,v);if(!g.fragments.length){a.trigger(x.Events.ERROR,{type:F.ErrorTypes.NETWORK_ERROR,details:F.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:_,reason:"no fragments found in level",level:typeof d.level=="number"?d.level:void 0});return}if(p===I.PlaylistContextType.MANIFEST){var T={attrs:new k.AttrList({}),bitrate:0,details:g,name:"",url:_};a.trigger(x.Events.MANIFEST_LOADED,{levels:[T],audioTracks:[],url:_,stats:c,networkDetails:o,sessionData:null})}if(c.parsing.end=performance.now(),g.needSidxRanges){var P,B=(P=g.fragments[0].initSegment)===null||P===void 0?void 0:P.url;this.load({url:B,isSidxRequest:!0,type:p,level:h,levelDetails:g,id:s,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}d.levelDetails=g,this.handlePlaylistLoaded(l,c,d,o)},y.handleSidxRequest=function(l,c){var d=new Uint8Array(l.data),o=(0,K.findBox)(d,["sidx"])[0];if(o){var a=(0,K.parseSegmentIndex)(o);if(a){var s=a.references,h=c.levelDetails;s.forEach(function(p,_){var v=p.info,A=h.fragments[_];if(A.byteRange.length===0&&A.setByteRange(String(1+v.end-v.start)+"@"+String(v.start)),A.initSegment){var E=(0,K.findBox)(d,["moov"])[0],g=E?E.length:null;A.initSegment.setByteRange(String(g)+"@0")}})}}},y.handleManifestParsingError=function(l,c,d,o){this.hls.trigger(x.Events.ERROR,{type:F.ErrorTypes.NETWORK_ERROR,details:F.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:c.type===I.PlaylistContextType.MANIFEST,url:l.url,reason:d,response:l,context:c,networkDetails:o})},y.handleNetworkError=function(l,c,d,o){d===void 0&&(d=!1),M.logger.warn("[playlist-loader]: A network "+(d?"timeout":"error")+" occurred while loading "+l.type+" level: "+l.level+" id: "+l.id+' group-id: "'+l.groupId+'"');var a=F.ErrorDetails.UNKNOWN,s=!1,h=this.getInternalLoader(l);switch(l.type){case I.PlaylistContextType.MANIFEST:a=d?F.ErrorDetails.MANIFEST_LOAD_TIMEOUT:F.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case I.PlaylistContextType.LEVEL:a=d?F.ErrorDetails.LEVEL_LOAD_TIMEOUT:F.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.AUDIO_TRACK:a=d?F.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:F.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case I.PlaylistContextType.SUBTITLE_TRACK:a=d?F.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:F.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}h&&this.resetInternalLoader(l.type);var p={type:F.ErrorTypes.NETWORK_ERROR,details:a,fatal:s,url:l.url,loader:h,context:l,networkDetails:c};o&&(p.response=o),this.hls.trigger(x.Events.ERROR,p)},y.handlePlaylistLoaded=function(l,c,d,o){var a=d.type,s=d.level,h=d.id,p=d.groupId,_=d.loader,v=d.levelDetails,A=d.deliveryDirectives;if(!(v!=null&&v.targetduration)){this.handleManifestParsingError(l,d,"invalid target duration",o);return}if(_)switch(v.live&&(_.getCacheAge&&(v.ageHeader=_.getCacheAge()||0),(!_.getCacheAge||isNaN(v.ageHeader))&&(v.ageHeader=0)),a){case I.PlaylistContextType.MANIFEST:case I.PlaylistContextType.LEVEL:this.hls.trigger(x.Events.LEVEL_LOADED,{details:v,level:s||0,id:h||0,stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(x.Events.AUDIO_TRACK_LOADED,{details:v,id:h||0,groupId:p||"",stats:c,networkDetails:o,deliveryDirectives:A});break;case I.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(x.Events.SUBTITLE_TRACK_LOADED,{details:v,id:h||0,groupId:p||"",stats:c,networkDetails:o,deliveryDirectives:A});break}},C}();const O=R},"./src/polyfills/number.ts":(b,D,m)=>{m.r(D),m.d(D,{MAX_SAFE_INTEGER:()=>x,isFiniteNumber:()=>N});var N=Number.isFinite||function(F){return typeof F=="number"&&isFinite(F)},x=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>x});var N=function(){function F(){}return F.getSilentFrame=function(K,w){switch(K){case"mp4a.40.2":if(w===1)return new Uint8Array([0,200,0,128,35,128]);if(w===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(w===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(w===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(w===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(w===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(w===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(w===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},F}();const x=N},"./src/remux/mp4-generator.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>F});var N=Math.pow(2,32)-1,x=function(){function M(){}return M.init=function(){M.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var w;for(w in M.types)M.types.hasOwnProperty(w)&&(M.types[w]=[w.charCodeAt(0),w.charCodeAt(1),w.charCodeAt(2),w.charCodeAt(3)]);var I=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),k=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);M.HDLR_TYPES={video:I,audio:k};var S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),L=new Uint8Array([0,0,0,0,0,0,0,0]);M.STTS=M.STSC=M.STCO=L,M.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),M.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),M.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),M.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var R=new Uint8Array([105,115,111,109]),O=new Uint8Array([97,118,99,49]),C=new Uint8Array([0,0,0,1]);M.FTYP=M.box(M.types.ftyp,R,C,R,O),M.DINF=M.box(M.types.dinf,M.box(M.types.dref,S))},M.box=function(w){for(var I=8,k=arguments.length,S=new Array(k>1?k-1:0),L=1;L<k;L++)S[L-1]=arguments[L];for(var R=S.length,O=R;R--;)I+=S[R].byteLength;var C=new Uint8Array(I);for(C[0]=I>>24&255,C[1]=I>>16&255,C[2]=I>>8&255,C[3]=I&255,C.set(w,4),R=0,I=8;R<O;R++)C.set(S[R],I),I+=S[R].byteLength;return C},M.hdlr=function(w){return M.box(M.types.hdlr,M.HDLR_TYPES[w])},M.mdat=function(w){return M.box(M.types.mdat,w)},M.mdhd=function(w,I){I*=w;var k=Math.floor(I/(N+1)),S=Math.floor(I%(N+1));return M.box(M.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,S>>24,S>>16&255,S>>8&255,S&255,85,196,0,0]))},M.mdia=function(w){return M.box(M.types.mdia,M.mdhd(w.timescale,w.duration),M.hdlr(w.type),M.minf(w))},M.mfhd=function(w){return M.box(M.types.mfhd,new Uint8Array([0,0,0,0,w>>24,w>>16&255,w>>8&255,w&255]))},M.minf=function(w){return w.type==="audio"?M.box(M.types.minf,M.box(M.types.smhd,M.SMHD),M.DINF,M.stbl(w)):M.box(M.types.minf,M.box(M.types.vmhd,M.VMHD),M.DINF,M.stbl(w))},M.moof=function(w,I,k){return M.box(M.types.moof,M.mfhd(w),M.traf(k,I))},M.moov=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trak(w[I]);return M.box.apply(null,[M.types.moov,M.mvhd(w[0].timescale,w[0].duration)].concat(k).concat(M.mvex(w)))},M.mvex=function(w){for(var I=w.length,k=[];I--;)k[I]=M.trex(w[I]);return M.box.apply(null,[M.types.mvex].concat(k))},M.mvhd=function(w,I){I*=w;var k=Math.floor(I/(N+1)),S=Math.floor(I%(N+1)),L=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,w>>24&255,w>>16&255,w>>8&255,w&255,k>>24,k>>16&255,k>>8&255,k&255,S>>24,S>>16&255,S>>8&255,S&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return M.box(M.types.mvhd,L)},M.sdtp=function(w){var I=w.samples||[],k=new Uint8Array(4+I.length),S,L;for(S=0;S<I.length;S++)L=I[S].flags,k[S+4]=L.dependsOn<<4|L.isDependedOn<<2|L.hasRedundancy;return M.box(M.types.sdtp,k)},M.stbl=function(w){return M.box(M.types.stbl,M.stsd(w),M.box(M.types.stts,M.STTS),M.box(M.types.stsc,M.STSC),M.box(M.types.stsz,M.STSZ),M.box(M.types.stco,M.STCO))},M.avc1=function(w){var I=[],k=[],S,L,R;for(S=0;S<w.sps.length;S++)L=w.sps[S],R=L.byteLength,I.push(R>>>8&255),I.push(R&255),I=I.concat(Array.prototype.slice.call(L));for(S=0;S<w.pps.length;S++)L=w.pps[S],R=L.byteLength,k.push(R>>>8&255),k.push(R&255),k=k.concat(Array.prototype.slice.call(L));var O=M.box(M.types.avcC,new Uint8Array([1,I[3],I[4],I[5],255,224|w.sps.length].concat(I).concat([w.pps.length]).concat(k))),C=w.width,y=w.height,u=w.pixelRatio[0],l=w.pixelRatio[1];return M.box(M.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,C>>8&255,C&255,y>>8&255,y&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),O,M.box(M.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),M.box(M.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,l>>24,l>>16&255,l>>8&255,l&255])))},M.esds=function(w){var I=w.config.length;return new Uint8Array([0,0,0,0,3,23+I,0,1,0,4,15+I,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([I]).concat(w.config).concat([6,1,2]))},M.mp4a=function(w){var I=w.samplerate;return M.box(M.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]),M.box(M.types.esds,M.esds(w)))},M.mp3=function(w){var I=w.samplerate;return M.box(M.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,w.channelCount,0,16,0,0,0,0,I>>8&255,I&255,0,0]))},M.stsd=function(w){return w.type==="audio"?w.segmentCodec==="mp3"&&w.codec==="mp3"?M.box(M.types.stsd,M.STSD,M.mp3(w)):M.box(M.types.stsd,M.STSD,M.mp4a(w)):M.box(M.types.stsd,M.STSD,M.avc1(w))},M.tkhd=function(w){var I=w.id,k=w.duration*w.timescale,S=w.width,L=w.height,R=Math.floor(k/(N+1)),O=Math.floor(k%(N+1));return M.box(M.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,I>>24&255,I>>16&255,I>>8&255,I&255,0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255,O>>24,O>>16&255,O>>8&255,O&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,S>>8&255,S&255,0,0,L>>8&255,L&255,0,0]))},M.traf=function(w,I){var k=M.sdtp(w),S=w.id,L=Math.floor(I/(N+1)),R=Math.floor(I%(N+1));return M.box(M.types.traf,M.box(M.types.tfhd,new Uint8Array([0,0,0,0,S>>24,S>>16&255,S>>8&255,S&255])),M.box(M.types.tfdt,new Uint8Array([1,0,0,0,L>>24,L>>16&255,L>>8&255,L&255,R>>24,R>>16&255,R>>8&255,R&255])),M.trun(w,k.length+16+20+8+16+8+8),k)},M.trak=function(w){return w.duration=w.duration||4294967295,M.box(M.types.trak,M.tkhd(w),M.mdia(w))},M.trex=function(w){var I=w.id;return M.box(M.types.trex,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,I&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},M.trun=function(w,I){var k=w.samples||[],S=k.length,L=12+16*S,R=new Uint8Array(L),O,C,y,u,l,c;for(I+=8+L,R.set([w.type==="video"?1:0,0,15,1,S>>>24&255,S>>>16&255,S>>>8&255,S&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255],0),O=0;O<S;O++)C=k[O],y=C.duration,u=C.size,l=C.flags,c=C.cts,R.set([y>>>24&255,y>>>16&255,y>>>8&255,y&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.paddingValue<<1|l.isNonSync,l.degradPrio&61440,l.degradPrio&15,c>>>24&255,c>>>16&255,c>>>8&255,c&255],12+16*O);return M.box(M.types.trun,R)},M.initSegment=function(w){M.types||M.init();var I=M.moov(w),k=new Uint8Array(M.FTYP.byteLength+I.byteLength);return k.set(M.FTYP),k.set(I,M.FTYP.byteLength),k},M}();x.types=void 0,x.HDLR_TYPES=void 0,x.STTS=void 0,x.STSC=void 0,x.STCO=void 0,x.STSZ=void 0,x.VMHD=void 0,x.SMHD=void 0,x.STSD=void 0,x.FTYP=void 0,x.DINF=void 0;const F=x},"./src/remux/mp4-remuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>u,flushTextTrackMetadataCueSamples:()=>d,flushTextTrackUserdataCueSamples:()=>o,normalizePts:()=>l});var N=m("./src/polyfills/number.ts"),x=m("./src/remux/aac-helper.ts"),F=m("./src/remux/mp4-generator.ts"),M=m("./src/events.ts"),K=m("./src/errors.ts"),w=m("./src/utils/logger.ts"),I=m("./src/types/loader.ts"),k=m("./src/utils/timescale-conversion.ts");function S(){return S=Object.assign?Object.assign.bind():function(h){for(var p=1;p<arguments.length;p++){var _=arguments[p];for(var v in _)Object.prototype.hasOwnProperty.call(_,v)&&(h[v]=_[v])}return h},S.apply(this,arguments)}var L=10*1e3,R=1024,O=1152,C=null,y=null,u=function(){function h(_,v,A,E){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=_,this.config=v,this.typeSupported=A,this.ISGenerated=!1,C===null){var g=navigator.userAgent||"",T=g.match(/Chrome\/(\d+)/i);C=T?parseInt(T[1]):0}if(y===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);y=P?parseInt(P[1]):0}}var p=h.prototype;return p.destroy=function(){},p.resetTimeStamp=function(v){w.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=v},p.resetNextTimestamp=function(){w.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},p.resetInitSegment=function(){w.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},p.getVideoStartPts=function(v){var A=!1,E=v.reduce(function(g,T){var P=T.pts-g;return P<-4294967296?(A=!0,l(g,T.pts)):P>0?g:T.pts},v[0].pts);return A&&w.logger.debug("PTS rollover detected"),E},p.remux=function(v,A,E,g,T,P,B,V){var W,j,z,Q,Z,ee,ae=T,se=T,Y=v.pid>-1,X=A.pid>-1,q=A.samples.length,re=v.samples.length>0,ne=B&&q>0||q>1,U=(!Y||re)&&(!X||ne)||this.ISGenerated||B;if(U){this.ISGenerated||(z=this.generateIS(v,A,T));var H=this.isVideoContiguous,$=-1,J;if(ne&&($=c(A.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(ee=!0,$>0){w.logger.warn("[mp4-remuxer]: Dropped "+$+" out of "+q+" video samples due to a missing keyframe");var te=this.getVideoStartPts(A.samples);A.samples=A.samples.slice($),A.dropped+=$,se+=(A.samples[0].pts-te)/A.inputTimeScale,J=se}else $===-1&&(w.logger.warn("[mp4-remuxer]: No keyframe found out of "+q+" video samples"),ee=!1);if(this.ISGenerated){if(re&&ne){var ie=this.getVideoStartPts(A.samples),le=l(v.samples[0].pts,ie)-ie,oe=le/A.inputTimeScale;ae+=Math.max(0,oe),se+=Math.max(0,-oe)}if(re){if(v.samplerate||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),z=this.generateIS(v,A,T)),j=this.remuxAudio(v,ae,this.isAudioContiguous,P,X||ne||V===I.PlaylistLevelType.AUDIO?se:void 0),ne){var ue=j?j.endPTS-j.startPTS:0;A.inputTimeScale||(w.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),z=this.generateIS(v,A,T)),W=this.remuxVideo(A,se,H,ue)}}else ne&&(W=this.remuxVideo(A,se,H,0));W&&(W.firstKeyFrame=$,W.independent=$!==-1,W.firstKeyFramePTS=J)}}return this.ISGenerated&&(E.samples.length&&(Z=d(E,T,this._initPTS,this._initDTS)),g.samples.length&&(Q=o(g,T,this._initPTS))),{audio:j,video:W,initSegment:z,independent:ee,text:Q,id3:Z}},p.generateIS=function(v,A,E){var g=v.samples,T=A.samples,P=this.typeSupported,B={},V=!(0,N.isFiniteNumber)(this._initPTS),W="audio/mp4",j,z,Q;if(V&&(j=z=1/0),v.config&&g.length){switch(v.timescale=v.samplerate,v.segmentCodec){case"mp3":P.mpeg?(W="audio/mpeg",v.codec=""):P.mp3&&(v.codec="mp3");break}B.audio={id:"audio",container:W,codec:v.codec,initSegment:v.segmentCodec==="mp3"&&P.mpeg?new Uint8Array(0):F.default.initSegment([v]),metadata:{channelCount:v.channelCount}},V&&(Q=v.inputTimeScale,j=z=g[0].pts-Math.round(Q*E))}if(A.sps&&A.pps&&T.length&&(A.timescale=A.inputTimeScale,B.video={id:"main",container:"video/mp4",codec:A.codec,initSegment:F.default.initSegment([A]),metadata:{width:A.width,height:A.height}},V)){Q=A.inputTimeScale;var Z=this.getVideoStartPts(T),ee=Math.round(Q*E);z=Math.min(z,l(T[0].dts,Z)-ee),j=Math.min(j,Z-ee)}if(Object.keys(B).length)return this.ISGenerated=!0,V&&(this._initPTS=j,this._initDTS=z),{tracks:B,initPTS:j,timescale:Q}},p.remuxVideo=function(v,A,E,g){var T=v.inputTimeScale,P=v.samples,B=[],V=P.length,W=this._initPTS,j=this.nextAvcDts,z=8,Q=this.videoSampleDuration,Z,ee,ae=Number.POSITIVE_INFINITY,se=Number.NEGATIVE_INFINITY,Y=!1;if(!E||j===null){var X=A*T,q=P[0].pts-l(P[0].dts,P[0].pts);j=X-q}for(var re=0;re<V;re++){var ne=P[re];ne.pts=l(ne.pts-W,j),ne.dts=l(ne.dts-W,j),ne.dts<P[re>0?re-1:re].dts&&(Y=!0)}Y&&P.sort(function(Sn,Ii){var ao=Sn.dts-Ii.dts,so=Sn.pts-Ii.pts;return ao||so}),Z=P[0].dts,ee=P[P.length-1].dts;var U=ee-Z,H=U?Math.round(U/(V-1)):Q||v.inputTimeScale/30;if(E){var $=Z-j,J=$>H,te=$<-1;if((J||te)&&(J?w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)($,!0)+" ms ("+$+"dts) hole between fragments detected, filling it"):w.logger.warn("AVC: "+(0,k.toMsFromMpegTsClock)(-$,!0)+" ms ("+$+"dts) overlapping between fragments detected"),!te||j>P[0].pts)){Z=j;var ie=P[0].pts-$;P[0].dts=Z,P[0].pts=ie,w.logger.log("Video: First PTS/DTS adjusted: "+(0,k.toMsFromMpegTsClock)(ie,!0)+"/"+(0,k.toMsFromMpegTsClock)(Z,!0)+", delta: "+(0,k.toMsFromMpegTsClock)($,!0)+" ms")}}Z=Math.max(0,Z);for(var le=0,oe=0,ue=0;ue<V;ue++){for(var fe=P[ue],he=fe.units,ge=he.length,Ae=0,Ce=0;Ce<ge;Ce++)Ae+=he[Ce].data.length;oe+=Ae,le+=ge,fe.length=Ae,fe.dts=Math.max(fe.dts,Z),ae=Math.min(fe.pts,ae),se=Math.max(fe.pts,se)}ee=P[V-1].dts;var Ie=oe+4*le+8,Fe;try{Fe=new Uint8Array(Ie)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:K.ErrorTypes.MUX_ERROR,details:K.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ie,reason:"fail allocating video mdat "+Ie});return}var Ne=new DataView(Fe.buffer);Ne.setUint32(0,Ie),Fe.set(F.default.types.mdat,4);for(var We=!1,De=Number.POSITIVE_INFINITY,Te=Number.POSITIVE_INFINITY,Re=Number.NEGATIVE_INFINITY,et=Number.NEGATIVE_INFINITY,Oe=0;Oe<V;Oe++){for(var Be=P[Oe],Xe=Be.units,Ft=0,Bt=0,rr=Xe.length;Bt<rr;Bt++){var ft=Xe[Bt],_n=ft.data,Ut=ft.data.byteLength;Ne.setUint32(z,Ut),z+=4,Fe.set(_n,z),z+=Ut,Ft+=4+Ut}var Et=void 0;if(Oe<V-1)Q=P[Oe+1].dts-Be.dts,Et=P[Oe+1].pts-Be.pts;else{var nr=this.config,Kt=Oe>0?Be.dts-P[Oe-1].dts:H;if(Et=Oe>0?Be.pts-P[Oe-1].pts:H,nr.stretchShortVideoTrack&&this.nextAudioPts!==null){var Fr=Math.floor(nr.maxBufferHole*T),Tn=(g?ae+g*T:this.nextAudioPts)-Be.pts;Tn>Fr?(Q=Tn-Kt,Q<0?Q=Kt:We=!0,w.logger.log("[mp4-remuxer]: It is approximately "+Tn/90+" ms to the next segment; using duration "+Q/90+" ms for the last video frame.")):Q=Kt}else Q=Kt}var qs=Math.round(Be.pts-Be.dts);De=Math.min(De,Q),Re=Math.max(Re,Q),Te=Math.min(Te,Et),et=Math.max(et,Et),B.push(new a(Be.key,Q,Ft,qs))}if(B.length){if(C){if(C<70){var Pi=B[0].flags;Pi.dependsOn=2,Pi.isNonSync=0}}else if(y&&et-Te<Re-De&&H/Re<.025&&B[0].cts===0){w.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var bn=Z,nt=0,Di=B.length;nt<Di;nt++){var Oi=bn+B[nt].duration,eo=bn+B[nt].cts;if(nt<Di-1){var to=Oi+B[nt+1].cts;B[nt].duration=to-eo}else B[nt].duration=nt?B[nt-1].duration:H;B[nt].cts=0,bn=Oi}}}console.assert(Q!==null,"mp4SampleDuration must be computed"),Q=We||!Q?H:Q,this.nextAvcDts=j=ee+Q,this.videoSampleDuration=Q,this.isVideoContiguous=!0;var ro=F.default.moof(v.sequenceNumber++,Z,S({},v,{samples:B})),no="video",io={data1:ro,data2:Fe,startPTS:ae/T,endPTS:(se+Q)/T,startDTS:Z/T,endDTS:j/T,type:no,hasAudio:!1,hasVideo:!0,nb:B.length,dropped:v.dropped};return v.samples=[],v.dropped=0,console.assert(Fe.length,"MDAT length must not be zero"),io},p.remuxAudio=function(v,A,E,g,T){var P=v.inputTimeScale,B=v.samplerate?v.samplerate:P,V=P/B,W=v.segmentCodec==="aac"?R:O,j=W*V,z=this._initPTS,Q=v.segmentCodec==="mp3"&&this.typeSupported.mpeg,Z=[],ee=T!==void 0,ae=v.samples,se=Q?0:8,Y=this.nextAudioPts||-1,X=A*P;if(this.isAudioContiguous=E=E||ae.length&&Y>0&&(g&&Math.abs(X-Y)<9e3||Math.abs(l(ae[0].pts-z,X)-Y)<20*j),ae.forEach(function(ft){ft.pts=l(ft.pts-z,X)}),!E||Y<0){if(ae=ae.filter(function(ft){return ft.pts>=0}),!ae.length)return;T===0?Y=0:g&&!ee?Y=Math.max(0,X):Y=ae[0].pts}if(v.segmentCodec==="aac")for(var q=this.config.maxAudioFramesDrift,re=0,ne=Y;re<ae.length;re++){var U=ae[re],H=U.pts,$=H-ne,J=Math.abs(1e3*$/P);if($<=-q*j&&ee)re===0&&(w.logger.warn("Audio frame @ "+(H/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*$/P)+" ms."),this.nextAudioPts=Y=ne=H);else if($>=q*j&&J<L&&ee){var te=Math.round($/j);ne=H-te*j,ne<0&&(te--,ne+=j),re===0&&(this.nextAudioPts=Y=ne),w.logger.warn("[mp4-remuxer]: Injecting "+te+" audio frame @ "+(ne/P).toFixed(3)+"s due to "+Math.round(1e3*$/P)+" ms gap.");for(var ie=0;ie<te;ie++){var le=Math.max(ne,0),oe=x.default.getSilentFrame(v.manifestCodec||v.codec,v.channelCount);oe||(w.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=U.unit.subarray()),ae.splice(re,0,{unit:oe,pts:le}),ne+=j,re++}}U.pts=ne,ne+=j}for(var ue=null,fe=null,he,ge=0,Ae=ae.length;Ae--;)ge+=ae[Ae].unit.byteLength;for(var Ce=0,Ie=ae.length;Ce<Ie;Ce++){var Fe=ae[Ce],Ne=Fe.unit,We=Fe.pts;if(fe!==null){var De=Z[Ce-1];De.duration=Math.round((We-fe)/V)}else if(E&&v.segmentCodec==="aac"&&(We=Y),ue=We,ge>0){ge+=se;try{he=new Uint8Array(ge)}catch{this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:K.ErrorTypes.MUX_ERROR,details:K.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ge,reason:"fail allocating audio mdat "+ge});return}if(!Q){var Te=new DataView(he.buffer);Te.setUint32(0,ge),he.set(F.default.types.mdat,4)}}else return;he.set(Ne,se);var Re=Ne.byteLength;se+=Re,Z.push(new a(!0,W,Re,0)),fe=We}var et=Z.length;if(et){var Oe=Z[Z.length-1];this.nextAudioPts=Y=fe+V*Oe.duration;var Be=Q?new Uint8Array(0):F.default.moof(v.sequenceNumber++,ue/V,S({},v,{samples:Z}));v.samples=[];var Xe=ue/P,Ft=Y/P,Bt="audio",rr={data1:Be,data2:he,startPTS:Xe,endPTS:Ft,startDTS:Xe,endDTS:Ft,type:Bt,hasAudio:!0,hasVideo:!1,nb:et};return this.isAudioContiguous=!0,console.assert(he.length,"MDAT length must not be zero"),rr}},p.remuxEmptyAudio=function(v,A,E,g){var T=v.inputTimeScale,P=v.samplerate?v.samplerate:T,B=T/P,V=this.nextAudioPts,W=(V!==null?V:g.startDTS*T)+this._initDTS,j=g.endDTS*T+this._initDTS,z=B*R,Q=Math.ceil((j-W)/z),Z=x.default.getSilentFrame(v.manifestCodec||v.codec,v.channelCount);if(w.logger.warn("[mp4-remuxer]: remux empty Audio"),!Z){w.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var ee=[],ae=0;ae<Q;ae++){var se=W+ae*z;ee.push({unit:Z,pts:se,dts:se})}return v.samples=ee,this.remuxAudio(v,A,E,!1)},h}();function l(h,p){var _;if(p===null)return h;for(p<h?_=-8589934592:_=8589934592;Math.abs(h-p)>4294967296;)h+=_;return h}function c(h){for(var p=0;p<h.length;p++)if(h[p].key)return p;return-1}function d(h,p,_,v){var A=h.samples.length;if(A){for(var E=h.inputTimeScale,g=0;g<A;g++){var T=h.samples[g];T.pts=l(T.pts-_,p*E)/E,T.dts=l(T.dts-v,p*E)/E}var P=h.samples;return h.samples=[],{samples:P}}}function o(h,p,_){var v=h.samples.length;if(v){for(var A=h.inputTimeScale,E=0;E<v;E++){var g=h.samples[E];g.pts=l(g.pts-_,p*A)/A}h.samples.sort(function(P,B){return P.pts-B.pts});var T=h.samples;return h.samples=[],{samples:T}}}var a=function(p,_,v,A){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=_,this.size=v,this.cts=A,this.flags=new s(p)},s=function(p){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=p?2:1,this.isNonSync=p?0:1}},"./src/remux/passthrough-remuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>k});var N=m("./src/polyfills/number.ts"),x=m("./src/remux/mp4-remuxer.ts"),F=m("./src/utils/mp4-tools.ts"),M=m("./src/loader/fragment.ts"),K=m("./src/utils/logger.ts"),w=function(){function S(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var L=S.prototype;return L.destroy=function(){},L.resetTimeStamp=function(O){this.initPTS=O,this.lastEndTime=null},L.resetNextTimestamp=function(){this.lastEndTime=null},L.resetInitSegment=function(O,C,y){this.audioCodec=C,this.videoCodec=y,this.generateInitSegment(O),this.emitInitSegment=!0},L.generateInitSegment=function(O){var C=this.audioCodec,y=this.videoCodec;if(!O||!O.byteLength){this.initTracks=void 0,this.initData=void 0;return}var u=this.initData=(0,F.parseInitSegment)(O);C||(C=I(u.audio,M.ElementaryStreamTypes.AUDIO)),y||(y=I(u.video,M.ElementaryStreamTypes.VIDEO));var l={};u.audio&&u.video?l.audiovideo={container:"video/mp4",codec:C+","+y,initSegment:O,id:"main"}:u.audio?l.audio={container:"audio/mp4",codec:C,initSegment:O,id:"audio"}:u.video?l.video={container:"video/mp4",codec:y,initSegment:O,id:"main"}:K.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=l},L.remux=function(O,C,y,u,l){var c,d=this.initPTS,o=this.lastEndTime,a={audio:void 0,video:void 0,text:u,id3:y,initSegment:void 0};(0,N.isFiniteNumber)(o)||(o=this.lastEndTime=l||0);var s=C.samples;if(!s||!s.length)return a;var h={initPTS:void 0,timescale:1},p=this.initData;if((!p||!p.length)&&(this.generateInitSegment(s),p=this.initData),!p||!p.length)return K.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),a;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);var _=(0,F.getStartDTS)(p,s);(0,N.isFiniteNumber)(d)||(this.initPTS=h.initPTS=d=_-l);var v=(0,F.getDuration)(s,p),A=O?_-d:o,E=A+v;(0,F.offsetStartDTS)(p,s,d),v>0?this.lastEndTime=E:(K.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var g=!!p.audio,T=!!p.video,P="";g&&(P+="audio"),T&&(P+="video");var B={data1:s,startPTS:A,startDTS:A,endPTS:E,endDTS:E,type:P,hasAudio:g,hasVideo:T,nb:1,dropped:0};a.audio=B.type==="audio"?B:void 0,a.video=B.type!=="audio"?B:void 0,a.initSegment=h;var V=(c=this.initPTS)!=null?c:0;return a.id3=(0,x.flushTextTrackMetadataCueSamples)(y,l,V,V),u.samples.length&&(a.text=(0,x.flushTextTrackUserdataCueSamples)(u,l,V)),a},S}();function I(S,L){var R=S==null?void 0:S.codec;return R&&R.length>4?R:R==="hvc1"||R==="hev1"?"hvc1.1.c.L120.90":R==="av01"?"av01.0.04M.08":R==="avc1"||L===M.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const k=w},"./src/task-loop.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});var N=function(){function x(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var F=x.prototype;return F.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},F.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},F.onHandlerDestroyed=function(){},F.hasInterval=function(){return!!this._tickInterval},F.hasNextTick=function(){return!!this._tickTimer},F.setInterval=function(K){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,K),!0)},F.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},F.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},F.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},F.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},F.doTick=function(){},x}()},"./src/types/cmcd.ts":(b,D,m)=>{m.r(D),m.d(D,{CMCDObjectType:()=>x,CMCDStreamType:()=>M,CMCDStreamingFormat:()=>F,CMCDVersion:()=>N});var N=1,x;(function(K){K.MANIFEST="m",K.AUDIO="a",K.VIDEO="v",K.MUXED="av",K.INIT="i",K.CAPTION="c",K.TIMED_TEXT="tt",K.KEY="k",K.OTHER="o"})(x||(x={}));var F;(function(K){K.DASH="d",K.HLS="h",K.SMOOTH="s",K.OTHER="o"})(F||(F={}));var M;(function(K){K.VOD="v",K.LIVE="l"})(M||(M={}))},"./src/types/demuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{MetadataSchema:()=>N});var N;(function(x){x.audioId3="org.id3",x.dateRange="com.apple.quicktime.HLS",x.emsg="https://aomedia.org/emsg/ID3"})(N||(N={}))},"./src/types/level.ts":(b,D,m)=>{m.r(D),m.d(D,{HlsSkip:()=>F,HlsUrlParameters:()=>K,Level:()=>w,getSkipValue:()=>M});function N(I,k){for(var S=0;S<k.length;S++){var L=k[S];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(I,L.key,L)}}function x(I,k,S){return k&&N(I.prototype,k),S&&N(I,S),Object.defineProperty(I,"prototype",{writable:!1}),I}var F;(function(I){I.No="",I.Yes="YES",I.v2="v2"})(F||(F={}));function M(I,k){var S=I.canSkipUntil,L=I.canSkipDateRanges,R=I.endSN,O=k!==void 0?k-R:0;return S&&O<S?L?F.v2:F.Yes:F.No}var K=function(){function I(S,L,R){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=S,this.part=L,this.skip=R}var k=I.prototype;return k.addDirectives=function(L){var R=new self.URL(L);return this.msn!==void 0&&R.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&R.searchParams.set("_HLS_part",this.part.toString()),this.skip&&R.searchParams.set("_HLS_skip",this.skip),R.toString()},I}(),w=function(){function I(k){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[k.url],this.attrs=k.attrs,this.bitrate=k.bitrate,k.details&&(this.details=k.details),this.id=k.id||0,this.name=k.name,this.width=k.width||0,this.height=k.height||0,this.audioCodec=k.audioCodec,this.videoCodec=k.videoCodec,this.unknownCodecs=k.unknownCodecs,this.codecSet=[k.videoCodec,k.audioCodec].filter(function(S){return S}).join(",").replace(/\.[^.,]+/g,"")}return x(I,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(S){var L=S%this.url.length;this._urlId!==L&&(this.details=void 0,this._urlId=L)}}]),I}()},"./src/types/loader.ts":(b,D,m)=>{m.r(D),m.d(D,{PlaylistContextType:()=>N,PlaylistLevelType:()=>x});var N;(function(F){F.MANIFEST="manifest",F.LEVEL="level",F.AUDIO_TRACK="audioTrack",F.SUBTITLE_TRACK="subtitleTrack"})(N||(N={}));var x;(function(F){F.MAIN="main",F.AUDIO="audio",F.SUBTITLE="subtitle"})(x||(x={}))},"./src/types/transmuxer.ts":(b,D,m)=>{m.r(D),m.d(D,{ChunkMetadata:()=>N});var N=function(M,K,w,I,k,S){I===void 0&&(I=0),k===void 0&&(k=-1),S===void 0&&(S=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=x(),this.buffering={audio:x(),video:x(),audiovideo:x()},this.level=M,this.sn=K,this.id=w,this.size=I,this.part=k,this.partial=S};function x(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":(b,D,m)=>{m.r(D),m.d(D,{AttrList:()=>F});var N=/^(\d+)x(\d+)$/,x=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,F=function(){function M(w){typeof w=="string"&&(w=M.parseAttrList(w));for(var I in w)w.hasOwnProperty(I)&&(this[I]=w[I])}var K=M.prototype;return K.decimalInteger=function(I){var k=parseInt(this[I],10);return k>Number.MAX_SAFE_INTEGER?1/0:k},K.hexadecimalInteger=function(I){if(this[I]){var k=(this[I]||"0x").slice(2);k=(k.length&1?"0":"")+k;for(var S=new Uint8Array(k.length/2),L=0;L<k.length/2;L++)S[L]=parseInt(k.slice(L*2,L*2+2),16);return S}else return null},K.hexadecimalIntegerAsNumber=function(I){var k=parseInt(this[I],16);return k>Number.MAX_SAFE_INTEGER?1/0:k},K.decimalFloatingPoint=function(I){return parseFloat(this[I])},K.optionalFloat=function(I,k){var S=this[I];return S?parseFloat(S):k},K.enumeratedString=function(I){return this[I]},K.bool=function(I){return this[I]==="YES"},K.decimalResolution=function(I){var k=N.exec(this[I]);if(k!==null)return{width:parseInt(k[1],10),height:parseInt(k[2],10)}},M.parseAttrList=function(I){var k,S={},L='"';for(x.lastIndex=0;(k=x.exec(I))!==null;){var R=k[2];R.indexOf(L)===0&&R.lastIndexOf(L)===R.length-1&&(R=R.slice(1,-1)),S[k[1]]=R}return S},M}()},"./src/utils/binary-search.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>x});var N={search:function(M,K){for(var w=0,I=M.length-1,k=null,S=null;w<=I;){k=(w+I)/2|0,S=M[k];var L=K(S);if(L>0)w=k+1;else if(L<0)I=k-1;else return S}return null}};const x=N},"./src/utils/buffer-helper.ts":(b,D,m)=>{m.r(D),m.d(D,{BufferHelper:()=>F});var N=m("./src/utils/logger.ts"),x={length:0,start:function(){return 0},end:function(){return 0}},F=function(){function M(){}return M.isBuffered=function(w,I){try{if(w){for(var k=M.getBuffered(w),S=0;S<k.length;S++)if(I>=k.start(S)&&I<=k.end(S))return!0}}catch{}return!1},M.bufferInfo=function(w,I,k){try{if(w){var S=M.getBuffered(w),L=[],R;for(R=0;R<S.length;R++)L.push({start:S.start(R),end:S.end(R)});return this.bufferedInfo(L,I,k)}}catch{}return{len:0,start:I,end:I,nextStart:void 0}},M.bufferedInfo=function(w,I,k){I=Math.max(0,I),w.sort(function(a,s){var h=a.start-s.start;return h||s.end-a.end});var S=[];if(k)for(var L=0;L<w.length;L++){var R=S.length;if(R){var O=S[R-1].end;w[L].start-O<k?w[L].end>O&&(S[R-1].end=w[L].end):S.push(w[L])}else S.push(w[L])}else S=w;for(var C=0,y,u=I,l=I,c=0;c<S.length;c++){var d=S[c].start,o=S[c].end;if(I+k>=d&&I<o)u=d,l=o,C=l-I;else if(I+k<d){y=d;break}}return{len:C,start:u||0,end:l||0,nextStart:y}},M.getBuffered=function(w){try{return w.buffered}catch(I){return N.logger.log("failed to get media.buffered",I),x}},M}()},"./src/utils/cea-608-parser.ts":(b,D,m)=>{m.r(D),m.d(D,{CaptionScreen:()=>c,Row:()=>l,default:()=>p});var N=m("./src/utils/logger.ts"),x={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},F=function(v){var A=v;return x.hasOwnProperty(v)&&(A=x[v]),String.fromCharCode(A)},M=15,K=100,w={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},I={17:2,18:4,21:6,22:8,23:10,19:13,20:15},k={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},S={25:2,26:4,29:6,30:8,31:10,27:13,28:15},L=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],R;(function(_){_[_.ERROR=0]="ERROR",_[_.TEXT=1]="TEXT",_[_.WARNING=2]="WARNING",_[_.INFO=2]="INFO",_[_.DEBUG=3]="DEBUG",_[_.DATA=3]="DATA"})(R||(R={}));var O=function(){function _(){this.time=null,this.verboseLevel=R.ERROR}var v=_.prototype;return v.log=function(E,g){this.verboseLevel>=E&&N.logger.log(this.time+" ["+E+"] "+g)},_}(),C=function(v){for(var A=[],E=0;E<v.length;E++)A.push(v[E].toString(16));return A},y=function(){function _(A,E,g,T,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=A||"white",this.underline=E||!1,this.italics=g||!1,this.background=T||"black",this.flash=P||!1}var v=_.prototype;return v.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},v.setStyles=function(E){for(var g=["foreground","underline","italics","background","flash"],T=0;T<g.length;T++){var P=g[T];E.hasOwnProperty(P)&&(this[P]=E[P])}},v.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},v.equals=function(E){return this.foreground===E.foreground&&this.underline===E.underline&&this.italics===E.italics&&this.background===E.background&&this.flash===E.flash},v.copy=function(E){this.foreground=E.foreground,this.underline=E.underline,this.italics=E.italics,this.background=E.background,this.flash=E.flash},v.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},_}(),u=function(){function _(A,E,g,T,P,B){this.uchar=void 0,this.penState=void 0,this.uchar=A||" ",this.penState=new y(E,g,T,P,B)}var v=_.prototype;return v.reset=function(){this.uchar=" ",this.penState.reset()},v.setChar=function(E,g){this.uchar=E,this.penState.copy(g)},v.setPenState=function(E){this.penState.copy(E)},v.equals=function(E){return this.uchar===E.uchar&&this.penState.equals(E.penState)},v.copy=function(E){this.uchar=E.uchar,this.penState.copy(E.penState)},v.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},_}(),l=function(){function _(A){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var E=0;E<K;E++)this.chars.push(new u);this.logger=A,this.pos=0,this.currPenState=new y}var v=_.prototype;return v.equals=function(E){for(var g=!0,T=0;T<K;T++)if(!this.chars[T].equals(E.chars[T])){g=!1;break}return g},v.copy=function(E){for(var g=0;g<K;g++)this.chars[g].copy(E.chars[g])},v.isEmpty=function(){for(var E=!0,g=0;g<K;g++)if(!this.chars[g].isEmpty()){E=!1;break}return E},v.setCursor=function(E){this.pos!==E&&(this.pos=E),this.pos<0?(this.logger.log(R.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>K&&(this.logger.log(R.DEBUG,"Too large cursor position "+this.pos),this.pos=K)},v.moveCursor=function(E){var g=this.pos+E;if(E>1)for(var T=this.pos+1;T<g+1;T++)this.chars[T].setPenState(this.currPenState);this.setCursor(g)},v.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},v.insertChar=function(E){E>=144&&this.backSpace();var g=F(E);if(this.pos>=K){this.logger.log(R.ERROR,"Cannot insert "+E.toString(16)+" ("+g+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(g,this.currPenState),this.moveCursor(1)},v.clearFromPos=function(E){var g;for(g=E;g<K;g++)this.chars[g].reset()},v.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},v.clearToEndOfRow=function(){this.clearFromPos(this.pos)},v.getTextString=function(){for(var E=[],g=!0,T=0;T<K;T++){var P=this.chars[T].uchar;P!==" "&&(g=!1),E.push(P)}return g?"":E.join("")},v.setPenStyles=function(E){this.currPenState.setStyles(E);var g=this.chars[this.pos];g.setPenState(this.currPenState)},_}(),c=function(){function _(A){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var E=0;E<M;E++)this.rows.push(new l(A));this.logger=A,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var v=_.prototype;return v.reset=function(){for(var E=0;E<M;E++)this.rows[E].clear();this.currRow=M-1},v.equals=function(E){for(var g=!0,T=0;T<M;T++)if(!this.rows[T].equals(E.rows[T])){g=!1;break}return g},v.copy=function(E){for(var g=0;g<M;g++)this.rows[g].copy(E.rows[g])},v.isEmpty=function(){for(var E=!0,g=0;g<M;g++)if(!this.rows[g].isEmpty()){E=!1;break}return E},v.backSpace=function(){var E=this.rows[this.currRow];E.backSpace()},v.clearToEndOfRow=function(){var E=this.rows[this.currRow];E.clearToEndOfRow()},v.insertChar=function(E){var g=this.rows[this.currRow];g.insertChar(E)},v.setPen=function(E){var g=this.rows[this.currRow];g.setPenStyles(E)},v.moveCursor=function(E){var g=this.rows[this.currRow];g.moveCursor(E)},v.setCursor=function(E){this.logger.log(R.INFO,"setCursor: "+E);var g=this.rows[this.currRow];g.setCursor(E)},v.setPAC=function(E){this.logger.log(R.INFO,"pacData = "+JSON.stringify(E));var g=E.row-1;if(this.nrRollUpRows&&g<this.nrRollUpRows-1&&(g=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==g){for(var T=0;T<M;T++)this.rows[T].clear();var P=this.currRow+1-this.nrRollUpRows,B=this.lastOutputScreen;if(B){var V=B.rows[P].cueStartTime,W=this.logger.time;if(V&&W!==null&&V<W)for(var j=0;j<this.nrRollUpRows;j++)this.rows[g-this.nrRollUpRows+j+1].copy(B.rows[P+j])}}this.currRow=g;var z=this.rows[this.currRow];if(E.indent!==null){var Q=E.indent,Z=Math.max(Q-1,0);z.setCursor(E.indent),E.color=z.chars[Z].penState.foreground}var ee={foreground:E.color,underline:E.underline,italics:E.italics,background:"black",flash:!1};this.setPen(ee)},v.setBkgData=function(E){this.logger.log(R.INFO,"bkgData = "+JSON.stringify(E)),this.backSpace(),this.setPen(E),this.insertChar(32)},v.setRollUpRows=function(E){this.nrRollUpRows=E},v.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(R.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(R.TEXT,this.getDisplayText());var E=this.currRow+1-this.nrRollUpRows,g=this.rows.splice(E,1)[0];g.clear(),this.rows.splice(this.currRow,0,g),this.logger.log(R.INFO,"Rolling up")},v.getDisplayText=function(E){E=E||!1;for(var g=[],T="",P=-1,B=0;B<M;B++){var V=this.rows[B].getTextString();V&&(P=B+1,E?g.push("Row "+P+": '"+V+"'"):g.push(V.trim()))}return g.length>0&&(E?T="["+g.join(" | ")+"]":T=g.join(`
`)),T},v.getTextAndFormat=function(){return this.rows},_}(),d=function(){function _(A,E,g){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=A,this.outputFilter=E,this.mode=null,this.verbose=0,this.displayedMemory=new c(g),this.nonDisplayedMemory=new c(g),this.lastOutputScreen=new c(g),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=g}var v=_.prototype;return v.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},v.getHandler=function(){return this.outputFilter},v.setHandler=function(E){this.outputFilter=E},v.setPAC=function(E){this.writeScreen.setPAC(E)},v.setBkgData=function(E){this.writeScreen.setBkgData(E)},v.setMode=function(E){E!==this.mode&&(this.mode=E,this.logger.log(R.INFO,"MODE="+E),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=E)},v.insertChars=function(E){for(var g=0;g<E.length;g++)this.writeScreen.insertChar(E[g]);var T=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(R.INFO,T+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(R.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},v.ccRCL=function(){this.logger.log(R.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},v.ccBS=function(){this.logger.log(R.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},v.ccAOF=function(){},v.ccAON=function(){},v.ccDER=function(){this.logger.log(R.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},v.ccRU=function(E){this.logger.log(R.INFO,"RU("+E+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(E)},v.ccFON=function(){this.logger.log(R.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},v.ccRDC=function(){this.logger.log(R.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},v.ccTR=function(){this.logger.log(R.INFO,"TR"),this.setMode("MODE_TEXT")},v.ccRTD=function(){this.logger.log(R.INFO,"RTD"),this.setMode("MODE_TEXT")},v.ccEDM=function(){this.logger.log(R.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},v.ccCR=function(){this.logger.log(R.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},v.ccENM=function(){this.logger.log(R.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},v.ccEOC=function(){if(this.logger.log(R.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var E=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=E,this.writeScreen=this.nonDisplayedMemory,this.logger.log(R.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},v.ccTO=function(E){this.logger.log(R.INFO,"TO("+E+") - Tab Offset"),this.writeScreen.moveCursor(E)},v.ccMIDROW=function(E){var g={flash:!1};if(g.underline=E%2===1,g.italics=E>=46,g.italics)g.foreground="white";else{var T=Math.floor(E/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];g.foreground=P[T]}this.logger.log(R.INFO,"MIDROW: "+JSON.stringify(g)),this.writeScreen.setPen(g)},v.outputDataUpdate=function(E){E===void 0&&(E=!1);var g=this.logger.time;g!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=g:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,g,this.lastOutputScreen),E&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:g),this.lastOutputScreen.copy(this.displayedMemory))},v.cueSplitAtTime=function(E){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,E,this.displayedMemory),this.cueStartTime=E))},_}(),o=function(){function _(A,E,g){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var T=new O;this.channels=[null,new d(A,E,T),new d(A+1,g,T)],this.cmdHistory=h(),this.logger=T}var v=_.prototype;return v.getHandler=function(E){return this.channels[E].getHandler()},v.setHandler=function(E,g){this.channels[E].setHandler(g)},v.addData=function(E,g){var T,P,B,V=!1;this.logger.time=E;for(var W=0;W<g.length;W+=2)if(P=g[W]&127,B=g[W+1]&127,!(P===0&&B===0)){if(this.logger.log(R.DATA,"["+C([g[W],g[W+1]])+"] -> ("+C([P,B])+")"),T=this.parseCmd(P,B),T||(T=this.parseMidrow(P,B)),T||(T=this.parsePAC(P,B)),T||(T=this.parseBackgroundAttributes(P,B)),!T&&(V=this.parseChars(P,B),V)){var j=this.currentChannel;if(j&&j>0){var z=this.channels[j];z.insertChars(V)}else this.logger.log(R.WARNING,"No channel found yet. TEXT-MODE?")}!T&&!V&&this.logger.log(R.WARNING,"Couldn't parse cleaned data "+C([P,B])+" orig: "+C([g[W],g[W+1]]))}},v.parseCmd=function(E,g){var T=this.cmdHistory,P=(E===20||E===28||E===21||E===29)&&g>=32&&g<=47,B=(E===23||E===31)&&g>=33&&g<=35;if(!(P||B))return!1;if(s(E,g,T))return a(null,null,T),this.logger.log(R.DEBUG,"Repeated command ("+C([E,g])+") is dropped"),!0;var V=E===20||E===21||E===23?1:2,W=this.channels[V];return E===20||E===21||E===28||E===29?g===32?W.ccRCL():g===33?W.ccBS():g===34?W.ccAOF():g===35?W.ccAON():g===36?W.ccDER():g===37?W.ccRU(2):g===38?W.ccRU(3):g===39?W.ccRU(4):g===40?W.ccFON():g===41?W.ccRDC():g===42?W.ccTR():g===43?W.ccRTD():g===44?W.ccEDM():g===45?W.ccCR():g===46?W.ccENM():g===47&&W.ccEOC():W.ccTO(g-32),a(E,g,T),this.currentChannel=V,!0},v.parseMidrow=function(E,g){var T=0;if((E===17||E===25)&&g>=32&&g<=47){if(E===17?T=1:T=2,T!==this.currentChannel)return this.logger.log(R.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[T];return P?(P.ccMIDROW(g),this.logger.log(R.DEBUG,"MIDROW ("+C([E,g])+")"),!0):!1}return!1},v.parsePAC=function(E,g){var T,P=this.cmdHistory,B=(E>=17&&E<=23||E>=25&&E<=31)&&g>=64&&g<=127,V=(E===16||E===24)&&g>=64&&g<=95;if(!(B||V))return!1;if(s(E,g,P))return a(null,null,P),!0;var W=E<=23?1:2;g>=64&&g<=95?T=W===1?w[E]:k[E]:T=W===1?I[E]:S[E];var j=this.channels[W];return j?(j.setPAC(this.interpretPAC(T,g)),a(E,g,P),this.currentChannel=W,!0):!1},v.interpretPAC=function(E,g){var T,P={color:null,italics:!1,indent:null,underline:!1,row:E};return g>95?T=g-96:T=g-64,P.underline=(T&1)===1,T<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(T/2)]:T<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((T-16)/2)*4,P},v.parseChars=function(E,g){var T,P=null,B=null;if(E>=25?(T=2,B=E-8):(T=1,B=E),B>=17&&B<=19){var V;B===17?V=g+80:B===18?V=g+112:V=g+144,this.logger.log(R.INFO,"Special char '"+F(V)+"' in channel "+T),P=[V]}else E>=32&&E<=127&&(P=g===0?[E]:[E,g]);if(P){var W=C(P);this.logger.log(R.DEBUG,"Char codes =  "+W.join(",")),a(E,g,this.cmdHistory)}return P},v.parseBackgroundAttributes=function(E,g){var T=(E===16||E===24)&&g>=32&&g<=47,P=(E===23||E===31)&&g>=45&&g<=47;if(!(T||P))return!1;var B,V={};E===16||E===24?(B=Math.floor((g-32)/2),V.background=L[B],g%2===1&&(V.background=V.background+"_semi")):g===45?V.background="transparent":(V.foreground="black",g===47&&(V.underline=!0));var W=E<=23?1:2,j=this.channels[W];return j.setBkgData(V),a(E,g,this.cmdHistory),!0},v.reset=function(){for(var E=0;E<Object.keys(this.channels).length;E++){var g=this.channels[E];g&&g.reset()}this.cmdHistory=h()},v.cueSplitAtTime=function(E){for(var g=0;g<this.channels.length;g++){var T=this.channels[g];T&&T.cueSplitAtTime(E)}},_}();function a(_,v,A){A.a=_,A.b=v}function s(_,v,A){return A.a===_&&A.b===v}function h(){return{a:null,b:null}}const p=o},"./src/utils/codecs.ts":(b,D,m)=>{m.r(D),m.d(D,{isCodecSupportedInMp4:()=>F,isCodecType:()=>x});var N={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function x(M,K){var w=N[K];return!!w&&w[M.slice(0,4)]===!0}function F(M,K){return MediaSource.isTypeSupported((K||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>w});var N=m("./src/utils/vttparser.ts"),x=m("./src/utils/webvtt-parser.ts"),F=m("./src/utils/texttrack-utils.ts"),M=/\s/,K={newCue:function(k,S,L,R){for(var O=[],C,y,u,l,c,d=self.VTTCue||self.TextTrackCue,o=0;o<R.rows.length;o++)if(C=R.rows[o],u=!0,l=0,c="",!C.isEmpty()){for(var a=0;a<C.chars.length;a++)M.test(C.chars[a].uchar)&&u?l++:(c+=C.chars[a].uchar,u=!1);C.cueStartTime=S,S===L&&(L+=1e-4),l>=16?l--:l++;var s=(0,N.fixLineBreaks)(c.trim()),h=(0,x.generateCueId)(S,L,s);(!k||!k.cues||!k.cues.getCueById(h))&&(y=new d(S,L,s),y.id=h,y.line=o+1,y.align="left",y.position=10+Math.min(80,Math.floor(l*8/32)*10),O.push(y))}return k&&O.length&&(O.sort(function(p,_){return p.line==="auto"||_.line==="auto"?0:p.line>8&&_.line>8?_.line-p.line:p.line-_.line}),O.forEach(function(p){return(0,F.addCueToTrack)(k,p)})),O}};const w=K},"./src/utils/discontinuities.ts":(b,D,m)=>{m.r(D),m.d(D,{adjustSlidingStart:()=>k,alignMediaPlaylistByPDT:()=>O,alignPDT:()=>R,alignStream:()=>S,findDiscontinuousReferenceFrag:()=>w,findFirstFragWithCC:()=>M,shouldAlignOnDiscontinuities:()=>K});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/logger.ts"),F=m("./src/controller/level-helper.ts");function M(C,y){for(var u=null,l=0,c=C.length;l<c;l++){var d=C[l];if(d&&d.cc===y){u=d;break}}return u}function K(C,y,u){return!!(y.details&&(u.endCC>u.startCC||C&&C.cc<u.startCC))}function w(C,y,u){var l=C.fragments,c=y.fragments;if(!c.length||!l.length){x.logger.log("No fragments to align");return}var d=M(l,c[0].cc);if(!d||d&&!d.startPTS){x.logger.log("No frag in previous level to align on");return}return d}function I(C,y){if(C){var u=C.start+y;C.start=C.startPTS=u,C.endPTS=u+C.duration}}function k(C,y){for(var u=y.fragments,l=0,c=u.length;l<c;l++)I(u[l],C);y.fragmentHint&&I(y.fragmentHint,C),y.alignedSliding=!0}function S(C,y,u){y&&(L(C,u,y),!u.alignedSliding&&y.details&&R(u,y.details),!u.alignedSliding&&y.details&&!u.skippedSegments&&(0,F.adjustSliding)(y.details,u))}function L(C,y,u){if(K(C,u,y)){var l=w(u.details,y);l&&(0,N.isFiniteNumber)(l.start)&&(x.logger.log("Adjusting PTS using last level due to CC increase within current level "+y.url),k(l.start,y))}}function R(C,y){if(!(!y.fragments.length||!C.hasProgramDateTime||!y.hasProgramDateTime)){var u=y.fragments[0].programDateTime,l=C.fragments[0].programDateTime,c=(l-u)/1e3+y.fragments[0].start;c&&(0,N.isFiniteNumber)(c)&&(x.logger.log("Adjusting PTS using programDateTime delta "+(l-u)+"ms, sliding:"+c.toFixed(3)+" "+C.url+" "),k(c,C))}}function O(C,y){if(!(!C.hasProgramDateTime||!y.hasProgramDateTime)){var u=C.fragments,l=y.fragments;if(!(!u.length||!l.length)){var c=Math.round(l.length/2)-1,d=l[c],o=M(u,d.cc)||u[Math.round(u.length/2)-1],a=d.programDateTime,s=o.programDateTime;if(!(a===null||s===null)){var h=(s-a)/1e3-(o.start-d.start);k(h,C)}}}}},"./src/utils/ewma-bandwidth-estimator.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>F});var N=m("./src/utils/ewma.ts"),x=function(){function M(w,I,k){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=k,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new N.default(w),this.fast_=new N.default(I)}var K=M.prototype;return K.update=function(I,k){var S=this.slow_,L=this.fast_;this.slow_.halfLife!==I&&(this.slow_=new N.default(I,S.getEstimate(),S.getTotalWeight())),this.fast_.halfLife!==k&&(this.fast_=new N.default(k,L.getEstimate(),L.getTotalWeight()))},K.sample=function(I,k){I=Math.max(I,this.minDelayMs_);var S=8*k,L=I/1e3,R=S/L;this.fast_.sample(L,R),this.slow_.sample(L,R)},K.canEstimate=function(){var I=this.fast_;return I&&I.getTotalWeight()>=this.minWeight_},K.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},K.destroy=function(){},M}();const F=x},"./src/utils/ewma.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>x});var N=function(){function F(K,w,I){w===void 0&&(w=0),I===void 0&&(I=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=K,this.alpha_=K?Math.exp(Math.log(.5)/K):0,this.estimate_=w,this.totalWeight_=I}var M=F.prototype;return M.sample=function(w,I){var k=Math.pow(this.alpha_,w);this.estimate_=I*(1-k)+k*this.estimate_,this.totalWeight_+=w},M.getTotalWeight=function(){return this.totalWeight_},M.getEstimate=function(){if(this.alpha_){var w=1-Math.pow(this.alpha_,this.totalWeight_);if(w)return this.estimate_/w}return this.estimate_},F}();const x=N},"./src/utils/fetch-loader.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>c,fetchSupported:()=>O});var N=m("./src/polyfills/number.ts"),x=m("./src/loader/load-stats.ts"),F=m("./src/demux/chunk-cache.ts");function M(d,o){d.prototype=Object.create(o.prototype),d.prototype.constructor=d,S(d,o)}function K(d){var o=typeof Map=="function"?new Map:void 0;return K=function(s){if(s===null||!k(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(s))return o.get(s);o.set(s,h)}function h(){return w(s,arguments,L(this).constructor)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),S(h,s)},K(d)}function w(d,o,a){return I()?w=Reflect.construct.bind():w=function(h,p,_){var v=[null];v.push.apply(v,p);var A=Function.bind.apply(h,v),E=new A;return _&&S(E,_.prototype),E},w.apply(null,arguments)}function I(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k(d){return Function.toString.call(d).indexOf("[native code]")!==-1}function S(d,o){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,h){return s.__proto__=h,s},S(d,o)}function L(d){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},L(d)}function R(){return R=Object.assign?Object.assign.bind():function(d){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(d[s]=a[s])}return d},R.apply(this,arguments)}function O(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var C=function(){function d(a){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=a.fetchSetup||u,this.controller=new self.AbortController,this.stats=new x.LoadStats}var o=d.prototype;return o.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function(){var s=this.response;(!s||!s.ok)&&(this.stats.aborted=!0,this.controller.abort())},o.abort=function(){var s;this.abortInternal(),(s=this.callbacks)!==null&&s!==void 0&&s.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function(s,h,p){var _=this,v=this.stats;if(v.loading.start)throw new Error("Loader can only be used once.");v.loading.start=self.performance.now();var A=y(s,this.controller.signal),E=p.onProgress,g=s.responseType==="arraybuffer",T=g?"byteLength":"length";this.context=s,this.config=h,this.callbacks=p,this.request=this.fetchSetup(s,A),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){_.abortInternal(),p.onTimeout(v,s,_.response)},h.timeout),self.fetch(this.request).then(function(P){if(_.response=_.loader=P,!P.ok){var B=P.status,V=P.statusText;throw new l(V||"fetch, bad network response",B,P)}return v.loading.first=Math.max(self.performance.now(),v.loading.start),v.total=parseInt(P.headers.get("Content-Length")||"0"),E&&(0,N.isFiniteNumber)(h.highWaterMark)?_.loadProgressively(P,v,s,h.highWaterMark,E):g?P.arrayBuffer():P.text()}).then(function(P){var B=_.response;self.clearTimeout(_.requestTimeout),v.loading.end=Math.max(self.performance.now(),v.loading.first);var V=P[T];V&&(v.loaded=v.total=V);var W={url:B.url,data:P};E&&!(0,N.isFiniteNumber)(h.highWaterMark)&&E(v,s,P,B),p.onSuccess(W,v,s,B)}).catch(function(P){if(self.clearTimeout(_.requestTimeout),!v.aborted){var B=P&&P.code||0,V=P?P.message:null;p.onError({code:B,text:V},s,P?P.details:null)}})},o.getCacheAge=function(){var s=null;if(this.response){var h=this.response.headers.get("age");s=h?parseFloat(h):null}return s},o.loadProgressively=function(s,h,p,_,v){_===void 0&&(_=0);var A=new F.default,E=s.body.getReader(),g=function T(){return E.read().then(function(P){if(P.done)return A.dataLength&&v(h,p,A.flush(),s),Promise.resolve(new ArrayBuffer(0));var B=P.value,V=B.length;return h.loaded+=V,V<_||A.dataLength?(A.push(B),A.dataLength>=_&&v(h,p,A.flush(),s)):v(h,p,B,s),T()}).catch(function(){return Promise.reject()})};return g()},d}();function y(d,o){var a={method:"GET",mode:"cors",credentials:"same-origin",signal:o,headers:new self.Headers(R({},d.headers))};return d.rangeEnd&&a.headers.set("Range","bytes="+d.rangeStart+"-"+String(d.rangeEnd-1)),a}function u(d,o){return new self.Request(d.url,o)}var l=function(d){M(o,d);function o(a,s,h){var p;return p=d.call(this,a)||this,p.code=void 0,p.details=void 0,p.code=s,p.details=h,p}return o}(K(Error));const c=C},"./src/utils/imsc1-ttml-parser.ts":(b,D,m)=>{m.r(D),m.d(D,{IMSC1_CODEC:()=>k,parseIMSC1:()=>O});var N=m("./src/utils/mp4-tools.ts"),x=m("./src/utils/vttparser.ts"),F=m("./src/utils/vttcue.ts"),M=m("./src/demux/id3.ts"),K=m("./src/utils/timescale-conversion.ts"),w=m("./src/utils/webvtt-parser.ts");function I(){return I=Object.assign?Object.assign.bind():function(p){for(var _=1;_<arguments.length;_++){var v=arguments[_];for(var A in v)Object.prototype.hasOwnProperty.call(v,A)&&(p[A]=v[A])}return p},I.apply(this,arguments)}var k="stpp.ttml.im1t",S=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,L=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,R={left:"start",center:"center",right:"end",start:"start",end:"end"};function O(p,_,v,A,E){var g=(0,N.findBox)(new Uint8Array(p),["mdat"]);if(g.length===0){E(new Error("Could not parse IMSC1 mdat"));return}var T=g.map(function(B){return(0,M.utf8ArrayToStr)(B)}),P=(0,K.toTimescaleFromScale)(_,1,v);try{T.forEach(function(B){return A(C(B,P))})}catch(B){E(B)}}function C(p,_){var v=new DOMParser,A=v.parseFromString(p,"text/xml"),E=A.getElementsByTagName("tt")[0];if(!E)throw new Error("Invalid ttml");var g={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},T=Object.keys(g).reduce(function(j,z){return j[z]=E.getAttribute("ttp:"+z)||g[z],j},{}),P=E.getAttribute("xml:space")!=="preserve",B=u(y(E,"styling","style")),V=u(y(E,"layout","region")),W=y(E,"body","[begin]");return[].map.call(W,function(j){var z=l(j,P);if(!z||!j.hasAttribute("begin"))return null;var Q=a(j.getAttribute("begin"),T),Z=a(j.getAttribute("dur"),T),ee=a(j.getAttribute("end"),T);if(Q===null)throw o(j);if(ee===null){if(Z===null)throw o(j);ee=Q+Z}var ae=new F.default(Q-_,ee-_,z);ae.id=(0,w.generateCueId)(ae.startTime,ae.endTime,ae.text);var se=V[j.getAttribute("region")],Y=B[j.getAttribute("style")];ae.position=10,ae.size=80;var X=c(se,Y,B),q=X.textAlign;if(q){var re=R[q];re&&(ae.lineAlign=re),ae.align=q}return I(ae,X),ae}).filter(function(j){return j!==null})}function y(p,_,v){var A=p.getElementsByTagName(_)[0];return A?[].slice.call(A.querySelectorAll(v)):[]}function u(p){return p.reduce(function(_,v){var A=v.getAttribute("xml:id");return A&&(_[A]=v),_},{})}function l(p,_){return[].slice.call(p.childNodes).reduce(function(v,A,E){var g;return A.nodeName==="br"&&E?v+`
`:(g=A.childNodes)!==null&&g!==void 0&&g.length?l(A,_):_?v+A.textContent.trim().replace(/\s+/g," "):v+A.textContent},"")}function c(p,_,v){var A="http://www.w3.org/ns/ttml#styling",E=null,g=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],T=p!=null&&p.hasAttribute("style")?p.getAttribute("style"):null;return T&&v.hasOwnProperty(T)&&(E=v[T]),g.reduce(function(P,B){var V=d(_,A,B)||d(p,A,B)||d(E,A,B);return V&&(P[B]=V),P},{})}function d(p,_,v){return p&&p.hasAttributeNS(_,v)?p.getAttributeNS(_,v):null}function o(p){return new Error("Could not parse ttml timestamp "+p)}function a(p,_){if(!p)return null;var v=(0,x.parseTimeStamp)(p);return v===null&&(S.test(p)?v=s(p,_):L.test(p)&&(v=h(p,_))),v}function s(p,_){var v=S.exec(p),A=(v[4]|0)+(v[5]|0)/_.subFrameRate;return(v[1]|0)*3600+(v[2]|0)*60+(v[3]|0)+A/_.frameRate}function h(p,_){var v=L.exec(p),A=Number(v[1]),E=v[2];switch(E){case"h":return A*3600;case"m":return A*60;case"ms":return A*1e3;case"f":return A/_.frameRate;case"t":return A/_.tickRate}return A}},"./src/utils/logger.ts":(b,D,m)=>{m.r(D),m.d(D,{enableLogs:()=>w,logger:()=>I});var N=function(){},x={trace:N,debug:N,log:N,warn:N,info:N,error:N},F=x;function M(k){var S=self.console[k];return S?S.bind(self.console,"["+k+"] >"):N}function K(k){for(var S=arguments.length,L=new Array(S>1?S-1:0),R=1;R<S;R++)L[R-1]=arguments[R];L.forEach(function(O){F[O]=k[O]?k[O].bind(k):M(O)})}function w(k,S){if(self.console&&k===!0||typeof k=="object"){K(k,"debug","log","info","warn","error");try{F.log('Debug logs enabled for "'+S+'"')}catch{F=x}}else F=x}var I=F},"./src/utils/mediakeys-helper.ts":(b,D,m)=>{m.r(D),m.d(D,{KeySystems:()=>N,requestMediaKeySystemAccess:()=>x});var N;(function(F){F.WIDEVINE="com.widevine.alpha",F.PLAYREADY="com.microsoft.playready"})(N||(N={}));var x=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":(b,D,m)=>{m.r(D),m.d(D,{getMediaSource:()=>N});function N(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":(b,D,m)=>{m.r(D),m.d(D,{RemuxerTrackIdConfig:()=>w,appendUint8Array:()=>a,bin2str:()=>I,computeRawDurationFromSamples:()=>c,discardEPB:()=>v,findBox:()=>O,getDuration:()=>l,getStartDTS:()=>u,offsetStartDTS:()=>d,parseEmsg:()=>A,parseInitSegment:()=>y,parseSEIMessageFromNALu:()=>_,parseSamples:()=>s,parseSegmentIndex:()=>C,readSint32:()=>L,readUint16:()=>k,readUint32:()=>S,segmentValidRange:()=>o,writeUint32:()=>R});var N=m("./src/utils/typed-array.ts"),x=m("./src/loader/fragment.ts"),F=m("./src/demux/id3.ts"),M=Math.pow(2,32)-1,K=[].push,w={video:1,audio:2,id3:3,text:4};function I(E){return String.fromCharCode.apply(null,E)}function k(E,g){var T=E[g]<<8|E[g+1];return T<0?65536+T:T}function S(E,g){var T=L(E,g);return T<0?4294967296+T:T}function L(E,g){return E[g]<<24|E[g+1]<<16|E[g+2]<<8|E[g+3]}function R(E,g,T){E[g]=T>>24,E[g+1]=T>>16&255,E[g+2]=T>>8&255,E[g+3]=T&255}function O(E,g){var T=[];if(!g.length)return T;for(var P=E.byteLength,B=0;B<P;){var V=S(E,B),W=I(E.subarray(B+4,B+8)),j=V>1?B+V:P;if(W===g[0])if(g.length===1)T.push(E.subarray(B+8,j));else{var z=O(E.subarray(B+8,j),g.slice(1));z.length&&K.apply(T,z)}B=j}return T}function C(E){var g=[],T=E[0],P=8,B=S(E,P);P+=4;var V=0,W=0;T===0?P+=8:P+=16,P+=2;var j=E.length+W,z=k(E,P);P+=2;for(var Q=0;Q<z;Q++){var Z=P,ee=S(E,Z);Z+=4;var ae=ee&2147483647,se=(ee&2147483648)>>>31;if(se===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var Y=S(E,Z);Z+=4,g.push({referenceSize:ae,subsegmentDuration:Y,info:{duration:Y/B,start:j,end:j+ae-1}}),j+=ae,Z+=4,P=Z}return{earliestPresentationTime:V,timescale:B,version:T,referencesCount:z,references:g}}function y(E){for(var g=[],T=O(E,["moov","trak"]),P=0;P<T.length;P++){var B=T[P],V=O(B,["tkhd"])[0];if(V){var W=V[0],j=W===0?12:20,z=S(V,j),Q=O(B,["mdia","mdhd"])[0];if(Q){W=Q[0],j=W===0?12:20;var Z=S(Q,j),ee=O(B,["mdia","hdlr"])[0];if(ee){var ae=I(ee.subarray(8,12)),se={soun:x.ElementaryStreamTypes.AUDIO,vide:x.ElementaryStreamTypes.VIDEO}[ae];if(se){var Y=O(B,["mdia","minf","stbl","stsd"])[0],X=void 0;Y&&(X=I(Y.subarray(12,16))),g[z]={timescale:Z,type:se},g[se]={timescale:Z,id:z,codec:X}}}}}}var q=O(E,["moov","mvex","trex"]);return q.forEach(function(re){var ne=S(re,4),U=g[ne];U&&(U.default={duration:S(re,12),flags:S(re,20)})}),g}function u(E,g){return O(g,["moof","traf"]).reduce(function(T,P){var B=O(P,["tfdt"])[0],V=B[0],W=O(P,["tfhd"]).reduce(function(j,z){var Q=S(z,4),Z=E[Q];if(Z){var ee=S(B,4);V===1&&(ee*=Math.pow(2,32),ee+=S(B,8));var ae=Z.timescale||9e4,se=ee/ae;if(isFinite(se)&&(j===null||se<j))return se}return j},null);return W!==null&&isFinite(W)&&(T===null||W<T)?W:T},null)||0}function l(E,g){for(var T=0,P=0,B=0,V=O(E,["moof","traf"]),W=0;W<V.length;W++){var j=V[W],z=O(j,["tfhd"])[0],Q=S(z,4),Z=g[Q];if(Z){var ee=Z.default,ae=S(z,0)|(ee==null?void 0:ee.flags),se=ee==null?void 0:ee.duration;ae&8&&(ae&2?se=S(z,12):se=S(z,8));for(var Y=Z.timescale||9e4,X=O(j,["trun"]),q=0;q<X.length;q++){if(T=c(X[q]),!T&&se){var re=S(X[q],4);T=se*re}Z.type===x.ElementaryStreamTypes.VIDEO?P+=T/Y:Z.type===x.ElementaryStreamTypes.AUDIO&&(B+=T/Y)}}}if(P===0&&B===0){for(var ne=0,U=O(E,["sidx"]),H=0;H<U.length;H++){var $=C(U[H]);$!=null&&$.references&&(ne+=$.references.reduce(function(J,te){return J+te.info.duration||0},0))}return ne}return P||B}function c(E){var g=S(E,0),T=8;g&1&&(T+=4),g&4&&(T+=4);for(var P=0,B=S(E,4),V=0;V<B;V++){if(g&256){var W=S(E,T);P+=W,T+=4}g&512&&(T+=4),g&1024&&(T+=4),g&2048&&(T+=4)}return P}function d(E,g,T){O(g,["moof","traf"]).forEach(function(P){O(P,["tfhd"]).forEach(function(B){var V=S(B,4),W=E[V];if(W){var j=W.timescale||9e4;O(P,["tfdt"]).forEach(function(z){var Q=z[0],Z=S(z,4);if(Q===0)Z-=T*j,Z=Math.max(Z,0),R(z,4,Z);else{Z*=Math.pow(2,32),Z+=S(z,8),Z-=T*j,Z=Math.max(Z,0);var ee=Math.floor(Z/(M+1)),ae=Math.floor(Z%(M+1));R(z,4,ee),R(z,8,ae)}})}})})}function o(E){var g={valid:null,remainder:null},T=O(E,["moof"]);if(T){if(T.length<2)return g.remainder=E,g}else return g;var P=T[T.length-1];return g.valid=(0,N.sliceUint8)(E,0,P.byteOffset-8),g.remainder=(0,N.sliceUint8)(E,P.byteOffset-8),g}function a(E,g){var T=new Uint8Array(E.length+g.length);return T.set(E),T.set(g,E.length),T}function s(E,g){var T=[],P=g.samples,B=g.timescale,V=g.id,W=!1,j=O(P,["moof"]);return j.map(function(z){var Q=z.byteOffset-8,Z=O(z,["traf"]);Z.map(function(ee){var ae=O(ee,["tfdt"]).map(function(se){var Y=se[0],X=S(se,4);return Y===1&&(X*=Math.pow(2,32),X+=S(se,8)),X/B})[0];return ae!==void 0&&(E=ae),O(ee,["tfhd"]).map(function(se){var Y=S(se,4),X=S(se,0)&16777215,q=(X&1)!==0,re=(X&2)!==0,ne=(X&8)!==0,U=0,H=(X&16)!==0,$=0,J=(X&32)!==0,te=8;Y===V&&(q&&(te+=8),re&&(te+=4),ne&&(U=S(se,te),te+=4),H&&($=S(se,te),te+=4),J&&(te+=4),g.type==="video"&&(W=h(g.codec)),O(ee,["trun"]).map(function(ie){var le=ie[0],oe=S(ie,0)&16777215,ue=(oe&1)!==0,fe=0,he=(oe&4)!==0,ge=(oe&256)!==0,Ae=0,Ce=(oe&512)!==0,Ie=0,Fe=(oe&1024)!==0,Ne=(oe&2048)!==0,We=0,De=S(ie,4),Te=8;ue&&(fe=S(ie,Te),Te+=4),he&&(Te+=4);for(var Re=fe+Q,et=0;et<De;et++){if(ge?(Ae=S(ie,Te),Te+=4):Ae=U,Ce?(Ie=S(ie,Te),Te+=4):Ie=$,Fe&&(Te+=4),Ne&&(le===0?We=S(ie,Te):We=L(ie,Te),Te+=4),g.type===x.ElementaryStreamTypes.VIDEO)for(var Oe=0;Oe<Ie;){var Be=S(P,Re);if(Re+=4,p(W,P[Re])){var Xe=P.subarray(Re,Re+Be);_(Xe,W?2:1,E+We/B,T)}Re+=Be,Oe+=Be+4}E+=Ae/B}}))})})}),T}function h(E){if(!E)return!1;var g=E.indexOf("."),T=g<0?E:E.substring(0,g);return T==="hvc1"||T==="hev1"||T==="dvh1"||T==="dvhe"}function p(E,g){if(E){var T=g>>1&63;return T===39||T===40}else{var P=g&31;return P===6}}function _(E,g,T,P){var B=v(E),V=0;V+=g;for(var W=0,j=0,z=!1,Q=0;V<B.length;){W=0;do{if(V>=B.length)break;Q=B[V++],W+=Q}while(Q===255);j=0;do{if(V>=B.length)break;Q=B[V++],j+=Q}while(Q===255);var Z=B.length-V;if(!z&&W===4&&V<B.length){z=!0;var ee=B[V++];if(ee===181){var ae=k(B,V);if(V+=2,ae===49){var se=S(B,V);if(V+=4,se===1195456820){var Y=B[V++];if(Y===3){var X=B[V++],q=31&X,re=64&X,ne=re?2+q*3:0,U=new Uint8Array(ne);if(re){U[0]=X;for(var H=1;H<ne;H++)U[H]=B[V++]}P.push({type:Y,payloadType:W,pts:T,bytes:U})}}}}}else if(W===5&&j<Z){if(z=!0,j>16){for(var $=[],J=0;J<16;J++){var te=B[V++].toString(16);$.push(te.length==1?"0"+te:te),(J===3||J===5||J===7||J===9)&&$.push("-")}for(var ie=j-16,le=new Uint8Array(ie),oe=0;oe<ie;oe++)le[oe]=B[V++];P.push({payloadType:W,pts:T,uuid:$.join(""),userData:(0,F.utf8ArrayToStr)(le),userDataBytes:le})}}else if(j<Z)V+=j;else if(j>Z)break}}function v(E){for(var g=E.byteLength,T=[],P=1;P<g-2;)E[P]===0&&E[P+1]===0&&E[P+2]===3?(T.push(P+2),P+=2):P++;if(T.length===0)return E;var B=g-T.length,V=new Uint8Array(B),W=0;for(P=0;P<B;W++,P++)W===T[0]&&(W++,T.shift()),V[P]=E[W];return V}function A(E){var g=E[0],T="",P="",B=0,V=0,W=0,j=0,z=0,Q=0;if(g===0){for(;I(E.subarray(Q,Q+1))!=="\0";)T+=I(E.subarray(Q,Q+1)),Q+=1;for(T+=I(E.subarray(Q,Q+1)),Q+=1;I(E.subarray(Q,Q+1))!=="\0";)P+=I(E.subarray(Q,Q+1)),Q+=1;P+=I(E.subarray(Q,Q+1)),Q+=1,B=S(E,12),V=S(E,16),j=S(E,20),z=S(E,24),Q=28}else if(g===1){Q+=4,B=S(E,Q),Q+=4;var Z=S(E,Q);Q+=4;var ee=S(E,Q);for(Q+=4,W=Math.pow(2,32)*Z+ee,Number.isSafeInteger(W)||(W=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),j=S(E,Q),Q+=4,z=S(E,Q),Q+=4;I(E.subarray(Q,Q+1))!=="\0";)T+=I(E.subarray(Q,Q+1)),Q+=1;for(T+=I(E.subarray(Q,Q+1)),Q+=1;I(E.subarray(Q,Q+1))!=="\0";)P+=I(E.subarray(Q,Q+1)),Q+=1;P+=I(E.subarray(Q,Q+1)),Q+=1}var ae=E.subarray(Q,E.byteLength);return{schemeIdUri:T,value:P,timeScale:B,presentationTime:W,presentationTimeDelta:V,eventDuration:j,id:z,payload:ae}}},"./src/utils/output-filter.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});var N=function(){function x(M,K){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=K}var F=x.prototype;return F.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},F.newCue=function(K,w,I){(this.startTime===null||this.startTime>K)&&(this.startTime=K),this.endTime=w,this.screen=I,this.timelineController.createCaptionsTrack(this.trackName)},F.reset=function(){this.cueRanges=[],this.startTime=null},x}()},"./src/utils/texttrack-utils.ts":(b,D,m)=>{m.r(D),m.d(D,{addCueToTrack:()=>F,clearCurrentCues:()=>M,getCuesInRange:()=>I,removeCuesInRange:()=>K,sendAddTrackEvent:()=>x});var N=m("./src/utils/logger.ts");function x(k,S){var L;try{L=new Event("addtrack")}catch{L=document.createEvent("Event"),L.initEvent("addtrack",!1,!1)}L.track=k,S.dispatchEvent(L)}function F(k,S){var L=k.mode;if(L==="disabled"&&(k.mode="hidden"),k.cues&&!k.cues.getCueById(S.id))try{if(k.addCue(S),!k.cues.getCueById(S.id))throw new Error("addCue is failed for: "+S)}catch(O){N.logger.debug("[texttrack-utils]: "+O);var R=new self.TextTrackCue(S.startTime,S.endTime,S.text);R.id=S.id,k.addCue(R)}L==="disabled"&&(k.mode=L)}function M(k){var S=k.mode;if(S==="disabled"&&(k.mode="hidden"),k.cues)for(var L=k.cues.length;L--;)k.removeCue(k.cues[L]);S==="disabled"&&(k.mode=S)}function K(k,S,L,R){var O=k.mode;if(O==="disabled"&&(k.mode="hidden"),k.cues&&k.cues.length>0)for(var C=I(k.cues,S,L),y=0;y<C.length;y++)(!R||R(C[y]))&&k.removeCue(C[y]);O==="disabled"&&(k.mode=O)}function w(k,S){if(S<k[0].startTime)return 0;var L=k.length-1;if(S>k[L].endTime)return-1;for(var R=0,O=L;R<=O;){var C=Math.floor((O+R)/2);if(S<k[C].startTime)O=C-1;else if(S>k[C].startTime&&R<L)R=C+1;else return C}return k[R].startTime-S<S-k[O].startTime?R:O}function I(k,S,L){var R=[],O=w(k,S);if(O>-1)for(var C=O,y=k.length;C<y;C++){var u=k[C];if(u.startTime>=S&&u.endTime<=L)R.push(u);else if(u.startTime>L)return R}return R}},"./src/utils/time-ranges.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>x});var N={toString:function(M){for(var K="",w=M.length,I=0;I<w;I++)K+="["+M.start(I).toFixed(3)+","+M.end(I).toFixed(3)+"]";return K}};const x=N},"./src/utils/timescale-conversion.ts":(b,D,m)=>{m.r(D),m.d(D,{toMpegTsClockFromTimescale:()=>K,toMsFromMpegTsClock:()=>M,toTimescaleFromBase:()=>x,toTimescaleFromScale:()=>F});var N=9e4;function x(w,I,k,S){k===void 0&&(k=1),S===void 0&&(S=!1);var L=w*I*k;return S?Math.round(L):L}function F(w,I,k,S){return k===void 0&&(k=1),S===void 0&&(S=!1),x(w,I,1/k,S)}function M(w,I){return I===void 0&&(I=!1),x(w,1e3,1/N,I)}function K(w,I){return I===void 0&&(I=1),x(w,N,1/I)}},"./src/utils/typed-array.ts":(b,D,m)=>{m.r(D),m.d(D,{sliceUint8:()=>N});function N(x,F,M){return Uint8Array.prototype.slice?x.slice(F,M):new Uint8Array(Array.prototype.slice.call(x,F,M))}},"./src/utils/vttcue.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>N});const N=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var x=["","lr","rl"],F=["start","middle","end","left","right"];function M(S,L){if(typeof L!="string"||!Array.isArray(S))return!1;var R=L.toLowerCase();return~S.indexOf(R)?R:!1}function K(S){return M(x,S)}function w(S){return M(F,S)}function I(S){for(var L=arguments.length,R=new Array(L>1?L-1:0),O=1;O<L;O++)R[O-1]=arguments[O];for(var C=1;C<arguments.length;C++){var y=arguments[C];for(var u in y)S[u]=y[u]}return S}function k(S,L,R){var O=this,C={enumerable:!0};O.hasBeenReset=!1;var y="",u=!1,l=S,c=L,d=R,o=null,a="",s=!0,h="auto",p="start",_=50,v="middle",A=50,E="middle";Object.defineProperty(O,"id",I({},C,{get:function(){return y},set:function(T){y=""+T}})),Object.defineProperty(O,"pauseOnExit",I({},C,{get:function(){return u},set:function(T){u=!!T}})),Object.defineProperty(O,"startTime",I({},C,{get:function(){return l},set:function(T){if(typeof T!="number")throw new TypeError("Start time must be set to a number.");l=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"endTime",I({},C,{get:function(){return c},set:function(T){if(typeof T!="number")throw new TypeError("End time must be set to a number.");c=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"text",I({},C,{get:function(){return d},set:function(T){d=""+T,this.hasBeenReset=!0}})),Object.defineProperty(O,"region",I({},C,{get:function(){return o},set:function(T){o=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"vertical",I({},C,{get:function(){return a},set:function(T){var P=K(T);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");a=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"snapToLines",I({},C,{get:function(){return s},set:function(T){s=!!T,this.hasBeenReset=!0}})),Object.defineProperty(O,"line",I({},C,{get:function(){return h},set:function(T){if(typeof T!="number"&&T!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");h=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"lineAlign",I({},C,{get:function(){return p},set:function(T){var P=w(T);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");p=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"position",I({},C,{get:function(){return _},set:function(T){if(T<0||T>100)throw new Error("Position must be between 0 and 100.");_=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"positionAlign",I({},C,{get:function(){return v},set:function(T){var P=w(T);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");v=P,this.hasBeenReset=!0}})),Object.defineProperty(O,"size",I({},C,{get:function(){return A},set:function(T){if(T<0||T>100)throw new Error("Size must be between 0 and 100.");A=T,this.hasBeenReset=!0}})),Object.defineProperty(O,"align",I({},C,{get:function(){return E},set:function(T){var P=w(T);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");E=P,this.hasBeenReset=!0}})),O.displayState=void 0}return k.prototype.getCueAsHTML=function(){var S=self.WebVTT;return S.convertCueToDOMTree(self,this.text)},k}()},"./src/utils/vttparser.ts":(b,D,m)=>{m.r(D),m.d(D,{VTTParser:()=>L,fixLineBreaks:()=>S,parseTimeStamp:()=>F});var N=m("./src/utils/vttcue.ts"),x=function(){function R(){}var O=R.prototype;return O.decode=function(y,u){if(!y)return"";if(typeof y!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(y))},R}();function F(R){function O(y,u,l,c){return(y|0)*3600+(u|0)*60+(l|0)+parseFloat(c||0)}var C=R.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return C?parseFloat(C[2])>59?O(C[2],C[3],0,C[4]):O(C[1],C[2],C[3],C[4]):null}var M=function(){function R(){this.values=Object.create(null)}var O=R.prototype;return O.set=function(y,u){!this.get(y)&&u!==""&&(this.values[y]=u)},O.get=function(y,u,l){return l?this.has(y)?this.values[y]:u[l]:this.has(y)?this.values[y]:u},O.has=function(y){return y in this.values},O.alt=function(y,u,l){for(var c=0;c<l.length;++c)if(u===l[c]){this.set(y,u);break}},O.integer=function(y,u){/^-?\d+$/.test(u)&&this.set(y,parseInt(u,10))},O.percent=function(y,u){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(u)){var l=parseFloat(u);if(l>=0&&l<=100)return this.set(y,l),!0}return!1},R}();function K(R,O,C,y){var u=y?R.split(y):[R];for(var l in u)if(typeof u[l]=="string"){var c=u[l].split(C);if(c.length===2){var d=c[0],o=c[1];O(d,o)}}}var w=new N.default(0,0,""),I=w.align==="middle"?"middle":"center";function k(R,O,C){var y=R;function u(){var d=F(R);if(d===null)throw new Error("Malformed timestamp: "+y);return R=R.replace(/^[^\sa-zA-Z-]+/,""),d}function l(d,o){var a=new M;K(d,function(p,_){var v;switch(p){case"region":for(var A=C.length-1;A>=0;A--)if(C[A].id===_){a.set(p,C[A].region);break}break;case"vertical":a.alt(p,_,["rl","lr"]);break;case"line":v=_.split(","),a.integer(p,v[0]),a.percent(p,v[0])&&a.set("snapToLines",!1),a.alt(p,v[0],["auto"]),v.length===2&&a.alt("lineAlign",v[1],["start",I,"end"]);break;case"position":v=_.split(","),a.percent(p,v[0]),v.length===2&&a.alt("positionAlign",v[1],["start",I,"end","line-left","line-right","auto"]);break;case"size":a.percent(p,_);break;case"align":a.alt(p,_,["start",I,"end","left","right"]);break}},/:/,/\s/),o.region=a.get("region",null),o.vertical=a.get("vertical","");var s=a.get("line","auto");s==="auto"&&w.line===-1&&(s=-1),o.line=s,o.lineAlign=a.get("lineAlign","start"),o.snapToLines=a.get("snapToLines",!0),o.size=a.get("size",100),o.align=a.get("align",I);var h=a.get("position","auto");h==="auto"&&w.position===50&&(h=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=h}function c(){R=R.replace(/^\s+/,"")}if(c(),O.startTime=u(),c(),R.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+y);R=R.slice(3),c(),O.endTime=u(),c(),l(R,O)}function S(R){return R.replace(/<br(?: \/)?>/gi,`
`)}var L=function(){function R(){this.state="INITIAL",this.buffer="",this.decoder=new x,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var O=R.prototype;return O.parse=function(y){var u=this;y&&(u.buffer+=u.decoder.decode(y,{stream:!0}));function l(){var h=u.buffer,p=0;for(h=S(h);p<h.length&&h[p]!=="\r"&&h[p]!==`
`;)++p;var _=h.slice(0,p);return h[p]==="\r"&&++p,h[p]===`
`&&++p,u.buffer=h.slice(p),_}function c(h){K(h,function(p,_){},/:/)}try{var d="";if(u.state==="INITIAL"){if(!/\r\n|\n/.test(u.buffer))return this;d=l();var o=d.match(/^()?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");u.state="HEADER"}for(var a=!1;u.buffer;){if(!/\r\n|\n/.test(u.buffer))return this;switch(a?a=!1:d=l(),u.state){case"HEADER":/:/.test(d)?c(d):d||(u.state="ID");continue;case"NOTE":d||(u.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){u.state="NOTE";break}if(!d)continue;if(u.cue=new N.default(0,0,""),u.state="CUE",d.indexOf("-->")===-1){u.cue.id=d;continue}case"CUE":if(!u.cue){u.state="BADCUE";continue}try{k(d,u.cue,u.regionList)}catch{u.cue=null,u.state="BADCUE";continue}u.state="CUETEXT";continue;case"CUETEXT":{var s=d.indexOf("-->")!==-1;if(!d||s&&(a=!0)){u.oncue&&u.cue&&u.oncue(u.cue),u.cue=null,u.state="ID";continue}if(u.cue===null)continue;u.cue.text&&(u.cue.text+=`
`),u.cue.text+=d}continue;case"BADCUE":d||(u.state="ID")}}}catch{u.state==="CUETEXT"&&u.cue&&u.oncue&&u.oncue(u.cue),u.cue=null,u.state=u.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},O.flush=function(){var y=this;try{if((y.cue||y.state==="HEADER")&&(y.buffer+=`

`,y.parse()),y.state==="INITIAL"||y.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(u){y.onparsingerror&&y.onparsingerror(u)}return y.onflush&&y.onflush(),this},R}()},"./src/utils/webvtt-parser.ts":(b,D,m)=>{m.r(D),m.d(D,{generateCueId:()=>L,parseWebVTT:()=>O});var N=m("./src/polyfills/number.ts"),x=m("./src/utils/vttparser.ts"),F=m("./src/demux/id3.ts"),M=m("./src/utils/timescale-conversion.ts"),K=m("./src/remux/mp4-remuxer.ts"),w=/\r\n|\n\r|\n|\r/g,I=function(y,u,l){return l===void 0&&(l=0),y.slice(l,l+u.length)===u},k=function(y){var u=parseInt(y.slice(-3)),l=parseInt(y.slice(-6,-4)),c=parseInt(y.slice(-9,-7)),d=y.length>9?parseInt(y.substring(0,y.indexOf(":"))):0;if(!(0,N.isFiniteNumber)(u)||!(0,N.isFiniteNumber)(l)||!(0,N.isFiniteNumber)(c)||!(0,N.isFiniteNumber)(d))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+y);return u+=1e3*l,u+=60*1e3*c,u+=60*60*1e3*d,u},S=function(y){for(var u=5381,l=y.length;l;)u=u*33^y.charCodeAt(--l);return(u>>>0).toString()};function L(C,y,u){return S(C.toString())+S(y.toString())+S(u)}var R=function(y,u,l){var c=y[u],d=y[c.prevCC];if(!d||!d.new&&c.new){y.ccOffset=y.presentationOffset=c.start,c.new=!1;return}for(;(o=d)!==null&&o!==void 0&&o.new;){var o;y.ccOffset+=c.start-d.start,c.new=!1,c=d,d=y[c.prevCC]}y.presentationOffset=l};function O(C,y,u,l,c,d,o,a){var s=new x.VTTParser,h=(0,F.utf8ArrayToStr)(new Uint8Array(C)).trim().replace(w,`
`).split(`
`),p=[],_=(0,M.toMpegTsClockFromTimescale)(y,u),v="00:00.000",A=0,E=0,g,T=!0;s.oncue=function(P){var B=l[c],V=l.ccOffset,W=(A-_)/9e4;B!=null&&B.new&&(E!==void 0?V=l.ccOffset=B.start:R(l,c,W)),W&&(V=W-l.presentationOffset);var j=P.endTime-P.startTime,z=(0,K.normalizePts)((P.startTime+V-E)*9e4,d*9e4)/9e4;P.startTime=Math.max(z,0),P.endTime=Math.max(z+j,0);var Q=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(Q)),P.id||(P.id=L(P.startTime,P.endTime,Q)),P.endTime>0&&p.push(P)},s.onparsingerror=function(P){g=P},s.onflush=function(){if(g){a(g);return}o(p)},h.forEach(function(P){if(T)if(I(P,"X-TIMESTAMP-MAP=")){T=!1,P.slice(16).split(",").forEach(function(B){I(B,"LOCAL:")?v=B.slice(6):I(B,"MPEGTS:")&&(A=parseInt(B.slice(7)))});try{E=k(v)/1e3}catch(B){g=B}return}else P===""&&(T=!1);s.parse(P+`
`)}),s.flush()}},"./src/utils/xhr-loader.ts":(b,D,m)=>{m.r(D),m.d(D,{default:()=>K});var N=m("./src/utils/logger.ts"),x=m("./src/loader/load-stats.ts"),F=/^age:\s*[\d.]+\s*$/m,M=function(){function w(k){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=k?k.xhrSetup:null,this.stats=new x.LoadStats,this.retryDelay=0}var I=w.prototype;return I.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},I.abortInternal=function(){var S=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),S&&(S.onreadystatechange=null,S.onprogress=null,S.readyState!==4&&(this.stats.aborted=!0,S.abort()))},I.abort=function(){var S;this.abortInternal(),(S=this.callbacks)!==null&&S!==void 0&&S.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},I.load=function(S,L,R){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=S,this.config=L,this.callbacks=R,this.retryDelay=L.retryDelay,this.loadInternal()},I.loadInternal=function(){var S=this.config,L=this.context;if(S){var R=this.loader=new self.XMLHttpRequest,O=this.stats;O.loading.first=0,O.loaded=0;var C=this.xhrSetup;try{if(C)try{C(R,L.url)}catch{R.open("GET",L.url,!0),C(R,L.url)}R.readyState||R.open("GET",L.url,!0);var y=this.context.headers;if(y)for(var u in y)R.setRequestHeader(u,y[u])}catch(l){this.callbacks.onError({code:R.status,text:l.message},L,R);return}L.rangeEnd&&R.setRequestHeader("Range","bytes="+L.rangeStart+"-"+(L.rangeEnd-1)),R.onreadystatechange=this.readystatechange.bind(this),R.onprogress=this.loadprogress.bind(this),R.responseType=L.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),S.timeout),R.send()}},I.readystatechange=function(){var S=this.context,L=this.loader,R=this.stats;if(!(!S||!L)){var O=L.readyState,C=this.config;if(!R.aborted&&O>=2)if(self.clearTimeout(this.requestTimeout),R.loading.first===0&&(R.loading.first=Math.max(self.performance.now(),R.loading.start)),O===4){L.onreadystatechange=null,L.onprogress=null;var y=L.status,u=L.responseType==="arraybuffer";if(y>=200&&y<300&&(u&&L.response||L.responseText!==null)){R.loading.end=Math.max(self.performance.now(),R.loading.first);var l,c;if(u?(l=L.response,c=l.byteLength):(l=L.responseText,c=l.length),R.loaded=R.total=c,!this.callbacks)return;var d=this.callbacks.onProgress;if(d&&d(R,S,l,L),!this.callbacks)return;var o={url:L.responseURL,data:l};this.callbacks.onSuccess(o,R,S,L)}else R.retry>=C.maxRetry||y>=400&&y<499?(N.logger.error(y+" while loading "+S.url),this.callbacks.onError({code:y,text:L.statusText},S,L)):(N.logger.warn(y+" while loading "+S.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,C.maxRetryDelay),R.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),C.timeout)}},I.loadtimeout=function(){N.logger.warn("timeout while loading "+this.context.url);var S=this.callbacks;S&&(this.abortInternal(),S.onTimeout(this.stats,this.context,this.loader))},I.loadprogress=function(S){var L=this.stats;L.loaded=S.loaded,S.lengthComputable&&(L.total=S.total)},I.getCacheAge=function(){var S=null;if(this.loader&&F.test(this.loader.getAllResponseHeaders())){var L=this.loader.getResponseHeader("age");S=L?parseFloat(L):null}return S},w}();const K=M},"./node_modules/eventemitter3/index.js":b=>{var D=Object.prototype.hasOwnProperty,m="~";function N(){}Object.create&&(N.prototype=Object.create(null),new N().__proto__||(m=!1));function x(w,I,k){this.fn=w,this.context=I,this.once=k||!1}function F(w,I,k,S,L){if(typeof k!="function")throw new TypeError("The listener must be a function");var R=new x(k,S||w,L),O=m?m+I:I;return w._events[O]?w._events[O].fn?w._events[O]=[w._events[O],R]:w._events[O].push(R):(w._events[O]=R,w._eventsCount++),w}function M(w,I){--w._eventsCount===0?w._events=new N:delete w._events[I]}function K(){this._events=new N,this._eventsCount=0}K.prototype.eventNames=function(){var I=[],k,S;if(this._eventsCount===0)return I;for(S in k=this._events)D.call(k,S)&&I.push(m?S.slice(1):S);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(k)):I},K.prototype.listeners=function(I){var k=m?m+I:I,S=this._events[k];if(!S)return[];if(S.fn)return[S.fn];for(var L=0,R=S.length,O=new Array(R);L<R;L++)O[L]=S[L].fn;return O},K.prototype.listenerCount=function(I){var k=m?m+I:I,S=this._events[k];return S?S.fn?1:S.length:0},K.prototype.emit=function(I,k,S,L,R,O){var C=m?m+I:I;if(!this._events[C])return!1;var y=this._events[C],u=arguments.length,l,c;if(y.fn){switch(y.once&&this.removeListener(I,y.fn,void 0,!0),u){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,k),!0;case 3:return y.fn.call(y.context,k,S),!0;case 4:return y.fn.call(y.context,k,S,L),!0;case 5:return y.fn.call(y.context,k,S,L,R),!0;case 6:return y.fn.call(y.context,k,S,L,R,O),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];y.fn.apply(y.context,l)}else{var d=y.length,o;for(c=0;c<d;c++)switch(y[c].once&&this.removeListener(I,y[c].fn,void 0,!0),u){case 1:y[c].fn.call(y[c].context);break;case 2:y[c].fn.call(y[c].context,k);break;case 3:y[c].fn.call(y[c].context,k,S);break;case 4:y[c].fn.call(y[c].context,k,S,L);break;default:if(!l)for(o=1,l=new Array(u-1);o<u;o++)l[o-1]=arguments[o];y[c].fn.apply(y[c].context,l)}}return!0},K.prototype.on=function(I,k,S){return F(this,I,k,S,!1)},K.prototype.once=function(I,k,S){return F(this,I,k,S,!0)},K.prototype.removeListener=function(I,k,S,L){var R=m?m+I:I;if(!this._events[R])return this;if(!k)return M(this,R),this;var O=this._events[R];if(O.fn)O.fn===k&&(!L||O.once)&&(!S||O.context===S)&&M(this,R);else{for(var C=0,y=[],u=O.length;C<u;C++)(O[C].fn!==k||L&&!O[C].once||S&&O[C].context!==S)&&y.push(O[C]);y.length?this._events[R]=y.length===1?y[0]:y:M(this,R)}return this},K.prototype.removeAllListeners=function(I){var k;return I?(k=m?m+I:I,this._events[k]&&M(this,k)):(this._events=new N,this._eventsCount=0),this},K.prototype.off=K.prototype.removeListener,K.prototype.addListener=K.prototype.on,K.prefixed=m,K.EventEmitter=K,b.exports=K},"./node_modules/url-toolkit/src/url-toolkit.js":function(b){(function(D){var m=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,N=/^(?=([^\/?#]*))\1([^]*)$/,x=/(?:\/|^)\.(?=\/)/g,F=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,M={buildAbsoluteURL:function(K,w,I){if(I=I||{},K=K.trim(),w=w.trim(),!w){if(!I.alwaysNormalize)return K;var k=M.parseURL(K);if(!k)throw new Error("Error trying to parse base URL.");return k.path=M.normalizePath(k.path),M.buildURLFromParts(k)}var S=M.parseURL(w);if(!S)throw new Error("Error trying to parse relative URL.");if(S.scheme)return I.alwaysNormalize?(S.path=M.normalizePath(S.path),M.buildURLFromParts(S)):w;var L=M.parseURL(K);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var R=N.exec(L.path);L.netLoc=R[1],L.path=R[2]}L.netLoc&&!L.path&&(L.path="/");var O={scheme:L.scheme,netLoc:S.netLoc,path:null,params:S.params,query:S.query,fragment:S.fragment};if(!S.netLoc&&(O.netLoc=L.netLoc,S.path[0]!=="/"))if(!S.path)O.path=L.path,S.params||(O.params=L.params,S.query||(O.query=L.query));else{var C=L.path,y=C.substring(0,C.lastIndexOf("/")+1)+S.path;O.path=M.normalizePath(y)}return O.path===null&&(O.path=I.alwaysNormalize?M.normalizePath(S.path):S.path),M.buildURLFromParts(O)},parseURL:function(K){var w=m.exec(K);return w?{scheme:w[1]||"",netLoc:w[2]||"",path:w[3]||"",params:w[4]||"",query:w[5]||"",fragment:w[6]||""}:null},normalizePath:function(K){for(K=K.split("").reverse().join("").replace(x,"");K.length!==(K=K.replace(F,"")).length;);return K.split("").reverse().join("")},buildURLFromParts:function(K){return K.scheme+K.netLoc+K.path+K.params+K.query+K.fragment}};b.exports=M})()}},r={};function t(b){var D=r[b];if(D!==void 0)return D.exports;var m=r[b]={exports:{}};return i[b].call(m.exports,m,m.exports,t),m.exports}t.m=i,t.n=b=>{var D=b&&b.__esModule?()=>b.default:()=>b;return t.d(D,{a:D}),D},t.d=(b,D)=>{for(var m in D)t.o(D,m)&&!t.o(b,m)&&Object.defineProperty(b,m,{enumerable:!0,get:D[m]})},t.o=(b,D)=>Object.prototype.hasOwnProperty.call(b,D),t.r=b=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})};var f=t("./src/hls.ts");return f=f.default,f})())})(Zs);var Le=Zf(Zs.exports),Jf=wt.now,qf=wt.listContainsIgnoreCase,ed=-1,td=16;G.register("PLAYBACK_FRAGMENT_CHANGED");G.register("PLAYBACK_FRAGMENT_PARSING_METADATA");var Js=function(e){Bf(i,e);var n=Vf(i);function i(){var r;wf(this,i);for(var t=arguments.length,f=new Array(t),b=0;b<t;b++)f[b]=arguments[b];return r=n.call.apply(n,[this].concat(f)),r.options.hlsPlayback=Un(Un({},r.defaultOptions),r.options.hlsPlayback),r._setInitialState(),r}return Nf(i,[{key:"name",get:function(){return"hls"}},{key:"supportedVersion",get:function(){return{min:"0.4.27"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return this._currentLevel===null||this._currentLevel===void 0?ed:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(G.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"latency",get:function(){return this._hls.latency}},{key:"currentProgramDateTime",get:function(){return this._hls.playingDate}},{key:"_startTime",get:function(){return this._playbackType===pe.LIVE&&this._playlistType!=="EVENT"?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return Jf()}},{key:"_extrapolatedStartTime",get:function(){if(!this._localStartTimeCorrelation)return this._playableRegionStartTime;var t=this._localStartTimeCorrelation,f=this._now-t.local,b=(t.remote+f)/1e3;return Math.min(b,this._playableRegionStartTime+this._extrapolatedWindowDuration)}},{key:"_extrapolatedEndTime",get:function(){var t=this._playableRegionStartTime+this._playableRegionDuration;if(!this._localEndTimeCorrelation)return t;var f=this._localEndTimeCorrelation,b=this._now-f.local,D=(f.remote+b)/1e3;return Math.max(t-this._extrapolatedWindowDuration,Math.min(D,t))}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return this._segmentTargetDuration===null?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!0}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"sourceMedia",get:function(){return this.options.src}},{key:"currentTimestamp",get:function(){if(!this._currentFragment)return null;var t=this._currentFragment.programDateTime,f=this.el.currentTime,b=f-this._currentFragment.start,D=t+b*1e3;return D/1e3}},{key:"_setInitialState",value:function(){this._minDvrSize=typeof this.options.hlsMinimumDvrSize>"u"?60:this.options.hlsMinimumDvrSize,this._extrapolatedWindowNumSegments=!this.options.playback||typeof this.options.playback.extrapolatedWindowNumSegments>"u"?2:this.options.playback.extrapolatedWindowNumSegments,this._playbackType=pe.VOD,this._lastTimeUpdate={current:0,total:0},this._lastDuration=null,this._playableRegionStartTime=0,this._localStartTimeCorrelation=null,this._localEndTimeCorrelation=null,this._playableRegionDuration=0,this._programDateTime=0,this._durationExcludesAfterLiveSyncPoint=!1,this._segmentTargetDuration=null,this._playlistType=null,this._recoverAttemptsRemaining=this.options.hlsRecoverAttempts||td}},{key:"_setup",value:function(){this._destroyHLSInstance(),this._createHLSInstance(),this._listenHLSEvents(),this._attachHLSMedia()}},{key:"_destroyHLSInstance",value:function(){this._hls&&(this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._setInitialState(),this._hls.destroy(),this._hls=null)}},{key:"_createHLSInstance",value:function(){var t=Un({},this.options.playback.hlsjsConfig);this._hls=new Le(t)}},{key:"_attachHLSMedia",value:function(){this._hls&&this._hls.attachMedia(this.el)}},{key:"_listenHLSEvents",value:function(){var t=this;this._hls&&(this._hls.once(Le.Events.MEDIA_ATTACHED,function(){t.options.hlsPlayback.preload&&t._hls.loadSource(t.options.src)}),this._hls.on(Le.Events.MANIFEST_PARSED,function(){return t._manifestParsed=!0}),this._hls.on(Le.Events.LEVEL_LOADED,function(f,b){return t._updatePlaybackType(f,b)}),this._hls.on(Le.Events.LEVEL_UPDATED,function(f,b){return t._onLevelUpdated(f,b)}),this._hls.on(Le.Events.LEVEL_SWITCHING,function(f,b){return t._onLevelSwitch(f,b)}),this._hls.on(Le.Events.FRAG_CHANGED,function(f,b){return t._onFragmentChanged(f,b)}),this._hls.on(Le.Events.FRAG_LOADED,function(f,b){return t._onFragmentLoaded(f,b)}),this._hls.on(Le.Events.FRAG_PARSING_METADATA,function(f,b){return t._onFragmentParsingMetadata(f,b)}),this._hls.on(Le.Events.ERROR,function(f,b){return t._onHLSJSError(f,b)}),this._hls.on(Le.Events.SUBTITLE_TRACK_LOADED,function(f,b){return t._onSubtitleLoaded(f,b)}),this._hls.on(Le.Events.SUBTITLE_TRACKS_UPDATED,function(){return t._ccTracksUpdated=!0}),this.bindCustomListeners())}},{key:"bindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(f){var b=f.eventName,D=f.once?"once":"on";b&&t._hls["".concat(D)](b,f.callback)})}},{key:"unbindCustomListeners",value:function(){var t=this;this.customListeners.forEach(function(f){var b=f.eventName;b&&t._hls.off(b,f.callback)})}},{key:"_onFragmentParsingMetadata",value:function(t,f){this.trigger(G.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:f})}},{key:"render",value:function(){return this._ready(),Pt(gt(i.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(!this._hls&&this._setup(),this._isReadyState=!0,this.trigger(G.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(t,f,b){if(!this._recoveredDecodingError)this._recoveredDecodingError=!0,this._hls.recoverMediaError();else if(!this._recoveredAudioCodecError)this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError();else{Ee.error("hlsjs: failed to recover",{evt:t,data:f}),b.level=ot.Levels.FATAL;var D=this.createError(b);this.trigger(G.PLAYBACK_ERROR,D),this.stop()}}},{key:"_setupSrc",value:function(t){}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval(function(){t._onDurationChange(),t._onTimeUpdate()},100))}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(t){var f=t>0?this._duration*(t/100):this._duration;this.seek(f)}},{key:"seek",value:function(t){t<0&&(Ee.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this._startTime,this.el.currentTime=t}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(t){this.trigger(G.PLAYBACK_DVR,t),this.trigger(G.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function(){this._playbackType===pe.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(G.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(t,f){var b={code:"".concat(f.type,"_").concat(f.details),description:"".concat(this.name," error: type: ").concat(f.type,", details: ").concat(f.details),raw:f},D;if(f.response&&(b.description+=", response: ".concat(JSON.stringify(f.response))),f.fatal)if(this._recoverAttemptsRemaining>0)switch(this._recoverAttemptsRemaining-=1,f.type){case Le.ErrorTypes.NETWORK_ERROR:switch(f.details){case Le.ErrorDetails.MANIFEST_LOAD_ERROR:case Le.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case Le.ErrorDetails.MANIFEST_PARSING_ERROR:case Le.ErrorDetails.LEVEL_LOAD_ERROR:case Le.ErrorDetails.LEVEL_LOAD_TIMEOUT:Ee.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:f}),D=this.createError(b),this.trigger(G.PLAYBACK_ERROR,D),this.stop();break;default:Ee.warn("hlsjs: trying to recover from network error.",{evt:t,data:f}),b.level=ot.Levels.WARN,this._hls.startLoad();break}break;case Le.ErrorTypes.MEDIA_ERROR:Ee.warn("hlsjs: trying to recover from media error.",{evt:t,data:f}),b.level=ot.Levels.WARN,this._recover(t,f,b);break;default:Ee.error("hlsjs: could not recover from error.",{evt:t,data:f}),D=this.createError(b),this.trigger(G.PLAYBACK_ERROR,D),this.stop();break}else Ee.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:f}),D=this.createError(b),this.trigger(G.PLAYBACK_ERROR,D),this.stop();else{if(this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(f)){Ee.error("hlsjs: could not load decrypt key.",{evt:t,data:f}),D=this.createError(b),this.trigger(G.PLAYBACK_ERROR,D),this.stop();return}b.level=ot.Levels.WARN,Ee.warn("hlsjs: non-fatal error occurred",{evt:t,data:f})}}},{key:"_keyIsDenied",value:function(t){return t.type===Le.ErrorTypes.NETWORK_ERROR&&t.details===Le.ErrorDetails.KEY_LOAD_ERROR&&t.response&&t.response.code>=400}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},f=this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total;f||(this._lastTimeUpdate=t,this.trigger(G.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,Pt(gt(i.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],f=0,b=0;b<this.el.buffered.length;b++)t=[].concat(Hf(t),[{start:Math.max(0,this.el.buffered.start(b)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(b)-this._playableRegionStartTime)}]),this.el.currentTime>=t[b].start&&this.el.currentTime<=t[b].end&&(f=b);var D={start:t[f].start,current:t[f].end,total:this.getDuration()};this.trigger(G.PLAYBACK_PROGRESS,D,t)}}},{key:"load",value:function(t){this._stopTimeUpdateTimer(),this.options.src=t,this._setup()}},{key:"play",value:function(){!this._hls&&this._setup(),!this._manifestParsed&&!this.options.hlsPlayback.preload&&this._hls.loadSource(this.options.src),Pt(gt(i.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){this._hls&&(this.el.pause(),this.dvrEnabled&&this._updateDvr(!0))}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&Pt(gt(i.prototype),"stop",this).call(this),this._destroyHLSInstance()}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._destroyHLSInstance(),Pt(gt(i.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(t,f){this._playbackType=f.details.live?pe.LIVE:pe.VOD,this._onLevelUpdated(t,f),this._ccTracksUpdated&&this._playbackType===pe.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map(function(t,f){return{id:f,level:t,label:"".concat(t.bitrate/1e3,"Kbps")}}),this.trigger(G.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(t,f){this._segmentTargetDuration=f.details.targetduration,this._playlistType=f.details.type||null;var b=!1,D=!1,m=f.details.fragments,N=this._playableRegionStartTime,x=this._playableRegionDuration;if(m.length!==0){if(m[0].rawProgramDateTime&&(this._programDateTime=m[0].rawProgramDateTime),this._playableRegionStartTime!==m[0].start&&(b=!0,this._playableRegionStartTime=m[0].start),b)if(!this._localStartTimeCorrelation)this._localStartTimeCorrelation={local:this._now,remote:(m[0].start+this._extrapolatedWindowDuration/2)*1e3};else{var F=this._localStartTimeCorrelation,M=this._now-F.local,K=(F.remote+M)/1e3;K<m[0].start?this._localStartTimeCorrelation={local:this._now,remote:m[0].start*1e3}:K>N+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:Math.max(m[0].start,N+this._extrapolatedWindowDuration)*1e3})}var w=f.details.totalduration;if(this._playbackType===pe.LIVE){var I=f.details.targetduration,k=this.options.playback.hlsjsConfig||{},S=k.liveSyncDurationCount||Le.DefaultConfig.liveSyncDurationCount,L=I*S;L<=w?(w-=L,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1}w!==this._playableRegionDuration&&(D=!0,this._playableRegionDuration=w);var R=m[0].start+w,O=N+x,C=R!==O;if(C)if(!this._localEndTimeCorrelation)this._localEndTimeCorrelation={local:this._now,remote:R*1e3};else{var y=this._localEndTimeCorrelation,u=this._now-y.local,l=(y.remote+u)/1e3;l>R?this._localEndTimeCorrelation={local:this._now,remote:R*1e3}:l<R-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:(R-this._extrapolatedWindowDuration)*1e3}:l>O&&(this._localEndTimeCorrelation={local:this._now,remote:O*1e3})}D&&this._onDurationChange(),b&&this._onProgress()}}},{key:"_onFragmentChanged",value:function(t,f){this._currentFragment=f.frag,this.trigger(G.Custom.PLAYBACK_FRAGMENT_CHANGED,f)}},{key:"_onFragmentLoaded",value:function(t,f){this.trigger(G.PLAYBACK_FRAGMENT_LOADED,f)}},{key:"_onSubtitleLoaded",value:function(){if(!this._ccIsSetup){this.trigger(G.PLAYBACK_SUBTITLE_AVAILABLE);var t=this._playbackType===pe.LIVE?-1:this.closedCaptionsTrackId;this.closedCaptionsTrackId=t,this._ccIsSetup=!0}}},{key:"_onLevelSwitch",value:function(t,f){this.levels.length||this._fillLevels(),this.trigger(G.PLAYBACK_LEVEL_SWITCH_END),this.trigger(G.PLAYBACK_LEVEL_SWITCH,f);var b=this._hls.levels[f.level];b&&(this.highDefinition=b.height>=720||b.bitrate/1e3>=2e3,this.trigger(G.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(G.PLAYBACK_BITRATE,{height:b.height,width:b.width,bandwidth:b.bitrate,bitrate:b.bitrate,level:f.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===pe.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===pe.VOD||this.dvrEnabled}}],[{key:"HLSJS",get:function(){return Le}}]),i}(pt);Js.canPlay=function(e,n){var i=e.split("?")[0].match(/.*\.(.*)$/)||[],r=i.length>1&&i[1].toLowerCase()==="m3u8"||qf(n,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!!(Le.isSupported()&&r)};/*!
 * v-clappr v3.3.0
 * Vue.js wrapper for Clappr
 * (c) 2024 Vinayak Kulkarni<inbox.vinayak@gmail.com>
 * Released under the MIT License
 */const rd=_i({name:"VClappr",props:{el:{type:String,required:!0,default:"player"},source:{type:String,required:!0,default:""},options:{type:Object,required:!1,default:()=>({width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}},poster:"https://picsum.photos/3840/2160"})}},emits:["init","ready","resize","play","pause","stop","ended","seek","error","time-updated","volume-updated","subtitle-available"],setup(e,{emit:n}){const i=$o(null);ds(async()=>{await r()}),hs(()=>{var t;(t=i.value)==null||t.destroy(),i.value=null});const r=()=>new Promise((t,f)=>{e.el?(i.value=new js({parentId:`#${e.el}`,source:e.source,plugins:[ii,of,ff,Ia,ka,Ra,rf,cf,gf,mf,yf,Lf,Of,Ia,Ra,ka,Js],events:{onReady:b=>{n("ready",b)},onResize:b=>{n("resize",b)},onPlay:()=>{n("play",!0)},onPause:()=>{n("pause",!0)},onStop:b=>{n("stop",b)},onEnded:()=>{n("ended",!0)},onSeek:b=>{n("seek",b)},onError:b=>{n("error",b)},onTimeUpdate:b=>{n("time-updated",b)},onVolumeUpdate:b=>{n("volume-updated",b)},onSubtitleAvailable:b=>{n("subtitle-available",b)}},...e.options}),t("Player created!")):f("Root element not found")})}}),nd=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},id=["id"];function ad(e,n,i,r,t,f){return lr(),Lr("div",{id:e.el},null,8,id)}const sd=nd(rd,[["render",ad]]),od=_i({name:"ExampleApp",components:{VClappr:sd,VGithubIcon:Zu},setup(){const e=fn({clappr:null,source:"https://download.samplelib.com/mp4/sample-30s.mp4",poster:"http://clappr.io/poster.png",options:{width:"100%",height:"100%",autoPlay:!1,mute:!1,loop:!1,language:"en-US",playbackNotSupportedMessage:"Playback not supported",autoSeekFromUrl:!0,includeResetStyle:!0,playback:{preload:"metadata",disableContextMenu:!0,controls:!1,crossOrigin:null,playInline:!1,minimumDvrSize:null,externalTracks:[],hlsjsConfig:{},shakaConfiguration:{}}}});return{state:e,onInit:K=>{e.clappr=K},onReady:K=>{console.log("onReady Event: ",K)},onResize:K=>{console.log("onResize Event: ",K)},onPlay:K=>{console.log("onPlay Event: ",K)},onPause:K=>{console.log("onPause Event: ",K)},onStop:K=>{console.log("onStop Event: ",K)},onEnded:K=>{console.log("onEnded Event: ",K)},onSeek:K=>{console.log("onSeek Event: ",K)},onError:K=>{console.log("onError Event: ",K)},onTimeUpdated:K=>{console.log("onTimeUpdate Event: ",K)},onVolumeUpdated:K=>{console.log("onVolumeUpdate Event: ",K)},onSubtitleAvailable:K=>{console.log("onSubtitleAvailable Event: ",K)}}}}),ld=(e,n)=>{const i=e.__vccOpts||e;for(const[r,t]of n)i[r]=t;return i},ud={class:"w-screen h-screen bg-gradient-49"},cd=ut("div",{class:"absolute bottom-4 right-4"},[ut("a",{href:"https://app.netlify.com/sites/v-clappr/deploys","aria-label":"View deploys on Netlify",target:"_blank",rel:"noopener noreferrer",class:"gray-400"},[ut("img",{src:"https://www.netlify.com/img/global/badges/netlify-color-accent.svg",alt:"Deploys by Netlify"})])],-1);function fd(e,n,i,r,t,f){const b=Vi("v-github-icon"),D=Vi("v-clappr");return lr(),Lr("main",ud,[ct(b,{url:"https://github.com/vinayakkulkarni/v-clappr"}),ct(D,{el:"player",source:e.state.source,options:e.state.options,class:"mx-auto w-1/2 h-full",onInit:e.onInit,onReady:e.onReady,onResize:e.onResize,onPlay:e.onPlay,onPause:e.onPause,onStop:e.onStop,onEnded:e.onEnded,onSeek:e.onSeek,onError:e.onError,onTimeUpdated:e.onTimeUpdated,onVolumeUpdated:e.onVolumeUpdated,onSubtitleAvailable:e.onSubtitleAvailable},null,8,["source","options","onInit","onReady","onResize","onPlay","onPause","onStop","onEnded","onSeek","onError","onTimeUpdated","onVolumeUpdated","onSubtitleAvailable"]),cd])}const dd=ld(od,[["render",fd]]);Nu(dd).mount("#app");
